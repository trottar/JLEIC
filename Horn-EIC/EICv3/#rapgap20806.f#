*CMZ :  2.07/03 15/05/99  14.21.38  by  Hannes Jung
*CMZ :  2.01/09 27/02/96  09.50.59  by  Hannes Jung
*CMZ :  1.04/01 23/02/95  11.50.45  by  Hannes Jung
*CMZ :  1.03/01 03/04/94  16.45.55  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      FUNCTION AALAM(A,B,C)
      IMPLICIT NONE
	double precision A,B,C,AALAM
      AALAM = A**2 + B**2 + C**2 - 2.D0*A*B - 2.D0*B*C - 2.D0*C*A
      RETURN
      END
*CMZ :  2.08/00 06/06/99  15.38.27  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  14.25.17  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      FUNCTION ALPHAS(RQ)
      IMPLICIT NONE
      Integer NF
      REAL ALAM
      COMMON/ALPHA/NF,ALAM
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.
      REAL SNGL
	Double Precision ALPHAS,RQ,RQ1
C PDFLIB COMMON
      Double Precision QCDL4,QCDL5
      COMMON/W50512/ QCDL4,QCDL5
C
      REAL SCALE
      RQ1 = RQ
      IF(IRUNA.EQ.0) THEN
         ALPHAS=ALPHS
      ELSE

         SCALE = SNGL(RQ1*RQ1)
         ALPHAS =DBLE(ULALPS(SCALE))
      ENDIF
c      write(6,*) alphas,nf
      RETURN
      END
C*********************************************************************

      FUNCTION ULALPS(Q2)

C...Purpose: to give the value of alpha_strong.
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
*KEEP,RGLUDAT2.
      REAL PMAS,PARF,VCKM
      INTEGER KCHG
      COMMON/LUDAT2/KCHG(500,3),PMAS(500,4),PARF(2000),VCKM(4,4)
C      SAVE

*KEND.
      SAVE /LUDAT1/

C...Constant alpha_strong trivial.
      IF(MSTU(111).LE.0) THEN
         ULALPS=PARU(111)
         MSTU(118)=MSTU(112)
         PARU(117)=0.
         PARU(118)=PARU(111)
         RETURN
      ENDIF

C...Find effective Q2, number of flavours and Lambda.
      Q2EFF=Q2
      IF(MSTU(115).GE.2) Q2EFF=MAX(Q2,PARU(114))
      NF=MSTU(112)
      ALAM2=PARU(112)**2
   10 IF(NF.GT.MAX(2,MSTU(113))) THEN
         Q2THR=PARU(113)*PMAS(NF,1)**2
         IF(Q2EFF.LT.Q2THR) THEN
            NF=NF-1
            ALAM2=ALAM2*(Q2THR/ALAM2)**(2./(33.-2.*NF))
            GOTO 10
         ENDIF
      ENDIF
   20 IF(NF.LT.MIN(8,MSTU(114))) THEN
         Q2THR=PARU(113)*PMAS(NF+1,1)**2
         IF(Q2EFF.GT.Q2THR) THEN
            NF=NF+1
            ALAM2=ALAM2*(ALAM2/Q2THR)**(2./(33.-2.*NF))
            GOTO 20
         ENDIF
      ENDIF
      IF(MSTU(115).EQ.1) Q2EFF=Q2EFF+ALAM2
      PARU(117)=SQRT(ALAM2)

C...Evaluate first or second order alpha_strong.
      B0=(33.-2.*NF)/6.
      ALGQ=LOG(MAX(1.0001,Q2EFF/ALAM2))
      IF(MSTU(111).EQ.1) THEN
         ULALPS=MIN(PARU(115),PARU(2)/(B0*ALGQ))
      ELSE
         B1=(153.-19.*NF)/6.
         ULALPS=MIN(PARU(115),PARU(2)/(B0*ALGQ)*(1.-B1*LOG(ALGQ)/
     +   (B0**2*ALGQ)))
      ENDIF
      MSTU(118)=NF
      PARU(118)=ULALPS

      RETURN
      END
*CMZ :  2.08/02 04/11/99  16.39.08  by  Hannes Jung
*CMZ :  2.08/01 20/06/99  10.42.25  by  Hannes Jung
*CMZ :  2.08/00 14/06/99  19.13.11  by  Hannes Jung
*-- Author :
      SUBROUTINE ANALYS
      Implicit none
      DOUBLE PRECISION SSS,CM,DBCMSS
      COMMON /PARTON/ SSS,CM(4),DBCMSS(4)
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEND.

      INTEGER N,K
      REAL P,V
      COMMON/LUJETS/N,K(4000,5),P(4000,5),V(4000,5)

*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEND.

*KEEP, RGPARA1. change q2--> q2r
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2R,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2R,Q2Q,PCM(4,18)

*KEEP,RGPARAM.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
*KEND.

*KEEP, RGPARAS. change IPRO --> IPROR
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPROR
      COMMON/RAPA /IPROR,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA

*KEEP, RGDISDIF. change IDIR --> IDIRR
      INTEGER IDIRR,IDISDIF
      COMMON/DISDIF/ IDIRR,IDISDIF

*KEEP, RGEFFIC. change NOUT --> NOUTT
      DOUBLE PRECISION AVGI,SD
      INTEGER NIN,NOUTT
      COMMON/EFFIC/AVGI,SD,NIN,NOUTT
C     SAVE

      INTEGER NING

      DOUBLE PRECISION DBCMS(4)
      DOUBLE PRECISION XMX
      COMMON/TEST/XMX
      Integer NOUT,NOU110,NOU210,NOU1100
      COMMON/MYOUT/NOUT,NOU110,NOU210,NOU1100
      DOUBLE PRECISION PT2GEN,PHIGEN
      COMMON/HARDPOM/PT2GEN,PHIGEN

      DOUBLE PRECISION  QPR(4),PP(4),DOT
      real pt2_gen,phi_gen
      real plu,ulangl
      Real sphi,stheta,phit1,phit2
      Integer ncall,nevent,naf1,naf2,l,ll
c  ntuple gluon
      Real x_bj,y,xgam,Q2,x_pom,t,sigm
      Integer ipro,idir
      Real s_h,p_t,p_t1,p_t2,p_t3,phi1,phi2,phi3,eta1,eta2,
     + eta3,xg_p,xm2_tot
      common/cwnco1/x_bj,y,xgam,Q2,x_pom,t,ipro,idir,sigm
      common/cwnco2/s_h,p_t,p_t1,p_t2,p_t3,phi1,phi2,phi3,eta1,eta2,
     + eta3,xg_p,xm2_tot

      real phi_e,phi_p
      Integer isprot,i,ipom
      double precision bochck

      LOGICAL FIRST
      EXTERNAL DOT
      DATA FIRST/.TRUE./
      DATA NEVENT/0/
      IF(FIRST) THEN
         NOUT = 0
         FIRST = .FALSE.
      ENDIF
      x_bj = SNGL(Q2R/DBLE(YY)/SSS)
      y = yy
      xgam = xel/yy
      Q2 = SNGL(Q2R)
      x_pom = XFGKI
      t = T2GKI
      ipro = ipror
      idir = idirr
      sigm = sngl(avgi)
      s_h = shh
      if(ipror.eq.12) shh = 0.
      p_t = sqrt(pt2h)
      phi_e = ULANGL(P(4,1),P(4,2))
      do I=1,n
         if(k(i,2).eq.2212.and.k(i,1).eq.1) isprot =i
      enddo
      phi_p=ULANGL(P(isprot,1),P(isprot,2))
c     write(6,*) ' analys: phi_e/p ',phi_e,phi_p
c looking for phi asymmetries
C boost in gamma proton system
C and rotate
      IF(IDIRR.EQ.1) THEN

         DBCMS(1)= DBLE(P(NIA1,1) + P(2,1))
         DBCMS(2)= DBLE(P(NIA1,2) + P(2,2))
         DBCMS(3)= DBLE(P(NIA1,3) + P(2,3))
         DBCMS(4)= DBLE(P(NIA1,4) + P(2,4))
         xfgki=1.
      ELSE
c find pomeron
         ipom = 2
         do i=1,n
            if(k(i,2).eq.100) ipom=i
         enddo
c boost to gamma pomeron system
         DBCMS(1)= DBLE(P(NIA1,1) + P(ipom,1))
         DBCMS(2)= DBLE(P(NIA1,2) + P(ipom,2))
         DBCMS(3)= DBLE(P(NIA1,3) + P(ipom,3))
         DBCMS(4)= DBLE(P(NIA1,4) + P(ipom,4))
      ENDIF
c      write(6,*) ' analys nia1 ',nia1
      BOCHCK = (DBCMS(1)/DBCMS(4))**2 + (DBCMS(2)/DBCMS(4))**2
     +              + (DBCMS(3)/DBCMS(4))**2
      BOCHCK = DSQRT(BOCHCK)
      IF(BOCHCK.GT.0.99999999D0) then
         write(6,*) BOCHCK,nia1,ipom
         call lulist(1)
      endif
      CALL LUDBRB(0,N,0.,0.,-DBCMS(1)/DBCMS(4),-DBCMS(2)/DBCMS(4),
     +-DBCMS(3)/DBCMS(4))
      SPHI = ULANGL(P(nia1,1),P(nia1,2))
      CALL LUDBRB(0,0,0.,-sphi,0.d0,0.d0,0.d0)
      STHETA = ULANGL(P(nia1,3),P(nia1,1))
      CALL LUDBRB(0,0,-STHETA,0.,0.d0,0.d0,0.d0)
      IF(P(NF1,4).GT.P(NF2,4)) THEN
         phit1 = ULANGL(P(NF1,1),P(NF1,2))
         phit2 = ULANGL(P(NF2,1),P(NF2,2))
      ELSE
         phit2 = ULANGL(P(NF1,1),P(NF1,2))
         phit1 = ULANGL(P(NF2,1),P(NF2,2))

      ENDIF
      if(phit1.lt.0.) phit1 = 2.*sngl(pi) + phit1
      if(phit2.lt.0.) phit2 = 2.*sngl(pi) + phit2


      if(nf1.ne.nf2) then
         naf1=nf1
         naf2=nf2
      else
         do 20  l=nf1+1,n-1
            if(k(l,1).eq.12.or.k(l,1).eq.2) THEN
               do 10 ll = l,n
                  IF(k(ll,1).eq.11.or.k(ll,1).eq.1) then
                     naf1=l
                     naf2=ll
                     goto 30
                  endif
   10          continue
            endif
   20    continue
   30    continue
      endif
c     call lulist(1)
c     write(6,*) ' nf1,nf2,naf1,naf2 ',nf1,nf2,naf1,naf2
      p_t1 = plu(naf1,10)
      p_t2 = plu(naf2,10)
      p_t3 = plu(naf1+1,10)
      phi1 = ULANGL(P(NaF1,1),P(NaF1,2))
      phi2 = ULANGL(P(NaF2,1),P(NaF2,2))
      phi3 = ULANGL(P(NaF1+1,1),P(NaF1+1,2))
      eta1 = plu(naf1,19)
      eta2 = plu(naf2,19)
      eta3 = plu(naf1+1,19)
      xg_p = (shh+ sngl(Q2R))/yy/sngl(sss)
      xg_p = xpr
      xm2_tot = -sngl(Q2R) + yy*xfgki*sngl(sss) + t2gki


      CALL LUDBRB(0,0,STHETA,0.,0.d0,0.d0,0.d0)
      CALL LUDBRB(0,0,0.,sphi,0.d0,0.d0,0.d0)
      CALL LUDBRB(0,N,0.,0.,DBCMS(1)/DBCMS(4),DBCMS(2)/DBCMS(4),
     + DBCMS(3)/DBCMS(4))


      if(pt2gen.ne.0.0) then
         pt2_gen = sngl(pt2gen)
         phi_gen = sngl(phigen)
      else
         pt2_gen=PT2H
         phi_gen=phitgki
      endif
      ncall = ncall + 1
      CALL HFNT(100)

      NEVENT = NEVENT + 1
      NOUT=NEVENT
      RETURN
      END
*CMZ :  2.08/00 06/06/99  15.45.42  by  Hannes Jung
*CMZ :  2.06/51 10/10/98  10.29.55  by  Hannes Jung
*CMZ :  2.06/34 20/05/98  09.12.48  by  Hannes Jung
*CMZ :  2.06/21 28/11/97  11.56.06  by  Hannes Jung
*CMZ :  2.06/08 10/10/97  17.15.19  by  Hannes Jung
*CMZ :  2.06/00 17/07/97  12.49.00  by  Hannes Jung
*CMZ :  2.04/00 10/12/96  11.15.18  by  Hannes Jung
*CMZ :  2.01/14 03/05/96  10.11.16  by  Hannes Jung
*CMZ :  2.01/13 28/04/96  16.57.17  by  Hannes Jung
*CMZ :  2.01/09 10/02/96  19.20.34  by  Hannes Jung
*CMZ :  2.01/00 01/01/96  17.20.46  by  Hannes Jung
*CMZ :  2.00/30 29/12/95  14.46.41  by  Hannes Jung
*CMZ :  2.00/28 25/11/95  17.12.18  by  Hannes Jung
*CMZ :  2.00/27 22/11/95  16.24.57  by  Hannes Jung
*CMZ :  2.00/25 20/11/95  16.31.16  by  Hannes Jung
*CMZ :  2.00/23 19/11/95  21.32.59  by  Hannes Jung
*CMZ :  1.04/00 11/01/95  14.35.16  by  Hannes Jung
*CMZ :  1.03/01 03/04/94  16.45.58  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE AREXEC
C...ARiadne subroutine EXECute ariadne

C...The Main driver routine in Ariadne.


      IMPLICIT DOUBLE PRECISION (D)
      IMPLICIT DOUBLE PRECISION (B)
      IMPLICIT LOGICAL (Q)
      PARAMETER(MAXDIP=500,MAXPAR=500,MAXSTR=100)
      COMMON /ARPART/ BP(MAXPAR,5),IFL(MAXPAR),IEX(MAXPAR),QQ(MAXPAR),
     +                IDI(MAXPAR),IDO(MAXPAR),INO(MAXPAR),IPART
      SAVE /ARPART/

      COMMON /ARDIPS/ BX1(MAXDIP),BX3(MAXDIP),PT2IN(MAXDIP),
     +                SDIP(MAXDIP),IP1(MAXDIP),IP3(MAXDIP),
     +                AEX1(MAXDIP),AEX3(MAXDIP),QDONE(MAXDIP),
     +                QEM(MAXDIP),IRAD(MAXDIP),ISTR(MAXDIP),IDIPS
      SAVE /ARDIPS/

      COMMON /ARSTRS/ IPF(MAXSTR),IPL(MAXSTR),IFLOW(MAXSTR),
     +                PT2LST,IMF,IML,IO,QDUMP,ISTRS
      SAVE /ARSTRS/

      COMMON /ARDAT1/ PARA(40),MSTA(40)
      SAVE /ARDAT1/

      COMMON /ARDAT2/ PQMAS(10)
      SAVE /ARDAT2/

      COMMON /ARDAT3/ IWRN(40)
      SAVE /ARDAT3/

      COMMON /ARINT2/ DBEX,DBEY,DBEZ,PHI,THE
      SAVE /ARINT2/

*KEEP,RGLUPARM.
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


*KEND.
      REAL P,V
      COMMON/LUJETS/N,K(LUPAN,5),P(LUPAN,5),V(LUPAN,5)
      DOUBLE PRECISION PARL
      COMMON /RAPTOU/ CUT(14),LST(40),PARL(30),X,Y,W2,XQ2,U
      SAVE /RAPTOU/
*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEND.

      COMMON /PYSUBS/ MSEL,MSUB(200),KFIN(2,-40:40),CKIN(200)
      SAVE /PYSUBS/

      COMMON /PYINT1/ MINT(400),VINT(400)
      SAVE /PYINT1/
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEND.
C...Step counter
      MSTA(4)=MSTA(4)+1

C...Reset error log
      MSTA(13)=0

C...Error if ARINIT has not been called
      IF(MSTA(2).EQ.0) CALL ARERRM('AREXEC',12,0)

C...If ariadne mode just pass event through to ARPARS
      IF(MSTA(1).EQ.0) THEN
         CALL ARPARS(1,N)

C...If JETSET mode should work by just passing event on to ARPARS
      ELSEIF(MSTA(1).EQ.1) THEN
         CALL ARPARS(1,N)

C...If PYTHIA mode tag extended partons etc.
      ELSEIF(MSTA(1).EQ.2) THEN

         ISUB=MINT(1)
         IF(ISUB.NE.11.AND.ISUB.NE.12.AND.ISUB.NE.13.AND.ISUB.NE.28.AND
     +   .ISUB.NE.53.AND.ISUB.NE.68) CALL ARERRM('AREXEC',20,0)

         IFIRST=1
         ILAST=N

         DO 10 I=IFIRST,ILAST
            IF(K(I,1).GT.2) GOTO 10
            CALL ARGTYP(I,ITYP)
            IF(ITYP.EQ.0) GOTO 10
            IF(K(I,3).EQ.1.OR.K(I,3).EQ.2) THEN
               K(I,4)=1
            ELSE
               K(I,4)=0
            ENDIF
   10    CONTINUE

         CALL ARPARS(IFIRST,ILAST)

C...If LEPTO mode tag extended partons
      ELSEIF(MSTA(1).EQ.3) THEN
         IF(LST(24).EQ.1) THEN

C...Boost to hadronic cm to avoid precision problems
            DEL=DBLE(P(5,4)+P(6,4))
            DBXL=DBLE(P(5,1)+P(6,1))/DEL
            DBYL=DBLE(P(5,2)+P(6,2))/DEL
            DBZL=DBLE(P(5,3)+P(6,3))/DEL
            CALL DUDBRB(5,N,0.D0,0.D0,-DBXL,-DBYL,-DBZL)

            IF(MSTA(30).LT.2) THEN
               K(5,4)=0
            ELSE
               K(5,4)=3
               PARA(13)=SQRT(XQ2)
            ENDIF
            IF(MSTA(30).EQ.0) THEN
               K(6,4)=1
            ELSE
               K(6,4)=2
               PARA(12)=PARA(11)/(1.0-X)
            ENDIF
            CALL ARPARS(5,6)
            CALL DUDBRB(5,N,0.D0,0.D0,DBXL,DBYL,DBZL)
         ELSEIF(LST(24).EQ.3) THEN

C...Boost to hadronic cm to avoid precision problems
            DEL=DBLE(P(5,4)+P(6,4)+P(7,4)+P(8,4))
            DBXL=DBLE(P(5,1)+P(6,1)+ P(7,1)+P(8,1))
     +      /DEL
            DBYL=DBLE(P(5,2)+P(6,2)+ P(7,2)+P(8,2))
     +      /DEL
            DBZL=(DBLE(P(5,3))+DBLE(P(6,3))+ DBLE(P(7,3))+DBLE(P(8,4)))
     +      /DEL
            CALL DUDBRB(5,N,0.D0,0.D0,-DBXL,-DBYL,-DBZL)

            IF(MSTA(30).LT.2) THEN
               K(5,4)=0
            ELSE
               K(5,4)=3
               PARA(13)=SQRT(XQ2)
            ENDIF
            IF(MSTA(30).EQ.0) THEN
               K(6,4)=1
            ELSE
               K(6,4)=2
               PARA(12)=PARA(11)/(1.0-X)
            ENDIF
            CALL ARPARS(5,6)
            IF(MSTA(30).LT.2) THEN
               K(7,4)=0
            ELSE
               K(7,4)=3
               PARA(13)=SQRT(XQ2)
            ENDIF
            IF(MSTA(30).EQ.0) THEN
               K(8,4)=1
            ELSE
               K(8,4)=2
               PARA(12)=PARA(11)/(1.0-X)
            ENDIF
            CALL ARPARS(7,8)
            CALL DUDBRB(5,N,0.D0,0.D0,DBXL,DBYL,DBZL)
         ENDIF
      ELSEIF(MSTA(1).EQ.4) THEN
c         write(6,*) ' in arexec ',idir,ipro
         INPOM = 2
         XRA = Q2/dble(yy)/sss
         IF(IPRO.EQ.12) THEN
c here QPM
            N1 = 0
            N2 = 0
            DO 30 I=3,N
               IF(IDIR.EQ.0.AND.IABS(K(I,2)).EQ.100) INPOM = I
               IF(K(I,1).EQ.2.AND.N1.EQ.0) THEN
                  N1 = I
                  DO 20 J=N1,N
                     IF(K(J,1).EQ.2.AND.K(J+1,1).EQ.1.AND.N2.EQ.0)
     +               THEN
                        N2 = J+1
                        GOTO 30
                     ENDIF
   20             CONTINUE
               ENDIF
   30       CONTINUE
C...Boost to hadronic cm to avoid precision problems
            DEL=DBLE(P(NIA1,4)+P(INPOM,4))
            DBXL=DBLE(P(NIA1,1)+P(INPOM,1))/DEL
            DBYL=DBLE(P(NIA1,2)+P(INPOM,2))/DEL
            DBZL=DBLE(P(NIA1,3)+P(INPOM,3))/DEL
            CALL DUDBRB(0,N,0.D0,0.D0,-DBXL,-DBYL,-DBZL)
            IF(N1.NE.0.AND.N2.NE.0) THEN
               IF(MSTA(30).LT.2) THEN
                  K(N1,4)=0
               ELSE
                  K(N1,4)=3
                  PARA(13)=SQRT(SNGL(Q2))
               ENDIF
               IF(MSTA(30).EQ.0) THEN
                  K(N2,4)=1
               ELSE
                  K(N2,4)=2
                  PARA(12)=PARA(11)/(1.0-XRA)
                  IF(IDIR.EQ.0) PARA(12)=PARA(11)/(1.0-XRA/XFGKI)
               ENDIF
c         write(6,*) ' arexec ipro=12,n1,n2 ',n1,n2
               CALL ARPARS(N1,N2)
            ENDIF
            CALL DUDBRB(0,N,0.D0,0.D0,DBXL,DBYL,DBZL)
         ELSEIF(IPRO.EQ.13.OR.IPRO.EQ.14) THEN
c here  BGF
            N1 = 0
            N2 = 0
            DO 50 I=3,N
               IF(IDIR.EQ.0.AND.IABS(K(I,2)).EQ.100) INPOM = I
               IF(K(I,1).EQ.2.AND.N1.EQ.0) THEN
                  N1 = I
                  DO 40 J=N1,N
                     IF(K(J,1).EQ.2.AND.K(J+1,1).EQ.1.AND.N2.EQ.0)
     +               THEN
                        N2 = J + 1
                        GOTO 60
                     ENDIF
   40             CONTINUE
               ENDIF
   50       CONTINUE
   60       CONTINUE
C...Boost to hadronic cm to avoid precision problems
            DEL=DBLE(P(NIA1,4)+P(INPOM,4))
            DBXL=DBLE(P(NIA1,1)+P(INPOM,1))/DEL
            DBYL=DBLE(P(NIA1,2)+P(INPOM,2))/DEL
            DBZL=DBLE(P(NIA1,3)+P(INPOM,3))/DEL
            CALL DUDBRB(0,N,0.D0,0.D0,-DBXL,-DBYL,-DBZL)
            IF(MSTA(30).EQ.0) THEN
               K(NIA2+1,4)=1
            ENDIF
            IF(N2.NE.0) THEN
               NN2 = N2
               N3 = 0
               N4 = 0
               DO 80 I=NN2,N
                  IF(K(I,1).EQ.2.AND.N3.EQ.0) THEN
                     N3 = I
                     DO 70 J=N3,N
                        IF(K(J,1).EQ.2.AND.K(J+1,1).EQ.1.AND.N4.EQ.0)
     +                  THEN
                           N4 = J+1
                           GOTO 90
                        ENDIF
   70                CONTINUE
                  ENDIF
   80          CONTINUE
            ENDIF
   90       CONTINUE
c         write(6,*) ' arexec ipro=13,14  ,n1,n2 ',n1,n2
            IF(N1.NE.0.AND.N2.NE.0) THEN
               IF(MSTA(30).LT.2) THEN
                  K(N1,4)=0
                  IF(IDIR.EQ.0.AND.(N1+1).LT.N2) K(N2,4)=0
               ELSE
                  K(N1,4)=3
                  IF(IDIR.EQ.0.AND.(N1+1).LT.N2) K(N2,4)=3
                  PARA(13)=SQRT(SNGL(Q2))
               ENDIF
               IF(MSTA(30).EQ.0) THEN
                  K(N1+1,4)=1
               ELSE
                  K(N1+1,4)=2
                  PARA(12)=PARA(11)/(1.0-XRA)
                  IF(IDIR.EQ.0) PARA(12)=PARA(11)/(1.0-XRA/XFGKI)
               ENDIF
               CALL ARPARS(N1,N2)
            ENDIF

c         write(6,*) ' arexec 2nd ipro=13,14  ,n3,n4 ',n3,n4
            IF(N3.NE.0.AND.N4.NE.0) THEN
               IF(MSTA(30).LT.2) THEN
                  K(N3,4)=0
               ELSE
                  K(N3,4)=3
                  PARA(13)=SQRT(SNGL(Q2))
               ENDIF
               IF(MSTA(30).EQ.0) THEN
                  K(N4,4)=1
               ELSE
                  K(N4,4)=2
                  PARA(12)=PARA(11)/(1.0-XRA)
                  IF(IDIR.EQ.0) PARA(12)=PARA(11)/(1.0-XRA/XFGKI)
               ENDIF
               CALL ARPARS(N3,N4)
            ENDIF

            CALL DUDBRB(0,N,0.D0,0.D0,DBXL,DBYL,DBZL)
         ENDIF
      ENDIF
C...Perform fragmentation if requested
      IF(MSTA(5).EQ.1) CALL LUEXEC
      RETURN

C**** END OF AREXEC ****************************************************
      END






*CMZ :  2.06/51 10/10/98  10.29.56  by  Hannes Jung
*CMZ :  2.06/34 20/05/98  09.12.48  by  Hannes Jung
*CMZ :  2.05/05 20/03/97  11.13.39  by  Hannes Jung
*CMZ :  2.04/00 10/12/96  11.15.20  by  Hannes Jung
*CMZ :  2.03/03 22/08/96  19.18.54  by  Hannes Jung
*CMZ :  2.01/09 10/02/96  19.20.34  by  Hannes Jung
*CMZ :  2.00/30 29/12/95  14.41.47  by  Hannes Jung
*CMZ :  2.00/23 19/11/95  20.13.16  by  Hannes Jung
*CMZ :  2.00/19 06/11/95  08.35.01  by  Hannes Jung
*CMZ :  1.04/00 11/01/95  14.38.48  by  Hannes Jung
*CMZ :  1.03/01 03/04/94  16.45.58  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE ARINIT(MODE)

C...ARiadne subroutine INITialize
C...Initializes Ariadne to run with other (Lund) MC programs
      IMPLICIT DOUBLE PRECISION (D)
      IMPLICIT DOUBLE PRECISION (B)
      IMPLICIT LOGICAL (Q)
      PARAMETER(MAXDIP=500,MAXPAR=500,MAXSTR=100)

      COMMON /ARPART/ BP(MAXPAR,5),IFL(MAXPAR),IEX(MAXPAR),QQ(MAXPAR),
     +                IDI(MAXPAR),IDO(MAXPAR),INO(MAXPAR),IPART
      SAVE /ARPART/

      COMMON /ARDIPS/ BX1(MAXDIP),BX3(MAXDIP),PT2IN(MAXDIP),
     +                SDIP(MAXDIP),IP1(MAXDIP),IP3(MAXDIP),
     +                AEX1(MAXDIP),AEX3(MAXDIP),QDONE(MAXDIP),
     +                QEM(MAXDIP),IRAD(MAXDIP),ISTR(MAXDIP),IDIPS
      SAVE /ARDIPS/

      COMMON /ARSTRS/ IPF(MAXSTR),IPL(MAXSTR),IFLOW(MAXSTR),
     +                PT2LST,IMF,IML,IO,QDUMP,ISTRS
      SAVE /ARSTRS/

      COMMON /ARDAT1/ PARA(40),MSTA(40)
      SAVE /ARDAT1/

      COMMON /ARDAT2/ PQMAS(10)
      SAVE /ARDAT2/

      COMMON /ARDAT3/ IWRN(40)
      SAVE /ARDAT3/

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEND.

*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEND.

*KEEP,RGLUDAT2.
      REAL PMAS,PARF,VCKM
      INTEGER KCHG
      COMMON/LUDAT2/KCHG(500,3),PMAS(500,4),PARF(2000),VCKM(4,4)
C      SAVE

*KEND.
      DOUBLE PRECISION PARL
      COMMON /RAPTOU/ CUT(14),LST(40),PARL(30),X,Y,W2,XQ2,U
      SAVE /RAPTOU/
*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEND.

      COMMON /PYSUBS/ MSEL,MSUB(200),KFIN(2,-40:40),CKIN(200)
      SAVE /PYSUBS/
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEND.
      CHARACTER MODE*(*)


C...Set output files if not already done
      IF(MSTA(7).LT.0) MSTA(7)=MSTU(11)
      IF(MSTA(8).LT.0) MSTA(8)=MSTU(11)

C...Write out header
      WRITE(MSTA(7),10000)
      MSTA(2)=1

C...If Ariadne mode, do nothing special
      IF(MODE(1:6).EQ.'ARIADN') THEN
         MSTA(1)=0

C...If JETSET mode, switch off cascade and fragmentation in JETSET
      ELSEIF(MODE(1:6).EQ.'JETSET') THEN
         MSTA(1)=1
         MSTA(5)=MIN(MAX(MSTJ(105),0),1)
         MSTJ(101)=5
         MSTJ(41)=0
         MSTJ(105)=0
         WRITE(MSTA(7),10100)

C...If PYTHIA mode, switch off cascades and fragmentation. Check that
C...Ariadne can handle selected processes
      ELSEIF(MODE(1:6).EQ.'PYTHIA') THEN

         MSTA(1)=2
         WRITE(MSTA(7),10200)
         MSTA(5)=MIN(MAX(MSTP(111),0),1)
         MSTP(61)=0
         MSTP(71)=0
         MSTP(111)=0

C...If LEPTO mode, switch off cascades and fragmentation.
      ELSEIF(MODE(1:5).EQ.'LEPTO') THEN
         MSTA(1)=3
         WRITE(MSTA(7),10300)
         LST(8)=9
         MSTA(5)=MIN(MAX(LST(7),0),1)
         LST(7)=0

C...If RAPGAP mode, switch off cascades and fragmentation.
      ELSEIF(MODE(1:6).EQ.'RAPGAP') THEN
         MSTA(1)=4
         WRITE(MSTA(7),10400)
         MSTA(5)=MIN(MAX(LST(7),0),1)

C...Warn if mode is none of the above
      ELSE
         WRITE(MSTA(7),10500) MODE
         MSTA(1)=0
      ENDIF

C...Set quark masses
      IF(MSTA(24).GT.0) THEN
         DO 10 I=1,8
            PQMAS(I)=PMAS(I,1)
   10    CONTINUE
      ENDIF

      IF(MSTA(24).GE.2) THEN
         DO 20 I=1,5
            PQMAS(I)=PARF(100+I)
   20    CONTINUE
      ENDIF

      IF(MSTA(3).EQ.1) CALL ARTUNE('EMC')

10000 FORMAT(/,14X,
     +     'The Lund Monte Carlo - Ariadne version 4 revision 03',/,
     +     23X,'Latest date of change: 16 Jul 1992')
10100 FORMAT(18X,'Initialization done for running with JETSET')
10200 FORMAT(18X,'Initialization done for running with PYTHIA')
10300 FORMAT(18X,'Initialization done for running with LEPTO')
10400 FORMAT(18X,'Initialization done for running with RAPGAP')
10500 FORMAT(/,15X,'WARNING: Ariadne cannot be initialized for "',A,
     +     '".',/,21X,'Using default initialization instead.')
      RETURN

C**** END OF ARINIT ****************************************************
      END
*CMZ :  2.07/03 15/05/99  14.29.30  by  Hannes Jung
*CMZ :  2.06/51 10/10/98  10.29.56  by  Hannes Jung
*CMZ :  2.06/34 20/05/98  09.12.48  by  Hannes Jung
*CMZ :  2.06/30 18/03/98  12.21.24  by  Hannes Jung
*CMZ :  2.06/18 17/11/97  11.44.33  by  Hannes Jung
*CMZ :  2.05/05 19/03/97  18.42.20  by  Hannes Jung
*CMZ :  2.04/00 10/12/96  11.15.20  by  Hannes Jung
*CMZ :  2.01/09 11/02/96  16.51.47  by  Hannes Jung
*CMZ :  2.01/01 04/01/96  16.28.05  by  Hannes Jung
*CMZ :  2.00/30 29/12/95  14.49.16  by  Hannes Jung
*CMZ :  2.00/05 22/07/95  16.50.03  by  Hannes Jung
*CMZ :  1.04/01 20/01/95  17.43.26  by  Hannes Jung
*CMZ :  1.04/00 16/01/95  19.38.34  by  Hannes Jung
*CMZ :  1.03/01 03/04/94  16.45.54  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE BLEPIN

*#**********************************************************************
*#
*# to initialise block data from phythia and lepto neede for
*# structure function and parton shower
*#
*# CALLING: UCOPY
*#
*# AUTHOR:                          CREATED AT:
*#
*# CHANGED BY:                              AT:
*# REASON:
*#
*#**********************************************************************
      IMPLICIT NONE
      CHARACTER*23  FLAG,CHECK

C...Give sensible default values to switches and parameters.
      INTEGER I
      DOUBLE PRECISION PARL,EPARL
	REAL CUT,X,Y,W2,Q2,U,PYPAR,PYVAR
	Integer LST,IPY
      COMMON /RAPTOU/ CUT(14),LST(40),PARL(30),X,Y,W2,Q2,U
      COMMON /PYPARA/ IPY(80),PYPAR(80),PYVAR(80)
*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEND.
      INTEGER KSTP,KLST,KIPY
	REAL EARP,ECUT,EPYPAR,EPYVAR
      DIMENSION KSTP(200),EARP(200)
      DIMENSION ECUT(14),KLST(40),EPARL(30)
      DIMENSION KIPY(80),EPYPAR(80),EPYVAR(80)
C...Default values for main switches and parameters. Reset information.
      DATA (KSTP(I),I=1,100)/
     +     3,    1,    2,    0,    0,    0,    0,    0,    0,    0,
     +     0,    0,    1,    0,    0,    0,    0,    0,    0,    0,
     +     1,    0,    0,    0,    0,    0,    0,    0,    0,    0,
     +     1,    2,    0,    0,    0,    2,    1,    5,    0,    0,
     +     1,    1,    3,    7,    2,    1,    1,    0,    0,    0,
     +     1,    1,   20,    6,    0,    0,    0,    0,    0,    0,
     +     1,    2,    2,    2,    1,    0,    0,    0,    0,    0,
     +     1,    0,    0,    0,    0,    0,    0,    0,    0,    0,
     +     1,    1,  100,    0,    0,    0,    0,    0,    0,    0,
     +     1,    4,    0,    0,    0,    0,    0,    0,    0,    0/
      DATA (KSTP(I),I=101,200)/
     +     1,    0,    0,    0,    0,    0,    0,    0,    0,    0,
     +     1,    1,    1,    0,    0,    0,    0,    0,    0,    0,
     +     0,    1,    2,    1,    1,   20,    1,    0,   10,    0,
     +     0,    4,    0,    1,    0,    0,    0,    0,    0,    0,
     +     0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
     +     0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
     +     0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
     +     0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
     +     5,    5,    0,    0,    0,    0,    0,    0,    0,    0,
     +     0,    0,    0,    0,    0,    0,    0,    0,    0,    0/
c     +     5,    5, 1991,   03,   08,    0,    0,    0,    0,    0,
      DATA (EARP(I),I=1,100)/
     +  0.25,  10.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     +   0.0,-0.67, 25.0, 0.01,   0.,   0.,   0.,   0.,   0.,   0.,
     +    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     +   1.5,  2.0, 0.075,  0.,  0.2,   0.,  2.0,   0.,   0.,   0.,
     +  0.01,  2.0, 0.10, 1000., 2054., 0.,   0.,   0.,   0.,   0.,
     +   1.0, 2.26, 1.E4, 1.E-4,  0.,   0.,   0.,   0.,   0.,   0.,
     +  0.25,  1.0, 0.25,  1.0,  2.0, 1.E-3, 4.0,   0.,   0.,   0.,
     +   4.0,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     +  1.45, 1.70,  0.5,  0.2, 0.33, 0.66,  0.7,  0.5,   0.,   0.,
     +  0.44, 0.44,  2.0,  1.0,   0.,  3.0,  1.0, 0.75,   0.,   0./
      DATA (EARP(I),I=101,200)/
     + -0.02,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     +   2.0,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     +   1.0,  0.4,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     +  0.01,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     +    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     +    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     +    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     +    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     +    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     +    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0./

C...RAPTOU: Cuts, basic switches and parameters.
      DATA ECUT/1.E-04,1.,0.,1.,4.,1.E+08,5.,1.E+08,1.,1.E+08,1.,1.E+08,
     +0.,3.1416/
      DATA KLST/0,1,5,1,3,1,1,12,5,1,0,4,5,1,1,1,0,2,3,21*0/
**      DATA EPARL/1.,1.,0.44,0.75,0.226,0.,0.,0.015,2.,0.,0.01,4.,
**     +0.1,0.44,0.01,7.29735E-03,1.16637E-05,0.044,0.03,1.,10*0./
      DATA EPARL/1.,0.7,0.44,0.75,0.226,0.,0.,0.015,2.,0.,0.01,4.,
     +0.1,0.44,0.01,7.29735E-03,1.16637E-05,0.044,0.03,1.,10*0./
      DATA KIPY/
     + 0,     0,     2,     2,     6,     1,     1,     4,     3,     1,
     + 3,     1,     1,     2,     1,     1,     4,     1,     1,     1,
     + 0,     1,     1,     1,     1,     1,     1,     0,     0,     0,
     + 1,     2,     1,     1,    30,    33,     1,     1,     7,     0,
     + 0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
     + 0,     0,     0,     1,   100,     0,     0,     0,     0,     0,
     + 0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
     + 0,     0,     0,     0,     0,     0,     0,     0,     0,     0/
      DATA (EPYPAR(I),I=1,40)/
     +   7.299E-03,   2.290E-01,   2.000E-01,   2.500E-01,   4.000E+00,
     +   1.000E+00,   4.400E-01,   4.400E-01,   7.500E-02,   0.000E+00,
     +   2.000E+00,   2.000E+00,   1.000E+00,   0.000E+00,   3.000E+00,
     +   1.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,   1.000E+00,
     +   2.500E-01,   1.000E+00,   2.000E+00,   1.000E-03,   1.000E+00,
     +   1.000E+00,   1.000E+00,  -2.000E-02,  -1.000E-02,   0.000E+00,
     +   0.000E+00,   1.600E+00,   0.500E+00,   0.200E+00,   3.894E-01,
     +   1.000E+00,   3.300E-01,   6.600E-01,   0.000E+00,   1.000E+00/
      DATA (EPYPAR(I),I=41,80)/
     +   2.260E+00,   1.000E+04,   1.000E-04,   0.000E+00,   0.000E+00,
     +   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,
     +   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,
     +   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,
     +   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,
     +   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,
     +   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,
     +   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00,   0.000E+00/
      DATA EPYVAR/80*0./
      DATA CHECK /'RAPGAP 2.0 INITIALISED'/
      DATA FLAG  /'                      '/

      IF (FLAG .EQ. CHECK) THEN
         WRITE(6,*) ' BLOCK DATA for RAPGAP 2.0 REINITIALISED.'
      ENDIF

      CALL UCOPY(KSTP,MSTP,IPYPAR)
      CALL UCOPY(EARP,PARP,IPYPAR)

      CALL UCOPY(ECUT,CUT,14)
      CALL UCOPY(KLST,LST,40)
      CALL UCOPY(EPARL,PARL,30)
      CALL UCOPY(KIPY,IPY,80)
      CALL UCOPY(EPYPAR,PYPAR,80)
      CALL UCOPY(EPYVAR,PYVAR,80)
      FLAG = CHECK
      WRITE(6,*) ' BLOCK DATA for RAPGAP  initialised'

      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.31.08  by  Hannes Jung
*-- Author :    Hannes Jung   05/03/97
      SUBROUTINE COLRES

      IMPLICIT NONE
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEND.
      INTEGER LST,IRES
      COMMON/EPPARA/LST(30),IRES(2)
c..hju
      INTEGER ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      COMMON /COLCON/ ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG

      INTEGER KS,NS
      COMMON /COLR/ KS(40,5),NS


      K(NS+7,2)=21
ccc      write(6,*) ' colres IRESPRO ',irespro
      IF(IRESPRO.EQ.1) THEN
         K(NS+3,4)=21
         K(NS+3,5)=27
c qqbar event
         IF(K(NS+5,2).GT.0) THEN
            K(NS+5,4)=(NS+7)*MSTU(5)
            K(NS+5,5)=0
            K(NS+6,4)=0
            K(NS+6,5)=(NS+7)*MSTU(5)
            K(NS+1,4) = 27
            K(NS+1,5) = 23
            K(NS+7,4)=(NS+1)*MSTU(5)+25
            K(NS+7,5)=(NS+3)*MSTU(5)+26
         ELSE
            K(NS+6,4)=(NS+7)*MSTU(5)
            K(NS+6,5)=0
            K(NS+5,4)=0
            K(NS+5,5)=(NS+7)*MSTU(5)
            K(NS+1,4) = 27
            K(NS+1,5) = 23
            K(NS+7,4)=(NS+1)*MSTU(5)+26
            K(NS+7,5)=(NS+3)*MSTU(5)+25
         ENDIF
      ELSEIF(IRESPRO.EQ.2) THEN
c glu glu event

         IF(ICOLORA.EQ.1) THEN
c color flow A
            K(NS+1,4) = 27
            K(NS+1,5) = 23
            K(NS+3,4)=21
            K(NS+3,5)=27
            K(NS+5,4)=(NS+7)*MSTU(5)
            K(NS+5,5)=(NS+6)*MSTU(5)
            K(NS+6,4)=(NS+5)*MSTU(5)
            K(NS+6,5)=(NS+7)*MSTU(5)
            K(NS+7,4)=(NS+1)*MSTU(5)+25
            K(NS+7,5)=(NS+3)*MSTU(5)+26
         ELSEIF(ICOLORA.EQ.2) THEN
c color flow B
            K(NS+1,4) = 27
            K(NS+1,5) = 23
            K(NS+3,4)=21
            K(NS+3,5)=27
            K(NS+5,4)=(NS+6)*MSTU(5)
            K(NS+5,5)=(NS+7)*MSTU(5)
            K(NS+6,4)=(NS+7)*MSTU(5)
            K(NS+6,5)=(NS+5)*MSTU(5)
            K(NS+7,4)=(NS+1)*MSTU(5)+26
            K(NS+7,5)=(NS+3)*MSTU(5)+25
         ELSEIF(ICOLORA.EQ.3) THEN
c color flow C
            K(NS+1,4) = 26
            K(NS+1,5) = 25
            K(NS+3,4)=25
            K(NS+3,5)=26
            K(NS+5,4)=(NS+3)*MSTU(5)
            K(NS+5,5)=(NS+1)*MSTU(5)
            K(NS+6,4)=(NS+1)*MSTU(5)
            K(NS+6,5)=(NS+3)*MSTU(5)
            K(NS+7,4)=0
            K(NS+7,5)=0
            K(NS+7,1)=0
         ELSE
            write(6,*) ' wrong color configuartion ',ICOLORA
         ENDIF

      ELSEIF(IRESPRO.EQ.3) THEN
c qg event
C color configuartion A
         IF(ICOLORA.EQ.1) THEN
C antq from photon
            IF(K(21,2).LT.0.AND.K(23,2).EQ.21) THEN
               IF(K(25,2).LT.0.AND.K(26,2).EQ.21) THEN
                  K(NS+1,4) = 0
                  K(NS+1,5) = 23
                  K(NS+3,4)=21
                  K(NS+3,5)=27
                  K(NS+5,4)=0
                  K(NS+5,5)=(NS+6)*MSTU(5)
                  K(NS+6,4)=(NS+5)*MSTU(5)
                  K(NS+6,5)=(NS+7)*MSTU(5)
                  K(NS+7,4)=(NS+3)*MSTU(5)+25
                  K(NS+7,5)=0
                  K(NS+7,2) = K(NS+5,2)
c               write(6,*) ' 1st '
               ELSEIF(K(25,2).EQ.21.AND.K(26,2).LT.0) THEN
                  K(NS+1,4) = 0
                  K(NS+1,5) = 23
                  K(NS+3,4)=21
                  K(NS+3,5)=27
                  K(NS+6,4)=0
                  K(NS+6,5)=(NS+5)*MSTU(5)
                  K(NS+5,4)=(NS+6)*MSTU(5)
                  K(NS+5,5)=(NS+7)*MSTU(5)
                  K(NS+7,4)=(NS+1)*MSTU(5)+26
                  K(NS+7,5)=0
                  K(NS+7,2) = K(NS+6,2)
c               write(6,*) ' 3rd '
               ENDIF
c  q from photon
            ELSEIF(K(21,2).GT.0.AND.K(23,2).EQ.21) THEN
               IF(K(25,2).GT.0.AND.K(26,2).EQ.21) THEN
                  K(NS+1,4) = 23
                  K(NS+1,5) = 0
                  K(NS+3,4)=27
                  K(NS+3,5)=21
                  K(NS+5,4)=(NS+6)*MSTU(5)
                  K(NS+5,5)=0
                  K(NS+6,4)=(NS+7)*MSTU(5)
                  K(NS+6,5)=(NS+5)*MSTU(5)
                  K(NS+7,4)=(NS+3)*MSTU(5)+26
                  K(NS+7,5)=0
                  K(NS+7,2) = K(NS+5,2)
c               write(6,*) ' 2nd '
               ELSEIF(K(25,2).EQ.21.AND.K(26,2).GT.0) THEN
                  K(NS+1,4) = 23
                  K(NS+1,5) = 0
                  K(NS+3,4)=27
                  K(NS+3,5)=21
                  K(NS+6,4)=(NS+5)*MSTU(5)
                  K(NS+6,5)=0
                  K(NS+5,4)=(NS+7)*MSTU(5)
                  K(NS+5,5)=(NS+6)*MSTU(5)
                  K(NS+7,4)=(NS+3)*MSTU(5)+26
                  K(NS+7,5)=0
                  K(NS+7,2) = K(NS+6,2)
c               write(6,*) ' 4th '
               ENDIF
C antq from proton
            ELSEIF(K(23,2).LT.0.AND.K(21,2).EQ.21) THEN
               IF(K(25,2).LT.0.AND.K(26,2).EQ.21) THEN
                  K(NS+3,4) = 0
                  K(NS+3,5) = 21
                  K(NS+1,4)=23
                  K(NS+1,5)=27
                  K(NS+5,4)=0
                  K(NS+5,5)=(NS+6)*MSTU(5)
                  K(NS+6,4)=(NS+5)*MSTU(5)
                  K(NS+6,5)=(NS+7)*MSTU(5)
                  K(NS+7,4)=(NS+1)*MSTU(5)+25
                  K(NS+7,5)=0
                  K(NS+7,2) = K(NS+5,2)
c               write(6,*) ' 1st '
               ELSEIF(K(25,2).EQ.21.AND.K(26,2).LT.0) THEN
                  K(NS+3,4) = 0
                  K(NS+3,5) = 21
                  K(NS+1,4)=23
                  K(NS+1,5)=27
                  K(NS+6,4)=0
                  K(NS+6,5)=(NS+5)*MSTU(5)
                  K(NS+5,4)=(NS+6)*MSTU(5)
                  K(NS+5,5)=(NS+7)*MSTU(5)
                  K(NS+7,4)=(NS+1)*MSTU(5)+26
                  K(NS+7,5)=0
                  K(NS+7,2) = K(NS+6,2)
c               write(6,*) ' 3rd '
               ENDIF
c  q from proton
            ELSEIF(K(23,2).GT.0.AND.K(21,2).EQ.21) THEN
               IF(K(25,2).GT.0.AND.K(26,2).EQ.21) THEN
                  K(NS+3,4) = 21
                  K(NS+3,5) = 0
                  K(NS+1,4)=27
                  K(NS+1,5)=23
                  K(NS+5,4)=(NS+6)*MSTU(5)
                  K(NS+5,5)=0
                  K(NS+6,4)=(NS+7)*MSTU(5)
                  K(NS+6,5)=(NS+5)*MSTU(5)
                  K(NS+7,4)=(NS+1)*MSTU(5)+26
                  K(NS+7,5)=0
                  K(NS+7,2) = K(NS+5,2)
c               write(6,*) ' 2nd '
               ELSEIF(K(25,2).EQ.21.AND.K(26,2).GT.0) THEN
                  K(NS+3,4) = 21
                  K(NS+3,5) = 0
                  K(NS+1,4)=27
                  K(NS+1,5)=23
                  K(NS+6,4)=(NS+5)*MSTU(5)
                  K(NS+6,5)=0
                  K(NS+5,4)=(NS+7)*MSTU(5)
                  K(NS+5,5)=(NS+6)*MSTU(5)
                  K(NS+7,4)=(NS+1)*MSTU(5)+25
                  K(NS+7,5)=0
                  K(NS+7,2) = K(NS+6,2)
c               write(6,*) ' 4th '
               ENDIF
            ENDIF
C color configuartion B
         ELSE
C antq from photon
            IF(K(21,2).LT.0.AND.K(23,2).EQ.21) THEN
               IF(K(25,2).LT.0.AND.K(26,2).EQ.21) THEN
                  K(NS+1,4) = 0
                  K(NS+1,5) = 26
                  K(NS+3,4)=26
                  K(NS+3,5)=25
                  K(NS+5,4)=0
                  K(NS+5,5)=(NS+3)*MSTU(5)
                  K(NS+6,4)=(NS+3)*MSTU(5)
                  K(NS+6,5)=(NS+1)*MSTU(5)
                  K(NS+7,4)=0
                  K(NS+7,5)=0
                  K(NS+7,1)=0
                  K(NS+7,2) = K(NS+5,2)
c               write(6,*) ' 1st '
               ELSEIF(K(25,2).EQ.21.AND.K(26,2).LT.0) THEN
                  K(NS+1,4) = 0
                  K(NS+1,5) = 25
                  K(NS+3,4)=25
                  K(NS+3,5)=26
                  K(NS+6,4)=0
                  K(NS+6,5)=(NS+3)*MSTU(5)
                  K(NS+5,4)=(NS+3)*MSTU(5)
                  K(NS+5,5)=(NS+1)*MSTU(5)
                  K(NS+7,4)=0
                  K(NS+7,5)=0
                  K(NS+7,2) = K(NS+6,2)
                  K(NS+7,1)=0
c               write(6,*) ' 3rd '
               ENDIF
c  q from photon
            ELSEIF(K(21,2).GT.0.AND.K(23,2).EQ.21) THEN
               IF(K(25,2).GT.0.AND.K(26,2).EQ.21) THEN
                  K(NS+1,4) = 26
                  K(NS+1,5) = 0
                  K(NS+3,4)=25
                  K(NS+3,5)=26
                  K(NS+5,4)=(NS+3)*MSTU(5)
                  K(NS+5,5)=0
                  K(NS+6,4)=(NS+1)*MSTU(5)
                  K(NS+6,5)=(NS+3)*MSTU(5)
                  K(NS+7,4)=0
                  K(NS+7,5)=0
                  K(NS+7,1)=0
                  K(NS+7,2) = K(NS+5,2)
c               write(6,*) ' 2nd '
               ELSEIF(K(25,2).EQ.21.AND.K(26,2).GT.0) THEN
                  K(NS+1,4) = 25
                  K(NS+1,5) = 0
                  K(NS+3,4)=26
                  K(NS+3,5)=25
                  K(NS+6,4)=(NS+3)*MSTU(5)
                  K(NS+6,5)=0
                  K(NS+5,4)=(NS+1)*MSTU(5)
                  K(NS+5,5)=(NS+3)*MSTU(5)
                  K(NS+7,4)=0
                  K(NS+7,5)=0
                  K(NS+7,1)=0
                  K(NS+7,2) = K(NS+6,2)
c               write(6,*) ' 4th '
               ENDIF
C antq from proton
            ELSEIF(K(23,2).LT.0.AND.K(21,2).EQ.21) THEN
               IF(K(25,2).LT.0.AND.K(26,2).EQ.21) THEN
                  K(NS+3,4) = 0
                  K(NS+3,5) = 26
                  K(NS+1,4)=26
                  K(NS+1,5)=25
                  K(NS+5,4)=0
                  K(NS+5,5)=(NS+1)*MSTU(5)
                  K(NS+6,4)=(NS+1)*MSTU(5)
                  K(NS+6,5)=(NS+3)*MSTU(5)
                  K(NS+7,4)=0
                  K(NS+7,5)=0
                  K(NS+7,1)=0
                  K(NS+7,2) = K(NS+5,2)
c               write(6,*) ' 1st '
               ELSEIF(K(25,2).EQ.21.AND.K(26,2).LT.0) THEN
                  K(NS+3,4) = 0
                  K(NS+3,5) = 25
                  K(NS+1,4)=25
                  K(NS+1,5)=26
                  K(NS+6,4)=0
                  K(NS+6,5)=(NS+1)*MSTU(5)
                  K(NS+5,4)=(NS+1)*MSTU(5)
                  K(NS+5,5)=(NS+3)*MSTU(5)
                  K(NS+7,4)=0
                  K(NS+7,5)=0
                  K(NS+7,1)=0
                  K(NS+7,2) = K(NS+6,2)
c               write(6,*) ' 3rd '
               ENDIF
c  q from proton
            ELSEIF(K(23,2).GT.0.AND.K(21,2).EQ.21) THEN
               IF(K(25,2).GT.0.AND.K(26,2).EQ.21) THEN
                  K(NS+3,4) = 26
                  K(NS+3,5) = 0
                  K(NS+1,4)=25
                  K(NS+1,5)=26
                  K(NS+5,4)=(NS+1)*MSTU(5)
                  K(NS+5,5)=0
                  K(NS+6,4)=(NS+3)*MSTU(5)
                  K(NS+6,5)=(NS+1)*MSTU(5)
                  K(NS+7,4)=0
                  K(NS+7,5)=0
                  K(NS+7,1)=0
                  K(NS+7,2) = K(NS+5,2)
c               write(6,*) ' 2nd '
               ELSEIF(K(25,2).EQ.21.AND.K(26,2).GT.0) THEN
                  K(NS+3,4) = 25
                  K(NS+3,5) = 0
                  K(NS+1,4)=26
                  K(NS+1,5)=25
                  K(NS+6,4)=(NS+1)*MSTU(5)
                  K(NS+6,5)=0
                  K(NS+5,4)=(NS+3)*MSTU(5)
                  K(NS+5,5)=(NS+1)*MSTU(5)
                  K(NS+7,4)=0
                  K(NS+7,5)=0
                  K(NS+7,1)=0
                  K(NS+7,2) = K(NS+6,2)
c               write(6,*) ' 4th '
               ENDIF
            ENDIF

         ENDIF
ccc         CALL DULIST(2)
      ELSEIF(IRESPRO.EQ.4) THEN
c qqbar --> g g
         IF(ICOLORA.EQ.1) THEN
c color flow A
            IF(K(23,2).GT.0) THEN
               K(NS+1,4) = 0
               K(NS+1,5) = 27
               K(NS+3,4)=27
               K(NS+3,5)=0
               K(NS+5,4)=(NS+6)*MSTU(5)
               K(NS+5,5)=(NS+7)*MSTU(5)
               K(NS+6,4)=(NS+7)*MSTU(5)
               K(NS+6,5)=(NS+5)*MSTU(5)
               K(NS+7,4)=(NS+3)*MSTU(5)+26
               K(NS+7,5)=(NS+1)*MSTU(5)+25
c            write(6,*) ' flow A, quark'
            ELSEIF(K(23,2).LT.0) THEN
               K(NS+1,4) = 27
               K(NS+1,5) = 0
               K(NS+3,4)=0
               K(NS+3,5)=27
               K(NS+5,4)=(NS+7)*MSTU(5)
               K(NS+5,5)=(NS+6)*MSTU(5)
               K(NS+6,4)=(NS+5)*MSTU(5)
               K(NS+6,5)=(NS+7)*MSTU(5)
               K(NS+7,4)=(NS+1)*MSTU(5)+25
               K(NS+7,5)=(NS+3)*MSTU(5)+26
c            write(6,*) ' flow A, antiquark'
            ELSE
               write(6,*) ' wrong flavor',K(23,2),' for IRESPRO=',
     +         IRESPRO
               write(6,*) ' color conf: ',ICOLORA
            ENDIF
         ELSEIF(ICOLORA.EQ.2) THEN
c color flow B
            IF(K(23,2).GT.0) THEN
               K(NS+1,4) = 0
               K(NS+1,5) = 27
               K(NS+3,4)=27
               K(NS+3,5)=0
               K(NS+5,4)=(NS+7)*MSTU(5)
               K(NS+5,5)=(NS+6)*MSTU(5)
               K(NS+6,4)=(NS+5)*MSTU(5)
               K(NS+6,5)=(NS+7)*MSTU(5)
               K(NS+7,4)=(NS+3)*MSTU(5)+25
               K(NS+7,5)=(NS+1)*MSTU(5)+26
c            write(6,*) ' flow B, quark'
            ELSEIF(K(23,2).LT.0) THEN
               K(NS+1,4) = 27
               K(NS+1,5) = 0
               K(NS+3,4)=0
               K(NS+3,5)=27
               K(NS+5,4)=(NS+6)*MSTU(5)
               K(NS+5,5)=(NS+7)*MSTU(5)
               K(NS+6,4)=(NS+7)*MSTU(5)
               K(NS+6,5)=(NS+5)*MSTU(5)
               K(NS+7,4)=(NS+1)*MSTU(5)+26
               K(NS+7,5)=(NS+3)*MSTU(5)+25
c            write(6,*) ' flow B, antiquark'
            ELSE
               write(6,*) ' wrong flavor',K(23,2),' for IRESPRO=',
     +         IRESPRO
               write(6,*) ' color conf: ',ICOLORA
            ENDIF
         ELSE
            write(6,*) ' wrong color configuartion ',ICOLORA
         ENDIF
      ELSEIF(IRESPRO.EQ.5) THEN
c qqbar --> q qbar
         IF(ICOLORA.EQ.1) THEN
c color flow A
            IF(K(23,2).GT.0) THEN
               K(NS+1,4) = 0
               K(NS+1,5) = 23
               K(NS+3,4)=21
               K(NS+3,5)=0
               K(NS+5,4)=0
               K(NS+5,5)=(NS+6)*MSTU(5)
               K(NS+6,4)=(NS+5)*MSTU(5)
               K(NS+6,5)=0
               K(NS+7,4)=0
               K(NS+7,5)=0
               K(NS+7,1)=0
c            write(6,*) ' flow A, quark'
            ELSEIF(K(23,2).LT.0) THEN
               K(NS+1,4) = 23
               K(NS+1,5) = 0
               K(NS+3,4)=0
               K(NS+3,5)=21
               K(NS+5,4)=(NS+6)*MSTU(5)
               K(NS+5,5)=0
               K(NS+6,4)=0
               K(NS+6,5)=(NS+5)*MSTU(5)
               K(NS+7,4)=0
               K(NS+7,5)=0
               K(NS+7,1)=0
c            write(6,*) ' flow A, antiquark'
            ELSE
               write(6,*) ' wrong flavor',K(23,2),' for IRESPRO=',
     +         IRESPRO
               write(6,*) ' color conf: ',ICOLORA
            ENDIF
         ELSEIF(ICOLORA.EQ.2) THEN
c color flow B
            IF(K(23,2).GT.0) THEN
               K(NS+1,4) = 0
               K(NS+1,5) = 27
               K(NS+3,4)=27
               K(NS+3,5)=0
               IF(K(25,2).GT.0) THEN
                  K(NS+5,4)=(NS+7)*MSTU(5)
                  K(NS+5,5)=0
                  K(NS+6,4)=0
                  K(NS+6,5)=(NS+7)*MSTU(5)
                  K(NS+7,4)=(NS+3)*MSTU(5)+25
                  K(NS+7,5)=(NS+1)*MSTU(5)+26
               ELSE
                  K(NS+5,4)=0
                  K(NS+5,5)=(NS+7)*MSTU(5)
                  K(NS+6,4)=(NS+7)*MSTU(5)
                  K(NS+6,5)=0
                  K(NS+7,4)=(NS+3)*MSTU(5)+26
                  K(NS+7,5)=(NS+1)*MSTU(5)+25
               ENDIF
c            write(6,*) ' flow B, quark'
            ELSEIF(K(23,2).LT.0) THEN
               K(NS+1,4) = 27
               K(NS+1,5) = 0
               K(NS+3,4)=0
               K(NS+3,5)=27
               IF(K(25,2).GT.0) THEN
                  K(NS+5,4)=(NS+7)*MSTU(5)
                  K(NS+5,5)=0
                  K(NS+6,4)=0
                  K(NS+6,5)=(NS+7)*MSTU(5)
                  K(NS+7,4)=(NS+1)*MSTU(5)+25
                  K(NS+7,5)=(NS+3)*MSTU(5)+26
               ELSE
                  K(NS+5,4)=0
                  K(NS+5,5)=(NS+7)*MSTU(5)
                  K(NS+6,4)=(NS+7)*MSTU(5)
                  K(NS+6,5)=0
                  K(NS+7,4)=(NS+1)*MSTU(5)+26
                  K(NS+7,5)=(NS+3)*MSTU(5)+25
               ENDIF
c            write(6,*) ' flow B, antiquark'
            ELSE
               write(6,*) ' wrong flavor',K(23,2),' for IRESPRO=',
     +         IRESPRO
               write(6,*) ' color conf: ',ICOLORA
            ENDIF
         ELSE
            write(6,*) ' wrong color configuartion ',ICOLORA
         ENDIF
      ELSEIF(IRESPRO.EQ.6) THEN
c q q --> q q
         IF(ICOLORA.EQ.1) THEN
c color flow A
            IF(K(23,2).GT.0) THEN
               K(NS+1,4) = 26
               K(NS+1,5) = 0
               K(NS+3,4)=25
               K(NS+3,5)=0
               K(NS+5,4)=(NS+3)*MSTU(5)
               K(NS+5,5)=0
               K(NS+6,4)=(NS+1)*MSTU(5)
               K(NS+6,5)=0
               K(NS+7,4)=0
               K(NS+7,5)=0
               K(NS+7,1)=0
c            write(6,*) ' flow A, quark'
            ELSEIF(K(23,2).LT.0) THEN
               K(NS+1,4) = 0
               K(NS+1,5) = 26

               K(NS+3,4)=0
               K(NS+3,5)=25
               K(NS+5,4)=0
               K(NS+5,5)=(NS+3)*MSTU(5)
               K(NS+6,4)=0
               K(NS+6,5)=(NS+1)*MSTU(5)
               K(NS+7,4)=0
               K(NS+7,5)=0
               K(NS+7,1)=0
c            write(6,*) ' flow A, antiquark'
            ELSE
               write(6,*) ' wrong flavor',K(23,2),' for IRESPRO=',
     +         IRESPRO
               write(6,*) ' color conf: ',ICOLORA
            ENDIF
         ELSEIF(ICOLORA.EQ.2) THEN
c color flow B
            IF(K(23,2).GT.0) THEN
               K(NS+1,4) = 25
               K(NS+1,5) = 0

               K(NS+3,4)=26
               K(NS+3,5)=0
               K(NS+5,4)=(NS+1)*MSTU(5)
               K(NS+5,5)=0
               K(NS+6,4)=(NS+3)*MSTU(5)
               K(NS+6,5)=0
               K(NS+7,4)=0
               K(NS+7,5)=0
               K(NS+7,1)=0
c            write(6,*) ' flow B, quark'
            ELSEIF(K(23,2).LT.0) THEN
               K(NS+1,4) = 0
               K(NS+1,5) = 25

               K(NS+3,4)=0
               K(NS+3,5)=26
               K(NS+5,4)=0
               K(NS+5,5)=(NS+1)*MSTU(5)
               K(NS+6,4)=0
               K(NS+6,5)=(NS+3)*MSTU(5)
               K(NS+7,4)=0
               K(NS+7,5)=0
               K(NS+7,1)=0
c            write(6,*) ' flow B, antiquark'
            ELSE
               write(6,*) ' wrong flavor',K(23,2),' for IRESPRO=',
     +         IRESPRO
               write(6,*) ' color conf: ',ICOLORA
            ENDIF
         ELSE
            write(6,*) ' wrong color configuartion ',ICOLORA
         ENDIF
      ELSEIF(IRESPRO.EQ.7) THEN
c q q --> q q color singlet exchange
         K(NS+1,4) = 25
         K(NS+1,5) = 25
         K(NS+3,4)=26
         K(NS+3,5)=26
         K(NS+5,4)=(NS+1)*MSTU(5)
         K(NS+5,5)=(NS+1)*MSTU(5)
         K(NS+6,4)=(NS+3)*MSTU(5)
         K(NS+6,5)=(NS+3)*MSTU(5)
         K(NS+7,4)=0
         K(NS+7,5)=0
         K(NS+7,1)=0
      ELSE
         write(6,*) ' colres : irespro not implemented ',irespro
      ENDIF
      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.32.06  by  Hannes Jung
*CMZ :  2.01/11 26/03/96  14.31.18  by  Hannes Jung
*CMZ :  2.00/23 19/11/95  20.13.16  by  Hannes Jung
*CMZ :  1.03/01 03/04/94  16.45.58  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE CUTG(PT2,NACC)
      IMPLICIT NONE
	Double Precision PT2
	INTEGER NACC
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEND.
      NACC=1
      IF(PT2.LT.PT2CUT(IPRO)) NACC=0
      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.33.38  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      FUNCTION DFUN(N,X)
      IMPLICIT NONE
      INTEGER N,I
      DOUBLE PRECISION DFUN,FXN1,WEIGHT,X(20)
      EXTERNAL FXN1
      DFUN=0
      WEIGHT=0.D0
      DO 10 I=1,N
10    IF(X(I).EQ.0..OR.X(I).EQ.1.) RETURN
      DFUN = FXN1(X,WEIGHT)
      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.38.44  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE DIFFR1(X,WDIF)
      IMPLICIT NONE
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      Double Precision GEV2NB,WPART,WDIF,WT1
	Double Precision X(20)
      DATA GEV2NB/.3893857D+6/
      WPART=0.D0
      WDIF=0.D0
      WT1=0.D0
      IF(IHERAC.EQ.0) THEN
         CALL PARTDF(X,WPART)
      ELSE
         CALL PARTDFHS(X,WPART)
      ENDIF

      IF(WPART.GT.0.) THEN
         IF(IPRO.EQ.10) CALL ELEQQL(WT1)
         IF(IPRO.EQ.13) CALL ELEQQF(WT1)
         IF(IPRO.EQ.15) CALL ELEQCDC(WT1)
         WDIF=WPART*WT1*GEV2NB
      ENDIF
c      if(wt1.eq.0.d0.and.wpart.ne.0.d0) then
c      write(6,*) 'diffr1 wpart,wt1',wpart,wt1
c      endif
      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.36.31  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE DIFFR2(X,WDIF)
      IMPLICIT NONE
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      Double Precision GEV2NB,WPART,WDIF,WT1
	Double Precision X(20)
      DATA GEV2NB/.3893857D+6/
      WPART=0.D0
      WDIF=0.D0
      WT1=0.D0
      IF(IHERAC.EQ.0) THEN
         CALL PARTDF(X,WPART)
      ELSE
         CALL PARTDFHS(X,WPART)
      ENDIF
      IF(WPART.GT.0.) THEN
         IF(IPRO.EQ.11) CALL ELEQQB(WT1)
         IF(IPRO.EQ.14) CALL ELEQQF(WT1)
      ENDIF
      if(wt1.eq.0d0.and.wpart.ne.0.d0) then
c      write(6,*) 'diffr2 wpart,wt1',wpart,wt1
      endif
      WDIF=WPART*WT1*GEV2NB
      RETURN
      END
*CMZ :  2.08/00 06/06/99  15.53.52  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  14.38.44  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE DIFFR3(X,WDIF)
      IMPLICIT NONE
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      Double Precision GEV2NB,WPART,WDIF
	Double Precision X(20)
      DATA GEV2NB/.3893857D+6/
      WPART=0.D0
      WDIF=0.D0
      IF(IHERAC.EQ.0) THEN
         CALL PARTDF(X,WPART)
      ELSE
         CALL PARTDFHS(X,WPART)
      ENDIF
      IF(WPART.LE.0.D0) WPART = 0.D0
c matrix element in partdf included
      WDIF=WPART*GEV2NB
      RETURN
      END
*CMZ :  2.08/00 06/06/99  15.46.42  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  14.37.42  by  Hannes Jung
*-- Author :    Hannes Jung   30/10/94
      SUBROUTINE DIFFR4(X,WDIF)
      IMPLICIT NONE
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEND.
      Double Precision GEV2NB,WPART,WDIF,WT1
	Double Precision X(20)
      DATA GEV2NB/.3893857D+6/
      WPART=0.D0
      WDIF=0.D0
      WT1=0.D0
      CALL PARTDF(X,WPART)
c      write(6,*) 'diffr4: WPART ',WPART
      IF(WPART.NE.0.) THEN
         IF(IPRO.EQ.100) CALL ELERHO(WT1)
      ENDIF
      WDIF=WPART*WT1*GEV2NB
c      write(6,*) 'diffr4: WDIF ',WDIF
c      call lulist(1)
      RETURN
      END


*CMZ :  2.07/03 15/05/99  14.41.38  by  Hannes Jung
*-- Author :    Hannes Jung   12/01/95
      SUBROUTINE DIR1(X,WDIF)
      IMPLICIT NONE
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      Double Precision GEV2NB,WPART,WDIF,WT1
      Double Precision X(20)
      DATA GEV2NB/.3893857D+6/
      WPART=0.D0
      WDIF=0.D0
      WT1=0.D0
      IF(IHERAC.EQ.0) THEN
         CALL PARTDI(X,WPART)
      ELSE
         CALL PARTDIHS(X,WPART)
      ENDIF


      IF(WPART.GT.0.) THEN
         IF(IPRO.EQ.10) CALL ELEQQL(WT1)
         IF(IPRO.EQ.13) CALL ELEQQF(WT1)
         IF(IPRO.EQ.15) CALL ELEQCDC(WT1)
         WDIF=WPART*WT1*GEV2NB
      ENDIF
c           write(6,*) 'dir1 ',wpart,wt1,IHERAC
      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.41.38  by  Hannes Jung
*-- Author :    Hannes Jung   12/01/95
      SUBROUTINE DIR2(X,WDIF)
      IMPLICIT NONE
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      Double Precision GEV2NB,WPART,WDIF,WT1
      Double Precision X(20)
      DATA GEV2NB/.3893857D+6/
      WPART=0.D0
      WDIF=0.D0
      WT1=0.D0
      IF(IHERAC.EQ.0) THEN
         CALL PARTDI(X,WPART)
      ELSE
         CALL PARTDIHS(X,WPART)
      ENDIF

      IF(WPART.GT.0.) THEN
         IF(IPRO.EQ.11) CALL ELEQQB(WT1)
         IF(IPRO.EQ.14) CALL ELEQQF(WT1)
      ENDIF
      WDIF=WPART*WT1*GEV2NB
c          write(6,*) 'dir2 ',wpart,wt1,iherac
      RETURN
      END
*CMZ :  2.08/00 06/06/99  15.47.21  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  14.41.38  by  Hannes Jung
*-- Author :    Hannes Jung   12/01/95
      SUBROUTINE DIR3(X,WDIF)
      IMPLICIT NONE
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      Double Precision GEV2NB,WPART,WDIF
      Double Precision X(20)
      DATA GEV2NB/.3893857D+6/
      WPART=0.D0
      WDIF=0.D0
      IF(IHERAC.EQ.0) THEN
         CALL PARTDI(X,WPART)
      ELSE
         CALL PARTDIHS(X,WPART)
      ENDIF
c matrix element in partdi included
      IF(WPART.LE.0.D0) WPART=0.D0
      WDIF=WPART*GEV2NB
c      write(6,*) ' dir3 ',wpart,wdif
      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.42.27  by  Hannes Jung
*-- Author :    Hannes Jung   02/03/97
      SUBROUTINE DIR4(X,WDIF)
      IMPLICIT NONE
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      Double Precision GEV2NB,WPART,WDIF,WT1
      Double Precision X(20)
	INTEGER IDEBUG
      COMMON/ INTERN/IDEBUG
      DATA GEV2NB/.3893857D+6/
      WPART=0.D0
      WDIF=0.D0
      WT1=0.D0
      IF(IHERAC.EQ.0) THEN
         CALL PARTDI(X,WPART)
      ELSE
         CALL PARTDIHS(X,WPART)
      ENDIF

      IF(WPART.GT.0.) THEN
         CALL ELERES(WT1)
      ENDIF
cc      write(6,*) wpart,wt1
      WDIF=WPART*WT1*GEV2NB
      IF(WDIF.LE.0.D0.AND.IDEBUG.EQ.1) THEN
         write(6,*) ' DIR4 WPART,WT1 ',WPART,WT1
      ENDIF
      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.46.46  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      FUNCTION DLANGL(X,Y)
      IMPLICIT NONE
	Double Precision PI,DLANGL,R,X,Y
      PI = 4.D0*DATAN(1.D0)
      DLANGL=0.D0
      R=DSQRT(X**2+Y**2)
      IF(R.LT.1D-20) RETURN
      IF(DABS(X)/R.LT.0.8D0) THEN
         DLANGL=DSIGN(DACOS(X/R),Y)
      ELSE
         DLANGL=DASIN(Y/R)
         IF(X.LT.0.d0.AND.DLANGL.GE.0.d0) THEN
            DLANGL=PI-DLANGL
         ELSEIF(X.LT.0.) THEN
            DLANGL=-PI-DLANGL
         ENDIF
      ENDIF

      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.45.03  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      FUNCTION DOT(A,B)
      IMPLICIT NONE
C+++++++++++
C    DOT PRODUCT OF FOUR VECTOR IN MINKOWSKI METRIK
C+++++++++++
      Double Precision A(4),B(4),DOT
      DOT = A(4)*B(4)-A(1)*B(1)-A(2)*B(2)-A(3)*B(3)
      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.45.03  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94

      FUNCTION DOT1(I,J)
	IMPLICIT NONE
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
*KEEP,RGLUPARM.
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


*KEND.
      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      Double Precision DOT1
	INTEGER I,J
C+++++++++++
C    DOT PRODUCT OF FOUR VECTOR IN MINKOWSKI METRIK
C    WITH VECTORS FROM LUJETS
C+++++++++++
      DOT1= P(I,4)*P(J,4)-(P(I,1)*P(J,1))-(P(I,2)*P(J,2))-
     .     (P(I,3)*P(J,3))
      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.52.10  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
C*********************************************************************

      FUNCTION DPLU(I,J)
      IMPLICIT NONE
C...Purpose: to provide various real-valued event related data.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
*KEEP,RGLUPARM.
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


*KEND.
      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
	Double precision DLANGL,PSUM,DPLU,PR,PMR
	Integer I,J,I1,J1,LUCHGE
      EXTERNAL DLANGL,ULMASS,LUCHGE
C      SAVE

*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEND.
      SAVE /LUJETS/
      DIMENSION PSUM(4)
C...Set default value. For I = 0 sum of momenta or charges,
C...or invariant mass of system.
      DPLU=0.D0
      IF(I.LT.0.OR.I.GT.MSTU(4).OR.J.LE.0) THEN
      ELSEIF(I.EQ.0.AND.J.LE.4) THEN
         DO 10 I1=1,N
   10    IF(K(I1,1).GT.0.AND.K(I1,1).LE.10) DPLU=DPLU+P(I1,J)
      ELSEIF(I.EQ.0.AND.J.EQ.5) THEN
         DO 20 J1=1,4
            PSUM(J1)=0.D0
            DO 20 I1=1,N
   20    IF(K(I1,1).GT.0.AND.K(I1,1).LE.10) PSUM(J1)=PSUM(J1)+P(I1,J1)
         DPLU=DSQRT(DMAX1(0.D0, PSUM(4)**2-PSUM(1)**2-PSUM(2)**2-
     +   PSUM(3)**2))
      ELSEIF(I.EQ.0.AND.J.EQ.6) THEN
         DO 30 I1=1,N
   30    IF(K(I1,1).GT.0.AND.K(I1,1).LE.10) DPLU=DPLU+
     +   DBLE(LUCHGE(K(I1,2)))/3.D0
      ELSEIF(I.EQ.0) THEN

C...Direct readout of P matrix.
      ELSEIF(J.LE.5) THEN
         DPLU=P(I,J)

C...Charge, total momentum, transverse momentum, transverse mass.
      ELSEIF(J.LE.12) THEN
         IF(J.EQ.6) DPLU=DBLE(LUCHGE(K(I,2)))/3.D0
         IF(J.EQ.7.OR.J.EQ.8) DPLU=P(I,1)**2+P(I,2)**2+P(I,3)**2
         IF(J.EQ.9.OR.J.EQ.10) DPLU=P(I,1)**2+P(I,2)**2
         IF(J.EQ.11.OR.J.EQ.12) DPLU=P(I,5)**2+P(I,1)**2+P(I,2)**2
         IF(J.EQ.8.OR.J.EQ.10.OR.J.EQ.12) DPLU=DSQRT(DPLU)

C...Theta and phi angle in radians or degrees.
      ELSEIF(J.LE.16) THEN
         IF(J.LE.14) DPLU=DLANGL(P(I,3),DSQRT(P(I,1)**2+P(I,2)**2))
         IF(J.GE.15) DPLU=DLANGL(P(I,1),P(I,2))
         IF(J.EQ.14.OR.J.EQ.16) DPLU=DPLU*DBLE(180./PARU(1))

C...True rapidity, rapidity with pion mass, pseudorapidity.
      ELSEIF(J.LE.19) THEN
         PMR=0.D0
         IF(J.EQ.17) PMR=P(I,5)
         IF(J.EQ.18) PMR=DBLE(ULMASS(211))
         PR=DMAX1(1D-20,PMR**2+P(I,1)**2+P(I,2)**2)
         DPLU=SIGN(DLOG(DMIN1((DSQRT(PR+(P(I,3)**2)) +ABS(P(I,3))
     +   )/DSQRT(PR),1D20)),P(I,3))

C...Energy and momentum fractions (only to be used in CM frame).
      ELSEIF(J.LE.25) THEN
         IF(J.EQ.20) DPLU=2.D0*DSQRT(P(I,1)**2+P(I,2)**2+P(I,3)**2)/
     +   DBLE(PARU(21))
         IF(J.EQ.21) DPLU=2.D0*P(I,3)/DBLE(PARU(21))
         IF(J.EQ.22) DPLU=2.D0*DSQRT(P(I,1)**2+P(I,2)**2)/DBLE(PARU(21))
         IF(J.EQ.23) DPLU=2.D0*P(I,4)/DBLE(PARU(21))
         IF(J.EQ.24) DPLU=(P(I,4)+P(I,3))/DBLE(PARU(21))
         IF(J.EQ.25) DPLU=(P(I,4)-P(I,3))/DBLE(PARU(21))
      ENDIF

      RETURN
      END
*CMZ :  2.07/03 15/05/99  15.00.27  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE DU2ENT(NF1,KP1,KP2,ECM)
	IMPLICIT NONE
      INTEGER N,K
      REAL P,V
      DOUBLE PRECISION DP
*KEEP,RGLUPARM.
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


*KEND.
      COMMON/LUJETS/N,K(LUPAN,5),P(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/DP(LUPAN,5)
      REAL ECM
	INTEGER NF1,KP1,KP2,I,J
      DO 10 I=1,N
         DO 10 J=1,5
   10 P(I,J)= SNGL(DP(I,J))
      CALL LU2ENT(NF1,KP1,KP2,ECM)
      DO 20 I = 1,N
         DO 20 J=1,5
   20 DP(I,J) = DBLE(P(I,J))
      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.59.27  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE DUEDIT(MLIST)
	IMPLICIT NONE
      INTEGER N,K
      REAL P,V
      DOUBLE PRECISION DP
*KEEP,RGLUPARM.
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


*KEND.
      COMMON/LUJETS/N,K(LUPAN,5),P(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/DP(LUPAN,5)
	Integer MLIST,I,J
      DO 10 I=1,N
         DO 10 J=1,5
   10 P(I,J)= SNGL(DP(I,J))
      CALL LUEDIT(MLIST)
      DO 20 I=1,N
         DO 20 J=1,5
   20 DP(I,J)= DBLE(P(I,J))
      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.59.27  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE DULIST(MLIST)
	IMPLICIT NONE
      INTEGER N,K
      REAL P,V
      DOUBLE PRECISION DP
*KEEP,RGLUPARM.
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


*KEND.
      COMMON/LUJETS/N,K(LUPAN,5),P(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/DP(LUPAN,5)
	INTEGER MLIST,I,J
      DO 10 I=1,N
         DO 10 J=1,5
   10 P(I,J)= SNGL(DP(I,J))
      CALL LULIST(MLIST)
      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.59.27  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE DUPREP(MLIST)
      IMPLICIT NONE
      INTEGER N,K
      REAL P,V
      DOUBLE PRECISION DP
*KEEP,RGLUPARM.
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


*KEND.
      COMMON/LUJETS/N,K(LUPAN,5),P(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/DP(LUPAN,5)
	INTEGER MLIST,I,J
      DO 10 I=1,N
         DO 10 J=1,5
   10 P(I,J)= SNGL(DP(I,J))
      CALL LUPREP(MLIST)
      DO 20 I=1,N
         DO 20 J=1,5
   20 DP(I,J)= DBLE(P(I,J))
      RETURN
      END
*CMZ :  2.08/02 04/11/99  16.39.08  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  15.04.23  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
C*********************************************************************

      SUBROUTINE DUROBO(DTHE,DPHI,BEX,BEY,BEZ)

C...Purpose: to perform rotations and boosts.
      IMPLICIT NONE
      REAL SP,V
      DOUBLE PRECISION P
      Integer IMIN,IMAX,IMI,IMA,I,J
      Integer N,K
*KEEP,RGLUPARM.
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


*KEND.
      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEND.
      SAVE /LUJETS/
      double precision DROT,DPR,VR,DP,DV,DTHE,DPHI,BEX,BEY,BEZ
      double precision DBEX,DBEY,DBEZ
      double precision DBX,DBY,DBZ,DB,DGA,DBP,DGABP,DBV,DGABV
      DIMENSION DROT(3,3),DPR(3),VR(3),DP(4),DV(4)
      REAL SNGL
C...Find range of rotation/boost. Convert boost to double precision.
      IMIN=1
      IF(MSTU(1).GT.0) IMIN=MSTU(1)
      IMAX=N
      IF(MSTU(2).GT.0) IMAX=MSTU(2)
      DBX=BEX
      DBY=BEY
      DBZ=BEZ
      GOTO 20

C...Entry for specific range and double precision boost.
      ENTRY DUDBRB(IMI,IMA,DTHE,DPHI,DBEX,DBEY,DBEZ)
      IMIN=IMI
      IF(IMIN.LE.0) IMIN=1
      IMAX=IMA
      IF(IMAX.LE.0) IMAX=N
      DBX=DBEX
      DBY=DBEY
      DBZ=DBEZ

C...Optional resetting of V (when not set before.)
      IF(MSTU(33).NE.0) THEN
         DO 10 I=MIN(IMIN,MSTU(4)),MIN(IMAX,MSTU(4))
            DO 10 J=1,5
   10    V(I,J)=0.
         MSTU(33)=0
      ENDIF

C...Check range of rotation/boost.
   20 IF(IMIN.GT.MSTU(4).OR.IMAX.GT.MSTU(4)) THEN
         CALL LUERRM(11,'(DUROBO:) range outside LUJETS memory')
         RETURN
      ENDIF

C...Rotate, typically from z axis to direction (theta,phi).
      IF(DTHE**2+DPHI**2.GT.1D-20) THEN
         DROT(1,1)=DCOS(DTHE)*DCOS(DPHI)
         DROT(1,2)=-DSIN(DPHI)
         DROT(1,3)=DSIN(DTHE)*DCOS(DPHI)
         DROT(2,1)=DCOS(DTHE)*DSIN(DPHI)
         DROT(2,2)=DCOS(DPHI)
         DROT(2,3)=DSIN(DTHE)*DSIN(DPHI)
         DROT(3,1)=-DSIN(DTHE)
         DROT(3,2)=0.D0
         DROT(3,3)=DCOS(DTHE)
         DO 50 I=IMIN,IMAX
            IF(K(I,1).LE.0) GOTO 50
            DO 30 J=1,3
               DPR(J)=P(I,J)
   30       VR(J)=DBLE(V(I,J))
            DO 40 J=1,3
               P(I,J)=DROT(J,1)*DPR(1)+DROT(J,2)*DPR(2)+DROT(J,3)*
     +         DPR(3)
   40       V(I,J)=
     +      SNGL(DROT(J,1)*VR(1)+DROT(J,2)*VR(2)+DROT(J,3)*VR(3))
   50    CONTINUE
      ENDIF

C...Boost, typically from rest to momentum/energy=beta.
      IF(DBX**2+DBY**2+DBZ**2.GT.1E-20) THEN
         DB=DSQRT(DBX**2+DBY**2+DBZ**2)
         IF(DB.GT.0.99999999D0) THEN
C...Rescale boost vector if too close to unity.
            CALL LUERRM(3,'(DUROBO:) boost vector too large')
            call dulist(1)
            DBX=DBX*(0.99999999D0/DB)
            DBY=DBY*(0.99999999D0/DB)
            DBZ=DBZ*(0.99999999D0/DB)
            DB=0.99999999D0
         ENDIF
         DGA=1D0/DSQRT(1D0-DB**2)
         DO 70 I=IMIN,IMAX
            IF(K(I,1).LE.0) GOTO 70
            DO 60 J=1,4
               DP(J)=P(I,J)
   60       DV(J)=DBLE(V(I,J))
            DBP=DBX*DP(1)+DBY*DP(2)+DBZ*DP(3)
            DGABP=DGA*(DGA*DBP/(1D0+DGA)+DP(4))
            P(I,1)=DP(1)+DGABP*DBX
            P(I,2)=DP(2)+DGABP*DBY
            P(I,3)=DP(3)+DGABP*DBZ
            P(I,4)=DGA*(DP(4)+DBP)
            DBV=DBX*DV(1)+DBY*DV(2)+DBZ*DV(3)
            DGABV=DGA*(DGA*DBV/(1D0+DGA)+DV(4))
            V(I,1)=SNGL(DV(1)+DGABV*DBX)
            V(I,2)=SNGL(DV(2)+DGABV*DBY)
            V(I,3)=SNGL(DV(3)+DGABV*DBZ)
            V(I,4)=SNGL(DGA*(DV(4)+DBV))
   70    CONTINUE
      ENDIF

      RETURN
      END
*CMZ :  2.07/03 15/05/99  14.59.27  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE DUSHOW(I1,I2,QMAX)
	IMPLICIT NONE
      INTEGER N,K
      REAL P,V,QMAX
      DOUBLE PRECISION DP
*KEEP,RGLUPARM.
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


*KEND.
      COMMON/LUJETS/N,K(LUPAN,5),P(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/DP(LUPAN,5)
	INTEGER I1,I2,I,J
	
      DO 10 I=1,N
         DO 10 J=1,5
   10 P(I,J)= SNGL(DP(I,J))
      CALL LUSHOW(I1,I2,QMAX)
      DO 20 I=1,N
         DO 20 J=1,5
   20 DP(I,J)= DBLE(P(I,J))
      RETURN
      END
*CMZ :  2.08/00 06/06/99  15.49.36  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  18.23.37  by  Hannes Jung
*-- Author :    Hannes Jung   18/04/95
      SUBROUTINE ELEQCDC(WT1)
C    QCD Compton
C    PHOTON q ----> Q gluon
C
C         P1(q)-----//////--------Q1(q)
C                  ////////
C         P2(PH)-----//////--------Q2(gluon)
C
C
C
C
C for light quarks without masses
c changed for including Q2 of photon
C
      IMPLICIT NONE
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEND.
      Double Precision P2E(4),P3E(4),Q1E(4),Q2E(4)
      Double Precision SPHI,PHIT
	Double Precision ALPHAS,ALPHA_S,ALPH_EM,DOT,SH,TH,UH
	Double Precision SUMT,SUML,Y,XP,ZQ,EPSILON,WT1,GF,SIG0t,SIG0s
	Double Precision Sigi,cos2p,cosp,sig1,sig2,sig0,sig
	Integer I,IPHIDEP
      REAL SNGL
      IPHIDEP=1
C.....MARTIX ELEMENT
c      write(6,*) 'here in new eleqcdc '
      ALPHA_S=ALPHAS(DSQRT(Q2Q))
      ALPH_EM = ALPH
      IF(IRUNAEM.EQ.1) ALPH_EM = DBLE(ULALEM(SNGL(Q2)))
      IF(IPHIDEP.EQ.0) THEN
         IF(INTER.EQ.2) THEN
            write(6,*) ' INTER = 2 not implemented'
            STOP
         ENDIF
         DO 10 I=1,4
            P2E(I) = P(NIA2,I)
            Q1E(I) = P(NF1,I)
            Q2E(I) = P(NF2,I)
   10    CONTINUE
         SH = 2.D0 * DOT(Q1E,Q2E)
         TH = - 2.D0 * DOT(P2E,Q2E)
         UH = - 2.D0 * DOT(P2E,Q1E)

c for transverse photons
         SUMT = 16.D0*8.D0/3.D0*PI*PI*(-TH/SH - SH/TH + 2.D0*UH*Q2/SH/
     +   TH - 2.D0*UH*Q2/(SH+Q2)**2)
c for longitudinal photons
         SUML = 16.D0*32.D0/3.D0*PI*PI*Q2*(Q2+SH+TH)/(SH+Q2)**2
         IF(SUMT.LE.0.0D0.OR.SUML.LT.0.0D0) THEN
            write(6,*) ' eleqcdc ',TH,SH,UH
            write(6,*) ' eleqcdc ',SUMT,SUML
         endif
c         write(6,*) ' eleqcdc SUMT,SUML',SUMT,SUML
c epsilon
         Y = DBLE(YY)
         EPSILON = (1.D0 - Y)/(1.D0 - Y + Y**2 /2)

         WT1= ALPHA_S*ALPH_EM*(SUMT + EPSILON * SUML)
         IF(WT1.LE.0.D0) THEN
            write(6,*) ' eleqcdc ',WT1,EPSILON
            write(6,*) ' eleqcdc ',TH,SH,UH
            write(6,*) ' eleqcdc ',SUMT,SUML
         endif
      ELSEIF(IPHIDEP.EQ.1) THEN
         DO 20 I=1,4
            P2E(I) = p(nia1,I)
            P3E(I) = p(nia2,I)
            Q1E(I) = P(NF1,I)
            Q2E(I) = P(NF2,I)
   20    continue
         y = DBLE(YY)
         SH = 2.D0 * DOT(Q1E,Q2E)
         TH = - 2.D0 * DOT(P3E,Q2E)
         UH = - 2.D0 * DOT(P3E,Q1E)
         xp = Q2/(SH+Q2)
         zq = DOT(P3E,Q1E)/DOT(P3E,P2E)
         zq = 2.D0*DOT(P3E,Q1E)/(SH+Q2)
         WT1=0.d0
c         if(y.ge.1.) write(6,*) ' y = ',y
         SPHI = DLANGL(P(1,1),P(1,2))
         call DUDBRB(0,0,0.D0,-sphi,0.d0,0.d0,0.d0)
         phit = DLANGL(P(NF1,1),P(NF1,2))
c      phitt = raphi(1,nia2,nf1)
c     write(6,*) 'eleqqf  phitt,phit ',phittt,phitt,phit
         call DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
         cosp = cos(phit)
         cos2p = cos(2.D0*phit)
c fill MEINFO
         ZQGKI = SNGL(zq)
         XPGKI = SNGL(xp)
         if(phit.ge.0.0) then
            PHITGKI = SNGL(PHIT)
         else
            PHITGKI = SNGL(2.D0*PI+PHIT)
         endif
c...........
         sig0t = 2.D0*ALPHA_S/3.D0/pi*((zq**2+xp**2)/
     +    (1.D0-xp)/(1.D0-zq) +
     +   2.D0*(xp*zq+1.D0))
         sig0s = 2.D0*ALPHA_S/3.D0/pi*4.D0*xp*zq
         sigi = 0.D0
         IF(INTER.EQ.2) THEN
            sigi = 2.D0*ALPHA_S/3.D0/pi*((zq**2+xp**2)/ (1.D0-xp)/
     +      (1.D0-zq) + 2.D0*(xp+zq))
         ENDIF

c      write(6,*) ' new sig_t ',sig0t*64*alph_em*pi**3/alph_em/alpha_s
c      write(6,*) ' new sig_l ',sig0s*64*alph_em*pi**3/alph_em/alpha_s

         sig1 = 4.D0*ALPHA_S/3.D0/pi*y*
     +    DSQRT(((1.D0-y)*xp*zq)/(1.D0-xp)/(1.D0-zq))
         sig1 = sig1*((1.D0-2.D0/y)*(1.D0-zq-xp+2.D0*xp*zq))
         sig2 = 4.D0*ALPHA_S/3.D0/pi*((1.D0-y)*xp*zq)
         sig0 = 0.5D0*(1.D0+(1.D0-y)**2)*sig0t + (1.D0-y)*sig0s
     +          +ISIGN(1,K(1,2))*y*(1.d0-0.5d0*y)*sigi
         sig = sig0+ cosp * sig1 + cos2p * sig2
c include 64/pi*alph*pi**3 to compare with s_hat expression and
c integration over angles
         IF(INTER.LT.2) THEN
            wt1 = alph_em**2 /pi/Q2/y * sig *64.D0*pi**3
         ELSEIF(INTER.EQ.2) THEN
            GF = PI*ALPH_EM/(SIN2W*XMW2*DSQRT(2.D0))
ccc            wt1 = GF**2/pi/Q2/y * sig *64.D0*pi**3
            wt1 = GF**2 *Q2/y * 8.D0 * sig
c is that really correct ????? to be checked
            wt1 = wt1 /(1.D0 + Q2/XMW2)**2
         ENDIF
c      write(6,*) 'eleqcdc:',zq,xp,yy,sig,alph_em,pi
      ENDIF
      RETURN
      END
*CMZ :  2.08/00 14/06/99  19.13.55  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  18.29.44  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE ELEQQB(WT1)
      IMPLICIT NONE
C
C    PHOTON GLUON ----> Q Q_BAR
C
C         P1(G)-----//////--------Q1(C)
C                  ////////
C         P2(PH)-----//////--------Q2(CBAR)
C
C
C  ( EICHLER KUNSZT ETH-PT/88-1 SOME PROBLEMS WITH AVERAGED SPIN
C  ( AND COLOUR
C  ( USE ELLIS KUNSZT CALCULATION IN NUCL PHYS. B303 (1988) 653
C  (
C

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEND.
      Double Precision ALPHAS,ALPHA_S,QF,SH,TH,UH,V1,V2,SUM2
      Double Precision ALPH_EM,WT1
      INTEGER LUCHGE
      IF(INTER.EQ.2) THEN
         write(6,*) ' INTER = 2 not implemented for eleqqb'
         STOP
      ENDIF
      QF=DFLOAT(LUCHGE(KPA))/3.D0
      ALPHA_S=ALPHAS(DSQRT(Q2Q))
      SH = 2.D0 * AM(1)**2 + 2.D0 * DOT1(NF1,NF2)
      TH = AM(1)**2 - 2.D0 * DOT1(NIA1,NF1) - P(NIA1,5)**2
      UH = AM(2)**2 - 2.D0 * DOT1(NIA1,NF2) - P(NIA1,5)**2
c      write(6,*) ' ELEQQB ',QG2
C.....MARTIX ELEMENT
      V1 = AM(1)**2 - TH
      V2 = AM(1)**2 - UH
      SUM2 = V1/V2 + V2/V1 + 4.D0*AM(1)**2 *SH/V1/V2 -4.D0*AM(1)**4
     +*SH*SH/V1/V1/V2/V2
c      write(6,*) ' old sum2 : ',sum2
c      write(6,*) ' sss ',sss
cccccccccccccc         SUM2 = SUM2/QG2**2

      ALPH_EM = ALPH
      IF(IRUNAEM.EQ.1) ALPH_EM = DBLE(ULALEM(SNGL(Q2)))

      SUM2 = SUM2*16.D0*PI*PI*ALPHA_S*ALPH_EM*QF*QF
      WT1=SUM2
      RETURN
      END
*CMZ :  2.08/00 06/06/99  15.53.20  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  18.47.29  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE ELEQQF(WT1)
C
C    PHOTON GLUON ----> Q Q_BAR
C
C         P1(G)-----//////--------Q1(q)
C                  ////////
C         P2(PH)-----//////--------Q2(q_bar)
C
C    full martix element G.Schuler
C    e g --> e' q q_bar
C
C    Notation: p = P3E
C              q = P2E
C              l = P1E
C              pf = Q1E
C              pf' = Q2E
C              sh = s_hat = gamma glu CM energy
C              sg = e glu CM energy
C              x = Q2/(2P.q)
C              xg = Q2/(2p.q)
C              y = p.q/p.l
C              z = p.pf/p.q
C              |M|**2 = g**2 * eq**2/Q**4 *sum gf L_munu *H^munu
      IMPLICIT NONE
*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEND.
      Double Precision P0E(4),P2E(4),P3E(4),Q1E(4)
      Double Precision G1(2),G2(2),GA(2),GB(2)
      Double Precision gff(4)
	Double Precision Vff,QF2
      Double Precision SPHI,phit,mf,mfp
      Double Precision ksiw,raphi,wt1,y,sg,sum,xg,m2plus,m2minus,m0
	Double Precision z,cosp,cos2p,f,g
	Double Precision H11,H12,H21,H22,H41,H14,H24,H34,H61
	Double Precision G3,GC,deltal,rho
	Double Precision ALPHA_S,ALPH_EM,DOT,ALPHAS
	Integer Luchge,I
	Double Precision Wmax
	Integer IMIX,IGENFL
      COMMON /OALPHAS/ WMAX,IMIX
      COMMON/GENWEI/IGENFL
      REAL SNGL
      external raphi
      IF(INTER.LT.2) THEN
c charge for charm
         IF(IPRO.EQ.14) THEN
            IF(AM(1).LT.2.D0) QF2 = 4.D0/9.D0
            IF(AM(1).GE.2.D0) QF2 = 1.D0/9.D0
c         write(6,*) ' ELEQQF IPRO=14',QF2
         ELSEIF(IGENFL.EQ.1) THEN
            QF2 = DFLOAT(LUCHGE(KPA))**2/9.D0
c         write(6,*) ' ELEQQF IGENFL=1 KPA ',KPA,QF2

         ELSE
c sum of charges for u d s = (2/3)**2 + (1/3)**2 + (1/3)**2 = 6/9 = 2/3
            QF2=2.D0/3.D0
c         write(6,*) ' ELEQQF SONST KPA ',KPA,QF2
         ENDIF
      ELSEIF(INTER.EQ.2) THEN
c charge for charm
         IF(IPRO.EQ.14) THEN
            Vff = 1.D0
         ELSEIF(IGENFL.EQ.1) THEN
            Vff = 1.D0
         ELSE
c sum of charges for u d s = 3
            Vff=3.D0
c         write(6,*) ' ELEQQF SONST KPA ',KPA,QF2
         ENDIF
      ENDIF
      WT1 = 0.0D0
   10 CONTINUE
      if(IPRO.EQ.13) THEN
         AM(1) = 0.D0
         AM(2) = 0.D0
      ENDIF
      mf = AM(1)
      mfp = AM(2)
c         write(6,*) 'masses ',mf,mfp,ipro
c
c      IF(IPRO.EQ.14) THEN
c         write(6,*) 'masses ',mf,mfp
c         write(6,*) ' charge ',DSQRT(QF2)
c         ENDIF
      DO 20 I=1,4
         P0E(I) = P(1,I)
         P2E(I) = p(nia1,I)
         P3E(I) = p(nia2,i)
         Q1E(I) = P(NF1,I)
   20 continue
      y = DBLE(YY)
c      sgp = DBLE(XPR)*SSS
c check for pomeron_gluon
      sg= 2.D0*DOT(P0E,P3E)
c      call DULIST(1)
c      xgp = Q2/y/sgp
      XG = Q2/2.D0/DOT(P2E,P3E)
c      write(6,*) ' eleqqf: sg",sg,xg",xg ',sgp,sg,xgp,xg
      m2plus = (mf**2 + mfp**2)/y/sg
      m2minus = (mf**2 - mfp**2)/y/sg
      m0      = mf*mfp/y/sg
      z = DOT(P3E,Q1E)/DOT(P3E,P2E)
ctest
c      ZQMIN = 0.5D0 - DSQRT(0.25D0 - PT2CUT(IPRO)*XG/Q2/(1.D0-XG))
c      write(6,*) ' eleqqf: zqmin,z ',zqmin,z,pt2cut(ipro)
c      SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
c      CHIMIN=(SMIN+Q2)/(Y*SSS)
c      CHIMIN = DMAX1(CHIMIN,Q2/Y/SSS)
c      x = q2/y/sss
c      XPMIN = X
c      XPMAX = X/CHIMIN
c      write(6,*) y,sss,q2,chimin,x
c      write(6,*) 'eleqqf xpmax,xpmin,xp ',xpmax,xpmin,xg
ctest
c      write(6,*) ' eleqqf z',z,nia1,nia2,nf1,nf2
ctest      if(y.ge.1.) write(6,*) ' y = ',y
      SPHI = DLANGL(P(1,1),P(1,2))
c     if(igenfl.eq.1) then
c      call dulist(1)
c      endif
      call DUDBRB(0,0,0.D0,-sphi,0.d0,0.d0,0.d0)
      phit =  DLANGL(P(NF1,1),P(NF1,2))
c     if(igenfl.eq.1) then
c      call dulist(1)
c      write(6,*) ' phi ',phit
c      endif
c      phitt = raphi(1,nia2,nf1)
c     write(6,*) 'eleqqf  phit ',phit
      call DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
c we are in a system with g(p) in - z and gamma in + z
c therefore -cos(phit)
      cosp = DBLE(-cos(phit))
      cos2p = DBLE(cos(2.D0*phit))
c fill MEINFO
      XPGKI = sngl(xg)
      ZQGKI = sngl(z)
      if(phit.ge.0.0) then
         PHITGKI = SNGL(PHIT)
      else
         PHITGKI = SNGL(2.D0*PI+PHIT)
      endif

c............
      f = (1.D0-xg)*z*(1.D0-z) + (z*(mf**2 - mfp**2) - mf**2)/y/sg
      g = (1.D0-xg)*(1.D0-z) + xg*z + m2minus
      if(f*xg.le.0.) then
c         write(6,*) 'eleqqf f,xg,f*xg,z',f,xg,f*xg,z,mf**2/y/sg
c         write(6,*) 'eleqqf (1.D0-xg)*z*(1.D0-z)',(1.D0-xg)*z*(1.D0-z)
c         write(6,*) 'eleqqf mf**2/y/sg',mf**2/y/sg
         return
      endif
      H11 = 4.D0/z/(1.D0-z)*(2.D0*z*(1.D0-z) + 2.D0*xg*(1.D0-xg) -1.D0)
     +    + 4.D0/z**2/(1.D0-z)**2 *(-m2plus**2 + m2plus*m2minus*
     +      (2.D0*z-1.D0) + m2plus*(2.D0*z*(z-1.D0)*(xg-1.D0) -xg) +
     +        m2minus*xg*(2.D0*z-1.D0))
      H21 = 16.D0*(xg/z/(1.D0-z) + (m2plus +
     + (1.D0-z)*m2minus)/z**2/(1D0-z))
      H41 = 32D0*xg/z/(1.D0-z) + 16.D0/z**2/(1.D0-z)**2 *
     +      (m2plus + (1.D0-2.D0*z)*m2minus)
      H61 = - 32.D0*xg/z/(1.D0-z) - 32.D0/z**2/(1.D0-z) *
     +      (m2plus + (1.D0-z)*m2minus)
      H12 = - 16D0* m0 *(1.D0-xg)/z/(1.D0-z) +
     +       8.D0*m0/z**2/(1.D0-z)**2 *
     +      (m2plus + (1.D0-2.D0*z)*m2minus)
      H22 = - 32.D0*m0/z/(1.D0-z)
      H14 = - 8.D0/z**2/(1.D0-z)*(-z**2+z*xg+m2plus+(1.D0-z)*m2minus)
      H24 = 0.D0
      H34 = 8.D0*(1.D0-2.D0*xg)/z/(1.D0-z) -
     +      8.D0*(m2plus+(1.D0-2.D0*z)*m2minus)/z**2/(1.D0-z)**2
      G1(1) = -2.D0*H11 + f*H41
      G2(1) = 2.D0*xg*f*H41 + H21 + g*(H61 + g * H41)
      GA(1) = DSQRT(xg*f) * (H61 + 2.D0*g*H41)
      GB(1) = f * H41
      G1(2) = - 2.D0* H12
      G2(2) = H22
      GA(2) = 0.d0
      GB(2) = 0.d0
      G3 = H14 + z*H24 -g*H34
      GC = DSQRT(xg*f)*(H24 - 2.D0*xg*H34)
      IF(INTER.EQ.0) THEN
         gff(1) = QF2
         gff(2) = QF2
         gff(4) = 0.D0
         deltal = 0.5d0
      ELSEIF(INTER.EQ.2) THEN
         ksiw = 1.D0/(SIN2W*8.D0)*Q2**2/XMW2**2/(1.D0 + Q2/XMW2)**2
         rho = 0.d0
         gff(1) = 4.D0*Vff**2*ksiw**2*(1.D0-ISIGN(1,K(1,2))*rho)
         gff(2) = 0.d0
         gff(4) = 4.D0*Vff**2*ksiw**2*(ISIGN(1,K(1,2)) - rho)
         deltal = 1.d0
      ENDIF
      SUM = gff(1)*(xg*y**2*G1(1) + (1.D0 - y)*G2(1) +(2.D0-y)*
     +DSQRT(1.D0-y)* cosp*GA(1) + 2.D0*xg*(1.D0-y)*cos2p*GB(1)) +gff(2)
     +*(xg*y**2*G1(2) + (1.D0 - y)*G2(2)) +gff(4)*(xg*y*(2.D0-y)*G3+
     +2.D0*y*DSQRT(1.d0-y)*cosp*GC)

C.....MARTIX ELEMENT
      ALPHA_S=ALPHAS(DSQRT(Q2Q))
C this is for z,phi integrated and full differential
      ALPH_EM = ALPH
      IF(IRUNAEM.EQ.1) ALPH_EM = DBLE(ULALEM(SNGL(Q2)))
c       write(6,*) 'elleqqf ',alpha_s,SUM,qf2,y,q2,alph_em,irunaem
c      write(6,*) ' sum,alpha_s,q2q ',sum,alpha_s,q2q
      SUM = SUM *ALPHA_S* deltal*2.D0*ALPH_EM**2
      SUM = SUM / 16.D0 / y /Q2**2
c this is correction for 2 body phase space
      SUM = SUM*2.D0/pi
      WT1=SUM
c      write(6,*) WT1,ksiw
      RETURN
      END
*CMZ :  2.07/03 15/05/99  18.51.46  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE ELEQQL(WT1)
C
C    PHOTON GLUON ----> Q Q_BAR
C
C         P1(G)-----//////--------Q1(q)
C                  ////////
C         P2(PH)-----//////--------Q2(q_bar)
C
C
C
C
C for light quarks without masses
c changed for including Q2 of photon
C
      IMPLICIT NONE
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEND.
      Double Precision WMAX
	Integer IMIX
      COMMON /OALPHAS/ WMAX,IMIX
      Double Precision P2E(4),Q1E(4),Q2E(4)
	Double Precision ALPHA_S,ALPHAS,ALPH_EM,SH,TH,UH,QF2
	Double Precision SUMT,SUML,EPSILON,YX,WT1,DOT
	Integer I,LUCHGE
      REAL SNGL
      IF(INTER.EQ.2) THEN
         write(6,*) ' interaction INTER = 2 not implemented '
         STOP
      ENDIF
      DO 10  I=1,4
         P2E(I) = P(NIA2,I)
         Q1E(I) = P(NF1,I)
         Q2E(I) = P(NF2,I)
   10 CONTINUE
   20 CONTINUE
C.....MARTIX ELEMENT
      ALPHA_S=ALPHAS(DSQRT(Q2Q))
      SH =  2.D0 * DOT(Q1E,Q2E)
      TH = - 2.D0 * DOT(P2E,Q2E)
      UH = - 2.D0 * DOT(P2E,Q1E)
c sum of charges for u d s (2/3)**2 + (1/3)**2 + (1/3)**2 = 6/9 = 2/3
      QF2=2.D0/3.D0
      IF(IMIX.EQ.1) QF2 = DFLOAT(LUCHGE(KPA))**2/9.D0
c for transverse photons
      SUMT = 16.D0*PI*PI*(UH/TH + TH/UH
     +        - 2.D0*SH*Q2/UH/TH
     +        + 4.D0*SH*Q2/(SH+Q2)**2)
c for longitudinal photons
      SUML = -16.D0*8.D0*PI*PI*Q2*(Q2+TH+UH)/(SH+Q2)**2
      IF(SUMT.LE.0.0D0.OR.SUML.LT.0.0D0) THEN
         write(6,*) ' eleqql ',TH,SH,UH
         write(6,*) ' eleqql ',SUMT,SUML
      endif

c epsilon
      YX = DBLE(YY)
      EPSILON = (1.D0 - YX)/(1.D0 - YX + YX**2 /2)
      ALPH_EM = ALPH
      IF(IRUNAEM.EQ.1) ALPH_EM = DBLE(ULALEM(SNGL(Q2)))

      WT1 = ALPHA_S*ALPH_EM*QF2*(SUMT + EPSILON * SUML)
      IF(WT1.LE.0.D0) THEN
         write(6,*) ' eleqql ',WT1,EPSILON
         write(6,*) ' eleqql ',TH,SH,UH
         write(6,*) ' eleqql ',SUMT,SUML
      endif

      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.23  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  15.59.10  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  19.15.01  by  Hannes Jung
*-- Author :    Hannes Jung   02/03/97
      SUBROUTINE ELERES(WT1)
C
C     Matrix elements for resolved photon processes
C     gg --> qq_bar
C     g + g --> g + g
C     g + q --> g + q
C     qq_bar --> gg
C     q + q_bar --> q + q_bar
C     qq --> qq
C
C
      IMPLICIT NONE
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGLUDAT2.
      REAL PMAS,PARF,VCKM
      INTEGER KCHG
      COMMON/LUDAT2/KCHG(500,3),PMAS(500,4),PARF(2000),VCKM(4,4)
C      SAVE

*KEEP,RGSTRU.
      REAL SCAL1,XPD1,SCAL2,XPD2
      COMMON/STRU/ SCAL1,XPD1,SCAL2,XPD2
C     SAVE
*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
	Integer ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
	Integer IDEBUG
      COMMON /COLCON/ ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      COMMON/ INTERN/IDEBUG

	Integer IRFUL
      REAL XPQ(-6:6),XGQ(-6:6)
      REAL XGQ1,XPQ2,XGAM,XPRO,XGQ1_HF,XPQ2_HF
      REAL SNGL
c IRFUL=1 using full ME's
c IRFUL=0 using ME's from Bengtsson
      PARAMETER (IRFUL=0)
      DOUBLE PRECISION ZETA3
C---ZETA3=RIEMANN ZETA FUNCTION(3)
      PARAMETER (ZETA3=1.202056903159594D0)
C---paramtric fit to the function used in the Bartels/Forshaw/et al.
calculation
	Double Precision wt1,ALPHA_S,ALPHAS,SH,UH,TH,VTH,VUH
	Double Precision SUMA,SUMB,SUMC,SUMC1,SUMC1T,SUMD,SUMD1,SUMD2
	Double Precision SUMF,SUME,SUME1,SUME2,SUMTE
	Double Precision SUMTF,SUMF1,SUMF2,SUMG,SUMG1,SUTO,SUM2
	Double Precision A1,A2,A3,ASUM,FLSUM,FLRN
	Double Precision QTOT,QSUM,CF,CA,yh,omeg0,delta
	Double Precision RNTEST
	Integer I,NFG,NFLG,NFLP,NFLT,NFLTG,NFLTP,NFLTPC,KPF
	Double Precision draprn
      DOUBLE PRECISION alphasf,gmass
      PARAMETER (alphasf=0.23D0)
      PARAMETER (gmass=.8D0)
      wt1 = 0.d0
      ALPHA_S=ALPHAS(DSQRT(Q2Q))
      if(xpr.GT.1.d0) write(6,*) ' eleres xp2>1',xpr,ipro
      IF(IDIR.EQ.1) THEN
         XPRO = XPR
      ELSE
         XPRO = XPR/XFGKI
      ENDIF
      if(xpro.ge.0.999) return
      CALL PYSTFU(KINT(2,2),XPRO,SNGL(Q2Q),XPQ)
c call virtual photon structure function
      XGAM = XEL/YY
      if(xgam.gt.1.0) then
         write(6,*) ' eleres xpr,x_gam,yy',xpr,xgam,yy,q2q,q2
      endif
      if(xgam.gt.0.999) return
      CALL RYSTGA(XGAM,SNGL(Q2Q),SNGL(Q2),XGQ)
      if(xgq(0).ne.xgq(0)) then
         write(6,*) ' eleres x_gam,Q2Q,Q2,xgq(0)',xgam,q2q,q2,xgq(0)
      endif
c      write(6,*) ' eleres ',xgq
      XPQ2 = 0.
      XGQ1 = 0.
      DO 10 I=1,NFLAV
         XPQ2 = XPQ2+XPQ(I) + XPQ(-I)
         XGQ1 = XGQ1+XGQ(I) + XGQ(-I)
   10 CONTINUE
      IF(IHFLA.GE.4) THEN
         XPQ2_HF = XPQ(IHFLA) + XPQ(-IHFLA)
         XGQ1_HF = XGQ(IHFLA) + XGQ(-IHFLA)
      ENDIF
      SH = 2.D0 * AM(1)**2 + 2.D0 * DOT1(NF1,NF2)
      TH = AM(1)**2 - 2.D0 * DOT1(NIA1,NF1) + dot1(nia1,nia1)
      UH = AM(2)**2 - 2.D0 * DOT1(NIA1,NF2) + dot1(nia1,nia1)
      VTH = - 2.D0 * DOT1(NIA1,NF1)
      VUH = - 2.D0 * DOT1(NIA1,NF2)
      SUMA = 0.D0
      SUMB = 0.D0
      SUMC = 0.D0
      SUMD = 0.D0
      SUME = 0.D0
      SUMF = 0.D0
      SUMG = 0.D0
      IF(IRPA.NE.0) THEN
         IF(IHFLA.LT.4) THEN
C.....MATRIX ELEMENT for gg --> qq_barp(466)
            IF(IRFUL.EQ.1) THEN
               SUMA = 2.d0*th*uh/th**2/12.d0 + 2.d0*th*uh/uh**2/12.d0 -
     +         3.d0/16.d0*4.d0*(1.d0 -uh*th/sh**2) + 3.d0/32.d0*4.d0
            ELSE
c this was from bengtsson
               SUMA = uh/th -2.d0*uh**2/sh**2 + th/uh - 2.d0*th**2/sh**
     +         2
               SUMA = SUMA/6.d0
            ENDIF
c include sum over NFG flavors and parton densities
            NFG = 3
c         IF(SH.GT.4.D0*DBLE(PMAS(4,1)**2)) NFG = 4
c         IF(SH.GT.4.D0*DBLE(PMAS(5,1)**2)) NFG = 5

            SUMA = SUMA * DFLOAT(NFG) * DBLE(XGQ(0)) * DBLE(XPQ(0))
         ELSEIF(IHFLA.GE.4) THEN
c heavy flavour gg --> QQ_bar
            SUMA = (32.D0/vth/vuh - 8d0*9D0/sh**2)*
     +   (vth**2/4d0 + vuh**2/4d0 + AM(1)**2*sh - AM(1)**2*sh/vth/vuh)
            SUMA = SUMA/16d0/3d0
            SUMA = SUMA  * DBLE(XGQ(0)) * DBLE(XPQ(0))
         ENDIF
      ENDIF
      IF(IRPB.NE.0) THEN
         IF(IRFUL.EQ.1) THEN
C.....MATRIX ELEMENT for gg --> gg
            SUMB = 9.d0/8.d0*(17.d0/2.d0 - 4.d0*uh*sh/th**2 + 17.d0/
     +      2.d0 - 4.d0*sh*th/uh**2 + 17.d0/2.d0 - 4.d0*uh*th/sh**2 +
     +      27.d0) + 9.d0/16.d0*(15.d0 - sh**2/th/uh + 15.d0 - uh**2/
     +      th/sh - 15.d0 + th**2/sh/uh) - 3.d0*9.d0/8.d0*81.d0/4.d0
         ELSE
c this is from bengtsson
            SUMB = 9.d0/4.d0*( sh**2/th**2+2.d0*sh/th+3.d0+2.d0*th/sh+
     +      th** 2/sh**2 +uh**2/sh**2+2.d0*uh/sh+3.d0+2.d0*sh/uh+sh**2/
     +      uh**2 +th**2/uh**2+2.d0*th/uh+3.d0+2.d0*uh/th+uh**2/th**2 )
     +      * 0.5d0
ccc         write(6,*) sumb,xgq(0),xpq(0),uh,th,sh
         ENDIF
         SUMB = SUMB * DBLE(XGQ(0)) * DBLE(XPQ(0))

      ENDIF
      IF(IRPC.NE.0) THEN
C.....MATRIX ELEMENT for qg --> qg
         IF(IRFUL.EQ.1) THEN
            SUMC1 = 2.d0*(1.d0-uh*sh/th**2)-4.d0/9.d0*(sh/uh+uh/sh)-
     +      1.d0
c  this was from bengtsson
         ELSE
            SUMC1 = 4.d0/9.d0*(2.d0*uh**2/th**2-uh/sh+2.d0*sh**2/th**2-
     +      sh/ uh)
         ENDIF
         sumc1t = SUMC1 *(DBLE(XGQ1) * DBLE(XPQ(0)))
c      write(6,*) xgq1,xgg1,xpq2,xpg2
         SUMC = SUMC1 *(DBLE(XGQ1)*DBLE(XPQ(0))+DBLE(XGQ(0))*DBLE(XPQ2)
     +   )
         IF(IHFLA.GE.4) THEN
            SUMC=0.D0
            IF(sh.ge.4.*ULMASS(IHFLA)) THEN
               SUMC = SUMC1* (DBLE(XGQ1_HF)*DBLE(XPQ(0))+DBLE(XGQ(0))*
     +         DBLE(XPQ2_HF))
            ENDIF
         ENDIF
      ENDIF
      IF(IRPD.NE.0) THEN
C.....MATRIX ELEMENT for qq_bar --> gg
         IF(IRFUL.EQ.1) THEN
            SUMD1 = 16.d0/27.d0*2.d0*uh/th + 16.d0/27.d0*2d0*th/uh
     +      -4.d0/3.d0*4.d0*(1.d0-uh*th/sh**2) +2.d0/3.d0*4.d0
            SUMD2 = 0.D0
         ELSE
            SUMD1 =32.d0/27.d0*(uh/th-2.d0*uh**2/sh**2)
            SUMD2 =32.d0/27.d0*(th/uh-2.d0*th**2/sh**2)
         ENDIF
c
         SUMD = (SUMD1+SUMD2) * DBLE(XGQ(1)*XPQ(-1)+ XGQ(2)*XPQ(-2)+
     +   XGQ(3)*XPQ(-3)+ XGQ(4)*XPQ(-4)+ XGQ(-1)*XPQ(1)+ XGQ(-2)*XPQ(2)
     +   + XGQ(-3)*XPQ(3)+ XGQ(-4)*XPQ(4))
      ENDIF
      IF(IRPE.NE.0) THEN
C.....MATRIX ELEMENT for qq_bar --> qq_bar

         IF(IHFLA.LT.4) THEN

            SUME1 = 4.d0/9.d0*(sh**2 + uh**2)/th**2
            SUME2 = 4.d0/9.d0*(th**2 + uh**2)/sh**2
         ELSEIF(IHFLA.GE.4) THEN
c heavy flavour qq --> QQ_bar
            SUME1 = 0.D0
            SUME2=4.d0/9.d0*
     +      ((vth**2 + vuh**2)/sh**2 + 4d0*AM(1)**2/sh**2)
         ENDIF
c
c first take t channel: q_i + q_bar_j --> q_i + q_bar_j
         SUME1 = SUME1 * (DBLE(XGQ(1))*DBLE(XPQ(-4)+XPQ(-3)+XPQ(-2)+
     +   XPQ(-1)) + DBLE(XGQ(2))*DBLE(XPQ(-4)+XPQ(-3)+XPQ(-2)+XPQ(-1))
     +   + DBLE(XGQ(3))*DBLE(XPQ(-4)+XPQ(-3)+XPQ(-2)+XPQ(-1)) +
     +   DBLE(XGQ(4))*DBLE(XPQ(-4)+XPQ(-3)+XPQ(-2)+XPQ(-1)) +
     +   DBLE(XGQ(-1))*
     +   DBLE(XPQ(4)+XPQ(3)+XPQ(2)+XPQ(1)) + DBLE(XGQ(-2))*DBLE(XPQ(4)+
     +   XPQ(3)+XPQ(2)+XPQ(1)) + DBLE(XGQ(-3))*DBLE(XPQ(4)+XPQ(3)+
     +   XPQ(2)+XPQ(1)) + DBLE(XGQ(-4))*DBLE(XPQ(4)+XPQ(3)+XPQ(2)+
     +   XPQ(1)))
c now s channel q_i + q_bar_i --> q_k + q_bar_k
         SUME2 = SUME2 * DBLE(XGQ(1)*XPQ(-1)+ XGQ(2)*XPQ(-2)+ XGQ(3)*
     +   XPQ(-3)+ XGQ(4)*XPQ(-4)+ XGQ(-1)*XPQ(1)+ XGQ(-2)*XPQ(2)+
     +   XGQ(-3)*XPQ(3)+ XGQ(-4)*XPQ(4))
         SUME = SUME1 + SUME2
      ENDIF
      IF(IRPF.NE.0) THEN
C.....MATRIX ELEMENT for qq --> qq, q_bar q_bar --> q_bar q_bar


         SUMF1 = 4.d0/9.d0*(sh**2 + uh**2)/th**2
         SUMF2 = 4.d0/9.d0*(sh**2 + th**2)/uh**2
c

         SUMF1 = SUMF1 * (DBLE(XGQ(1))*DBLE(XPQ(4)+XPQ(3)+XPQ(2)+XPQ(1)
     +   ) + DBLE(XGQ(2))*DBLE(XPQ(4)+XPQ(3)+XPQ(2)+XPQ(1)) + DBLE(XGQ(
     +   3))*DBLE(XPQ(4)+XPQ(3)+XPQ(2)+XPQ(1)) + DBLE(XGQ(4))*
     +   DBLE(XPQ(4)+XPQ(3)+XPQ(2)+XPQ(1)) + DBLE(XGQ(-1))*DBLE(XPQ(-4)
     +   +XPQ(-3)+XPQ(-2)+XPQ(-1)) + DBLE(XGQ(-2))*DBLE(XPQ(-4)+XPQ(-3)
     +   +XPQ(-2)+XPQ(-1)) + DBLE(XGQ(-3))*DBLE(XPQ(-4)+XPQ(-3)+XPQ(-2)
     +   +XPQ(-1)) + DBLE(XGQ(-4))*DBLE(XPQ(-4)+XPQ(-3)+XPQ(-2)+XPQ(-1)
     +   ))
         SUMF2 = SUMF2 * (DBLE(XGQ(1))*DBLE(XPQ(1)) + DBLE(XGQ(2))*
     +   DBLE(XPQ(2)) + DBLE(XGQ(3))*DBLE(XPQ(3)) + DBLE(XGQ(4))*
     +   DBLE(XPQ(4)) + DBLE(XGQ(-1))*DBLE(XPQ(-1)) + DBLE(XGQ(-2))*
     +   DBLE(XPQ(-2)) + DBLE(XGQ(-3))*DBLE(XPQ(-3)) + DBLE(XGQ(-4))*
     +   DBLE(XPQ(-4)))
         SUMF = SUMF1 + SUMF2
      ENDIF
      IF(IRPG.NE.0) THEN
c cross sections from B. Cox J. Forshaw hep-ph/9805206
         SUMG1 = 0.D0
         if(IRPG.eq.1) then
c eq. 3 Mueller tang
            CF = 4.D0/3.D0
            CA = 3.D0
            yh=LOG(SH/(-TH))+1.D0
            omeg0 = CA*alphasf/pi*4*dlog(2.d0)
            SUMG1=16.D0*PI*2*PI**3*(CF*alphasf)**4
     +    *(SH/TH)**2 *dexp(2.d0*omeg0*yh)/(7.D0*alphasf*CA*zeta3*yh)**3
         elseif(IRPG.eq.2) then
c eq 4. massive gluon
            delta=sqrt(1-((4*gmass**2)/TH))
            SUMG1=(SH/TH)**2/delta**2*(log((delta+1)/(delta-1)))**2*
     +      PI**2*(alphasf)**4
         endif
         SUMG=SUMG1*DBLE(XPQ2)*DBLE(XGQ1)
      ENDIF
c now the total
      SUTO = SUMA + SUMB + SUMC + SUMD + SUME + SUMF + SUMG
c      SUTO = SUMA + SUMB + SUMC + SUMD + SUME + SUMF
      SUM2 = SUTO*16.D0*PI*PI*ALPHA_S*ALPHA_S
      WT1=SUM2
      RNTEST = draprn()
      IF((SUMA+SUMB+SUMC+SUMD+SUME+SUMF)/SUTO.LT.RNTEST) THEN
         IRESPRO = 7
      ELSEIF((SUMA+SUMB+SUMC+SUMD+SUME)/SUTO.LT.RNTEST) THEN
         IRESPRO = 6
      ELSEIF((SUMA+SUMB+SUMC+SUMD)/SUTO.LT.RNTEST) THEN
         IRESPRO = 5
      ELSEIF((SUMA+SUMB+SUMC)/SUTO.LT.RNTEST) THEN
         IRESPRO = 4
      ELSEIF((SUMA+SUMB)/SUTO.LT.RNTEST) THEN
         IRESPRO = 3
      ELSEIF(SUMA/SUTO.LT.RNTEST) THEN
         IRESPRO = 2
      ELSE
         IRESPRO = 1
      ENDIF
      ICOLORA = 0
c      write(6,*) ' eleres ',IRESPRO
      IF(IRESPRO.EQ.1) THEN
c get color configuartion for gg --> qq_bar
         A1 = uh/th - 2.d0*uh**2/sh**2
         A2 = th/uh - 2.d0*th**2/uh**2
         ASUM = A1 + A2
         IF(A1/ASUM.lt.draprn()) THEN
            ICOLORA=2
         ELSE
            ICOLORA=1
         ENDIF
         IF(IHFLA.LT.4) THEN
c select flavour of outgoing q q_bar
            FLRN = draprn()
            FLSUM = 1.D0/3.D0
            IF(FLRN.LT.FLSUM) THEN
               KPF = 1
            ELSEIF(FLRN.LT.2.D0*FLSUM) THEN
               KPF = 2
            ELSEIF(FLRN.LE.3.D0*FLSUM) THEN
               KPF = 3
            ENDIF
         ELSE
            KPF = IHFLA
         ENDIF
         IF(draprn().LE.0.5) THEN
            K(NF1,2) = KPF
            K(NF2,2) = - KPF
         ELSE
            K(NF1,2) = - KPF
            K(NF2,2) = KPF
         ENDIF

      ELSEIF(IRESPRO.EQ.2) THEN
c get color configuartion for gg --> gg
         K(NF1,2)=21
         K(NF2,2)=21
         A1 = sh**2/th**2+2.d0*sh/th+3.d0+2.d0*th/sh+th**2/sh**2
         A2 = uh**2/sh**2+2.d0*uh/sh+3.d0+2.d0*sh/uh+sh**2/uh**2
         A3 = th**2/uh**2+2.d0*th/uh+3.d0+2.d0*uh/th+uh**2/th**2
         ASUM = A1+A2+A3
         RNTEST = draprn()
         ICOLORA = 0
         IF((A1+A2)/ASUM.lt.rntest) THEN
            ICOLORA=3
         ELSEIF(A1/ASUM.lt.rntest) THEN
            ICOLORA=2
         ELSE
            ICOLORA=1
         ENDIF
      ELSEIF(IRESPRO.EQ.3) THEN
c where is the quark ( from gamma or proton)
         IF(SUMC1t/SUMC.GT.draprn()) THEN
            IF(IHFLA.LT.4) THEN
               NFLT = -NFLAV-1
               QSUM = -DBLE(XGQ1)*draprn()
   20          NFLT = NFLT + 1
               IF(NFLT.EQ.0) GOTO 20
c         write(6,*) ' q of gamma ',QSUM,XGQ1,NFLT,XGQ(NFLT)
               QSUM = QSUM + DBLE(XGQ(NFLT))
               IF(QSUM.LE.0.0D0) GOTO 20
               IF(NFLT.GT.NFLAV) write(6,*) ' eleres NFL > NFLAV ',
     +         NFLT, NFLAV
            ELSE
               NFLT = IHFLA
            ENDIF
            IF(draprn().GT.0.5) NFLT=-IHFLA
            K(NIA1,2) = NFLT
            K(NIR1,2) = -NFLT
            K(NIA2,2) = 21
            K(NF1,2) = NFLT
            K(NF2,2) = 21
         ELSE
            IF(IHFLA.LT.4) THEN
               NFLT = -NFLAV-1
               QSUM = -DBLE(XPQ2)*draprn()
   30          NFLT = NFLT + 1
               IF(NFLT.EQ.0) GOTO 30
c         write(6,*) ' q of proton ',QSUM,XPQ2,NFLT,XPQ(NFLT)
               QSUM = QSUM + DBLE(XPQ(NFLT))
               IF(QSUM.LE.0.0D0) GOTO 30
               IF(NFLT.GT.NFLAV) write(6,*) ' eleres NFL > NFLAV ',
     +         NFLT, NFLAV
            ELSE
               NFLT = IHFLA
            ENDIF
            IF(draprn().GT.0.5) NFLT=-IHFLA
            K(NIA1,2) = 21
            K(NIR1,2) = 21
            K(NIA2,2) = NFLT
            K(NF1,2) = 21
            K(NF2,2) = NFLT
         ENDIF
c         call dulist(1)
c get color configuartion for gq --> gq
         A1 = 2.d0*uh**2/th**2 - uh/sh
         A2 = 2.d0*sh**2/th**2 - sh/th
         ASUM = A1 + A2
         ICOLORA = 0
         IF(A1/ASUM.lt.draprn()) THEN
            ICOLORA=2
         ELSE
            ICOLORA=1
         ENDIF
      ELSEIF(IRESPRO.EQ.4) THEN
c get color configuartion for gg --> qq_bar
         A1 = uh/th - 2.d0*uh**2/sh**2
         A2 = th/uh - 2.d0*th**2/uh**2
         ASUM = A1 + A2
         IF(A1/ASUM.lt.draprn()) THEN
            ICOLORA=2
         ELSE
            ICOLORA=1
         ENDIF
         IF(IHFLA.LT.4) THEN
            QTOT=DBLE(XGQ(1)*XPQ(-1)+ XGQ(2)*XPQ(-2)+ XGQ(3)*XPQ(-3)+
     +      XGQ(-1)*XPQ(1)+ XGQ(-2)*XPQ(2)+ XGQ(-3)*XPQ(3))
            NFLT = -3-1
            QSUM = -QTOT*draprn()
   40       NFLT = NFLT + 1
            IF(NFLT.EQ.0) GOTO 40
            QSUM = QSUM + DBLE(XPQ(NFLT)*XGQ(-NFLT))
            IF(QSUM.LE.0.0D0) GOTO 40
            IF(NFLT.GT.NFLAV) write(6,*) ' eleres NFL > NFLAV ',NFLT,
     +      NFLAV
         ELSE
            NFLT = IHFLA
            IF(draprn().GT.0.5) NFLT= -IHFLA
         ENDIF
c         write(6,*) ' IRPE 2nd ',NFLT
         K(NIA1,2) = -NFLT
         K(NIR1,2) = NFLT
         K(NIA2,2) = NFLT
         K(NF1,2) = 21
         K(NF2,2) = 21
      ELSEIF(IRESPRO.EQ.5) THEN
c qq_bar --> qq_bar
         SUMTE = SUME1+SUME2
         IF(SUME1/SUMTE.lt.draprn()) THEN
            ICOLORA = 2
            QTOT  =     DBLE(XGQ(1)*XPQ(-1)+
     +                    XGQ(2)*XPQ(-2)+
     +                    XGQ(3)*XPQ(-3)+
     +                    XGQ(-1)*XPQ(1)+
     +                    XGQ(-2)*XPQ(2)+
     +                    XGQ(-3)*XPQ(3))
            NFLT = -3-1
            QSUM = -QTOT*draprn()
   50       NFLT = NFLT + 1
            IF(NFLT.EQ.0) GOTO 50
            QSUM = QSUM + DBLE(XPQ(NFLT)*XGQ(-NFLT))
            IF(QSUM.LE.0.0D0) GOTO 50
            IF(NFLT.GT.NFLAV) write(6,*) ' eleres NFL > NFLAV ',NFLT,
     +      NFLAV
            K(NIA1,2) = -NFLT
            K(NIR1,2) = NFLT
            K(NIA2,2) = NFLT
c select flavour of outgoing q q_bar
            IF(IHFLA.LT.4) THEN
               FLRN = draprn()
               FLSUM = 1.D0/3.D0
               IF(FLRN.LT.FLSUM) THEN
                  KPF = 1
               ELSEIF(FLRN.LT.2.D0*FLSUM) THEN
                  KPF = 2
               ELSEIF(FLRN.LE.3.D0*FLSUM) THEN
                  KPF = 3
               ENDIF
            ELSE
               KPF = IHFLA
            ENDIF
            IF(K(NIA1,2).LE.0) THEN
               K(NF1,2) = -KPF
               K(NF2,2) =  KPF
            ELSE
               K(NF1,2) = KPF
               K(NF2,2) = -KPF
            ENDIF
         ELSE
            ICOLORA = 1
            QTOT = (DBLE(XGQ(1))*DBLE(XPQ(-3)+XPQ(-2)+XPQ(-1)) +
     +                DBLE(XGQ(2))*DBLE(XPQ(-3)+XPQ(-2)+XPQ(-1)) +
     +                DBLE(XGQ(3))*DBLE(XPQ(-3)+XPQ(-2)+XPQ(-1)) +
     +                DBLE(XGQ(-1))*DBLE(XPQ(3)+XPQ(2)+XPQ(1)) +
     +                DBLE(XGQ(-2))*DBLE(XPQ(3)+XPQ(2)+XPQ(1)) +
     +                DBLE(XGQ(-3))*DBLE(XPQ(3)+XPQ(2)+XPQ(1)))
            NFLTG = -3-1
            QSUM = -QTOT*draprn()
   60       NFLTG = NFLTG + 1
            IF(NFLTG.EQ.0) GOTO 60
            IF(NFLTG.LE.0) THEN
               NFLTP = 0
               NFLTPC = 3
            ELSE
               NFLTP = -3-1
               NFLTPC = 0
            ENDIF
   70       NFLTP = NFLTP + 1
            IF(NFLTP.EQ.0) GOTO 70
            IF(NFLTP.GT.NFLTPC) GOTO 60
            QSUM = QSUM + DBLE(XPQ(NFLTP)*XGQ(NFLTG))
            IF(QSUM.LE.0.D0.AND.NFLTP.LE.NFLTPC) GOTO 70
            IF(QSUM.LE.0.0D0) GOTO 60
            IF(NFLTG.GT.NFLAV) write(6,*) ' eleres NFL_gam > NFLAV ',
     +      NFLTG, NFLAV
            IF(NFLTP.GT.NFLAV) write(6,*) ' eleres NFL_gp > NFLAV ',
     +      NFLTP, NFLAV
            K(NIA1,2) = NFLTG
            K(NIR1,2) = -NFLTG
            K(NIA2,2) = NFLTP
            K(NF1,2) = NFLTG
            K(NF2,2) = NFLTP
         ENDIF
      ELSEIF(IRESPRO.EQ.6) THEN
C qq --> qq, q_bar q_bar --> q_bar q_bar
         SUMTF = SUMF1 + SUMF2
         IF(SUMF1/SUMTF.lt.draprn()) THEN
            ICOLORA = 2
            QTOT = (DBLE(XGQ(1))*DBLE(XPQ(1)) + DBLE(XGQ(2))*
     +      DBLE(XPQ(2)) + DBLE(XGQ(3))*DBLE(XPQ(3)) + DBLE(XGQ(-1))*
     +      DBLE(XPQ(-1)) + DBLE(XGQ(-2))*DBLE(XPQ(-2)) + DBLE(XGQ(-3))
     +      *DBLE(XPQ(-3)))
            NFLT = -3-1
            QSUM = -QTOT*draprn()
   80       NFLT = NFLT + 1
            IF(NFLT.EQ.0) GOTO 80
            QSUM = QSUM + DBLE(XPQ(NFLT)*XGQ(NFLT))
            IF(QSUM.LE.0.0D0) GOTO 80
            IF(NFLT.GT.NFLAV) write(6,*) ' eleres NFL > NFLAV ',NFLT,
     +      NFLAV
            K(NIA1,2) = NFLT
            K(NIR1,2) = -NFLT
            K(NIA2,2) = NFLT
            K(NF1,2) = NFLT
            K(NF2,2) = NFLT
         ELSE
            ICOLORA = 1
            QTOT = (DBLE(XGQ(1))*DBLE(XPQ(3)+XPQ(2)+XPQ(1)) + DBLE(XGQ(
     +      2))*DBLE(XPQ(3)+XPQ(2)+XPQ(1)) + DBLE(XGQ(3))*DBLE(XPQ(3)+
     +      XPQ(2)+XPQ(1)) + DBLE(XGQ(-1))*DBLE(XPQ(-3)+XPQ(-2)+XPQ(-1)
     +      ) + DBLE(XGQ(-2))*DBLE(XPQ(-3)+XPQ(-2)+XPQ(-1)) + DBLE(XGQ(
     +      -3))*DBLE(XPQ(-3)+XPQ(-2)+XPQ(-1)))
            NFLTG = -3-1
            QSUM = -QTOT*draprn()
   90       NFLTG = NFLTG + 1
            IF(NFLTG.EQ.0) GOTO 90
            IF(NFLTG.LE.0) THEN
               NFLTP = -3-1
               NFLTPC = 0
            ELSE
               NFLTP = 0
               NFLTPC = 3
            ENDIF
  100       NFLTP = NFLTP + 1
            IF(NFLTP.GT.NFLTPC) GOTO 90
            IF(NFLTP.EQ.0) GOTO 100
            QSUM = QSUM + DBLE(XPQ(NFLTP)*XGQ(NFLTG))
            IF(QSUM.LE.0.D0.AND.NFLTP.LE.NFLTPC) GOTO 100
            IF(QSUM.LE.0.0D0) GOTO 90
            IF(NFLTG.GT.NFLAV) write(6,*) ' eleres NFL_gam > NFLAV ',
     +      NFLTG, NFLAV
            IF(NFLTP.GT.NFLAV) write(6,*) ' eleres NFL_gp > NFLAV ',
     +      NFLTP, NFLAV
            K(NIA1,2) = NFLTG
            K(NIR1,2) = -NFLTG
            K(NIA2,2) = NFLTP
            K(NF1,2) = NFLTG
            K(NF2,2) = NFLTP
         ENDIF
      ELSEIF(IRESPRO.EQ.7) THEN
C qq --> qq, q_bar q_bar --> q_bar q_bar color singlet exchange
         NFLP = -NFLAV-1
         QSUM = -DBLE(XPQ2)*draprn()
  110    NFLP = NFLP + 1
         IF(NFLP.EQ.0) GOTO 110
c         write(6,*) ' q of proton ',QSUM,XPQ2,NFLP,XPQ(NFLP)
         QSUM = QSUM + DBLE(XPQ(NFLP))
         IF(QSUM.LE.0.0D0) GOTO 110
         IF(NFLP.GT.NFLAV) write(6,*) ' eleres NFLP > NFLAV ',NFLP,
     +   NFLAV
         NFLG = -NFLAV-1
         QSUM = -DBLE(XGQ1)*draprn()
  120    NFLG = NFLG + 1
         IF(NFLG.EQ.0) GOTO 120
c         write(6,*) ' q of gamma ',QSUM,XGQ1,NFLG,XGQ(NFLG)
         QSUM = QSUM + DBLE(XGQ(NFLG))
         IF(QSUM.LE.0.0D0) GOTO 120
         IF(NFLG.GT.NFLAV) write(6,*) ' eleres NFLG > NFLAV ',NFLG,
     +   NFLAV

         K(NIA1,2) = NFLG
         K(NIR1,2) = -NFLG
         K(NIA2,2) = NFLP
         K(NF1,2) = NFLG
         K(NF2,2) = NFLP
      ENDIF
      SCAL1 = SNGL(Q2Q)
      XPD1 = XGQ(K(NIA1,2))
      IF(WT1.LE.0.D0.AND.IDEBUG.EQ.1) THEN
         write(6,*) ' eleres wt1 = ',wt1,' Q2 = ',Q2,' Q2Q = ',Q2Q
         write(6,*) ' eleres xgq = ',(xgq(i),i=-6,6)
         write(6,*) ' eleres xpq = ',(xpq(i),i=-6,6)
      ENDIF
      IF(WT1.LT.0.D0) THEN
         write(6,*) ' eleres wt1 = ',wt1,' Q2 = ',Q2,' Q2Q = ',Q2Q
         WT1 = 0.D0
      ENDIF
      RETURN
      END
*CMZ :  2.08/05 10/03/2000  12.33.04  by  Hannes Jung
*CMZ :  2.08/04 11/01/2000  19.47.19  by  Hannes Jung
*CMZ :  2.08/02 04/11/99  16.39.08  by  Hannes Jung
*CMZ :  2.08/01 22/06/99  16.58.44  by  Hannes Jung
*CMZ :  2.08/00 14/06/99  19.13.55  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  19.54.45  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE EVENT
      IMPLICIT NONE
      Integer NDIM,NPOIN
      COMMON/DIVO/ NDIM,NPOIN
*KEEP,RGEFFIC.
      DOUBLE PRECISION AVGI,SD
      INTEGER NIN,NOUT
      COMMON/EFFIC/AVGI,SD,NIN,NOUT
C     SAVE

*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGLUPARM.
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGFULL.
      INTEGER IFULL,IQCDGRID
      COMMON /OALPINI/ IFULL,IQCDGRID
*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEEP,RGRAHER.
      REAL XPQDIF,XPQPI
	Integer IHERPYS
	Integer NBQ2,NBX
      PARAMETER (NBQ2=20)
      PARAMETER (NBX=20)
      COMMON /RAHER/ IHERPYS,XPQDIF(-6:6,NBX,NBQ2),XPQPI(-6:6,NBX,NBQ2)
*KEEP,RGRGRIDF2.
      DOUBLE PRECISION XX,Q2X
      COMMON /RGRIDF2/ XX(NBX),Q2X(NBQ2)
      REAL F2_DIS,F2_DIF,F2_PI
      COMMON /F2VAL/ F2_DIS(NBX,NBQ2),F2_DIF(NBX,NBQ2),F2_PI(NBX,NBQ2)
cNEW
      DOUBLE PRECISION F2DIS,F2DIF,F2PI
      COMMON /F2INT/ F2DIS,F2DIF,F2PI
cNEW
*KEND.
c henry's commons
      Double Precision  Stot, Q2_henry, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2_henry, W2, Mx2, AJAC
      Double Precision    KtG2, QtG2, SM2, ZW, KW2, WT3, YCUT
      COMMON /C3BODVAR/   KtG2, QtG2, SM2, ZW, KW2, WT3, YCUT
c end
      INTEGER N,K
      REAL P,V
      DOUBLE PRECISION DP
      COMMON/LUJETS/N,K(LUPAN,5),P(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/DP(LUPAN,5)
      REAL ULMASS
      EXTERNAL ULMASS

      REAL XPQ(-6:6)
      Double Precision X(20)
      Double Precision XG(20)
      Integer LST,IRES,MSTA
      COMMON /EPPARA/ LST(30),IRES(2)
      REAL PARA
      COMMON /ARDAT1/ PARA(40),MSTA(40)
      Double Precision WMAX
      Integer IMIX
      COMMON /OALPHAS/ WMAX,IMIX

      Integer NQPM,NQQB,NQQBC,NQQBB,NQCDC
      COMMON /QCDEV/ NQPM,NQQB,NQQBC,NQQBB,NQCDC
      Double Precision XV
      Integer NDIMEN
      COMMON /XVAL/ XV(20),NDIMEN
      Double Precision draprn
      DOUBLE PRECISION MP
      DOUBLE PRECISION POMAX,PIMAX,WTMA
      COMMON/WEIGHT/ POMAX(NBX,NBQ2),PIMAX(NBX,NBQ2),WTMA
      Integer IGENFL,IVM
      COMMON/GENWEI/IGENFL
      COMMON/VMESON/IVM
      Integer ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      COMMON /COLCON/ ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      Integer NDIS,NQPMDS,NQQBDS,NQQBCDS,NQQBBDS,NQCDCDS,
     +              NDIF,NQPMDF,NQQBDF,NQQBCDF,NQQBBDF,NQCDCDF,
     +              NPI,NQPMPI,NQQBPI,NQQBCPI,NQQBBPI,NQCDCPI,
     +              NRPA,NRPB,NRPC,NRPD,NRPE,NRPF,NRPG,NPRT
      COMMON/NEVOUT/NDIS,NQPMDS,NQQBDS,NQQBCDS,NQQBBDS,NQCDCDS,
     +              NDIF,NQPMDF,NQQBDF,NQQBCDF,NQQBBDF,NQCDCDF,
     +              NPI,NQPMPI,NQQBPI,NQQBCPI,NQQBBPI,NQCDCPI,
     +              NRPA,NRPB,NRPC,NRPD,NRPE,NRPF,NRPG,NPRT
      REAL PYPAR,PYVAR
      Integer IPY
      COMMON /PYPARA/ IPY(80),PYPAR(80),PYVAR(80)
      REAL QMAX
      Integer LERR
      COMMON/ERR/LERR(100)
C JPP Add variables for calculating Q2EG
      DOUBLE PRECISION KEP(4)
      REAL Q2EG
      REAL XHF,Q2HF
      Integer KPHF
      COMMON /HEAVYF/XHF,Q2HF,KPHF
      Integer IDEBUG
      COMMON/ INTERN/IDEBUG
      REAL SNGL
      Real     remPARJ32
      Real     remPARJ(5)
      LOGICAL FIRST

      Integer IQPML1,IQQBL1,IQQBCL1,IQCDCL1,IQPML0
      Integer IQQBL0,IQCDCL0,IQPMH1,IQQBH1,IQQBCH1
      Integer IQCDCH1,IQPMH0,IQQBH0,IQCDCH0
      Integer NTRMAX,NPRIN,IDEBUGO,IPROO,IDIRO,NGO,NPOMO,KPAO,KINT22
      Integer IHERPYSO,IHFO
      Integer I,J,NTRY,IX,IQ,IERR,IKEEP
      Integer NFI1,NFI2
      Integer IRAD
      Double Precision WDUM,SMALL,T2MAXO,XBJ,WPA,XPRT,XRMIN,XR
      Double Precision VMAX,VMIN,XMAXV,XMINV,xmch
      Double Precision XMINHF,T2MIN,XP2T,Q2T,T2,T2MN,WTDIST,WTT,WTRN
      Double Precision FXN1,DCORR,XD,QD,X1P,X2P,RF2DIS,RF2DIF,RF2PI
      Double Precision RNTEST,DOT1,RNSAT
      EXTERNAL DOT1
      EXTERNAL draprn
      DATA WDUM/0.D0/
      DATA IQPML1/0/,IQQBL1/0/,IQQBCL1/0/,IQCDCL1/0/,IQPML0/0/
      DATA IQQBL0/0/,IQCDCL0/0/,IQPMH1/0/,IQQBH1/0/,IQQBCH1/0/
      DATA IQCDCH1/0/,IQPMH0/0/,IQQBH0/0/,IQCDCH0/0/
      DATA FIRST/.TRUE./
      DATA NTRMAX/8000/
      DATA NPRIN/5/
      DATA  SMALL/1.D-3/
      Double Precision    Kt2, WT2
      COMMON /C2BODVAR/   Kt2, WT2

CPER
      integer nPrint
      parameter (nPrint = 100000)
CPER

      IDEBUGO = IDEBUG
   10 CONTINUE
      NIN=NIN+1
c      IF(MOD(NOUT,1).EQ.0) write(6,*) ' start: Nr of events ',NOUT
      IF(FIRST) THEN
         first = .FALSE.
         remPARJ32 = PARJ(32)
         IPROO = IPRO
         IDIRO = IDIR
         NGO = NG
         NPOMO = NPOM
         KPAO = KPA
         KINT22 = KINT(2,2)
         FIRST=.FALSE.
         MP = DP(2,5)
         T2MAXO = T2MAX
         NDIS=0
         NQPMDS=0
         NQQBDS=0
         NQQBCDS=0
         NQQBBDS=0
         NQCDCDS=0
         NDIF=0
         NQPMDF=0
         NQQBDF=0
         NQQBCDF=0
         NQQBBDF=0
         NQCDCDF=0
         NPI=0
         NQPMPI=0
         NQQBPI=0
         NQQBCPI=0
         NQQBBPI=0
         NQCDCPI=0
         NRPA=0
         NRPB=0
         NRPC=0
         NRPD=0
         NRPE=0
         NRPF=0
         NRPG=0
         NPRT=0
         IHERPYSO = IHERPYS
         IHFO = IHF
      ELSE
         PARJ(32)=remPARJ32
         IHERPYS = IHERPYSO
         IHF = IHFO
         IPRO = IPROO
         IDIR=IDIRO
         NG = NGO
         NPOM = NPOMO
         KPA = KPAO
         KINT(2,2) = KINT22
      ENDIF
      T2GKI = 0.
      XFGKI = 0.
      PT2H = 0.
      SHH = 0.
      IWEI = 0
      IGENFL = 0
      IMIX = 0
      DO 20 I=1,20
         XV(I)= 0.D0
   20 X(I) = 0.D0
      NDIMEN = NDIM
      IF(IDISDIF.GE.1) IHERPYS = 0
      IF(IPRO.EQ.1200.AND.IDIR.EQ.1) IHERPYS=0
      IF(IPRO.EQ.1200.AND.IDIR.EQ.0) IHERPYS=1
      IF(IPRO.EQ.3000.AND.IDIR.EQ.0) IHERPYS=1
      IF(IPRO.LT.1000) THEN
         CALL RAPGEN(NDIM,XG)
         DO 30 I=1,NDIM
            X(I) = XG(I)
   30    XV(I) = X(I)
c      write(6,*) ' check kt2 after',kt2
      ELSE
         CALL HERACL(AVGI,SD,2)
         IHERPYS = 0
c       IF(MOD(NOUT,1).EQ.0) write(6,*) ' heracl: Nr of events ',NOUT

         XBJ = XHS
         Q2 = Q2HS
         IF(IHF.EQ.1) THEN
            KPHF = IHFLA
            KPA = KPHF
         ENDIF
         IF(IDIR.EQ.1) THEN
            WPA = FXN1(X,WDUM)
         ELSEIF(IDIR.EQ.0.AND.NPOM.NE.20.AND.NPOM.NE.21) THEN
            XPRT = XBJ
		Q2T = Q2
            IF(XPRT.LT.XX(1).OR.XPRT.GT.XX(NBX)) THEN
               WRITE(6,*) ' EVENT: X values outside grid '
               WRITE(6,*) ' X_min ',XX(1),' X_max ',XX(NBX),
     +          ' actual X ', XPRT
               IF(XPRT.LT.XX(1)) XPRT=XX(1)
               IF(XPRT.GT.XX(NBX)) XPRT=XX(NBX)
            ENDIF
            IX = 0
   40       IX = IX + 1
            IF(XPRT.GT.XX(IX+1)) GOTO 40
            IF(Q2T.LT.Q2X(1).OR.Q2T.GT.Q2X(NBQ2)) THEN
               WRITE(6,*) ' EVENT: Q2 values outside grid '
               WRITE(6,*) ' Q2_min ',Q2X(1),' Q2_max ',Q2X(NBQ2),
     +          ' actual Q2 ', Q2T
               IF(Q2T.LT.Q2X(1)) Q2T=Q2X(1)
               IF(Q2T.GT.Q2X(NBQ2)) Q2T=Q2X(NBQ2)
            ENDIF
            IQ = 0
   41       IQ = IQ + 1
            IF(Q2T.GT.Q2X(IQ+1)) GOTO 41
            NTRY = 0
            NG = NGO
            NPOM =NPOMO
            IDIR = 0
            KINT(2,2) = 100
            WTMA = POMAX(IX,IQ)

            XD = (XPRT - XX(IX))/(XX(IX+1)-XX(IX))
            QD = (Q2T - Q2X(IQ))/(Q2X(IQ+1) - Q2X(IQ))
            X1P=DBLE(
     +      (POMAX(IX+1,IQ)-POMAX(IX,IQ))*SNGL(XD)+POMAX(IX,IQ))
            X2P=DBLE((POMAX(IX+1,IQ+1)-POMAX(IX,IQ+1))
     +                *SNGL(XD)+POMAX(IX,IQ+1))
            WTMA = (X2P-X1P)*QD + X1P


c            NDIMEN = NDIM + 2
c            write(6,*) ' event: IPRO = ',IPRO,IHERAC
            IF(IPRO.EQ.30) THEN
c               NTRMAX = 15000
   50          CALL draprnV(XG,2)
               IF(NTRY.GT.NTRMAX) THEN
                  write(6,*) 'too many trials for DIF; event rejected,'
     +            //'q2 = ',Q2,' x = ',xbj
                  GOTO 10
               ENDIF
               NTRY = NTRY + 1
               DO  I=1,2
                  XV(NDIM+I)=XG(I)
                  X(NDIM+I)=XG(I)
               ENDDO
c           write(6,*) ' event x ',x(ndim+1),x(ndim+2),xg(1),xg(2)
               call RGSATRAP(X,WPA)
               RNSAT = draprn()
c               write(6,*) ' EVENT :Wpa,WTMA ',WPA,WTMA,RNSAT,ntry
               IF(WPA.GT.1.0*WTMA) THEN
                  write(6,*) ' EVENT: WPA > WTMA from RGSATRAP',WPA,
     +            WTMA,' q2,x ',q2,xbj,ix,iq
               endif

               IF(RNSAT.GT.WPA/(1.0*WTMA)) GOTO 50
c             write(6,*) ' EVENT accepted:Wpa,WTMA ',WPA,WTMA,RNSAT,ntry
            ELSE
c generate xr and t2
   60          CALL draprnV(XG,2)
               NTRY = NTRY + 1
               DO 70 I=1,2
                  XV(NDIM+I)=XG(I)
   70          X(NDIM+I)=XG(I)
               XMAX = 1.D0 - XF
               XP2T = XBJ
               IF(XMAX.LE.XP2T) THEN
                  write(6,*) ' 1. xmax<xp2t ',xmax,xp2t
                  GOTO 10
               endif
               IF(NTRY.GT.NTRMAX) THEN
                  write(6,*) 'too many trials for DIF; event rejected,'
     +            //'t,x'
                  GOTO 10
               ENDIF
               XRMIN = XP2T
cnew
c            IF(IHF.EQ.1) THEN
c               XMINHF = XP2T*(1.d0 + 4.d0*DBLE(ULMASS(KPA))**2/Q2)
c           Xrmin = MAX(XrMIN,XMINHF)
c           Xrmin = MIN(Xrmin,XMAX)
cc          write(6,*) ' 1st xminhf ',xminhf,xrmin,xmax
c           ENDIF
cnew
               IF(IVM.EQ.0) THEN
                  XR = XRMIN*(XMAX/XRMIN)**X(NDIM+1)
c           write(6,*) ' event xr,xmax,xrmin ',xr,xmax,xrmin
               ELSE
                  IF(IVM.GE.1.AND.IVM.LT.443) THEN
                     VMAX = DBLE(1.020 + 2.*ULMASS(211))
                     VMIN = DBLE(0.780 - 2.*ULMASS(211))
                  ELSEIF(IVM.EQ.443) THEN
                     VMAX = 2.D0*DBLE(ULMASS(421))
                     VMIN = 2.D0*DBLE(ULMASS(4))
                  ELSEIF(IVM.EQ.553) THEN
                     VMAX = 2.D0*DBLE(ULMASS(521))
                     VMIN = 2.D0*DBLE(ULMASS(5))
                  ENDIF
                  VMIN = VMIN+SMALL
                  VMAX = VMAX-SMALL
c                  write(6,*) 'event:',XMAX,XMIN
                  XMAXV = XP2T*(1.d0 + VMAX**2/Q2)
                  XMINV = XP2T*(1.d0 + VMIN**2/Q2)
                  XR = XMINV*(XMAXV/XMINV)**X(NDIM+1)
c                  write(6,*) 'event:',XMAXV,XMINV,XR
                  IF(XMAXV.GT.XMAX) THEN
                     write(6,*) 'xmaxv>xmax'
                     GOTO 10
                  ENDIF
               ENDIF
               IF(IHF.EQ.1) THEN
                  XMINHF = XP2T*(1.d0 + 4.d0*DBLE(ULMASS(KPA))**2/Q2)
c keep XR generated in full range, and only reject those values which fall
c outside the phase space, otherwise POMAX calculated in POMSTR will not match
C maximum calculated here
                  IF(XMINHF.GT.XMAX) THEN
                     write(6,*) ' event xminhf,xrmin',xminhf,xrmin
                     write(6,*) ' event xp2t,q2',xp2t,q2,ulmass(4)
                     write(6,*) ' goto 10 '
                     GOTO 10
                  ENDIF
                  IF(XMINHF.GT.XR) THEN
c             write(6,*) 'xminhf > xr ',xminhf,xr,xmin,xmax
c             write(6,*) ' goto 50 '
                     GOTO 60
                  ENDIF

c               XR = XMINHF*(XMAX/XMINHF)**X(NDIM+1)
               ENDIF
               T2MIN = MP*MP*XR*XR/(1.D0-XR)
               T2MN = -(Q2 *(1.D0 - XR/XBJ) + 4.D0*DBLE(ULMASS(211))**
     +         2)
               IF(T2MN.LT.T2MAXO) THEN
                  T2MAX = T2MN
               ELSE
                  T2MAX = T2MAXO
               ENDIF
               IF(T2MAX.LE.T2MIN) THEN
c               write(6,*) ' event: T2min T2max',T2MIN,T2MAX
c           write(6,*) ' goto 50 '
                  GOTO 60
               ENDIF
               T2 = T2MIN*((T2MAX/T2MIN)**X(NDIM+2))
               WTDIST = 0.D0
               CALL RAT2DI(KINT(2,2),XR,-T2,WTDIST)
c        write(6,*) ' event WTDIST',WTDIST
               WTDIST = WTDIST * T2*DLOG(T2MAX/T2MIN)
               IF(IVM.EQ.0.AND.IHF.EQ.0) THEN
                  WTDIST=WTDIST*XR*DLOG(XMAX/XRMIN)
               ELSEIF(IVM.EQ.0.AND.IHF.EQ.1) THEN
ccc               WTDIST=WTDIST*XR*DLOG(XMAX/XMINHF)
                  WTDIST=WTDIST*XR*DLOG(XMAX/XRMIN)
                  xmch = q2*(xr-xp2t)/xp2t - T2
                  if(xmch.lt.4.d0*dble(ulmass(kphf))**2) Then
c              write(6,*) ' xmch failed xmch= ',xmch,t2,kphf,kpa
c              write(6,*) ' goto 50 '
                     goto 60
                  endif
c        write(6,*) ' event WTDIST',WTDIST,XR,XR*DLOG(XMAX/XRMIN)
               ELSE
                  WTDIST=WTDIST*XR*DLOG(XMAXV/XMINV)
               ENDIF
               IF(DABS(WTDIST).LE.1.D-45) GOTO 60
               XPR = SNGL(XP2T)
               T2GKI = SNGL(-T2)
               XFGKI = SNGL(XR)
               CALL RASTFU(100,SNGL(XP2T/XR),SNGL(Q2),XPQ)
               WTDIST = WTDIST*DBLE(XPQ(KPA))
               IF(WTDIST.LE.0.0) GOTO 60
c add safety margin 1.5 for rejection
               WTT = WTDIST/(1.5D0*WTMA)
               WTRN = draprn()
C JPP Turn debugging off
c            IDEBUG = 1
               WPA = FXN1(X,WDUM)
c            IDEBUG =IDEBUGO
c               write(6,*) ' T2,Xr,xbj ',t2,xr,xbj
c               write(6,*) ' x(NDIM+1),X(NDIM+2),NDIM ',X(NDIM+1),
c     +       X(NDIM+2),NDIM
               IF(WTDIST.GT.1.5D0*WTMA) THEN
                  write(6,*) ' WPA,NTRY ',WPA,NTRY
                  write(6,*) ' EVENT: WTDIST,WTMA ',WTDIST,WTMA
                  write(6,*) ' WTRN,WTT ',WTRN,WTT
                  write(6,*) ' T2,Xr,xbj ',t2,xr,xbj
                  write(6,*) ' x(NDIM+1),X(NDIM+2),NDIM ',X(NDIM+1),
     +            X(NDIM+2),NDIM
               endif
               IF(WPA.LE.0.) THEN
c               write(6,*) '1st WPA = 0 '
                  GOTO 10
               ENDIF
               IF(WTRN.GT.WTT) THEN
c               write(6,*) ' WTRN>WTT ',wtrn,wtt
                  GOTO 60
               ENDIF
c            write(6,*) ntry
            ENDIF
         ELSEIF(IDIR.EQ.0.AND.(NPOM.EQ.20.OR.NPOM.EQ.21)) THEN
            NTRY = 0
            IDIR = 0
            XPRT = XBJ
		Q2T = Q2
            IF(NPOM.EQ.20) THEN
               NG = 20
               KINT(2,2)=211
            ELSEIF(NPOM.EQ.21) THEN
               NG = 21
               KINT(2,2)=111
            ENDIF
            XPRT = XBJ
            IF(XPRT.LT.XX(1).OR.XPRT.GT.XX(NBX)) THEN
               WRITE(6,*) ' EVENT: X  values outside grid '
               WRITE(6,*) ' X_min ',XX(1),' X_max ',XX(NBX),
     +         ' actual X ', XPRT
               IF(XPRT.LT.XX(1)) XPRT=XX(1)
               IF(XPRT.GT.XX(NBX)) XPRT=XX(NBX)
            ENDIF
            IX = 0
   80       IX = IX + 1
            IF(XPRT.GT.XX(IX+1)) GOTO 80
            IF(Q2T.LT.Q2X(1).OR.Q2T.GT.Q2X(NBQ2)) THEN
               WRITE(6,*) ' EVENT: Q2 values outside grid '
               WRITE(6,*) ' Q2_min ',Q2X(1),' Q2_max ',Q2X(NBQ2),
     +          ' actual Q2 ', Q2T
               IF(Q2T.LT.Q2X(1)) Q2T=Q2X(1)
               IF(Q2T.GT.Q2X(NBQ2)) Q2T=Q2X(NBQ2)
            ENDIF
            IQ = 0
   81       IQ = IQ + 1
            IF(Q2T.GT.Q2X(IQ+1)) GOTO 81

            WTMA = PIMAX(IX,IQ)
            NDIMEN = NDIM + 2
c generate xr and t2
   90       CALL draprnV(XG,2)
            DO 100  I=1,2
               XV(NDIM+I)=XG(I)
  100       X(NDIM+I)=XG(I)
            NTRY = NTRY + 1
            XMAX = 1.D0 - XF
            XP2T = XBJ
            IF(XMAX.LE.XP2T) THEN
               write(6,*) ' 2 xmax<x2pt ',xmax,xp2t
               GOTO 10
            endif
            IF(NTRY.GT.NTRMAX) THEN
               write(6,*) ' too many trials for PI; event rejected,x,t'
               GOTO 10
c               RETURN
            ENDIF
            XR = XP2T*(XMAX/XP2T)**X(NDIM+1)
            T2MIN = MP*MP*XR*XR/(1.D0-XR)
            T2MN = -(Q2 *(1.D0 - XR/XBJ) + 4.D0*DBLE(ULMASS(211))**2)
c            write(6,*) T2MN,T2MAXO,T2min
c            write(6,*) Q2,Xr,XBJ,ULMASS(211)
            IF(T2MN.LT.T2MAXO) THEN
               T2MAX = T2MN
            ELSE
               T2MAX = T2MAXO
            ENDIF
            IF(T2MAX.LE.T2MIN) GOTO 90

            T2 = T2MIN*((T2MAX/T2MIN)**X(NDIM+2))
            WTDIST = 0.D0
            CALL RAT2DI(KINT(2,2),XR,-T2,WTDIST)
            WTDIST = WTDIST *T2*DLOG(T2MAX/T2MIN)*XR*DLOG(XMAX/XP2T)
            IF(DABS(WTDIST).LE.1.D-45) GOTO 90
cnew
            XPR = SNGL(XP2T)
            T2GKI = SNGL(-T2)
            XFGKI = SNGL(XR)
            CALL RASTFU(KINT(2,2),SNGL(XP2T/XR),SNGL(Q2),XPQ)
            WTDIST = WTDIST*DBLE(XPQ(KPA))
cnew
c add safety margin 1.5 for rejection
            WTT = WTDIST/(1.5D0*WTMA)
            WTRN = draprn()
c		IDEBUGO = IDEBUG
c            IDEBUG = 1
               WPA = FXN1(X,WDUM)
c            IDEBUG =IDEBUGO
            IF(WTDIST.GT.1.5D0*WTMA) THEN
               write(6,*) ' WPA,NTRY ',WPA,NTRY
               write(6,*) ' EVENT: WTDIST,WTMA ',WTDIST,WTMA
               write(6,*) ' WTRN,WTT ',WTRN,WTT
               write(6,*) ' T2,Xr,xbj ',t2,xr,xbj
               write(6,*) ' x(NDIM+1),X(NDIM+2),NDIM ',X(NDIM+1),
     +       X(NDIM+2),NDIM
            endif
            IF(WPA.LE.0.0) THEN
c               write(6,*) ' 3rd WPA = 0'
c               write(6,*) T2MN,T2MAXO,T2min
c            write(6,*) Q2,Xr,XBJ,ULMASS(211),DBLE(ULMASS(211))
c            write(6,*)  Q2*(1.D0 - XR/XBJ),4.D0*ULMASS(211)**2
               GOTO 10
            ENDIF
            IF(WTRN.GT.WTT) THEN
               GOTO 90
            ENDIF

         ENDIF
      ENDIF

c      CALL DULIST(1)

      IGENFL = 0
      IDEBUG = 0
c       write(6,*) 'EVENT: before 1st FXN1, WPA= ',WPA,IPRO,KPA,idir,x
      IF(IPRO.EQ.30) THEN
      ELSEIF(ISEMIH.EQ.0) THEN
         WPA = FXN1(X,WDUM)
         IF(WPA.LE.0.0) THEN
c         write(6,*) ' 2nd after rangen :',(x(i),i=1,ndim)
c         write(6,*) ' 4th WPA = 0',KPA
c         call dulist(1)
c         pause
            GOTO 10
         ENDIF
      ENDIF
      IDEBUG = IDEBUGO
c       write(6,*) 'EVENT: after 1st FXN1, WPA= ',WPA,IPRO,KPA,idir,x

      IF(IPRO.EQ.100) GOTO 180
      XBJ = Q2/DBLE(YY)/SSS
      IF(IDISDIF.GE.1) THEN
         IGENFL = 0
         XPRT = XBJ
         Q2T = Q2
         IF(XPRT.LT.XX(1).OR.XPRT.GT.XX(NBX) .OR.Q2T.LT.Q2X(1)
     +   .OR.Q2T.GT.Q2X(NBQ2)) THEN
            IF(IHERAC.EQ.0) THEN
               WRITE(6,*) ' EVENT: X or Q2 values outside grid '
               WRITE(6,*) ' X_min ',XX(1),' X_max ',XX(NBX),
     +         ' actual X ', XPRT
               WRITE(6,*) ' Q2_min ',Q2X(1),' Q2_max ',Q2X(NBQ2), ' '
     +         //'actual Q2 ',Q2T
            ENDIF
            IF(XPRT.LT.XX(1)) XPRT=XX(1)
            IF(XPRT.GT.XX(NBX)) XPRT=XX(NBX)
            IF(Q2T.LT.Q2X(1)) Q2T = Q2X(1)
            IF(Q2T.GT.Q2X(NBQ2)) Q2T = Q2X(NBQ2)
         ENDIF
         IX = 0
  110    IX = IX + 1
         IF(XPRT.GT.XX(IX+1)) GOTO 110
         IQ = 0
  120    IQ = IQ + 1
         IF(Q2T.GT.Q2X(IQ+1)) GOTO 120
         DCORR = 1.D0
         XD = (XPRT - XX(IX))/(XX(IX+1)-XX(IX))
         QD = (Q2T - Q2X(IQ))/(Q2X(IQ+1) - Q2X(IQ))
         X1P=DBLE(
     +    (F2_DIS(IX+1,IQ)-F2_DIS(IX,IQ))*SNGL(XD)+F2_DIS(IX,IQ))
         X2P=DBLE(
     +    (F2_DIS(IX+1,IQ+1)-F2_DIS(IX,IQ+1))*SNGL(XD)+F2_DIS(IX,IQ+1))
         F2DIS = (X2P-X1P)*QD + X1P
         F2DIS = F2DIS*DCORR
         X1P=DBLE(
     +    (F2_DIF(IX+1,IQ)-F2_DIF(IX,IQ))*SNGL(XD)+F2_DIF(IX,IQ))
         X2P=DBLE(
     +    (F2_DIF(IX+1,IQ+1)-F2_DIF(IX,IQ+1))*SNGL(XD)+F2_DIF(IX,IQ+1))
         F2DIF = (X2P-X1P)*QD + X1P
         F2DIF = F2DIF*DCORR
         X1P=DBLE(
     +    (F2_PI(IX+1,IQ)-F2_PI(IX,IQ))*SNGL(XD)+F2_PI(IX,IQ))
         X2P=DBLE(
     +    (F2_PI(IX+1,IQ+1)-F2_PI(IX,IQ+1))*SNGL(XD)+F2_PI(IX,IQ+1))
         F2PI = (X2P-X1P)*QD + X1P
         F2PI = F2PI*DCORR
         IF((1.D0 - XF).LE.XBJ) THEN
            F2DIF = 0.D0
            F2PI = 0.D0
         ENDIF
         RF2DIS = (F2DIS-F2DIF-F2PI)/F2DIS
         IF(RF2DIS.LE.0.0D0) THEN
            write(6,*) ' pomeron or pion contribution larger than '
     +      //'total'
            write(6,*) ' F2TOT= ',F2DIS,' F2_DIF= ',F2DIF,' F2_PI= ',
     +      F2PI
            write(6,*) ' event rejected ..... mixing might be wrong '
            RETURN
         ENDIF
         RF2DIF = F2DIF/F2DIS
         RF2PI = F2PI/F2DIS
         KPA = KPAO
         RNTEST = draprn()
         IF(RNTEST.LT.RF2DIS) THEN
            IDIR = 1
            KINT(2,2)=2212
            NDIMEN = NDIM
            WTMA = 999999.D0
         ELSEIF(RNTEST.LT.(RF2DIS+RF2DIF)) THEN
            NTRY = 0
            NG = NGO
            NPOM =NPOMO
            IDIR = 0
            KINT(2,2) = 100
            WTMA = POMAX(IX,IQ)
            NDIMEN = NDIM + 2
c generate xr and t2
  130       CALL draprnV(XG,2)
            NTRY = NTRY + 1
            DO 140 I=1,2
               XV(NDIM+I)=XG(I)
  140       X(NDIM+I)=XG(I)
            XMAX = 1.D0 - XF
            XP2T = XBJ
            IF(XMAX.LE.XP2T) THEN
               write(6,*) '3. xmax<xp2t ',xmax,xp2t
               GOTO 10
            endif
            IF(NTRY.GT.NTRMAX) THEN
               write(6,*) ' too many trials for DIF;',
     +          ' event rejected,mix,po'
               GOTO 10
c               RETURN
            ENDIF
            XR = XP2T*(XMAX/XP2T)**X(NDIM+1)
            T2MIN = MP*MP*XR*XR/(1.D0-XR)
            T2MN = -(Q2 *(1.D0 - XR/XBJ) + 4.D0*DBLE(ULMASS(211))**2)
            IF(T2MN.LT.T2MAXO) THEN
               T2MAX = T2MN
            ELSE
               T2MAX = T2MAXO
            ENDIF

            T2 = T2MIN*((T2MAX/T2MIN)**X(NDIM+2))
            WTDIST = 0.D0
            CALL RAT2DI(KINT(2,2),XR,-T2,WTDIST)
            WTDIST = WTDIST * T2*DLOG(T2MAX/T2MIN)*XR*DLOG(XMAX/XP2T)
c include that when ng <0 or ng>30 because weight is only included in RASTFU,
c in RAT2DI weight=1.
cnew
            XPR = SNGL(XP2T)
            T2GKI = SNGL(-T2)
            XFGKI = SNGL(XR)
            CALL RASTFU(100,SNGL(XP2T/XR),SNGL(Q2),XPQ)
            WTDIST = WTDIST*DBLE(XPQ(KPA))
cnew

c add safety margin 1.5 for rejection
            WTT = WTDIST/(1.5D0*WTMA)
            WTRN = draprn()
            IF(WTRN.GT.WTT) THEN
               GOTO 130
            ENDIF
            WPA = FXN1(X,WDUM)
            IF(WPA.LE.0.0) GOTO 130
         ELSEIF(RNTEST.LT.(RF2DIS+RF2DIF+RF2PI)) THEN
            NTRY = 0
            IDIR = 0
            NG = 20
            NPOM = 20
            KINT(2,2)=211
            WTMA = PIMAX(IX,IQ)
            NDIMEN = NDIM + 2
c generate xr and t2
  150       CALL draprnV(XG,2)
            DO 160 I=1,2
               XV(NDIM+I)=XG(I)
  160       X(NDIM+I)=XG(I)
            NTRY = NTRY + 1
            XMAX = 1.D0 - XF
            XP2T = XBJ
            IF(XMAX.LE.XP2T) THEN
               write(6,*) '4. xmax<xp2t ',xmax,xp2t
               GOTO 10
            endif
            IF(NTRY.GT.NTRMAX) THEN
               write(6,*) ' too many trials for PI;',
     +         '  event rejected,mix,pi'
               GOTO 10
c               RETURN
            ENDIF
            XR = XP2T*(XMAX/XP2T)**X(NDIM+1)
            T2MIN = MP*MP*XR*XR/(1.D0-XR)
            T2MN = -(Q2 *(1.D0 - XR/XBJ) + 4.D0*DBLE(ULMASS(211))**2)
            IF(T2MN.LT.T2MAXO) THEN
               T2MAX = T2MN
            ELSE
               T2MAX = T2MAXO
            ENDIF

            T2 = T2MIN*((T2MAX/T2MIN)**X(NDIM+2))
            WTDIST = 0.D0
            CALL RAT2DI(KINT(2,2),XR,-T2,WTDIST)
            WTDIST = WTDIST * T2*DLOG(T2MAX/T2MIN)*XR*DLOG(XMAX/XP2T)
c include that when ng <0 or ng>30 because weight is only included in RASTFU,
c in RAT2DI weight=1.
cnew
            XPR = SNGL(XP2T)
            T2GKI = SNGL(-T2)
            XFGKI = SNGL(XR)
            CALL RASTFU(100,SNGL(XP2T/XR),SNGL(Q2),XPQ)
            WTDIST = WTDIST*DBLE(XPQ(KPA))
cnew
c add safety margin 1.5 for rejection
            WTT = WTDIST/(1.5D0*WTMA)
            WTRN = draprn()
            IF(WTRN.GT.WTT) THEN
               GOTO 150
            ENDIF
            WPA = FXN1(X,WDUM)
            IF(WPA.LE.0.0) GOTO 150
         ELSE
            WRITE(6,*) ' something"s wrong here '
            WRITE(6,*) ' RNTEST = ',RNTEST,' RF2DIS = ',RF2DIS, ' '
     +      //'RF2DIF = ',RF2DIF,' RF2PI = ',RF2PI
         ENDIF
         WPA = FXN1(X,WDUM)
      ENDIF


      IGENFL = 0
c      write(6,*)'here before MEPS mixing',WPA,KPA
      DO 170 I=1,NDIMEN
  170 XV(I) = X(I)
c check whether event mixing wanted by user
      IHERPYS = 0
      IMIX = IFULL
      IWEI = 1
c      write(6,*) ' 1. event xpr,xfgki',xpr,xfgki
c      write(6,*) ' event ',imix,ndim,ndimen
      IF(IMIX.EQ.1) THEN
c         WPA = FXN1(X,WDUM)
c         write(6,*) ' wpa before qcdmix ',wpa,x
         CALL QCDMIX(X,IERR)
c check on QCDMIX
         IF(LST(21).NE.0) THEN
            LERR(LST(21)) = LERR(LST(21)) + 1
         ENDIF
         IF(IERR.NE.0) THEN
            write(6,*) ' qcdmix error ',ierr
            GOTO 10
         ENDIF
      ENDIF
c      write(6,*) ' 2. event xpr,xfgki',xpr,xfgki
      IGENFL = 1
c zero MEINFO
      ZQGKI = 99999.
      XPGKI = 99999.
      PHITGKI = 99999.
c............
c      IF(IPRO.NE.20) THEN
      IF(IPRO.EQ.20.OR.IPRO.EQ.30) THEN
      ELSE
         IDEBUG = 0
c       write(6,*) 'EVENT: before 2nd FXN1, WPA= ',WPA,IPRO,KPA,idir,x
         IF(ISEMIH.EQ.0) THEN
            WPA = FXN1(X,WDUM)
            IDEBUG=IDEBUGO
c       write(6,*) 'EVENT: after 2nd FXN1, WPA= ',WPA,IPRO,KPA,idir,x
            IF(WPA.LE.0.0D0) THEN
c           write(6,*) 'EVENT: after 2nd FXN1, WPA= ',WPA,IPRO,KPA,idir,x
               GOTO 10
            ENDIF
         ENDIF
      ENDIF
  180 CONTINUE
c      write(6,*) ' 3. event xpr,xfgki',xpr,xfgki
      IWEI = 0
c      write(6,*) ' event NIA1 ',nia1
c      IF(IPRO.EQ.20.OR.IPRO.EQ.21) THEN
      IF(IPRO.EQ.30) THEN
c      write(6,*) ' check kt2 before satrev',kt2
         CALL RGSATREV
c        write(6,*) '  event before reshuffling'
c        write(6,*) ' event nia1,nia2,nf1,nf2 ',nia1,nia2,nf1,nf2
c        call dulist(1)
         IRAD = 0
         IF(K(4,2).eq.22.and.K(4,1).eq.1) IRAD=1
         DO I=1,5
            DP(N+1,I) = DP(3,I)
            K(N+1,I) = K(3,I)
            K(N+2,I) = K(4,I)
            DP(N+2,I) = DP(4,I)
            DP(3,I) = DP(NIA1,I)
            K(3,I) = K(NIA1,I)
            IF(IRAD.eq.1) then
               K(5,I) = K(N+2,I)
               DP(5,I) = DP(N+2,I)
            endif
            DP(4,I) = DP(N+1,I)
            K(4,I) = K(N+1,I)
            DP(N+1,I) = 0
            K(N+1,I) = 0
            DP(N+2,I) = 0
            K(N+2,I) = 0
         ENDDO
         nia1 = nia1 - 1 - irad
c        write(6,*) ' irad ',irad
c         write(6,*) ' event nf1,nf2,shh',nf1,nf2,mx2,sm2
c         call dulist(1)
         IF(IPY(13).EQ.1) THEN
            QMAX = SQRT(Mx2)/2.
            IF(NF2.EQ.NF1+1) THEN
               NFI2 = N
               NFI1 = N-1
            ELSE
               QMAX = SQRT(SM2)
               NFI2 = N
               NFI1 = N-2
            ENDIF
c        write(6,*) ' qmax ',qmax,mx2,sm2
            CALL DUSHOW(NFI1,NFI2,QMAX)
         ENDIF
         call rghaprep

         CALL DUEDIT(14)
      ELSEIF(IPRO.EQ.20.OR.IPRO.EQ.21) THEN
         DO I=1,5
            DP(N+1,I) = DP(3,I)
            K(N+1,I) = K(3,I)
            DP(3,I) = DP(4,I)
            K(3,I) = K(4,I)
            DP(4,I) = DP(N+1,I)
            K(4,I) = K(N+1,I)
            DP(N+1,I) = 0
            K(N+1,I) = 0
         ENDDO
         IF(IPY(13).EQ.1) THEN
c            write(6,*) ' event nf1,nf2,shh',nf1,nf2,shh
            IF(IPRO.EQ.21) THEN
               QMAX = 0.5*SQRT(SHH)
            ELSEIF(IPRO.EQ.20) THEN
               QMAX=SNGL(DOT1(NF1,NF2))
            ENDIF
            CALL DUSHOW(NF1,NF2,QMAX)
         ENDIF
         call rghaprep
         K(NF1,1)=21
         K(NF1+1,1)=21
         K(NF2,1)=21
         CALL DUEDIT(14)
      ELSE

         IF(IFPS.NE.10) THEN
            IF(IPRO.NE.100) THEN
c             call dulist(1)
c            write(6,*) ' before LMEPS '
               IHF=0
               IF(IPRO.EQ.99) THEN
                  CALL LMEPS99
               ELSE
                  CALL LMEPS
               ENDIF
               IHF = IHFO
c            write(6,*) ' after LMEPS '
c check on lmeps and pyremn
               IF(LST(21).NE.0) THEN
                  LERR(LST(21)) = LERR(LST(21)) + 1
                  GOTO 10
               ENDIF
            ELSEIF(IPRO.EQ.100) THEN
C...Delete empty lines
               CALL DUEDIT(12)
            ENDIF
         ELSE
            CALL LMEPS
c check on lmeps and pyremn
            IF(LST(21).NE.0) THEN
               LERR(LST(21)) = LERR(LST(21)) + 1
               GOTO 10
            ENDIF
            MSTA(5)=0
c         write(6,*) ' event: NF1,NF2 ',NF1,NF2
            DO 210 I=1,N
               DO 210 J=1,5
  210       P(I,J) = SNGL(DP(I,J))
c         write(6,*) ' before arexec '
            CALL AREXEC
            DO 220 I=1,N
               DO 220 J=1,5
  220       DP(I,J) = DBLE(P(I,J))
         ENDIF
      ENDIF
c     write(6,*) ' before prodiff'
      IF(NFRAG.EQ.10.AND.NPOM.NE.20.AND.NPOM.NE.21
     +           .AND.IDIR.EQ.0) CALL PRODIFF
c change interacting gamma to z0 on request from experiment
      DO 230 I=3,N
         IF(K(I,2).EQ.22.AND.K(I,1).EQ.21) K(I,2)=23
  230 CONTINUE
c     write(6,*) ' end of event nia1,nia2,nf1,nf2 ',nia1,nia2,nf1,nf2
c      call lulist(1)

      CALL DUDBRB(0,N,0.D0,0.D0,CM(1)/CM(4),CM(2)/CM(4),CM(3)/CM(4))
      DO 240  I=1,N
         DO 240  J=1,5
  240 P(I,J) = SNGL(DP(I,J))
      CALL LUDBRB(0,N,0.,0.,-CM(1)/CM(4),-CM(2)/CM(4),-CM(3)/CM(4))
      IF(NFRAG.GE.1) CALL LUEXEC
      CALL LUDBRB(0,N,0.,0.,CM(1)/CM(4),CM(2)/CM(4),CM(3)/CM(4))
c only for decay of  p - diss
      IF(NFRAG.EQ.10.AND.NPOM.NE.20.AND.NPOM.NE.21
     +           .AND.IDIR.EQ.0) CALL PDISDC
c....
      IF(MSTU(24).NE.0) THEN
         WRITE(6,*) 'MSTU(24)= ',MSTU(24)
         CALL LULIST(1)
      ENDIF
      NOUT = NOUT + 1
      IF(MOD(NOUT,nPrint).EQ.0) write(6,*) ' Nr of events ',NOUT
      IF(XBJ.LT.0.001) THEN
         IF(IDIR.EQ.1.AND.IPRO.EQ.12) IQPML1 = IQPML1+1
         IF(IDIR.EQ.1.AND.IPRO.EQ.13) IQQBL1 = IQQBL1+1
         IF(IDIR.EQ.1.AND.IPRO.EQ.14) IQQBCL1 = IQQBCL1+1
         IF(IDIR.EQ.1.AND.IPRO.EQ.15) IQCDCL1 = IQCDCL1+1
         IF(IDIR.EQ.0.AND.IPRO.EQ.12) IQPML0 = IQPML0+1
         IF(IDIR.EQ.0.AND.IPRO.EQ.13) IQQBL0 = IQQBL0+1
         IF(IDIR.EQ.0.AND.IPRO.EQ.15) IQCDCL0 = IQCDCL0+1
      ELSE
         IF(IDIR.EQ.1.AND.IPRO.EQ.12) IQPMH1 = IQPMH1+1
         IF(IDIR.EQ.1.AND.IPRO.EQ.13) IQQBH1 = IQQBH1+1
         IF(IDIR.EQ.1.AND.IPRO.EQ.14) IQQBCH1 = IQQBCH1+1
         IF(IDIR.EQ.1.AND.IPRO.EQ.15) IQCDCH1 = IQCDCH1+1
         IF(IDIR.EQ.0.AND.IPRO.EQ.12) IQPMH0 = IQPMH0+1
         IF(IDIR.EQ.0.AND.IPRO.EQ.13) IQQBH0 = IQQBH0+1
         IF(IDIR.EQ.0.AND.IPRO.EQ.15) IQCDCH0 = IQCDCH0+1
      ENDIF
      IF(IMIX.EQ.1) THEN
         IF(IPRO.EQ.12) THEN
            NQPM = NQPM + 1
         ELSEIF(IPRO.EQ.13) THEN
            NQQB = NQQB + 1
         ELSEIF(IPRO.EQ.14) THEN
            IF(AM(1).LT.2.D0) NQQBC = NQQBC + 1
            IF(AM(1).GT.2.D0) NQQBB = NQQBB + 1
         ELSEIF(IPRO.EQ.15) THEN
            NQCDC = NQCDC + 1
         ENDIF
      ENDIF
      IF(IPRO.EQ.18) THEN
         NPRT = NPRT + 1
         IF(IRESPRO.EQ.1) NRPA=NRPA+1
         IF(IRESPRO.EQ.2) NRPB=NRPB+1
         IF(IRESPRO.EQ.3) NRPC=NRPC+1
         IF(IRESPRO.EQ.4) NRPD=NRPD+1
         IF(IRESPRO.EQ.5) NRPE=NRPE+1
         IF(IRESPRO.EQ.6) NRPF=NRPF+1
         IF(IRESPRO.EQ.7) NRPG=NRPG+1
      ENDIF
      IF(IDISDIF.GE.1) THEN
c         write(6,*) IDIR,NG,NPOM
         IF(NG.EQ.20.AND.NPOM.EQ.20) IDIR =2
         IF(IDIR.EQ.1) THEN
            NDIS = NDIS + 1
            IF(IPRO.EQ.12) THEN
               NQPMDS = NQPMDS + 1
            ELSEIF(IPRO.EQ.13) THEN
               NQQBDS = NQQBDS + 1
            ELSEIF(IPRO.EQ.14) THEN
               IF(AM(1).LT.2.D0) NQQBCDS = NQQBCDS + 1
               IF(AM(1).GT.2.D0) NQQBBDS = NQQBBDS + 1
            ELSEIF(IPRO.EQ.15) THEN
               NQCDCDS = NQCDCDS + 1
            ENDIF
         ELSEIF(IDIR.EQ.0) THEN
            NDIF = NDIF + 1
            IF(IPRO.EQ.12) THEN
               NQPMDF = NQPMDF + 1
            ELSEIF(IPRO.EQ.13) THEN
               NQQBDF = NQQBDF + 1
            ELSEIF(IPRO.EQ.14) THEN
               IF(AM(1).LT.2.D0) NQQBCDF = NQQBCDF + 1
               IF(AM(1).GT.2.D0) NQQBBDF = NQQBBDF + 1
            ELSEIF(IPRO.EQ.15) THEN
               NQCDCDF = NQCDCDF + 1
            ENDIF
         ELSEIF(IDIR.EQ.2) THEN
            NPI = NPI + 1
            IF(IPRO.EQ.12) THEN
               NQPMPI = NQPMPI + 1
            ELSEIF(IPRO.EQ.13) THEN
               NQQBPI = NQQBPI + 1
            ELSEIF(IPRO.EQ.14) THEN
               IF(AM(1).LT.2.D0) NQQBCPI = NQQBCPI + 1
               IF(AM(1).GT.2.D0) NQQBBPI = NQQBBPI + 1
            ELSEIF(IPRO.EQ.15) THEN
               NQCDCPI = NQCDCPI + 1
            ENDIF
         ENDIF
      ENDIF
      IF(MOD(NOUT,nPrint*5).EQ.0) THEN
         write(6,*) ' Nr of events ',NOUT,NQPM,NQQB
         write(6,*) ' Nr of DIS events x<10**-3 ',IQPML1,IQQBL1,IQCDCL1
         write(6,*) ' Nr of DIS events x>10**-3 ',IQPMH1,IQQBH1,IQCDCH1
         write(6,*) ' Nr of DIF events x<10**-3 ',IQPML0,IQQBL0,IQCDCL0
         write(6,*) ' Nr of DIF events x>10**-3 ',IQPMH0,IQQBH0,IQCDCH0
         IF(IDISDIF.GE.1) THEN
            write(6,*) ' all qpm qqb ccb qcdc '
            write(6,*) ' Nr of DIS events ',NDIS,NQPMDS,NQQBDS,NQQBCDS,
     +       NQQBBDS,NQCDCDS
            write(6,*) ' Nr of DIF events ',NDIF,NQPMDF,NQQBDF,NQQBCDF,
     +       NQQBBDF,NQCDCDF
            write(6,*) ' Nr of pi  events ',NPI,NQPMPI,NQQBPI,NQQBCPI,
     +       NQQBBPI,NQCDCPI
         ENDIF
      ENDIF
c      write(6,*) ' EVENT: x,Q2,XR',XBJ,Q2,XR
c      write(6,*) ' event: IPRO = ',IPRO,KPA
      IF(NOUT.LE.NPRIN) THEN
         write(6,*) ' event: IPRO = ',IPRO
         CALL LULIST(1)
      ENDIF
      IF(MOD(NOUT,nPrint*5).EQ.0) THEN
         write(6,*) 'Nr qpm ',NQPM
         write(6,*) 'Nr bgf ',NQQB
         write(6,*) 'Nr ccbar',NQQBC
         write(6,*) 'Nr bbbar',NQQBB
         write(6,*) 'Nr qcdc ',NQCDC
      endif
      NG = NGO
      NPOM = NPOMO
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.23  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  20.32.53  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE FRAG
	IMPLICIT NONE
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
	Integer IJOIN1,IJOIN2,NJOIN,NFLSP,NFLCH,KFL,KFLSP,KINTER
	Integer KFLCH
	REAL PHISPL,PTSPL,CHI,draprn
      DIMENSION IJOIN1(10),IJOIN2(10)
      DATA PHISPL/0./,PTSPL/0./
      DATA NFLSP/0/,NFLCH/0/
      IF(NFRAG.EQ.10.AND.NPOM.NE.20.AND.NPOM.NE.21
     &                .AND.IDIR.EQ.0) CALL PRODIFF
      IF(NPOM.EQ.20.OR.NPOM.EQ.21) THEN
         KFL = KINT(2,2)
         KINTER = K(NIA2,2)
         CALL PYSPLI(KFL,KINTER,KFLCH,KFLSP)
c         write(6,*) ' KFLCH =',KFLCH,' KFLSP =',KFLSP
         K(NF1+1,1)=21
C-- new test
         CHI = draprn()
         IF(IABS(KFLCH).GT.0.AND.IABS(KFLSP).GT.0) THEN
            K(N+1,1)=2
            K(N+1,2)=KFLCH
            P(N+1,1)=P(NF1+1,1)*DBLE((1.0-CHI)+PTSPL*COS(PHISPL))
            P(N+1,2)=P(NF1+1,2)*DBLE((1.0-CHI)+PTSPL*SIN(PHISPL))
            P(N+1,5)=DBLE(ULMASS(KFLCH))
            NFLCH = N+1
            K(N+2,1)=2
            K(N+2,2)=KFLSP
            P(N+2,5)=DBLE(ULMASS(KFLSP))
            P(N+2,1)=P(NF1+1,1)*DBLE(CHI)-DBLE(PTSPL*COS(PHISPL))
            P(N+2,2)=P(NF1+1,2)*DBLE(CHI)-DBLE(PTSPL*SIN(PHISPL))
            NFLSP = N+2
            P(N+1,4)=DBLE((1.0-CHI))*P(NF1+1,4)
            P(N+1,3)=DBLE((1.0-CHI))*P(NF1+1,3)
            P(N+2,4)=DBLE(CHI)*P(NF1+1,4)
            P(N+2,3)=DBLE(CHI)*P(NF1+1,3)
            N = N+2
            NJOIN = 2
            IF(IABS(KFLCH).LT.10.AND.IABS(KFLSP).LT.10) THEN
               IF(KFLCH.GT.0.AND.IABS(KFLSP).GT.0) THEN
                  IJOIN1(1) = NF2
                  IJOIN1(2) = NFLCH
                  IJOIN2(1) = NF1
                  IJOIN2(2) = NFLSP
               ELSE
                  IJOIN1(1) = NF1
                  IJOIN1(2) = NFLCH
                  IJOIN2(1) = NF2
                  IJOIN2(2) = NFLSP
               ENDIF
               CALL LUJOIN(NJOIN,IJOIN1)
               CALL LUJOIN(NJOIN,IJOIN2)
            ELSEIF(IABS(KFLCH).GT.10.AND.IABS(KFLSP).LT.10) THEN
               IJOIN1(1) = NF1
               IJOIN1(2) = NFLSP
               NJOIN = 2
               CALL LUJOIN(NJOIN,IJOIN1)
            ENDIF
         ELSEIF(IABS(KFLCH).EQ.0.AND.IABS(KFLSP).LT.10) THEN
            K(N+1,1)=2
            K(N+1,2)=KFLSP
            P(N+1,1)=P(NF1+1,1)
            P(N+1,2)=P(NF1+1,2)
            P(N+1,3)=P(NF1+1,3)
            P(N+1,4)=P(NF1+1,4)
            P(N+1,5)=DBLE(ULMASS(KFLSP))
            NFLSP = N+1
            NJOIN = 2
            IJOIN1(1) = NF1
            IJOIN1(2) = NFLSP
            N=N+1
            CALL LUJOIN(NJOIN,IJOIN1)
         ELSEIF(IABS(KFLCH).LT.10.AND.IABS(KFLSP).EQ.0) THEN
            K(N+1,1)=2
            K(N+1,2)=KFLCH
            P(N+1,1)=P(NF1+1,1)
            P(N+1,2)=P(NF1+1,2)
            P(N+1,3)=P(NF1+1,3)
            P(N+1,4)=P(NF1+1,4)
            P(N+1,5)=DBLE(ULMASS(KFLCH))
            NFLCH = N+1
            NJOIN = 2
            IJOIN1(1) = NF1
            IJOIN1(2) = NFLCH
            N=N+1
            CALL LUJOIN(NJOIN,IJOIN1)
         ELSEIF(IABS(KFLCH).GT.10.AND.IABS(KFLSP).LT.10) THEN
            NJOIN = 3
            IJOIN1(1) = NF1
            IJOIN1(2) = NFLSP
            IJOIN1(3) = NF2
            CALL LUJOIN(NJOIN,IJOIN1)
         ELSEIF(IABS(KFLCH).LT.10.AND.IABS(KFLSP).GT.10) THEN
            NJOIN = 3
            IJOIN1(1) = NF1
            IJOIN1(2) = NFLCH
            IJOIN1(3) = NF2
            CALL LUJOIN(NJOIN,IJOIN1)
         ELSE
            write(6,*) ' this configuration not implemented'
         ENDIF
      ENDIF
      CALL DUPREP(NF1)
      RETURN
      END
*CMZ :  2.08/00 14/06/99  19.13.55  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  20.34.44  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      FUNCTION FXN1(X,WEIGHT)
      IMPLICIT NONE
      Double Precision X,WEIGHT,WEIG,FXN1
      DIMENSION X(20)
      Integer Ncall,I,J
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
      DATA NCALL/0/
      DO 10  I=1,20
         DO 10 J=1,5
            K(I,J) = 0
   10 P(I,J) = 0.0D0
      N=0
      WEIG=0.D0
      FXN1=0.D0
      IF(IDIR.EQ.0) THEN
         IF(IPRO.EQ.10.OR.IPRO.EQ.13.OR.IPRO.EQ.15) THEN
            CALL DIFFR1(X,WEIG)
         ELSEIF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
            CALL DIFFR2(X,WEIG)
         ELSEIF(IPRO.EQ.12) THEN
            CALL DIFFR3(X,WEIG)
         ELSEIF(IPRO.EQ.18) THEN
            CALL DIFFR7(X,WEIG)
         ELSEIF(IPRO.EQ.20) THEN
            CALL DIFFR5(X,WEIG)
         ELSEIF(IPRO.EQ.21) THEN
            CALL DIFFR6(X,WEIG)
         ELSEIF(IPRO.EQ.30) THEN
            CALL DIFFR30(X,WEIG)
         ELSEIF(IPRO.EQ.100) THEN
            CALL DIFFR4(X,WEIG)
         ELSE
            WRITE(6,*) ' FXN1: wrong subprocess selected; IPRO = ',
     +      IPRO
            WRITE(6,*) ' FXN1: PROGRM STOPPED '
            STOP
         ENDIF
      ELSEIF(IDIR.EQ.1) THEN
         IF(IPRO.EQ.10.OR.IPRO.EQ.13.OR.IPRO.EQ.15) THEN
            CALL DIR1(X,WEIG)
         ELSEIF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
            CALL DIR2(X,WEIG)
         ELSEIF(IPRO.EQ.12) THEN
            CALL DIR3(X,WEIG)
         ELSEIF(IPRO.EQ.18) THEN
            CALL DIR4(X,WEIG)
         ELSEIF(IPRO.EQ.99) THEN
            CALL DIR99(X,WEIG)
         ELSE
            WRITE(6,*) ' FXN1: wrong subprocess selected; IPRO = ',
     +      IPRO
            WRITE(6,*) ' FXN1: PROGRM STOPPED '
            STOP
         ENDIF
      ENDIF
C BOOST BACK TO OVERALL CMS
c      write(6,*) '  FXN1 ',weig,X
      IF(WEIG.EQ.0.0) RETURN
      IF(IPRO.EQ.20.OR.IPRO.EQ.21.OR.IPRO.EQ.30) THEN
      ELSE
         IF(IPRO.NE.12.OR.IPRO.EQ.100) CALL DUDBRB(0,N,0.D0,0.D0,
     +   DBCMS(1)/DBCMS(4),DBCMS(2)/DBCMS(4), DBCMS(3)/DBCMS(4))
      ENDIF
      ncall = ncall + 1
c      call dulist(1)
      FXN1=WEIG
      WEIGHT = WEIG
      RETURN
      END
*CMZ :  2.07/03 15/05/99  20.38.29  by  Hannes Jung
*-- Author :
C#######################################################################
C
C   One- and two-dimensional adaptive Gaussian integration routines.
C
C **********************************************************************

      SUBROUTINE GADAP(A0,B0,F,EPS,SUM)
	IMPLICIT NONE
C
C   PURPOSE           - INTEGRATE A FUNCTION F(X)
C   METHOD            - ADAPTIVE GAUSSIAN
C   USAGE             - CALL GADAP(A0,B0,F,EPS,SUM)
C   PARAMETERS  A0    - LOWER LIMIT (INPUT,REAL)
C               B0    - UPPER LIMIT (INPUT,REAL)
C               F     - FUNCTION F(X) TO BE INTEGRATED. MUST BE
C                       SUPPLIED BY THE USER. (INPUT,REAL FUNCTION)
C               EPS   - DESIRED RELATIVE ACCURACY. IF SUM IS SMALL EPS
C                       WILL BE ABSOLUTE ACCURACY INSTEAD. (INPUT,REAL)
C               SUM   - CALCULATED VALUE FOR THE INTEGRAL (OUTPUT,REAL)
C   PRECISION         - SINGLE
C   REQ'D PROG'S      - F
C   AUTHOR            - T. JOHANSSON, LUND UNIV. COMPUTER CENTER, 1973
C   REFERENCE(S)      - THE AUSTRALIAN COMPUTER JOURNAL,3 P.126 AUG. -71
C
	Integer Num,Ifu,N,L,I
	Real F,A,B,F1,F2,F3,S,F1F,F2F,F3F,AA,BB,EPS,RED,SUM,C
	Real A0,B0,DSUM,W1,U2,SOLD,SS
      COMMON/GADAP1/ NUM,IFU
      EXTERNAL F
      DIMENSION A(300),B(300),F1(300),F2(300),F3(300),S(300),N(300)

      DSUM(F1F,F2F,F3F,AA,BB)=5./18.*(BB-AA)*(F1F+1.6*F2F+F3F)
      IF(EPS.LT.1.0E-8) EPS=1.0E-8
      RED=1.3
      L=1
      I=1
      SUM=0.
      C=SQRT(15.)/5.
      A(1)=A0
      B(1)=B0
      F1(1)=F(0.5*(1+C)*A0+0.5*(1-C)*B0)
      F2(1)=F(0.5*(A0+B0))
      F3(1)=F(0.5*(1-C)*A0+0.5*(1+C)*B0)
      IFU=3
      S(1)=  DSUM(F1(1),F2(1),F3(1),A0,B0)
   10 CONTINUE
      L=L+1
      N(L)=3
      EPS=EPS*RED
      A(I+1)=A(I)+C*(B(I)-A(I))
      B(I+1)=B(I)
      A(I+2)=A(I)+B(I)-A(I+1)
      B(I+2)=A(I+1)
      A(I+3)=A(I)
      B(I+3)=A(I+2)
      W1=A(I)+(B(I)-A(I))/5.
      U2=2.*W1-(A(I)+A(I+2))/2.
      F1(I+1)=F(A(I)+B(I)-W1)
      F2(I+1)=F3(I)
      F3(I+1)=F(B(I)-A(I+2)+W1)
      F1(I+2)=F(U2)
      F2(I+2)=F2(I)
      F3(I+2)=F(B(I+2)+A(I+2)-U2)
      F1(I+3)=F(A(I)+A(I+2)-W1)
      F2(I+3)=F1(I)
      F3(I+3)=F(W1)
      IFU=IFU+6
      IF(IFU.GT.5000) GOTO 40
      S(I+1)=  DSUM(F1(I+1),F2(I+1),F3(I+1),A(I+1),B(I+1))
      S(I+2)=  DSUM(F1(I+2),F2(I+2),F3(I+2),A(I+2),B(I+2))
      S(I+3)=  DSUM(F1(I+3),F2(I+3),F3(I+3),A(I+3),B(I+3))
      SS=S(I+1)+S(I+2)+S(I+3)
      I=I+3
      IF(I.GT.300)GOTO 30
      SOLD=S(I-3)
      IF(ABS(SOLD-SS).GT.EPS*(1.+ABS(SS))/2.) GOTO 10
      SUM=SUM+SS
      I=I-4
      N(L)=0
      L=L-1
   20 CONTINUE
      IF(L.EQ.1) GOTO 40
      N(L)=N(L)-1
      EPS=EPS/RED
      IF(N(L).NE.0) GOTO 10
      I=I-1
      L=L-1
      GOTO 20
   30 WRITE(6,10000)
10000 FORMAT(' GADAP:I TOO BIG')
   40 RETURN
      END
*CMZ :  2.08/00 06/06/99  16.04.05  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  20.43.21  by  Hannes Jung
*-- Author :
C **********************************************************************

      SUBROUTINE GADAP2(A0,B0,FL,FU,F,EPS,SUM)
C
C   PURPOSE           - INTEGRATE A FUNCTION F(X,Y) OF TWO VARIABLES
C   METHOD            - ADAPTIVE GAUSSIAN IN BOTH DIRECTIONS
C   USAGE             - CALL GADAP2(A0,B0,FL,FU,F,EPS,SUM)
C   PARAMETERS  A0    - LOWER X-LIMIT (INPUT,REAL)
C               B0    - UPPER X-LIMIT (INPUT,REAL)
C               FL    - USER SUPPLIED FUNCTION FL(X) GIVING THE LOWER
C                       Y-LIMIT FOR A GIVEN X-VALUE
C                       (INPUT,REAL FUNCTION)
C               FU    - USER SUPPLIED FUNCTION FU(X) GIVING THE UPPER
C                       Y-LIMIT FOR A GIVEN X-VALUE
C                       (INPUT,REAL FUNCTION)
C               F     - USER SUPPLIED FUNCTION F(X,Y) TO BE INTEGRATED
C                       (INPUT,REAL FUNCTION)
C               EPS   - DESIRED ACCURACY (INPUT,REAL)
C               SUM   - CALCULATED VALUE FOR THE INTEGRAL (OUTPUT,REAL)
C   PRECISION         - SINGLE
C   REQ'D PROG'S      - FL,FU,F,GADAPF
C   AUTHOR            - THOMAS JOHANSSON, LDC,1973
C
	IMPLICIT NONE
	Integer NUM,IFU,I,L,N
      COMMON/GADAP1/ NUM,IFU
	Real F,FL,FU,GADAPF,A,B,F1,F2,F3,S,A0,B0,SS,SOLD
	Real DSUM,F1F,F2F,F3F,AA,BB,RED,SUM,EPS,AY,BY,W1,U2,C,X
      EXTERNAL F,FL,FU
      DIMENSION A(300),B(300),F1(300),F2(300),F3(300),S(300),N(300)

      DSUM(F1F,F2F,F3F,AA,BB)=5./18.*(BB-AA)*(F1F+1.6*F2F+F3F)
      IF(EPS.LT.1.0E-8) EPS=1.0E-8
      RED=1.4
      L=1
      I=1
      SUM=0.
      C=SQRT(15.)/5.
      A(1)=A0
      B(1)=B0
      X=0.5*(1+C)*A0+0.5*(1-C)*B0
      AY=FL(X)
      BY=FU(X)
      F1(1)=GADAPF(X,AY,BY,F,EPS)
      X=0.5*(A0+B0)
      AY=FL(X)
      BY=FU(X)
      F2(1)=GADAPF(X,AY,BY,F,EPS)
      X=0.5*(1-C)*A0+0.5*(1+C)*B0
      AY=FL(X)
      BY=FU(X)
      F3(1)=GADAPF(X,AY,BY,F,EPS)
      IFU=3
      S(1)=  DSUM(F1(1),F2(1),F3(1),A0,B0)
   10 CONTINUE
      L=L+1
      N(L)=3
      EPS=EPS*RED
      A(I+1)=A(I)+C*(B(I)-A(I))
      B(I+1)=B(I)
      A(I+2)=A(I)+B(I)-A(I+1)
      B(I+2)=A(I+1)
      A(I+3)=A(I)
      B(I+3)=A(I+2)
      W1=A(I)+(B(I)-A(I))/5.
      U2=2.*W1-(A(I)+A(I+2))/2.
      X=A(I)+B(I)-W1
      AY=FL(X)
      BY=FU(X)
      F1(I+1)=GADAPF(X,AY,BY,F,EPS)
      F2(I+1)=F3(I)
      X=B(I)-A(I+2)+W1
      AY=FL(X)
      BY=FU(X)
      F3(I+1)=GADAPF(X,AY,BY,F,EPS)
      X=U2
      AY=FL(X)
      BY=FU(X)
      F1(I+2)=GADAPF(X,AY,BY,F,EPS)
      F2(I+2)=F2(I)
      X=B(I+2)+A(I+2)-U2
      AY=FL(X)
      BY=FU(X)
      F3(I+2)=GADAPF(X,AY,BY,F,EPS)
      X=A(I)+A(I+2)-W1
      AY=FL(X)
      BY=FU(X)
      F1(I+3)=GADAPF(X,AY,BY,F,EPS)
      F2(I+3)=F1(I)
      X=W1
      AY=FL(X)
      BY=FU(X)
      F3(I+3)=GADAPF(X,AY,BY,F,EPS)
      IFU=IFU+6
      IF(IFU.GT.5000) GOTO 40
      S(I+1)=  DSUM(F1(I+1),F2(I+1),F3(I+1),A(I+1),B(I+1))
      S(I+2)=  DSUM(F1(I+2),F2(I+2),F3(I+2),A(I+2),B(I+2))
      S(I+3)=  DSUM(F1(I+3),F2(I+3),F3(I+3),A(I+3),B(I+3))
      SS=S(I+1)+S(I+2)+S(I+3)
      I=I+3
      IF(I.GT.300)GOTO 30
      SOLD=S(I-3)
      IF(ABS(SOLD-SS).GT.EPS*(1.+ABS(SS))/2.) GOTO 10
      SUM=SUM+SS
      I=I-4
      N(L)=0
      L=L-1
   20 CONTINUE
      IF(L.EQ.1) GOTO 40
      N(L)=N(L)-1
      EPS=EPS/RED
      IF(N(L).NE.0) GOTO 10
      I=I-1
      L=L-1
      GOTO 20
   30 WRITE(6,10000)
10000 FORMAT(' GADAP:I TOO BIG')
   40 RETURN
      END
*CMZ :  2.07/03 15/05/99  20.45.54  by  Hannes Jung
*-- Author :
C **********************************************************************


      FUNCTION GADAPF(X,A0,B0,F,EPS)
	IMPLICIT NONE
	Integer NUM,IFU,I,L,N
	Real F,A,B,F1,F2,F3,S,DSUM,F1F,F2F,F3F,AA,BB,EPS,RED
	Real SUM,C,A0,B0,X,W1,U2,SS,SOLD,GADAPF
      COMMON/GADAP1/ NUM,IFU
      EXTERNAL F
      DIMENSION A(300),B(300),F1(300),F2(300),F3(300),S(300),N(300)

      DSUM(F1F,F2F,F3F,AA,BB)=5./18.*(BB-AA)*(F1F+1.6*F2F+F3F)
      IF(EPS.LT.1.0E-8) EPS=1.0E-8
      RED=1.4
      L=1
      I=1
      SUM=0.
      C=SQRT(15.)/5.
      A(1)=A0
      B(1)=B0
      F1(1)=F(X,0.5*(1+C)*A0+0.5*(1-C)*B0)
      F2(1)=F(X,0.5*(A0+B0))
      F3(1)=F(X,0.5*(1-C)*A0+0.5*(1+C)*B0)
      IFU=3
      S(1)=  DSUM(F1(1),F2(1),F3(1),A0,B0)
   10 CONTINUE
      L=L+1
      N(L)=3
      EPS=EPS*RED
      A(I+1)=A(I)+C*(B(I)-A(I))
      B(I+1)=B(I)
      A(I+2)=A(I)+B(I)-A(I+1)
      B(I+2)=A(I+1)
      A(I+3)=A(I)
      B(I+3)=A(I+2)
      W1=A(I)+(B(I)-A(I))/5.
      U2=2.*W1-(A(I)+A(I+2))/2.
      F1(I+1)=F(X,A(I)+B(I)-W1)
      F2(I+1)=F3(I)
      F3(I+1)=F(X,B(I)-A(I+2)+W1)
      F1(I+2)=F(X,U2)
      F2(I+2)=F2(I)
      F3(I+2)=F(X,B(I+2)+A(I+2)-U2)
      F1(I+3)=F(X,A(I)+A(I+2)-W1)
      F2(I+3)=F1(I)
      F3(I+3)=F(X,W1)
      IFU=IFU+6
      IF(IFU.GT.5000) GOTO 40
      S(I+1)=  DSUM(F1(I+1),F2(I+1),F3(I+1),A(I+1),B(I+1))
      S(I+2)=  DSUM(F1(I+2),F2(I+2),F3(I+2),A(I+2),B(I+2))
      S(I+3)=  DSUM(F1(I+3),F2(I+3),F3(I+3),A(I+3),B(I+3))
      SS=S(I+1)+S(I+2)+S(I+3)
      I=I+3
      IF(I.GT.300)GOTO 30
      SOLD=S(I-3)
      IF(ABS(SOLD-SS).GT.EPS*(1.+ABS(SS))/2.) GOTO 10
      SUM=SUM+SS
      I=I-4
      N(L)=0
      L=L-1
   20 CONTINUE
      IF(L.EQ.1) GOTO 40
      N(L)=N(L)-1
      EPS=EPS/RED
      IF(N(L).NE.0) GOTO 10
      I=I-1
      L=L-1
      GOTO 20
   30 WRITE(6,10000)
10000 FORMAT(' GADAP:I TOO BIG')
   40 GADAPF=SUM
      EPS=EPS/RED
      RETURN
      END
*CMZ :  2.07/03 15/05/99  20.53.56  by  Hannes Jung
*CMZ :  2.06/34 20/05/98  09.12.49  by  Hannes Jung
*CMZ :  2.04/00 06/12/96  10.13.01  by  Hannes Jung
*CMZ :  2.03/12 14/10/96  14.33.38  by  Hannes Jung
*-- Author :    Guenter Grindhammer   13/08/92

      SUBROUTINE GJEINI
*#**********************************************************************
*#
*#    SUBROUTINE GJEINI
*#
*# PURPOSE: initialise JETSET 7.404 (Oct. '94) parameter commons LUDAT1,
*#          2,3,4,R (this routine replaces BLOCK DATA LUDATA).
*#
*# NOTE: GJEINI has to be called by the user before any other JETSET
*#       routine.
*#
*# CALLING: UCOPY
*#
*#**********************************************************************
      IMPLICIT NONE
      CHARACTER*22  FLAG,CHECK

C---JETSET commons
      Real PARU,PARJ,PMAS,PARF,VCKM,BRAT,RRLU
	Integer MSTU,MSTJ,KCHG,MDCY,MDME,KFDP,MRLU
      COMMON /LUDAT1/ MSTU(200),PARU(200),MSTJ(200),PARJ(200)
      COMMON /LUDAT2/ KCHG(500,3),PMAS(500,4),PARF(2000),VCKM(4,4)
      COMMON /LUDAT3/ MDCY(500,3),MDME(2000,2),BRAT(2000),KFDP(2000,5)
      CHARACTER       CHAF*8
      COMMON /LUDAT4/ CHAF(500)
      COMMON /LUDATR/ MRLU(6),RRLU(100)
      SAVE /LUDAT1/,/LUDAT2/,/LUDAT3/,/LUDAT4/,/LUDATR/

      Integer       JSTU,JSTJ,JCHG,JDCY,JDME,JFDP,JRLU
      Real ZARU,ZARJ,ZMAS,ZARF,ZCKM,ZRAT
      DIMENSION       JSTU(200),ZARU(200),JSTJ(200),ZARJ(200)
      DIMENSION       JCHG(500,3),ZMAS(500,4),ZARF(2000),ZCKM(4,4)
      DIMENSION       JDCY(500,3),JDME(2000,2),ZRAT(2000),JFDP(2000,5)
      CHARACTER       ZHAF*8
      DIMENSION       ZHAF(500)
      DIMENSION       JRLU(6)
	Integer I,J

      DATA CHECK /'JETSET 7.4 INITIALISED'/

C...LUDAT1, containing status codes and most parameters.
      DATA JSTU/
     &    0,    0,    0, 4000,10000,  500, 2000,    0,    0,    2,
     1    6,    1,    1,    0,    1,    1,    0,    0,    0,    0,
     2    2,   10,    0,    0,    1,   10,    0,    0,    0,    0,
     3    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
     4    2,    2,    1,    4,    2,    1,    1,    0,    0,    0,
     5   25,   24,    0,    1,    0,    0,    0,    0,    0,    0,
     6    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
     7  30*0,
     &    1,    0,    0,    0,    0,    0,    0,    0,    0,    0,
     1    1,    5,    3,    5,    0,    0,    0,    0,    0,    0,
     2  60*0,
     8    7,  404, 1994,   08,   25,  700,    0,    0,    0,    0,
     9    0,    0,    0,    0,    0,    0,    0,    0,    0,    0/
      DATA ZARU/
     & 3.1415927, 6.2831854, 0.1973, 5.068, 0.3894, 2.568,   4*0.,
     1 0.001, 0.09, 0.01,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
     2   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     3   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     4  2.0,  1.0, 0.25,  2.5, 0.05,   0.,   0., 0.0001, 0.,   0.,
     5  2.5,  1.5,  7.0,  1.0,  0.5,  2.0,  3.2,   0.,   0.,   0.,
     6  40*0.,
     & 0.00729735, 0.232, 0., 0., 0.,  0.,   0.,   0.,   0.,   0.,
     1 0.20, 0.25,  1.0,  4.0,  10.,   0.,   0.,   0.,   0.,   0.,
     2 -0.693, -1.0, 0.387, 1.0, -0.08, -1.0, 1.0, 1.0, 1.0,   0.,
     3  1.0, -1.0,  1.0, -1.0,  1.0,   0.,   0.,   0.,   0.,   0.,
     4  5.0,  1.0,  1.0,   0.,  1.0,  1.0,   0.,   0.,   0.,   0.,
     5  1.0,   0.,   0.,   0., 1000., 1.0,  1.0,  1.0,  1.0,   0.,
     6  1.0,  1.0,  1.0,  1.0,  1.0,   0.,   0.,   0.,   0.,   0.,
     7  1.0,  1.0,  1.0,  1.0,  1.0,  1.0,  1.0,   0.,   0.,   0.,
     8  1.0,  1.0,  1.0,  0.0,  0.0,  1.0,  1.0,  0.0,  0.0,   0.,
     9   0.,   0.,   0.,   0.,  1.0,   0.,   0.,   0.,   0.,   0./
      DATA JSTJ/
     &    1,    3,    0,    0,    0,    0,    0,    0,    0,    0,
     1    4,    2,    0,    1,    0,    0,    0,    0,    0,    0,
     2    2,    1,    1,    2,    1,    2,    2,    0,    0,    0,
     3    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
     4    2,    2,    4,    2,    5,    3,    3,    0,    0,    0,
     5    0,    3,    0,    0,    0,    0,    0,    0,    0,    0,
     6  40*0,
     &    5,    2,    7,    5,    1,    1,    0,    2,    0,    2,
     1    0,    0,    0,    0,    1,    1,    0,    0,    0,    0,
     2  80*0/
      DATA ZARJ/
     & 0.10, 0.30, 0.40, 0.05, 0.50, 0.50, 0.50,   0.,   0.,   0.,
     1 0.50, 0.60, 0.75,   0.,   0.,   0.,   0.,  1.0,  1.0,   0.,
     2 0.36,  1.0, 0.01,  2.0,  1.0,  0.4,   0.,   0.,   0.,   0.,
     3 0.10,  1.0,  0.8,  1.5,   0.,  2.0,  0.2,  2.5,  0.6,   0.,
     4  0.3, 0.58,  0.5,  0.9,  0.5,  1.0,  1.0,  1.0,   0.,   0.,
     5 0.77,0.77,0.77,-0.05,-0.005,-0.00001,-0.00001,-0.00001,1.0,0.,
     6  4.5,  0.7,  0., 0.003,  0.5,  0.5,   0.,   0.,   0.,   0.,
     7  10., 1000., 100., 1000., 0.,  0.7,  10.,   0.,   0.,   0.,
     8 0.29,  1.0,  1.0,   0.,  10.,  10.,   0.,   0.,   0.,   0.,
     9 0.02,  1.0,  0.2,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     &   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     1   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     2  1.0, 0.25,91.187,2.489, 0.01, 2.0,  1.0, 0.25,0.002,   0.,
     3   0.,   0.,   0.,   0., 0.01, 0.99,   0.,   0.,  0.2,   0.,
     4  60*0./

C...LUDAT2, with particle data and flavour treatment parameters.
      DATA (JCHG(I,1),I=   1, 500)/-1,2,-1,2,-1,2,-1,2,2*0,-3,0,-3,0,
     &-3,0,-3,6*0,3,9*0,3,2*0,3,0,-1,44*0,2,-1,2,-1,2,3,11*0,3,0,2*3,0,
     &3,0,3,0,3,10*0,3,0,2*3,0,3,0,3,0,3,10*0,3,0,2*3,0,3,0,3,0,3,10*0,
     &3,0,2*3,0,3,0,3,0,3,10*0,3,0,2*3,0,3,0,3,0,3,10*0,3,0,2*3,0,3,0,
     &3,0,3,70*0,3,0,3,28*0,3,2*0,3,8*0,-3,8*0,3,0,-3,0,3,-3,3*0,3,6,0,
     &3,5*0,-3,0,3,-3,0,-3,4*0,-3,0,3,6,-3,0,3,-3,0,-3,0,3,6,0,3,5*0,
     &-3,0,3,-3,0,-3,114*0/
      DATA (JCHG(I,2),I=   1, 500)/8*1,12*0,2,16*0,2,1,50*0,-1,410*0/
      DATA (JCHG(I,3),I=   1, 500)/8*1,2*0,8*1,5*0,1,9*0,1,2*0,1,0,2*1,
     &41*0,1,0,7*1,10*0,10*1,10*0,10*1,10*0,10*1,10*0,10*1,10*0,10*1,
     &10*0,10*1,70*0,3*1,22*0,1,5*0,1,0,2*1,6*0,1,0,2*1,6*0,2*1,0,5*1,
     &0,6*1,4*0,6*1,4*0,16*1,4*0,6*1,114*0/
      DATA (ZMAS(I,1),I=   1, 500)/0.0099,0.0056,0.199,1.35,5.,160.,
     &2*250.,2*0.,0.00051,0.,0.1057,0.,1.777,0.,250.,5*0.,91.187,80.25,
     &80.,6*0.,500.,900.,500.,3*300.,350.,200.,5000.,60*0.,0.1396,
     &0.4977,0.4936,1.8693,1.8645,1.9688,5.2787,5.2786,5.47972,6.594,
     &0.135,0.5475,0.9578,2.9788,9.4,320.,2*500.,2*0.,0.7669,0.8961,
     &0.8916,2.0101,2.0071,2.11,2*5.325,5.5068,6.602,0.7683,0.782,
     &1.0194,3.0969,9.4603,320.,2*500.,2*0.,1.232,2*1.29,2*2.424,2.536,
     &2*5.73,5.97,7.3,1.232,1.17,1.4,3.46,9.875,320.,2*500.,2*0.,0.983,
     &2*1.429,2*2.272,2.5,2*5.68,5.92,7.25,0.9827,1.,1.4,3.4151,9.8598,
     &320.,2*500.,2*0.,1.26,2*1.402,2*2.372,2.56,2*5.78,6.02,7.3,1.26,
     &1.282,1.42,3.5106,9.8919,320.,2*500.,2*0.,1.318,1.432,1.425,
     &2*2.46,2.61,2*5.83,6.07,7.35,1.318,1.275,1.525,3.5562,9.9132,
     &320.,2*500.,2*0.,2*0.4977,8*0.,3.686,3*0.,10.0233,70*0.,1.1156,
     &5*0.,2.2849,0.,2.473,2.466,6*0.,5.641,0.,2*5.84,6*0.,0.9396,
     &0.9383,0.,1.1974,1.1926,1.1894,1.3213,1.3149,0.,2.4525,2.4529,
     &2.4527,2*2.55,2.73,4*0.,3*5.8,2*5.96,6.12,4*0.,1.234,1.233,1.232,
     &1.231,1.3872,1.3837,1.3828,1.535,1.5318,1.6724,3*2.5,2*2.63,2.8,
     &4*0.,3*5.81,2*5.97,6.13,114*0./
      DATA (ZMAS(I,2),I=   1, 500)/22*0.,2.489,2.066,88*0.,0.0002,
     &0.001,6*0.,0.149,0.0505,0.0498,7*0.,0.151,0.00843,0.0044,7*0.,
     &0.155,2*0.09,2*0.02,0.,4*0.05,0.155,0.36,0.08,2*0.01,5*0.,0.057,
     &2*0.287,7*0.05,0.057,0.,0.25,0.014,6*0.,0.4,2*0.174,7*0.05,0.4,
     &0.024,0.06,0.0009,6*0.,0.11,0.109,0.098,2*0.019,5*0.02,0.11,
     &0.185,0.076,0.002,146*0.,4*0.12,0.0394,0.036,0.0358,0.0099,
     &0.0091,131*0./
      DATA (ZMAS(I,3),I=   1, 500)/22*0.,2*20.,88*0.,0.002,0.005,6*0.,
     &0.4,2*0.2,7*0.,0.4,0.1,0.015,7*0.,0.25,0.005,0.01,2*0.08,0.,
     &4*0.1,0.25,0.2,0.001,2*0.02,5*0.,0.05,2*0.4,6*0.1,2*0.05,0.,0.35,
     &0.05,6*0.,3*0.3,2*0.1,0.03,4*0.1,0.3,0.05,0.02,0.001,6*0.,0.25,
     &4*0.12,5*0.05,0.25,0.17,0.2,0.01,146*0.,4*0.14,0.04,2*0.035,
     &2*0.05,131*0./
      DATA (ZMAS(I,4),I=   1, 500)/12*0.,658650.,0.,0.0914,68*0.,0.1,
     &0.387,15*0.,7804.,0.,3709.,0.32,0.1259,0.135,3*0.387,0.15,110*0.,
     &15500.,26.75,83*0.,78.88,5*0.,0.057,0.,0.025,0.09,6*0.,0.387,0.,
     &2*0.387,9*0.,44.3,0.,23.95,49.1,86.9,6*0.,0.13,9*0.,0.387,13*0.,
     &24.60001,130*0./
      DATA ZARF/
     &  0.5, 0.25,  0.5, 0.25,   1.,  0.5,   0.,   0.,   0.,   0.,
     1  0.5,   0.,  0.5,   0.,   1.,   1.,   0.,   0.,   0.,   0.,
     2  0.5,   0.,  0.5,   0.,   1.,   1.,   0.,   0.,   0.,   0.,
     3  0.5,   0.,  0.5,   0.,   1.,   1.,   0.,   0.,   0.,   0.,
     4  0.5,   0.,  0.5,   0.,   1.,   1.,   0.,   0.,   0.,   0.,
     5  0.5,   0.,  0.5,   0.,   1.,   1.,   0.,   0.,   0.,   0.,
     6 0.75,  0.5,   0., 0.1667, 0.0833, 0.1667, 0., 0., 0.,   0.,
     7   0.,   0.,   1., 0.3333, 0.6667, 0.3333, 0., 0., 0.,   0.,
     8   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     9   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     & 0.325, 0.325, 0.5, 1.6,  5.0,   0.,   0.,   0.,   0.,   0.,
     1   0., 0.11, 0.16, 0.048, 0.50, 0.45, 0.55, 0.60,  0.,   0.,
     2  0.2,  0.1,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
     3  1870*0./
      DATA ((ZCKM(I,J),J=1,4),I=1,4)/
     1  0.95113,  0.04884,  0.00003,  0.00000,
     2  0.04884,  0.94940,  0.00176,  0.00000,
     3  0.00003,  0.00176,  0.99821,  0.00000,
     4  0.00000,  0.00000,  0.00000,  1.00000/

C...LUDAT3, with particle decay parameters and data.
      DATA (JDCY(I,1),I=   1, 500)/5*0,3*1,6*0,1,0,1,5*0,3*1,6*0,1,0,1,
     &2*0,4*1,42*0,7*1,12*0,1,0,15*1,2*0,18*1,2*0,18*1,2*0,18*1,2*0,
     &18*1,2*0,18*1,3*0,1,8*0,1,3*0,1,70*0,1,5*0,1,0,2*1,6*0,1,0,2*1,
     &9*0,5*1,0,6*1,4*0,6*1,4*0,16*1,4*0,6*1,114*0/
      DATA (JDCY(I,2),I=   1, 500)/1,9,17,25,33,41,50,60,2*0,70,74,76,
     &81,83,124,126,132,2*0,135,144,156,172,192,6*0,209,0,231,254,274,
     &292,301,304,305,42*0,314,315,319,328,331,336,338,11*0,358,359,
     &361,367,430,491,524,560,596,635,666,668,675,681,682,683,684,685,
     &2*0,686,688,691,694,697,699,700,701,702,703,704,708,713,721,724,
     &733,734,735,2*0,736,737,742,747,749,751,753,755,757,759,761,762,
     &765,769,770,771,772,773,2*0,774,775,777,779,781,783,785,787,789,
     &791,793,794,799,804,806,808,809,810,2*0,811,813,815,817,819,821,
     &823,825,827,829,831,833,846,850,852,854,855,856,2*0,857,863,873,
     &884,892,900,904,912,920,924,928,936,945,951,953,955,956,957,2*0,
     &958,966,8*0,968,3*0,979,70*0,993,5*0,997,0,1073,1074,6*0,1075,0,
     &1092,1093,9*0,1094,1096,1097,1100,1101,0,1103,1104,1105,1106,
     &1107,1108,4*0,1109,1110,1111,1112,1113,1114,4*0,1115,1116,1119,
     &1122,1123,1126,1129,1132,1134,1136,1140,1141,1142,1143,1145,1147,
     &4*0,1148,1149,1150,1151,1152,1153,114*0/
      DATA (JDCY(I,3),I=   1, 500)/5*8,9,2*10,2*0,4,2,5,2,41,2,6,3,2*0,
     &9,12,16,20,17,6*0,22,0,23,20,18,9,3,1,9,42*0,1,4,9,3,5,2,20,11*0,
     &1,2,6,63,61,33,2*36,39,31,2,7,6,5*1,2*0,2,3*3,2,5*1,4,5,8,3,9,
     &3*1,2*0,1,2*5,7*2,1,3,4,5*1,2*0,1,9*2,1,2*5,2*2,3*1,2*0,11*2,13,
     &4,2*2,3*1,2*0,6,10,11,2*8,4,2*8,2*4,8,9,6,2*2,3*1,2*0,8,2,8*0,11,
     &3*0,14,70*0,4,5*0,76,0,2*1,6*0,17,0,2*1,9*0,2,1,3,1,2,0,6*1,4*0,
     &6*1,4*0,1,2*3,1,3*3,2*2,4,3*1,2*2,1,4*0,6*1,114*0/
      DATA (JDME(I,1),I=   1,2000)/6*1,-1,7*1,-1,7*1,-1,7*1,-1,7*1,-1,
     &7*1,-1,1,-1,8*1,2*-1,8*1,2*-1,61*1,-1,2*1,-1,6*1,2*-1,7*1,2*-1,
     &3*1,-1,6*1,2*-1,6*1,2*-1,3*1,-1,3*1,-1,3*1,5*-1,3*1,-1,6*1,2*-1,
     &3*1,-1,11*1,2*-1,6*1,8*-1,3*1,-1,3*1,-1,3*1,5*-1,3*1,4*-1,6*1,
     &2*-1,3*1,-1,5*1,-1,8*1,2*-1,3*1,-1,9*1,-1,3*1,-1,9*1,2*-1,2*1,-1,
     &16*1,-1,2*1,3*-1,1665*1/
      DATA (JDME(I,2),I=   1,2000)/75*102,42,6*102,2*42,2*0,7*41,2*0,
     &24*41,6*102,45,29*102,8*32,8*0,16*32,4*0,8*32,4*0,32,4*0,8*32,
     &14*0,16*32,7*0,8*32,4*0,32,7*0,8*32,4*0,32,5*0,4*32,5*0,3*32,0,
     &6*32,3*0,12,2*42,2*11,9*42,2*45,31,2*45,2*33,31,2*45,20*46,7*0,
     &24*42,41*0,16*42,46*0,10*42,20*0,2*13,14*42,16*0,48,3*13,16*42,
     &16*0,48,3*13,16*42,19*0,48,3*13,2*42,0,2*11,28*42,0,2,4*0,2,8*0,
     &12,32,86,87,88,3,0,2*3,0,2*3,0,2*3,0,3,6*0,3,3*0,1,0,3,2*0,2*3,
     &3*0,1,4*0,12,3*0,4*32,2*4,86,87,88,33*0,12,32,86,87,88,31*0,12,0,
     &32,86,87,88,40*0,12,0,32,86,87,88,95*0,12,0,32,86,87,88,2*0,4*42,
     &6*0,12,11*0,4*32,2*4,9*0,14*42,52*0,10*13,2*84,3*42,8*0,48,3*13,
     &2*42,2*85,14*0,84,5*0,85,886*0/
      DATA (ZRAT(I)  ,I=   1, 439)/75*0.,1.,6*0.,0.179,0.178,0.116,
     &0.235,0.005,0.056,0.018,0.023,0.011,2*0.004,0.0067,0.014,2*0.002,
     &2*0.001,0.0022,0.054,0.002,0.016,0.005,0.011,0.0101,5*0.006,
     &0.002,2*0.001,5*0.002,6*0.,1.,29*0.,0.15394,0.11936,0.15394,
     &0.11926,0.15254,3*0.,0.03368,0.06664,0.03368,0.06664,0.03368,
     &0.06664,2*0.,0.3214,0.0165,2*0.,0.0165,0.3207,2*0.,0.00001,
     &0.00059,6*0.,3*0.1081,3*0.,0.0003,0.048,0.8705,4*0.,0.0002,
     &0.0603,0.,0.0199,0.0008,3*0.,0.143,0.111,0.143,0.111,0.143,0.085,
     &2*0.,0.03,0.058,0.03,0.058,0.03,0.058,8*0.,0.25,0.01,2*0.,0.01,
     &0.25,4*0.,0.24,5*0.,3*0.08,6*0.,0.01,0.08,0.82,5*0.,0.09,11*0.,
     &0.01,0.08,0.82,5*0.,0.09,9*0.,1.,6*0.,0.01,0.98,0.01,1.,4*0.215,
     &2*0.,2*0.07,0.,1.,2*0.08,0.76,0.08,2*0.105,0.04,0.5,0.08,0.14,
     &0.01,0.015,0.005,1.,3*0.,1.,4*0.,1.,0.25,0.01,2*0.,0.01,0.25,
     &4*0.,0.24,5*0.,3*0.08,0.,1.,2*0.5,0.635,0.212,0.056,0.017,0.048,
     &0.032,0.07,0.065,2*0.005,2*0.011,5*0.001,0.07,0.065,2*0.005,
     &2*0.011,5*0.001,0.026,0.019,0.066,0.041,0.045,0.076,0.0073,
     &2*0.0047,0.026,0.001,0.0006,0.0066,0.005,2*0.003,2*0.0006,
     &2*0.001,0.006,0.005,0.012,0.0057,0.067,0.008,0.0022,0.027,0.004,
     &0.019,0.012,0.002,0.009,0.0218,0.001,0.022,0.087,0.001,0.0019,
     &0.0015,0.0028,0.034,0.027,2*0.002,2*0.004,2*0.002,0.034,0.027/
      DATA (ZRAT(I)  ,I= 440, 655)/2*0.002,2*0.004,2*0.002,0.0365,
     &0.045,0.073,0.062,3*0.021,0.0061,0.015,0.025,0.0088,0.074,0.0109,
     &0.0041,0.002,0.0035,0.0011,0.001,0.0027,2*0.0016,0.0018,0.011,
     &0.0063,0.0052,0.018,0.016,0.0034,0.0036,0.0009,0.0006,0.015,
     &0.0923,0.018,0.022,0.0077,0.009,0.0075,0.024,0.0085,0.067,0.0511,
     &0.017,0.0004,0.0028,0.01,2*0.02,0.03,2*0.005,2*0.02,0.03,2*0.005,
     &0.015,0.037,0.028,0.079,0.095,0.052,0.0078,4*0.001,0.028,0.033,
     &0.026,0.05,0.01,4*0.005,0.25,0.0952,0.02,0.055,2*0.005,0.008,
     &0.012,0.02,0.055,2*0.005,0.008,0.012,0.01,0.03,0.0035,0.011,
     &0.0055,0.0042,0.009,0.018,0.015,0.0185,0.0135,0.025,0.0004,
     &0.0007,0.0008,0.0014,0.0019,0.0025,0.4291,0.08,0.07,0.02,0.015,
     &0.005,0.02,0.055,2*0.005,0.008,0.012,0.02,0.055,2*0.005,0.008,
     &0.012,0.01,0.03,0.0035,0.011,0.0055,0.0042,0.009,0.018,0.015,
     &0.0185,0.0135,0.025,0.0004,0.0007,0.0008,0.0014,0.0019,0.0025,
     &0.4291,0.08,0.07,0.02,0.015,0.005,0.02,0.055,2*0.005,0.008,0.012,
     &0.02,0.055,2*0.005,0.008,0.012,0.01,0.03,0.0035,0.011,0.0055,
     &0.0042,0.009,0.018,0.015,0.0185,0.0135,0.025,2*0.0002,0.0007,
     &2*0.0004,0.0014,0.001,0.0009,0.0025,0.4291,0.08,0.07,0.02,0.015,
     &0.005,0.047,0.122,0.006,0.012,0.035,0.012,0.035,0.003,0.007,0.15,
     &0.037,0.008,0.002,0.05,0.015,0.003,0.001,0.014,0.042,0.014,0.042/
      DATA (ZRAT(I)  ,I= 656, 931)/0.24,0.065,0.012,0.003,0.001,0.002,
     &0.001,0.002,0.014,0.003,0.988,0.012,0.389,0.319,0.2367,0.049,
     &0.005,0.001,0.0003,0.441,0.206,0.3,0.03,0.022,0.001,5*1.,0.99955,
     &0.00045,0.665,0.333,0.002,0.666,0.333,0.001,0.65,0.3,0.05,0.56,
     &0.44,5*1.,0.99912,0.00079,0.00005,0.00004,0.888,0.085,0.021,
     &2*0.003,0.49,0.344,3*0.043,0.023,0.013,0.001,0.0627,0.0597,
     &0.8776,3*0.027,0.015,0.045,0.015,0.045,0.77,0.029,4*1.,0.28,0.14,
     &0.313,0.157,0.11,0.28,0.14,0.313,0.157,0.11,0.667,0.333,0.667,
     &0.333,2*0.5,0.667,0.333,0.667,0.333,4*0.5,1.,0.333,0.334,0.333,
     &4*0.25,6*1.,0.667,0.333,0.667,0.333,0.667,0.333,0.667,0.333,
     &2*0.5,0.667,0.333,0.667,0.333,4*0.5,1.,0.52,0.26,0.11,2*0.055,
     &0.62,0.31,0.035,2*0.0175,0.007,0.993,0.02,0.98,3*1.,2*0.5,0.667,
     &0.333,0.667,0.333,0.667,0.333,0.667,0.333,2*0.5,0.667,0.333,
     &0.667,0.333,6*0.5,3*0.12,0.097,0.043,4*0.095,4*0.03,4*0.25,0.273,
     &0.727,0.35,0.65,3*1.,2*0.35,0.144,0.105,0.048,0.003,0.333,0.166,
     &0.168,0.084,0.087,0.043,0.059,2*0.029,0.002,0.332,0.166,0.168,
     &0.084,0.086,0.043,0.059,2*0.029,2*0.002,0.3,0.15,0.16,0.08,0.13,
     &0.06,0.08,0.04,0.3,0.15,0.16,0.08,0.13,0.06,0.08,0.04,2*0.3,
     &2*0.2,0.3,0.15,0.16,0.08,0.13,0.06,0.08,0.04,0.3,0.15,0.16,0.08,
     &0.13,0.06,0.08,0.04,2*0.3,2*0.2,2*0.3,2*0.2,2*0.35,0.144,0.105/
      DATA (ZRAT(I)  ,I= 932,2000)/0.024,2*0.012,0.003,0.566,0.283,
     &0.069,0.028,0.023,2*0.0115,0.005,0.003,0.356,2*0.178,0.28,
     &2*0.004,0.135,0.865,0.22,0.78,3*1.,0.217,0.124,2*0.193,2*0.135,
     &0.002,0.001,0.686,0.314,2*0.0083,0.1866,0.324,0.184,0.027,0.001,
     &0.093,0.087,0.078,0.0028,3*0.014,0.008,0.024,0.008,0.024,0.425,
     &0.02,0.185,0.088,0.043,0.067,0.066,0.641,0.357,2*0.001,0.018,
     &2*0.005,0.003,0.002,2*0.006,0.018,2*0.005,0.003,0.002,2*0.006,
     &0.0066,0.025,0.016,0.0088,2*0.005,0.0058,0.005,0.0055,4*0.004,
     &2*0.002,2*0.004,0.003,0.002,2*0.003,3*0.002,2*0.001,0.002,
     &2*0.001,2*0.002,0.0013,0.0018,5*0.001,4*0.003,2*0.005,2*0.002,
     &2*0.001,2*0.002,2*0.001,0.2432,0.057,2*0.035,0.15,2*0.075,0.03,
     &2*0.015,2*1.,2*0.105,0.04,0.0077,0.02,0.0235,0.0285,0.0435,
     &0.0011,0.0022,0.0044,0.4291,0.08,0.07,0.02,0.015,0.005,2*1.,
     &0.999,0.001,1.,0.516,0.483,0.001,1.,0.995,0.005,13*1.,0.331,
     &0.663,0.006,0.663,0.331,0.006,1.,0.88,2*0.06,0.88,2*0.06,0.88,
     &2*0.06,0.667,2*0.333,0.667,0.676,0.234,0.085,0.005,3*1.,4*0.5,
     &7*1.,847*0./
      DATA (JFDP(I,1),I=   1, 507)/21,22,23,4*-24,25,21,22,23,4*24,25,
     &21,22,23,4*-24,25,21,22,23,4*24,25,21,22,23,4*-24,25,21,22,23,
     &4*24,25,37,21,22,23,4*-24,25,2*-37,21,22,23,4*24,25,2*37,22,23,
     &-24,25,23,24,-12,22,23,-24,25,23,24,-12,-14,35*16,22,23,-24,25,
     &23,24,-89,22,23,-24,25,-37,23,24,37,1,2,3,4,5,6,7,8,21,1,2,3,4,5,
     &6,7,8,11,13,15,17,1,2,3,4,5,6,7,8,11,12,13,14,15,16,17,18,4*-1,
     &4*-3,4*-5,4*-7,-11,-13,-15,-17,1,2,3,4,5,6,7,8,11,13,15,17,21,
     &2*22,23,24,1,2,3,4,5,6,7,8,11,12,13,14,15,16,17,18,24,37,2*23,25,
     &35,4*-1,4*-3,4*-5,4*-7,-11,-13,-15,-17,3*24,1,2,3,4,5,6,7,8,11,
     &13,15,17,21,2*22,23,24,23,25,36,1,2,3,4,5,6,7,8,11,13,15,17,21,
     &2*22,23,24,23,-1,-3,-5,-7,-11,-13,-15,-17,24,5,6,21,2,1,2,3,4,5,
     &6,11,13,15,82,-11,-13,2*2,-12,-14,-16,2*-2,2*-4,-2,-4,2*89,37,
     &2*-89,2*5,-37,2*89,4*-1,4*-3,4*-5,4*-7,-11,-13,-15,-17,-13,130,
     &310,-13,3*211,12,14,11*-11,11*-13,-311,-313,-311,-313,-20313,
     &2*-311,-313,-311,-313,2*111,2*221,2*331,2*113,2*223,2*333,-311,
     &-313,2*-321,211,-311,-321,333,-311,-313,-321,211,2*-321,2*-311,
     &-321,211,113,8*-11,8*-13,-321,-323,-321,-323,-311,2*-313,-311,
     &-313,2*-311,-321,-10323,-321,-323,-321,-311,2*-313,211,111,333,
     &3*-321,-311,-313,-321,-313,310,333,211,2*-321,-311,-313,-311,211,
     &-321,3*-311,211,113,321,-15,5*-11,5*-13,221,331,333,221,331,333/
      DATA (JFDP(I,1),I= 508, 924)/10221,211,213,211,213,321,323,321,
     &323,2212,221,331,333,221,2*2,6*12,6*14,2*16,3*-411,3*-413,2*-411,
     &2*-413,2*441,2*443,2*20443,2*2,2*4,2,4,6*12,6*14,2*16,3*-421,
     &3*-423,2*-421,2*-423,2*441,2*443,2*20443,2*2,2*4,2,4,6*12,6*14,
     &2*16,3*-431,3*-433,2*-431,2*-433,3*441,3*443,3*20443,2*2,2*4,2,4,
     &16,2*4,2*12,2*14,2*16,4*2,4*4,2*-11,2*-13,2*-1,2*-3,2*-11,2*-13,
     &2*-1,3*22,111,211,2*22,211,22,211,111,3*22,111,82,21,3*0,2*211,
     &321,3*311,2*321,421,2*411,2*421,431,511,521,531,541,211,111,13,
     &11,211,22,211,2*111,321,130,-213,113,213,211,22,111,11,13,82,11,
     &13,15,1,2,3,4,21,22,3*0,223,321,311,323,313,2*311,321,313,323,
     &321,423,2*413,2*423,413,523,2*513,2*523,2*513,523,223,213,113,
     &-213,313,-313,323,-323,82,21,3*0,221,321,2*311,321,421,2*411,421,
     &411,421,521,2*511,2*521,2*511,521,221,211,111,321,130,310,211,
     &111,321,130,310,443,82,553,21,3*0,113,213,323,2*313,323,423,
     &2*413,2*423,413,523,2*513,2*523,2*513,523,213,-213,10211,10111,
     &-10211,2*221,213,2*113,-213,2*321,2*311,313,-313,323,-323,443,82,
     &553,21,3*0,213,113,221,223,321,211,321,311,323,313,323,313,321,
     &4*311,321,313,323,313,323,311,4*321,421,411,423,413,423,413,421,
     &2*411,421,413,423,413,423,411,2*421,411,423,413,521,511,523,513,
     &523,513,521,2*511,521,513,523,513,523,511,2*521,511,523,513,511/
      DATA (JFDP(I,1),I= 925,2000)/521,513,523,213,-213,221,223,321,
     &130,310,111,211,111,2*211,321,130,310,221,111,321,130,310,221,
     &211,111,443,82,553,21,3*0,111,211,-12,12,-14,14,211,111,211,111,
     &11,13,82,4*443,10441,20443,445,441,11,13,15,1,2,3,4,21,22,2*553,
     &10551,20553,555,2212,2*2112,-12,7*-11,7*-13,2*2224,2*2212,2*2214,
     &2*3122,2*3212,2*3214,5*3222,4*3224,2*3322,3324,2*2224,7*2212,
     &5*2214,2*2112,2*2114,2*3122,2*3212,2*3214,2*3222,2*3224,4*2,3,
     &2*2,1,2*2,2*0,-12,-14,-16,5*4122,441,443,20443,2*-2,2*-4,-2,-4,
     &2*0,2112,-12,3122,2212,2112,2212,3*3122,3*4122,4132,4232,0,
     &3*5122,5132,5232,0,2112,2212,2*2112,2212,2112,2*2212,3122,3212,
     &3112,3122,3222,3112,3122,3222,3212,3322,3312,3322,3312,3122,3322,
     &3312,-12,3*4122,2*4132,2*4232,4332,3*5122,5132,5232,5332,847*0/
      DATA (JFDP(I,2),I=   1, 476)/3*1,2,4,6,8,1,3*2,1,3,5,7,2,3*3,2,4,
     &6,8,3,3*4,1,3,5,7,4,3*5,2,4,6,8,5,3*6,1,3,5,7,6,5,3*7,2,4,6,8,7,
     &4,6,3*8,1,3,5,7,8,5,7,2*11,12,11,12,2*11,2*13,14,13,14,13,11,13,
     &-211,-213,-211,-213,-211,-213,3*-211,-321,-323,-321,-323,3*-321,
     &4*-211,-213,-211,-213,-211,-213,-211,-213,-211,-213,6*-211,2*15,
     &16,15,16,15,18,2*17,18,17,2*18,2*17,-1,-2,-3,-4,-5,-6,-7,-8,21,
     &-1,-2,-3,-4,-5,-6,-7,-8,-11,-13,-15,-17,-1,-2,-3,-4,-5,-6,-7,-8,
     &-11,-12,-13,-14,-15,-16,-17,-18,2,4,6,8,2,4,6,8,2,4,6,8,2,4,6,8,
     &12,14,16,18,-1,-2,-3,-4,-5,-6,-7,-8,-11,-13,-15,-17,21,22,2*23,
     &-24,-1,-2,-3,-4,-5,-6,-7,-8,-11,-12,-13,-14,-15,-16,-17,-18,-24,
     &-37,22,25,2*36,2,4,6,8,2,4,6,8,2,4,6,8,2,4,6,8,12,14,16,18,23,22,
     &25,-1,-2,-3,-4,-5,-6,-7,-8,-11,-13,-15,-17,21,22,2*23,-24,2*25,
     &36,-1,-2,-3,-4,-5,-6,-7,-8,-11,-13,-15,-17,21,22,2*23,-24,25,2,4,
     &6,8,12,14,16,18,25,-5,-6,21,11,-3,-4,-5,-6,-7,-8,-13,-15,-17,-82,
     &12,14,-1,-3,11,13,15,1,4,3,4,1,3,5,3,5,6,4,21,22,4,7,5,2,4,6,8,2,
     &4,6,8,2,4,6,8,2,4,6,8,12,14,16,18,14,2*0,14,111,211,111,-11,-13,
     &11*12,11*14,2*211,2*213,211,20213,2*321,2*323,211,213,211,213,
     &211,213,211,213,211,213,211,213,3*211,213,211,2*321,8*211,2*113,
     &2*211,8*12,8*14,2*211,2*213,2*111,221,2*113,223,333,20213,211,
     &2*321,323,2*311,313,-211,111,113,2*211,321,2*211,311,321,310,211/
      DATA (JFDP(I,2),I= 477, 857)/-211,4*211,321,4*211,113,2*211,-321,
     &16,5*12,5*14,3*211,3*213,211,2*111,2*113,2*-311,2*-313,-2112,
     &3*321,323,2*-1,6*-11,6*-13,2*-15,211,213,20213,211,213,20213,431,
     &433,431,433,311,313,311,313,311,313,-1,-4,-3,-4,-1,-3,6*-11,
     &6*-13,2*-15,211,213,20213,211,213,20213,431,433,431,433,321,323,
     &321,323,321,323,-1,-4,-3,-4,-1,-3,6*-11,6*-13,2*-15,211,213,
     &20213,211,213,20213,431,433,431,433,221,331,333,221,331,333,221,
     &331,333,-1,-4,-3,-4,-1,-3,-15,-3,-1,2*-11,2*-13,2*-15,-1,-4,-3,
     &-4,-3,-4,-1,-4,2*12,2*14,2,3,2,3,2*12,2*14,2,1,22,11,22,111,-211,
     &211,11,-211,13,-211,111,113,223,22,111,-82,21,3*0,111,22,-211,
     &111,22,211,111,22,211,111,22,111,6*22,-211,22,-13,-11,-211,111,
     &-211,2*111,-321,310,211,111,2*-211,221,22,-11,-13,-82,-11,-13,
     &-15,-1,-2,-3,-4,2*21,3*0,211,-213,113,-211,111,223,213,113,211,
     &111,223,211,111,-211,111,321,311,-211,111,211,111,-321,-311,411,
     &421,111,-211,111,211,-311,311,-321,321,-82,21,3*0,211,-211,111,
     &211,111,211,111,-211,111,311,321,-211,111,211,111,-321,-311,411,
     &421,111,-211,111,-321,130,310,-211,111,-321,130,310,22,-82,22,21,
     &3*0,211,111,-211,111,211,111,211,111,-211,111,321,311,-211,111,
     &211,111,-321,-311,411,421,-211,211,-211,111,2*211,111,-211,211,
     &111,211,-321,2*-311,-321,-311,311,-321,321,22,-82,22,21,3*0,111/
      DATA (JFDP(I,2),I= 858,2000)/3*211,-311,22,-211,111,-211,111,
     &-211,211,-213,113,223,221,211,111,211,111,2*211,213,113,223,221,
     &22,211,111,211,111,4*211,-211,111,-211,111,-211,211,-211,211,321,
     &311,321,311,-211,111,-211,111,-211,211,-211,2*211,111,211,111,
     &4*211,-321,-311,-321,-311,411,421,411,421,-211,211,111,211,-321,
     &130,310,22,-211,111,2*-211,-321,130,310,221,111,-321,130,310,221,
     &-211,111,22,-82,22,21,3*0,111,-211,11,-11,13,-13,-211,111,-211,
     &111,-11,-13,-82,211,111,221,111,4*22,-11,-13,-15,-1,-2,-3,-4,
     &2*21,211,111,3*22,-211,111,22,11,7*12,7*14,-321,-323,-311,-313,
     &-311,-313,211,213,211,213,211,213,111,221,331,113,223,111,221,
     &113,223,321,323,321,-211,-213,111,221,331,113,223,333,10221,111,
     &221,331,113,223,211,213,211,213,321,323,321,323,321,323,311,313,
     &311,313,2*-1,-3,-1,2203,3201,3203,2203,2101,2103,2*0,11,13,15,
     &-211,-213,-20213,-431,-433,3*3122,1,4,3,4,1,3,2*0,-211,11,22,111,
     &211,22,-211,111,22,-211,111,211,2*22,0,-211,111,211,2*22,0,
     &2*-211,111,22,111,211,22,211,2*-211,2*111,-211,2*211,111,211,
     &-211,2*111,211,-321,-211,111,11,-211,111,211,111,22,111,2*22,
     &-211,111,211,3*22,847*0/
      DATA (JFDP(I,3),I=   1, 944)/75*0,14,6*0,2*16,2*0,5*111,310,130,
     &2*0,2*111,310,130,321,113,211,223,221,2*113,2*211,2*223,2*221,
     &2*113,221,113,2*213,-213,195*0,4*3,4*4,1,4,3,2*2,10*81,25*0,-211,
     &3*111,-311,-313,-311,-321,-313,-323,111,221,331,113,223,-311,
     &-313,-311,-321,-313,-323,111,221,331,113,223,22*0,111,113,2*211,
     &-211,-311,211,111,3*211,-211,7*211,-321,-323,-311,-321,-313,-323,
     &-211,-213,-321,-323,-311,-321,-313,-323,-211,-213,22*0,111,113,
     &-311,2*-211,211,-211,310,-211,2*111,211,2*-211,-321,-211,2*211,
     &-211,111,-211,2*211,0,221,331,333,321,311,221,331,333,321,311,
     &20*0,3,0,-411,-413,-10413,-10411,-20413,-415,-411,-413,-10413,
     &-10411,-20413,-415,-411,-413,16*0,-4,-1,-4,-3,2*-2,-421,-423,
     &-10423,-10421,-20423,-425,-421,-423,-10423,-10421,-20423,-425,
     &-421,-423,16*0,-4,-1,-4,-3,2*-2,-431,-433,-10433,-10431,-20433,
     &-435,-431,-433,-10433,-10431,-20433,-435,-431,-433,19*0,-4,-1,-4,
     &-3,2*-2,3*0,441,443,441,443,441,443,-4,-1,-4,-3,-4,-3,-4,-1,531,
     &533,531,533,3,2,3,2,511,513,511,513,1,2,0,-11,0,2*111,-211,-11,
     &11,-13,2*221,3*0,111,27*0,111,2*0,22,111,5*0,111,12*0,2*21,103*0,
     &-211,2*111,-211,3*111,-211,111,211,14*0,111,6*0,111,-211,8*0,111,
     &-211,9*0,111,-211,111,-211,4*0,111,-211,111,-211,8*0,111,-211,
     &111,-211,4*0,111,-211,111,-211,11*0,-211,6*0,111,211,4*0,111/
      DATA (JFDP(I,3),I= 945,2000)/13*0,2*111,211,-211,211,-211,7*0,
     &-211,111,13*0,2*21,-211,111,6*0,2212,3122,3212,3214,2112,2114,
     &2212,2112,3122,3212,3214,2112,2114,2212,2112,52*0,3*3,1,8*0,
     &3*4122,8*0,4,1,4,3,2*2,3*0,2112,43*0,3322,861*0/
      DATA (JFDP(I,4),I=   1,2000)/88*0,3*111,8*0,-211,0,-211,3*0,111,
     &2*-211,0,111,0,2*111,113,221,111,-213,-211,211,195*0,13*81,41*0,
     &111,211,111,211,7*0,111,211,111,211,35*0,2*-211,2*111,211,111,
     &-211,2*211,2*-211,2*0,-211,111,-211,111,4*0,-211,111,-211,111,
     &34*0,111,-211,3*111,3*-211,2*111,3*-211,4*0,-321,-311,3*0,-321,
     &-311,20*0,-3,31*0,6*1,30*0,6*2,33*0,6*3,9*0,8*4,4*0,4*-5,4*0,
     &2*-5,7*0,-11,264*0,111,-211,4*0,111,57*0,-211,111,5*0,-211,111,
     &52*0,2101,2103,2*2101,19*0,6*2101,909*0/
      DATA (JFDP(I,5),I=   1,2000)/90*0,111,16*0,111,7*0,111,0,2*111,
     &303*0,-211,2*111,-211,111,-211,111,54*0,111,-211,3*111,-211,111,
     &1510*0/

C...LUDAT4, with character strings.
      DATA (ZHAF(I)  ,I=   1, 281)/'d','u','s','c','b','t','l','h',
     &2*' ','e','nu_e','mu','nu_mu','tau','nu_tau','chi','nu_chi',
     &2*' ','g','gamma','Z','W','H',2*' ','reggeon','pomeron',2*' ',
     &'Z''','Z"','W''','H''','A','H','eta_tech','LQ_ue','R',40*' ',
     &'specflav','rndmflav','phasespa','c-hadron','b-hadron',
     &'t-hadron','l-hadron','h-hadron','Wvirt','diquark','cluster',
     &'string','indep.','CMshower','SPHEaxis','THRUaxis','CLUSjet',
     &'CELLjet','table',' ','pi',2*'K',2*'D','D_s',2*'B','B_s','B_c',
     &'pi','eta','eta''','eta_c','eta_b','eta_t','eta_l','eta_h',2*' ',
     &'rho',2*'K*',2*'D*','D*_s',2*'B*','B*_s','B*_c','rho','omega',
     &'phi','J/psi','Upsilon','Theta','Theta_l','Theta_h',2*' ','b_1',
     &2*'K_1',2*'D_1','D_1s',2*'B_1','B_1s','B_1c','b_1','h_1','h''_1',
     &'h_1c','h_1b','h_1t','h_1l','h_1h',2*' ','a_0',2*'K*_0',2*'D*_0',
     &'D*_0s',2*'B*_0','B*_0s','B*_0c','a_0','f_0','f''_0','chi_0c',
     &'chi_0b','chi_0t','chi_0l','chi_0h',2*' ','a_1',2*'K*_1',
     &2*'D*_1','D*_1s',2*'B*_1','B*_1s','B*_1c','a_1','f_1','f''_1',
     &'chi_1c','chi_1b','chi_1t','chi_1l','chi_1h',2*' ','a_2',
     &2*'K*_2',2*'D*_2','D*_2s',2*'B*_2','B*_2s','B*_2c','a_2','f_2',
     &'f''_2','chi_2c','chi_2b','chi_2t','chi_2l','chi_2h',2*' ','K_L',
     &'K_S',8*' ','psi''',3*' ','Upsilon''',45*' ','pi_diffr'/
      DATA (ZHAF(I)  ,I= 282, 500)/'n_diffr','p_diffr','rho_diff',
     &'omega_di','phi_diff','J/psi_di',18*' ','Lambda',5*' ',
     &'Lambda_c',' ',2*'Xi_c',6*' ','Lambda_b',' ',2*'Xi_b',6*' ','n',
     &'p',' ',3*'Sigma',2*'Xi',' ',3*'Sigma_c',2*'Xi''_c','Omega_c',
     &4*' ',3*'Sigma_b',2*'Xi''_b','Omega_b',4*' ',4*'Delta',
     &3*'Sigma*',2*'Xi*','Omega',3*'Sigma*_c',2*'Xi*_c','Omega*_c',
     &4*' ',3*'Sigma*_b',2*'Xi*_b','Omega*_b',114*' '/

C...LUDATR, with initial values for the random number generator.
      DATA JRLU/19780503,0,0,97,33,0/

      IF (FLAG .EQ. CHECK) THEN
         WRITE(6,*) ' GJEINI: JETSET 7.404 WAS REINITIALISED.'
      ENDIF

      CALL UCOPY(JSTU,MSTU,200)
      CALL UCOPY(ZARU,PARU,200)
      CALL UCOPY(JSTJ,MSTJ,200)
      CALL UCOPY(ZARJ,PARJ,200)
      CALL UCOPY(JCHG,KCHG,1500)
      CALL UCOPY(ZMAS,PMAS,2000)
      CALL UCOPY(ZARF,PARF,2000)
      CALL UCOPY(ZCKM,VCKM,16)
      CALL UCOPY(JDCY,MDCY,1500)
      CALL UCOPY(JDME,MDME,4000)
      CALL UCOPY(ZRAT,BRAT,2000)
      CALL UCOPY(JFDP,KFDP,10000)
      DO 10  I=1,500
   10 CHAF(I) = ZHAF(I)
      CALL UCOPY(JRLU,MRLU,6)

      FLAG = CHECK
      WRITE(6,*) ' GJEINI: INITIALISATION OF LUDAT1,2,3,4,R FOR',
     +           ' JETSET 7.404 PERFORMED.'
      RETURN
      END
*CMZ :  2.08/04 10/01/2000  10.19.35  by  Hannes Jung
*CMZ :  2.08/02 20/10/99  08.36.03  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  16.06.21  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  20.57.12  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE GRAINI

*#**********************************************************************
*#
*#    SUBROUTINE GRAINI
*#
*# PURPOSE: INITIALISE RAPGAP PARAMETER COMMONS RAPINI,
*#
*#
*# CHANGED BY:                              AT:
*# REASON:
*#
*#**********************************************************************
      IMPLICIT NONE
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGPARAM.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGFULL.
      INTEGER IFULL,IQCDGRID
      COMMON /OALPINI/ IFULL,IQCDGRID
*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEEP,RGSCQ2.
      DOUBLE PRECISION SCALQ2
	Integer ISET,IP2
      COMMON/RESGAM/ISET,IP2,SCALQ2
*KEEP,RGLQ2.
      DOUBLE PRECISION Q2SUPP
      COMMON/LOWQ2S/Q2SUPP
*KEEP,PSHWR.
      INTEGER IORDER,IALPS,ITIMSHR,ISOFTG,ICCFM
      COMMON /PSHWR/IORDER,IALPS,ITIMSHR,ISOFTG,ICCFM
*KEEP,RGPQCDPOM.
      Integer Iqqg
	COMMON/pqcdpom/ Iqqg
C     SAVE


*KEND.
      REAL ALAM
	Integer NF
      COMMON/ALPHA/NF,ALAM
      CHARACTER CHIN*100
	INTEGER IVM
      COMMON/VMESON/IVM
      REAL PYPAR,PYVAR
	Integer IPY
      COMMON /PYPARA/ IPY(80),PYPAR(80),PYVAR(80)
	Integer IDEBUG
      COMMON/ INTERN/IDEBUG
	Integer ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      COMMON /COLCON/ ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      REAL ACC1,ACC2
	Integer IINT,NCB
      COMMON /INTEGR/ ACC1,ACC2,IINT,NCB
      DOUBLE PRECISION C1,Cg
      COMMON/BUCHMUE/C1,Cg
*KEEP,RGPRKT.
      DOUBLE PRECISION PRKT1,PRKT2,pktm
	Integer IGAMKT
      COMMON /RGPRKT/PRKT1,PRKT2,pktm,IGAMKT

*KEND.
      DOUBLE PRECISION  XMW
      CALL BLEPIN
      IDEBUG = 0
c select integration procedure
c IINT = 1 DIVON
C IINT = 0 BASES/SPRING
      IINT = 0
      NCB = 60000
      ACC1 = 0.75
      ACC2 = 0.5
c... call block data for heracles
      CALL HS46INI
      NF=4
C FINAL STATE PARTON SHOWER
      IFPS = 3
      ILEPTO = 1
C LEPIN KE = 11
      KE = 11
      KGL = 21
      KPH=22
      KEB = KPH
      KPA = 1
      NFLAV = 5
      NFLQCDC = 3
      IHF = 0
      IALMKT = 0
c for photon structure function
      MSTP(12) = 2
c select proton strcuture function
      MSTP(51)=9
c select pion strcuture function
      MSTP(52)=1
c select photon strcuture function
      MSTP(56)=1
c virtual photon supression for resolved photons
      OMEG2 = 0.01D0
C select interaction type
C INTER = 0 --> photon exchange
C INTER = 2 --> CC (W) exchange
      INTER = 0
C select BGF in semihard approach a la Zotov et al. ISEMIH = 1
      ISEMIH = 0
C RUNNING ALPHA_S IRUNA = 1
      IRUNA=1
C RUNNING ALPHA_EM IRUNAEM = 1
      IRUNAEM=0
C SET ELECTROWEAK PARAMETERS
      SIN2W = 0.23D0
      XMW = 80.D0
      XMW2 = XMW**2
C SELECT SCALE FOR STRUCTURE FKT AND ALPHA_S
C IQ2 =1 SCALE Q2 = MASS**2
C IQ2 =2 SCALE Q2 = SHAT
C IQ2 =3 SCALE Q2 = MASS**2 + PT**2
C IQ2 =4 SCALE Q2 = Q2
C IQ2 =5 SCALE Q2 = Q2 + pt**2
      IQ2=5
C SELECT PROCESS
      IPRO= 12
c qpm and martix elements
      IFULL = 1
c for matrix elements: grid (IQCDGRID = 1)
c       or calculated event by event (IQCDGRID = 0)
      IQCDGRID = 1
c select vm production
      IVM = 0
c select p remnant treatment
      IREM = 1
c select pomeron distribution
c npom = 0 (a la streng hera proc. 1987)
c      = 1 ( a la Ingelman)
      NPOM = -10
C...  GLUON DENSITY IN POMERON : ALA STRENG HERA PROCEEDINGS 1987
C...  IF NG = 0 THEN G(X) = 6(1-X)
C...  FOR 0 <= N <= 5 USE NG=...
      NG=-14
C... PARAMETERS FOR POMERON DISTRIBUTION ALA STRENG HERA PROCEEDINGS
C... R_N **2 = 4.7 GEV**-2
      RN2=4.7D0
C... ALPHA_P = 0.25 GEV**-2
      ALPHP=0.25D0
C... EPSP = 0.085
      EPSP = 0.085D0
      XF=0.90D0
C   TMAX =  ACCEPTANCE THETA = 0.5 DEG
      T2MAX=5.D0
C Minimum Q^2 of electron to be generated
      QMI = 5.d0
C Maximum Q^2 of electron to be generated
      QMA = 10D8
C Minimum y of electron to be generated
      YMI=0.0d0
C Minimum y of electron to be generated
      YMA=1.0d0
C pt^2_hat cut for light quark Matrix Elements
      PT2CUT(10)=5.D0
      PT2CUT(13)=5.D0
      PT2CUT(15)=5.D0
      PT2CUT(18)=5.D0
C Maximium theta angle of scattered electron
      THEMA = 180.0D0
C Minimum  theta angle of scattered electron
      THEMI =   0.0D0
C ELECTRON MOMENTUM
C      PLEPIN =-30.
      PLEPIN =-5.
C PROTON MOMENTUM
C      PPIN   = 820.
      PPIN   = 50.
C PERFORM FRAGMENTATION NFRAG=0/1
      NFRAG = 1
c safety for fragmentation
      PYPAR(12) = 1.5
      MSTU(12) = 0
      CHIN='CHAF(C100)=pomeron;'
      CALL LUGIVE(CHIN)
      CHIN='PMAS(4,1)=1.5'
      CALL LUGIVE(CHIN)
c      CALL LUGIVE('PMAS(1,1)=0.450')
c      CALL LUGIVE('PMAS(2,1)=0.450')
c      CALL LUGIVE('PMAS(2101,1)=0.650')
c      CALL LUGIVE('PMAS(2103,1)=0.650')
c      CALL LUGIVE('PMAS(2203,1)=0.650')
c for HERACLES low Q2 supreesion
      Q2SUPP=3.37D0
c for IPRO =14,18 ,1400 which flavor is produced
      IHFLA = 3
c set scale factor for QCD scale:
      SCALFA = 1.D0
c Buchmueller et al parameters
      C1 = 1.D0
      Cg = 1.D0
c for DIS resolved photons .... scale q2
      SCALQ2=1.D0

c
C     Matrix elements for resolved photon processes
C     gg --> qq_bar
      IRPA = 1
C     g + g --> g + g
      IRPB = 1
C     g + q --> g + q
      IRPC = 1
C     qq_bar --> gg
      IRPD = 1
C     q + q_bar --> q + q_bar
      IRPE = 1
C     qq --> qq
      IRPF = 1
C     BFKL qq --> qq
      IRPG = 0

c Schuler Sjostrand
      ISET = 3
      IP2 = 0
c initial state parton shower parameters
      IORDER=1
      IALPS=1
      ITIMSHR=1
      ISOFTG=1
	ICCFM = 0
c intrinsic kt in proton
      IGAMKT = 1 ! for gaussian
c      IGAMKT = 2 ! for dkt^2/(kt0^2 + kt^2)
c      IGAMKT = 3 ! for dkt^2/(kt0^2 + kt^2)^2
c gaussian width:
      PRKT2=0.44D0
c power like: for IGAMKT=2,3
	pktm=2.d0	! maximum kt
c intrinsic kt in photon
      PRKT1=0.77D0
c full/approximate integration for diffr. qqg
      Iqqg = 0
      WRITE(6,*) ' GRAINI: initialisation of RAPGAP '

      RETURN
      END
C...  END INITIALIZE
*CMZ :  2.08/04 22/12/99  15.39.24  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  20.59.48  by  Hannes Jung
*CMZ :  2.03/08 03/10/96  20.08.56  by  Julian Phillips
*-- Author :    Julian Phillips   01/10/96
*#**********************************************************************
*#
*#    SUBROUTINE GRAWQ2
*#
*# PURPOSE: Decide whether to write event for weighted files
*#
*# INPUT: RAPGAP Common RGPARAS
*#
*# OUTPUT: IWRITE = 0 If event to be rejected
*#                = 1 If event to be kept
*#
*# CALLED BY: GRAPGA
*#
*# CALLING: draprn()
*#
*# AUTHOR: Julian Phillips                 CREATED AT: 96/10/01
*#**********************************************************************
      SUBROUTINE GRAWQ2(IWRITE,Q2EG)
	IMPLICIT NONE
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEND.
      Integer NCHK
      PARAMETER (NCHK=1000)
      INTEGER  IWRITE
      Double Precision draprn
	Real Q2EG
      EXTERNAL draprn
      DOUBLE PRECISION WTEST

      INTEGER ILOOP,ICALL,IKEEP
      DATA ILOOP/0/, ICALL/0/, IKEEP/0/

      IWRITE = 0
      ICALL = ICALL + 1
      ILOOP = ILOOP + 1

* Contruct weight
      W_Q2 = 1.D0
      IF(Q2.GT.0.D0) W_Q2 = DMAX1(1.D0,Q2START/DBLE(Q2EG))

* Keep fraction 1/W_Q2 of sample, weighted by W_Q2
      WTEST = draprn()
      IF(WTEST.LT.1.D0/W_Q2) THEN
         IWRITE=1
         IKEEP = IKEEP + 1
      ENDIF

      IF(ILOOP.EQ.NCHK) THEN
         ILOOP = 0
         WRITE(6,*)'Weighting: from ',ICALL,' kept ',IKEEP
      ENDIF

      RETURN
      END
*CMZ :  2.08/04 22/12/99  18.07.27  by  Hannes Jung
*CMZ :  2.06/02 09/09/97  11.19.50  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
*-- AUTHOR :  STEPHAN EGLI
      FUNCTION H1RN()
************************************************************************
* Return one random number between 0 and 1 (excl.)                     *
************************************************************************
      DIMENSION X(1)

      CALL H1RNV(X,1)
      H1RN=X(1)

      RETURN
      END
      SUBROUTINE H1RNV(RVEC,LENV)
************************************************************************
*# RANDOM NUMBER GENERATOR AS ADVOCATED BY F. JAMES FROM PROPOSAL OF   *
*# MARSAGLIA AND ZAMAN (RCARRY)                                        *
*#                                                                     *
*# ENTRIES ARE:                                                        *
*#     SUBROUTINE  H1RNV(RVEC,LENV) VECTOR OF RANDOM NUMBERS           *
*#     SUBROUTINE  H1RNIN(INSEED)   INITIALISE WITH SEED               *
*#     SUBROUTINE  H1RNIV(IVEC)     INITIALISE/RESTART WITH SEED ARRAY *
*#     SUBROUTINE  H1RNSV(IVEC)     SAVE SEED ARRAY IVEC(25)           *
*#                                                                     *
*# IN ADDITION THERE EXISTS:                                           *
*#     FUNCTION    H1RN()          SINGLE RANDOM NUMBER                *
*#                                                                     *
************************************************************************
      LOGICAL NOTYET
      DIMENSION RVEC(LENV)
      DIMENSION SEEDS(24),ISEEDS(24),IVEC(25)
      PARAMETER (TWOP12=4096.)
      PARAMETER (ITWO24=2**24,ICONS=2147483563)
      DATA NOTYET /.TRUE./
      DATA I24,J24,CARRY/24,10,0./
      DATA TWOM24/1/
*
*      write(6,*) 'in h1rnv '
      IF (NOTYET) THEN
         NOTYET = .FALSE.
         JSEED = 314159265
         WRITE(6,'(A,I12)') ' H1RN default initialization: ',JSEED
         TWOM24 = 1.
         DO 10 I= 1, 24
            TWOM24 = TWOM24 * 0.5
            K = JSEED/53668
            JSEED = 40014*(JSEED-K*53668) -K*12211
            IF (JSEED .LT. 0)  JSEED = JSEED+ICONS
            ISEEDS(I) = MOD(JSEED,ITWO24)
   10    CONTINUE
         DO 20 I= 1,24
            SEEDS(I) = REAL(ISEEDS(I))*TWOM24
   20    CONTINUE
         I24 = 24
         J24 = 10
         CARRY = 0.
         IF (SEEDS(24) .LT. SEEDS(14)) CARRY = TWOM24
      ENDIF

C          The Generator proper: "Subtract-with-borrow",
C          as proposed by Marsaglia and Zaman,
C          Florida State University, March, 1989
C
      DO 30  IV= 1, LENV
         UNI = SEEDS(I24) - SEEDS(J24) - CARRY
         IF (UNI .LT. 0.) THEN
            UNI = UNI + 1.0
            CARRY = TWOM24
         ELSE
            CARRY = 0.
         ENDIF
         SEEDS(I24) = UNI
         I24 = I24 - 1
         IF (I24 .EQ. 0) I24 = 24
         J24 = J24 - 1
         IF (J24 .EQ. 0) J24 = 24
*       code to avoid exact zeroes
         IF(UNI.EQ.0.)THEN
            UNI=SEEDS(I24)*TWOM24
            IF(UNI.EQ.0.)UNI=2.**(-48)
         ENDIF
         RVEC(IV) = UNI
   30 CONTINUE
      RETURN

************************************************************************

C                    Entry to initialize from one integer
      ENTRY H1RNIN(INSEED)
      NOTYET=.FALSE.
      JSEED = INSEED
      WRITE(6,'(A,I12)') ' H1RN initialized from seed: ',JSEED
      TWOM24 = 1.
      DO 40  I= 1, 24
         TWOM24 = TWOM24 * 0.5
         K = JSEED/53668
         JSEED = 40014*(JSEED-K*53668) -K*12211
         IF (JSEED .LT. 0) JSEED = JSEED+ICONS
         ISEEDS(I) = MOD(JSEED,ITWO24)
   40 CONTINUE
      DO 50 I= 1,24
         SEEDS(I) = REAL(ISEEDS(I))*TWOM24
   50 CONTINUE
      I24 = 24
      J24 = 10
      CARRY = 0.
      IF (SEEDS(24) .LT. SEEDS(14)) CARRY = TWOM24
      RETURN

************************************************************************

C           Entry to input and float integer seeds from previous run

      ENTRY H1RNIV(IVEC)
      NOTYET=.FALSE.
      TWOM24 = 1.
      DO 60  I= 1, 24
   60 TWOM24 = TWOM24 * 0.5
      WRITE(6,'(A)') ' Full initialization of H1RN with 25 integers:'
      DO 70  I= 1, 24
         SEEDS(I) = REAL(IVEC(I))*TWOM24
   70 CONTINUE
      CARRY = REAL(MOD(IVEC(25),10))*TWOM24
      ISD = IVEC(25)/10
      I24 = MOD(ISD,100)
      ISD = ISD/100
      J24 = ISD
      RETURN

************************************************************************
C                    Entry to output seeds as integers

      ENTRY H1RNSV(IVEC)
      DO 80  I= 1, 24
         IVEC(I) = INT(SEEDS(I)*TWOP12*TWOP12)
   80 CONTINUE
      ICARRY = 0
      IF (CARRY .GT. 0.)  ICARRY = 1
      IVEC(25) = 1000*J24 + 10*I24 + ICARRY
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.24  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  16.08.11  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  21.04.02  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94

C***********************************************************************
C         Change DIVON default options                                 C
C                                                                      C
C***********************************************************************
      SUBROUTINE DVNOPT
C

      COMMON /D151DT/ IDATE
      DOUBLE PRECISION IDATE
      COMMON /PRINT/ IPRINT
      COMMON /ISTRGE/ MXRGNS , ISTOR(12000)
      COMMON /RSTRGE/ RSTSZE,RSTOR(18001)
      INTEGER RSTSZE
      COMMON /QUADRE/ IDEG
      COMMON /START/ ISTART
      COMMON /EXFILE/ NFILE
      COMMON /DISPOS/ IDISP
      COMMON /DEPTHS/ ISTDPH , INCDPH
      COMMON /SAMPLE/ NPOINT
      COMMON /CUTOLS/ BNDTOL, FRACT, REGNTL, FNLTOL
      COMMON /BNDLMT/ FLOBD,FUPBD
      COMMON /PRSTOP/ NSTOP
      COMMON /ZEETRM/ ITRMF
C
      IPRINT= 10
      IDEG=1
      FLOBD=0.0
C
      PRINT 10000
10000 FORMAT(44H0DIVON4 default options are altered by user.  )
C     WRITE(6,*) ' NPOINT = ',NPOINT,' IDEG = ',IDEG
      RETURN
      END
      SUBROUTINE RANUMS (X,N)
	IMPLICIT NONE
      Double Precision X(20)
	Double Precision VEC(20)
	Integer N,LEN,I
      LEN=N
      CALL draprnV(VEC,LEN)
      DO 10 I=1,N
   10 X(I)=VEC(I)
      RETURN
      END
      SUBROUTINE RAPGEN(NDIMEN,XG)
      IMPLICIT NONE
      REAL ACC1,ACC2
	Integer IINT,NCB
      COMMON /INTEGR/ ACC1,ACC2,IINT,NCB
	Double Precision XG
	Double Precision XGS,FXNB
	Integer NDIMEN,MXTRY,I
      DIMENSION XG(20)
      COMMON/XFXNB/XGS(20)
      EXTERNAL FXNB
      IF(IINT.EQ.1) THEN
         CALL RANGEN(NDIMEN,XG)
      ELSE
         MXTRY = 500
         CALL SPRING( FXNB, MXTRY )
         DO I=1,NDIMEN
            XG(I) =XGS(I)
         ENDDO
      ENDIF
      RETURN
      END







*CMZ :  2.07/03 15/05/99  21.05.09  by  Hannes Jung
*-- Author :    Hannes Jung   19/06/96
C#######################################################################
C
C   One dimensional adaptive Gaussian integration routines.
C
C **********************************************************************
c just a copy of GADAP
c

      SUBROUTINE INTGA(A0,B0,F,EPS,SUM)
	IMPLICIT NONE
C
C   PURPOSE           - INTEGRATE A FUNCTION F(X)
C   METHOD            - ADAPTIVE GAUSSIAN
C   USAGE             - CALL INTGA(A0,B0,F,EPS,SUM)
C   PARAMETERS  A0    - LOWER LIMIT (INPUT,REAL)
C               B0    - UPPER LIMIT (INPUT,REAL)
C               F     - FUNCTION F(X) TO BE INTEGRATED. MUST BE
C                       SUPPLIED BY THE USER. (INPUT,REAL FUNCTION)
C               EPS   - DESIRED RELATIVE ACCURACY. IF SUM IS SMALL EPS
C                       WILL BE ABSOLUTE ACCURACY INSTEAD. (INPUT,REAL)
C               SUM   - CALCULATED VALUE FOR THE INTEGRAL (OUTPUT,REAL)
C   PRECISION         - SINGLE
C   REQ'D PROG'S      - F
C   AUTHOR            - T. JOHANSSON, LUND UNIV. COMPUTER CENTER, 1973
C   REFERENCE(S)      - THE AUSTRALIAN COMPUTER JOURNAL,3 P.126 AUG. -71
C
	Integer Num,Ifu,N,L,I
	Real F,A,B,F1,F2,F3,S,F1F,F2F,F3F,AA,BB,EPS,RED,SUM,C
	Real A0,B0,DSUM,W1,U2,SOLD,SS
      COMMON/INTGA1/ NUM,IFU
      EXTERNAL F
      DIMENSION A(300),B(300),F1(300),F2(300),F3(300),S(300),N(300)

      DSUM(F1F,F2F,F3F,AA,BB)=5./18.*(BB-AA)*(F1F+1.6*F2F+F3F)
      IF(EPS.LT.1.0E-8) EPS=1.0E-8
      RED=1.3
      L=1
      I=1
      SUM=0.
      C=SQRT(15.)/5.
      A(1)=A0
      B(1)=B0
      F1(1)=F(0.5*(1+C)*A0+0.5*(1-C)*B0)
      F2(1)=F(0.5*(A0+B0))
      F3(1)=F(0.5*(1-C)*A0+0.5*(1+C)*B0)
      IFU=3
      S(1)=  DSUM(F1(1),F2(1),F3(1),A0,B0)
   10 CONTINUE
      L=L+1
      N(L)=3
      EPS=EPS*RED
      A(I+1)=A(I)+C*(B(I)-A(I))
      B(I+1)=B(I)
      A(I+2)=A(I)+B(I)-A(I+1)
      B(I+2)=A(I+1)
      A(I+3)=A(I)
      B(I+3)=A(I+2)
      W1=A(I)+(B(I)-A(I))/5.
      U2=2.*W1-(A(I)+A(I+2))/2.
      F1(I+1)=F(A(I)+B(I)-W1)
      F2(I+1)=F3(I)
      F3(I+1)=F(B(I)-A(I+2)+W1)
      F1(I+2)=F(U2)
      F2(I+2)=F2(I)
      F3(I+2)=F(B(I+2)+A(I+2)-U2)
      F1(I+3)=F(A(I)+A(I+2)-W1)
      F2(I+3)=F1(I)
      F3(I+3)=F(W1)
      IFU=IFU+6
      IF(IFU.GT.5000) GOTO 40
      S(I+1)=  DSUM(F1(I+1),F2(I+1),F3(I+1),A(I+1),B(I+1))
      S(I+2)=  DSUM(F1(I+2),F2(I+2),F3(I+2),A(I+2),B(I+2))
      S(I+3)=  DSUM(F1(I+3),F2(I+3),F3(I+3),A(I+3),B(I+3))
      SS=S(I+1)+S(I+2)+S(I+3)
      I=I+3
      IF(I.GT.300)GOTO 30
      SOLD=S(I-3)
      IF(ABS(SOLD-SS).GT.EPS*(1.+ABS(SS))/2.) GOTO 10
      SUM=SUM+SS
      I=I-4
      N(L)=0
      L=L-1
   20 CONTINUE
      IF(L.EQ.1) GOTO 40
      N(L)=N(L)-1
      EPS=EPS/RED
      IF(N(L).NE.0) GOTO 10
      I=I-1
      L=L-1
      GOTO 20
   30 WRITE(6,10000)
10000 FORMAT(' INTGA:I TOO BIG')
   40 RETURN
      END
*CMZ :  2.08/05 30/03/2000  16.22.44  by  Hannes Jung
*CMZ :  2.08/01 22/06/99  14.42.37  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  16.09.00  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  21.48.57  by  Hannes Jung
*CMZ :          15/05/99  21.37.38  by  Hannes Jung
* changes done for low mass diffraction by G. Briskin
*CMZ :          17/12/96  12.37.25  by  G.M. Briskin (TAU)
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE LMEPS
* for low mass systems changes introduced by gena briskin 2.12.1996
      IMPLICIT NONE
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
      DOUBLE PRECISION PT2GEN,PHIGEN
      COMMON/HARDPOM/PT2GEN,PHIGEN
c this is the modified but original LMEPS routine LEPTO 6.1
      DOUBLE PRECISION DETOT
      DOUBLE PRECISION DROBO(5)
      REAL CUT,X,Y,W2,Q2LP,U
      DOUBLE PRECISION PARL
	Integer LLST
      COMMON /RAPTOU/ CUT(14),LLST(40),PARL(30),X,Y,W2,Q2LP,U
*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEND.
      DOUBLE PRECISION DBETA(2,3),DBETAR(2,3)
      DOUBLE PRECISION STHETA(2),SPHI(2),STHETAR(2),SPHIR(2)
      REAL PYPAR,PYVAR
	Integer IPY
      COMMON /PYPARA/ IPY(80),PYPAR(80),PYVAR(80)
      REAL XPY,SH,TH,UH,Q2PY
	Integer ISUB,KFL
      COMMON /PYPROC/ ISUB,KFL(3,2),XPY(2),SH,TH,UH,Q2PY
      REAL XQPY
      COMMON /MYINT1/ XQPY(2,-6:6)
c.hju DIMENSION KS(9,5),PS(9,5),ROBO(5),XPQ(-6:6)
      REAL XPQ1,XPQ2
      DOUBLE PRECISION ROBO
      DIMENSION ROBO(5),XPQ1(-6:6),XPQ2(-6:6)
      DOUBLE PRECISION PS(40,5)
      REAL QMAX,XPRO
c..hju
      Integer LST,IRES
      COMMON/EPPARA/LST(30),IRES(2)
      DOUBLE PRECISION DELTAP(4), DPLONG, DBTOT, DGAMMA
c..hju
      Integer ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      COMMON /COLCON/ ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      Integer KS,NS
      COMMON /COLR/ KS(40,5),NS
      REAL SNGL
cGB
      Real     remPARJ32
      Real     remPARJ(5)
	Integer I,J,NCALL,NPRIN,NCHECK,NIPH,NB2,NSTB,IFL,IT,IPU1,IPU2
	Integer NIEL,IRFL,NIA1T,IPOM,IRAD,MSTJO
	Double Precision SHRAP,Q2LM,UMAS2,XR,DETOTR,XGTEST,Q12
	Double Precision PC1,PC2,PC3,PC4,CHEC,P1,P2,P3,P4
	Double Precision phielt,PHIROT,PZT,RMX2,STHARD

*PER
        integer iLMEPSPrint, MxLMEPSPrint
        parameter (MxLMEPSPrint = 10)
        save iLMEPSPrint
*PER

      logical first
      data    first /.TRUE./
c
c      SAVE KS,PS
cGB

      DATA NCALL/0/
      DATA NPRIN/0/
      DATA NCHECK/0/
      If(first) Then
         first = .FALSE.
         remPARJ32 = PARJ(32)
*PER
         iLMEPSPrint = 0
*PER
      ELSE
         PARJ(32)=remPARJ32
      EndIf
cGB
      DO I=1,40
         DO J=1,5
            KS(I,J) = 0
            PS(I,J) = 0.D0
         ENDDO
      ENDDO

c..hju
      NCALL = NCALL + 1
      IPY(48)=0
      LST(21)=0
C ILEPTO=1 parton shower a la LEPTO
C ILEPTO=0 parton shower a la PYTHIA
      SHRAP=DBLE(SHH)
      Q2PY = SNGL(Q2Q)
      Q2LP = SNGL(Q2)
      Q2LM = Q2
      IF(IRES(1).EQ.1) THEN
         DO 10 I=1,N
            IF(K(I,1).EQ.21.AND.K(I,2).EQ.22.AND.K(I,3).EQ.1) NIPH = I
            Q2LM = 0.0d0
   10    CONTINUE
      ELSE
         NIPH = NIA1
      ENDIF
c change to e in + z direction
      DO 20  I=1,N
         P(I,3) = - P(I,3)
   20 continue
      NB2 = 2
      UMAS2 = DBLE(ULMASS(K(2,2)))**2
      IF(IDIR.EQ.0) THEN
         NB2=NIA1+1
c         write(6,*) 'T2GKI',T2GKI,DOT1(NB2,NB2)
         UMAS2 = DBLE(T2GKI)
      ENDIF
c.hju parl(21) = 2P.k = invariant mass s
c.hjutest      PARL(21) = 2.D0*DOT1(1,NB2)
      PARL(21) = 2.D0*DOT1(1,2)
      IF(IDIR.EQ.0) PARL(21) = PARL(21) * DBLE(XFGKI)
      IF(ILEPTO.EQ.0) PARL(21) =PARL(21)+DBLE(ULMASS(K(1,2)))**2 +UMAS2
c.hju parl(22) = 2P.q P = proton(or pomeron) q = photon
      PARL(22) = 2.D0*DOT1(NB2,NIPH)
      IF(IABS(K(1,2)).EQ.22.OR.IABS(K(1,2)).EQ.23) Q2LM=0.0D0

      IF(IDIR.EQ.0) THEN
         XPRO = XPR/XFGKI
      ELSE
         XPRO = XPR
      ENDIF
      PYVAR(32) = XPRO
      XR = DBLE(XPRO)
      PYVAR(31) = XEL
      IF(NCALL.LE.NPRIN) CALL DULIST(1)
      IF(NCHECK.EQ.1) THEN
         write(6,*) ' LMEPS: 1st '
         CALL DULIST(1)
      ENDIF
      IF(ILEPTO.EQ.1) THEN
C...Transform to gamma p(or pomeron) cms, boost parameters in double precision.
         DETOT=P(NIPH,4)+P(NB2,4)
         DBETA(2,1)=(P(NIPH,1)+P(NB2,1))/DETOT
         DBETA(2,2)=(P(NIPH,2)+P(NB2,2))/DETOT
         DBETA(2,3)=(P(NIPH,3)+P(NB2,3))/DETOT
         CALL DUDBRB(0,0,0.D0,0.D0,-DBETA(2,1),-DBETA(2,2),-DBETA(2,3))
         SPHI(2)=DLANGL(P(NIPH,1),P(NIPH,2))
         CALL DUDBRB(0,0,0.D0,-SPHI(2),0.D0,0.D0,0.D0)
         STHETA(2)=DLANGL(P(NIPH,3),P(NIPH,1))
         CALL DUDBRB(0,0,-STHETA(2),0.D0,0.D0,0.D0,0.D0)
      ENDIF
c         write(6,*) ' LMEPS: in gamma p ',NB2
c         CALL DULIST(1)
      IF(IDIR.EQ.0) THEN
         DO J=1,5
            KS(31,J) = K(NIA1+1,J)
            PS(31,J) = P(NIA1+1,J)
            KS(32,J) = K(N,J)
            PS(32,J) = P(N,J)
         ENDDO
      ENDIF
      IF(ILEPTO.EQ.1.and.IRES(1).EQ.1) THEN
         NSTB = 5
         DETOTR=P(NIA1,4)+P(NIA2,4)
         DBETAR(2,1)=(P(NIA1,1)+P(NIA2,1))/DETOTR
         DBETAR(2,2)=(P(NIA1,2)+P(NIA2,2))/DETOTR
         DBETAR(2,3)=(P(NIA1,3)+P(NIA2,3))/DETOTR
         CALL DUDBRB(nstb,0,0.D0,0.D0,-DBETAR(2,1),-DBETAR(2,2),
     +   -DBETAR(2,3))
         SPHIR(2)=DLANGL(P(NIA1,1),P(NIA1,2))
         CALL DUDBRB(nstb,0,0.D0,-SPHIR(2),0.D0,0.D0,0.D0)
         STHETAR(2)=DLANGL(P(NIA1,3),P(NIA1,1))
         CALL DUDBRB(nstb,0,-STHETAR(2),0.D0,0.D0,0.D0,0.D0)

         if(ncall.le.nprin) call dulist(1)
      ENDIF
c      IF(NCHECK.EQ.1) THEN
c         write(6,*) ' LMEPS: 2nd '
c         CALL DULIST(1)
c      ENDIF

      IF(NCALL.LE.NPRIN) CALL DULIST(1)
C...Save event record in  cms
      DO 30 I=1,N
         DO 30 J=1,5
            KS(I,J)=K(I,J)
   30 PS(I,J)=P(I,J)
C...Rearrange event record to PYSSPA standard
      DO 40 J=1,5
         K(3,J)=0
         P(3,J)=0.D0
         K(4,J)=0
         P(4,J)=0.D0
         K(5,J)=KS(NIA1,J)
         P(5,J)=PS(NIA1,J)
         IF(IABS(K(1,2)).EQ.11.OR.IABS(K(1,2)).EQ.13) THEN
            K(7,J)=KS(3,J)
            P(7,J)=PS(3,J)
            K(9,J)=KS(3,J)
            P(9,J)=PS(3,J)
         ENDIF
         K(8,J)=KS(NF1,J)
         P(8,J)=PS(NF1,J)

         K(11,J) = 0
         K(12,J) = 0
         IF(IDIR.EQ.0) THEN
            K(11,J) = KS(31,J)
            P(11,J) = PS(31,J)
            K(12,J) = KS(32,J)
            P(12,J) = PS(32,J)
         ENDIF
         IF(IRES(1).EQ.1) THEN
            K(14,J) = KS(NIR1,J)
            K(14,1) = 21
            K(14,3) = 3
            P(14,J) = PS(NIR1,J)
            K(15,J) = KS(NIA1,J)
            K(15,1) = 21
            K(15,3) = 3
            P(15,J) = PS(NIA1,J)
         ENDIF

C check for radiative gamma
         IF(KS(4,2).EQ.22.AND.KS(4,1).EQ.1) THEN
            K(13,J) = KS(4,J)
            P(13,J) = PS(4,J)
         ENDIF
         K(10,J)=KS(NF2,J)
   40 P(10,J)=PS(NF2,J)
      K(5,3)=3
      K(6,3)=4
      K(7,3)=5
      K(8,3)=6
      K(9,3)=5
      K(10,3)=6
      DO 50 I=5,10
   50 K(I,1)=21
      K(9,1)=0
C...Incoming parton
      DO 60 J=1,4
         IF(ILEPTO.EQ.1) THEN
            IF(IPRO.NE.12) THEN

               P(6,J)=P(8,J) + P(10,J) - P(5,J)
               IF(IRES(1).NE.0) P(6,J)=PS(NIA2,J)
            ELSEIF(IPRO.EQ.12) THEN
               P(6,J)=PS(NIA2,J)

            ENDIF
         ELSE
            P(6,J)=PS(NIA2,J)
         ENDIF
c this redinition of incoming and outgoing parton is needed
c because in PYREMN there is a boost to correct for the long. frame in case
c there are different masses for outgoing parton and remnant.

   60 CONTINUE
      IF(IPRO.EQ.12.AND.ILEPTO.EQ.1) THEN
         IF(Q2LM.GT.2.D0) THEN
            P(6,3)=(PS(NF1,5)**2+Q2LM)*(PS(NIA1,4)-PS(NIA1,3))
     +      /(2.D0*Q2LM)
            P(6,4)=-P(6,3)
         ELSE
            P(6,3)=-(PS(NF1,5)**2+Q2LM)/(PS(NIA1,4)+PS(NIA1,3))/2.D0
            P(6,4)=-P(6,3)
         ENDIF

         DO 70 J=1,4
            P(8,J)= PS(NIA1,J) + P(6,J)
            PS(NF1,J) = P(8,J)
   70    CONTINUE
      ENDIF
c end of redefintion
      P(6,5)=0.0D0
      IF(ISEMIH.EQ.1) P(6,5)=PS(NIA2,5)
      K(6,2)=KS(NIA2,2)
      N=15
      IF(NCALL.LE.NPRIN) THEN
         CALL DULIST(1)
      ENDIF
C...Partons with colour information in hadronic cms frame.
      DO 80  I=16,MSTU(4)
         DO 80 J=1,5
            K(I,J)=0
            P(I,J)=0.D0
   80 V(I,J)=0.
      NS=20

      DO 90  J=1,5
         IF(IPRO.NE.12) THEN
            N=NS+7
            K(NS+1,J)=K(5,J)
            P(NS+1,J)=P(5,J)
            K(NS+3,J)=K(6,J)
            P(NS+3,J)=P(6,J)
            K(NS+5,J)=K(8,J)
            P(NS+5,J)=P(8,J)
            K(NS+6,J)=K(10,J)
            P(NS+6,J)=P(10,J)
            IF(IRES(1).NE.0) THEN
               K(NS+1,1) = 13
            ENDIF
         ELSEIF(IPRO.EQ.12) THEN
            N=NS+6
            K(NS+1,J)=K(5,J)
            P(NS+1,J)=P(5,J)
            K(NS+3,J)=K(6,J)
            K(NS+5,J)=K(8,J)
            P(NS+5,J)=P(8,J)
            P(NS+3,J)=P(6,J)
         ENDIF
   90 CONTINUE
C...Old standard continuation lines
      K(NS+2,1)=-1
      K(NS+2,3)=NS+1
      K(NS+4,1)=-1
      K(NS+4,3)=NS+3
      IF(IPRO.NE.12) THEN
         P(NS+4,3)=27
         P(NS+4,4)=27
      ELSEIF(IPRO.EQ.12) THEN
         P(NS+4,3)=NS+5
         P(NS+4,4)=NS+5
      ENDIF
C...Origin and Colour info for incoming parton
      K(NS+3,1)=13
      K(NS+3,3)=2
      IF(IPRO.NE.12) THEN
         K(NS+3,4)=27
         K(NS+3,5)=27
C...Colour info for two outgoing partons
         K(NS+5,1)=3
         K(NS+6,1)=3
         IF(IPRO.EQ.15) THEN
c qg event
            IF(K(NS+5,2).GT.0) THEN
               K(NS+5,4)=(NS+6)*MSTU(5)
               K(NS+5,5)=(NS+7)*MSTU(5)
               K(NS+6,4)=(NS+7)*MSTU(5)
               K(NS+6,5)=(NS+5)*MSTU(5)
            ELSE
               K(NS+5,4)=(NS+7)*MSTU(5)
               K(NS+5,5)=(NS+6)*MSTU(5)
               K(NS+6,4)=(NS+5)*MSTU(5)
               K(NS+6,5)=(NS+7)*MSTU(5)
            ENDIF
         ELSE
C qqbar event
            IF(IRES(1).EQ.0) THEN
               K(NS+5,4)=(NS+7)*MSTU(5)
               K(NS+5,5)=(NS+7)*MSTU(5)
               K(NS+6,4)=(NS+7)*MSTU(5)
               K(NS+6,5)=(NS+7)*MSTU(5)
            ENDIF
         ENDIF
C...Effective outgoing parton = sum of both outgoing partons
         K(NS+7,1)=14
         K(NS+7,3)=3
         IF(IPRO.NE.15) THEN
C... qqbar event
            IF(IRES(1).EQ.0) THEN
               K(NS+7,2)=21
               IF(K(NS+5,2).GT.0) THEN
                  K(NS+7,4)=(NS+3)*MSTU(5)+25
                  K(NS+7,5)=(NS+3)*MSTU(5)+26
               ELSE
                  K(NS+7,4)=(NS+3)*MSTU(5)+26
                  K(NS+7,5)=(NS+3)*MSTU(5)+25
               ENDIF
            ELSE
               CALL COLRES

            ENDIF
         ELSEIF(IPRO.EQ.15) THEN
c... qg event
            K(NS+7,2)=K(NS+5,2)
            IF(K(NS+7,2).GT.0) THEN
               K(NS+7,4)=(NS+3)*MSTU(5)+26
               K(NS+7,5)=(NS+3)*MSTU(5)+25
            ELSE
               K(NS+7,4)=(NS+3)*MSTU(5)+25
               K(NS+7,5)=(NS+3)*MSTU(5)+26
            ENDIF
         ENDIF
         DO 100 J=1,4
            IF(IRES(1).EQ.0) THEN
               P(NS+7,J)=P(8,J)+P(10,J)
            ELSEIF(IRES(1).EQ.1) THEN
               P(NS+7,J)=P(8,J)+P(10,J)
            ENDIF
  100    CONTINUE
         P(NS+7,5)=DSQRT(DMAX1(0.D0, P(NS+7,4)**2-P(NS+7,1)**2-P(NS+
     +   7,2)**2- P(NS+7,3)**2))
         N=NS+7

CPHI
      ELSEIF(IPRO.EQ.12) THEN
         K(NS+3,4)=NS+5
         K(NS+3,5)=NS+5
         K(NS+5,1)=3
         K(NS+5,3)=8
         K(NS+6,1)=-1
         K(NS+6,3)=NS+5
         P(NS+6,1)=NS+3
         P(NS+6,2)=NS+3
         K(NS+5,4)=(NS+3)*MSTU(5)
         K(NS+5,5)=(NS+3)*MSTU(5)
         P(NS+5,5)=DBLE(ULMASS(K(NS+5,2)))
         N=NS+6
      ENDIF
C...Scale for bremsstrahlung etc.

      SH = SNGL(SHRAP)
      IPY(40)=10
      IF(IPRO.EQ.12) IPY(40)=8
      IPY(47)=N
C...Save quantities for later use.
      IPY(41)=K(1,2)
      IF(IRES(1).EQ.1) IPY(41)=22
      IPY(42)=KINT(2,2)
      XPY(1)=1.
      XPY(2)=SNGL(XR)
      IF(IRES(1).EQ.1) THEN
         IPY(41)=22
         PYVAR(2) = -Q2LP +SNGL(PARL(22))
         PYVAR(31)=SNGL(SHRAP)/PYVAR(2)/PYVAR(32)
         XPY(1)=PYVAR(31)
         IF(XPY(1).GT.1.1) THEN
            write(6,*) ' LMEPS : XPY(1) > 1. ',XPY(1)
            write(6,*) ' LMEPS :s_hat, W**2, x_p',
     +        SHRAP,PYVAR(2),PYVAR(32)
            write(6,*) ' LMEPS :y, sss, q2lp, xel, xel/yy ',
     +        yy,sss,q2lp,xel,xel/yy
         ENDIF
         XPY(1)=AMIN1(1.0,XPY(1))
         CALL PYSTFU(IPY(41),XPY(1),Q2PY,XPQ1)
         IF(NCALL.LE.NPRIN) THEN
            write(6,*) ' IPY(41),XPY(1),Q2PY,XPQ1', IPY(41),XPY(1),
     +      Q2PY,XPQ1
         ENDIF
      ENDIF

c.hju CALL PYSTFU(K(2,2),XR,Q2,XPQ)
      IF(XPY(2).GT.1.) write(6,*) 'LMEPS : XPY(2) > 1. ',XPY(2)

      CALL PYSTFU(IPY(42),XPY(2),Q2PY,XPQ2)
      DO 110 I=-6,6
         IF(XPQ2(I).EQ.0.0) XPQ2(I)=1.E-11
  110 CONTINUE
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' IPY(42),XPY(2),Q2PY,XPQ2',
     +    IPY(42),XPY(2),Q2PY,XPQ2
      ENDIF
      DO 120 IFL=-6,6
         XQPY(1,IFL)=XPQ1(IFL)
  120 XQPY(2,IFL)=XPQ2(IFL)
      ISUB=39
      IPY(11)=1
      KFL(2,1)=KS(NIA1,2)
      KFL(2,2)=K(6,2)
      KFL(1,1)=KFL(2,1)
      KFL(1,2)=KFL(2,2)
      KFL(3,1)=K(1,2)
      KFL(3,2)=K(27,2)
      IF(IPRO.EQ.12) KFL(3,2)=K(8,2)
      PYVAR(2)=SNGL(PARL(21))
      IF(IRES(1).EQ.1) PYVAR(2) = -Q2LP +SNGL(PARL(22))
      PYVAR(3)=SNGL(P(1,5))
      PYVAR(4)=SNGL(P(2,5))
      PYVAR(1)=SQRT(PYVAR(2))
      PYVAR(5)=PYVAR(1)/2.


C...Generate timelike parton shower (if required)
      IF(IPY(13).EQ.1) THEN
         CALL LSCALE(1,QMAX)
         IF(IPRO.NE.12) THEN
            CALL DUSHOW(25,26,QMAX)
c		write(6,*) ' qmax,shat ',qmax,sqrt(shh)
         ELSEIF(IPRO.EQ.12) THEN
            QMAX = MIN(QMAX,SNGL(P(25,4)))
            CALL DUSHOW(25,0,QMAX)
         ENDIF
      ENDIF
      IT=25
      IF(N.GE.27) IT=27
      NS=N
C...Generate spacelike parton shower (if required)
      IPU1=0
changed
      IF(IRES(1).EQ.1) IPU1=21
      IPU2=23

      XGTEST = (P(21,5)**2 + P(IT,5)**2+DBLE(PYPAR(22)))/PARL(22)

      IF(IPY(14).GE.1.AND.XGTEST.LT.0.999) THEN
         CALL PYSSPA(IPU1,IPU2)
         IF(LST(21).NE.0) THEN
            IF(LST(21).EQ.55) THEN
            ELSE
               RETURN
            ENDIF
         ENDIF
      ENDIF
      IF(.NOT.(IPY(14).GE.1.AND.XGTEST.LT.0.999).OR.LST(21).EQ.55) THEN
         IF(LST(21).EQ.55) LST(21)=0
         DO 130 I=NS+1,NS+4
            DO 130 J=1,5
               K(I,J)=0
               P(I,J)=0.D0
  130    V(I,J)=0.
Cadded
         IF(IRES(1).EQ.0) THEN
            K(NS+1,1)=11
            K(NS+1,3)=21
         ELSE
            K(NS+1,1)=13
            K(NS+1,3)=21
            K(NS+1,4)=21
            K(NS+1,5)=21
            K(21,4)=K(21,4) + (NS+1)*MSTU(5)
            K(21,5)=K(21,5) + (NS+1)*MSTU(5)
         ENDIF
         K(NS+1,2)=KFL(2,1)
         DO 140 J=1,5
  140    P(NS+1,J)=P(21,J)
         K(NS+2,1)=-1
         K(NS+2,3)=NS+1
         K(NS+3,1)=13
         K(NS+3,2)=KFL(2,2)
         K(NS+3,3)=23
         K(NS+3,4)=23
         K(NS+3,5)=23
         P(NS+3,1)= 0.D0
         P(NS+3,2)= 0.D0
         P(NS+3,5)= 0.D0
         IF(ISEMIH.EQ.1) THEN
            Q12 = PS(NIA2,5)**2
            P(NS+3,1) = PS(NIA2,1)
            P(NS+3,2) = PS(NIA2,2)
            P(NS+3,5) = PS(NIA2,5)
         ELSE
            Q12 = 0.D0
         ENDIF
         IF(IRES(1).EQ.0) THEN
            IF(Q2LM.GT.2.D0) THEN
               P(NS+3,3)=(P(IT,5)**2+Q2LM+Q12)*(P(21,4)-P(21,3))/(2.D0*
     +         Q2LM)
               P(NS+3,4)=-P(NS+3,3)
            ELSE
               P(NS+3,3)=-(P(IT,5)**2+Q2LM+Q12)/(P(21,4)+P(21,3))/2.D0
               P(NS+3,4)=-P(NS+3,3)
            ENDIF
         ELSE
            P(NS+3,3) = P(23,3)
            P(NS+3,4) = P(23,4)
         ENDIF
         IF(NCALL.LT.NPRIN) THEN
            write(6,*) ' LMEPS NS+3,23,it ',P(NS+3,3),P(23,3),P(IT,5)
            write(6,*) ' LMEPS Q2 ',Q2,P(21,5)**2
         ENDIF

         K(NS+4,1)=-1
         K(NS+4,3)=NS+3
         P(NS+4,3)=23
         P(NS+4,4)=23
         P(24,1)=NS+3
         P(24,2)=NS+3
         K(23,4)=K(23,4)+(NS+3)*MSTU(5)
         K(23,5)=K(23,5)+(NS+3)*MSTU(5)
         IPU1=0
         IF(IRES(1).EQ.1) IPU1=NS+1
         IPU2=NS+3
         N=N+4
      ENDIF
C...Rotate and boost outgoing parton shower
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' before rotate and boost outgoing PS '
         CALL DULIST(2)
      ENDIF
changed      IF(ILEPTO.EQ.1.AND.IPRO.NE.12.AND.N.GT.31) THEN
      IF(ILEPTO.EQ.1.AND.IPRO.NE.12.AND.N.GT.31.and.IRES(1).EQ.0) THEN
         K(N+1,1)=0
         DO 150 J=1,4
  150    P(N+1,J)=P(NS+1,J)+P(NS+3,J)
         ROBO(1)=DLANGL(P(IT,3),SQRT(P(IT,1)**2+P(IT,2)**2))
         ROBO(2)=DLANGL(P(IT,1),P(IT,2))
         CALL DUDBRB(25,NS,0.D0,-ROBO(2),0.D0,0.D0,0.D0)
         CALL DUDBRB(25,NS,-ROBO(1),0.D0,0.D0,0.D0,0.D0)
         DELTAP(1) = P(N+1,1)
         DELTAP(2) = P(N+1,2)
         DELTAP(3) = P(N+1,3) - P(IT,3)
         DELTAP(4) = DSQRT(DELTAP(1)**2+DELTAP(2)**2+DELTAP(3)**2)
         DPLONG = -(P(IT,3)*DELTAP(3))/DELTAP(4)
         DBTOT = -(DPLONG*P(IT,4)- P(N+1,4)*DSQRT(DMAX1(0.D0,P(N+1,4)**
     +   2- P(IT,4)**2+DPLONG**2)))/(DPLONG**2+P(N+1,4)**2)
         DGAMMA = 1.D0/DSQRT(1.D0-DBTOT**2)
         DO 160 I = 1,3
            DROBO(I+2)=DELTAP(I)/(DGAMMA/(DGAMMA+1.D0)* (P(N+1,4)-
     +      DGAMMA*P(IT,4))+DGAMMA*P(IT,4))
  160    CONTINUE
         CALL DUDBRB(25,NS,0.D0,0.D0,DROBO(3),DROBO(4),DROBO(5))
C...End phi-correction
      ELSEIF(ILEPTO.EQ.1.AND.IPRO.EQ.12.AND.N.GT.30) THEN
         K(N+1,1)=0
         DO 170  J=1,4
  170    P(N+1,J)=P(NS+1,J)+P(NS+3,J)
         IF(P(N+1,4).LE.1.01D0*P(IT,5)) THEN
            LST(21)=46
            RETURN
         ENDIF
         ROBO(1)=DLANGL(P(IT,3),SQRT(P(IT,1)**2+P(IT,2)**2))
         ROBO(2)=DLANGL(P(IT,1),P(IT,2))
         CALL DUDBRB(25,NS,0.D0,-ROBO(2),0.D0,0.D0,0.D0)
         CALL DUDBRB(25,NS,-ROBO(1),0.D0,0.D0,0.D0,0.D0)
C old phi
         DROBO(5)=-(P(IT,3)*P(IT,4)-P(N+1,4)*SQRT(P(N+1,4)**2- P(IT,4)*
     +   *2+P(IT,3)**2))/(P(IT,3)**2+P(N+1,4)**2)
         CALL DUDBRB(25,NS,0.D0,0.D0,0.D0,0.D0,DROBO(5))
         ROBO(1)=DLANGL(P(N+1,3),SQRT(P(N+1,1)**2+P(N+1,2)**2))
         ROBO(2)=DLANGL(P(N+1,1),P(N+1,2))
         CALL DUDBRB(25,NS,ROBO(1),ROBO(2),0.D0,0.D0,0.D0)
      ENDIF

      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' after rotate and boost outgoing PS '
         call dulist(1)
      ENDIF
C...Hadron remnant and primordial kt
      IPY(47)=N
      IF(IRES(1).EQ.0) THEN
         IPU1=0
         PYVAR(31)=XEL
      ELSEIF(IRES(1).EQ.1.AND.ILEPTO.EQ.0) THEN
         IF(IABS(K(1,2)).EQ.11.OR.IABS(K(1,2)).EQ.13) THEN
            IPY(41)=K(1,2)
            PYVAR(31)=PYVAR(31)*YY
         ENDIF
      ENDIF
      IF(N.GT.MSTU(4)-20) THEN
         WRITE(6,*) ' LMEPS before PYREMN: no more memory in LUJETS'
         LST(21)=51
         RETURN
      ENDIF
      CALL PYREMN(IPU1,IPU2)
      IF(NCALL.LE.NPRIN) CALL DULIST(2)
      IF(IPY(48).GE.1) THEN
         LST(21)=47+IPY(48)
         RETURN
      ENDIF
C...Rearrange partons along strings
      MSTU(24)=0
      MSTU(28)=0
      IF(IFPS.EQ.10) THEN
         MSTJO = MSTJ(105)
         MSTJ(105) = -1
      ENDIF
      IF(N.GT.MSTU(4)-20) THEN
         WRITE(6,*) ' LMEPS before DUPREP: no more memory in LUJETS'
         LST(21)=51
         RETURN
      ENDIF
cGB..
*==> Don't allow certain decay modes if collapsing
      RMX2     = -Q2 + PARL(22) + DBLE(T2GKI)
*
      If (RMX2.LT.4.0.AND.IDIR.EQ.0) Then
         If(ABS(KPA).LE.2) Then
            PARJ(32) = 0.35
            GOTO 180
         ElseIf(ABS(KPA).EQ.3) Then
            PARJ(32) = 0.1
            GOTO 180
         EndIf
  180    Continue
*
         remPARJ(1) = PARJ(11)
         remPARJ(2) = PARJ(12)
         remPARJ(3) = PARJ(13)
         remPARJ(4) = PARJ(27)
         remPARJ(5) = PARJ(28)
*
         PARJ(11) = 1.0
         PARJ(12) = 1.0
         PARJ(13) = 1.0
         PARJ(27) = 0.1
         PARJ(28) = 0.9
*
         CALL DUPREP(0)
         PARJ(11) = remPARJ(1)
         PARJ(12) = remPARJ(2)
         PARJ(13) = remPARJ(3)
         PARJ(27) = remPARJ(4)
         PARJ(28) = remPARJ(5)
      ElseIf (RMX2.GT.9.0.AND.RMX2.LT.14.AND.
     + ABS(KPA).EQ.4.AND.IDIR.EQ.0) Then
         remPARJ(2) = PARJ(12)
         remPARJ(3) = PARJ(13)
         PARJ(13) = 1.0
         CALL DUPREP(0)
         PARJ(13) = remPARJ(3)
         PARJ(12) = remPARJ(2)

      Else

         CALL DUPREP(0)

      EndIf
cGB....
      IF(IFPS.EQ.10) THEN
         MSTJ(105) = MSTJO
      ENDIF
      IF(MSTU(24).NE.0.OR.MSTU(28).NE.0) THEN
         if (iLMEPSPrint .le. MxLMEPSPrint) then
            iLMEPSPrint = iLMEPSPrint + 1
            WRITE(6,*) ' LMEPS: LUPREP error MSTU(24)= ',MSTU(24)
            write(6,*) ' color configuration ICOLORA,IRESPRO ',
     +           ICOLORA,IRESPRO
            write(6,*) ' res. photon ?  ',IRES(1)
            call DULIST(2)
         endif
         LST(21)=50
         RETURN
      ENDIF
      IF(ILEPTO.EQ.0.AND.IDIR.EQ.0) THEN
         K(12,1)=1
         CALL DUDBRB(NSTB,0,STHETA(2),0.D0,0.D0,0.D0,0.D0)
         CALL DUDBRB(NSTB,0,0.D0,sphi(2),0.D0,0.D0,0.D0)
         CALL DUDBRB(NSTB,0,0.D0,0.D0,DBETA(2,1),DBETA(2,2),DBETA(2,3))
      ENDIF

C...Clean up event record -> order:
C...1=inc. lepton; 2=inc. nucleon; 3=exch boson; 4=scat. lepton;
C... (4+1) = rad. gamma if any
C...5+1=inc. parton before initial shower; 6+1=inc. parton at hard scattering
C...after shower; 7+1,8+1=first,second parton from hard scattering
C...before final shower
      IF(NCALL.LT.NPRIN) CALL DULIST(1)
      DO 190 J=1,5
         K(N+2,J)=K(3,J)
         P(N+2,J)=P(3,J)
         K(N+1,J)=K(4,J)
         P(N+1,J)=P(4,J)
         K(10,J)=0
         K(N+3,J)=KS(32,J)
         P(N+3,J)=PS(32,J)
         K(12,J)=KS(32,J)
         P(12,J)=PS(32,J)


         K(N+4,J)=KS(NIPH,J)
         P(N+4,J)=PS(NIPH,J)
  190 CONTINUE
      DO 200 I=1,20
         DO 200 J=1,5
            PS(I,J) = P(I,J)
  200 KS(I,J) = K(I,J)
      IRFL = 0
      DO 210 J=1,5
         IPOM=0
         IRAD = 0
         IF(ILEPTO.EQ.1) THEN
            K(3,J)=K(N+4,J)
            P(3,J)=P(N+4,J)
            NIA1T = 3
            NIEL=4
            K(NIEL,J)=KS(9,J)
            P(NIEL,J)=PS(9,J)
            IF(KS(13,1).NE.0) THEN
               K(NIEL+1,J)=KS(13,J)
               P(NIEL+1,J)=PS(13,J)
               IRAD = 1
               NIEL = 5
            ENDIF
            IF(IRES(1).EQ.1) THEN
               IRFL = 2
               K(NIEL+1,J) = K(N+2,J)
               K(NIEL+2,J) = K(NS+1,J)
               K(NIEL+1,1) = 21
               K(NIEL+1,3) = NIEL-1
               K(NIEL+2,1) = 21
               K(NIEL+2,3) = NIEL+1
               P(NIEL+1,J) = P(N+2,J)
               P(NIEL+2,J) = P(NS+1,J)
            ENDIF
            IF(KS(11,1).NE.0) THEN
               K(NIEL+1+IRFL,J)=KS(31,J)
               P(NIEL+1+IRFL,J)=PS(31,J)
               IPOM = 1
            ENDIF
            IF(IABS(K(1,2)).EQ.11.OR.IABS(K(1,2)).EQ.13) K(4,1)=1

         ENDIF
         K(NIEL+1+IRFL+IPOM,J)=K(N+1,J)
         P(NIEL+1+IRFL+IPOM,J)=P(N+1,J)
         K(NIEL+2+IRFL+IPOM,J)=K(NS+3,J)
         K(NIEL+2+IRFL+IPOM,3) = NIEL+1+IRFL+IPOM
         P(NIEL+2+IRFL+IPOM,J)=P(NS+3,J)
         NIA2 = NIEL + 2 + IRFL + IPOM
         K(NIEL+3+IRFL+IPOM,J)=K(25,J)
         P(NIEL+3+IRFL+IPOM,J)=P(25,J)
         NF1 = NIEL + 3 + IRFL + IPOM
         IF(IPRO.NE.12) THEN
            K(NIEL+4+IRFL+IPOM,J)=K(26,J)
            P(NIEL+4+IRFL+IPOM,J)=P(26,J)
            NF2 = NIEL + 4 + IRFL + IPOM
         ELSEIF(IPRO.EQ.12) THEN
            K(NIEL+4+IRFL+IPOM,J)=0
            NF2=NF1
         ENDIF
  210 CONTINUE
      K(3,3)=1
      K(4,3)=1
      K(NIEL+2+IRFL+IPOM,1)=21
      K(NIEL+2+IRFL+IPOM,3)=5+IRFL+IPOM
      K(NIEL+2+IRFL+IPOM,4)=0
      K(NIEL+2+IRFL+IPOM,5)=0
      K(NIEL+3+IRFL+IPOM,1)=21
      K(NIEL+3+IRFL+IPOM,3)=NIA1T
      K(NIEL+3+IRFL+IPOM,4)=0
      K(NIEL+3+IRFL+IPOM,5)=0
      IF(IPRO.NE.12) THEN
         K(NIEL+4+IRFL+IPOM,1)=21
         K(NIEL+4+IRFL+IPOM,3)=NIA1T
         K(NIEL+4+IRFL+IPOM,4)=0
         K(NIEL+4+IRFL+IPOM,5)=0
      ENDIF
      K(25,3) = NIEL + 3 + IRFL + IPOM
      K(26,3) = NIEL + 4 + IRFL + IPOM
      IF(IRES(1).EQ.1) THEN
         P(NIEL+1,5)=-DSQRT(dabs(P(NIEL+1,1)**2 + P(NIEL+1,2)**2
     +   + P(NIEL+1,3)**2 - P(NIEL+1,4)**2))
         P(NIEL+2,5)=-DSQRT(dabs(P(NIEL+2,1)**2 + P(NIEL+2,2)**2
     +   + P(NIEL+2,3)**2 - P(NIEL+2,4)**2))
      ENDIF
      NIA1 = NIA1T
C...Deactivate obsolete lines 9, 10, 21, NS+1 (extra lines with boson)
      K(21,1)=0
      IF(IRFL.EQ.0) THEN
         K(NIEL-IRAD+6+IPOM,1)=0
      ELSE

      ENDIF
      IF(K(NS+1,2).EQ.K(3,2)) K(NS+1,1)=0
      K(13,1)=0
      K(14,1)=0
      K(15,1)=0
C...Zero irrelevant lines with K(I,1)<0
      DO 230 I=1,N
         IF(K(I,1).LT.0) THEN
            DO 220 J=1,5
               K(I,J)=0
  220       P(I,J)=0.D0
         ENDIF
  230 CONTINUE
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' LMEPS: before LUEDIT '
         CALL DULIST(1)
      ENDIF
C...Delete internal parton lines, i.e. with K(I,1)=13,14
c      IF(MOD(1/10,10).EQ.0) THEN
      CALL DUEDIT(14)
c      ENDIF
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' LMEPS:after LUEDIT(14) '
         CALL DULIST(1)
      ENDIF
C...Delete empty lines
      CALL DUEDIT(12)
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' LMEPS:after LUEDIT(12) '
         CALL DULIST(1)
      ENDIF
      IF(IPRO.EQ.12.AND.PT2GEN.NE.0.D0) THEN
         phielt=DLANGL(P(1,1),P(1,2))
         CALL DUDBRB(0,0,0.D0,-phielt,0.D0,0.D0,0.D0)
         PZT = DSQRT(P(NF1,4)**2 - P(NF1,5)**2 - PT2GEN)
         STHARD = DLANGL(PZT,DSQRT(PT2GEN))
         CALL DUDBRB(NF1,NF1,STHARD,0.D0,0.D0,0.D0,0.D0)
         CALL DUDBRB(NF1+2,N,STHARD,0.D0,0.D0,0.D0,0.D0)
         phirot=PHIGEN
         CALL DUDBRB(NF1,NF1,0.D0,PHIROT,0.D0,0.D0,0.D0)
         CALL DUDBRB(NF1+2,N,0.D0,PHIROT,0.D0,0.D0,0.D0)
         CALL DUDBRB(0,0,0.D0,phielt,0.D0,0.D0,0.D0)
c       nre=5
c       te11 = P(nre,2)*p(1,3)-p(nre,3)*p(1,2)
c       te12 = P(nre,3)*p(1,1)-p(nre,1)*p(1,3)
c       te13 = P(nre,1)*p(1,2)-p(nre,2)*p(1,1)
c       te21 = P(nre,2)*p(nf1,3)-p(nre,3)*p(nf1,2)
c       te22 = P(nre,3)*p(nf1,1)-p(nre,1)*p(nf1,3)
c       te23 = P(nre,1)*p(nf1,2)-p(nre,2)*p(nf1,1)
c       prod = te11*te21 + te12*te22 + te13*te23
c       write(6,*) 'sc vec_prod ',prod
c       prod=prod/dsqrt(te11**2+te12**2+te13**2)
c       prod=prod/dsqrt(te21**2+te22**2+te23**2)
c       write(6,*) ' LMEPS NF1,phielt,phirot ',NF1,phielt,phirot
c       write(6,*) ' LMEPS checking pt2,phi,phi_calc',pt2gen,phigen
c     &    ,dacos(prod)
c       write(6,*) ' LMEPS checking cos(phi,phi_calc)',cos(phigen)
c     &    ,prod
c         call dulist(1)
      ENDIF

c check for enegy momentum conservation
      DO 250 I=1,N
         IF(P(I,5).LT.0.0D0.OR.K(I,1).GT.2) GOTO 250
         DO 240 J=1,4
            IF(ABS(P(I,J)).LE.1.E-6) THEN
               P(I,J)=0.0D0
            ENDIF
  240    CONTINUE
  250 CONTINUE
      CHEC = 5.D-3
      P1 =ABS(P(1,1)+P(2,1))
      P2 =ABS(P(1,2)+P(2,2))
      P3 =ABS(P(1,3)+P(2,3))
      P4 =ABS(P(1,4)+P(2,4))
      PC1 = (ABS(DPLU(0,1)) - P1)/P4
      PC2 = (ABS(DPLU(0,2)) - P2)/P4
      PC3 = (ABS(DPLU(0,3)) - P3)/P4
      PC4 = (ABS(DPLU(0,4)) - P4)/P4
      IF(DABS(PC1).GT.CHEC.
     +   OR.DABS(PC2).GT.CHEC.
     +   OR.DABS(PC3).GT.CHEC.
     +   OR.DABS(PC4).GT.CHEC) THEN
         if (iLMEPSPrint .le. MxLMEPSPrint) then
            iLMEPSPrint = iLMEPSPrint + 1
            write(6,*) ' LMEPS: energy of final particles not correct'
     +           ,chec
            write(6,*) ' PC1 = ',PC1,pC2,pC3,pC4
            write(6,*) ' Q2 = ',Q2,' Q2_calc = ',DOT1(3,3)
            write(6,*) ' yy = ',yy,' y_calc = ',DOT1(2,3)/DOT1(2,1)
            write(6,*) ' x_bj = ',Q2/PARL(22),' W = ',SQRT(-Q2+PARL(22))
            write(6,*) ' IPRO = ',IPRO
            call DULIST(1)
         endif
         LST(21) = 100
      ENDIF
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' in gamma pom system '
         CALL DULIST(1)
      ENDIF
      IF(ILEPTO.EQ.1) THEN
         CALL DUDBRB(0,0,STHETA(2),SPHI(2),0.D0,0.D0,0.D0)
         CALL DUDBRB(0,0,0.D0,0.D0,DBETA(2,1),DBETA(2,2),DBETA(2,3))
      ENDIF
c... change z coordinate from LEPTO61 standard to rapgap standard
      do 260 i=1,n
  260 p(i,3) = - p(i,3)
      DO 270 I=1,4
         IF(ABS(P(NIEL,I)).LE.1.E-6) THEN
            P(NIEL,I)=0.0D0
         ENDIF
         P(1,I)=PBEAM(1,I)
         P(2,I)=PBEAM(2,I)
  270 CONTINUE
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' after boost dbeta in lmeps'
         CALL DULIST(1)
      ENDIF
      IF(NCHECK.EQ.1) THEN
         write(6,*) ' LMEPS final '
         CALL DULIST(1)
      ENDIF
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.42.05  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  21.50.10  by  Hannes Jung
*-- Author :
      SUBROUTINE LPRIKT(S,PT,PHI)
	IMPLICIT NONE
      Double Precision draprn
	Real S,PT,PHI
      EXTERNAL draprn
C...Size (PT) and azimuthal angle (PHI) of primordial kt according
C...to a Gaussian distribution.

      PT=S*SQRT(-ALOG(Real(draprn())))
      PHI=6.2832*draprn()
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.25  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  21.54.41  by  Hannes Jung
*-- Author :
C **********************************************************************

      SUBROUTINE LREMH(IFLRO,IFLR,K2,Z)
	Implicit None

C...Gives flavour and energy-momentum fraction Z for the particle
C...to be produced out of the target remnant when that is not a
C...simple diquark.
      DOUBLE PRECISION PARL
	Real CUT,X,Y,W2,Q2,U
	Integer LST
      COMMON /RAPTOU/ CUT(14),LST(40),PARL(30),X,Y,W2,Q2,U
      Double Precision draprn
	Real ULMASS
	Integer IFLRO,IFLQ,IFLQQ,IFLR,KSP,K2,IDUM,K2A,LUCOMP,KC2
	Real AMSP,AMK2,Z,FC,A
      EXTERNAL draprn,LUCOMP,ULMASS

C...Flavours fixed when calling from PYREMN or LQQBEV
      IF(IFLRO.EQ.0) GOTO 20

C...Split target remnant qqqQ -> qqQ + q or qqqQbar -> qQbar + qq
C...Q (Qbar) is the partner to the struck sea quark
C...qqq are the nucleon valence quarks from which a quark q or a
C...diquark qq is chosen at random to form a jet system with the
C...scattered sea antiquark or quark, respectively, the other parton
C...forms a baryon qqQ or meson qQbar, respectively.
   10 IFLQ=INT(1.+LST(22)/3.+draprn())
      IF(IFLQ.EQ.LST(22)) THEN
         IFLQQ=2101
         IF(draprn().GT.SNGL(PARL(4))) IFLQQ =2103
      ELSE
         IFLQQ=1000*IFLQ+100*IFLQ+3
      ENDIF
      IFLQ=3-IFLQ

C...Choose flavour of hadron and parton for jet system
      IF(IFLRO.GT.0) THEN
         CALL LUKFDI(IFLQQ,IFLRO,IDUM,K2)
         IF(K2.EQ.0) GOTO 10
         IFLR=IFLQ
      ELSE
         CALL LUKFDI(IFLQ,IFLRO,IDUM,K2)
         IF(K2.EQ.0) GOTO 10
         IFLR=IFLQQ
      ENDIF

C...Entry for use from PYSSPA, flavours given, choose E-p fraction
   20 KSP=IFLR
C...Split energy-momentum of target remnant according to functions P(z)
C...z=E-pz fraction for qq (q) forming jet-system with struck Q (Qbar)
C...1-z=E-pz fraction for qQbar (qqQ) hadron
C...mq=mass of (light) parton remnant q (qq) in jet system
C...mQ=mass of produced (heavy flavour) hadron
      AMSP=ULMASS(KSP)
      AMK2=ULMASS(K2)
C...Old Lepto treatment
C...P(z)=(a+1)(1-z)**a with <z>=1/(a+2)=1/3 since a=1 fixed
      Z=1.-SQRT(draprn())
C...Flip if baryon produced
      KC2=IABS(LUCOMP(K2))
      IF(KC2.GE.301.AND.KC2.LE.400) Z=1.-Z
      IF(LST(14).EQ.2) THEN
C...Update of LEPTO treatment
C...P(z)=(a+1)(1-z)**a with <z>=1/(a+2)=mq/(mq+mQ) --> a=a(mq,mQ)
         A=(AMSP+AMK2)/AMSP - 2.
         Z=draprn()**(1./(A+1.))
      ELSEIF(LST(14).EQ.3) THEN
C...Using Peterson fragmentation function
C...P(z)=N/(z(1-1/z-c/(1-z))**2)  where c=(mq/mQ)**2  (FC=-c)
         FC=-(AMSP/AMK2)**2
   30    Z=draprn()
         IF(-4.*FC*Z*(1.-Z)**2.LT.draprn()*((1.-Z)**2-FC*Z)**2) GOTO 30
      ENDIF
      LST(27)=1
      K2A=IABS(K2)
      IF((K2A.GE.1.AND.K2A.LE.8).OR.K2A.EQ.21.OR.LUCOMP(K2A).EQ.90)
     +LST(27)=2
c      write(6,*) ' LREMH : ',Z,IFLR,K2,AMSP,AMK2
      RETURN
      END
*CMZ :  2.08/00 14/06/99  19.13.55  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  21.55.59  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE LSCALE(INFIN,QMAX)
      IMPLICIT NONE
      REAL QMAX
*KEEP,RGFULL.
      INTEGER IFULL,IQCDGRID
      COMMON /OALPINI/ IFULL,IQCDGRID
*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
      INTEGER INFIN
      IF(IFULL.EQ.0) THEN
         IF(IPRO.EQ.12) THEN
            QMAX = SNGL(Q2)
         ELSE
            QMAX = SNGL(P(27,5))**2
            IF(INFIN.LT.0) THEN
               IF(IPRO.EQ.18) THEN
                  QMAX = SNGL(Q2Q)
               ELSE
                  QMAX=SNGL(MAX(ABS(-Q2-2.D0*DOT1(25,21)), ABS(-Q2-
     +            2.D0* DOT1(26,21))))
               ENDIF
            ENDIF
         ENDIF
      ELSE
         IF(IPRO.EQ.12) THEN
            QMAX = 4.*SNGL(PT2CUT(13))
         ELSE
            QMAX = SNGL(P(27,5))**2
            IF(IPRO.EQ.99) QMAX = SNGL(P(28,5))**2
            IF(INFIN.LT.0) QMAX=SNGL(MAX(ABS(-Q2-2.D0*DOT1(25,21)),
     +      ABS(-Q2-2.D0*DOT1(26,21))))
            IF(IPRO.EQ.99.and.INFIN.LT.0) THEN
               QMAX=SNGL(MAX(ABS(-Q2-2.D0*DOT1(25,21)), ABS(-Q2-2.D0*
     +         DOT1(27,21))))
            ENDIF
         ENDIF
      ENDIF
      QMAX=SQRT(QMAX)
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.25  by  Hannes Jung
*CMZ :  2.07/03 16/05/99  08.52.56  by  Hannes Jung
*CMZ :          16/05/99  08.51.22  by  Hannes Jung
* changes done for low mass diffractive states by G. Briskin
*CMZ :          17/12/96  12.37.25  by  G.M. Briskin (TAU)
*-- Author :    G.M. Briskin (TAU)   30/11/96
C*********************************************************************

      SUBROUTINE LUKFDI(KFL1,KFL2,KFL3,KF)
	IMPLICIT NONE
C...Purpose: to generate a new flavour pair and combine off a hadron.
      Integer MSTU,MSTJ,KCHG
	Real PARU,PARJ,PMAS,PARF,VCKM
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
      COMMON/LUDAT2/KCHG(500,3),PMAS(500,4),PARF(2000),VCKM(4,4)
      SAVE /LUDAT1/,/LUDAT2/
	Integer LUCOMP
	Integer KFL1,KFL2,KFL3,KF,KC
	Integer KF1A,KF2A,KTAB1,KFL1A,KFL1B,KFL1S,KTAB2,KFL2A,KFL2B
	Integer KFL1D,KFL1E,KFL3A,KFL3B,KTAB3,KTABS
	Integer KFL2S,MBARY,KFDA,KFLDA,KFLDB,KFLDS,KFS
	Integer KFLA,KFLB,KFLC,KFLD,KFLE,KFLF,KFLL,KMUL,KFLS,IMIX,KBARY
	Integer KT3L,KT3U,KTS,KT3
	Real PAR2,PAR3,PAR4,PAR3M,PAR4M,PARDM,PARS0,PARS1,PARS2,PARSM
	Double Precision draprn
	Real WTDQ,RMUL,RMIX,RFL,WT
C

C...Default flavour values. Input consistency checks.
      KF1A=IABS(KFL1)
      KF2A=IABS(KFL2)
      KFL3=0
      KF=0
      IF(KF1A.EQ.0) RETURN
      IF(KF2A.NE.0) THEN
         IF(KF1A.LE.10.AND.KF2A.LE.10.AND.KFL1*KFL2.GT.0) RETURN
         IF(KF1A.GT.10.AND.KF2A.GT.10) RETURN
         IF((KF1A.GT.10.OR.KF2A.GT.10).AND.KFL1*KFL2.LT.0) RETURN
      ENDIF

C...Check if tabulated flavour probabilities are to be used.
      IF(MSTJ(15).EQ.1) THEN
         KTAB1=-1
         IF(KF1A.GE.1.AND.KF1A.LE.6) KTAB1=KF1A
         KFL1A=MOD(KF1A/1000,10)
         KFL1B=MOD(KF1A/100,10)
         KFL1S=MOD(KF1A,10)
         IF(KFL1A.GE.1.AND.KFL1A.LE.4.AND.KFL1B.GE.1.AND.KFL1B.LE.4)
     +   KTAB1=6+KFL1A*(KFL1A-2)+2*KFL1B+(KFL1S-1)/2
         IF(KFL1A.GE.1.AND.KFL1A.LE.4.AND.KFL1A.EQ.KFL1B) KTAB1=KTAB1-
     +   1
         IF(KF1A.GE.1.AND.KF1A.LE.6) KFL1A=KF1A
         KTAB2=0
         IF(KF2A.NE.0) THEN
            KTAB2=-1
            IF(KF2A.GE.1.AND.KF2A.LE.6) KTAB2=KF2A
            KFL2A=MOD(KF2A/1000,10)
            KFL2B=MOD(KF2A/100,10)
            KFL2S=MOD(KF2A,10)
            IF(KFL2A.GE.1.AND.KFL2A.LE.4.AND.KFL2B.GE.1.AND.KFL2B.LE.4)
     +      KTAB2=6+KFL2A*(KFL2A-2)+2*KFL2B+(KFL2S-1)/2
            IF(KFL2A.GE.1.AND.KFL2A.LE.4.AND.KFL2A.EQ.KFL2B) KTAB2=
     +      KTAB2-1
         ENDIF
         IF(KTAB1.GE.0.AND.KTAB2.GE.0) GOTO 60
      ENDIF

C...Parameters and breaking diquark parameter combinations.
   10 PAR2=PARJ(2)
      PAR3=PARJ(3)
      PAR4=3.*PARJ(4)
      IF(MSTJ(12).GE.2) THEN
         PAR3M=SQRT(PARJ(3))
         PAR4M=1./(3.*SQRT(PARJ(4)))
         PARDM=PARJ(7)/(PARJ(7)+PAR3M*PARJ(6))
         PARS0=PARJ(5)*(2.+(1.+PAR2*PAR3M*PARJ(7))*(1.+PAR4M))
         PARS1=PARJ(7)*PARS0/(2.*PAR3M)+PARJ(5)*(PARJ(6)*(1.+PAR4M)+
     +   PAR2*PAR3M*PARJ(6)*PARJ(7))
         PARS2=PARJ(5)*2.*PARJ(6)*PARJ(7)*(PAR2*PARJ(7)+(1.+PAR4M)/
     +   PAR3M)
         PARSM=MAX(PARS0,PARS1,PARS2)
         PAR4=PAR4*(1.+PARSM)/(1.+PARSM/(3.*PAR4M))
      ENDIF

C...Choice of whether to generate meson or baryon.
   20 MBARY=0
      KFDA=0
      IF(KF1A.LE.10) THEN
         IF(KF2A.EQ.0.AND.MSTJ(12).GE.1.AND.(1.+PARJ(1))*draprn().GT.1.)
     +   MBARY=1
         IF(KF2A.GT.10) MBARY=2
         IF(KF2A.GT.10.AND.KF2A.LE.10000) KFDA=KF2A
      ELSE
         MBARY=2
         IF(KF1A.LE.10000) KFDA=KF1A
      ENDIF

C...Possibility of process diquark -> meson + new diquark.
      IF(KFDA.NE.0.AND.MSTJ(12).GE.2) THEN
         KFLDA=MOD(KFDA/1000,10)
         KFLDB=MOD(KFDA/100,10)
         KFLDS=MOD(KFDA,10)
         WTDQ=PARS0
         IF(MAX(KFLDA,KFLDB).EQ.3) WTDQ=PARS1
         IF(MIN(KFLDA,KFLDB).EQ.3) WTDQ=PARS2
         IF(KFLDS.EQ.1) WTDQ=WTDQ/(3.*PAR4M)
         IF((1.+WTDQ)*draprn().GT.1.) MBARY=-1
         IF(MBARY.EQ.-1.AND.KF2A.NE.0) RETURN
      ENDIF

C...Flavour for meson, possibly with new flavour.
      IF(MBARY.LE.0) THEN
         KFS=ISIGN(1,KFL1)
         IF(MBARY.EQ.0) THEN
            IF(KF2A.EQ.0) KFL3=ISIGN(1+INT((2.+PAR2)*draprn()),-KFL1)
            KFLA=MAX(KF1A,KF2A+IABS(KFL3))
            KFLB=MIN(KF1A,KF2A+IABS(KFL3))
            IF(KFLA.NE.KF1A) KFS=-KFS

C...Splitting of diquark into meson plus new diquark.
         ELSE
            KFL1A=MOD(KF1A/1000,10)
            KFL1B=MOD(KF1A/100,10)
   30       KFL1D=KFL1A+INT(draprn()+0.5)*(KFL1B-KFL1A)
            KFL1E=KFL1A+KFL1B-KFL1D
            IF((KFL1D.EQ.3.AND.draprn().GT.PARDM).OR.(KFL1E.EQ.3.AND.
     +      draprn().LT.PARDM)) THEN
               KFL1D=KFL1A+KFL1B-KFL1D
               KFL1E=KFL1A+KFL1B-KFL1E
            ENDIF
            KFL3A=1+INT((2.+PAR2*PAR3M*PARJ(7))*draprn())
            IF((KFL1E.NE.KFL3A.AND.draprn().GT.(1.+PAR4M)/MAX(2.,1.+
     +      PAR4M)). OR.(KFL1E.EQ.KFL3A.AND.draprn().GT.2./MAX(2.,1.+
     +      PAR4M))) GOTO 30
            KFLDS=3
            IF(KFL1E.NE.KFL3A) KFLDS=2*INT(draprn()+1./(1.+PAR4M))+1
            KFL3=ISIGN(10000+1000*MAX(KFL1E,KFL3A)+100*MIN(KFL1E,KFL3A)
     +      + KFLDS,-KFL1)
            KFLA=MAX(KFL1D,KFL3A)
            KFLB=MIN(KFL1D,KFL3A)
            IF(KFLA.NE.KFL1D) KFS=-KFS
         ENDIF

C...Form meson, with spin and flavour mixing for diagonal states.
         IF(KFLA.LE.2) KMUL=INT(PARJ(11)+draprn())
         IF(KFLA.EQ.3) KMUL=INT(PARJ(12)+draprn())
         IF(KFLA.GE.4) KMUL=INT(PARJ(13)+draprn())
         IF(KMUL.EQ.0.AND.PARJ(14).GT.0.) THEN
            IF(draprn().LT.PARJ(14)) KMUL=2
         ELSEIF(KMUL.EQ.1.AND.PARJ(15)+PARJ(16)+PARJ(17).GT.0.) THEN
            RMUL=draprn()
            IF(RMUL.LT.PARJ(15)) KMUL=3
            IF(KMUL.EQ.1.AND.RMUL.LT.PARJ(15)+PARJ(16)) KMUL=4
            IF(KMUL.EQ.1.AND.RMUL.LT.PARJ(15)+PARJ(16)+PARJ(17)) KMUL=
     +      5
         ENDIF
         KFLS=3
         IF(KMUL.EQ.0.OR.KMUL.EQ.3) KFLS=1
         IF(KMUL.EQ.5) KFLS=5
         IF(KFLA.NE.KFLB) THEN
            KF=(100*KFLA+10*KFLB+KFLS)*KFS*(-1)**KFLA
         ELSE
            RMIX=draprn()
            IMIX=2*KFLA+10*KMUL
            IF(KFLA.LE.3) KF=110*(1+INT(RMIX+PARF(IMIX-1))+ INT(RMIX+
     +      PARF(IMIX)))+KFLS
            IF(KFLA.GE.4) KF=110*KFLA+KFLS
         ENDIF
         IF(KMUL.EQ.2.OR.KMUL.EQ.3) KF=KF+ISIGN(10000,KF)
         IF(KMUL.EQ.4) KF=KF+ISIGN(20000,KF)

C...Optional extra suppression of eta and eta' and omega
         IF(KF.EQ.221) THEN
            IF(draprn().GT.PARJ(25)) GOTO 20
         ELSEIF(KF.EQ.331) THEN
            IF(draprn().GT.PARJ(26)) GOTO 20
cGB..
         ElseIf(KF.EQ.113) THEN
c          rho
            IF(draprn().GT.(1.-PARJ(27))) GOTO 20
         ElseIf(KF.EQ.223) THEN
c          omega
            IF(draprn().GT.(1.-PARJ(28))) GOTO 20
cGB..
         ENDIF

C...Generate diquark flavour.
      ELSE
   40    IF(KF1A.LE.10.AND.KF2A.EQ.0) THEN
            KFLA=KF1A
   50       KFLB=1+INT((2.+PAR2*PAR3)*draprn())
            KFLC=1+INT((2.+PAR2*PAR3)*draprn())
            KFLDS=1
            IF(KFLB.GE.KFLC) KFLDS=3
            IF(KFLDS.EQ.1.AND.PAR4*draprn().GT.1.) GOTO 50
            IF(KFLDS.EQ.3.AND.PAR4.LT.draprn()) GOTO 50
            KFL3=ISIGN(1000*MAX(KFLB,KFLC)+100*MIN(KFLB,KFLC)+KFLDS,
     +      KFL1)

C...Take diquark flavour from input.
         ELSEIF(KF1A.LE.10) THEN
            KFLA=KF1A
            KFLB=MOD(KF2A/1000,10)
            KFLC=MOD(KF2A/100,10)
            KFLDS=MOD(KF2A,10)

C...Generate (or take from input) quark to go with diquark.
         ELSE
            IF(KF2A.EQ.0) KFL3=ISIGN(1+INT((2.+PAR2)*draprn()),KFL1)
            KFLA=KF2A+IABS(KFL3)
            KFLB=MOD(KF1A/1000,10)
            KFLC=MOD(KF1A/100,10)
            KFLDS=MOD(KF1A,10)
         ENDIF

C...SU(6) factors for formation of baryon. Try again if fails.
         KBARY=KFLDS
         IF(KFLDS.EQ.3.AND.KFLB.NE.KFLC) KBARY=5
         IF(KFLA.NE.KFLB.AND.KFLA.NE.KFLC) KBARY=KBARY+1
         WT=PARF(60+KBARY)+PARJ(18)*PARF(70+KBARY)
         IF(MBARY.EQ.1.AND.MSTJ(12).GE.2) THEN
            WTDQ=PARS0
            IF(MAX(KFLB,KFLC).EQ.3) WTDQ=PARS1
            IF(MIN(KFLB,KFLC).EQ.3) WTDQ=PARS2
            IF(KFLDS.EQ.1) WTDQ=WTDQ/(3.*PAR4M)
            IF(KFLDS.EQ.1) WT=WT*(1.+WTDQ)/(1.+PARSM/(3.*PAR4M))
            IF(KFLDS.EQ.3) WT=WT*(1.+WTDQ)/(1.+PARSM)
         ENDIF
         IF(KF2A.EQ.0.AND.WT.LT.draprn()) GOTO 40

C...Form baryon. Distinguish Lambda- and Sigmalike baryons.
         KFLD=MAX(KFLA,KFLB,KFLC)
         KFLF=MIN(KFLA,KFLB,KFLC)
         KFLE=KFLA+KFLB+KFLC-KFLD-KFLF
         KFLS=2
         IF((PARF(60+KBARY)+PARJ(18)*PARF(70+KBARY))*draprn().GT. PARF(60
     +   +KBARY)) KFLS=4
         KFLL=0
         IF(KFLS.EQ.2.AND.KFLD.GT.KFLE.AND.KFLE.GT.KFLF) THEN
            IF(KFLDS.EQ.1.AND.KFLA.EQ.KFLD) KFLL=1
            IF(KFLDS.EQ.1.AND.KFLA.NE.KFLD) KFLL=INT(0.25+draprn())
            IF(KFLDS.EQ.3.AND.KFLA.NE.KFLD) KFLL=INT(0.75+draprn())
         ENDIF
         IF(KFLL.EQ.0) KF=ISIGN(1000*KFLD+100*KFLE+10*KFLF+KFLS,KFL1)
         IF(KFLL.EQ.1) KF=ISIGN(1000*KFLD+100*KFLF+10*KFLE+KFLS,KFL1)
      ENDIF
      RETURN

C...Use tabulated probabilities to select new flavour and hadron.
   60 IF(KTAB2.EQ.0.AND.MSTJ(12).LE.0) THEN
         KT3L=1
         KT3U=6
      ELSEIF(KTAB2.EQ.0.AND.KTAB1.GE.7.AND.MSTJ(12).LE.1) THEN
         KT3L=1
         KT3U=6
      ELSEIF(KTAB2.EQ.0) THEN
         KT3L=1
         KT3U=22
      ELSE
         KT3L=KTAB2
         KT3U=KTAB2
      ENDIF
      RFL=0.
      DO 80  KTS=0,2
         DO 70 KT3=KT3L,KT3U
            RFL=RFL+PARF(120+80*KTAB1+25*KTS+KT3)
   70    CONTINUE
   80 CONTINUE
      RFL=draprn()*RFL
      DO 100 KTS=0,2
         KTABS=KTS
         DO 90 KT3=KT3L,KT3U
            KTAB3=KT3
            RFL=RFL-PARF(120+80*KTAB1+25*KTS+KT3)
            IF(RFL.LE.0.) GOTO 110
   90    CONTINUE
  100 CONTINUE
  110 CONTINUE

C...Reconstruct flavour of produced quark/diquark.
      IF(KTAB3.LE.6) THEN
         KFL3A=KTAB3
         KFL3B=0
         KFL3=ISIGN(KFL3A,KFL1*(2*KTAB1-13))
      ELSE
         KFL3A=1
         IF(KTAB3.GE.8) KFL3A=2
         IF(KTAB3.GE.11) KFL3A=3
         IF(KTAB3.GE.16) KFL3A=4
         KFL3B=(KTAB3-6-KFL3A*(KFL3A-2))/2
         KFL3=1000*KFL3A+100*KFL3B+1
         IF(KFL3A.EQ.KFL3B.OR.KTAB3.NE.6+KFL3A*(KFL3A-2)+2*KFL3B) KFL3=
     +   KFL3+2
         KFL3=ISIGN(KFL3,KFL1*(13-2*KTAB1))
      ENDIF

C...Reconstruct meson code.
      IF(KFL3A.EQ.KFL1A.AND.KFL3B.EQ.KFL1B.AND.(KFL3A.LE.3.OR.
     +KFL3B.NE.0)) THEN
         RFL=draprn()*(PARF(143+80*KTAB1+25*KTABS)+PARF(144+80*KTAB1+
     +   25*KTABS)+PARF(145+80*KTAB1+25*KTABS))
         KF=110+2*KTABS+1
         IF(RFL.GT.PARF(143+80*KTAB1+25*KTABS)) KF=220+2*KTABS+1
         IF(RFL.GT.PARF(143+80*KTAB1+25*KTABS)+PARF(144+80*KTAB1+
     +   25*KTABS)) KF=330+2*KTABS+1
      ELSEIF(KTAB1.LE.6.AND.KTAB3.LE.6) THEN
         KFLA=MAX(KTAB1,KTAB3)
         KFLB=MIN(KTAB1,KTAB3)
         KFS=ISIGN(1,KFL1)
         IF(KFLA.NE.KF1A) KFS=-KFS
         KF=(100*KFLA+10*KFLB+2*KTABS+1)*KFS*(-1)**KFLA
      ELSEIF(KTAB1.GE.7.AND.KTAB3.GE.7) THEN
         KFS=ISIGN(1,KFL1)
         IF(KFL1A.EQ.KFL3A) THEN
            KFLA=MAX(KFL1B,KFL3B)
            KFLB=MIN(KFL1B,KFL3B)
            IF(KFLA.NE.KFL1B) KFS=-KFS
         ELSEIF(KFL1A.EQ.KFL3B) THEN
            KFLA=KFL3A
            KFLB=KFL1B
            KFS=-KFS
         ELSEIF(KFL1B.EQ.KFL3A) THEN
            KFLA=KFL1A
            KFLB=KFL3B
         ELSEIF(KFL1B.EQ.KFL3B) THEN
            KFLA=MAX(KFL1A,KFL3A)
            KFLB=MIN(KFL1A,KFL3A)
            IF(KFLA.NE.KFL1A) KFS=-KFS
         ELSE
            CALL LUERRM(2,'(LUKFDI:) no matching flavours for qq -> '
     +      //'qq')
            GOTO 10
         ENDIF
         KF=(100*KFLA+10*KFLB+2*KTABS+1)*KFS*(-1)**KFLA

C...Reconstruct baryon code.
      ELSE
         IF(KTAB1.GE.7) THEN
            KFLA=KFL3A
            KFLB=KFL1A
            KFLC=KFL1B
         ELSE
            KFLA=KFL1A
            KFLB=KFL3A
            KFLC=KFL3B
         ENDIF
         KFLD=MAX(KFLA,KFLB,KFLC)
         KFLF=MIN(KFLA,KFLB,KFLC)
         KFLE=KFLA+KFLB+KFLC-KFLD-KFLF
         IF(KTABS.EQ.0) KF=ISIGN(1000*KFLD+100*KFLF+10*KFLE+2,KFL1)
         IF(KTABS.GE.1) KF=ISIGN(1000*KFLD+100*KFLE+10*KFLF+2*KTABS,
     +   KFL1)
      ENDIF

C...Check that constructed flavour code is an allowed one.
      IF(KFL2.NE.0) KFL3=0
      KC=LUCOMP(KF)
      IF(KC.EQ.0) THEN
         CALL LUERRM(2,'(LUKFDI:) user-defined flavour probabilities '/
     +   / 'failed')
         GOTO 10
      ENDIF

      RETURN
      END
*CMZ :  2.08/05 10/03/2000  11.32.27  by  Hannes Jung
*CMZ :  2.08/04 22/12/99  15.39.25  by  Hannes Jung
*CMZ :  2.08/02 12/08/99  16.34.55  by  Hannes Jung
*CMZ :  2.08/01 22/06/99  16.58.44  by  Hannes Jung
*CMZ :          02/06/99  12.39.58  by  Hannes Jung
*CMZ :  2.07/03 16/05/99  09.27.29  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94


      SUBROUTINE PARTDF(X,WPART)
      IMPLICIT NONE
*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGSTRU.
      REAL SCAL1,XPD1,SCAL2,XPD2
      COMMON/STRU/ SCAL1,XPD1,SCAL2,XPD2
C     SAVE
*KEEP,RGFULL.
      INTEGER IFULL,IQCDGRID
      COMMON /OALPINI/ IFULL,IQCDGRID
*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEEP,RGRAHER.
      REAL XPQDIF,XPQPI
	Integer IHERPYS
	Integer NBQ2,NBX
      PARAMETER (NBQ2=20)
      PARAMETER (NBX=20)
      COMMON /RAHER/ IHERPYS,XPQDIF(-6:6,NBX,NBQ2),XPQPI(-6:6,NBX,NBQ2)
*KEND.
      Double Precision PHI
      COMMON/DIFFA/ PHI
      Double Precision draprn
      DOUBLE PRECISION ME,MP
      Double Precision XY,X,WPART,WEIGHT
      COMMON/XVAR/ XY(10)
      DOUBLE PRECISION STHETA,SPHI
      DIMENSION X(20)
      Integer IJOIN,NJOIN
      DIMENSION IJOIN(10)
      REAL XPQ(-6:6)
      REAL F2CC(-6:6),XF3CC(-6:6)
      Integer NDIMC
      COMMON /DIMEN/ NDIMC
      Integer IMIX
      Double Precision WMAX
      COMMON /OALPHAS/ WMAX,IMIX
      Integer NDIM,NPOIN
      COMMON/DIVO/ NDIM,NPOIN
      Integer LST,IRES
      COMMON/EPPARA/LST(30),IRES(2)
      Integer IVM
      COMMON/VMESON/IVM
      Integer IGENFL
      COMMON/GENWEI/IGENFL
      Integer NTHRE,NVMRE
      COMMON/HERTHET/ NTHRE,NVMRE
      Integer IDEBUG
      COMMON/ INTERN/IDEBUG
      EXTERNAL draprn
      Double Precision QF,QFT,XR12,SMALL,ALPH_EM,GF,DOT
      Integer INRNCH,ICHECK,NFLAVP,LUCHGE,NACC
      Double Precision  WT,W02,W12,YX,SMIN,XP2Q,XG1,XP1MIN,QG2
      Double Precision  XP2,SHAT1,XMCHECK,PIO,FGAM,FWEI,FLUX
      Double Precision THETE,ECM,PT2,PT,WTG15
      Double Precision XP,XR,XX,VMAX,VMIN,XMAXV,XMINV,XMINHF
      Double Precision T2,T2MIN,T2MN,T2MAX1,XR1,WTDIST,WTD12
      Double Precision COSTP,PHIP,PHIO,SPHP,CPHP,BOCHCK
      Double Precision PEP,PEG,PEGZ,POMDGA,PEZ,EN,PZC,WMAT,XPINT
      Double Precision SPOM,WTGLU,tdraprn,XP1
      Double Precision xmax1
      Integer I,J,IN,KI,MSTJ24,NP,NPP,NDFF,KPA2,KPAT,KPFL,KPAO,KPAO2
      Integer NDIMEN,NRN,IST,NPFIN,NB2,nafl,KPF
      DATA QF/0.0D0/,W12/0.0D0/,NFLAVP/0/,XR12/-999./
      DATA SMALL/1.D-3/
      DATA ICHECK/0/
      Data INRNCH/0/
c      IDEBUG = 1
      SCAL1 = -99999.
      XPD1 = -99999.
      SCAL2 = -99999.
      XPD2 = -99999.
      MSTJ24 = MSTJ(24)
      MSTJ(24) = 0
      DO 10  IN=1,20
         K(IN,1) = 0
         K(IN,2) = 0
   10 CONTINUE

C...  GIVE BEAM  FOUR VECTORS
      DO 20 I=1,2
         DO 20 J=1,5
            K(I,J)=KBEAM(I,J)
   20 P(I,J) = PBEAM(I,J)
      ME =P(1,5)
      MP =P(2,5)
      NP=2
      NPP=3*NP
      N=2
      QF = 0.D0
      NFLAVP = 0
      NDFF = 0


      IF(IPRO.EQ.10.OR.IPRO.EQ.12.OR.IPRO.EQ.13.OR.
     +   IPRO.EQ.15.OR.IPRO.EQ.18) THEN
         AM(1) = 0.0D0
         AM(2) = 0.0D0
         IF(IHFLA.GE.4.AND.IPRO.EQ.18) THEN
            KPA=IHFLA
            AM(1) = DBLE(ULMASS(KPA))
            AM(2) = DBLE(ULMASS(KPA))
         ENDIF
         IF(IPRO.EQ.12.OR.IPRO.EQ.15) THEN
            NFLAVP = NFLAV
            IF(NPOM.EQ.2.AND.NG.EQ.11) THEN
c this is for DL pomeron and DL parton density
               NFLAVP=3
            ENDIF
         ENDIF
      ELSEIF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
         IF(IWEI.EQ.0) THEN
            KPA = 4
            IF(IHFLA.GE.4) KPA=IHFLA
         ELSEIF(IWEI.EQ.1) THEN
         ENDIF
         AM(1) = DBLE(ULMASS(KPA))
         AM(2) = DBLE(ULMASS(KPA))

      ELSEIF(IPRO.EQ.100) THEN
         AM(1)=1.D0
         AM(2)=2.D0*DBLE(ULMASS(211))

ccc            KPA = 213
      ELSE
         WRITE(6,*) 'wrong subprocess selected: IPRO = ',IPRO
         WRITE(6,*) '**** PROGRAM STOP ****'
         STOP
      ENDIF
C.. HERE THE LIMITS ON Y( PHOTON ENERGY) AND Q**2 ARE CALCULATED
C... ACCORDING TO PROCEEDINGS OF HERA WORKSHOP 1987
C... ALI ET AL
      IF(IPRO.EQ.14.AND.IMIX.EQ.1) THEN
      ELSE
         W02=(AM(1)+AM(2)+MP)**2
         IF(IPRO.EQ.12) W02=(AM(1)+MP)**2
         IF(AM(1).LT.1.0D0) W02=(1.D0 + MP)**2
         W12=W02-MP*MP
         YMAX=SSS+W12+DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
         YMAX=YMAX/(2.D0*(SSS+ME*ME))
         YMIN=SSS+W12-DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
         YMIN=YMIN/(2.D0*(SSS+ME*ME))
         IF(YMI.GT.YMIN) YMIN=YMI
         IF(YMA.LT.YMAX) YMAX=YMA
      ENDIF
c         WRITE(6,10000) YMIN,YMAX
c 10000 FORMAT(' limits on y ',/,' YMIN = ',E10.5,' YMAX = ',E10.5)

C ... select particle code for light flavour production according
C ... to charges
      IF(IPRO.EQ.10.OR.IPRO.EQ.13.OR.IPRO.EQ.18) THEN
         IF(IHFLA.GE.4.AND.IPRO.EQ.18) THEN
            IF(IWEI.EQ.0) THEN
               KPA=4
               IF(IHFLA.GE.4) KPA=IHFLA
            ELSEIF(IWEI.EQ.1) THEN
               IF(draprn().GT.0.5) KPA = -KPA
            ENDIF
            KPA2 = - KPA

         ELSEIF(INTER.LT.2) THEN
            QF=DFLOAT(LUCHGE(1))**2 + DFLOAT(LUCHGE(2))**2 + DFLOAT(
     +      LUCHGE(3))**2
            QF = 2.D0*QF
            KPA = -4
            QFT = - draprn()*QF
   30       KPA=KPA+1
            QFT = QFT + DBLE(LUCHGE(KPA))**2
            IF(QFT.LT.0.0D0) GOTO 30
            IF(KPA.GT.3) write(6,*) 'fatal light quark = charm!!!!!! ',
     +      KPA
            KPA2 = - KPA
         ELSEIF(INTER.EQ.2) THEN
            KPAT = 2

            IF(draprn().GT.0.5) THEN
               KPA = -ISIGN(1,K(1,2))*IABS(KPAT)
               KPA2 = ISIGN(1,K(1,2))*(IABS(KPAT)-1)
            ELSE
               KPA = ISIGN(1,K(1,2))*(IABS(KPAT)-1)
               KPA2 = -ISIGN(1,K(1,2))*IABS(KPAT)
            ENDIF
         ENDIF
      ELSEIF(IPRO.EQ.14) THEN
         IF(IWEI.EQ.0) THEN
            KPA = 4
            IF(IHFLA.GE.4) KPA=IHFLA
         ELSEIF(IWEI.EQ.1) THEN
         ENDIF
         KPFL = IABS(KPA)
         KPA2=-KPA
         IF(INTER.EQ.2) THEN
            KPA = -ISIGN(1,K(1,2))*KPFL
            KPA2 = ISIGN(1,K(1,2))*(KPFL-1)
            IF(draprn().LT.0.5) THEN
               KPA = ISIGN(1,K(1,2))*(KPFL-1)
               KPA2 = -ISIGN(1,K(1,2))*KPFL
            ENDIF
         ENDIF
         AM(1)=DBLE(ULMASS(KPA))
         AM(2)=DBLE(ULMASS(KPA2))
      ELSEIF(IPRO.EQ.12.OR.IPRO.EQ.15) THEN
         NFLAVP = NFLAV
         KPA = 1
      ENDIF
      IF(IGENFL.EQ.0) THEN
         KPAO = KPA
         KPAO2 = KPA2
c          write(6,*) '0th',kpa,kpa2
      ELSEIF(IGENFL.EQ.1) THEN
         KPA = KPAO
         KPA2 = KPAO2
c         write(6,*) '1st',kpa,kpa2
         IF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
            AM(1)=DBLE(ULMASS(KPA))
            AM(2)=DBLE(ULMASS(KPA2))
         ENDIF
      ENDIF
c         IF(IDEBUG.EQ.1) write(6,*) 'partdf KPA = ',KPA
      IF(IPRO.EQ.100) THEN
         AM(1)=1.D0
         AM(2)=2.D0*DBLE(ULMASS(211))
c         write(6,*) ' am ',am(1),am(2)
      ENDIF
c      write(6,*) ' ULMASS ',ULMASS(113),ULMASS(211)
C... YX IS THE PHOTON ENERGY
C... Q2 FROM PHOTON
C... XP2 IS XGLUON ( MOMENTUM FRACTION OF THE GLUON)
C... XMIN = MIN XGLUON TO PRODUCE THE INV. MASS OF GAMMA GLUON SYSTEM
C... XMAX=1.
CCC
C... GENERATE YX,Q2,XP2 ACCORDING TO 1/X SPECTRUM
C... FGAM IS THE WEIGHT OF EPA
      NDIMEN = NDIM
      IF(IDISDIF.GE.1) NDIMEN=NDIM+2
      NRN = 0
      XMAX=1.d0-XF
      IF(IRES(1).EQ.0) THEN
c.......
         IF(KE.NE.22) THEN
            NRN = NRN + 1
            YX = YMIN*((YMAX/YMIN)**X(NRN))
            IF(YX.GT.YMAX.OR.YX.LT.YMIN) GOTO 260
            Q2MIN=ME*ME*YX*YX/(1.D0-YX)
            IF(QMI.GT.Q2MIN) Q2MIN = QMI
            Q2MAX=YX*SSS - W12
            IF(QMA.LT.Q2MAX) Q2MAX = QMA
            IF(Q2MAX.LT.Q2MIN) GOTO 270
            NRN = NRN + 1
            IF(QMI.EQ.0.D0) THEN
               Q2 = Q2MIN*((Q2MAX/Q2MIN)**X(NRN))
            ELSE
c new try weighting with 1/q**4
               Q2 = Q2MIN*Q2MAX/(X(NRN)*Q2MIN + Q2MAX*(1.D0 - X(NRN)))
            ENDIF
c            write(6,*) 'PARTDF: Q2MIN,Q2MAX,Q2 ',Q2MIN,Q2MAX,Q2
            IF(INRNCH.EQ.1) Then
               write(6,*) ' after y,q2: nrn = ',nrn
            endif
            XMIN = 0.0D0
            XP2Q=Q2/YX/SSS
            IF(IPRO.NE.12) THEN
               SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
               IF(IPRO.EQ.100) SMIN = 2.D0*(AM(1)**2+AM(2)**2)
               XMIN=(SMIN+Q2)/(YX*SSS)
               IF(IMIX.EQ.1.AND.IWEI.EQ.1) THEN
                  XMIN = DMAX1(XP2Q,XMIN)
cnew
                  XMAX = XR12
cnew
               ENDIF
            ELSE
               XMIN=Q2/YX/SSS
            ENDIF
         ELSEIF(KE.EQ.22) THEN
            Q2 = 1.D0
            YX = 1.D0
            SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
            IF(IPRO.EQ.100) SMIN = 2.D0*(AM(1)**2+AM(2)**2)
            XMIN=SMIN/(YX*SSS)
         ELSE
            write(6,*) ' wrong KF selected; program stop '
            YX = 0.D0
         ENDIF
         XG1=YX
      ELSEIF(IRES(1).EQ.1) THEN
C XG1 = E_gluon/E_electron
C YX  = E_photon/E_electron
C XP1 = E_gluon/E_photon
         NRN = NRN + 1
         YX = YMIN*((YMAX/YMIN)**X(NRN))
         NRN = NRN + 1
         XP1MIN =DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
     +           /YX/SSS
         XP1 = XP1MIN*(1.D0/XP1MIN)**X(NRN)
         XG1 = XP1*YX
         Q2MIN = ME*ME*YX*YX/(1.D0 - YX)
         IF(QMI.GT.Q2MIN) Q2MIN = QMI
         Q2MAX=YX*(SSS-MP**2) - W12
         IF(QMA.LT.Q2MAX) Q2MAX = QMA
         IF(Q2MAX.LT.Q2MIN) GOTO 270
         NRN = NRN + 1
         IF(QMI.EQ.0.D0) THEN
            Q2 = Q2MIN*((Q2MAX/Q2MIN)**X(NRN))
         ELSE
c new try weighting with 1/q**4
            Q2 = Q2MIN*Q2MAX/(X(NRN)*Q2MIN + Q2MAX*(1.D0 - X(NRN)))
         ENDIF
c         write(6,*) ' partdf yx =',yx,' xel = ',xg1
         XMIN = 0.0D0
         XP2Q=Q2/XG1/SSS
         QG2 = 0.D0
         IF(IPRO.NE.12) THEN
            SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
            XMIN=(SMIN+Q2+QG2)/(XG1*SSS)
c         write(6,*) yx,xg1,xp1,smin,q2,xmin
            IF(IMIX.EQ.1.AND.IWEI.EQ.1) THEN
               XMIN = DMAX1(XMIN,Q2/YX/SSS)
c                    XMAX = XR12
            ENDIF
         ELSE
            XMIN=Q2/YX/SSS
         ENDIF
      ELSE
         YX = 0.D0
         XG1 = 0.D0
      ENDIF
C ... XP2 = E_glue /E_proton
C ... XX  = E_glue/E_pomeron = xg_pom
C ... XR  = E_pomeron/E_proton = x_pom
      IF(IPRO.NE.12.AND.IMIX.EQ.0) THEN
         NRN = NRN + 1
         XP2= XMIN*((XMAX/XMIN)**X(NRN))
c       write(6,*) ' partdf xp2,xmin,xmax',xp2,xmin,xmax
      ELSEIF(IPRO.NE.12.AND.IMIX.EQ.1.AND.IWEI.EQ.1) THEN
         XP2= XMIN*((XMAX/XMIN)**X(NDIMEN+3))
         IF(ICHECK.EQ.1)  THEN
            write(6,*) 'partdf x(ndimen+3),ndimen,xp2,xmax,xmin '
     +      ,x(ndimen+3),ndimen,xp2,xmax,xmin
         ENDIF
      ELSEIF(IPRO.EQ.12.OR.IPRO.EQ.100) THEN
         XP2 = Q2/YX/SSS
      ELSE
         XP2 = 0.D0
      ENDIF
      IF(INRNCH.EQ.1) Then
         write(6,*) ' after xp2: nrn = ',nrn
      endif

c check for w range
c      ww = dsqrt(-q2 + yx*sss)
c      if(ww.lt.50.or.ww.gt.220) goto 456



      IF(SNGL(XP2).GT.SNGL(XMAX).OR.SNGL(XP2).LT.SNGL(XMIN)) GOTO 290
      SHAT1=SSS*XG1*XP2
      XMCHECK = DMAX1((AM(1)+AM(2))**2,DBLE(ULMASS(113)))
      IF(IPRO.EQ.12) XMCHECK = AM(1)
      IF(SHAT1.LT.XMCHECK) GOTO 300
      ENTRY PARTDFHS(X,WPART)
      IF(IHERAC.EQ.1) THEN
c test
         MSTJ24 = MSTJ(24)
         MSTJ(24) = 0
         DO 40    IN=1,20
            K(IN,1) = 0
            K(IN,2) = 0
   40    CONTINUE

C...  GIVE BEAM  FOUR VECTORS
         DO 50   I=1,2
            DO 50   J=1,5
               K(I,J)=KBEAM(I,J)
   50    P(I,J) = PBEAM(I,J)
         ME =P(1,5)
         MP =P(2,5)
         NP=2
         NPP=3*NP
         N=2
         NFLAVP = NFLAV
         NRN = 2
         MP =P(2,5)
         XMAX= 1.d0 -XF
         IST = 0
         YX = YHS
         XP2 = XHS
         Q2 = Q2HS
c        write(6,*) '1st partdf IPRO,IHFLA,KPA',IPRO,IHFLA,KPA,IGENFL
         IF(IPRO.EQ.12.OR.IPRO.EQ.15) THEN
            KPA = KPAHS
         ENDIF
         XG1 = YX
         NDIMEN = NDIM
C ... select particle code for light flavour production according
C ... to charges
         IF(IPRO.EQ.10.OR.IPRO.EQ.13) THEN
            AM(1) = 0.0D0
            AM(2) = 0.0D0
            IF(INTER.LT.2) THEN
               QF=DFLOAT(LUCHGE(1))**2 + DFLOAT(LUCHGE(2))**2 +
     +         DFLOAT( LUCHGE(3))**2
               QF = 2.D0*QF
               KPA = -4
               QFT = - draprn()*QF
   60          KPA=KPA+1
               QFT = QFT + DBLE(LUCHGE(KPA))**2
               IF(QFT.LT.0.0D0) GOTO 60
               IF(KPA.GT.3) write(6,*) 'fatal light quark = charm!!!!!!'
     +         //' ', KPA
               KPA2 = - KPA
            ELSEIF(INTER.EQ.2) THEN
               KPAT = 2
               IF(draprn().GT.0.5) THEN
                  KPA = -ISIGN(1,K(1,2))*IABS(KPAT)
                  KPA2 = ISIGN(1,K(1,2))*(IABS(KPAT)-1)

               ELSE
                  KPA = ISIGN(1,K(1,2))*(IABS(KPAT)-1)
                  KPA2 = -ISIGN(1,K(1,2))*IABS(KPAT)
               ENDIF
            ENDIF
         ENDIF
         IF(IPRO.EQ.14) THEN
            IF(IWEI.EQ.0) THEN
               KPA=4
               IF(IHFLA.GE.4) KPA=IHFLA
               KPA2=-KPA
            ELSEIF(IWEI.EQ.1) THEN
               IF(draprn().GT.0.5) KPA = -KPA
               KPA2 = -KPA
            ENDIF
            KPFL = IABS(KPA)
            IF(INTER.EQ.2) THEN
               KPA = -ISIGN(1,K(1,2))*KPFL
               KPA2 = ISIGN(1,K(1,2))*(KPFL-1)
               IF(draprn().LT.0.5) THEN
                  KPA = ISIGN(1,K(1,2))*(KPFL-1)
                  KPA2 = -ISIGN(1,K(1,2))*KPFL
               ENDIF
            ENDIF
            AM(1)=DBLE(ULMASS(KPA))
            AM(2)=DBLE(ULMASS(KPA2))
            IF(AM(1).LT.1.D-6) AM(1)=0.0D0
            IF(AM(2).LT.1.D-6) AM(2)=0.0D0
         ENDIF
c         IF(IDEBUG.EQ.1) write(6,*) 'partdf KPA = ',KPA
c         IF(IPRO.EQ.14) write(6,*) ' 2 partdf ',KPA,AM(1)
c         write(6,*) 'parths ',Q2
c         write(6,*) 'PARTDF SSS ',SSS
C.. HERE THE LIMITS ON Y( PHOTON ENERGY) AND Q**2 ARE CALCULATED
C... ACCORDING TO PROCEEDINGS OF HERA WORKSHOP 1987
C... ALI ET AL
         IF(IPRO.EQ.14.AND.IMIX.EQ.1) THEN
         ELSE
            W02=(1.D0 + MP)**2
            W12=W02-MP*MP
            YMAX=SSS+W12+DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
            YMAX=YMAX/(2.D0*(SSS+ME*ME))
            YMIN=SSS+W12-DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
            YMIN=YMIN/(2.D0*(SSS+ME*ME))
c         write(6,*) ' YX,YHS,YMIN,YMAX ',YX,YHS,ymin,ymax
            IF(YMI.GT.YMIN) YMIN=YMI
            IF(YMA.LT.YMAX) YMAX=YMA
c         IF(YX.GT.YMAX.OR.YX.LT.YMIN) GOTO 260
         ENDIF
         IF(IGENFL.EQ.0) THEN
            KPAO = KPA
            KPAO2 = KPA2
         ELSE
            KPA=KPAO
            KPA2 = KPAO2
         ENDIF

         Q2MIN=ME*ME*YX*YX/(1.D0-YX)
         IF(QMI.GT.Q2MIN) Q2MIN = QMI
         Q2MAX=YX*SSS - W12
         IF(QMA.LT.Q2MAX) Q2MAX = QMA
         IF(Q2MAX.LT.Q2MIN) GOTO 270
         XP2Q=Q2/YX/SSS
         IF(IPRO.NE.12) THEN
            SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
            IF(IPRO.EQ.100) SMIN = 2.D0*(AM(1)**2+AM(2)**2)
            XMIN=(SMIN+Q2)/(YX*SSS)
            IF(IMIX.EQ.1.AND.IWEI.EQ.1) THEN
               XMIN = DMAX1(XP2Q,XMIN)
               XMAX = XR12
               NDIMEN = NDIM + 3
               XP2= XMIN*((XMAX/XMIN)**X(NDIMEN+3))
c               write(6,*) 'partdf x',x
c               write(6,*) 'partdf: xp2 ',x(ndimen+3),ndimen
            ENDIF
         ENDIF
c         write(6,*) ' PARTDHS: KPA,AM',KPA,AM(1),AM(2)
c         write(6,*) ' here in heracl partdf ',IHERAC
         IF(XP2.GT.XMAX) GOTO 280
c        write(6,*) '2nd partdf IPRO,IHFLA,KPA',IPRO,IHFLA,KPA,IGENFL

      ENDIF

      IST = 0
      YY=SNGL(YX)
      XEL=SNGL(XG1)
      XPR=SNGL(XP2)
      PHI = 99999.D0
      IF(IPRO.EQ.15) NFLAVP = NFLQCDC
      IF((IPRO.EQ.13.OR.IPRO.EQ.14.OR.IPRO.EQ.15.OR.IPRO.EQ.18)
     +  .AND.IMIX.EQ.0) THEN
         NRN=NRN+1
         PHI = 2.D0*PI*X(NRN)
         IF(ICHECK.EQ.1)  THEN
            write(6,*) 'partdf  phi random nrn,x(nrn),phi',nrn,x(nrn),
     +      phi
         ENDIF

      ELSEIF((IPRO.EQ.13.OR.IPRO.EQ.14.OR.IPRO.EQ.15.OR.IPRO.EQ.18)
     +  .AND.IMIX.EQ.1.
     +        AND.IWEI.EQ.1) THEN
         PHI = 2.D0*PI*X(NDIMEN+4)
         IF(ICHECK.EQ.1)  THEN
            write(6,*) 'partdf  phi imix/iwei ndimen,x(ndimen+4),phi',
     +      ndimen,x(ndimen+4),phi
         ENDIF
c         write(6,*) 'partdf phi',x(ndimen+4),ndimen
      ELSEIF(IHERAC.EQ.0) THEN
         IF(IGENFL.EQ.0) THEN
            PHI = 2.D0*PI*draprn()
            PIO = PHI
         ELSEIF(IGENFL.EQ.1) THEN
            PHI = PIO
         ENDIF
         IF(ICHECK.EQ.1)  THEN
            write(6,*) 'partdf  phi herac phi,pio',phi,pio
         ENDIF

      ENDIF
      IF(INRNCH.EQ.1) Then
         write(6,*) ' after phi: nrn = ',nrn
      endif

      IF(IRES(1).EQ.0) THEN
         CALL PARTI(KE,YX,FGAM,FWEI,1,IST)
      ELSEIF(IRES(1).EQ.1) THEN
         CALL PARTI(KE,YX,FGAM,WEIGHT,1,IST)
c factor xg1/yx cancelled because parton densities of photon taken
c xgx instead of g(x)
         FWEI =  DLOG(1.D0/XP1MIN) * WEIGHT
c       write(6,*) ' partdf fwei ',fwei
      ELSE
         WRITE(6,*) ' IRES(1) > 1 not implemented '
         FGAM = 0.D0
         FWEI = 0.D0
      ENDIF

c         write(6,*) 'parths Q2_gen,dot ',Q2,dot1(NIA1,NIA1)
c      write(6,*) ' partdf: iherpys',iherpys
      XP=0.D0
      XX=0.D0
      XR=0.D0
      IRES(2) = 1
C here do some gymnastics to make cut on theta angle of electron
      IF(THEMA.LT.180.D0.OR.THEMI.GE.0.D0) THEN
C go first to ep LAB system
         CALL DUDBRB(3,3,0.D0,0.D0,CM(1)/CM(4),CM(2)/CM(4),CM(3)/CM(4))
         THETE = DPLU(3,14)
         CALL DUDBRB(3,3,0.D0,0.D0,-CM(1)/CM(4),
     +                -CM(2)/CM(4),-CM(3)/CM(4))
c         CALL DULIST(1)
         IF(THETE .GT. 180.01D0) THEN
            WRITE(6,*) ' FATAL: theta_electron > 180 deg ',THETE
         ENDIF
         IF(THETE .GE. THEMA) GOTO 310
         IF(THETE .LE. THEMI) GOTO 310
      ENDIF
C end of these gymnastics

      IF(IPRO.EQ.10.OR.IPRO.EQ.11.OR.IPRO.EQ.12.OR.IPRO.EQ.13.
     +   OR.IPRO.EQ.14.OR.IPRO.EQ.15.OR.IPRO.EQ.18.OR.IPRO.EQ.100) THEN
         IF(IPRO.NE.100) THEN
            NRN = NRN + 1
            IF(IVM.EQ.0) THEN
               XR = XP2*(XMAX/XP2)**X(NRN)
            ELSE
               IF(IVM.GE.1.AND.IVM.LT.443) THEN
                  VMAX = DBLE(1.020 + 2.*ULMASS(211))
                  VMIN = DBLE(0.780 - 2.*ULMASS(211))
               ELSEIF(IVM.EQ.443) THEN
                  VMAX = 2.D0*DBLE(ULMASS(421))
                  VMIN = 2.D0*DBLE(ULMASS(4))
               ELSEIF(IVM.EQ.553) THEN
                  VMAX = 2.D0*DBLE(ULMASS(521))
                  VMIN = 2.D0*DBLE(ULMASS(5))
               ENDIF
               VMIN = VMIN+SMALL
               VMAX = VMAX-SMALL
c                  write(6,*) 'partdf 1:',XMAXV,XMINV
               XMAXV = XP2*(1 + VMAX**2/Q2)
               XMINV = XP2*(1 + VMIN**2/Q2)
c                  write(6,*) 'partdf 2:',XMAXV,XMINV
               XR = XMINV*(XMAXV/XMINV)**X(NRN)
               IF(XMAXV.GT.XMAX) GOTO 290
            ENDIF
            IF(IHF.EQ.1.and.ipro.eq.12) THEN
               XMINHF = XP2*(1.d0 + 4.d0*DBLE(ULMASS(4))**2/Q2)
               IF(XMINHF.GT.XMAX) GOTO 290
               XR = XMINHF*(XMAX/XMINHF)**X(NRN)
            ENDIF
c          write(6,*) ' PARTDF: XR,X(NRN),NRN ',XR,X(NRN),NRN

            IF(IMIX.EQ.1.AND.IPRO.EQ.12.AND.IWEI.EQ.1) THEN
               XR12=XR
            ELSEIF(IMIX.EQ.1.AND.IPRO.NE.12.AND.IWEI.EQ.1) THEN
               XR=XR12
            ENDIF
c      IF(IWEI.EQ.1) THEN
c           write(6,*) ' PARTDF: XR,X(NRN),NRN ',XR,X(NRN),NRN
c           ENDIF
cnew
c            IF(XP2.GT.XR) THEN
c          write(6,*) ' partdf xp2 > xr ',xp2,xr
c          goto 345
c          endif
cnew
            IF((XP2/XR).LT.1.D-20) GOTO 320
            XX = XP2/XR
c            IF(XX.GT.1.0.OR.XX.LT.0.0)
c     +      write(6,*) 'PARTDF xx,xpr,xr',xx,xpr,xr
            IF(ICHECK.EQ.1) THEN
               write(6,*) 'partdf XX,xr,xp2,x(NRN) ',xx,xr,xp2,x(NRN)
            ENDIF
c         IF(XX.GT.0.9999) THEN
c         write(6,*) 'XX>.9999 ',xx,xr,xp2,x(NRN)
c         ENDIF
         ELSEIF(IPRO.EQ.100) THEN
            XR=XP2
            NDFF=4
         ENDIF
         IF(INRNCH.EQ.1) Then
            write(6,*) ' after x_pom: nrn = ',nrn
         endif

         T2MIN=MP*MP*XR*XR/(1.D0-XR)
c         T2MN = -(Q2  - XR*YX*SSS  + 4.D0*DBLE(ULMASS(211))**2)
         T2MN = -(Q2  - XR*XG1*SSS  + 4.D0*DBLE(ULMASS(211))**2)
c         write(6,*) 'partdf : t2mn,t2min,t2max',t2mn,t2min,t2max
         IF(T2MN.LT.T2MAX) THEN
            T2MAX1 = T2MN
         ELSE
            T2MAX1 = T2MAX
         ENDIF

         NDFF = 6
      ELSE
         WRITE(6,*) ' no t_min, t_max calculated '
         T2MIN = 0.D0
         NDFF = 0
      ENDIF
      IF(T2MIN.GE.T2MAX1) THEN
CCC            WRITE(6,*) 'T2MIN=',T2MIN,'.GT.T2MAX1=',T2MAX1
         GOTO 330
      ENDIF
      NRN = NRN + 1
      T2 = T2MIN * ((T2MAX1/T2MIN)**X(NRN))
      IF(ICHECK.EQ.1) THEN
         write(6,*) ' PARTDF: T2,X(NRN),NRN ',T2,X(NRN),NRN
      ENDIF

c      IF(IWEI.EQ.1) THEN
c          write(6,*) ' PARTDF: T2,X(NRN),NRN ',T2,X(NRN),NRN
c          ENDIF
      XR1= T2/XR/SSS
      T2=-T2
      T2GKI = SNGL(T2)
      XFGKI = SNGL(XR)
      IF(INRNCH.EQ.1) Then
         write(6,*) ' after t: nrn = ',nrn
      endif

      CALL RAT2DI(KINT(2,2),XR,T2,WTDIST)
C weight for t distribution
      WTDIST = WTDIST * (-T2) *DLOG(T2MAX1/T2MIN)
      IF(IPRO.NE.100) THEN
         IF(IVM.EQ.0.AND.IHF.EQ.0) THEN
            WTDIST=WTDIST*XR*DLOG((1.D0 - XF)/XP2)
         ELSEIF(IVM.EQ.0.AND.IHF.EQ.1.and.ipro.eq.12) THEN
            WTDIST=WTDIST*XR*DLOG(XMAX/XMINHF)
         ELSEIF(IVM.EQ.0.AND.IHF.EQ.1.and.ipro.ne.12) THEN
            WTDIST=WTDIST*XR*DLOG((1.D0 - XF)/XP2)
         ELSEIF(IVM.GE.1) THEN
            WTDIST=WTDIST*XR*DLOG(XMAXV/XMINV)
         ENDIF
      ELSE
         WTDIST=WTDIST*XR*DLOG(XMAX/XMIN)
      ENDIF
      IF(IMIX.EQ.1.AND.IPRO.EQ.12.AND.IWEI.EQ.1) THEN
         WTD12=WTDIST
         IF(ICHECK.EQ.1)  THEN
            write(6,*) 'partdf wtdist 1st ',wtdist,wtd12
         ENDIF

      ELSEIF(IMIX.EQ.1.AND.IPRO.NE.12.AND.IWEI.EQ.1) THEN
         WTDIST=WTD12
         IF(ICHECK.EQ.1)  THEN
            write(6,*) 'partdf wtdist 2nd ',wtdist,wtd12
         ENDIF

      ENDIF
C end weight for t distribution
      IF(DABS(WTDIST).LE.1.D-45) GOTO 340
      COSTP=(1.D0 - XR - XR1*XR)/(1.D0 - XR + XR1*XR)
      IF(COSTP.GT.1.D0) COSTP=1.0D0
      IF(COSTP.LT.-1.D0) COSTP=-1.0D0
C...  COSTP IS SCATTERING ANGLE OF PROTON
      IF(IDISDIF.EQ.0.OR.IMIX.EQ.0) THEN
         NRN = NRN + 1
         PHIP=2.D0*PI*X(NRN)
	   IF(IHERAC.EQ.1) PHIP=2.D0*PI*draprn()
      ELSE
         PHIP=2.D0*PI*draprn()
      ENDIF
      IF(IGENFL.EQ.0) THEN
         PHIO = PHIP
      ELSEIF(IGENFL.EQ.1) THEN
         PHIP = PHIO
      ENDIF
      IF(INRNCH.EQ.1) Then
         write(6,*) ' after phip: nrn = ',nrn
      endif

c      PHIP = 0.D0
c      IF(IDEBUG.EQ.1) write(6,*) 'partdf: PHIP=',PHIP
      SPHP=DSIN(PHIP)
      CPHP=DCOS(PHIP)

C FINAL STATE PROTON
      NPFIN=NIA1+NDFF
      N=NPFIN
      K(NPFIN,1)=1
      K(NPFIN,2)=KP
      IF(IABS(KINT(2,2)).EQ.211) K(NPFIN,2) = 2112
      K(NPFIN,3)=2
      P(NPFIN,5)=DBLE(ULMASS(K(NPFIN,2)))
C NEW gymnastics because of numerical precision problems.....

c for construction of  pomeron goto gamma p system
      DBCMS(1)=  P(NIA1,1) + P(2,1)
      DBCMS(2)=  P(NIA1,2) + P(2,2)
      DBCMS(3)=  P(NIA1,3) + P(2,3)
      DBCMS(4)=  P(NIA1,4) + P(2,4)
      BOCHCK = (DBCMS(1)/DBCMS(4))**2 + (DBCMS(2)/DBCMS(4))**2
     +              + (DBCMS(3)/DBCMS(4))**2
      BOCHCK = DSQRT(BOCHCK)
      IF(BOCHCK.GT.0.99999999D0) goto 360

      CALL DUDBRB(0,0,0.D0,0.D0,
     +  -DBCMS(1)/DBCMS(4),-DBCMS(2)/DBCMS(4),
     +  -DBCMS(3)/DBCMS(4))
      SPHI = DLANGL(P(NIA1,1),P(NIA1,2))
      CALL DUDBRB(0,0,0.D0,-sphi,0.d0,0.d0,0.d0)
      STHETA = DLANGL(P(NIA1,3),P(NIA1,1))
      CALL DUDBRB(0,0,-STHETA,0.D0,0.d0,0.d0,0.d0)
c new
      PEP = DSQRT(P(2,3)**2 + DBLE(ULMASS(KP)**2))
      P(2,4) = PEP
      PEZ = ABS(P(2,3))
      PEG = P(NIA1,4)
      PEGZ = DABS(P(NIA1,3))
cres      POMDGA = XR * YX * SSS/2.D0
      POMDGA = XR * XG1 * SSS/2.D0
      EN= PEZ*(PEGZ*PEZ+PEG*PEP)/(PEZ*PEG+PEP*PEGZ) - ((T2-P(2,5)**2-
     +P(NPFIN,5)**2)*PEGZ/2.D0 + POMDGA*PEZ)/(PEZ*PEG+PEP*PEGZ)
      P(NPFIN,4) = EN
      PZC =       - (PEP*(PEGZ*PEZ+PEG*PEP)/(PEZ*PEG+PEP*PEGZ) +
     +             ((T2-P(2,5)**2-P(NPFIN,5)**2)*PEG/2.D0
     +             - POMDGA*PEP)/(PEZ*PEG+PEP*PEGZ))
      P(NPFIN,3) = PZC
      PT = (-(T2-P(NPFIN,5)**2)*(PEGZ*PEZ+PEG*PEP)**2 + (T2-P(2,5)**2-
     +P(NPFIN,5)**2)**2*Q2/4.D0 -P(NPFIN,5)**2*POMDGA**2 +(T2+P(2,5)**
     +2-P(NPFIN,5)**2)*POMDGA *(PEGZ*PEZ+PEG*PEP) )/(PEZ*PEG+PEGZ*PEP)*
     +*2 - P(2,5)**2
      P(NPFIN,1) = DSQRT(DMAX1(0.D0,PT))*CPHP
      P(NPFIN,2) = DSQRT(DMAX1(0.D0,PT))*SPHP
      CALL DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
      CALL DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
      CALL DUDBRB(0,0,0.D0,0.D0,
     +  DBCMS(1)/DBCMS(4),DBCMS(2)/DBCMS(4),
     +  DBCMS(3)/DBCMS(4))
c end new

C end of these gymnastics

C MOMENTA OF POMERON
      K(NIA1+1,1)=21
      K(NIA1+1,2)=KINT(2,2)
      K(NIA1+1,3)=2
      DO 70  KI=1,4
         P(NIA1+1,KI)=P(2,KI)-P(NPFIN,KI)
   70 CONTINUE
      P(NIA1+1,5)=-sqrt(ABS(DOT1(NIA1+1,NIA1+1)))
      T2GKI=-SNGL(P(NIA1+1,5)**2)
c      IF(IDEBUG.EQ.1) THEN
c         write(6,*) ' PARTDF: T2GKI,T2 ',T2GKI,T2
c         write(6,*) ' partdf: yx=',yx,dot1(nia1,2)/dot1(1,2)
c         write(6,*) ' partdf: xr=',xr,dot1(nia1,nia1+1)/dot1(nia1,2)
c      ENDIF
c for construction of parton in pomeron goto gamma pomeron system

      DBCMS(1)=  P(NIA1,1) + P(NIA1+1,1)
      DBCMS(2)=  P(NIA1,2) + P(NIA1+1,2)
      DBCMS(3)=  P(NIA1,3) + P(NIA1+1,3)
      DBCMS(4)=  P(NIA1,4) + P(NIA1+1,4)
      spom = dot(dbcms,dbcms)
c      IF(IWEI.EQ.1) write(6,*) ' PARTDF: SPOM= ',spom
      IF(SPOM.LT.0.0D0) GOTO 380
      BOCHCK = (DBCMS(1)/DBCMS(4))**2 + (DBCMS(2)/DBCMS(4))**2
     +              + (DBCMS(3)/DBCMS(4))**2
      BOCHCK = DSQRT(BOCHCK)
      IF(BOCHCK.GT.0.99999999D0) goto 360

      CALL DUDBRB(NIA1,NIA1+4,0.D0,0.D0,
     +  -DBCMS(1)/DBCMS(4),-DBCMS(2)/DBCMS(4),
     +  -DBCMS(3)/DBCMS(4))
      SPHI = DLANGL(P(NIA1,1),P(NIA1,2))
      CALL DUDBRB(NIA1,NIA1+4,0.D0,-sphi,0.d0,0.d0,0.d0)
      STHETA = DLANGL(P(NIA1,3),P(NIA1,1))
      CALL DUDBRB(NIA1,NIA1+4,-STHETA,0.d0,0.d0,0.d0,0.d0)
c      write(6,*) ' now in parton pom system partdf NIA1 ',NIA1
c      CALL DULIST(1)
      IF(IPRO.EQ.100) THEN
         NIA2= NIA1+1
         NF1=NIA1+2
         NF2=NIA1+3
         K(NF1,1)=1
         K(NF1,2)=KPA
         K(NF1,3)=NIA1
         K(NF2,1)=1
         K(NF2,2)=KINT(2,2)
         K(NF2,2)=83
         K(NF2,3)=NIA1
         NJOIN=0
         NB2 = NIA1 + 1
      ELSE
         K(NIA1+2,1)=21
         K(NIA1+2,2)=KGL
         K(NIA1+2,3)=NIA1+1
         IF(IPRO.NE.12) THEN
c            IF(Q2.LE.2) THEN
            IF(IRES(1).EQ.1) THEN
               P(NIA1+2,3) = XX*P(NIA1+1,3)
               P(NIA1+2,4) = DABS(P(NIA1+2,3))
            ELSE
               IF(Q2.LE.2.D0) THEN
                  P(NIA1+2,4)= XX*(P(NIA1+1,4)*P(NIA1,4)+ ABS(P(NIA1+1,
     +            3)* P(NIA1,3)) + DBLE(T2GKI)) /(P(NIA1,4)+ABS(P(NIA1,
     +            3)))
                  P(NIA1+2,3)= -P(NIA1+2,4)
               ELSE
                  P(NIA1+2,4)= -XX*(P(NIA1+1,4)*P(NIA1,4)+ ABS(P(NIA1+
     +            1,3) * P(NIA1,3)) + DBLE(T2GKI))*(P(NIA1,4)-P(NIA1,3)
     +            )/Q2
                  P(NIA1+2,3)= -P(NIA1+2,4)
               ENDIF
            ENDIF
c            write(6,*) 'construct NIA1+2: P,Q2,XX ',P(NIA1+2,4),Q2,XX
c            write(6,*) 'NIA1  ',NIA1

         ELSE
            DO 80 I=-6,6
   80       XPQ(I) = 0.0

            Q2Q = Q2
            IF(XX.LT.0.999D0)
     +      CALL RASTFU(KINT(2,2),SNGL(XX),SNGL(Q2Q),XPQ)
            IF(XX.GE.1.D0) THEN
               write(6,*) ' partdf: XX',XX
               write(6,*) ' X(I) ',X
            ENDIF
c            if(xpr.ne.xx*xfgki) write(6,*) xpr,xfgki*xx,xfgki,xx
c            if(iwei.eq.1) call HF1(301,sngl(xx),1.)
c            if(iwei.eq.1) write(6,*) 'partdf: beta = ',xx
C... WTGLU IS THE WEIGHT FOR XGLUON GENERATION
            WTGLU = 0.D0
c           write(6,*) ' partdf: NFLAV ',NFLAVP,XPQ
            nafl =0
            DO 90  I=1,NFLAVP
               IF(INTER.LT.2) THEN
                  IF(SPOM.LT.(4.*ULMASS(I)**2)) GOTO 90
               ELSEIF(INTER.EQ.2) THEN
                  IF(I.GE.(NFLAVP+1)) GOTO 90
                  IF(SPOM.LT.((ULMASS(I)+ULMASS(I+1))**2)) GOTO 90
               ENDIF
               IF(XPQ(I).LE.0.) GOTO 90
               NAFL = I
   90       CONTINUE
            IF(INTER.LT.2) THEN
               DO 100 I=-NAFL,NAFL
  100          WTGLU =WTGLU+DBLE(XPQ(I))*DFLOAT(LUCHGE(I))**2/9.D0
               IF(WTGLU.LT.1.D-20) GOTO 350
               IF(IGENFL.EQ.1) THEN
                  KPA = KPAO
                  WTGLU = DBLE(XPQ(KPA))*DFLOAT(LUCHGE(KPA))**2/9.D0
                  KPF = KPA
               ELSE
  110             tdraprn =  draprn()
                  QFT = - tdraprn*WTGLU
                  KPA=-NAFL-1
  120             KPA=KPA+1
                  QFT = QFT + DBLE(LUCHGE(KPA))**2/9.D0*DBLE(XPQ(KPA))
                  IF(QFT.LT.0.0D0) GOTO 120
                  KPF = KPA
               ENDIF
               if(wtglu.le.0) then
                  write(6,*) ' wtglu < 0 '
                  write(6,*) 'check 1 ',nafl,wtglu,kpa,xpq,xx,q2q,
     +            igenfl
                  CALL RASTFU(KINT(2,2),SNGL(XX),SNGL(Q2Q),XPQ)
                  write(6,*) 'check 2 ',nafl,wtglu,kpa,xpq
               endif
               if(iabs(kpa).gt.nafl) then
                  write(6,*) 'partdf kpa,nafl',kpa,nafl
                  write(6,*) ' partdf wtglu = ',wtglu,tdraprn
                  write(6,*) ' partdf xpq ',xpq
                  write(6,*) ' luchge(0) ',luchge(0),igenfl
               endif
               IF(IVM.GT.0) THEN
                  IF(IVM.GE.1.AND.IVM.LT.443) THEN
                     VMAX = DBLE(1.020 + 2.*ULMASS(211))
                     VMIN = DBLE(0.780 - 2.*ULMASS(211))
                  ELSEIF(IVM.EQ.443) THEN
                     VMAX = 2.D0*DBLE(ULMASS(421))
                     VMIN = 2.D0*DBLE(ULMASS(4))
                     KPA = 4
                     WTGLU = 2.D0*DBLE(XPQ(4))*DFLOAT(LUCHGE(4))**2/
     +               9.D0
                  ELSEIF(IVM.EQ.553) THEN
                     VMAX = 2.D0*DBLE(ULMASS(521))
                     VMIN = 2.D0*DBLE(ULMASS(5))
                     KPA = 5
                     WTGLU = 2.D0*DBLE(XPQ(5))*DFLOAT(LUCHGE(5))**2/
     +               9.D0
                  ENDIF
                  VMIN = VMIN+SMALL
                  VMAX = VMAX-SMALL
                  KPF = KPA
c                  write(6,*) 'partdf spom =',spom,vmin,vmax
                  IF(SNGL(SPOM).LT.VMIN**2.OR.SPOM.GT.VMAX**2) GOTO
     +            440
               ENDIF
            ELSEIF(INTER.EQ.2) THEN
c            write(6,*) ISIGN(1,K(1,2))
               DO 130 I=-6,6
                  F2CC(I) = 0.0
  130          XF3CC(I) = 0.0
               DO 140 I=1,NAFL-1,2
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     F2CC(I+1) = 2.*XPQ(I+1)
                     F2CC(-I) = 2.*XPQ(-I)
                     XF3CC(I+1) = 2.*XPQ(I+1)
                     XF3CC(-I) = -2.*XPQ(-I)
                     WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)*
     +               DBLE(F2CC(-I)+F2CC(I+1)) + (YX - YX**2/2.D0)*
     +               DBLE(XF3CC(-I)+XF3CC(I+1))
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     F2CC(I) = 2.*XPQ(I)
                     F2CC(-I-1) = 2.*XPQ(-I-1)
                     XF3CC(I) = 2.*XPQ(I)
                     XF3CC(-I-1) = -2.*XPQ(-I-1)
                     WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)*
     +               DBLE(F2CC(I)+F2CC(-I-1)) - (YX - YX**2/2.D0)*
     +               DBLE(XF3CC(I)+XF3CC(-I-1))
                  ENDIF
  140          CONTINUE
               IF(IGENFL.EQ.1) THEN
                  KPA = KPAO
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)*
     +               DBLE(F2CC(KPA)) + (YX - YX**2/2.D0)*
     +               DBLE(XF3CC(KPA))
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)*
     +               DBLE(F2CC(KPA)) - (YX - YX**2/2.D0)*
     +               DBLE(XF3CC(KPA))
                  ENDIF
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     KPF = (KPA - 1)
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     KPF = (KPA + 1)
                  ENDIF
               ELSE
                  QFT = - draprn()*WTGLU
                  KPA=-NFLAVP-1
  150             KPA=KPA+1
                  IF(KPA.EQ.0) GOTO 150
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     QFT = QFT + (1.D0 - YX + YX**2/2.D0)*
     +               DBLE(F2CC(KPA)) + (YX - YX**2/2.D0)*
     +               DBLE(XF3CC(KPA))
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     QFT = QFT + (1.D0 - YX + YX**2/2.D0)*
     +               DBLE(F2CC(KPA)) - (YX - YX**2/2.D0)*
     +               DBLE(XF3CC(KPA))
                  ENDIF

                  IF(QFT.LT.0.0D0) GOTO 150
c                  write(6,*) KPA, QFT
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     KPF = (KPA - 1)
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     KPF = (KPA + 1)
                  ENDIF
               ENDIF
            ELSE
               WRITE(6,*) ' wrong interaction INTER = ',INTER
            ENDIF
            K(NIA1+2,2) = KPA
            SCAL2 = SNGL(Q2Q)
            XPD2 = XPQ(KPA)
            IF(Q2.LE.2) THEN
               P(NIA1+2,3)= -(DBLE(ULMASS(KPF))**2+Q2)
     +          /(P(NIA1,4)+P(NIA1,3))/2.D0
c               P(NIA1+2,3)= -(Q2)/(P(NIA1,4)+P(NIA1,3))/
c     +         2.
               P(NIA1+2,4)= ABS(P(NIA1+2,3))
            ELSE
               P(NIA1+2,3)= (DBLE(ULMASS(KPF))**2+Q2)
     +           *(P(NIA1,4)-P(NIA1,3))/Q2/2.D0
c               P(NIA1+2,3)= (Q2) *(P(NIA1,4)-P(NIA1,3))/
c     +         Q2/2.
               P(NIA1+2,4)= ABS(P(NIA1+2,3))
            ENDIF
         ENDIF
         P(NIA1+2,1)= 0.0D0
         P(NIA1+2,2)= 0.0D0
         P(NIA1+2,5)= DOT1(NIA1+2,NIA1+2)
         IF(P(NIA1+2,5).LT.0)
     + P(NIA1+2,5)=-DSQRT(DMAX1(0.D0,P(NIA1+2,5)))
         IF(P(NIA1+2,5).GE.0)
     + P(NIA1+2,5)= DSQRT(DMAX1(0.D0,P(NIA1+2,5)))
         NIA2 = NIA1+2

         IF(IPRO.NE.12) THEN
            NF1=NIA1+3
            NF2=NIA1+5
            K(NF1,1)=2
            K(NF1,2)=KPA
            K(NF1,3)=NIA1
            K(NF2,1)=1
            K(NF2,2)=KPA2
            K(NF2,3)=NIA1
            IF(IPRO.EQ.15) THEN
               K(NF1,2)=KPF
               K(NF2,2) = 21

            ENDIF
            IJOIN(1)=NF1
            IF(IPRO.NE.15) THEN
               IJOIN(2)=NF1+1
               IJOIN(3)=NF2
            ELSE
               IJOIN(2) = NF2
               IJOIN(3) = NF1+1
            ENDIF
            NJOIN=3
C POMERON Remnant
            K(NF1+1,1)=2
            K(NF1+1,2)=KGL
            IF(IPRO.EQ.15) THEN
               K(NF1+1,2) = -KPA
            ENDIF
            K(NF1+1,3)=NIA1+1
            P(NF1+1,1)=P(NIA1+1,1) - P(NIA1+2,1)
            P(NF1+1,2)=P(NIA1+1,2) - P(NIA1+2,2)
            P(NF1+1,3)=P(NIA1+1,3) - P(NIA1+2,3)
            P(NF1+1,4)=P(NIA1+1,4) - P(NIA1+2,4)
            P(NF1+1,5)=DBLE(ULMASS(K(NF1+1,2)))
            P(NF1+1,5)= DOT1(NF1+1,NF1+1)
            IF(P(NF1+1,5).LT.0)
     +      P(NF1+1,5)=-DSQRT(DMAX1(0.D0,P(NF1+1,5)))
            IF(P(NF1+1,5).GE.0)
     +      P(NF1+1,5)= DSQRT(DMAX1(0.D0,P(NF1+1,5)))
            P(NF1,5)=AM(1)
            P(NF2,5)=AM(2)
            NB2 = NIA2
C...   VECTOR OF GAMMA GLUON CMS SYSTEM or gamma pomeron system
         ELSEIF(IPRO.EQ.12) THEN

c            P(NIA1+2,5)=ULMASS(KPA)
c            P(NIA1+2,5) = 0.0
c            P(NIA1+2,4)= SQRT(P(NIA1+2,3)**2 + P(NIA1+2,5)**2)
            NF1=NIA1+3
            NF2=NF1+2
            K(NF1,1)=2
            K(NF1,2)=KPF
            K(NF1,3)=NIA1
            K(NF2,1)= 0
            IJOIN(1)=NF1
            IJOIN(2)=NF1+1
            NJOIN=2
            NB2 = NIA1 + 1
c            write(6,*) 'partdf nf1,nia1,nf2',nf1,nia1,nf2
         ELSE
            NB2 = 0
         ENDIF
      ENDIF

      CALL DUDBRB(NIA1,NIA1+4,STHETA,0.D0,0.d0,0.d0,0.d0)
      CALL DUDBRB(NIA1,NIA1+4,0.D0,sphi,0.d0,0.d0,0.d0)
      CALL DUDBRB(NIA1,NIA1+4,0.D0,0.D0,DBCMS(1)/DBCMS(4),
     +  DBCMS(2)/DBCMS(4),DBCMS(3)/DBCMS(4))
      DBCMS(1)=  P(NIA1,1) + P(NB2,1)
      DBCMS(2)=  P(NIA1,2) + P(NB2,2)
      DBCMS(3)=  P(NIA1,3) + P(NB2,3)
      DBCMS(4)=  P(NIA1,4) + P(NB2,4)
      DO 160 I=1,4
         P(NF1,I)=0.0D0
         P(NF2,I)=0.0D0
  160 CONTINUE
c      write(6,*) ' before shat calc: NB2',NB2
c      Call Dulist(1)
      SHAT=DOT(DBCMS,DBCMS)
      IF(SHAT.LE.0.0) THEN
         GOTO 390
      ENDIF

C NOW BOOST TO GAMMA GLUON or gamma pomeron CMS
      BOCHCK = (DBCMS(1)/DBCMS(4))**2 + (DBCMS(2)/DBCMS(4))**2 +
     +(DBCMS(3)/DBCMS(4))**2
      BOCHCK = DSQRT(BOCHCK)
      IF(BOCHCK.GT.0.99999999D0) goto 370
      CALL DUDBRB(0,N,0.D0,0.D0,-DBCMS(1)/DBCMS(4),-DBCMS(2)/DBCMS(4),
     +-DBCMS(3)/DBCMS(4))

      SPHI = DLANGL(P(NIA1,1),P(NIA1,2))
      call DUDBRB(0,0,0.D0,-sphi,0.d0,0.d0,0.d0)
      STHETA = DLANGL(P(NIA1,3),P(NIA1,1))
      call DUDBRB(0,0,-STHETA,0.D0,0.d0,0.d0,0.d0)
      IF(IPRO.EQ.12) THEN
         IF((SHAT-SMALL).LT.4.*ULMASS(211)**2) GOTO 430
         K(NIA2,2)=KPA
         IF((SHAT-SMALL).LT.4.*ULMASS(KPA)**2) GOTO 430
         IF(INTER.EQ.2) THEN
            IF((SHAT-SMALL).LT.(ULMASS(KPA)+ULMASS(KPF))**2) GOTO 430
         ENDIF
         WTGLU=WTGLU*WTDIST

         IF(SHAT.LE.0) THEN
            DO 170 I=1,4
  170       P(NF1,I) = P(NIA1,I) + P(NIA1+1,I)
            P(NF1,5)=DSQRT(SHAT)
            N=NPFIN
            K(NF1,1)=1
            K(NF1,2)=100*IABS(KPA) + 10*IABS(KPA) + 3
            K(NF1,3)=NIA1
            K(NF1+1,1)=0
         ELSE
            CALL DU2ENT(NF1,KPF,-KPA,SNGL(DSQRT(SHAT)))
c            write(6,*) 'partdf shat,KPA',SHAT,KPA
c            CALL DULIST(1)
            N = NPFIN
            K(NF1,3) = NIA1+1
            K(NF1+1,3) = NIA1 + 1
            K(NF1+1,1) = 1
            K(NF1+1,2) = -KPA
         ENDIF
         CALL DUEDIT(12)
c         IF(IWEI.EQ.1) write(6,*) 'PARTDF: spom,shat',spom,shat
c         DO 190 I=1,4
c  190    P(NIA1+2,I) = P(NF1,I) - P(NIA1,I)
c        CALL DULIST(1)
         NF2 = NF1 + 1
         ALPH_EM = ALPH
         IF(IRUNAEM.EQ.1) ALPH_EM = DBLE(ULALEM(SNGL(Q2)))
         IF(INTER.LT.2) THEN
            WMAT = 2.D0 * ALPH_EM*ALPH_EM*PI/YX/Q2**2
            WMAT = WMAT *(1.D0+(1.D0-YX)**2)
         ELSEIF(INTER.EQ.2) THEN
            GF = PI*ALPH_EM/(SIN2W*XMW2*DSQRT(2.D0))
            WMAT = GF**2/2.D0/PI /(1.D0 + Q2/XMW2)**2 /YX
capply additional factor 0.5 because only right/or left handed electrons contr.
            WMAT = WMAT * 0.5D0
         ENDIF
         WPART = WMAT * WTGLU *FWEI

C BOOST BACK TO OVERALL CMS ( now done in FXN1 )
         call DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
         call DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
         CALL DUDBRB(0,N,0.D0,0.D0,DBCMS(1)/DBCMS(4),DBCMS(2)/DBCMS(4),
     +   DBCMS(3)/DBCMS(4))

         PT2H = 99999.
         SHH = 99999.
C here do gymnastics for IPRO = 100 gamma pomeron --> rho pomeron
      ELSEIF(IPRO.EQ.100) THEN
C NOW  LOOK THAT WE REALLY HAVE ENOUGH ENERGY IN GAMMA GLUON CMS SYSTEM
C...  ECM = CMS ENERGY OF GAMMA GLUON SYSTEM
         ECM =DSQRT(SHAT)
c         write(6,*) ' 100: am(1),am(2) ',am(1),am(2)
c       IF(ECM.LE.(AM(1)+AM(2))) WRITE(6,*) 'ECM LE MASS',ECM,dsqrt(spom)
         IF(ECM.LE.(AM(1)+AM(2))) GOTO 400
c    we set scale to Q2Q = 99999. because it's irrelevant here
         Q2Q = 99999.D0
c here we set WT=1 because in ELERHO the momenta are seperately generated
         WT = 1.D-4
C BOOST BACK TO OVERALL CMS ( now done in FXN1 )
         call DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
         call DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
         WMAT=WT *WTDIST*FGAM*FWEI
         WPART = WMAT
      ELSE
C NOW  LOOK THAT WE REALLY HAVE ENOUGH ENERGY IN GAMMA GLUON CMS SYSTEM
C...  ECM = CMS ENERGY OF GAMMA GLUON SYSTEM
         ECM =DSQRT(SHAT)
         IF(ECM.LE.(AM(1)+AM(2))) GOTO 400
         NRN = NRN + 1
         XY(1) = X(NRN)
         NRN = NRN + 1
         XY(2) = X(NRN)
         IF(INRNCH.EQ.1) Then
            write(6,*) ' after phase: nrn = ',nrn
         endif

c          write(6,*) 'partdf:',x(nrn-1),x(nrn),nrn,ndim,ndimen,ipro
         CALL PHASE(NP,ECM,AM,PCM,WT)
         IF(WT.LE.0.D0) GOTO 410
c         write(6,*) ' PARTDF phase 1sr :',WT,XY(2)*DLOG(1.D0/SIMIN)
c         write(6,*) ' PARTDF phase AM:',am(1),am(2)
         DO 180 I=1,4
            P(NF1,I)=PCM(I,1)
            P(NF2,I)=PCM(I,2)
  180    CONTINUE
         PT2 = DPLU(NF1,9)
         CALL CUTG(PT2,NACC)
c         IF(IDEBUG.EQ.1) write(6,*) 'PARTDF: PT2 = ',PT2
         IF(NACC.EQ.0) GOTO 420

cscale         IF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
cscale            Q2Q = (AM(1)+AM(2))**2
cscale            Q2Q = (AM(1)+AM(2))**2 + Q2
cscale         ELSE
         IF(IQ2.EQ.1) THEN
            Q2Q = (2.D0*AM(1))**2
         ELSEIF(IQ2.EQ.2) THEN
            Q2Q = SHAT
         ELSEIF(IQ2.EQ.3) THEN
            Q2Q = (2.D0*AM(1))**2 + PT2
         ELSEIF(IQ2.EQ.4) THEN
            Q2Q = Q2
         ELSEIF(IQ2.EQ.5) THEN
            Q2Q = Q2 + PT2 + (2.D0*AM(1))**2
         ELSE
            WRITE(6,*) ' NO VALID Q2 SCALE. STOP'
            STOP
         ENDIF
cscale         ENDIF
         IF(IQ2.EQ.5) THEN
            Q2Q=Q2 + PT2*SCALFA + (2.D0*AM(1))**2
         ELSE
            Q2Q=SCALFA*Q2Q
         ENDIF
c do qcd compton stuff here
         IF(IPRO.EQ.15) THEN
c this should not be here               Q2Q = Q2
            IF(XX.LT.0.999D0) CALL RASTFU(KINT(2,2),SNGL(XX),SNGL(Q2Q),
     +      XPQ)
            IF(XX.GE.1.D0) THEN
c                  write(6,*) ' partdf: XX',XX
c                  write(6,*) ' X(I) ',X
               DO 190 I=-6,6
  190          XPQ(I) = 0.0
            ENDIF
C... WTGLU IS THE WEIGHT FOR XGLUON GENERATION
            DO 200 I=1,NFLAVP
               IF(SPOM.LT.(4.*ULMASS(I)**2)) GOTO 200
               NAFL = I
  200       CONTINUE
            WTGLU = 0.D0
c           write(6,*) ' partdf: NFLAV ',NFLAVP,XPQ
            IF(INTER.LT.2) THEN
               DO 210 I=-NAFL,NAFL
  210          WTGLU =WTGLU+DBLE(XPQ(I))*DFLOAT(LUCHGE(I))**2/9.D0
               IF(WTGLU.LT.1.D-20) GOTO 350
               IF(IGENFL.EQ.1) THEN
                  KPA = KPAO
                  WTGLU = DBLE(XPQ(KPA))*DFLOAT(LUCHGE(KPA))**2/
     +            9.D0
               ELSE
                  QFT = - draprn()*WTGLU
                  KPA=-NAFL-1
  220             KPA=KPA+1
                  QFT = QFT + DBLE(LUCHGE(KPA))**2/9.D0* DBLE(XPQ(KPA))
                  IF(QFT.LT.0.0D0) GOTO 220
               ENDIF
               KPF = KPA
            ELSEIF(INTER.EQ.2) THEN
c            write(6,*) ISIGN(1,K(1,2))
               DO 230 I=-6,6
                  F2CC(I) = 0.0
  230          XF3CC(I) = 0.0
               DO 240 I=1,NAFL-1,2
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     F2CC(I+1) = 2.*XPQ(I+1)
                     F2CC(-I) = 2.*XPQ(-I)
                     XF3CC(I+1) = 2.*XPQ(I+1)
                     XF3CC(-I) = - 2.*XPQ(-I)
                     WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)* DBLE(F2C
     +               C(-I)+F2CC(I+1)) + (YX - YX**2/2.D0)* DBLE(XF3CC(-
     +               I)+XF3CC(I+1))
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     F2CC(I) = 2.*XPQ(I)
                     F2CC(-I-1) = 2.*XPQ(-I-1)
                     XF3CC(I) = 2.*XPQ(I)
                     XF3CC(-I-1) = - 2.*XPQ(-I-1)
                     WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)* DBLE(F2C
     +               C(I)+F2CC(-I-1)) - (YX - YX**2/2.D0)* DBLE(XF3CC(I
     +               )+XF3CC(-I-1))
                  ENDIF
  240          CONTINUE
               IF(IGENFL.EQ.1) THEN
                  KPA = KPAO
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)* DBLE(F2C
     +               C(KPA)) + (YX - YX**2/2.D0)* DBLE(XF3CC(KPA))
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)* DBLE(F2C
     +               C(KPA)) - (YX - YX**2/2.D0)* DBLE(XF3CC(KPA))
                  ENDIF
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     KPF = (KPA - 1)
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     KPF = (KPA + 1)
                  ENDIF
               ELSE
                  QFT = - draprn()*WTGLU
                  KPA=-NFLAVP-1
  250             KPA=KPA+1
                  IF(KPA.EQ.0) GOTO 250
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     QFT = QFT + (1.D0 - YX + YX**2/2.D0)* DBLE(F2CC(KP
     +               A)) + (YX - YX**2/2.D0)* DBLE(XF3CC(KPA))
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     QFT = QFT + (1.D0 - YX + YX**2/2.D0)* DBLE(F2CC(KP
     +               A)) - (YX - YX**2/2.D0)* DBLE(XF3CC(KPA))
                  ENDIF

                  IF(QFT.LT.0.0D0) GOTO 250
c               write(6,*) KPA, QFT
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     KPF = (KPA - 1)
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     KPF = (KPA + 1)
                  ENDIF
               ENDIF
            ELSE
               WRITE(6,*) ' wrong interaction INTER = ',INTER
            ENDIF
            WTG15 = WTGLU
            K(NIA1+2,2) = KPA
            AM(1) = 0.D0
            IF(IABS(KPA).GE.4) AM(1) = DBLE(ULMASS(KPA))
            SCAL2 = SNGL(Q2Q)
            XPD2 = XPQ(KPA)
            K(NF1,2)=KPF
            K(NF2,2) = 21
            IJOIN(1)=NF1
            IJOIN(2) = NF2
            IJOIN(3) = NF1+1
            NJOIN=3
            K(NF1+1,2) = -KPA

         ENDIF
c end qcd compton

C BOOST BACK TO OVERALL CMS ( now done in FXN1 )
         call DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
         call DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
         XPR = SNGL(XP2)
         IF(XX.LT.0.999D0)
     +   CALL RASTFU(KINT(2,2),SNGL(XX),SNGL(Q2Q),XPQ)
C... WTGLU IS THE WEIGHT FOR XGLUON GENERATION
ccccc         write(6,*) ' partdf XPQ ',IPRO,xpq

c for resolved photon move parton densities into ELERES
         IF(IRES(1).EQ.1) THEN
            XP = 1.D0/XX
         ELSE
c            write(6,*) ' partdf ires=0'
c            if(xx.gt.0.999999) write(6,*) ' partdf xx>1. ',xx,xpq(0)
            XP = DBLE(XPQ(0))/XX
         ENDIF
         SCAL2 = SNGL(Q2Q)
         XPD2 = XPQ(0)
         IF(IPRO.EQ.15) THEN
            XP = WTG15/XX
            XPD2 = XPQ(KPA)
         ENDIF
         XPINT=DLOG(XMAX/XMIN)
cnew
c         IF(IMIX.EQ.1.AND.IPRO.NE.12.AND.IWEI.EQ.1) THEN
c         XPINT=DLOG(XR/XMIN)
c        endif
cnew
         WTGLU = XX * XP * XPINT
         WTGLU=WTGLU*WTDIST
         WMAT=WT *WTGLU*FGAM*FWEI
         WMAT=WMAT/((2.D0*PI)**NPP)
C...  FLUX = FLUX USED FOR X-SECTION CALCULATION
         FLUX=(2.D0*PI)**4
         FLUX=FLUX/(2.D0*(SHAT+Q2))
         WPART = WMAT *FLUX
         IF(IPRO.EQ.13.OR.IPRO.EQ.14.OR.IPRO.EQ.15) THEN
            WPART = WTGLU * FWEI * WT
            IF(IPRO.EQ.15) THEN
               WPART = WPART*FLUX/((2.D0*PI)**NPP)
            ENDIF
         ENDIF
         PT2H = SNGL(PT2)
         SHH = SNGL(SHAT)

      ENDIF
      IF(IFPS.NE.10.AND.NPOM.NE.20.AND.NPOM.NE.21.AND.IPRO.NE.100) THEN
c         CALL DULIST(1)
c         IF(IWEI.EQ.1) THEN
c            write(6,*) ' partdf ', kpa,kpa2
c            call dulist(1)
c            endif
         CALL LUJOIN(NJOIN,IJOIN)
c         CALL DULIST(1)
      ENDIF
      NDIMC = NRN
      IF(INRNCH.EQ.1) Then
         write(6,*) ' end: nrn = ',nrn
      endif

      IF(WPART.LT.0.D0) THEN
         WRITE(6,*) ' WPART < 0 '
         WRITE(6,*) ' WMAT = ',WMAT,' WTGLU = ',WTGLU,' FWEI = ',FWEI
         WRITE(6,*) ' WT = ',WT, 'WTDIST = ',WTDIST
         WRITE(6,*) ' NAFL =',nafl,' x = ',xpr,' xpom =',xr,' xx=',xx
      ENDIF
      IF(IGENFL.EQ.0) THEN
         KPAO = KPA
         KPAO2 = KPA2
c         write(6,*) '2nd ', kpa, kpa2
      ELSE
         KPA = KPAO
         KPA2 = KPAO2
c         write(6,*) '3rd ', kpa, kpa2
      ENDIF
c      write(6,*) 'partdf wpart,q2,xp2,yy,ipro',wpart,q2,xp2,q2q,yy,ipro
c         WRITE(6,*) 'partdf igenfl,imix,iwei ',igenfl,imix,iwei
      MSTJ(24) = MSTJ24
c      if(iwei.eq.1)      write(6,*) kpa,kpa2,kpf
c      call lulist(1)
      RETURN
  260 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: ylimit ; RETURN ',yx,ymin,ymax,x(1)
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  270 CONTINUE
      WPART = 0.D0
      IF(IWEI.EQ.1)
     +   write(6,*) ' partdf: Q2limit ; RETURN ',Q2,Q2MIN,Q2MAX
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: Q2limit ; RETURN ',Q2,Q2MIN,Q2MAX
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  280 CONTINUE
      WPART = 0.D0
c      IF(IWEI.EQ.1)
c     +write(6,*) ' partdf: xlimit ; RETURN xmin,xmax',xmin,xmax,IPRO
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: xlimit ; RETURN xmin,xmax',xmin,xmax,
     +   IPRO
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  290 CONTINUE
      WPART = 0.D0
c      write(6,*) ' partdf: xp2 limit ; RETURN ',xp2,xmax,xmin,IPRO
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: xp2 limit ; RETURN ',xp2,xmax,xmin,IPRO
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  300 CONTINUE
      WPART = 0.D0
c      IF(IWEI.EQ.1)
c     +write(6,*) ' partdf: slimit ; RETURN '
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: slimit ; RETURN '
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  310 CONTINUE
      WPART = 0.D0
c      IF(IWEI.EQ.1)
c     +write(6,*) ' partdf: theta limit ; RETURN '
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: theta limit ; RETURN '
      ENDIF
      IF(IHERAC.EQ.1) THEN
         NTHRE = NTHRE +1
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  320 CONTINUE
      WPART = 0.D0
c      write(6,*) ' partdf: xp2/xx limit ; RETURN ',IPRO
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: xp2/xx limit ; RETURN ',IPRO
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  330 CONTINUE
      WPART = 0.D0
c      write(6,*) ' partdf: tlimit ; RETURN '
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: tlimit ; RETURN ',T2,T2MIN,T2MAX1
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  340 CONTINUE
      WPART = 0.D0
c      IF(IWEI.EQ.1)
c     +write(6,*) ' partdf: wtdist limit ; RETURN ',WTDIST
      IF(IDEBUG.EQ.1) THEN
      write(6,*) ' partdf: wtdist limit; RETURN ',WTDIST,t2,T2MIN,T2MAX1
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  350 CONTINUE
      WPART = 0.D0
c      IF(IWEI.EQ.1)
c     +write(6,*) ' partdf: wtglu limit ; RETURN ',WTGLU
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: wtglu limit ; RETURN '
         write(6,*) ' partdf: WTGLU,xpq(4),nafl,nflavp,spom',
     +   WTGLU,xpq(4),nafl,nflavp,spom
         write(6,*) ' partdf: xr,q2,xbj,t2',xr,q2,xp2,t2
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  360 CONTINUE
      WPART = 0.D0

      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: bochck limit,pom ; RETURN ',BOCHCK,NDIM,
     +   NRN
         write(6,*) ' bochk:   P(NIA1,I)',(P(NIA1,I),I=1,4)
         write(6,*) ' bochk: P(NIA1+1,I)',(P(NIA1+1,I),I=1,4)
         write(6,*) ' bochk: DBCMS ',DBCMS
         write(6,*) ' bochk: X ',X
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  370 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: bochck limit, phase ; RETURN '
         write(6,*) ' bochk:   P(NIA1,I)',(P(NIA1,I),I=1,4)
         write(6,*) ' bochk: P(NIA1+1,I)',(P(NIA1+1,I),I=1,4)
         write(6,*) ' bochk: X ',X
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  380 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: spom=',spom,' test =',
     +   (-Q2+xr*yx*sss+t2)
c         write(6,*) ' partdf: nia1,nia1+1 ',nia1,nia1+1
         write(6,*) ' partdf: yx=',yx,dot1(nia1,2)/dot1(1,2)
         write(6,*) ' partdf: xr=',xr,dot1(nia1,nia1+1)/dot1(nia1,2)
         write(6,*) ' partdf: x_bj = ',xpr
c         write(6,*) 'partdf: 2gamma pom ',2*dot1(nia1,nia1+1),
c     +    xr*yx*sss
         write(6,*) ' partdf: Q2 ',Q2,dot1(nia1,nia1)
         write(6,*) ' partdf: T2 ',T2,T2min,T2max1
c         write(6,*) ' partdf:  test',(-Q2+dot1(nia1,nia1+1)/dot1(nia1,2)
c     +    *yx*sss+t2)
c        call lulist(1)
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  390 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: shat ; RETURN :x_bj',xpr,'x_pom',xr
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  400 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: ECM limit ; RETURN ',ECM,AM(1),AM(2)
         write(6,*) ' partdf: ecm_min ',dsqrt(-q2+xmin*yx*sss),xmin
      ENDIF
      MSTJ(24) = MSTJ24
      NDIMC = 9999
      RETURN
  410 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: PHASE wt=0 ; RETURN '
      ENDIF
      MSTJ(24) = MSTJ24
      NDIMC = 9999
      RETURN

  420 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: PTCUT limit ;RETURN ',PT2,PT2CUT(IPRO),
     +   IPRO
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  430 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) '350 partdf: shat;RETURN ',shat,ulmass(211),
     +   ulmass(kpa),nflav,nflavp
         write(6,*) '350 partdf: shat ; RETURN :x_bj',xpr,'x_pom',xr
         write(6,*) '350 partdf: shat,spom',shat,spom,kpa,ipro
      endif
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  440 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdf: VM_mass check ',IVM,SPOM,VMIN**2,VMAX**2
      ENDIF
      IF(IHERAC.EQ.1) THEN
         NVMRE = NVMRE +1
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  450 CONTINUE
      WPART = -1.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: xp2 > xr ',xp2,xr
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.25  by  Hannes Jung
*CMZ :  2.08/01 23/06/99  08.14.58  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  16.20.12  by  Hannes Jung
*CMZ :  2.07/03 16/05/99  09.40.42  by  Hannes Jung
*-- Author :    Hannes Jung   12/01/95
      SUBROUTINE PARTDI(X,WPART)
      IMPLICIT NONE
*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGSTRU.
      REAL SCAL1,XPD1,SCAL2,XPD2
      COMMON/STRU/ SCAL1,XPD1,SCAL2,XPD2
C     SAVE
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      Double Precision PHI
      COMMON/DIFFA/ PHI
      Double Precision draprn
      DOUBLE PRECISION ME,MP
	Double Precision X,XY,WPART,WEIGHT
      COMMON/XVAR/ XY(10)
      DOUBLE PRECISION STHETA,SPHI
      DIMENSION X(20)
      REAL XPQ(-6:6)
      REAL F2CC(-6:6),XF3CC(-6:6)
	Double Precision WMAX
	Integer NDIMC,IMIX,IDEBUG,NDIM,NPOIN,LST,IRES,NTHRE,NVMRE,IGENFL
      COMMON /DIMEN/ NDIMC
      COMMON /OALPHAS/ WMAX,IMIX
      COMMON/ INTERN/IDEBUG
      COMMON/DIVO/ NDIM,NPOIN
      COMMON/EPPARA/LST(30),IRES(2)
      COMMON/HERTHET/ NTHRE,NVMRE
      COMMON/GENWEI/IGENFL
      DOUBLE PRECISION QG2
      COMMON/SEMIH/ QG2
      REAL SNGL
      EXTERNAL draprn
	Double Precision QF,QFT,ALPH_EM,GF,DOT,WTGLU
	Integer NFLAVP,LUCHGE,NACC
	Double Precision  WT,W02,W12,YX,SMIN,XP2Q,XG1,XP1MIN
	Double Precision QG2MAX,QG2MIN,QG20,XZOHRN,WQG2
	Double Precision  XP2,SHAT1,PIO,FGAM,FWEI,FLUX
	Double Precision THETE,ECM,PT2,WTG15,XP1,PR,t,at
	Double Precision SPHP,CPHP,STHP,CTHP,BOCHCK
	Double Precision WMAT,XPINT,XP
	Integer I,J,IN,KI,NP,NPP,KPA2,KPAT,KPFL,KPAO,KPAO2
	Integer NDIMEN,NRN,IST,NPFIN,NB2,KPF,KFLCH,KFLSP
	
	
      DATA QF/0.0D0/,W12/0.0D0/
      NDIMEN = NDIM
c      IDEBUG=1
c      write(6,*) ' in partdi ',x
      SCAL1 = -99999.
      XPD1 = -99999.
      SCAL2 = -99999.
      XPD2 = -99999.
      DO 10  IN=1,20
         K(IN,1) = 0
         K(IN,2) = 0
   10 CONTINUE

C...  GIVE BEAM  FOUR VECTORS
      DO 20 I=1,2
         DO 20 J=1,5
            K(I,J)=KBEAM(I,J)
   20 P(I,J) = PBEAM(I,J)
      ME =P(1,5)
      MP =P(2,5)
      NP=2
      NPP=3*NP
      N=2

      QF = 0.D0
      NFLAVP = 0

      IF(IPRO.EQ.10.OR.IPRO.EQ.12.OR.IPRO.EQ.13.
     +OR.IPRO.EQ.15.OR.IPRO.EQ.18) THEN
         AM(1) = 0.0D0
         AM(2) = 0.0D0
         IF(IHFLA.GE.4.AND.IPRO.EQ.18) THEN
            KPA=IHFLA
            AM(1) = DBLE(ULMASS(KPA))
            AM(2) = DBLE(ULMASS(KPA))
         ENDIF
      ELSEIF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
         IF(IWEI.EQ.0) THEN
            KPA = 4
            IF(IHFLA.GE.4) KPA=IHFLA
         ELSEIF(IWEI.EQ.1) THEN
         ENDIF
         AM(1) = DBLE(ULMASS(KPA))
         AM(2) = DBLE(ULMASS(KPA))
      ELSE
         WRITE(6,*) 'wrong subprocess selected: IPRO = ',IPRO
         WRITE(6,*) '**** PROGRAM STOP ****'
         STOP
      ENDIF
      IF(IPRO.EQ.14.AND.IMIX.EQ.1) THEN
      ELSE
C.. HERE THE LIMITS ON Y( PHOTON ENERGY) AND Q**2 ARE CALCULATED
C... ACCORDING TO PROCEEDINGS OF HERA WORKSHOP 1987
C... ALI ET AL
         W02=(AM(1)+AM(2)+MP)**2
         IF(IPRO.EQ.12) W02=(AM(1)+MP)**2
         IF(AM(1).LT.1.0D0) W02=(1.D0 + MP)**2
         IF(AM(1).LT.1.0D0.and.pt2cut(ipro).ne.0.)
     +     W02=(DSQRT(PT2CUT(IPRO)) + MP)**2
         W12=W02-MP*MP
         YMAX=SSS+W12+DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
         YMAX=YMAX/(2.D0*(SSS+ME*ME))
         YMIN=SSS+W12-DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
         YMIN=YMIN/(2.D0*(SSS+ME*ME))
         IF(YMI.GT.YMIN) YMIN=YMI
         IF(YMA.LT.YMAX) YMAX=YMA
      ENDIF
c         write(6,*) w02
c         WRITE(6,10500) YMIN,YMAX
c10500 FORMAT(' limits on y ',/,
c     +' YMIN = ',E10.5,' YMAX = ',E10.5)

C ... select particle code for light flavour production according
C ... to charges
      IF(IPRO.EQ.10.OR.IPRO.EQ.13.OR.IPRO.EQ.18) THEN
         IF(IHFLA.GE.4.AND.IPRO.EQ.18) THEN
            IF(IWEI.EQ.0) THEN
               KPA=4
               IF(IHFLA.GE.4) KPA=IHFLA
            ELSEIF(IWEI.EQ.1) THEN
               IF(draprn().GT.0.5) KPA = -KPA
            ENDIF
         ELSEIF(INTER.LT.2) THEN
            QF=DFLOAT(LUCHGE(1))**2 + DFLOAT(LUCHGE(2))**2 + DFLOAT(
     +      LUCHGE(3))**2
            QF = 2.D0*QF
            KPA = -4
            QFT = - draprn()*QF
   30       KPA=KPA+1
            QFT = QFT + DBLE(LUCHGE(KPA))**2
            IF(QFT.LT.0.0D0) GOTO 30
            IF(KPA.GT.3) write(6,*) 'fatal light quark = charm!!!!!! ',
     +      KPA
            KPA2 = - KPA
         ELSEIF(INTER.EQ.2) THEN
            KPAT = 2
            IF(draprn().GT.0.5) THEN
               KPA = -ISIGN(1,K(1,2))*IABS(KPAT)
               KPA2 = ISIGN(1,K(1,2))*(IABS(KPAT)-1)
            ELSE
               KPA = ISIGN(1,K(1,2))*(IABS(KPAT)-1)
               KPA2 = -ISIGN(1,K(1,2))*IABS(KPAT)
            ENDIF
         ENDIF
      ELSEIF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
         IF(IWEI.EQ.0) THEN
            KPA=4
            IF(IHFLA.GE.4) KPA=IHFLA
         ELSEIF(IWEI.EQ.1) THEN
            IF(draprn().GT.0.5) KPA = -KPA
         ENDIF
         KPFL = IABS(KPA)
         KPA2=-KPA
         IF(INTER.EQ.2) THEN
            KPA = -ISIGN(1,K(1,2))*KPFL
            KPA2 = ISIGN(1,K(1,2))*(KPFL-1)
            IF(draprn().LT.0.5) THEN
               KPA = ISIGN(1,K(1,2))*(KPFL-1)
               KPA2 = -ISIGN(1,K(1,2))*KPFL
            ENDIF
         ENDIF
         AM(1)=DBLE(ULMASS(KPA))
         AM(2)=DBLE(ULMASS(KPA2))
      ELSEIF(IPRO.EQ.12.OR.IPRO.EQ.15) THEN
         NFLAVP = NFLAV
         KPA = 1
      ENDIF
      IF(IGENFL.EQ.0) THEN
         KPAO = KPA
         KPAO2 = KPA2
      ELSEIF(IGENFL.EQ.1) THEN
         KPA = KPAO
         KPA2 = KPAO2
         IF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
            AM(1)=DBLE(ULMASS(KPA))
            AM(2)=DBLE(ULMASS(KPA2))
         ENDIF
      ENDIF

C... YX IS THE PHOTON ENERGY
C... Q2 FROM PHOTON
C... XP2 IS XGLUON ( MOMENTUM FRACTION OF THE GLUON)
C... XMIN = MIN XGLUON TO PRODUCE THE INV. MASS OF GAMMA GLUON SYSTEM
C... XMAX=1.
CCC
C... GENERATE YX,Q2,XP2 ACCORDING TO 1/X SPECTRUM
C... FGAM IS THE WEIGHT OF EPA
      NRN = 0
c      IRES(1)=0
      XMAX=0.999d0
      IF(IRES(1).EQ.0.OR.IPRO.EQ.12) THEN
c.......
         IF(KE.NE.22) THEN
            NRN = NRN + 1

            YX = YMIN*((YMAX/YMIN)**X(NRN))
c            write(6,*) ' y,ymax,ymin,x(NRN),NRN',yx,ymax,ymin,x(nrn),nrn
            IF(YX.GT.YMAX.OR.YX.LT.YMIN) GOTO 200
            Q2MIN=ME*ME*YX*YX/(1.D0-YX)
            IF(QMI.GT.Q2MIN) Q2MIN = QMI
            Q2MAX=YX*SSS - W12
            IF(QMA.LT.Q2MAX) Q2MAX = QMA
            IF(Q2MAX.LT.Q2MIN) GOTO 210
            NRN = NRN + 1
            IF(QMI.EQ.0.D0) THEN
               Q2 = Q2MIN*((Q2MAX/Q2MIN)**X(NRN))
            ELSE
c new try weighting with 1/q**4
               Q2 = Q2MIN*Q2MAX/(X(NRN)*Q2MIN + Q2MAX*(1.D0 - X(NRN)))
            ENDIF
            XMIN = 0.0D0
            XP2Q=Q2/YX/SSS
            QG2 = 0.D0
            WQG2 = 1.D0
            IF(ISEMIH.EQ.1) THEN
C... here is new for ZOTOV SALEEV
               QG2MAX = 90.D0
               IF(AM(1).GT.1.D0) THEN
                  QG2MAX = 4.D0 * AM(1)**2 + Q2
               ELSE
                  QG2MAX = 4.D0 * PT2CUT(IPRO) + Q2
               ENDIF
               QG2MIN = 0.2D0
               QG20 = 2.D0
ccccc               QG2MAX = QG20
ccccc               QG2MAX = 9.D0
               NRN = NRN + 1
c               XZOHRN = draprn()
               XZOHRN = X(NRN)
c               QG2 = QG2MIN*QG2MAX/ (QG2MAX-XZOHRN*(QG2MAX-QG2MIN))
c               WQG2 = QG2**2*(1.D0/QG2MIN - 1.D0/QG2MAX)
c 1/qt**2
               QG2 = QG2MIN*((QG2MAX/QG2MIN)**XZOHRN)
               WQG2 = QG2*DLOG(QG2MAX/QG2MIN)
c               write(6,*) ' partdi QG2,WQG2:',QG2,WQG2
               IF(QG2.LE.QG20) QG2 = 0.D0
c               QG2 = 3.D0
c... end new ZOTOV
            ENDIF
            IF(IPRO.NE.12) THEN
               SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
               XMIN=(SMIN+Q2+QG2)/(YX*SSS)
               IF(IMIX.EQ.1.AND.IWEI.EQ.1) THEN
                  XMIN = DMAX1(XMIN,Q2/YX/SSS)
c                    XMAX = XR12
               ENDIF
            ELSE
               XMIN=Q2/YX/SSS
            ENDIF
         ELSEIF(KE.EQ.22) THEN
            Q2 = 0.D0
            YX = 1.D0
            QG2 = 0.D0
            WQG2 = 1.D0
            IF(ISEMIH.EQ.1) THEN
C... here is new for ZOTOV SALEEV
               QG2MAX = 90.D0
               IF(AM(1).GT.1.D0) THEN
                  QG2MAX = 4.D0 * AM(1)**2
               ELSE
                  QG2MAX = 4.D0 * PT2CUT(IPRO)
               ENDIF
               QG2MIN = 0.2D0
               QG20 = 2.D0
ccccc               QG2MAX = QG20
ccccc               QG2MAX = 9.D0
               NRN = NRN + 1
c               XZOHRN = draprn()
               XZOHRN = X(NRN)
c               write(6,*) ' partdi x(nrn) ',x(nrn),XZOHRN,nrn
c               QG2 = QG2MIN*QG2MAX/ (QG2MAX-XZOHRN*(QG2MAX-QG2MIN))
c               WQG2 = QG2**2*(1.D0/QG2MIN - 1.D0/QG2MAX)
c 1/qt**2
               QG2 = QG2MIN*((QG2MAX/QG2MIN)**XZOHRN)
               WQG2 = QG2*DLOG(QG2MAX/QG2MIN)
c               write(6,*) ' partdi QG2,WQG2:',QG2,WQG2
c               write(6,*) ' partdi QG2MAX,QG2MIN ',QG2MAX,QG2MIN
c               QG2 = 3.D0
               IF(QG2.LE.QG20) QG2 = 0.D0
c... end new ZOTOV
            ENDIF
c               write(6,*) ' partdi yx,q2 ',yx,q2
            SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
            XMIN= (SMIN+QG2)/(YX*SSS)
         ELSE
            write(6,*) ' wrong KF selected; program stop '
            YX = 0.D0
         ENDIF
         XG1=YX
      ELSEIF(IRES(1).EQ.1) THEN
C XG1 = E_gluon/E_electron
C YX  = E_photon/E_electron
C XP1 = E_gluon/E_photon
         NRN = NRN + 1
         YX = YMIN*((YMAX/YMIN)**X(NRN))
         NRN = NRN + 1
         XP1MIN =DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
     +           /YX/SSS
         XP1 = XP1MIN*(1.D0/XP1MIN)**X(NRN)
         XG1 = XP1*YX
         Q2MIN = ME*ME*YX*YX/(1.D0 - YX)
         IF(QMI.GT.Q2MIN) Q2MIN = QMI
         Q2MAX=YX*(SSS-MP**2) - W12
         IF(QMA.LT.Q2MAX) Q2MAX = QMA
         IF(Q2MAX.LT.Q2MIN) GOTO 210
         NRN = NRN + 1
         IF(QMI.EQ.0.D0) THEN
            Q2 = Q2MIN*((Q2MAX/Q2MIN)**X(NRN))
         ELSE
c new try weighting with 1/q**4
            Q2 = Q2MIN*Q2MAX/(X(NRN)*Q2MIN + Q2MAX*(1.D0 - X(NRN)))
         ENDIF
c         write(6,*) ' partdi yx =',yx,' xel = ',xg1
         XMIN = 0.0D0
         XP2Q=Q2/XG1/SSS
         QG2 = 0.D0
         WQG2 = 1.D0
         IF(IPRO.NE.12) THEN
            SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
            XMIN=(SMIN+Q2+QG2)/(XG1*SSS)
c         write(6,*) yx,xg1,xp1,smin,q2,xmin
            IF(IMIX.EQ.1.AND.IWEI.EQ.1) THEN
               XMIN = DMAX1(XMIN,Q2/YX/SSS)
c                    XMAX = XR12
            ENDIF
         ELSE
            XMIN=Q2/YX/SSS
         ENDIF
      ELSE
         YX = 0.D0
         XG1 = 0.D0
      ENDIF
      IF(XMIN.GE.XMAX) GOTO 220
C ... XP2 = E_parton /E_proton

      IF(IPRO.NE.12.AND.IMIX.EQ.0) THEN
         NRN = NRN + 1
         XP2= XMIN*((XMAX/XMIN)**X(NRN))
      ELSEIF(IPRO.NE.12.AND.IMIX.EQ.1.AND.IWEI.EQ.1) THEN
         XP2= XMIN*((XMAX/XMIN)**X(NDIMEN+1))
      ELSEIF(IPRO.EQ.12.OR.IPRO.EQ.100) THEN
         XP2 = Q2/YX/SSS
      ELSE
         XP2 = 0.D0
      ENDIF
c      write(6,*) ' xp2 ',xp2
      IF(SNGL(XP2).GE.0.9999.OR.XP2.LT.XMIN) GOTO 230
      SHAT1 = SSS*XG1*XP2
      IF(IPRO.NE.12)  SHAT1=SSS*XG1*XP2 - Q2 - QG2
c      write(6,*) ' sss,xg1,xp2,q2,qg2 ',sss,xg1,xp2,q2,qg2
      IF(SHAT1.LT.(AM(1)+AM(2))**2) GOTO240
      ENTRY PARTDIHS(X,WPART)
      IF(IHERAC.EQ.1) THEN
         DO 40     IN=1,20
            K(IN,1) = 0
            K(IN,2) = 0
   40    CONTINUE

C...  GIVE BEAM  FOUR VECTORS
         DO 50    I=1,2
            DO 50     J=1,5
               K(I,J)=KBEAM(I,J)
   50    P(I,J) = PBEAM(I,J)
         ME =P(1,5)
         MP =P(2,5)
         NP=2
         NPP=3*NP
         N=2
         NFLAVP = NFLAV
         NRN = 2
         MP =P(2,5)
         IRES(1)=0
         XMAX= 0.999d0
         IST = 0
         YX = YHS
         XP2 = XHS
c         XP2 = Q2HS/YX/SSS
c         write(6,*) ' PARTDI: XHS,X ',XHS,XP2
         Q2 = Q2HS
         IF(IPRO.EQ.12.OR.IPRO.EQ.15) THEN
            KPA = 1
         ENDIF
         XG1 = YX
         NDIMEN = NDIM
c        write(6,*) '1st partdi IPRO,IHFLA,KPA',IPRO,IHFLA,KPA,IGENFL
c         write(6,*) 'partdi kpa,ipro,igenfl',kpa,ipro,igenfl,iwei
C ... select particle code for light flavour production according
C ... to charges
         IF(IPRO.EQ.10.OR.IPRO.EQ.13) THEN
            IF(INTER.LT.2) THEN
               QF=DFLOAT(LUCHGE(1))**2 + DFLOAT(LUCHGE(2))**2 +
     +         DFLOAT( LUCHGE(3))**2
               QF = 2.D0*QF
               KPA = -4
               QFT = - draprn()*QF
   60          KPA=KPA+1
               QFT = QFT + DBLE(LUCHGE(KPA))**2
               IF(QFT.LT.0.0D0) GOTO 60
               IF(KPA.GT.3) write(6,*) 'fatal light quark = charm!!!!!!'
     +         //' ', KPA
               KPA2 = - KPA
            ELSEIF(INTER.EQ.2) THEN
               KPAT = 2
               IF(draprn().GT.0.5) THEN
                  KPA = -ISIGN(1,K(1,2))*IABS(KPAT)
                  KPA2 = ISIGN(1,K(1,2))*(IABS(KPAT)-1)

               ELSE
                  KPA = ISIGN(1,K(1,2))*(IABS(KPAT)-1)
                  KPA2 = -ISIGN(1,K(1,2))*IABS(KPAT)
               ENDIF
            ENDIF
         ENDIF
         IF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
            IF(IWEI.EQ.0) THEN
               KPA = 4
               IF(IHFLA.GE.4) KPA=IHFLA
               KPA2=-KPA
            ELSEIF(IWEI.EQ.1) THEN
               IF(draprn().GT.0.5) KPA = -KPA
               KPA2 = -KPA
            ENDIF
            KPFL = IABS(KPA)
            IF(INTER.EQ.2) THEN
               KPA = -ISIGN(1,K(1,2))*KPFL
               KPA2 = ISIGN(1,K(1,2))*(KPFL-1)
               IF(draprn().LT.0.5) THEN
                  KPA = ISIGN(1,K(1,2))*(KPFL-1)
                  KPA2 = -ISIGN(1,K(1,2))*KPFL
               ENDIF
            ENDIF
            AM(1)=DBLE(ULMASS(KPA))
            AM(2)=DBLE(ULMASS(KPA2))
            IF(AM(1).LT.1.D-6) AM(1)=0.0D0
            IF(AM(2).LT.1.D-6) AM(2)=0.0D0
         ENDIF

         IF(IPRO.EQ.14.AND.IMIX.EQ.1) THEN
         ELSE

c         write(6,*) 'PARTDI SSS ',SSS
C.. HERE THE LIMITS ON Y( PHOTON ENERGY) AND Q**2 ARE CALCULATED
C... ACCORDING TO PROCEEDINGS OF HERA WORKSHOP 1987
C... ALI ET AL
            W02=(1.D0 + MP)**2
            W12=W02-MP*MP
            YMAX=SSS+W12+DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
            YMAX=YMAX/(2.D0*(SSS+ME*ME))
            YMIN=SSS+W12-DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
            YMIN=YMIN/(2.D0*(SSS+ME*ME))
c         write(6,*) ' YX,YHS,YMIN,YMAX ',YX,YHS,ymin,ymax
            IF(YMI.GT.YMIN) YMIN=YMI
            IF(YMA.LT.YMAX) YMAX=YMA
ccc            IF(YX.GT.YMAX.OR.YX.LT.YMIN) GOTO 200
         ENDIF
         IF(IGENFL.EQ.0) THEN
            KPAO = KPA
            KPAO2 = KPA2
         ELSE
            KPA=KPAO
            KPA2 = KPAO2
         ENDIF

         Q2MIN=ME*ME*YX*YX/(1.D0-YX)
         IF(QMI.GT.Q2MIN) Q2MIN = QMI
         Q2MAX=YX*SSS - W12
         IF(QMA.LT.Q2MAX) Q2MAX = QMA
         IF(Q2MAX.LT.Q2MIN) GOTO 210
         XP2Q=Q2/YX/SSS
         IF(IPRO.NE.12) THEN
            SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
            QG2 = 0.D0
            IF(IPRO.EQ.100) SMIN = 2.D0*(AM(1)**2+AM(2)**2)
            XMIN=(SMIN+Q2+QG2)/(YX*SSS)
            IF(XMIN.GE.XMAX) GOTO 220
            IF(IMIX.EQ.1.AND.IWEI.EQ.1) THEN
               XMIN = DMAX1(XP2Q,XMIN)
c               XMAX = XR12
               XP2= XMIN*((XMAX/XMIN)**X(NDIMEN+1))
               if(xp2.GE.1.d0) then
                  write(6,*) ' partdi xp2,x(ndimen+1),xmax,xmin',
     +            xp2,x(ndimen+1),xmax,xmin
               endif
            ENDIF
         ENDIF
c        write(6,*) '2nd partdi IPRO,IHFLA,KPA',IPRO,IHFLA,KPA,IGENFL
c         write(6,*) ' PARTDI INTER',inter,',= KPA,KPA2 ', kpa,kpa2,ipro
c         write(6,*) 'PARTDI HERAC: yx,x,Q2,KPA,ipro ',yx,xp2,q2,kpa,ipro
c         write(6,*) 'PARTDI : kpao kpao2,kpa,kpa2 ',kpao,kpao2,kpa,kpa2
         IF(XP2.GE.XMAX) GOTO 240
      ENDIF
      IST = 0
      YY=SNGL(YX)
      XEL=SNGL(XG1)
      XPR=SNGL(XP2)
      PHI = 99999.D0
      IF(IPRO.EQ.15) NFLAVP = NFLQCDC
      IF((IPRO.EQ.13.OR.IPRO.EQ.14.OR.IPRO.EQ.15.OR.IPRO.EQ.18)
     +.AND.IMIX.EQ.0) THEN
         NRN=NRN+1
         PHI = 2.D0*PI*X(NRN)
      ELSEIF((IPRO.EQ.13.OR.IPRO.EQ.14.OR.IPRO.EQ.15.OR.IPRO.EQ.18)
     +.AND.IMIX.EQ.1.AND.IWEI.EQ.1) THEN
         PHI = 2.D0*PI*X(NDIMEN+2)
      ELSEIF(IHERAC.EQ.0) THEN
         IF(IGENFL.EQ.0) THEN
            PHI = 2.D0*PI*draprn()
            PIO = PHI
         ELSEIF(IGENFL.EQ.1) THEN
            PHI = PIO
         ENDIF
      ENDIF
      IF(IRES(1).EQ.0) THEN
         CALL PARTI(KE,YX,FGAM,FWEI,1,IST)
      ELSEIF(IRES(1).EQ.1) THEN
         CALL PARTI(KE,YX,FGAM,WEIGHT,1,IST)
c factor xg1/yx cancelled because parton densities of photon taken
c xgx instead of g(x)
         FWEI =  DLOG(1.D0/XP1MIN) * WEIGHT
      ELSE
         WRITE(6,*) ' IRES(1) > 1 not implemented '
         FGAM = 0.D0
         FWEI = 0.D0
      ENDIF
      XP=0.D0
      IRES(2)=1
C here do some gymnastics to make cut on theta angle of electron
      IF(THEMA.LT.180.D0.OR.THEMI.GE.0.D0) THEN
C go first to ep LAB system
         CALL DUDBRB(3,3,0.D0,0.D0,CM(1)/CM(4),CM(2)/CM(4),CM(3)/CM(4))
         THETE = DPLU(3,14)
         CALL DUDBRB(3,3,0.D0,0.D0,-CM(1)/CM(4),
     +                -CM(2)/CM(4),-CM(3)/CM(4))
c         CALL DULIST(1)
         IF(THETE .GT. 180.01D0) THEN
            WRITE(6,*) ' FATAL: theta_electron > 180 deg ',THETE
         ENDIF
         IF(THETE .GE. THEMA) GOTO 250
         IF(THETE .LE. THEMI) GOTO 250
      ENDIF
C end of these gymnastics

C FINAL STATE PROTON
      NPFIN=NIA1+4
      N=NPFIN
      K(NPFIN,1)=1
      K(NPFIN,2)=KP
      K(NPFIN,3)=2
      P(NPFIN,5)=DBLE(ULMASS(KP))
      PR = P(2,3)*(1.D0 - XP2)
      P(NPFIN,4) = PR
      CPHP=1.D0
      SPHP=DSQRT(1.D0 - CPHP**2)
      IF(ISEMIH.EQ.1) THEN
         STHP = DSQRT(QG2)/PR
      ENDIF
      IF(DABS(STHP).GT.1.D0) goto 310
      CTHP=DSQRT(1.D0 - STHP**2)
      P(NPFIN,1)= PR*STHP*CPHP
      P(NPFIN,2)= PR*STHP*SPHP
      P(NPFIN,3)= PR*CTHP
c      CALL DULIST(1)
C MOMENTA OF PARTON
      K(NIA1+1,1)=21
      K(NIA1+1,2)=KGL
      IF(IPRO.EQ.12) K(NIA1+1,2) = KPA
      K(NIA1+1,3)=2
      DO 70  KI=1,4
         P(NIA1+1,KI)=P(2,KI)-P(NPFIN,KI)
   70 CONTINUE
      IF(ISEMIH.EQ.0) THEN
         P(NIA1+1,4)=ABS(P(NIA1+1,3))
         P(NIA1+1,5)=0.0D0
      ELSE
         P(NIA1+1,4)=DSQRT(P(NIA1+1,1)**2+P(NIA1+1,2)**2+P(NIA1+1,3)**2
     +               - QG2)
         P(NIA1+1,5)=-sqrt(ABS(DOT1(NIA1+1,NIA1+1)))
      ENDIF
      NIA2 = NIA1+1
c      write(6,*) ' partdi p(nia2,5)**2',DOT1(NIA2,NIA2)
c      write(6,*) ' partdi p(npfin,5)**2',DOT1(NPFIN,NPFIN)
c      write(6,*)  ' partdi '
c      call dulist(1)
c      pause
      IF(IPRO.NE.12) THEN
         NF1=NIA1+2
         NF2=NIA1+3
         K(NF1,1)=2

         IF(IPRO.EQ.15) THEN

         ELSE
            K(NF2,2)=KPA2
         ENDIF
         IF(IPRO.NE.15.AND.IPRO.NE.12) KPF=KPA
         K(NF1,2)=KPF
         K(NF1,3)=NIA1
         K(NF2,1)=1
         K(NF2,3)=NIA1
         P(NF1,5)=AM(1)
         P(NF2,5)=AM(2)
         NB2 = NIA2
C...   VECTOR OF GAMMA GLUON CMS SYSTEM
      ELSEIF(IPRO.EQ.12) THEN
         Q2Q = Q2
         CALL PYSTFU(K(2,2),SNGL(XP2),SNGL(Q2Q),XPQ)
C... WTGLU IS THE WEIGHT FOR XPARTON GENERATION
         WTGLU = 0.D0
         IF(INTER.LT.2) THEN
            DO 80  I=-NFLAVP,NFLAVP
   80       WTGLU =WTGLU+DBLE(XPQ(I))*DFLOAT(LUCHGE(I))**2/9.D0
            IF(IGENFL.EQ.1) THEN
               KPA = KPAO
               WTGLU = DBLE(XPQ(KPA))*DFLOAT(LUCHGE(KPA))**2/9.D0
            ELSE
               QFT = - draprn()*WTGLU
               KPA=-NFLAVP-1
   90          KPA=KPA+1
               QFT = QFT + DBLE(LUCHGE(KPA))**2/9.D0*DBLE(XPQ(KPA))
               IF(QFT.LT.0.0D0) GOTO 90
            ENDIF
            KPF = KPA
         ELSEIF(INTER.EQ.2) THEN
c            write(6,*) ISIGN(1,K(1,2))
            DO 100 I=-6,6
               F2CC(I) = 0.0
  100       XF3CC(I) = 0.0
            DO 110 I=1,NFLAVP-1,2
               IF(ISIGN(1,K(1,2)).EQ.1) THEN
                  F2CC(I+1) = 2.*XPQ(I+1)
                  F2CC(-I) =  2.*XPQ(-I)
                  XF3CC(I+1) = 2.*XPQ(I+1)
                  XF3CC(-I) =  -2.*XPQ(-I)
                  WTGLU = WTGLU +
     +            (1.D0 - YX + YX**2/2.D0)*DBLE(F2CC(-I)+F2CC(I+1))
     +            + (YX - YX**2/2.D0)*DBLE(XF3CC(-I)+XF3CC(I+1))
               ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                  F2CC(I) = 2.*XPQ(I)
                  F2CC(-I-1) = 2.*XPQ(-I-1)
                  XF3CC(I) = 2.*XPQ(I)
                  XF3CC(-I-1) = -2.*XPQ(-I-1)
                  WTGLU = WTGLU +
     +            (1.D0 - YX + YX**2/2.D0)*DBLE(F2CC(I)+F2CC(-I-1))
     +            - (YX - YX**2/2.D0)*DBLE(XF3CC(I)+XF3CC(-I-1))
               ENDIF
  110       CONTINUE
            IF(IGENFL.EQ.1) THEN
               KPA = KPAO
               IF(ISIGN(1,K(1,2)).EQ.1) THEN
                  WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)*
     +            DBLE(F2CC(KPA)) + (YX - YX**2/2.D0)*DBLE(XF3CC(KPA))
               ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                  WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)*
     +            DBLE(F2CC(KPA)) - (YX - YX**2/2.D0)*DBLE(XF3CC(KPA))
               ENDIF
               IF(ISIGN(1,K(1,2)).EQ.1) THEN
                  KPF = (KPA - 1)
               ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                  KPF = (KPA + 1)
               ENDIF
            ELSE
               QFT = - draprn()*WTGLU
               KPA=-NFLAVP-1
  120          KPA=KPA+1
c               write(6,*) ' partdi 1st KPA =',kpa,NFLAVP,WTGLU,qft
c                write(6,*) ' partdi 1st KPA ='
               IF(KPA.EQ.0) GOTO 120
               IF(ISIGN(1,K(1,2)).EQ.1) THEN
                  QFT = QFT + (1.D0 - YX + YX**2/2.D0)*DBLE(F2CC(KPA))
     +            + (YX - YX**2/2.D0)*DBLE(XF3CC(KPA))
               ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                  QFT = QFT + (1.D0 - YX + YX**2/2.D0)*DBLE(F2CC(KPA))
     +            - (YX - YX**2/2.D0)*DBLE(XF3CC(KPA))
               ENDIF

               IF(QFT.LT.0.0D0) GOTO 120
c               write(6,*) 'partdi kpa,qft ',KPA, QFT
               IF(ISIGN(1,K(1,2)).EQ.1) THEN
                  KPF = (KPA - 1)
               ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                  KPF = (KPA + 1)
               ENDIF
c               write(6,*) ' partdi kpa =',kpa,'kpf = ',kpf
            ENDIF
         ELSE
            WRITE(6,*) ' wrong interaction INTER = ',INTER
         ENDIF
c        P(NIA1+1,5)=ULMASS(KPA)
         P(NIA1+1,5) = 0.0D0
         P(NIA1+1,4)=SQRT(P(NIA1+1,3)**2 + P(NIA1+1,5)**2)
         K(NIA1+1,2)=KPA
         NF1=NIA1+2
         NF2=NIA1+3
         K(NF1,1)=2
         K(NF1,2)=KPF
         K(NF1,3)=NIA1
         K(NF2,1)= 0
         NB2 = 2
         SCAL2 = SNGL(Q2Q)
         XPD2 = XPQ(KPA)
c         write(6,*) ' partdi NIA1,NF1,NF2,NB2',NIA1,NF1,NF2,NB2
c         call dulist(1)
c         pause
      ELSE
         NB2 = 0
      ENDIF
      DBCMS(1)=  P(NIA1,1) + P(NB2,1)
      DBCMS(2)=  P(NIA1,2) + P(NB2,2)
      DBCMS(3)=  P(NIA1,3) + P(NB2,3)
      DBCMS(4)=  P(NIA1,4) + P(NB2,4)
      DO 130 I=1,4
         P(NF1,I)=0.0D0
         P(NF2,I)=0.0D0
  130 CONTINUE
      SHAT=DOT(DBCMS,DBCMS)
      IF(SHAT.LE.0.0) THEN
         GOTO 270
      ENDIF
c          call dulist(1)
C NOW BOOST TO GAMMA GLUON
      BOCHCK = (DBCMS(1)/DBCMS(4))**2 + (DBCMS(2)/DBCMS(4))**2 +
     +(DBCMS(3)/DBCMS(4))**2
      BOCHCK = DSQRT(BOCHCK)
      IF(BOCHCK.GT.0.99999999D0) goto 260
      CALL DUDBRB(0,N,0.D0,0.D0,-DBCMS(1)/DBCMS(4),-DBCMS(2)/DBCMS(4),
     +-DBCMS(3)/DBCMS(4))
      SPHI = DLANGL(P(NIA1,1),P(NIA1,2))
      call DUDBRB(0,0,0.D0,-sphi,0.d0,0.d0,0.d0)
      STHETA = DLANGL(P(NIA1,3),P(NIA1,1))
      call DUDBRB(0,0,-STHETA,0.D0,0.d0,0.d0,0.d0)
      IF(IPRO.NE.12) THEN
C NOW  LOOK THAT WE REALLY HAVE ENOUGH ENERGY IN GAMMA GLUON CMS SYSTEM
C...  ECM = CMS ENERGY OF GAMMA GLUON SYSTEM
c         write(6,*) ECM
         ECM =DSQRT(SHAT)
C      IF(ECM.LE.(AM(1)+AM(2))) WRITE(6,*) ' ECM LE MASS',ECM
         IF(ECM.LE.(AM(1)+AM(2))) GOTO 280
c         write(6,*) ' IPRO = 13 ,NRN= ',NRN
         IF(IMIX.EQ.1.AND.IWEI.EQ.1) THEN
            XY(1)=X(NDIMEN+3)
            XY(2)=X(NDIMEN+4)
         ELSE
            NRN = NRN + 1
            XY(1) = X(NRN)
            NRN = NRN + 1
            XY(2) = X(NRN)
         ENDIF
c         write(6,*) am(1),am(2),ipro
c         write(6,*) 'partdi ',XY(1),XY(2),NDIM,NDIMEN,IMIX,IWEI
         CALL PHASE(NP,ECM,AM,PCM,WT)
         IF(WT.LE.0.D0) GOTO 290
         DO 140 I=1,4
            P(NF1,I)=PCM(I,1)
            P(NF2,I)=PCM(I,2)
  140    CONTINUE
c         write(6,*) ' partdi ', KPA,KPA2,K(NF1,2),K(NF2,2)
         PT2 = DPLU(NF1,9)
         CALL CUTG(PT2,NACC)
         IF(NACC.EQ.0) GOTO 300
cscale        IF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
cscale             Q2Q = (AM(1)+AM(2))**2
cscale            Q2Q = (AM(1)+AM(2))**2 + Q2
cscale         ELSE
         IF(IQ2.EQ.1) THEN
            Q2Q = (2.D0*AM(1))**2
         ELSEIF(IQ2.EQ.2) THEN
            Q2Q = SHAT
         ELSEIF(IQ2.EQ.3) THEN
            Q2Q = (2.D0*AM(1))**2 + PT2
         ELSEIF(IQ2.EQ.4) THEN
            Q2Q = Q2
         ELSEIF(IQ2.EQ.5) THEN
            Q2Q = Q2 + PT2 + (2.D0*AM(1))**2
c this is for testing
         ELSEIF(IQ2.EQ.6) THEN
c torbjorn suggestion
            Q2Q = PT2 + 8.D0*PT2**2/SHAT
C kt**2 as from Zeppenfeld/Mirkes
            t = AM(1)**2 - 2.D0 * DOT1(NIA1,NF1) - P(NIA1,5)**2
            at=DSQRT((t+Q2)**2+4.D0*Q2*PT2)
            Q2Q = at*(at+t+Q2)/2.D0/Q2
c         write(6,*) 'partdi : t,PT2,Q2,Q2Q ',t,PT2,Q2,Q2Q
         ELSEIF(IQ2.EQ.7) THEN
c torbjorn suggestion
            Q2Q = PT2 + 8.D0*PT2**2/SHAT
         ELSE
            WRITE(6,*) ' NO VALID Q2 SCALE. STOP'
            STOP
         ENDIF
cscale         ENDIF
         IF(IQ2.EQ.5) THEN
            Q2Q = Q2 + PT2*SCALFA + (2.D0*AM(1))**2
         ELSE
            Q2Q = SCALFA*Q2Q
         ENDIF
c now do QCD compton.....
         IF(IPRO.EQ.15) THEN
            K(NF2,2) = 21
cdon't use that            Q2Q = Q2
            if(XP2.GT.1.d0) write(6,*) 'partdi xp2>1',xp2,xmax,xmin,ipro
            CALL PYSTFU(K(2,2),SNGL(XP2),SNGL(Q2Q),XPQ)
C... WTGLU IS THE WEIGHT FOR XGLUON GENERATION
            WTGLU = 0.D0
c           write(6,*) 'partdi : NFLAV=',NFLAVP
            IF(INTER.LT.2) THEN
               DO 150 I=-NFLAVP,NFLAVP
  150          WTGLU =WTGLU+DBLE(XPQ(I))*DFLOAT(LUCHGE(I))**2/9.D0
               IF(IGENFL.EQ.1) THEN
                  KPA = KPAO
                  WTGLU = DBLE(XPQ(KPA))*DFLOAT(LUCHGE(KPA))**2/9.D0
               ELSE
                  QFT = - draprn()*WTGLU
                  KPA=-NFLAVP-1
  160             KPA=KPA+1
                  QFT = QFT + DBLE(LUCHGE(KPA))**2/9.D0*DBLE(XPQ(KPA))
                  IF(QFT.LT.0.0D0) GOTO 160
               ENDIF
               KPF = KPA
            ELSEIF(INTER.EQ.2) THEN
c            write(6,*) ISIGN(1,K(1,2))
               DO 170 I=-6,6
                  F2CC(I) = 0.0
  170          XF3CC(I) = 0.0
               DO 180 I=1,NFLAVP-1,2
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     F2CC(I+1) = 2.*XPQ(I+1)
                     F2CC(-I) =  2.*XPQ(-I)
                     XF3CC(I+1) =  2.*XPQ(I+1)
                     XF3CC(-I) = - 2.*XPQ(-I)
                     WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)*
     +               DBLE(F2CC(-I)+F2CC(I+1)) + (YX - YX**2/2.D0)*
     +               DBLE(XF3CC(-I)+XF3CC(I+1))
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     F2CC(I) =  2.*XPQ(I)
                     F2CC(-I-1) =  2.*XPQ(-I-1)
                     XF3CC(I) =  2.*XPQ(I)
                     XF3CC(-I-1) = - 2.*XPQ(-I-1)
                     WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)*
     +               DBLE(F2CC(I)+F2CC(-I-1)) - (YX - YX**2/2.D0)*
     +               DBLE(XF3CC(I)+XF3CC(-I-1))
                  ENDIF
  180          CONTINUE
               IF(IGENFL.EQ.1) THEN
                  KPA = KPAO
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)*
     +               DBLE(F2CC(KPA)) + (YX - YX**2/2.D0)*
     +               DBLE(XF3CC(KPA))
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     WTGLU = WTGLU + (1.D0 - YX + YX**2/2.D0)*
     +               DBLE(F2CC(KPA)) - (YX - YX**2/2.D0)*
     +               DBLE(XF3CC(KPA))
                  ENDIF
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     KPF = (KPA - 1)
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     KPF = (KPA + 1)
                  ENDIF
               ELSE
                  QFT = - draprn()*WTGLU
                  KPA=-NFLAVP-1
  190             KPA=KPA+1
                  IF(KPA.EQ.0) GOTO 190
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     QFT = QFT + (1.D0 - YX + YX**2/2.D0)*
     +               DBLE(F2CC(KPA)) + (YX - YX**2/2.D0)*
     +               DBLE(XF3CC(KPA))
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     QFT = QFT + (1.D0 - YX + YX**2/2.D0)*
     +               DBLE(F2CC(KPA)) - (YX - YX**2/2.D0)*
     +               DBLE(XF3CC(KPA))
                  ENDIF

                  IF(QFT.LT.0.0D0) GOTO 190
c               write(6,*) KPA, QFT
                  IF(ISIGN(1,K(1,2)).EQ.1) THEN
                     KPF = (KPA - 1)
                  ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                     KPF = (KPA + 1)
                  ENDIF
               ENDIF
            ELSE
               WRITE(6,*) ' wrong interaction INTER = ',INTER
            ENDIF
            WTG15 = WTGLU
            K(NIA1+1,2)=KPA
            AM(1) = 0.D0
            IF(IABS(KPA).GE.4) AM(1) = DBLE(ULMASS(KPA))
c end QCD compton.....
         ENDIF
C BOOST BACK TO OVERALL CMS ( now done in FXN1 )
         call DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
         call DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
         XPR = SNGL(XP2)
c         IDIRO = IDIR
c         IDIR = 0
         if(xp2.GT.1.d0) write(6,*) 'partdi xp2>1',xp2,ipro
c         write(6,*) 'partdi xp2,xg1',xp2,xg1
         CALL PYSTFU(K(2,2),SNGL(XP2),SNGL(Q2Q),XPQ)

c         IDIR = IDIRO
C... WTGLU IS THE WEIGHT FOR XGLUON GENERATION
c for resolved photon move parton densities into ELERES
         IF(IRES(1).EQ.1) THEN
            XP = 1.D0/XP2
         ELSE
c            write(6,*) ' partdi ires=0'
            XP = DBLE(XPQ(0))/XP2
         ENDIF
         SCAL2 = SNGL(Q2Q)
         XPD2 = XPQ(0)
         IF(IPRO.EQ.15) THEN
            XP = WTG15/XP2
            XPD2 = XPQ(KPA)
         ENDIF
         XPINT=DLOG(XMAX/XMIN)
         WTGLU = XP2 * XP * XPINT

         IF(ISEMIH.EQ.1.AND.IPRO.NE.12.AND.IPRO.NE.15)
     +      WTGLU = WTGLU*WQG2
         WMAT=WT *WTGLU*FGAM*FWEI
         WMAT=WMAT/((2.D0*PI)**NPP)
C...  FLUX = FLUX USED FOR X-SECTION CALCULATION
         FLUX=(2.D0*PI)**4
         FLUX=FLUX/(2.D0*(SHAT+Q2))
         WPART = WMAT *FLUX
         IF(IPRO.EQ.13.OR.IPRO.EQ.14.OR.IPRO.EQ.15) THEN
            WPART = WTGLU * FWEI * WT
            IF(IPRO.EQ.15) THEN
               WPART = WPART*FLUX/((2.D0*PI)**NPP)
            ENDIF

         ENDIF
c         IF(WPART.LE.0) THEN
c           write(6,*) ' PARTDI: SHAT,Q2 ',SHAT,Q2
c           write(6,*) ' PARTDI: WTGLU,FWEI,WT,FGAM',WTGLU,FWEI,WT,FGAM
c           write(6,*) ' PARTDI: XP2,XPINT,XP,WQG2 ',XP2,XPINT,XP,WQG2
c           call dulist(1)
c           ENDIF
         PT2H = SNGL(PT2)
         SHH = SNGL(SHAT)

      ELSEIF(IPRO.EQ.12) THEN
c      write(6,*) ' partdi: KPA:',KPA
         K(NIA2,2) = KPA
         K(NF1,2) = KPA
         CALL PYSPLI(K(2,2),KPA,KFLCH,KFLSP)
         IF(SHAT.LT.(ULMASS(KPF) + ULMASS(KFLSP))**2) GOTO 240
         IF(SHAT.LT.4.d0) GOTO 240
c         write(6,*) ' pyspli ',K(2,2),IABS(KPA),KFLCH,KFLSP
         CALL DU2ENT(NF1,KPF,KFLSP,SNGL(DSQRT(SHAT)))
         N = NPFIN
         K(NF1,3) = NIA1+1
         K(NF1+1,3) = 2
         K(NPFIN,1)= 0
         CALL DUEDIT(12)
c         CALL DULIST(1)
         NF2 = NF1
c         write(6,*) alph,pi,yx,Q2,wtglu,fwei

         ALPH_EM = ALPH
         IF(IRUNAEM.EQ.1) ALPH_EM = DBLE(ULALEM(SNGL(Q2)))
         IF(INTER.LT.2) THEN
            WMAT = 2.D0 * ALPH_EM*ALPH_EM*PI/YX/Q2**2
            WMAT = WMAT *(1.D0+(1.D0-YX)**2)
         ELSEIF(INTER.EQ.2) THEN
            GF = PI*ALPH_EM/(SIN2W*XMW2*DSQRT(2.D0))
            WMAT = GF**2/2.D0/PI /(1.D0 + Q2/XMW2)**2 /YX
capply additional factor 0.5 because only right/or left handed electrons contr.
            WMAT = WMAT * 0.5D0
         ENDIF
c         write(6,*) wmat,wtglu,fwei,wmat*wtglu*fwei
         WPART = WMAT * WTGLU *FWEI
c         write(6,*) ' yx ',yx,' Q2 ',Q2,' XP2 ',XP2,' WTGLU ',WTGLU
C BOOST BACK TO OVERALL CMS ( now done in FXN1 )
         call DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
         call DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
         CALL DUDBRB(0,N,0.D0,0.D0,DBCMS(1)/DBCMS(4),DBCMS(2)/DBCMS(4),
     +   DBCMS(3)/DBCMS(4))
         PT2H = 99999.
         SHH = 99999.
c         CALL DULIST(1)
      ENDIF
      NDIMC = NRN
c      write(6,*) ' end of PARTDI ',NDIMC,NRN
c      CALL DULIST(1)
c      write(6,*)  'partdi: WPART ',WPART
      XFGKI = 9999.
	T2GKI = 9999.
      IF(IGENFL.EQ.0) THEN
         KPAO = KPA
         KPAO2 = KPA2
      ELSE
         KPA = KPAO
         KPA2 = KPAO2
      ENDIF
c      write(6,*) ' partdi end ,kpa,kpa1,kpa2,kpao2',kpa,kpa1,kpa2,kpao2
      RETURN
  200 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi: ylimit ; RETURN ',yx,ymin,ymax,x(1)
      ENDIF
      NDIMC = 9999
      RETURN
  210 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi: Q2limit ; RETURN ',Q2,Q2MIN,Q2MAX
         NDIMC = 9999
      ENDIF
      RETURN
  220 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi: xlimit ; RETURN xmin,xmax',xmin,xmax
      ENDIF
      NDIMC = 9999
      RETURN
  230 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi: xp2imit ; RETURN '
      ENDIF
      NDIMC = 9999
      RETURN
  240 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi: slimit ; RETURN ',shat1,am(1),am(2),IPRO
         write(6,*) ' sss,xg1,xp2,q2,qg2 ',sss,xg1,xp2,q2,qg2
         write(6,*) ' partdi q2,y,sss',q2,yx,sss
      ENDIF
      NDIMC = 9999
      RETURN
  250 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi: theta limit ; RETURN '
      ENDIF
      NDIMC = 9999
      IF(IHERAC.EQ.1) THEN
         NTHRE = NTHRE +1
      ENDIF
      RETURN
  260 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi: bochck limit ; RETURN '
      ENDIF
      NDIMC = 9999
      RETURN
  270 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi: shat ; RETURN '
      ENDIF
      NDIMC = 9999
      RETURN
  280 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi: ECM limit ; RETURN '
      ENDIF
      NDIMC = 9999
      RETURN
  290 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi: PHASE WT=0 ; RETURN '
      ENDIF
      NDIMC = 9999
      RETURN

  300 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi: PTCUT limit ; RETURN ',PT2,KPA
      ENDIF
      NDIMC = 9999
      RETURN
  310 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi: QG2 limit ; RETURN ',DSQRT(QG2),PR,STHP
      ENDIF
      NDIMC = 9999
      RETURN


      END
*CMZ :  2.07/03 16/05/99  09.41.48  by  Hannes Jung
*-- Author :    Hannes Jung   15/03/95
      SUBROUTINE PARTHS(X,WPART)
      IMPLICIT NONE
*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEND.
	Double PRecision X,WPART
      DIMENSION X(20)
      IF(IDIR.EQ.0) THEN
         CALL PARTDFHS(X,WPART)
      ELSE
         CALL PARTDIHS(X,WPART)
      ENDIF
      RETURN
      END
*CMZ :  2.08/02 20/07/99  11.39.37  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  16.21.38  by  Hannes Jung
*CMZ :  2.07/03 16/05/99  09.53.09  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE PARTI(IP1,YX,YVAL,WEIGHT,IFL,IST)
      IMPLICIT NONE
	Integer IP1,IFL,IST
	Double Precision YX,YVAL,WEIGHT
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.
      Integer NMXHEP,NEVHEP,NHEP,ISTHEP,IDHEP,JMOHEP,JDAHEP
	Double Precision PHEP,VHKK
      PARAMETER (NMXHEP=2000)
      COMMON /HEPEVT/ NEVHEP,NHEP,ISTHEP(NMXHEP),IDHEP(NMXHEP),
     +                JMOHEP(2,NMXHEP),JDAHEP(2,NMXHEP),
     +                PHEP(5,NMXHEP),VHKK(4,NMXHEP)
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
C     from HERACLES;
	Integer ICHNN,LST,IRES
      COMMON /HSCHNN/ ICHNN
      COMMON/EPPARA/LST(30),IRES(2)
	Double Precision PHI,DBGAM
      COMMON/DIFFA/ PHI
      DOUBLE PRECISION ME
      DIMENSION DBGAM(4)
      REAL SNGL
	Double Precision XG1,ALPH_EM,FGAM,SQRTS,EC,X11,COST2,SPHE,CPHE
	Double Precision PEP,PEZ,PDLE,CSPHI,XP1,BOCHCK,THE,PHIE
	Double Precision SPHI,STHETA,PT
	Integer I,NIPH,IE,NFI,IG
C IST = 0, ONLY PARTICLE MOMENTA, BUT SCALE Q2Q IN STRUCTURE FUNCTION
C NOT YET DEFINED.
C IST = 1, CALCULATE ONLY STRUCTURE FUNCTION SINCE Q2Q NOW DEFINED
C
C IF PARTICLE IP1 = 11 (ELECTRON) USE EQUIVALENT PHOTON APPROXIMATION
C
c      write(6,*) 'parti  Q2 = ',Q2,' yx = ',yx
      XG1 = DBLE(XEL)
      YVAL =  999999.D0
      WEIGHT = -999999.D0
      ME = DBLE(ULMASS(IP1))
      ALPH_EM = ALPH
      IF(IRUNAEM.EQ.1) ALPH_EM = DBLE(ULALEM(SNGL(Q2)))

C IF 1ST INCOMING PARTICLE IS A ELECTRON AND LOOKING FOR DIRECT PHOTON
      IF((IABS(IP1).EQ.11.OR.IABS(IP1).EQ.13)) THEN
C
         IF(IABS(IP1).EQ.11.OR.IABS(IP1).EQ.13) THEN
C...          WEIZAECKER WILLIAMS APPROXIMATION FOR BREMSTRAHLUNG (EPA)
C...          WITH Q2 DEPENDENCE
            FGAM = (1.D0 - YX +YX*YX/2.D0)/Q2/YX - ME*ME*YX/Q2/Q2

            YVAL = ALPH_EM * FGAM / PI
         ENDIF
         IF(QMI.EQ.0.D0) THEN
            WEIGHT = YX*Q2*DLOG(YMAX/YMIN)*DLOG(Q2MAX/Q2MIN)
         ELSE
c new try weighting with 1/q**4
            WEIGHT = YX*DLOG(YMAX/YMIN)*Q2**2*(Q2MAX-Q2MIN)/Q2MIN/
     +      Q2MAX
         ENDIF
C...

C...      CALCULATE COS OF ELECTRON VIA FORMULA GIVEN IN CAMPBELL ET AL
C...      CAN.J.PHYS. 39 1981 (1742)
C...      VIA X Q2 Y
C...      X11= Q2/(2P.Q)
         SQRTS=DSQRT(SSS)
         EC= 0.5D0*SQRTS
         IF(IHERAC.EQ.0) THEN
            X11= Q2/YX/SSS
            COST2= ((1.D0 - YX) - X11*YX)/((1.D0 - YX) + X11*YX)
            IF(COST2.GT.1.) WRITE(6,*) 'YX Q2 COST2 ',YX,Q2,COST2
C...      COST2 IS SCATTERING ANGLE OF ELECTRON
            THE= DACOS(COST2)
            PHIE = PHI
            IF(PHIE.GT.7.D0) write(6,*) 'fatal PHIE = ',PHIE
            SPHE=DSIN(PHIE)
            CPHE=DCOS(PHIE)
C...      PEL1 = 4 VECTOR OF SCATTERED ELECTRON IN EP CMS SYSTEM
            N=N+1
            K(N,1)=1
            IF(INTER.LT.2) THEN
               K(N,2)=K(1,2)
            ELSEIF(INTER.EQ.2) THEN
               K(N,2)=ISIGN(1,K(1,2))*12
            ENDIF
            K(N,3)=IFL
c. 2*P.l_e
c new gymnastics for numerical stability
            PEP = DSQRT(P(2,3)**2 + P(2,5)**2)
            PEZ = P(2,3)
            PDLE = 2.D0*DOT1(1,2)
            X11 = Q2/PDLE/YX
            P(N,5)=DBLE(ULMASS(K(N,2)))
            P(N,4) = P(1,4) + (PEZ*(Q2+P(N,5)**2)/ (2.D0*P(1,4)) -
     +      YX*PDLE/2.D0)/(PEP+PEZ)
            P(N,3) = P(1,4) - (PEP*(Q2+P(N,5)**2)/ (2.D0*P(1,4)) + YX*
     +      PDLE/2.0D0)/(PEP+PEZ)
            P(N,3)=-P(N,3)
            PT = Q2 - (Q2 + P(N,5)**2)/P(1,4)/(PEP+PEZ)* (YX*PDLE/2.D0 +
     +      P(2,5)**2*(Q2+P(N,5)**2)/4.D0/ P(1,4)/(PEP+PEZ))
            P(N,1)=DSQRT(DMAX1(0.D0,PT))*CPHE
            P(N,2)=DSQRT(DMAX1(0.D0,PT))*SPHE

C...      PPH = 4 VECTOR OF (VIRTUAL) PHOTON IN EP CMS SYSTEM
            N=N+1
            K(N,1)=21
            K(N,2)=KEB
            K(N,3)=IFL
            P(N,1)= P(1,1) - P(3,1)
            P(N,2)= P(1,2) - P(3,2)
            P(N,3)= P(1,3) - P(3,3)
            P(N,4)= P(1,4) - P(3,4)
            P(N,5)= -SQRT(ABS(DOT1(N,N)))
c            write(6,*) 'parti: ',P(N,5)**2,q2
            NIA1 = N
            NIPH = N
         ELSEIF(IHERAC.EQ.1) THEN
c            CALL PEPEVT
            IE=N+1
            NFI = N + 2
            IF(PHEP(4,3).NE.0.0) THEN
               IG=N+2
               NFI = N + 3
c radiative gamma
               K(IG,1)=1
               K(IG,2)=KPH
c radiated gamma has origin in e or e'
c               write(6,*) 'parti: ICHNN=',ICHNN
               IF(ICHNN.EQ.6.OR.ICHNN.EQ.12) THEN
                  K(IG,3)=1
               ELSE
                  K(IG,3)=4
               ENDIF
            ENDIF
c scattered electron
            K(IE,1)=1
            K(IE,2)=K(1,2)
            K(IE,3)=IFL
c exchanged  boson
            IF(IABS(IDHEP(1)).EQ.11) THEN
               KEB=KPH
            ELSEIF(IABS(IDHEP(1)).EQ.12) THEN
               KEB=-24*ISIGN(1,K(1,2))
            ELSE
               write(6,*) ' PARTI: scattered lepton not known ',IDHEP(1)
            ENDIF
            K(NFI,1)=21
            K(NFI,2)=KEB
            K(NFI,3)=IFL
            DO 10  I=1,5
               P(IE,I) = PHEP(I,1)
               P(NFI,I) = PHEP(I,5) - PHEP(I,1) - PHEP(I,3)
               IF(PHEP(4,3).NE.0.0) THEN
                  P(IG,I) = PHEP(I,3)
               ENDIF
   10       CONTINUE
c calculate phi
            CSPHI = P(IE,1)/SQRT(P(IE,1)**2+P(IE,2)**2)
            PHI = DACOS(CSPHI)
            N = NFI
            NIA1 = NFI
            NIPH = NIA1
            DO 20  I = 3,N
   20       P(I,3) = -P(I,3)
            P(NFI,5)= -SQRT(ABS(DOT1(NFI,NFI)))
c         write(6,*) ' parti: q2hs =',q2hs,p(nfi,5)**2
C BOOST TO EP CMS
            CALL DUDBRB(3,N,0.D0,0.D0,-CM(1)/CM(4),-CM(2)/CM(4),-CM(3)/
     +      CM(4))
         ELSE
            write(6,*) ' not valid for IHERAC ',IHERAC
         ENDIF
         IF(IRES(1).EQ.0) THEN
            NIR1 = -99999
         ELSEIF(IRES(1).EQ.1) THEN
c          write(6,*) 'parti yx = ',yx,' xel ',xg1
C         XG1 = X_GLUON OF THE PHOTON = E_GLUON/E_ELECTRON
C         YX  = E_PHOTON/E_ELECTRON
C         XP1 = E_GLUON/E_PHOTON
            XP1=XG1/YX
C...      PPH = NOW 4 VECTOR OF HADR COMP OF PHOTON IN EP CMS SYSTEM
            N = N + 1
            K(N+1,1)=21
            K(N+1,2)=21
            K(N+1,3)=IFL
            P(N+1,1)= P(N-1,1)*XP1
            P(N+1,2)= P(N-1,2)*XP1
            P(N+1,3)= P(N-1,3)*XP1
cccc            P(N+1,4)= DABS(P(N-1,3))*XP1
            P(N+1,4)= DABS(P(N-1,4))*XP1
            P(N+1,5)= DBLE(ULMASS(21))
            NIA1 = N+1
C...      PHA = NOW 4 VECTOR OF PHOTON REMNANT  IN EP CMS SYSTEM
            K(N,1)=1
            K(N,2)=21
            K(N,3)=IFL
            P(N,1)= P(1,1) - P(N+1,1)- P(3,1)
            P(N,2)= P(1,2) - P(N+1,2)- P(3,2)
            P(N,3)= P(1,3) - P(N+1,3)- P(3,3)
            P(N,5)= DBLE(ULMASS(21))
            P(N,4)= DSQRT(P(N,1)**2+P(N,2)**2+P(N,3)**2+P(N,5)**2)
            P(N+1,4)= P(1,4) - P(3,4) - P(N,4)
            NIR1 = N

c            write(6,*) ' parti yx,xg1,xp1',yx,xg1,xp1
c            call dulist(1)
C NOW BOOST TO GAMMA PROTON FRAME
            DBGAM(1) = P(NIPH,1) + P(2,1)
            DBGAM(2) = P(NIPH,2) + P(2,2)
            DBGAM(3) = P(NIPH,3) + P(2,3)
            DBGAM(4) = P(NIPH,4) + P(2,4)
            BOCHCK = (DBGAM(1)/DBGAM(4))**2 + (DBGAM(2)/DBGAM(4))**2 +
     +      (DBGAM(3)/DBGAM(4))**2
            BOCHCK = DSQRT(BOCHCK)
            IF(BOCHCK.GT.0.99999999D0) goto 30
            CALL DUDBRB(0,N,0.D0,0.D0,-DBGAM(1)/DBGAM(4),-DBGAM(2)/
     +      DBGAM(4), -DBGAM(3)/DBGAM(4))
            SPHI = DLANGL(P(NIPH,1),P(NIPH,2))
            call DUDBRB(0,0,0.D0,-sphi,0.d0,0.d0,0.d0)
            STHETA = DLANGL(P(NIPH,3),P(NIPH,1))
            call DUDBRB(0,0,-STHETA,0.D0,0.d0,0.d0,0.d0)
            P(N+1,1) = 0.D0
            P(N+1,2) = 0.D0
            P(N+1,3) = XP1*P(NIPH,3)
            P(N+1,4) = XP1*(P(NIPH,4)*P(2,4)-P(NIPH,3)*P(2,3))/
     +                 (P(2,4)-P(2,3))
            P(N+1,3) = P(N+1,4)
            P(N,1)= P(1,1) - P(N+1,1)- P(3,1)
            P(N,2)= P(1,2) - P(N+1,2)- P(3,2)
            P(N,3)= P(1,3) - P(N+1,3)- P(3,3)
            P(N,4)= P(1,4) - P(N+1,4)- P(3,4)
            P(N,5)= DSQRT(DABS(P(N,1)**2+P(N,2)**2+P(N,3)**2-P(N,4)**2))
            N = N + 1
c            call dulist(1)
            call DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
            call DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
            CALL DUDBRB(0,N,0.D0,0.D0,DBGAM(1)/DBGAM(4),DBGAM(2)/
     +      DBGAM(4), DBGAM(3)/DBGAM(4))
c            call dulist(1)
c            pause
         ENDIF
C IF 1ST INCOMING PARTICLE IS A PHOTON
      ELSEIF(IABS(IP1).EQ.22.AND.IRES(1).EQ.0) THEN
C...      4 VECTOR OF (REAL) PHOTON IN CMS SYSTEM
         N=N+1
         K(N,1)=21
         K(N,2)=KPH
         K(N,3)=IFL
         P(N,1)= P(1,1)
         P(N,2)= P(1,2)
         P(N,3)= P(1,3)
         P(N,4)= P(1,4)
         P(N,5)=DBLE(ULMASS(KPH))
         NIA1 = N
         NIR1 = -99999
         YVAL = 1.D0
         WEIGHT = 1.D0
      ELSEIF(IABS(IP1).EQ.22.AND.IRES(1).EQ.1) THEN
         WEIGHT = 1.0D0
         YVAL = 1.0D0

C         XG1 = X_GLUON OF THE PHOTON = E_GLUON/E_ELECTRON
C         YX  = E_PHOTON/E_ELECTRON
C         XP1 = E_GLUON/E_PHOTON
         XP1=XG1/YX
C...      PPH = NOW 4 VECTOR OF HADR COMP OF PHOTON IN EP CMS SYSTEM
         N = N + 1
         K(N+1,1)=21
         K(N+1,2)=21
         K(N+1,3)=IFL
         P(N+1,1)= P(N-1,1)*XP1
         P(N+1,2)= P(N-1,2)*XP1
         P(N+1,3)= P(N-1,3)*XP1
cccc            P(N+1,4)= DABS(P(N-1,3))*XP1
         P(N+1,4)= DABS(P(N-1,4))*XP1
         P(N+1,5)= DBLE(ULMASS(21))
         NIA1 = N+1
C...      PHA = NOW 4 VECTOR OF PHOTON REMNANT  IN EP CMS SYSTEM
         K(N,1)=1
         K(N,2)=21
         K(N,3)=IFL
         P(N,1)= P(1,1) - P(N+1,1)- P(3,1)
         P(N,2)= P(1,2) - P(N+1,2)- P(3,2)
         P(N,3)= P(1,3) - P(N+1,3)- P(3,3)
         P(N,5)= DBLE(ULMASS(21))
         P(N,4)= DSQRT(P(N,1)**2+P(N,2)**2+P(N,3)**2+P(N,5)**2)
         P(N+1,4)= P(1,4) - P(3,4) - P(N,4)
         NIR1 = N
         N = N + 1
c            write(6,*) ' parti yx,xg1,xp1',yx,xg1,xp1
c            call dulist(1)
      ENDIF
      RETURN
   30 write(6,*) ' PARTI boost error '
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.26  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  16.22.33  by  Hannes Jung
*CMZ :  2.07/03 16/05/99  11.39.23  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE PHASE(NP,ET,XM,PCM,WT)
c to generate n-body phase space
c taken from: Collider Physics
c             V.D. Barger and R.J.N Phillips
c             Adison-Wesley Publishing Company, Inc.
c             1987
	Implicit none
	Integer NP
	Double Precision ET,XM,PCM,WT
	Integer N
	Double Precision WPS,PIE,M,MT,MS,P,K
      COMMON/KIN/ WPS,PIE,M(10),MT(10),MS(10),P(10,4),K(10,4),N
      DIMENSION XM(18),PCM(4,18)
	Integer I,J,Jmax
      N=NP
      PIE=4.D0*DATAN(1.D0)
      WPS=0.D0
      DO 10 I=1,N
         M(I)=0.D0
         MT(I)=0.D0
         MS(I)=0.D0
         DO 10 J=1,4
            K(I,J)=0.D0
            P(I,J)=0.D0
   10 CONTINUE
      DO 20 I=1,N
         M(I)=XM(I)
   20 CONTINUE
      K(1,1)=ET
      MT(1) =ET
      DO 30 I=1,N
   30 MS(1) = MS(1) + M(I)
      CALL ORDER
      JMAX = N - 1
      WPS = JMAX*((MT(1)-MS(1))/(4.D0*PIE**2))**(N-2)/
     +      (4.D0*PIE*MT(1))
      DO 40 J =1,JMAX
         WPS = WPS/J
         MS(J+1) = MS(J) - M(J)
         CALL GEN(J)
   40 CALL BOO(J)
      DO 50 J=1,N
         PCM(1,J) = P(J,2)
         PCM(2,J) = P(J,3)
         PCM(3,J) = P(J,4)
         PCM(4,J) = P(J,1)
   50 CONTINUE
      if(p(1,2).ne.p(1,2)) write(6,*) ' error in phase'
      WT=WPS*(2.D0*PIE)**(3*N-4)
      RETURN
      END
      SUBROUTINE GEN(I)
      IMPLICIT None
	Integer N
	Double Precision WPS,PIE,M,MT,MS,P,K
      COMMON/KIN/ WPS,PIE,M(10),MT(10),MS(10),P(10,4),K(10,4),N
	Double Precision X,AALAM
      COMMON/XVAR/ X(10)
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEND.
      Double Precision PSQ,EI,PI,COST,COSTM,SINT,PHI
      Integer I
      IF(I.EQ.N-1) THEN
         MT(I+1) = M(N)
      ELSE
         MT(I+1) = MS(I+1) + (MT(1)-MS(1))*X(3*I)
      ENDIF
      PSQ = AALAM(MT(I)**2,M(I)**2,MT(I+1)**2)/(4.D0*MT(I)**2)
      IF(PSQ.LT.0.0D0) WRITE(6,*) 'PSQ.LT.0 ',PSQ
      IF(PSQ.LT.0.0D0) PSQ=0.D0
      EI = DSQRT(PSQ+M(I)**2)
      PI = DSQRT(PSQ)
      COST = 1.D0-2.D0*X(3*I-1)
      IF(IPRO.EQ.21.OR.IPRO.EQ.20) THEN
      ELSE
c new check limits on PT2CUT --> make limits on cost
         if(pi**2.lt.pt2cut(ipro)) then
c         write(6,*) 'gen pi**2,pt2cut,ipro',pi**2,pt2cut(ipro),ipro
            wps = 0.d0
            return
         endif
         costm = dsqrt(1.d0 - pt2cut(ipro)/pi**2)
         cost = costm - 2.d0*X(3*I-1)*costm
c      write(6,*) 'gen: pi,ipro',pi,ipro
c      write(6,*) 'gen pt2cut,costm,cost',pt2cut(ipro),costm,cost,ipro
c new weight because of restricted phase space
         wps = wps*costm
      ENDIF
c end new
      SINT = DSQRT(1.D0-COST**2)
c new try for 1/pt**2 weighting (1/sin**2 )
cnew      SINT2 = X(3*I-1)
cnew      SINT = DSQRT(SINT2)
cnew      COST = DSQRT(1.D0 - SINT2)
cnew      IF(draprn().GT.0.5) COST = - COST
c      write(6,*) ' gen sin cos ',sint,cost
c end new
      PHI = 2.D0*PIE*X(3*I-2)
      P(I,1) = EI
      P(I,2) = PI*SINT*DSIN(PHI)
      P(I,3) = PI*SINT*DCOS(PHI)
c      write(6,*) ' GEN: PT**2 ',P(I,2)**2+P(I,3)**2,I
      P(I,4) = PI*COST
      if(p(I,2).ne.p(i,2)) then
         write(6,*) '  error in gen '
         write(6,*) ' pi,sint,phi ',pi,sint,phi,X(3*I-2),X(3*I-1)
      endif
      WPS = WPS*PI
      RETURN
      END
      SUBROUTINE ORDER
      IMPLICIT None
	Integer N
	Double Precision WPS,PIE,M,MT,MS,P,K	
      COMMON/KIN/ WPS,PIE,M(10),MT(10),MS(10),P(10,4),K(10,4),N
      IF(N.LE.3) RETURN
      WRITE(6,*) ' N .GT. 3; N = ',N
      STOP
      END
      SUBROUTINE BOO(I)
      IMPLICIT None
	Integer N
	Double Precision WPS,PIE,M,MT,MS,P,K	
      COMMON/KIN/ WPS,PIE,M(10),MT(10),MS(10),P(10,4),K(10,4),N
	Integer I,J
	Double Precision BG1,G1,BG2,G2,BG3,G3,E,X,Z,Y
      BG1 = K(I,2)/MT(I)
      G1 = DSQRT(1.D0 + BG1**2)
      BG2 = K(I,3)/(MT(I)*G1)
      G2 = DSQRT(1.D0 + BG2**2)
      BG3 = K(I,4)/(MT(I)*G1*G2)
      G3 = DSQRT(1.D0 + BG3**2)
      E = G1*G2*G3*P(I,1) + BG1*G2*G3*P(I,2)
     +    + BG2*G3*P(I,3) + BG3*P(I,4)
      X = BG1*P(I,1) +G1*P(I,2)
      Y = BG2*G1*P(I,1) + BG2*BG1*P(I,2) +G2*P(I,3)
      Z = BG3*G2*G1*P(I,1) + BG3*G2*BG1*P(I,2)
     +    + BG3*BG2*P(I,3) +G3*P(I,4)
      P(I,1) = E
      P(I,2) = X
      P(I,3) = Y
      P(I,4) = Z
      IF(I.EQ.N-1) GOTO 20
      DO 10 J=1,4
   10 K(I+1,J) = K(I,J) - P(I,J)
C     WRITE(6,*) 'BOO ',(P(I,IK),IK=1,4)
      RETURN
   20 DO 30 J =1,4
   30 P(N,J) = K(I,J) - P(I,J)
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.26  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  16.24.13  by  Hannes Jung
*CMZ :  2.07/03 16/05/99  11.50.49  by  Hannes Jung
*-- Author :    Hannes Jung   22/01/95
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C---INTERFACE FOR CALLS OF PARTON DISTRIBUTIONS FROM HERACLES
C---TAKEN FROM PYSTFU (4.1.91) HS
C    changed for the use with pomeron structure function RASTFU
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      FUNCTION FUNX(XINT)
	Implicit None
      DOUBLE PRECISION T2MIN,T2,XR,MP,XP2T,XX,WTDIST,XMAX
      REAL XPQ(-6:6),draprn
      DOUBLE PRECISION WTTEST,T2MN,T2MAX1,WTPO
      DOUBLE PRECISION XMAXV,XMINV,VMIN,VMAX,SMALL
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEND.
	Integer KPART,IVM
      REAL SCALE
      COMMON/PINT/ SCALE,KPART
      DOUBLE PRECISION POM,PIM
      COMMON/WEIGHT1/ POM,PIM
      COMMON/VMESON/IVM
	Real FUNX,WGMAX,XINT,ULMASS
	Integer I,KF
      EXTERNAL ULMASS
      DATA MP/0.938/
      DATA SMALL/1.d-3/
      XMAX=1.d0-XF
      FUNX = 0.
C ... XP2 = E_glue /E_proton
C ... XX  = E_glue/E_pomeron
C ... XR  = E_pomeron/E_proton
ctest      XR = DBLE(XINT)
      XR = DBLE(XPR)*(XMAX/DBLE(XPR))**DBLE(XINT)
      IF(IVM.GE.1) THEN
         IF(IVM.GE.1.AND.IVM.LT.443) THEN
            VMAX = DBLE(1.020 + 2.*ULMASS(211))
            VMIN = DBLE(0.780 - 2.*ULMASS(211))
         ELSEIF(IVM.EQ.443) THEN
            VMAX = 2.D0*DBLE(ULMASS(421))
            VMIN = 2.D0*DBLE(ULMASS(4))
         ELSEIF(IVM.EQ.553) THEN
            VMAX = 2.D0*DBLE(ULMASS(521))
            VMIN = 2.D0*DBLE(ULMASS(5))
         ENDIF
         VMIN = VMIN+SMALL
         VMAX = VMAX-SMALL
c                  write(6,*) 'pomstr :',XMAX,XMIN
         XMAXV = DBLE(XPR)*(1 + VMAX**2/DBLE(SCALE))
         XMINV = DBLE(XPR)*(1 + VMIN**2/DBLE(SCALE))
c                  write(6,*) 'pomstr:',XMAXV,XMINV
         XR = XMINV*(XMAXV/XMINV)**DBLE(XINT)
         IF(XMAXV.GT.XMAX) RETURN
      ENDIF
      XP2T = DBLE(XPR)
      XX = XP2T/XR
      FUNX = 0.
      IF(XX.GE.0.99999) RETURN
      T2 = -99999.D0
      T2MIN=MP*MP*XR*XR/(1.d0-XR)
      T2MN = -(DBLE(SCALE) *(1.D0-XR/DBLE(XPR))
     +         +4.D0*DBLE(ULMASS(211))**2)
      IF(T2MN.LT.T2MAX) THEN
         T2MAX1 = T2MN
      ELSE
         T2MAX1 = T2MAX
      ENDIF

      T2 = T2MIN*((T2MAX1/T2MIN)**draprn())
c      write(6,*) ' FUNX: XR,XPR,XX',XR,XPR,XX
      IF(T2MIN.GE.T2MAX1) RETURN
      IF(XP2T.GE.XMAX) RETURN
      IF(XP2T.GE.XR) RETURN
c      write(6,*) ' pomstr ',NG,NPOM
      IF(NG.EQ.20.AND.NPOM.EQ.20) THEN
         KF=211
      ELSEIF(NG.EQ.21.AND.NPOM.EQ.21) THEN
         KF=111
      ELSE
         KF=100
      ENDIF
c      if(KF.EQ.211) THEN
c        write(6,*) ' FUNX: xx,XPR,XR ',XX,XPR,XR
c        write(6,*) ' FUNX: T2min = ',T2MIN,'T2MAX ',T2MAX
c        FUNX = 0
c        RETURN
c        endif
c      write(6,*) ' FUNX: XR,XP2T,T2mIN,T2',XR,XP2T,T2MIN,T2
c this is called to get maximum of differential pomeron distribution
      CALL RAT2DI(KF,XR,-T2,WTTEST)
      CALL RAT2IN(KF,XR,XP2T,T2MIN,-T2,WTDIST)
      IF(XX.GE.1.) THEN
         write(6,*) ' funx error ',xx,xr,xp2t
      endif
      CALL RASTFU(KF,SNGL(XX),SCALE,XPQ)
c      write(6,*) xpq(kpart),xpq(-kpart),kpart,SNGL(XX)
      FUNX = 0.
c       write(6,*) ' FUNX: WTDIST',WTDIST

      FUNX = XPQ(KPART)*SNGL(WTDIST)
      IF(IVM.EQ.0) THEN
         WTPO = T2*DLOG(T2MAX/T2MIN)*XR*DLOG(XMAX/XP2T)*WTTEST
         FUNX = FUNX * SNGL(XR) * ALOG(SNGL(XMAX)/XPR)
      ELSE
         FUNX = FUNX * SNGL(XR * DLOG(XMAXV/XMINV))
         WTPO = T2*DLOG(T2MAX/T2MIN)*XR*DLOG(XMAXV/XMINV)*WTTEST
      ENDIF
      WGMAX=0.
      DO 10  I=-6,6
         IF(I.EQ.0) GOTO 10
         WGMAX = MAX(WGMAX,XPQ(I))
   10 CONTINUE
      WTPO=WTPO*DBLE(WGMAX)
      IF(WTPO.GT.POM) THEN
         POM = WTPO
ccc         write(6,*) ' WTPO,xr,t2 ',WTPO,XR,T2
      ENDIF
      RETURN

      END
      FUNCTION FXT2(XINT,T2INT)
	Implicit None
      DOUBLE PRECISION T2MIN,T2,XR,MP,XP2T,XX,WTDIST,XMAX,WTPI
      REAL XPQ(-6:6),WGMAX
      DOUBLE PRECISION XMAXV,XMINV,VMIN,VMAX,SMALL
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEND.
	Real SCALE,ULMASS
	Integer KPART,IVM
      COMMON/PINT/ SCALE,KPART
      DOUBLE PRECISION POM,PIM
      COMMON/WEIGHT1/ POM,PIM
      COMMON/VMESON/IVM
	Integer I,KF
	Double Precision T2MAX1,T2MN
	Real FXT2,XINT,T2INT
      EXTERNAL ULMASS
      DATA MP/0.938/
      DATA SMALL/1.d-3/
      XMAX=1.d0-XF
C ... XP2 = E_glue /E_proton
C ... XX  = E_glue/E_pomeron
C ... XR  = E_pomeron/E_proton
c      XR = DBLE(XINT)
      FXT2 = 1.
c      write(6,*) NG,NPOM
      IF(NG.EQ.20.AND.NPOM.EQ.20) THEN
         KF=211
      ELSEIF(NG.EQ.21.AND.NPOM.EQ.21) THEN
         KF=111
      ELSE
         KF=100
      ENDIF
      XR = DBLE(XPR)*(XMAX/DBLE(XPR))**DBLE(XINT)
      FXT2 = SNGL(XR * DLOG(XMAX/DBLE(XPR)))
      IF(IVM.GE.1) THEN
         IF(IVM.GE.1.AND.IVM.LT.443) THEN
            VMAX = DBLE(1.020 + 2.*ULMASS(211))
            VMIN = DBLE(0.780 - 2.*ULMASS(211))
         ELSEIF(IVM.EQ.443) THEN
            VMAX = 2.D0*DBLE(ULMASS(421))
            VMIN = 2.D0*DBLE(ULMASS(4))
         ELSEIF(IVM.EQ.553) THEN
            VMAX = 2.D0*DBLE(ULMASS(521))
            VMIN = 2.D0*DBLE(ULMASS(5))
         ENDIF
         VMIN = VMIN+SMALL
         VMAX = VMAX-SMALL
c                  write(6,*) 'pomstr:',XMAX,XMIN
         XMAXV = DBLE(XPR)*(1 + VMAX**2/DBLE(SCALE))
         XMINV = DBLE(XPR)*(1 + VMIN**2/DBLE(SCALE))
c                  write(6,*) 'pomstr:',XMAX,XMIN
         XR = XMINV*(XMAXV/XMINV)**DBLE(XINT)
         FXT2 = SNGL(XR * DLOG(XMAXV/XMINV))
         IF(XMAXV.GT.XMAX) RETURN
      ENDIF
      T2MN = -(DBLE(SCALE) *(1.D0-XR/DBLE(XPR))
     +         +4.D0*DBLE(ULMASS(211))**2)
      IF(T2MN.LT.T2MAX) THEN
         T2MAX1 = T2MN
      ELSE
         T2MAX1 = T2MAX
      ENDIF

      T2MIN=MP*MP*XR*XR/(1.d0-XR)
      T2 = T2MIN*((T2MAX1/T2MIN)**DBLE(T2INT))
c      write(6,*) ' FXT2 : T2,T2MAX,T2MIN,T2INT ',T2,T2MAX,T2MIN,T2INT
c      T2 = DBLE(T2INT)
      XP2T = DBLE(XPR)
      XX = XP2T/XR

      IF(T2MIN.GE.T2MAX1) THEN
c          write(6,*) ' T2MIN = ',T2MIN,' T2MAX ',T2MAX
         FXT2 = 0.0
         RETURN
      ENDIF
      IF(XP2T.GE.XMAX) THEN
         FXT2 = 0.0
         RETURN
      ENDIF

      if(XR.Le.0.0) THEN
         write(6,*) ' FXT2: xx,XPR,XR ',XX,XPR,XR
         write(6,*) ' FXT2: T2min = ',T2MIN,'T2MAX ',T2MAX
c        FUNX = 0
c        RETURN
      endif
      T2GKI = SNGL(-T2)
      XFGKI = SNGL(XR)
      CALL RAT2DI(KF,XR,-T2,WTDIST)
      CALL RASTFU(KF,SNGL(XX),SCALE,XPQ)

c      write(6,*) ' FXT2: WTDIST =',wtdist
c      write(6,*) 'FXT2 ',xpq(kpart),xpq(-kpart),kpart,xx,scale
      FXT2= FXT2 * SNGL(WTDIST)
      FXT2 = FXT2 * SNGL(T2 * DLOG(T2MAX1/T2MIN))
      IF(IVM.EQ.0) THEN
         WTPI = WTDIST*T2*DLOG(T2MAX1/T2MIN)*XR*DLOG(XMAX/XP2T)
      ELSE
         WTPI = WTDIST*T2*DLOG(T2MAX1/T2MIN)*XR*DLOG(XMAXV/XMINV)
      ENDIF
ctest      WTPI = WTDIST*T2*XR
      IF((NG.GE.30.AND.NG.LT.100).OR.(NG.LT.0.AND.NPOM.LT.0)) THEN
         WGMAX=0.
         DO 10  I=-6,6
            IF(I.EQ.0) GOTO 10
            WGMAX = MAX(WGMAX,XPQ(I))
   10    CONTINUE
         WTPI = WTPI*DBLE(WGMAX)
         IF(WTPI.GT.POM) POM=WTPI
      ELSE
         IF(WTPI.GT.PIM) PIM=WTPI
      ENDIF
      FXT2 = FXT2 * XPQ(KPART)

c      write(6,*) ' FXT2: FXT2 = ',FXT2
      RETURN
      END
      FUNCTION FLOW(XR)
      FLOW = 0.
      RETURN
      END
      FUNCTION FUP(XR)
      FUP = 1.
      RETURN
      END
      SUBROUTINE RAT2IN(KF,XR,XP2,T2MIN,T2,WTDIST)
	Implicit None
c give t distribution in proton
C KF = 100 for pomeron
C KF = 211 for pi
C XR = fractional energy of pomeron
C XP2 = fractional energy of parton to hard interaction
C T2 = t = (p - p')**2 < 0
C WTDIST = weight of distribution
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.

*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEND.
      INTEGER KF
      DOUBLE PRECISION T2,XR,XP2,T2MIN,WTDIST,MP,XE,XMAX,T2CH,beta02
      LOGICAL FIRST

      DATA MP/0.938D0/,FIRST/.TRUE./
      DATA beta02/58.74D0/
      XMAX=1.d0-XF

      WTDIST = 0.D0
c      write(6,*) 'RAT2IN: XR,XP2,T2MIN,T2',XR,XP2,T2MIN,T2
      IF(NPOM.EQ.0) THEN
         IF(FIRST) THEN
            write(6,*) ' streng pomeron is used'
            FIRST = .FALSE.
         ENDIF
c pomeron distribution from streng (hera proc. 1987)
         XE=2.D0*ALPHP*DLOG(1.d0/XR)+RN2
         T2CH = T2MAX
         IF(XE*T2MIN.GT.170.D0) THEN
c                      WRITE(6,*) 'XE..',XE,DEXP(-XE)
            GOTO 10
         ENDIF
         IF(XE*T2MAX.GT.170.D0) T2CH = 100.D0/XE
c         write(6,*) ' XE ',xe,' XR ',XR
c         write(6,*) 'T2MAX ',T2MAX,' T2MIN ',T2MIN
         WTDIST = DEXP(-XE*T2MIN)-DEXP(-XE*T2CH)
c         write(6,*) WTDIST
         WTDIST = WTDIST/XE
         WTDIST = WTDIST*beta02/XR**(1.D0 + 2.D0 * EPSP) /16.d0/PI
         IF(DABS(WTDIST).LT.1.D-20) GOTO 10
      ELSEIF(NPOM.EQ.1) THEN
         IF(FIRST) THEN
            write(6,*) ' Ingelman pomeron is used'
            FIRST = .FALSE.
         ENDIF
c test with Ingelman f_pom distribution
         T2CH = T2MAX
         IF(8.D0*T2MAX.GT.170.D0) T2CH = 170.D0/8.D0
         WTDIST = 6.38D0/8.D0*(DEXP(-8.D0*T2MIN) - DEXP(-8.D0*T2CH))
         WTDIST = WTDIST+ 0.424D0/8.D0*(DEXP(-3*T2MIN) - DEXP(-3*T2CH))
         WTDIST = WTDIST/XR/2.3D0
c end Ingelman
      ELSE
         write(6,*) ' RAT2IN: pomeron distribution ',NPOM,
     +       ' not implemented'
         write(6,*) ' RAT2IN: program stops '
         stop
      ENDIF
      RETURN
   10 WTDIST = 0.D0
      RETURN
      END
*CMZ :  2.08/01 23/06/99  07.03.33  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  16.26.59  by  Hannes Jung
*CMZ :  2.07/03 16/05/99  12.09.03  by  Hannes Jung
*-- Author :    Hannes Jung   28/02/97

      FUNCTION PQCD(X1,Y1)
      Implicit None
      REAL X1,Y1,PQCD
      Double Precision XV,WMAX
      Integer NDIMEN,IMIX
      COMMON /XVAL/ XV(20),NDIMEN
      COMMON /OALPHAS/ WMAX,IMIX
      Integer ID
      double precision xpom
      COMMON /PQPMID/xpom,ID
*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEND.
      Double Precision G1,G2,GA,GB,gff,G3,GC
      DIMENSION G1(2),G2(2),GA(2),GB(2)
      DIMENSION gff(4)
      Double Precision H11,H12,H21,H22,H41,H14,H24,H34,H61
      Double Precision ksiw,sg,xg,mf,mfp,lamd,f,g,m2plus,m2minus,m0
      Double Precision Vff,deltal,rho
      Double Precision GEV2NB,ALPH_EM,GF,Y,X,SMIN,CHIMIN,XPMIN,XPMAX
      Double Precision xp,sh,zq,zqmin,zqmax,gam2,PT2,SCAL,t,at
      Double Precision sig0t,sig0s,sigi,sig,sig0,wtg,sum,comfac
      Double Precision xq,wtq,QF2,XOLD
      Double Precision ALPHA_S,ALPHAS
      Integer I,LUCHGE
      REAL XPQ(-6:6)
      REAL SNGL
      DATA GEV2NB/.3893857D+6/
      PQCD = 0.0
      ALPH_EM = ALPH
      IF(IRUNAEM.EQ.1) ALPH_EM = DBLE(ULALEM(SNGL(Q2)))
      GF = pi*alph_em/sin2w/dsqrt(2.d0)/xmw2
      Y = DBLE(YY)
      X = Q2/Y/SSS
      IF(IPRO.NE.14) THEN
         AM(1) = 0.D0
         AM(2) = 0.D0
      ENDIF
      SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
c            write(6,*) ' pqcd  ',x,xpom,id,ipro
      IF(ID.EQ.1) THEN
      ELSE
         XOLD=X
         X=XOLD/XPOM
         IF(X.LT.1.and.X.gt.0.) THEN
c            write(6,*) ' pqcd beta found ',xold,xpom,x
         ELSE
            RETURN
         ENDIF
      ENDIF
cc      CHIMIN=(SMIN+Q2)/(Y*SSS)
      CHIMIN=(1.+SMIN/Q2)*X
      CHIMIN = DMAX1(CHIMIN,X)
      XPMIN = X
      XPMAX = X/CHIMIN
      if(xpmax.lt.xpmin) then
c         write(6,*) 'pqcd: xpmax<xpmin : goto 30'
         goto 30
      endif
      IF(XPMIN.EQ.0.0D0) THEN
         write(6,*) ' PQCD XPMIN CHIMIN,X ',CHIMIN,X,IPRO,AM(1)
         write(6,*) ' PQCD PT2CUT,Y,Q2 ',PT2CUT(IPRO),Y,Q2
      ENDIF
      XP = XPMIN * (XPMAX/XPMIN)**DBLE(X1)
      sh = Q2/xp*(1.d0 -xp)
      IF(IPRO.NE.14) THEN
         ZQMIN = 0.5D0 - DSQRT(0.25D0 - PT2CUT(IPRO)*XP/Q2/(1.D0-XP))
         IF(ZQMIN.GT.0.5D0) THEN
c         write(6,*) 'pqcd: ZQMIN > 0.5 : goto 30'
            GOTO 30
         ENDIF
         ZQMAX = 1.D0 - ZQMIN
      ELSE
         xg = x/xp
         sg = xg*sss
         mf=AM(1)
         mfp=AM(2)
         gam2 = sg*y*(1.d0-xp) + mf**2 - mfp**2
         lamd = (sg*y*(1.d0-xp) - mf**2 - mfp**2)**2 - 4.d0*mf**2*mfp**2
         zqmax = (gam2 + dsqrt(lamd))/sh/2.d0
         zqmin = (gam2 - dsqrt(lamd))/sh/2.d0
      ENDIF
c generate zq and 1-zq pole

      zq = zqmin*(zqmax/zqmin)**dble(y1)
      zq = zqmax/zqmin *(zqmin/zqmax)**(2.d0*dble(y1)) + 1
      zq = 1.d0/zq
      PT2 = sh*zq*(1.d0-zq)
      IF(IQ2.EQ.2) THEN
         SCAL = SH
      ELSEIF(IQ2.EQ.3) THEN
         SCAL = (2.D0*AM(1))**2 + PT2
      ELSEIF(IQ2.EQ.4) THEN
         SCAL = Q2
      ELSEIF(IQ2.EQ.5) THEN
         SCAL = Q2 + PT2 + (2.D0*AM(1))**2
c this is for testing
      ELSEIF(IQ2.EQ.6) THEN
C kt**2 as from Zeppenfeld/Mirkes
         t = -zq*Q2/xp
         at=DSQRT((t+Q2)**2+4.D0*Q2*PT2)
         SCAL = at*(at+t+Q2)/2.D0/Q2
c         write(6,*) 'pqcd : t,PT2,Q2,Q2Q ',t,PT2,Q2,Q2Q
      ELSEIF(IQ2.EQ.7) THEN
c torbjorn suggestion
         SCAL = PT2 + 8.D0*PT2**2/SH

      ELSE
         write(6,*) ' PQCD: IQ2 = ',IQ2
         WRITE(6,*) ' PQCD: NO VALID Q2 SCALE. STOP'
         STOP
      ENDIF
      IF(IQ2.EQ.5) THEN
         SCAL = Q2 + PT2*SCALFA + (2.D0*AM(1))**2
      ELSE
         SCAL = SCALFA*SCAL
      ENDIF
      ALPHA_S=ALPHAS(DSQRT(SCAL))

      IF(IPRO.EQ.13) THEN
         XG = X/XP
         sig0t = ALPHA_s/4.D0/pi/(1.D0-zq)/zq*
     +   (xp**2+(1.D0-xp)**2)*(zq**2+(1.d0-zq)**2)
         sig0s =  ALPHA_S/4.D0/pi*8.D0*xp*(1.D0-xp)
         sigi = 0.D0
         IF(INTER.EQ.2) THEN
            sigi = 0.D0
         ENDIF
         sig0 = 0.5D0*(1.D0+(1.D0-y)**2)*sig0t + (1.D0-y)*sig0s -
     +          ISIGN(1,K(1,2))*y*(1.D0 -0.5D0*y)*sigi
c including phase space factors
         sig = sig0*4.D0*pi*alph_em**2 /y/Q2/Q2
         if(xg.gt.1.) write(6,*) ' pqcd xg>1 ',xg,ipro,x,xp
         IF(ID.EQ.1) THEN
            CALL PYSTFU(2212,SNGL(XG),SNGL(SCAL),XPQ)
         ELSE
            CALL RASTFU(KINT(2,2),SNGL(XG),SNGL(SCAL),XPQ)
         ENDIF
         wtg = DBLE(XPQ(0))
         sig = sig * wtg
c include charges for 3 flavours
         IF(INTER.LT.2) THEN
            sig = sig *2.D0/3.D0
         ELSEIF(INTER.EQ.2) THEN
            sig = sig  * GF**2 * Q2 *Q2/8.D0/pi**2/alph_em**2/(1.d0
     +      + Q2/XMW2)**2
         ENDIF
      ELSEIF(IPRO.EQ.14) THEN
         sig = 0.0d0
         xg = x/xp
         sg = xg*sss
         m2plus = (mf**2 + mfp**2)/y/sg
         m2minus = (mf**2 - mfp**2)/y/sg
         m0 = mf*mfp/y/sg
c         write(6,*) mf,mfp,m0,m2minus,m2plus
c............
         f = (1.D0-xp)*zq*(1.D0-zq) + (zq*(mf**2 - mfp**2) - mf**2)/y/
     +   sg
         g = (1.D0-xp)*(1.D0-zq) + xp*zq + m2minus
         if(f*xp.le.0.) then
c         write(6,*) 'pqcd f,xp,zq,mf**2/y/sg',f,xp,zq,mf**2/y/sg
            return
         endif
         H11 = 4.D0/zq/(1.D0-zq)*(2.D0*zq*(1.D0-zq) + 2.D0*xp*(1.D0-xp)
     +   -1.D0) + 4.D0/zq**2/(1.D0-zq)**2 *(-m2plus**2 + m2plus*
     +   m2minus* (2.D0*zq-1.D0) + m2plus*(2.D0*zq*(zq-1.D0)*(xp-1.D0)
     +   -xp) + m2minus*xp*(2.D0*zq-1.D0))
         H21 = 16.D0*(xp/zq/(1.D0-zq) + (m2plus + (1.D0-zq)*m2minus)/
     +   zq**2/(1D0-zq))
         H41 = 32D0*xp/zq/(1.D0-zq) + 16.D0/zq**2/(1.D0-zq)**2 *
     +   (m2plus + (1.D0-2.D0*zq)*m2minus)
         H61 = - 32.D0*xp/zq/(1.D0-zq) - 32.D0/zq**2/(1.D0-zq) *
     +   (m2plus + (1.D0-zq)*m2minus)
         H12 = - 16D0* m0 *(1.D0-xp)/zq/(1.D0-zq) + 8.D0*m0/zq**2/
     +   (1.D0-zq)**2 * (m2plus + (1.D0-2.D0*zq)*m2minus)
         H22 = - 32.D0*m0/zq/(1.D0-zq)
         H14 = - 8.D0/zq**2/(1.D0-zq)*(-zq**2+zq*xp+m2plus+ (1.D0-zq)*
     +   m2minus)
         H24 = 0.D0
         H34 = 8.D0*(1.D0-2.D0*xp)/zq/(1.D0-zq) - 8.D0*(m2plus+(1.D0-
     +   2.D0*zq)*m2minus)/zq**2/(1.D0-zq)**2
         G1(1) = -2.D0*H11 + f*H41
         G2(1) = 2.D0*xp*f*H41 + H21 + g*(H61 + g * H41)
         GA(1) = DSQRT(xp*f) * (H61 + 2.D0*g*H41)
         GB(1) = f * H41
         G1(2) = - 2.D0* H12
         G2(2) = H22
         GA(2) = 0.d0
         GB(2) = 0.d0
         G3 = H14 + zq*H24 -g*H34
         GC = DSQRT(xp*f)*(H24 - 2.D0*xp*H34)
         IF(INTER.EQ.0) THEN
            IF(AM(1).LT.2.D0) qf2=4.d0/9.d0
            IF(AM(1).GE.2.D0) qf2=1.d0/9.d0
            gff(1) = QF2
            gff(2) = QF2
            gff(4) = 0.D0
            deltal = 0.5d0
         ELSEIF(INTER.EQ.2) THEN
            Vff = 1.d0
            ksiw = 1.D0/(SIN2W*8.D0)*Q2**2/XMW2**2/(1.D0 + Q2/XMW2)**2
            rho = 0.d0
            gff(1) = 4.D0*Vff**2*ksiw**2*(1.D0-ISIGN(1,K(1,2))*rho)
            gff(2) = 0.d0
            gff(4) = 4.D0*Vff**2*ksiw**2*(ISIGN(1,K(1,2)) - rho)
            deltal = 1.d0
         ENDIF
         SUM = gff(1)*(xp*y**2*G1(1) + (1.D0 - y)*G2(1)) +gff(2)
     +   *(xp*y**2*G1(2) + (1.D0 - y)*G2(2)) +gff(4)*(xp*y*(2.D0-y)*G3)
c for charged current xf_3 is still missing
         comfac = ALPHA_S* deltal*2.D0*alph_em**2/y/q2/q2/ 16.D0
         sig = comfac*sum
c including phase space factors
         sig=sig/xp
         if(xg.gt.1.) write(6,*) ' pqcdi xg>1 ',xg,ipro,x,xp
         IF(ID.EQ.1) THEN
            CALL PYSTFU(2212,SNGL(XG),SNGL(SCAL),XPQ)
         ELSE
            CALL RASTFU(KINT(2,2),SNGL(XG),SNGL(SCAL),XPQ)
         ENDIF
         wtg = dble(XPQ(0))
         sig = sig * wtg
      ELSEIF(IPRO.EQ.15) THEN
         sig0t = 2.d0*ALPHA_S/3.d0/pi*(
     +   (zq**2 + xp**2)/(1.d0-xp)/(1.d0-zq) +
     +    2.d0*(xp*zq + 1.d0))
         sig0s = 2.d0*ALPHA_S/3.d0/pi*4.d0*xp*zq
         sigi = 0.D0
         IF(INTER.EQ.2) THEN
            sigi = 2.d0*ALPHA_S/3.d0/pi*(1.d0/(1.d0-xp)/(1.d0-zq)*
     +   (xp**2 + xp**2)+2.d0*(xp+zq))
         ENDIF

         XQ=X/XP
         if(xg.gt.1.) write(6,*) ' pqcd xq>1 ',xq,ipro,x,xp
         IF(ID.EQ.1) THEN
            CALL PYSTFU(2212,SNGL(XQ),SNGL(SCAL),XPQ)
         ELSE
            CALL RASTFU(KINT(2,2),SNGL(XQ),SNGL(SCAL),XPQ)
         ENDIF
         wtq = 0.D0
         IF(INTER.LT.2) THEN
            do 10 I = -NFLQCDC,NFLQCDC
   10       wtq = wtq + DBLE(XPQ(I))*DFLOAT(LUCHGE(I))**2/9.D0
            sig0 = 0.5d0*(1.d0+(1.d0-y)**2)*sig0t + (1.d0-y)*sig0s -
     +      ISIGN(1,K(1,2))*y*(1.D0 -0.5D0*y)*sigi
c including phase space factors
            sig = sig0*4.d0*pi*alph_em**2 /y/Q2/Q2
            sig = sig * wtq
         ELSEIF(INTER.EQ.2) THEN
            sig0 = 0.d0
            DO 20  I=1,NFLAV-1,2
c take only contribution from light quarks
               IF(I.GE.3) GOTO 20
               IF(ISIGN(1,K(1,2)).EQ.1) THEN
                  sig0 = sig0 + 0.5d0*(1.d0+(1.d0-y)**2) *sig0t*
     +            DBLE(XPQ(-I)+XPQ(I+1)) + (1.d0-y)*sig0s*DBLE(XPQ(-
     +            I)+XPQ(I+1)) + ISIGN(1,K(1,2))*y*(1.D0 -0.5D0*y)*
     +            sigi* DBLE(-XPQ(-I)+XPQ(I+1))
               ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                  sig0 = sig0 + 0.5d0*(1.d0+(1.d0-y)**2) *sig0t*
     +            DBLE(XPQ(I)+XPQ(-I-1)) + (1.d0-y)*sig0s*
     +            DBLE(XPQ(I)+XPQ(-I-1)) - ISIGN(1,K(1,2))*y*(1.D0 -
     +            0.5D0*y)*sigi* DBLE(XPQ(I)-XPQ(-I-1))
               ENDIF

   20       CONTINUE
c including phase space factors
            sig = sig0*4.d0*pi*alph_em**2 /y/Q2/Q2
            sig = sig * GF**2 * Q2 *Q2/8.D0/pi**2/alph_em**2/(1.d0 + Q2/
     +      XMW2)**2
c additional factor 0.5 for handiness of electron
            sig = 0.5D0 * sig
         ENDIF
      ELSE
         write(6,*) ' PQCD process not implemented: IPRO = ',IPRO
      ENDIF
      if(x1.gt.1..or.x1.lt.0.) THEN
         write(6,*) 'PQCD: x1 = ',x1,IPRO,PT2CUT(IPRO),AM(1)
      endif

cccc      PQCD = SNGL(SIG*GEV2NB*XP*LOG(XPMAX/XPMIN)*ZQ*LOG(ZQMAX/ZQMIN))
c use (1-zq) instead of zq because we switched to 1-zq
c      PQCD=SNGL(SIG*GEV2NB*XP*LOG(XPMAX/XPMIN)*(1.-ZQ)*LOG(ZQMAX/ZQMIN))
      PQCD=SNGL(SIG*GEV2NB*XP*LOG(XPMAX/XPMIN)*(1.D0-ZQ)*ZQ*
     +   2.D0*LOG(ZQMAX/ZQMIN))
c       write(6,*) ' pqcd ',ipro,sig,pqcd
      RETURN
   30 CONTINUE
      PQCD = 0.0
c       write(6,*) ' pqcd =0',ipro,sig,pqcd
      END
*CMZ :  2.08/01 23/06/99  06.42.59  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  16.29.14  by  Hannes Jung
*CMZ :  2.07/03 23/05/99  13.49.18  by  Hannes Jung
*-- Author : Hannes Jung

      FUNCTION PQCDI(X1)
	Implicit None
      REAL X1,PQCDI
	Double Precision XV,WMAX
	Integer NDIMEN,IMIX
      COMMON /XVAL/ XV(20),NDIMEN
      COMMON /OALPHAS/ WMAX,IMIX
      Integer ID
      double precision xpom
      COMMON /PQPMID/xpom,ID
*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEND.
      REAL XPQ(-6:6)
      REAL SNGL
	Double Precision GEV2NB,ALPH_EM,GF,Y,X,SMIN,CHIMIN,XPMIN,XPMAX
	Double Precision XP,ZQMIN,ZQMAX,XKSI,BETA,BETA2,ZLOG,SH,SCAL
	Double Precision ALPHA_S,ALPHAS
	Double Precision XG,sig0t,sig0s,sigi,sig0,sig,xt,xl,f2,fl,comfac
	Double Precision XQ,wtq,wtg,XOLD
	Integer I,LUCHGE
      DATA GEV2NB/.3893857D+6/
      PQCDI = 0.0
      ALPH_EM = ALPH
      IF(IRUNAEM.EQ.1) ALPH_EM = DBLE(ULALEM(SNGL(Q2)))
      GF = pi*alph_em/sin2w/dsqrt(2.d0)/xmw2
      Y = DBLE(YY)
      X = Q2/Y/SSS
c      write(6,*) ' pqcdi ',x,y,q2,sss
c      write(6,*) 'PQCDI ',x1
      IF(IPRO.NE.14) THEN
         AM(1) = 0.D0
         AM(2) = 0.D0
      ENDIF
      SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
      IF(ID.EQ.1) THEN
      ELSE
         XOLD=X
         X=XOLD/XPOM
         IF(X.LT.1.and.X.gt.0.) THEN
c            write(6,*) ' pqcd beta found ',xold,xpom,x
         ELSE
            RETURN
         ENDIF
      ENDIF
cc      CHIMIN=(SMIN+Q2)/(Y*SSS)
      CHIMIN=(1.+SMIN/Q2)*X
      CHIMIN = DMAX1(CHIMIN,X)
      XPMIN = X
      XPMAX = X/CHIMIN
      if(xpmax.lt.xpmin) then
c       write(6,*) ' pqcdi ',xpmax,xpmin
c       write(6,*) ' pqcdi ',am(1),am(2),PT2CUT(IPRO),IPRO
c        write(6,*) ' PQCDI: CHIMIN,XPMIN,XPMAX',CHIMIN,XPMIN,XPMAX
         goto 30
      endif
      IF(XPMIN.EQ.0.0D0) THEN
         write(6,*) ' PQCDI XPMIN CHIMIN,X ',CHIMIN,X,IPRO,AM(1)
         write(6,*) ' PQCDI PT2CUT,Y,Q2 ',PT2CUT(IPRO),Y,Q2
      ENDIF
      XP = XPMIN * (XPMAX/XPMIN)**DBLE(X1)
      IF(IPRO.NE.14) THEN
         ZQMIN = 0.5D0 - DSQRT(0.25D0 - PT2CUT(IPRO)*XP/Q2/(1.D0-XP))
         IF(ZQMIN.GT.0.5D0) GOTO 30
         ZQMAX = 1.D0 - ZQMIN
         xksi = 0.D0
         beta =  2.d0*zqmax - 1.d0
      ELSE
         IF((4.d0*am(1)**2*xp/Q2/(1.d0-xp)).GE.1.d0) GOTO 30
         beta2 = 1.d0 - 4.d0*am(1)**2*xp/Q2/(1.d0-xp)
         beta = sqrt(beta2)
         ZQMAX = 1.d0 + beta
         ZQMIN = 1.d0 - beta
         xksi = am(1)**2/q2
c         IF(ZQMIN.GT.0.5) GOTO 123
c         write(6,*) ' pqcdi beta,zqmax,zqmin',beta,zqmax,zqmin
      ENDIF
      zlog = log(zqmax/zqmin)
      sh = Q2/xp*(1.d0 -xp)
	IF(IQ2.EQ.1.AND.AM(1).GT.1.D0) THEN
	   SCAL = 4.D0*AM(1)**2
      ELSEIF(IQ2.EQ.2) THEN
         SCAL = SH
      ELSEIF(IQ2.EQ.4) THEN
         SCAL =4.D0*AM(1)**2 + Q2
      ELSE
         WRITE(6,*) 'PQCD: NO VALID Q2 SCALE. STOP'
	   WRITE(6,*) ' IQ2 = ',IQ2,' mass = ',AM(1)
         STOP
      ENDIF
      SCAL = SCALFA*SCAL
      ALPHA_S=ALPHAS(DSQRT(SCAL))

      IF(IPRO.EQ.13) THEN
         XG = X/XP
         sig0t = ALPHA_s/4.D0/pi/(1.D0-xp)*
     +   (1.D0-xp)*(xp**2+(1.D0-xp)**2)*(2.D0*(zqmin-zqmax)+
     +   log(zqmax**2/zqmin**2))
         sig0s =  ALPHA_S/4.D0/pi*8.D0*xp*(1.D0-xp)*(zqmax-zqmin)
cnew test	
cc	 sig0s = 0.
cend test	
         sigi = 0.D0
         IF(INTER.EQ.2) THEN
            sigi = 0.D0
         ENDIF
         sig0 = 0.5D0*(1.D0+(1.D0-y)**2)*sig0t + (1.D0-y)*sig0s -
     +          ISIGN(1,K(1,2))*y*(1.D0 -0.5D0*y)*sigi
c including phase space factors
         sig = sig0*4.D0*pi*alph_em**2 /y/Q2/Q2
         if(xg.gt.1.) write(6,*) ' pqcdi xg>1 ',xg,ipro,x,xp
         IF(ID.EQ.1) THEN
            CALL PYSTFU(2212,SNGL(XG),SNGL(SCAL),XPQ)
         ELSE
            CALL RASTFU(KINT(2,2),SNGL(XG),SNGL(SCAL),XPQ)
         ENDIF
         wtg = DBLE(XPQ(0))
c         write(6,*) ' 13... Xg,XPQ(0) ',XG,XPQ(0),wtg,X,XP,alpha_s
c          write(6,*) alph,pi
c         write(6,*) y,q2
         sig = sig * wtg
c include charges for 3 flavours
         IF(INTER.LT.2) THEN
            sig = sig *2.D0/3.D0
         ELSEIF(INTER.EQ.2) THEN
            sig = sig  * GF**2 * Q2 *Q2/8.D0/pi**2/alph_em**2/(1.d0
     +      + Q2/XMW2)**2
         ENDIF
      ELSEIF(IPRO.EQ.14) THEN
         sig = 0.0d0
         xg = x/xp
         xt = zlog*(0.5d0*xp - xp**2 *(1.d0-xp) +
     +        2.d0*xksi*xp**2*(1.d0-3.d0*xp) - 4.d0*xksi**2*xp**3)
     +        + beta*(4.d0*xp**2*(1.d0-xp) - 0.5d0*xp
     +        -2.d0*xp**2*xksi*(1.d0-xp))
c note the following line is different in massless case from Peccei/Ruckl
c    +        + beta*(3.d0*xp**2*(1.d0-xp) - 0.5d0*xp ! Peccei/Ruckl
         xl = 2.d0*beta*xp**2*(1.d0-xp) -4.d0*xp**3*xksi*zlog
         f2 = alpha_s * xt /pi
         fl = alpha_s * xl /pi
cnew test	
cc	 fl = 0.
cend test	
c for charged current xf_3 is still missing
         comfac = 4.d0*pi*alph_em**2/y/q2/q2
         sig0 = comfac*(0.5d0*(1.d0+(1.d0-y)**2)*f2 - 0.5d0*y**2*fl)
c including phase space factors
         sig = sig0/xp
         if(xg.gt.1.) write(6,*) ' pqcdi xg>1 ',xg,ipro,x,xp
         IF(ID.EQ.1) THEN
            CALL PYSTFU(2212,SNGL(XG),SNGL(SCAL),XPQ)
         ELSE
            CALL RASTFU(KINT(2,2),SNGL(XG),SNGL(SCAL),XPQ)
         ENDIF
         wtg = dble(XPQ(0))
         sig = sig * wtg
c include charges for charm/bottom
         IF(INTER.LT.2) THEN
            IF(AM(1).LT.2.d0)  sig = sig *4.d0/9.d0
            IF(AM(1).GT.2.d0)  sig = sig *1.d0/9.d0
         ELSEIF(INTER.EQ.2) THEN
            sig = sig * GF**2 * Q2 *Q2/8.D0/pi**2/alph_em**2/(1.d0 + Q2/
     +      XMW2)**2
         ENDIF

      ELSEIF(IPRO.EQ.15) THEN
         sig0t = 2.d0*ALPHA_S/3.d0/pi/(1.d0-xp)*
     +   (xp**2*zlog + zqmin -zqmax +(zqmin**2-zqmax**2)/2.d0 +
     +    zlog+xp*(1.d0-xp)*(zqmax**2-zqmin**2)+
     +    2.d0*(1.d0-xp)*(zqmax-zqmin))
         sig0s = 2.d0*ALPHA_S/3.d0/pi*2*xp*(1.d0-xp)*(zqmax**2-zqmin**2)
     +    /(1.d0-xp)
         sigi = 0.D0
cnew test	
cc	 sig0s = 0.
cend test	
         IF(INTER.EQ.2) THEN
            sigi = 2.d0*ALPHA_S/3.d0/pi/(1.d0-xp)*
     +   (xp**2*zlog + zqmin -zqmax +(zqmin**2-zqmax**2)/2.d0 +
     +    zlog+2.d0*xp*(1.d0-xp)*(zqmax-zqmin)+
     +    2.d0*(1.d0-xp)*(zqmax**2-zqmin**2))
         ENDIF

         XQ=X/XP
         if(xg.gt.1.) write(6,*) ' pqcdi xq>1 ',xq,ipro,x,xp
         IF(ID.EQ.1) THEN
            CALL PYSTFU(2212,SNGL(XQ),SNGL(SCAL),XPQ)
         ELSE
            CALL RASTFU(KINT(2,2),SNGL(XQ),SNGL(SCAL),XPQ)
         ENDIF
         wtq = 0.D0
         IF(INTER.LT.2) THEN
            do 10 I = -NFLQCDC,NFLQCDC
   10       wtq = wtq + DBLE(XPQ(I))*DFLOAT(LUCHGE(I))**2/9.D0
            sig0 = 0.5d0*(1.d0+(1.d0-y)**2)*sig0t + (1.d0-y)*sig0s -
     +      ISIGN(1,K(1,2))*y*(1.D0 -0.5D0*y)*sigi
c including phase space factors
            sig = sig0*4.d0*pi*alph_em**2 /y/Q2/Q2
            sig = sig * wtq
         ELSEIF(INTER.EQ.2) THEN
            sig0 = 0.d0
            DO 20  I=1,NFLAV-1,2
c take only contribution from light quarks
               IF(I.GE.3) GOTO 20
               IF(ISIGN(1,K(1,2)).EQ.1) THEN
                  sig0 = sig0 + 0.5d0*(1.d0+(1.d0-y)**2) *sig0t*
     +            DBLE(XPQ(-I)+XPQ(I+1)) + (1.d0-y)*sig0s*DBLE(XPQ(-
     +            I)+XPQ(I+1)) + ISIGN(1,K(1,2))*y*(1.D0 -0.5D0*y)*
     +            sigi* DBLE(-XPQ(-I)+XPQ(I+1))
               ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
                  sig0 = sig0 + 0.5d0*(1.d0+(1.d0-y)**2) *sig0t*
     +            DBLE(XPQ(I)+XPQ(-I-1)) + (1.d0-y)*sig0s*
     +            DBLE(XPQ(I)+XPQ(-I-1)) - ISIGN(1,K(1,2))*y*(1.D0 -
     +            0.5D0*y)*sigi* DBLE(XPQ(I)-XPQ(-I-1))
               ENDIF

   20       CONTINUE
c including phase space factors
            sig = sig0*4.d0*pi*alph_em**2 /y/Q2/Q2
            sig = sig * GF**2 * Q2 *Q2/8.D0/pi**2/alph_em**2/(1.d0 + Q2/
     +      XMW2)**2
c additional factor 0.5 for handiness of electron
            sig = 0.5D0 * sig
         ENDIF
      ELSE
         write(6,*) ' PQCDI process not implemented: IPRO = ',IPRO
      ENDIF
      if(x1.gt.1..or.x1.lt.0.) THEN
         write(6,*) 'PQCDI: x1 = ',x1,IPRO,PT2CUT(IPRO),AM(1)
      endif

      PQCDI = SNGL(SIG * GEV2NB  * XP*LOG(XPMAX/XPMIN))
c      write(6,*) ' pqcdi ',ipro,pqcdi
      RETURN
   30 CONTINUE
      PQCDI = 0.0
      END
*CMZ :  2.08/04 22/12/99  15.39.26  by  Hannes Jung
*CMZ :  2.07/03 23/05/99  13.52.22  by  Hannes Jung
*-- Author :    Hannes Jung   11/01/95

      FUNCTION PQCDQQB(X1,Y1)
      IMPLICIT None
	Double Precision X,XV,WMAX
	Integer Ndimen,IMIX
      DIMENSION X(20)
      REAL X1,Y1,PQCDQQB
      COMMON /XVAL/ XV(20),NDIMEN
      COMMON /OALPHAS/ WMAX,IMIX
*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
      REAL SNGL
      Double Precision draprn
	Integer I
	Double Precision WDUM,WMAX1,FXN1
      EXTERNAL draprn
      DATA WDUM/0./
      IF(IDIR.EQ.0) THEN
C generate additional random numbers for order alpha_s QCD processes
C           X(NDIMEN+1) = phi in PHASE
C           X(NDIMEN+2) = cost in PHASE
C           X(NDIMEN+3) = XP2 = E_part/E_proton
C           X(NIDMEN+4) = phi electron
         XV(NDIMEN+1) = draprn()
         XV(NDIMEN+4) = draprn()
         XV(NDIMEN+2) = DBLE(X1)
         XV(NDIMEN+3) = DBLE(Y1)
      ELSEIF(IDIR.EQ.1) THEN
C generate additional random numbers for order alpha_s QCD processes
C           X(NDIMEN+1) = XP2 = E_part/E_proton
C           X(NIDMEN+2) = phi electron
C           X(NDIMEN+3) = phi in PHASE
C           X(NDIMEN+4) = cost in PHASE
         XV(NDIMEN+1) = DBLE(X1)
         XV(NDIMEN+2) = draprn()
         XV(NDIMEN+3) = draprn()
         XV(NDIMEN+4) = DBLE(Y1)
      ELSE
         WRITE(6,*) ' PQCDQQB: selection not possible. IDIR = ',IDIR
      ENDIF
c      write(6,*) (XV(I),I=Ndimen+1,Ndimen+4)
      DO 10 I=1,NDIMEN+4
   10 X(I) = XV(I)
c      write(6,*) ' pqcdqqb: ndimen ',NDIMEN,IDIR
c      write(6,*) ' pqcdqqb: x(i) ',(X(I),I=1,NDIMEN+4)
      if(x1.gt.1..or.x1.lt.0..or.y1.gt.1..or.y1.lt.0.) THEN
         write(6,*) ' x1 = ',x1,' y1 = ',y1
      endif
      WMAX1 = FXN1(X,WDUM)
c      write(6,*) ' pcdqqb: fxn1 wmax',wmax1,wmax,idir,ipro
      IF(WMAX1.GT.WMAX) WMAX=WMAX1
      PQCDQQB = SNGL(WMAX1)
      RETURN
      END
      FUNCTION FL(X)
	REAL FL
      FL=0.
      RETURN
      END
      FUNCTION FU(X)
	REAL FU
      FU=1.
      RETURN
      END
*CMZ :  2.08/02 14/07/99  18.40.55  by  Hannes Jung
*CMZ :  2.08/01 23/06/99  07.56.53  by  Hannes Jung
*CMZ :  2.08/00 17/06/99  17.21.39  by  Hannes Jung
*CMZ :  2.07/03 23/05/99  18.42.36  by  Hannes Jung
*-- Author :
      FUNCTION PQPM(YY1,Q2)
      IMPLICIT None
*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
      REAL XPQ(-6:6)
      REAL SNGL,XS,Q2S
      REAL SCALE
      Integer KPART
      COMMON/PINT/ SCALE,KPART
      Integer ID
      double precision xpom
      COMMON /PQPMID/xpom,ID
      Double Precision YY1,Q2,GEV2NB,X,F2,ALPH_EM,SIGMA,WTGLU,GF,WMAT
      Double Precision PQPM,beta
      Integer I,LUCHGE
      DATA GEV2NB/.3893857D+6/

      X = Q2/YY1/SSS
      XS = REAL(X)
      Q2S = REAL(Q2)
c      CALL PYSTFU(K(2,2),SNGL(X),SNGL(Q2),XPQ)
      do i=-6,6
         XPQ(i)=0.0
      enddo
      IF(ID.EQ.1) THEN
         CALL PYSTFU(2212,SNGL(X),SNGL(Q2),XPQ)
      ELSE
         BETA = X/XPOM
c     write(6,*) xpom,x,beta,id
         IF(BETA.LT.1.and.beta.gt.0.) THEN
c            write(6,*) xpom,x,beta,id
            CALL RASTFU(KINT(2,2),SNGL(beta),SNGL(Q2),XPQ)
c        write(6,*) KINT(2,2),SNGL(beta),SNGL(Q2),XPQ
         ENDIF
      ENDIF
c check for exclusive heavy flavor production
      if(IHF.GT.0) then
         do i=-6,6
            if(iabs(i).ne.IHFLA) xpq(i)=0
         enddo
      endif
c      write(6,*) ' PQPM x,q2,xpq     ',ihf,ihfla,x,q2,(xpq(i),i=0,5)

ccc      write(6,*) ' PQPM x,q2,xpq MXcut',x,q2,(xpq(i),i=0,4)
      F2 = 0.D0
      ALPH_EM = ALPH
      IF(IRUNAEM.EQ.1) ALPH_EM = DBLE(ULALEM(SNGL(Q2)))
      IF(INTER.LT.2) THEN
         DO 10 I=-NFLAV,NFLAV
   10    F2 = F2 + DBLE(XPQ(I))*DFLOAT(LUCHGE(I))**2/9.D0
cccc         F2 = 2*DBLE(XPQ(4))*DFLOAT(LUCHGE(4))**2/9.D0
         SIGMA = 2.D0*PI*ALPH_EM**2 /YY1 /Q2/Q2 *(1.d0+(1.d0-yy1)**2)*
     +   F2
      ELSEIF(INTER.EQ.2) THEN
         WTGLU = 0.D0
         DO 20  I=1,NFLAV-1,2
            IF(ISIGN(1,K(1,2)).EQ.1) THEN
               WTGLU = WTGLU + (1.D0 - YY1 + YY1**2/2.D0)*2.D0*
     +         DBLE(XPQ( -I)+XPQ(I+1)) + (YY1 - YY1**2/2.D0)*2.D0*
     +         DBLE(-XPQ(-I)+ XPQ(I+1))
            ELSEIF(ISIGN(1,K(1,2)).EQ.-1) THEN
               WTGLU = WTGLU + (1.D0 - YY1 + YY1**2/2.D0)*2.D0*
     +         DBLE(XPQ(I )+XPQ(-I-1)) - (YY1 - YY1**2/2.D0)*2.D0*
     +         DBLE(XPQ(I)-XPQ(- I-1))
            ENDIF
   20    CONTINUE
         GF = PI*ALPH_EM/(SIN2W*XMW2*DSQRT(2.D0))
         WMAT = GF**2/2.D0/PI /(1.D0 + Q2/XMW2)**2 /YY1
capply additional factor 0.5 because only right/or left handed electrons contr.
         WMAT = WMAT * 0.5D0
         SIGMA = WMAT * WTGLU
c         write(6,*) ' here in CC pqpm',sigma*gev2nb
      ENDIF
c      write(6,*) pi,alph,q2,f2,yy1,q2
      PQPM = SIGMA * GEV2NB
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.26  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  17.08.08  by  Hannes Jung
*CMZ :  2.07/03 23/05/99  14.51.10  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE PRODIFF
      IMPLICIT None
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEND.
      DOUBLE PRECISION PARL
      REAL CUT,XLEP,YLEP,W2LEP,Q2LEP,ULEP
	Integer LST
      COMMON /RAPTOU/CUT(14),LST(40),PARL(30),XLEP,YLEP,W2LEP,Q2LEP,ULEP
      Double Precision XMX
      COMMON/TEST/XMX
      DOUBLE PRECISION PHV(4)
      Double Precision draprn
	Real CHI,PTSPL,PHISPL
      REAL SNGL
	Integer I,ipom,kpart,npdc1,npdc2,iprot,KFLCH,KFLSP,KSIGN,KC2
	integer LUCOMP
      common/pdcyn/npdc1,npdc2
	Double Precision R,AMSP,AMK2,beta,A,shr,phr,pe,pz,pw1
	Double Precision pms,pms2,pms4,xmas,fc,dot
      EXTERNAL draprn
      IPROT = -9999
	PTSPL = 0.
	PHISPL = 0.
      DO 10 I=3,N
         IF(IABS(K(I,2)).EQ.2212) IPROT = I
         IF(IABS(K(I,2)).EQ.100) IPOM = I
   10 CONTINUE
      IF(IPROT.LT.0) RETURN
      K(IPROT,2)=2210
      KPART = K(IPROT,2)
      K(IPROT,1)=11
      KSIGN=ISIGN(1,KPART)
      KFLCH=0
C...GLUON REMOVED.
      R=6.D0*draprn()
      IF(R.LT.3.) THEN
         KFLCH=2*KSIGN
         KFLSP=2101*KSIGN
      ELSEIF(R.LT.4.) THEN
         KFLCH=2*KSIGN
         KFLSP=2103*KSIGN
      ELSE
         KFLCH=1*KSIGN
         KFLSP=2203*KSIGN
      ENDIF
      K(N+1,1)=1
      K(N+2,1)=1
      K(N+1,2)= KFLCH
      K(N+2,2)= KFLSP
      K(N+1,3)=IPROT
      K(N+2,3)=IPROT
   20 CONTINUE
C...Split energy-momentum of target remnant according to functions P(z)
C...z=E-pz fraction for qq (q) forming jet-system with struck Q (Qbar)
C...1-z=E-pz fraction for qQbar (qqQ) hadron
C...mq=mass of (light) parton remnant q (qq) in jet system
C...mQ=mass of produced (heavy flavour) hadron
      AMSP=DBLE(ULMASS(KFLSP))
      AMK2=DBLE(ULMASS(KFLCH))
      IF(IREM.EQ.1) THEN
C...Old Lepto treatment
C...P(z)=(a+1)(1-z)**a with <z>=1/(a+2)=1/3 since a=1 fixed
         BETA=DBLE(1.-SQRT(draprn()))
C...Flip if baryon produced
         KC2=IABS(LUCOMP(KFLCH))
         IF(KC2.GE.301.AND.KC2.LE.400) BETA=1.D0-BETA
      ELSEIF(IREM.EQ.2) THEN
C...Update of LEPTO treatment
C...P(z)=(a+1)(1-z)**a with <z>=1/(a+2)=mq/(mq+mQ) --> a=a(mq,mQ)
         A=(AMSP+AMK2)/AMSP - 2.D0
         BETA=draprn()**(1.D0/(A+1.D0))
      ELSEIF(IREM.EQ.3) THEN
C...Using Peterson fragmentation function
C...P(z)=N/(z(1-1/z-c/(1-z))**2)  where c=(mq/mQ)**2  (FC=-c)
         FC=-(AMSP/AMK2)**2
   30    BETA=draprn()
         IF(-4.D0*FC*BETA*(1.D0-BETA)**2.LT.draprn()*
     +    ((1.D0-BETA)**2-FC*BETA)**2) GOTO 30
      ELSEIF(IREM.LT.0) THEN
         beta = DBLE(XFGKI + (SNGL(XF) - XFGKI)*draprn())

      ENDIF
      IF(beta.lt.1.5*xfgki) goto 20
C --
      chi = XFGKI/SNGL(beta)
c use constituent masses in ULMASS
cccc      MSTJ(93)=1
      P(N+1,5)=DBLE(ULMASS(K(N+1,2)))
      P(N+1,1)=P(2,1)*DBLE(CHI) - P(IPOM,1) + DBLE(PTSPL*COS(PHISPL))
      P(N+1,2)=P(2,2)*DBLE(CHI) - P(IPOM,2) + DBLE(PTSPL*SIN(PHISPL))
      P(N+1,1) = P(2,1)*DBLE(CHI) - P(IPOM,1)
      P(N+1,2) = P(2,2)*DBLE(CHI) - P(IPOM,2)
c use constituent masses in ULMASS
cccc      MSTJ(93)=1
      P(N+2,5)=DBLE(ULMASS(K(N+2,2)))

C--
      DO 40 I=1,4
   40 PHV(I) = P(IPOM,I) + P(1,I)
      SHR = SSS
      SHR = SQRT(SHR)
      PHR = DOT(PHV,PHV)
      P(N+2,1) = P(IPROT,1) - P(N+1,1)
      P(N+2,2) = P(IPROT,2) - P(N+1,2)
      PMS2 = P(N+1,5)**2 + P(N+1,1)**2 + P(N+1,2)**2
      PMS4 = P(N+2,5)**2 + P(N+2,1)**2 + P(N+2,2)**2
      PMS = PMS2/DBLE(CHI) +PMS4/(1.D0-DBLE(CHI))
      PE = 0.5D0*(SHR + (PMS - PHR)/SHR)
      PZ = SQRT(PE**2 - PMS)
      PW1=DBLE(CHI)*(PE + PZ)
      P(N+1,4) = 0.5D0*(PW1 + PMS2/PW1)
      P(N+1,3) = 0.5D0*(PW1 - PMS2/PW1)

      P(N+2,4) = PE - P(N+1,4)
      P(N+2,3) = PZ - P(N+1,3)
ccc      xm1 = P(N+1,4)**2 - P(N+1,1)**2-P(N+1,2)**2-P(N+1,3)**2
ccc      xm2 = P(N+2,4)**2 - P(N+2,1)**2-P(N+2,2)**2-P(N+2,3)**2
ccc      xm1=dsqrt(xm1)
ccc      xm2=dsqrt(xm2)
ccc      write(6,*) ' masses xm1 ',xm1,p(n+1,5)
ccc      write(6,*) ' masses xm2 ',xm2,p(n+2,5)

      xmx = DOT1(N+1,N+1) + 2.D0*DOT1(N+1,N+2) + DOT1(N+2,N+2)
      xmas = dsqrt(xmx)
      if(xmas.lt.1.1) then
         npdc1 = 0
         npdc2 = 0
         DO I = 1,5
            P(N+1,I) = P(IPROT,I)
         ENDDO
         K(N+1,1)=1
         K(N+1,2)=2212
         K(N+1,3)=IPROT
         N=N+1
      ELSE
         npdc1 = N+1
         npdc2 = N+2
         K(npdc1,1) = 12
         K(npdc2,1) = 11

         N = N+2

      ENDIF

      RETURN
      END
*CMZ :  2.08/00 06/06/99  17.07.14  by  Hannes Jung
*CMZ :  2.00/01 20/04/95  17.18.33  by  Hannes Jung
*-- Author :
C*********************************************************************

      FUNCTION PYGAMM(X)

C...Gives ordinary Gamma function Gamma(x) for positive, real arguments;
C...see M. Abramowitz, I. A. Stegun: Handbook of Mathematical Functions
C...(Dover, 1965) 6.1.36.
      Double Precision B
      DIMENSION B(8)
      DATA B/-0.577191652D0,0.988205891D0,-0.897056937D0,0.918206857D0,
     +-0.756704078D0,0.482199394D0,-0.193527818D0,0.035868343D0/

      NX=INT(X)
      DX=X-NX

      PYGAMM=1.
      DXP=1.
      DO 10  I=1,8
         DXP=DXP*DX
   10 PYGAMM=PYGAMM+SNGL(B(I))*DXP
      IF(X.LT.1.) THEN
         PYGAMM=PYGAMM/X
      ELSE
         DO 20 IX=1,NX-1
   20    PYGAMM=(X-IX)*PYGAMM
      ENDIF
      RETURN
      END
*CMZ :  2.08/04 10/01/2000  10.27.23  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  17.09.03  by  Hannes Jung
*CMZ :  2.07/03 23/05/99  15.08.24  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
C **********************************************************************
      SUBROUTINE PYREMN(IPU1,IPU2)
      IMPLICIT None
C...ADDS ON TARGET REMNANTS (ONE OR TWO FROM EACH SIDE) AND
C...INCLUDES PRIMORDIAL KT.
      DOUBLE PRECISION DBETAX,DBETAZ,DROBO(5)
      REAL CUT,XLP,YLP,W2LP,Q2LP,ULP
      DOUBLE PRECISION PARL
	Integer LLST
      COMMON /RAPTOU/ CUT(14),LLST(40),PARL(30),XLP,YLP,W2LP,Q2LP,ULP
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEND.
      REAL PYPAR,PYVAR
	Integer IPY
      COMMON /PYPARA/ IPY(80),PYPAR(80),PYVAR(80)
      REAL X,SH,TH,UH,Q2PY
      DOUBLE PRECISION ROBO,SINTH,PHIPT
	Integer ISUB,KFLCH,KFLSP,IS,ISN,KFL
      COMMON /PYPROC/ ISUB,KFL(3,2),X(2),SH,TH,UH,Q2PY
	Double Precision PMS,PSYS
      DIMENSION KFLCH(2),KFLSP(2),PMS(0:6),IS(2),ROBO(5)

c.hju
      DIMENSION PSYS(0:2,5),ISN(2)

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEND.
      Integer LST,IRES
      COMMON/EPPARA/LST(30),IRES(2)
      REAL GGPT,GPPT
      COMMON /GRAKT/ GGPT,GPPT
      real prkt
	Double Precision pktmin,pktmax
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEND.

*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEND.
c.hju
*KEEP,RGPRKT.
      DOUBLE PRECISION PRKT1,PRKT2,pktm
	Integer IGAMKT
      COMMON /RGPRKT/PRKT1,PRKT2,pktm,IGAMKT

*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
      REAL PTSPL,PHISPL,CHI(2)
      REAL SNGL
	Integer I,J,JT,LUCOMP,IFLS,IPU,IQ,IPU1,IPU2,ILEP,IP,NS,NTRY
	Integer IL,IR,IG,IMAX,IMIN
	Double Precision PEI,PE,PZI,PZ,SHS,SHR,PMMIN0,PMMIN1
	Double Precision PMMIN2,PMMIN,PPB,PNB,PMTB,PMTR,PMTL,PW1
	Double Precision SQLAM,SQSGN,RKR,RKL,BER,BEL,PZF,PT2,RQP
	Double Precision PEM,PZM,PDEV
      EXTERNAL LUCOMP
	Double Precision draprn
	External draprn
      DATA IPU,IQ/0,0/,PEI,PE,PZI,PZ,SHS/5*0./
c... hju data added
c      write(6,*) 'IRES(2) ',IRES(2)
c...      IRES(2) = 1
c... hju
C...FIND EVENT TYPE, SET POINTERS
c      write(6,*) 'pyremn test; T2gki,xfgki ',T2GKI,XFGKI
      GGPT = -9999.
      GPPT = -9999.
      IF(IPU1.EQ.0.AND.IPU2.EQ.0) RETURN
      ILEP=0
      IF(IPU1.EQ.0) ILEP=1
      IF(IPU2.EQ.0) ILEP=2
      IF(ISUB.EQ.7) ILEP=-1
      IF(ILEP.EQ.1) IQ=21
      IF(ILEP.EQ.2) IQ=23
      IF(ILEP.eq.1.and.ILEPTO.eq.0) ILEP=0

      IF(ILEP.EQ.1.OR.(IRES(1).EQ.0.and.ILEPTO.EQ.1)) Q2 = DBLE(Q2LP)
      PYVAR(33) =  0.0
      PYVAR(34) =  0.0

      IP=MAX(IPU1,IPU2)
      NS=N
C...DEFINE INITIAL PARTONS, INCLUDING PRIMORDIAL KT
   10 DO 30  I=3,4
         IF(I.EQ.3) IPU=IPU1
         IF(I.EQ.4) IPU=IPU2
         K(I,1)=21
         K(I,3)=I-2
c         write(6,*) 'PYREMN 1st :PARL(22),T2GKI ',PARL(22),T2gki,xfgki
         DO 20 J=1,5
   20    P(I,J)=0.D0
         IF(IPU.NE.0) THEN
            K(I,2)=K(IPU,2)
            P(I,5)=P(IPU,5)
c            P(I,5)=0.D0
c            write(6,*) 'pyremn: prkt1',prkt1,ptspl,phispl
            IF(IDIR.NE.0) THEN
               if(i.eq.3) then
			if(K(I,2).eq.22) then
c for photon select gaussian,dkt^2/(kt0^2+kt^2) or dkt^2/(kt0^2+kt^2)^2
                  IF(IGAMKT.eq.1) Then
                  prkt = sngl(PRKT1)
			CALL LPRIKT(prkt,PTSPL,PHISPL)
			ELSEIF(IGAMKT.EQ.2) Then
			pktmin=prkt1**2
			pktmax=pktm**2+prkt1**2
			PTSPL = sqrt(max(0d0,
     &			(pktmin*(pktmax/pktmin)**draprn()-prkt1**2)))
                  PHISPL = 6.2832*draprn()
			ELSEIF(IGAMKT.EQ.3) Then
			pktmin=prkt1**2
			pktmax=pktm**2+prkt1**2
			PTSPL = sqrt(max(0d0,
     &		(pktmin*pktmax/(pktmax-draprn()*pktm**2)-prkt1**2)))
                  PHISPL = 6.2832*draprn()
			ELSE
			write(6,*) ' PYREMN: no valid distr. for prim. kt. ',
     &			'in photon selected: IGAMKT=',IGAMKT
                  STOP
			ENDIF
			
                  else
                  prkt = sngl(PRKT1)
			CALL LPRIKT(prkt,PTSPL,PHISPL)
			endif			
               else
                  prkt = sngl(PRKT2)
                  CALL LPRIKT(prkt,PTSPL,PHISPL)
               endif
            ELSEIF(IDIR.EQ.0) THEN
               PTSPL=0.
               IF(IALMKT.EQ.1.AND.IPRO.EQ.12) CALL RALMKT(SNGL(PARL(21)
     +         ),PTSPL,PHISPL)
            ENDIF
            IF(ISEMIH.EQ.1) THEN
               PTSPL=0.
               P(I,5)=0.D0
            ENDIF
            IF(I.EQ.3) GGPT = PTSPL
            IF(I.EQ.4) GPPT = PTSPL
c            write(6,*) 'pyremn: prkt1',prkt1,ptspl**2,phispl
c            write(6,*) 'pyremn: prkt2',prkt2
c            write(6,*) 'pyremn PT2gen,phigen ',pt2gen,phigen
            P(I,1)=DBLE(PTSPL*COS(PHISPL))
            P(I,2)=DBLE(PTSPL*SIN(PHISPL))
            PMS(I-2)=P(I,5)**2+P(I,1)**2+P(I,2)**2
c            write(6,*) 'PYREMN: PMS=',I,PMS(I-2),P(I,5),P(I,1),P(I,2)
c        write(6,*) ' ILEP ',ILEP
         ELSE
            K(I,2)=K(IQ,2)
            IF(ILEPTO.EQ.0) THEN
               P(I,5)= 0.0D0
               pms(i-2)=0.0D0

            ELSEIF(ILEPTO.EQ.1) THEN
               P(I,5)=-SQRT(Q2)
               PMS(I-2)= - Q2
c. shs = w**2 but calculated for photoprod.
               SHS= (- Q2 + PARL(22)+DBLE(PYVAR(7-I))**2)
cccc         write(6,*) 'PYREMN  :SHS,PYVAR(7-I)',SHS,PYVAR(7-I)
c              write(6,*) ' SHS ',SHS,' SHS_n =',SHSN
               IF(IDIR.EQ.0) THEN
                  SHS = DBLE(-Q2 + PARL(22) + DBLE(T2GKI))
c         write(6,*) 'PYREMN new :SHS,PYVAR(7-I)',SHS,T2GKI
c         write(6,*) 'PYREMN:PARL(22),T2GKI ',PARL(22),T2gki,xfgki
               ENDIF
            ENDIF
         ENDIF
   30 CONTINUE
c       write(6,*) ' pms(1),pms(2) ',pms(1),pms(2)
c      pause ' PYREMN: after 30 '
c      write(6,*) 'before construction of partons ',ILEP
c      call DULIST(1)
C...KINEMATICS CONSTRUCTION FOR INITIAL PARTONS
      IF(ILEP.EQ.0) SHS=DBLE(PYVAR(31)*PYVAR(32)*PYVAR(2))
     + +(P(3,1)+P(4,1))**2+(P(3,2)+P(4,2))**2
ccc            SHS1= (- Q2 + PARL(22))
c      write(6,*) ' shs ,shat ',shs,shat
c      write(6,*) 'PYVAR(31,32,2 :',pyvar(31),PYVAR(32),PYVAR(2)
c      write(6,*) ' Q2,PARL(22)',Q2,PARL(22)
c      SHS = SHAT
ccc      call dulist(1)
ccc      pause
      SHR=DSQRT(DMAX1(0.D0,SHS))
      IF(ILEP.EQ.0) THEN
         IF((SHS-PMS(1)-PMS(2))**2-4.D0*PMS(1)*PMS(2).LE.0.) GOTO 10
         P(3,4)=0.5D0*(SHR+(PMS(1)-PMS(2))/SHR)
         P(3,3)=DSQRT(DMAX1(0.D0,P(3,4)**2-PMS(1)))
c         P(3,4)=0.5D0*(SHR-(PMS(1)+PMS(2))/SHR)
c         P(3,3)=DSQRT(DMAX1(0.D0,P(3,4)**2+PMS(1)))
         P(4,4)=SHR-P(3,4)
         P(4,3)=-P(3,3)
      ELSEIF(ILEP.EQ.1) THEN
         P(3,4)=P(IQ,4)
         P(3,3)=P(IQ,3)
         P(4,4)=P(IP,4)
         P(4,3)=P(IP,3)
c         write(6,*) ' PYREMN IQ: ',P(IQ,3),P(IQ,4)
c         write(6,*) ' PYREMN IP: ',P(IP,3),P(IP,4)
      ELSEIF(ILEP.EQ.2) THEN
         P(3,4)=P(IP,4)
         P(3,3)=P(IP,3)
         P(4,4)=P(IQ,4)
         P(4,3)=P(IQ,3)
      ENDIF
C...TRANSFORM PARTONS TO OVERALL CM-FRAME (NOT FOR LEPTOPRODUCTION)
      IF(ILEP.EQ.0) THEN
         MSTU(1)=3
         MSTU(2)=4
ccc         write(6,*) ' in ILEP=0 ',P(3,3),P(3,4),P(4,3),P(4,4)
ccc         call dulist(1)
         DROBO(3)=(P(3,1)+P(4,1))/SHR
         DROBO(4)=(P(3,2)+P(4,2))/SHR
         CALL DUDBRB(MSTU(1),MSTU(2),0.D0,0.D0,-DROBO(3),-DROBO(4),0.D0)
ccc         CALL DULIST(1)
         ROBO(2)=DLANGL(P(3,1),P(3,2))
         CALL DUDBRB(MSTU(1),MSTU(2),0.D0,-ROBO(2),0.D0,0.D0,0.D0)
ccc         CALL DULIST(1)
         ROBO(1)=DLANGL(P(3,3),P(3,1))
         CALL DUDBRB(MSTU(1),MSTU(2),-ROBO(1),0.D0,0.D0,0.D0,0.D0)
ccc         CALL DULIST(1)
ccc         write(6,*) 'IPY(47),IPU1,IPU2',IPY(47),IPU1,IPU2
         MSTU(2)=MAX(IPY(47),IPU1,IPU2)
         CALL DUDBRB(MSTU(1),0,ROBO(1),ROBO(2),DROBO(3), DROBO(4),0D0)
         DROBO(5)=DBLE(MAX(-0.999999,MIN(0.999999,(PYVAR(31)-PYVAR(32))/
     +   (PYVAR(31)+PYVAR(32)))))
         CALL DUDBRB(MSTU(1),0,0.D0,0.D0,0.D0,0.D0,DROBO(5))
ccc         CALL DULIST(1)
c       ROBO(2) = DLANGL(P(1,1),P(1,2))
c       ROBO(1) = DLANGL(P(1,3),P(1,1))
         MSTU(1)=0
         MSTU(2)=0
      ENDIF
ccc      write(6,*) ' after boost : ILEP=',ILEP
ccc      CALL DULIST(1)
ccc      pause 'after boost'
C...CHECK INVARIANT MASS OF REMNANT SYSTEM:
C...HADRONIC EVENTS OR LEPTOPRODUCTION
      IF(ILEP.LE.0) THEN
c here is changed; now according to PYTHIA 5.6
         PSYS(0,4)=P(3,4)+P(4,4)
         PSYS(0,3)=P(3,3)+P(4,3)
         PMS(0)=DMAX1(0.D0,PSYS(0,4)**2 - PSYS(0,3)**2)
         PMMIN0=DSQRT(PMS(0))
         PMMIN1=P(1,5)**2 + P(3,1)**2 + P(3,2)**2
         PMMIN1=DSQRT(PMMIN1)
         PMMIN2=P(2,5)**2 + P(4,1)**2 + P(4,2)**2
         PMMIN2=DSQRT(ABS(PMMIN2))
         PSYS(1,4) = DBLE(0.5*PYVAR(1)*(1. - PYVAR(30+1)))
         PSYS(2,4) = DBLE(0.5*PYVAR(1)*(1. - PYVAR(30+2)))
         IF(IRES(1).EQ.0.AND.(IABS(K(1,2)).EQ.11.OR.IABS(K(1,2)).EQ.13)
     +   ) PSYS(1,3)=PSYS(1,4)
         IF(PMMIN0+PMMIN1+PMMIN2.GT.PYVAR(1).OR.PMMIN1.GT.PSYS(1,4)
     +   .OR. PMMIN2.GT.PSYS(2,4)) THEN
            IPY(48)=1
ccc            pause 'PYREMN: IPY(48) RETURN'
ccc            CALL DULIST(1)
            RETURN
         ENDIF
      ELSE
         PEI=P(IQ,4)+P(IP,4)
         PZI=P(IQ,3)+P(IP,3)
         PMS(ILEP)=DMAX1(0.D0, PEI**2-PZI**2+P(5-ILEP,1)**2+
     +   P(5-ILEP,2)**2)
c         write(6,*) ' pms ',pms(ilep),q2
         IF(IPRO.EQ.12) THEN
c            write(6,*) ' PEI ',PEI,' PZI ',PZI
c            write(6,*) ' q2 ',Q2,dot1(IQ,IQ)
         ENDIF
         PMMIN=P(3-ILEP,5)+DBLE(ULMASS(K(5-ILEP,2)))+DSQRT(PMS(ILEP))
c         write(6,*) ' 1st PMMIN ',PMMIN
c         IF(IDIR.EQ.0) PMMIN=DBLE(T2GKI)
c     +    +DBLE(ULMASS(K(5-ILEP,2)))+DSQRT(PMS(ILEP))
c         write(6,*) ' 2st PMMIN ',PMMIN
c         write(6,*) ' PMS(ILEP) ',PMS(ILEP),ULMASS(K(5-ILEP,2)),T2GKI
c hju
         IF(IDIR.EQ.1) THEN
            PMMIN=PMMIN+DBLE(PYPAR(12))
         ELSE
            PMMIN=DBLE(T2GKI)+DBLE(ULMASS(K(5-ILEP,2)))+DSQRT(PMS(ILEP)
     +      )
         ENDIF

chju         IF(SHR.LE.PMMIN+PYPAR(12)) THEN
         IF(SHR.LE.PMMIN) THEN
c            WRITE(6,*) ' IN PYREMN: IPY(48)=1 ',idir,ipro
c            WRITE(6,*) 'SHR  ',SHR
c            WRITE(6,*) 'PMS(ILEP)=',PMS(ILEP),' PMMIN=',PMMIN
c            WRITE(6,*) 'PYPAR(12)= ',PYPAR(12),'IQ=',IQ,' IP=',IP
c            WRITE(6,*) 'PYVAR(32 =',PYVAR(32)
ccc            pause 'PYREMN: IPY(48) RETURN'
ccc            CALL DULIST(1)
            IPY(48)=1
            RETURN
         ENDIF
      ENDIF
cc      write(6,*) ' before subdivide remnant'
cc      CALL DULIST(1)
C...SUBDIVIDE REMNANT IF NECESSARY, STORE FIRST PARTON
c      pause ' PYREMN: bef 40 '
      NTRY = 0
   40 I=NS-1
      DO 70  JT=1,2
         ISN(JT)=0
c      write(6,*) ' KFL = ',KFL(1,JT)
         IF((ILEP.EQ.JT).OR. (IPY(40+JT)
     +   .EQ.22.AND.IRES(JT).EQ.0)) GOTO 70
cc         IF((IRES(JT).EQ.0.AND.ILEPTO.EQ.1).OR. (IPY(40+JT)
cc     +   .EQ.22.AND.IRES(JT).EQ.0)) GOTO 70
         IF(JT.EQ.1) IPU=IPU1
         IF(JT.EQ.2) IPU=IPU2
         CALL PYSPLI(IPY(40+JT),KFL(1,JT),KFLCH(JT),KFLSP(JT))
cc       write(6,*) 'PYREMN IPY=',IPY(40+JT),KFL(1,JT),KFLCH(JT),KFLSP(JT)
         I=I+2
         IS(JT)=I
         ISN(JT)=2
         K(I,1)=3
         K(I,2)=KFLSP(JT)
         K(I,3)=JT
         P(I,5)=DBLE(ULMASS(K(I,2)))
c         P(I,5) = 0
c         write(6,*) 'PYREMN: I=',I,' mass ',P(I,5)
c          IF(IDIR.EQ.0) P(I,5) = 0.0
C...FIRST PARTON COLOUR CONNECTIONS AND TRANSVERSE MASS
         K(I+1,1)=-1
         K(I+1,3)=I
         K(I+1,2)=1000
         IF(IPY(34).GE.1) K(I+1,2)=1000+JT
         DO 50 J=1,5
   50    P(I+1,J)=0.D0
         IF(IPU.NE.0.AND.KFLSP(JT).EQ.21) THEN
            P(I+1,3)=IPU
            P(I+1,4)=IPU
            P(IPU+1,1)=I
            P(IPU+1,2)=I
            K(I,4)=IPU+IPU*MSTU(5)
            K(I,5)=IPU+IPU*MSTU(5)
            K(IPU,4)=MOD(K(IPU,4),MSTU(5))+I*MSTU(5)
            K(IPU,5)=MOD(K(IPU,5),MSTU(5))+I*MSTU(5)
         ELSEIF(IPU.NE.0) THEN
            IFLS=(3-ISIGN(1,KFLSP(JT)*(1102-IABS(KFLSP(JT)))))/2
            P(I+1,IFLS+2)=IPU
            P(IPU+1,3-IFLS)=I
            K(I,IFLS+3)=IPU
            K(IPU,6-IFLS)=MOD(K(IPU,6-IFLS),MSTU(5))+I*MSTU(5)
         ENDIF
         IF(KFLCH(JT).EQ.0) THEN
            P(I,1)=-P(JT+2,1)
            P(I,2)=-P(JT+2,2)
            IF(ISEMIH.EQ.1) THEN
               P(I,1) = - P(IP,1)
               P(I,2) = - P(IP,2)
            ENDIF
            PMS(JT)=P(I,5)**2+P(I,1)**2+P(I,2)**2
cc          write(6,*) ' PMS = ',PMS(JT),JT,P(I,5)**2,P(I,1)**2+P(I,2)**2
         ELSE

C...WHEN EXTRA REMNANT PARTON OR HADRON: FIND RELATIVE PT, STORE
C...PRIMORDIAL KT SPLIT SHARED BETWEEN REMNANTS
c            write(6,*) ' look for prim. k_t '
            CALL LPRIKT(SNGL(PARL(14)),PTSPL,PHISPL)
c            write(6,*) ' PARL(14) =',PARL(14),PTSPL,PHISPL
            IF((IABS(K(JT,2)).EQ.11.OR.IABS(K(JT,2)).EQ.13).AND.
     +      IRES(JT).NE.0) THEN
               CHI(JT)=(1. - yy)/(1. - PYVAR(30+JT))
            ELSEIF((IABS(K(JT,2)).EQ.11.OR.IABS(K(JT,2)).EQ.13).AND.
     +      IRES(JT).EQ.0)  THEN
               CHI(JT)=YY
            ELSE
C...RELATIVE DISTRIBUTION OF ENERGY; EXTRA PARTON COLOUR CONNECTION
               CALL LREMH(0,KFLSP(JT),KFLCH(JT),CHI(JT))
c               write(6,*) 'from LREMH:',KFLSP(JT),KFLCH(JT),CHI(JT)
            ENDIF
            P(I,1)=-P(JT+2,1)*(1.D0-DBLE(CHI(JT)))
     +       +DBLE(PTSPL*COS(PHISPL))
            P(I,2)=-P(JT+2,2)*(1.D0-DBLE(CHI(JT)))
     +       +DBLE(PTSPL*SIN(PHISPL))
            IF(ISEMIH.EQ.1) THEN
               P(I,1)=-P(IP,1)*DBLE((1.-CHI(JT))+PTSPL*COS(PHISPL))
               P(I,2)=-P(IP,2)*DBLE((1.-CHI(JT))+PTSPL*SIN(PHISPL))
            ENDIF

            PMS(JT+2)=P(I,5)**2+P(I,1)**2+P(I,2)**2
            I=I+2
            ISN(JT)=4
            DO 60 J=1,5
               K(I,J)=0
               K(I+1,J)=0
               P(I,J)=0.D0
   60       P(I+1,J)=0.D0
            K(I,1)=1
            K(I,2)=KFLCH(JT)
            K(I,3)=JT
            P(I,5)=DBLE(ULMASS(K(I,2)))
            P(I,1)=-P(JT+2,1)*DBLE(CHI(JT))-DBLE(PTSPL*COS(PHISPL))
            P(I,2)=-P(JT+2,2)*DBLE(CHI(JT))-DBLE(PTSPL*SIN(PHISPL))
            IF(ISEMIH.EQ.1) THEN
               P(I,1)=-P(IP,1)*DBLE(CHI(JT)-PTSPL*COS(PHISPL))
               P(I,2)=-P(IP,2)*DBLE(CHI(JT)-PTSPL*SIN(PHISPL))
            ENDIF
            PMS(JT+4)=P(I,5)**2+P(I,1)**2+P(I,2)**2
C...end of update
            PMS(JT)=PMS(JT+4)/DBLE(CHI(JT))+PMS(JT+2)/
     +               (1.D0-DBLE(CHI(JT)))
c            write(6,*) ' jt,pms(jt),chi ',jt,pms(jt),chi(JT),yy
c            pause
            K(I+1,1)=-1
            K(I+1,3)=I
            K(I+1,2)=1000
            IF(IPY(34).GE.1) K(I+1,2)=1000+JT
            IF((IABS(KFLCH(JT)).GE.1.AND.IABS(KFLCH(JT)).LE.8).OR.
     +      IABS(KFLCH(JT)).EQ.21.OR.LUCOMP(IABS(KFLCH(JT))).EQ.90)
     +      THEN
               IFLS=(3-ISIGN(1,KFLCH(JT)*(1102-IABS(KFLCH(JT)))))/2
               P(I+1,IFLS+2)=IPU
               P(IPU+1,3-IFLS)=I
               K(I,1)=3
               K(I,IFLS+3)=IPU
               K(IPU,6-IFLS)=MOD(K(IPU,6-IFLS),MSTU(5))+I*MSTU(5)
            ELSE
               IF(IPY(34).GE.1) THEN
                  K(I,1)=1
                  K(I,3)=JT
               ENDIF
            ENDIF
         ENDIF
c           write(6,*) ' jt,pms(jt),pms(1) ',jt,pms(jt),pms(1)
   70 CONTINUE
c      write(6,*) ' ILEP ',ILEP
c      pause 'PYREMN: before goto 40'
      IF(ILEP.GE.1.AND.
     +   SHR.LE.(DSQRT(PMS(1))+DSQRT(DABS(PMS(2))))) THEN
         NTRY = NTRY + 1
         IF(NTRY.LT.500) GOTO 40
c         write(6,*) 'pyremn IPY(48)=2 shr,dsqrt(pms(1)),dsqrt(pms(2))'
c     +    ,shr,dsqrt(pms(1)),dsqrt(pms(2))
c         write(6,*) ' pyremn pt2gen,shr/4 ',pt2gen,shr/4.
c         call lulist(1)
         IPY(48) = 2
         RETURN
      ENDIF


      IF(ILEP.EQ.0.AND.(PMS(1).GT.PSYS(1,4)**2.OR.
     +   PMS(2).GT.PSYS(2,4)**2)) THEN
         NTRY = NTRY + 1
         IF(NTRY.LT.500) GOTO 40
         IPY(48) = 2
         RETURN
      ENDIF
c      write(6,*) 'PYREMN: after goto 40'
c      pause ' PYREMN: bef kin '
c      call dulist(1)
c      pause
      N=I+1
C...RECONSTRUCT KINEMATICS OF REMNANTS
c      write(6,*) 'before remnant pms(1),pms(2) ',pms(1),pms(2)
      DO 80  JT=1,2
         IF((ILEPTO.EQ.1.AND.IRES(JT).EQ.0).OR.(IPY(40+JT)
     +   .EQ.22.AND.IRES(JT).EQ.0)) GOTO 80
         IF(ILEP.EQ.1) THEN
c            write(6,*) ' SHR = ',SHR,' PMS(JT)=',PMS(JT),PMS(3-JT)
c            write(6,*) ' Q2 = ',Q2,' T2 ',T2GKI
c            write(6,*) ' JT = ',JT
            PE=0.5D0*(SHR+(PMS(JT)-PMS(3-JT))/SHR)
            PZ=DSQRT(PE**2-PMS(JT))
c            write(6,*) ' PE,PZ ',PE,PZ
         ELSE
c new ala PYTHIA 5.6
            PE=PSYS(JT,4)
            PZ=DSQRT(PE**2-PMS(JT))
         ENDIF
         IF(KFLCH(JT).EQ.0) THEN
            P(IS(JT),4)=PE
            P(IS(JT),3)=PZ*(-1)**(JT-1)
         ELSE
            PW1=DBLE(CHI(JT))*(PE+PZ)
            P(IS(JT)+2,4)=0.5D0*(PW1+PMS(JT+4)/PW1)
            P(IS(JT)+2,3)=0.5D0*(PW1-PMS(JT+4)/PW1)*(-1)**(JT-1)
            P(IS(JT),4)=PE-P(IS(JT)+2,4)
            P(IS(JT),3)=PZ*(-1)**(JT-1)-P(IS(JT)+2,3)
         ENDIF
         PSYS(JT,3)=PZ*(-1)**(JT-1)
   80 CONTINUE


C...HADRONIC EVENTS: BOOST REMNANTS TO CORRECT LONGITUDINAL FRAME
      IF(ILEP.LE.0) THEN
ccc      CALL DULIST(1)
ccc      pause
C new a la PYTHIA 5.4.....
C... check if longitudinal boost needed - if so pick two systems.
         PDEV = ABS(PSYS(0,4)+PSYS(1,4)+PSYS(2,4) -
     +    DBLE(PYVAR(1)) + ABS(PSYS(0,3)+PSYS(1,3)+PSYS(2,3)))

         IF(PDEV.LE.1.E-6*PYVAR(1).OR. (K(1,2).EQ.22.AND.IRES(1).EQ.0))
     +   RETURN
c           write(6,*) ' now do the boost ',PDEV
c           CALL DULIST(1)
         IF(ISN(1).EQ.0) THEN
            IR=0
            IL=2
         ELSEIF(ISN(2).EQ.0) THEN
            IR=1
            IL=0
         ELSEIF((1.-PYVAR(31)).GT.0.2.AND.(1.-PYVAR(32)).GT.0.2) THEN
            IR=1
            IL=2
         ELSEIF((1.-PYVAR(31)).GT.0.2) THEN
            IR=1
            IL=0
         ELSEIF((1.-PYVAR(32)).GT.0.2) THEN
            IR=0
            IL=2
         ELSEIF(PMS(1)/PSYS(1,4)**2.GT.PMS(2)/PSYS(2,4)**2) THEN
            IR=1
            IL=0
         ELSE
            IR=0
            IL=2
         ENDIF
         IG=3-IR-IL

C...Construct longitudinal boost
         IF((IG.EQ.1.AND.ISN(1).EQ.0).OR.(IG.EQ.2.AND.ISN(2).EQ.0))
     +   THEN
            PPB=DBLE(PYVAR(1))
            PNB=DBLE(PYVAR(1))
         ELSE
            PPB=DBLE(PYVAR(1))-PSYS(IG,4)-PSYS(IG,3)
            PNB=DBLE(PYVAR(1))-PSYS(IG,4)+PSYS(IG,3)
         ENDIF

         PMTB=PPB*PNB
         PMTR=PMS(IR)
         PMTL=PMS(IL)
         SQLAM=DSQRT(DMAX1(0.D0,(PMTB-PMTR-PMTL)**2-4.D0*PMTR*PMTL))
         SQSGN=DSIGN(1.D0,PSYS(IR,3)*PSYS(IL,4)-PSYS(IL,3)*PSYS(IR,4))
         RKR=(PMTB+PMTR-PMTL+SQLAM*SQSGN)/(2.D0*(PSYS(IR,4)+PSYS(IR,3))*
     +   PNB)
         RKL=(PMTB+PMTL-PMTR+SQLAM*SQSGN)/(2.D0*(PSYS(IL,4)-PSYS(IL,3))*
     +   PPB)
         BER=(RKR**2-1.D0)/(RKR**2+1.D0)
         BEL=-(RKL**2-1.D0)/(RKL**2+1.D0)

C...Perform longitudinal boost
         MSTU(1)=0
	   MSTU(2)=0
         IF(IR.EQ.1) THEN
            CALL DUDBRB(IS(1),IS(1)+ISN(1)-2,0.D0,0.D0,0D0,0D0,BER)
         ELSE
            CALL DUDBRB(3,NS,0.D0,0.D0,0D0,0D0,DBLE(BER))
         ENDIF
         IF(IL.EQ.2) THEN
            CALL DUDBRB(IS(2),IS(2)+ISN(2)-2,0.D0,0.D0,0D0,0D0,BEL)
         ELSE
            CALL DUDBRB(3,NS,0.D0,0.D0,0D0,0D0,BEL)
         ENDIF
ccc         call dulist(1)
ccc         pause ' pyremn pythia end '
C...LEPTOPRODUCTION EVENTS: BOOST COLLIDING SUBSYSTEM
      ELSE

         IMIN=21
         MSTU(1) = IMIN
         IMAX=MAX(IP,IPY(47))
         MSTU(2) = IMAX
c         write(6,*) ' PYREMN: before long frame '
c         CALL DULIST(1)
         PZF=PZ*(-1)**(ILEP-1)
         PT2=P(5-ILEP,1)**2+P(5-ILEP,2)**2
         PHIPT=DLANGL(P(5-ILEP,1),P(5-ILEP,2))
         CALL DUDBRB(IMIN,IMAX,0.D0,-PHIPT,0.D0,0.D0,0.D0)
c         write(6,*) ' PYREMN: after phi rot '
c         CALL DULIST(1)
         RQP=P(IQ,3)*(PT2+PEI**2)-P(IQ,4)*PEI*PZI
         SINTH=P(IQ,4)*DSQRT(PT2*(PT2+PEI**2)/(RQP**2+PT2* P(IQ,4)**2*
     +   PZI**2))*DSIGN(1.D0,-RQP)
         CALL DUDBRB(IMIN,IMAX,DASIN(SINTH),0.D0,0.D0,0.D0,0.D0)
c         write(6,*) ' PYREMN: after theta rot '
c         CALL DULIST(1)
         DBETAX=(-PEI*PZI*SINTH+ DSQRT(PT2*(PT2+PEI**2-(PZI*SINTH)*
     +   *2)))/ (PT2+PEI**2)
         CALL DUDBRB(IMIN,IMAX,0.D0,0.D0,DBETAX,0.D0,0.D0)
         CALL DUDBRB(IMIN,IMAX,0.D0,PHIPT,0.D0,0.D0,0.D0)
c         write(6,*) ' PYREMN: after x boost and phi '
c         CALL DULIST(1)
         PEM=P(IQ,4)+P(IP,4)
         PZM=P(IQ,3)+P(IP,3)
c            write(6,*) ' PEM ',PEM,' PZM ',PZM
         DBETAZ=(-PEM*PZM+
     +   PZF*DSQRT(PZF**2+PEM**2-PZM**2))/(PZF**2+PEM**2)
c         write(6,*) ' boost check DBETAZ=',DBETAZ
c         write(6,*) 'PZM,PZF,PEM ',PZM,PZF,PEM
         CALL DUDBRB(IMIN,IMAX,0.D0,0.D0,0.D0,0.D0,DBETAZ)
c         write(6,*) ' PYREMN: after DBETZ '
c         CALL DULIST(1)
         MSTU(1) = 0
         MSTU(2) = 0
         CALL DUDBRB(3,4,DASIN(SINTH),0.D0,DBETAX,0.D0,0.D0)
         CALL DUDBRB(3,4,0.D0,PHIPT,0.D0,0.D0,DBETAZ)
         PEM=P(IQ,4)+P(IP,4)
         PZM=P(IQ,3)+P(IP,3)
c            write(6,*) ' now after last boost '
c            write(6,*) ' PEM ',PEM,' PZM ',PZM
c         write(6,*) ' PYREMN: end '
c         CALL DULIST(1)
c         pause 'PYREMN: END '
c         CALL DULIST(1)
      ENDIF
c      call dulist(1)
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.26  by  Hannes Jung
*CMZ :  2.07/03 23/05/99  15.14.05  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
C*********************************************************************

      SUBROUTINE PYSPLI(KF,KFLIN,KFLCH,KFLSP)
      Implicit None
C...In case of a hadron remnant which is more complicated than just a
C...quark or a diquark, split it into two (partons or hadron + parton).
*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEND.
      Integer KF,KFLIN,KFLCH,KFLSP,KFL,KFA,KFS,KFLR,IAGR,KFDUMP,NAGR
	Integer J,ID1,ID2,KSP
      DIMENSION KFL(3)
	Integer LST,IRES
      COMMON/EPPARA/LST(30),IRES(2)
	Double Precision draprn
	real RAGR
C...Preliminaries. Parton composition.
      KFA=IABS(KF)
      KFS=ISIGN(1,KF)
      KFL(1)=MOD(KFA/1000,10)
      KFL(2)=MOD(KFA/100,10)
      KFL(3)=MOD(KFA/10,10)
      IF(KFA.EQ.22.AND.MSTP(14).EQ.2) THEN
         KFL(2)=INT(1.5+draprn())
         KFL(3)=KFL(2)
ctest      ELSEIF((KFA.EQ.111.OR.KFA.EQ.113).AND.draprn().GT.0.5) THEN
      ELSEIF(KFA.EQ.113.AND.draprn().GT.0.5) THEN
         KFL(2)=2
         KFL(3)=2
      ELSEIF(KFA.EQ.223.AND.draprn().GT.0.5) THEN
         KFL(2)=1
         KFL(3)=1
      ENDIF
      IF(KFLIN.NE.21.AND.KFLIN.NE.22.AND.KFLIN.NE.23) THEN
         KFLR=KFLIN*KFS
      ELSE
         KFLR=KFLIN
      ENDIF
      KFLCH=0

C...Subdivide lepton.
      IF(KFA.GE.11.AND.KFA.LE.18) THEN
c     in case of resolved photon
         IF(KFLIN.EQ.21) THEN
            KFLSP = KFLIN*KFS
            KFLCH = KFA
         ELSEIF(IABS(KFLIN).LT.6) THEN
            KFLSP = KFLIN
            KFLCH = KFA
         ELSEIF(KFLIN.EQ.22) THEN
            KFLSP = KFLIN*KFS
            KFLCH = KFA
         ENDIF
C...Subdivide photon.
      ELSEIF(KFA.EQ.22) THEN
         IF(KFLR.NE.21.AND.KFLR.LE.6) THEN
            KFLSP=-KFLR
            KFLCH = 0
         ELSE
            KFLSP = KFLIN
            KFLCH = 0
         ENDIF
c.. changed for pomeron
      ELSEIF(KFA.EQ.100) THEN
c         write(6,*) ' PYSPLI: here for pomeron splitting KFLIN: ',KFLIN
         IF(KFLIN.EQ.21) THEN
            KFLCH = 0
            KFLSP = 21
         ELSE
            KFLCH = 0
            KFLSP = -KFLIN
         ENDIF
c          write(6,*) 'PYSPLI: KFLCH ',KFLCH,' KFLSP = ',KFLSP
C...Subdivide meson.
      ELSEIF(KFL(1).EQ.0) THEN
         KFL(2)=KFL(2)*(-1)**KFL(2)
         KFL(3)=-KFL(3)*(-1)**IABS(KFL(2))
         IF(KFLR.EQ.KFL(2)) THEN
            KFLSP=KFL(3)
         ELSEIF(KFLR.EQ.KFL(3)) THEN
            KFLSP=KFL(2)
         ELSEIF(KFLR.EQ.21.AND.draprn().GT.0.5) THEN
            KFLSP=KFL(2)
            KFLCH=KFL(3)
         ELSEIF(KFLR.EQ.21) THEN
            KFLSP=KFL(3)
            KFLCH=KFL(2)
         ELSEIF(KFLR*KFL(2).GT.0) THEN
            CALL LUKFDI(-KFLR,KFL(2),KFDUMP,KFLCH)
            KFLSP=KFL(3)
         ELSE
            CALL LUKFDI(-KFLR,KFL(3),KFDUMP,KFLCH)
            KFLSP=KFL(2)
         ENDIF

C...Subdivide baryon.
      ELSE
         NAGR=0
         DO 10 J=1,3
   10    IF(KFLR.EQ.KFL(J)) NAGR=NAGR+1
         IF(NAGR.GE.1) THEN
            RAGR=0.00001+(NAGR-0.00002)*draprn()
            IAGR=0
            DO 20 J=1,3
               IF(KFLR.EQ.KFL(J)) RAGR=RAGR-1.
   20       IF(IAGR.EQ.0.AND.RAGR.LE.0.) IAGR=J
         ELSE
            IAGR=INT(1.00001+2.99998*draprn())
         ENDIF
         ID1=1
         IF(IAGR.EQ.1) ID1=2
         IF(IAGR.EQ.1.AND.KFL(3).GT.KFL(2)) ID1=3
         ID2=6-IAGR-ID1
         KSP=3
         IF(MOD(KFA,10).EQ.2.AND.KFL(1).EQ.KFL(2)) THEN
            IF(IAGR.NE.3.AND.draprn().GT.0.25) KSP=1
         ELSEIF(MOD(KFA,10).EQ.2.AND.KFL(2).GE.KFL(3)) THEN
            IF(IAGR.NE.1.AND.draprn().GT.0.25) KSP=1
         ELSEIF(MOD(KFA,10).EQ.2) THEN
            IF(IAGR.EQ.1) KSP=1
            IF(IAGR.NE.1.AND.draprn().GT.0.75) KSP=1
         ENDIF
         KFLSP=1000*KFL(ID1)+100*KFL(ID2)+KSP
         IF(KFLR.EQ.21) THEN
            KFLCH=KFL(IAGR)
         ELSEIF(NAGR.EQ.0.AND.KFLR.GT.0) THEN
            CALL LUKFDI(-KFLR,KFL(IAGR),KFDUMP,KFLCH)
         ELSEIF(NAGR.EQ.0) THEN
            CALL LUKFDI(10000+KFLSP,-KFLR,KFDUMP,KFLCH)
            KFLSP=KFL(IAGR)
         ENDIF
      ENDIF

C...Add on correct sign for result.
      KFLCH=KFLCH*KFS
      KFLSP=KFLSP*KFS

      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.26  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  18.07.54  by  Hannes Jung
*CMZ :  2.07/03 23/05/99  18.05.05  by  Hannes Jung
*CMZ :          23/05/99  15.18.18  by  Hannes Jung
C from PYTHIA 4.8 manual
C IPY(14) (D=2) details of initial state parton showers
C         =0    not included
C         >=1   included
C NEW
C IORDER  =0    no ordering
C         =1    Q2 values at branches are strictly ordered, increasing towards
C               the hard scattering
C         =2    Q2 and opening angles of emitted (on shell or time like) partons
C               are both strictly ordered, increasing towards the hard
C               interaction.
C
C IALPS   =0
C         =1    alphas first order with scale Q2
C         =2    alphas first order with scale k_t**2=(1-z)*Q2
C
C ITIMSHR =0    no shower of time like partons
C         =1    time like partons may shower
C ISOFTG (D=1) treatment of soft gluons
C         =0    soft gluons are entirely neglected
C         =1    soft gluons are resummed and included together with the hard
C               radiation as an effective z shift.
C
C PYPAR(23) (D=2) effective minimum energy (in CM frame)  of timelike or
C               on shell parton emitted in spacelike showers.
C PYPAR(24) (D=0.001) effective lower cutoff in 1-z in spacelike showers
C               in addition to PYPAR(23)
*-- Author :    Hannes Jung   03/04/94


C.. THIS IS A COPY FROM LEPTO61
C.  CHANGE for photoproduction and gamma glu fusion

      SUBROUTINE PYSSPA(IPU1,IPU2)
      IMPLICIT None
C...NEW X REDEFINITION
C...GENERATES SPACELIKE PARTON SHOWERS
      REAL CUT,XLP,YLP,W2LP,Q2LP,ULP
      DOUBLE PRECISION PARL
	Integer LLST
      COMMON /RAPTOU/ CUT(14),LLST(40),PARL(30),XLP,YLP,W2LP,Q2LP,ULP
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEND.
      REAL PYPAR,PYVAR
	Integer IPY
      COMMON /PYPARA/ IPY(80),PYPAR(80),PYVAR(80)
      REAL X,SH,TH,UH,Q2
	Integer ISUB,KFL
      COMMON /PYPROC/ ISUB,KFL(3,2),X(2),SH,TH,UH,Q2
      REAL XQ
      COMMON /MYINT1/ XQ(2,-6:6)
      REAL XA,XFA,XB,XFB,Q2REF,XBMIN
      DOUBLE PRECISION ROBO,THE
	Integer IFLS
	Double Precision xs,zs,q2s,tevs,xfs,wtap,wtsf
      DIMENSION IFLS(4),IS(2),XS(2),ZS(2),Q2S(2),TEVS(2),ROBO(5),
     +XFS(2,-6:6),XFA(-6:6),XFB(-6:6),WTAP(-6:6),WTSF(-6:6)
c     +XFS(2,-6:6),XFA(-25:25),XFB(-25:25),WTAP(-6:6),WTSF(-6:6)
      DOUBLE PRECISION DQ2(3),DSH,DSHZ,DSHR,DPLCM,DPC(3),DPD(4),DMS,
     +DMSMA,DPT2,DPB(4),DBE1(4),DBE2(4),DBEP,DGABEP,DPQ(4),DPQS(2),
     +DM2,DQ2B,DROBO(5),DBEZ,THE2(2)
C-GI &DQ23,DPH(4),DM2,DQ2B,DQM2
c.hju
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEND.
      Double Precision draprn
	Real QMAX
      EXTERNAL draprn
	Integer LST,IRES
      COMMON/EPPARA/ LST(30),IRES(2)
      REAL SNGL
	Integer I,J,NS,IFLA,IFLB,NQ,IS,IPU1,IPU2,iremp,isea,ilep,ipo
	Integer i1,i2,itemp,ikin,kn1,kd1,ir,jb,id1,id2
	Integer ntry,ntry2,nprint,ncall,ifl,jt,IHFC,IHFX,IHFT,jr,it
	Double Precision z,xe,xe0,q2e,tmax,b0,q2b,tevb,qmass,wtapq,wtsum
	Double Precision VALENCE,SEARN,WTRAN,WTZ,XBNEW,RSOFT,ZU,ALPRAT
	Double Precision THE2T
      LOGICAL LAST
      LOGICAL LPRINT,FIRST
      LOGICAL OLDEPS
*KEEP,PSHWR.
      INTEGER IORDER,IALPS,ITIMSHR,ISOFTG,ICCFM
      COMMON /PSHWR/IORDER,IALPS,ITIMSHR,ISOFTG,ICCFM
*KEND.
      DATA LPRINT/.TRUE./
      DATA FIRST/.TRUE./
      DATA OLDEPS/.FALSE./
      DATA NPRINT /0/
      DATA NCALL /0/
      DATA IFLA,NQ/0,0/,Z,XE0,XA/3*0./,DSHZ,DMSMA,DPT2,DSHR/4*0.D0/
      DATA IS/2*0/
c set flag for epsilon treatment
c      OLDEPS = .TRUE.
cccccccccccccccccccccccccccccccc
      NTRY = 0
      NCALL = NCALL + 1
      IF(NCALL.GE.NPRINT) LPRINT=.FALSE.
c set flag for new remnant treatment (motivated by LEPTO 6.5)
      IREMP = 1
      LAST=.FALSE.
      ISEA = 0
c no special sea quark treatment for pomeron
      IF(IPY(42).EQ.100) IREMP = 0
c no special sea quark treatment for resolved gammas
      IF(IPY(41).EQ.22) IREMP = 0
C...COMMON CONSTANTS, SET UP INITIAL VALUES
      ILEP=0
      IF(IPU1.EQ.0) ILEP=1
      IF(IPU2.EQ.0) ILEP=2
      IF(ILEP.eq.1.and.ILEPTO.eq.0) ILEP=0
cccc
      PYPAR(23)=0.0
check pypar
cccc      PYPAR(23)=4.0
cccc
      IF(ILEP.EQ.0) PYPAR(23)=2.0
      DO 10  I=1,3
   10 DQ2(I) = 0.D0
      SH=SNGL(P(25,5)**2)
      IF(N.GE.27) SH=SNGL(P(27,5)**2)
      IF(IPRO.EQ.99) SH=SNGL(P(28,5)**2)
      CALL LSCALE(-1,QMAX)
      Q2E=DBLE(QMAX**2)
      TMAX=DLOG(Q2E/DBLE(PYPAR(21)**2))
      IF(LPRINT) THEN
         write(6,*) ' pysspa TMAX,PYPAR(26),PYPAR(27),Q2E,PYPAR(21)',
     +   TMAX,PYPAR(26),PYPAR(27),Q2E,PYPAR(21)
      ENDIF


      IF(ILEP.GE.1) THEN

         SH=SNGL(P(25,5)**2)
         IF(N.GE.27) SH=SNGL(P(27,5)**2)
         IF(IPRO.EQ.99) SH=SNGL(P(28,5)**2)
         CALL LSCALE(-1,QMAX)
         Q2E=DBLE(QMAX**2)
c.hju        Q2E=MAX(PYPAR(21)**2,MIN(Q2E,(0.95/X(3-ILEP)-1.)*Q2-SH,
c.hju     &  Q2/2.+SH))
c.hju        Q2E=MAX(PYPAR(21)**2,MIN(Q2E,(0.95/X(3-ILEP)-1.)*Q2LP-SH,
c.hju     &  Q2LP/2.+SH))
c.hju        Q2E=MAX(PYPAR(21)**2,MIN(Q2E,(1.-x(3-ilep))*PARL(22),
c.hju     &  Q2LP/2.+SH))
         Q2E=DMAX1(DBLE(PYPAR(21)**2), DMIN1(Q2E,DBLE(-Q2LP+PYVAR(31)*
     +   SNGL(PARL(21))-SH), DBLE(Q2LP/2.+SH)))
         TMAX=DLOG(Q2E/DBLE(PYPAR(21))**2)
      ENDIF
      IF(LPRINT) THEN
         write(6,*) ' start pysspa ',PYPAR(26)*sngl(Q2E),
     +   MAX(PYPAR(22),2.*PYPAR(21)**2)
         write(6,*) 'Q2E ',Q2E,' SH ',SH,' Q2LP ',Q2LP,PYVAR(31),
     +   PARL(21)
      ENDIF
      IF(SNGL(Q2E).LT.MAX(PYPAR(22),2.*PYPAR(21)**2).OR.
     +TMAX.LT.0.2) THEN
         IF(LPRINT) THEN
            write(6,*) ' PYYSPA 1st check: '
            write(6,*) ' PYPAR(26)=',PYPAR(26),' PYPAR(22)',PYPAR(22)
            write(6,*) ' PYPAR(21) ',PYPAR(21)
            write(6,*) ' SH ',SH,' Q2LP ',Q2LP,PYVAR(31),PARL(21)
            write(6,*) ' -Q2LP+PYVAR(31)*PARL(21)-SH', -Q2LP+PYVAR(31)*
     +      sngl(PARL(21))-SH
            write(6,*) ' Q2E ',Q2E,' TMAX ',TMAX
            write(6,*) ' QMAX ',QMAX,' SH ',SH,IPRO
         ENDIF
         LST(21)=55
         RETURN
      ENDIF
      IF(LPRINT) write(6,*) 'pysspa:check ok '
      IF(ILEP.EQ.0) XE0=DBLE(2.*PYPAR(23)/PYVAR(1))
      B0=DBLE((33.-2.*IPY(8))/6.)
      NS=N
      MSTU(2)=0
   20 N=NS
      IF(ILEP.GE.1) THEN
         NQ=IPU2-2
         IF(ILEP.EQ.2) NQ=IPU1+2
         DPQS(1)=P(NQ,3)
         DPQS(2)=P(NQ,4)
         IF(IPRO.EQ.12) THEN
            XBMIN=X(3-ILEP)*MAX(0.5,SH/Q2LP)
            CALL PYSTFU(IPY(43-ILEP),XBMIN,Q2,XFB)
cccccc        write(6,*) ' XFB = ',(XFB(i),i=-6,6)
            DO 30  IFL=-6,6
   30       XQ(3-ILEP,IFL)=XFB(IFL)
         ENDIF
      ENDIF
      DO 40  JT=1,2
         IFLS(JT)=KFL(2,JT)
         IF(KFL(2,JT).EQ.21) IFLS(JT)=0
         IFLS(JT+2)=IFLS(JT)
         XS(JT)=DBLE(X(JT))
         ZS(JT)=1.D0
         IF(ILEP.EQ.0) Q2S(JT)=Q2E
         THE2(JT)=100.D0
         TEVS(JT)=TMAX
ccc         write(6,*) ' TEVS,JT,TMAX',TEVS(JT),JT,TMAX
         DO 40 IFL=-6,6
c.. checking x values HJU
cccc            IF(XS(JT).GT.0.8.and.Ilep.ne.0) XQ(JT,IFL) = 0.
            IF(XS(JT).GT.0.8) XQ(JT,IFL) = 0.
c switch off ps from photon....
cccc            IF(ILEP.EQ.0) XQ(1,IFL) = 0.
c.. end checking
   40 XFS(JT,IFL)=DBLE(XQ(JT,IFL))
      IF(ILEP.GE.1) THEN
         Q2S(ILEP)=P(NQ,5)**2
         DQ2(ILEP)=Q2S(ILEP)
c         write(6,*) 'Q2E ',Q2E
         Q2S(3-ILEP)=Q2E
      ENDIF
cadded
      IF(ISEMIH.EQ.1) THEN
         Q2S(2)=P(IPU2,5)**2
         DQ2(2)=Q2S(2)
ccc       write(6,*) ' pysspa ISEMIH:',DQ2(2)
      ENDIF
      DSH=DBLE(SH)
      IHFC=0
      IHFX=0

C...PICK UP LEG WITH HIGHEST VIRTUALITY
   50 CONTINUE
      IF(N.GT.MSTU(4)-10) THEN
         WRITE(6,*) ' PYSSPA: no more memory in LUJETS'
         LST(21)=51
         RETURN
      ENDIF
      DO 60  I=N+1,N+8
         DO 60 J=1,5
            K(I,J)=0
   60 P(I,J)=0.D0
C     CALL GULIST(21,2)
      N=N+2
      JT=1
      IF((N.GT.NS+2.AND.Q2S(2).GT.Q2S(1).AND.ILEP.EQ.0).OR.ILEP.EQ.1)
     +JT=2
      IF(LPRINT) THEN
         write(6,*) ' pysspa JT,Q2S(1),Q2S(2) ',JT,Q2S(1),Q2S(2)
      ENDIF
      JR=3-JT
      IFLB=IFLS(JT)
      XB=SNGL(XS(JT))
c.hju      IF(ILEP.GE.1.AND.N.EQ.NS+2) XB=XS(JT)*MAX(SH/Q2,0.5)
      IF(ILEP.GE.1.AND.N.EQ.NS+2.AND.IPRO.EQ.12)
     +                     XB=SNGL(XS(JT))*MAX(SH/Q2LP,0.5)
      DO 70  IFL=-6,6
   70 XFB(IFL)=SNGL(XFS(JT,IFL))

      Q2B=Q2S(JT)
      TEVB=TEVS(JT)
      IF(IORDER.EQ.0) THEN
         IF(ZS(JT).GT.0.9999) THEN
            Q2B=Q2S(JT)
         ELSE
            Q2B=0.5D0*(1.D0/ZS(JT)+1.D0)*Q2S(JT)+0.5D0*(1.D0/ZS(JT)-
     +      1.D0) *(Q2S(3-JT)- DSH+DSQRT((DSH+Q2S(1)+Q2S(2))**2+8.D0*
     +      Q2S(1)*Q2S(2)* ZS(JT)/(1.D0-ZS(JT))))
         ENDIF
         TEVB=DLOG(Q2B/DBLE(PYPAR(21)**2))
      ENDIF
      IF(ILEP.EQ.0) THEN
         DSHR=2.D0*DSQRT(DSH)
         DSHZ=DSH/DBLE(ZS(JT))
      ELSEIF(ILEP.GE.1) THEN
         DSHZ=DSH
         IF(N.GT.NS+4) DSHZ=(DSH+DQ2(JR)-DQ2(JT))/ZS(JT)-DQ2(JR)+
     +   DBLE(PYPAR(22))
         DPD(2)=DSHZ+DQ2(JR)+DBLE(PYPAR(22))

         QMASS=DBLE(ULMASS(IABS(IFLB)))
         IF(IABS(IFLB).EQ.0) QMASS=DBLE(ULMASS(21))
C...CHECK IF QUARK PAIR CREATION ONLY POSSIBILITY
         IF(DQ2(JR).LE.4.D0*QMASS**2) THEN
            DM2=QMASS**2
            DPC(1)=DQ2(JR)*(DBLE(PYPAR(22))+DM2)**2
            DPC(2)=DPD(2)*(DPD(2)-2D0*DBLE(PYPAR(22)))*
     +       (DBLE(PYPAR(22))+DM2)
            DPC(3)=DBLE(PYPAR(22))*(DPD(2)-2D0*DBLE(PYPAR(22)))**2
c.hju here are few changes for Q2 = 0
            IF(Q2LP.GE.0.5*PYPAR(22)) THEN
               XE0=1D0-(DPC(2)-DSQRT(DPC(2)**2-4D0*DPC(1)*DPC(3)))/
     +         (2D0*DPC(1))
            ELSE
               XE0=1.D0-(DBLE(PYPAR(22))*(DPD(2)-2D0*DBLE(PYPAR(22)))
     +         /DPD(2)/(DBLE(PYPAR(22))+DM2))
            ENDIF
            if(oldeps) then
            else
               XE0 = dble(xb)*xe0/(1.d0 - xe0)
            endif
c.hju end of changes
         ELSE
c.hju here are few changes for Q2 = 0
            IF(Q2LP.GE.0.5*PYPAR(22)) THEN
               XE0=1D0-(DPD(2)-2D0*DBLE(PYPAR(22)))*(DPD(2)-
     +         DSQRT(DPD(2)**2- 4D0*DQ2(JR)*DBLE(PYPAR(22))))/(2D0*
     +         DQ2(JR)*DBLE(PYPAR(22)))
            ELSE
               XE0=1.D0-(DBLE(PYPAR(22))*(DPD(2)-2D0*DBLE(PYPAR(22)))
     +          /DPD(2)/DBLE(PYPAR(22)))
            ENDIF
            if(oldeps) then
            else
               XE0 = dble(xb)*xe0/(1.d0 - xe0)
            endif
         ENDIF
         if(oldeps) then
         else
c include fixed cut off to avoid soft gluons
c also solves energy momentum conservation problem
            XE0=DMAX1(XE0,2.D0*DBLE(PYPAR(23))/DSQRT(PARL(21)))
         endif
      ENDIF
   80 XE=DMAX1(XE0,DBLE(XB)*(1.d0/(1.d0-DBLE(PYPAR(24)))-1.d0))
      IF(XB+SNGL(XE).GE.0.999) THEN
         Q2B=0.D0
         IF(LPRINT) THEN
            write(6,*) ' here goto 150 ',XB,XE
         ENDIF
         GOTO 180
      ENDIF
      IF(LPRINT) THEN
         write(6,*) 'calc A P weights ',JT
      ENDIF
C...CALCULATE ALTARELLI-PARISI AND STRUCTURE FUNCTION WEIGHTS
      DO 90  IFL=-6,6
         WTAP(IFL)=0.D0
   90 WTSF(IFL)=0.D0
      IF(IFLB.EQ.0) THEN
         WTAPQ=DBLE(16.*(1.-SQRT(XB+SNGL(XE)))/(3.*SQRT(XB)))
         DO 100 IFL=-IPY(8),IPY(8)
            IF(IFL.EQ.0) WTAP(IFL)=6.D0*DLOG((1.D0-DBLE(XB))/XE)
  100    IF(IFL.NE.0) WTAP(IFL)=WTAPQ
      ELSE
         WTAP(0)=0.5D0*DBLE(XB)*(1.D0/(DBLE(XB)+XE)-1.D0)
         WTAP(IFLB)=8.D0*DLOG((1.D0-DBLE(XB))*(DBLE(XB)+XE)/XE)/3.D0
      ENDIF
  110 NTRY = NTRY+1
      IF(NTRY.GT.500) THEN
         LST(21)=56
         RETURN
      ENDIF
      WTSUM=0.D0
      IF(IHFC.EQ.0) THEN
         DO 120 IFL=-IPY(8),IPY(8)
            IF(LPRINT) THEN
               write(6,*) ' in loop IFL,IFLB,XFB(IFL)',IFL,IFLB,
     +         XFB(IFL)
            ENDIF
            WTSF(IFL)=DBLE(XFB(IFL)/MAX(1E-10,XFB(IFLB)))
  120    WTSUM=WTSUM+WTAP(IFL)*WTSF(IFL)
         IF(IABS(IFLB).GE.4.AND.WTSUM.GT.1E3) THEN
            IHFX=1
            DO 130 IFL=-IPY(8),IPY(8)
  130       WTSF(IFL)=WTSF(IFL)*1D3/WTSUM
            WTSUM=1D3
         ENDIF
      ENDIF

C...CHOOSE NEW T AND FLAVOUR
      IF(LPRINT) THEN
         write(6,*) ' before : TEVB,B0,WTSUM',TEVB,B0,WTSUM
      ENDIF
      NTRY2 = 0
  140 NTRY2 = NTRY2 + 1
      IF(NTRY2.GT.500) THEN
         LST(21)=56
         RETURN
      ENDIF
      IF(IALPS.EQ.1) THEN
         TEVB =TEVB*draprn()**(B0/DMAX1(0.0001d0,WTSUM))
      ELSEIF(IALPS.EQ.2) THEN
         TEVB =TEVB*draprn()**(B0/DMAX1(0.0001d0,5.D0*WTSUM))
      ELSE
         write(6,*) ' fatal IALPS not selected ',IALPS
         write(6,*) ' PROGRAM STOPPED '
         STOP
      ENDIF
c translate t into Q2 scale
      Q2REF=PYPAR(21)**2*EXP(SNGL(TEVB))
      IF(LPRINT) THEN
         write(6,*) 'TEVB ',TEVB,' WTSUM ',WTSUM,' Q2REF ',Q2REF
      ENDIF
      Q2B=DBLE(Q2REF)
      DQ2B=Q2B
      IF(ILEP.GE.1) THEN
         DSHZ=DSH
         IF(N.GT.NS+4) DSHZ=(DSH+DQ2(JR)-DQ2(JT))/DBLE(ZS(JT))-DQ2(JR)+
     +   DQ2B
      ENDIF
      ISEA = 0
      IF(LPRINT) THEN
         write(6,*) ' pysspa IPY(42)',IPY(42)
      ENDIF
      IF(IPY(40+JT).EQ.22) THEN
check that Q2B > Q2LP (virtuality of photon) for resolved gammas
         IF(Q2B.LE.Q2LP) THEN
            IF(LPRINT) THEN
               write(6,*) 'res.gamma  Q2B,Q2LP ',Q2B,Q2LP
            ENDIF
            Q2B=0.D0
         ENDIF
      ENDIF
changed      IF(Q2B.LT.PYPAR(22).AND.IREMP.EQ.1.AND.LAST) THEN
      IF(Q2B.LT.PYPAR(22).AND.IREMP.EQ.1.AND.LAST.AND.
     +IPY(40+JT).NE.22) THEN
         IREMP = 0
c check if last parton was valence or sea parton
         IF(IFLB.NE.0) THEN
            VALENCE =  DBLE(XFB(IFLB)-XFB(-IFLB))
            IF(LPRINT) THEN
               write(6,*) ' PYSSPA: IFLB,XFB(IFLB),VALENCE', IFLB,
     +         XFB(IFLB),XFB(-IFLB),VALENCE
            ENDIF
            SEARN = draprn()
            IF(LPRINT) THEN
               write(6,*) ' PYSSPA SEA ',SEARN,sngl(VALENCE)/XFB(IFLB)
            ENDIF
            IF(VALENCE.LT.1.D-5) THEN
               ISEA = 1
            ELSE
               IF(SEARN.GT.DABS(VALENCE/DBLE(XFB(IFLB)))) ISEA = 1
            ENDIF
         ENDIF
         IF(ISEA.EQ.1) THEN
            IF(LPRINT) THEN
               write(6,*) ' pysspa ISEA = ',ISEA
            ENDIF
            IFLA = 0
            Q2B = DBLE(PYPAR(22))
            DQ2B = Q2B
            IF(ILEP.GE.1) THEN
               DSHZ=DSH
               IF(N.GT.NS+4) DSHZ=(DSH+DQ2(JR)-DQ2(JT))/DBLE(ZS(JT))-
     +         DQ2(JR)+DQ2B
            ENDIF
         ENDIF
      ENDIF
      IF(Q2B.LT.PYPAR(22).AND.ISEA.EQ.0) THEN
         IF(LPRINT) THEN
            write(6,*) ' Q2B =',Q2B,PYPAR(22),ISEA
         ENDIF
         Q2B=0.D0
      ELSE
         IF(ISEA.EQ.1) GOTO 160
         LAST=.TRUE.
         IF(LPRINT) THEN
            write(6,*) '2nd. JT = ',JT,Q2B
         ENDIF
         WTRAN=draprn()*WTSUM
         IFLA=-IPY(8)-1
  150    IFLA=IFLA+1
         WTRAN=WTRAN-WTAP(IFLA)*WTSF(IFLA)
         IF(IFLA.LT.IPY(8).AND.WTRAN.GT.0.) GOTO 150
  160    CONTINUE
C...CHOOSE Z VALUE AND CORRECTIVE WEIGHT
c... g --> g + g.
         IF(IFLB.EQ.0.AND.IFLA.EQ.0) THEN
            Z=DBLE(1./(1.+((1.-XB)/XB)*(SNGL(XE)/(1.-XB))**draprn()))
            WTZ=(1.D0-Z*(1.D0-Z))**2
c... q --> g + q
         ELSEIF(IFLB.EQ.0) THEN
            Z=DBLE(XB/(1.-draprn()*(1.-SQRT(XB+SNGL(XE))))**2)
            WTZ=0.5D0*(1.D0+(1.D0-Z)**2)*DSQRT(Z)
c... g --> q + q_bar
         ELSEIF(IFLA.EQ.0) THEN
            Z=DBLE(XB*(1.+draprn()*(1./(XB+SNGL(XE))-1.)))
            WTZ=1.D0-2.D0*Z*(1.D0-Z)
c... q --> q + g.
         ELSE
            Z=DBLE(1.-(1.-XB)*(SNGL(XE)/((XB+SNGL(XE))*
     +       (1.-XB)))**draprn())
            WTZ=0.5D0*(1.D0+Z**2)
         ENDIF
c         pause 'after z '
C...REWEIGHT FIRST LEG BECAUSE OF MODIFIED XB OR CHECK PHASE SPACE
         IF(ILEP.GE.1.AND.N.EQ.NS+2) THEN
            IF(IPRO.EQ.12) THEN
               XBNEW=DBLE(X(JT))*(1.D0+(DSH-Q2B)/DQ2(JR))
            ELSE
c. new calculation for first x_g rescaling
               XBNEW=DBLE(X(JT))*(1.D0 + (DQ2(JR)-Q2B)/DSH)
            ENDIF
            IF(XBNEW.GT.MIN(Z,0.999d0)) GOTO 140
            XB=SNGL(XBNEW)
         ENDIF
         IF(ISEA.EQ.1) GOTO 170
C...SUM UP SOFT GLUON EMISSION AS EFFECTIVE Z SHIFT
         IF(ISOFTG.GE.1) THEN
            RSOFT=6.D0
            IF(IFLB.NE.0) RSOFT=8.D0/3.D0
            Z=Z*(TEVB/TEVS(JT))**(RSOFT*XE/((DBLE(XB)+XE)*B0))
            IF(Z.LE.XB) GOTO 140
         ENDIF
C...CHECK IF HEAVY FLAVOUR BELOW THRESHOLD
         IHFT=0
         IF(ILEP.GE.1.AND.IABS(IFLB).GE.4.AND.(XFB(IFLB).LT.1E-10.OR.
     +   Q2B.LT.5.*ULMASS(IABS(IFLB))**2)) THEN
            IHFT=1
            IFLA=0
         ENDIF
c include this also for res gammas
         IF(ILEP.EQ.0.AND.IABS(IFLB).GE.4.AND.(XFB(IFLB).LT.1E-10.OR.
     +   Q2B.LT.5.*ULMASS(IABS(IFLB))**2)) THEN
            IHFT=1
            IFLA=0
         ENDIF

C...FOR LEPTOPRODUCTION, CHECK Z AGAINST NEW LIMIT
         IF(ILEP.GE.1) THEN
            DPD(2)=DSHZ+DQ2(JR)+DQ2B
            DM2=DBLE(ULMASS(IABS(IFLA-IFLB))**2)
            IF(IABS(IFLA-IFLB).EQ.0) DM2=DBLE(ULMASS(21)**2)
            DPC(1)=DQ2(JR)*(DQ2B+DM2)**2
            DPC(2)=DPD(2)*(DPD(2)-2D0*DQ2B)*(DQ2B+DM2)
            DPC(3)=DQ2B*(DPD(2)-2D0*DQ2B)**2
c.hju here are few changes for Q2 = 0
            IF(Q2LP.GE.0.5*PYPAR(22)) THEN
               ZU=(DPC(2)-DSQRT(DPC(2)**2-4D0*DPC(1)*DPC(3)))/(2D0*
     +         DPC(1))
            ELSE
               ZU = DQ2B*(DPD(2)-2D0*DQ2B)/DPD(2)/(DQ2B+DM2)
            ENDIF
c.end of changes for Q2 = 0
c            write(6,*) ' Z limit ',Z,ZU
            IF(Z.GE.ZU) GOTO 140
         ENDIF
changed
C...OPTION WITH EVOLUTION IN KT2=(1-Z)Q2:
changed         IF(IPY(14).GE.5.AND.IPY(14).LE.6.AND.N.LE.NS+4) THEN
C...CHECK THAT (Q2)LAST BRANCHING < (Q2)HARD
changed            IF(LPRINT) write(6,*) ' check branching '
changed            IF(Q2B/(1.D0-Z).GT.PYPAR(26)*Q2) GOTO 140
changed         ELSEIF(IPY(14).GE.3.AND.IPY(14).LE.6.AND.N.GE.NS+6) THEN
C...CHECK THAT Z,Q2 COMBINATION IS KINEMATICALLY ALLOWED
changed            IF(LPRINT) write(6,*) 'check z,Q2 combination'
changed            Q2MAX=0.5D0*(1.D0/ZS(JT)+1.D0)*DQ2(JT)+0.5D0*
changed     +       (1.D0/ZS(JT)-1.D0)*
changed     +      (DQ2(3-JT)-DSH+SQRT((DSH+DQ2(1)+DQ2(2))**2+
changed     +      8.D0*DQ2(1)*DQ2(2)
changed     +      * ZS(JT)/(1.D0-ZS(JT))))
changed            IF(Q2B/(1.D0-Z).GE.Q2MAX) GOTO 140
changed         ENDIF
         IF(IALPS.GE.2) THEN
C...OPTION WITH ALPHAS((1-Z)Q2): DEMAND KT2 > CUTOFF, REWEIGHT
            IF((1.D0-Z)*Q2B.LT.PYPAR(22)) GOTO 140
            ALPRAT=TEVB/(TEVB+DLOG(1.D0-Z))
            IF(ALPRAT.LT.5.*draprn()) GOTO 140
            IF(ALPRAT.GT.5.) WTZ=WTZ*ALPRAT/5.D0
         ENDIF
check for angular ordering
         IF(IORDER.EQ.2.AND.NTRY2.LT.200) THEN
            THE2T=(4.D0*Z**2*Q2B)/(dble(PYVAR(1))*(1.D0-Z)*dble(XB)**2)
            IF(THE2T.GT.THE2(JT)) GOTO 140
         ENDIF
C...WEIGHTING WITH NEW STRUCTURE FUNCTIONS
         IF(LPRINT) THEN
            write(6,*) 'CALL PYSTFU(IPY(40+JT),XB,Q2REF,XFB)',IPY(40+
     +      JT)
            write(6,*) ' Q2REF,Q2LP ',Q2REF,Q2LP
         ENDIF
         CALL PYSTFU(IPY(40+JT),XB,Q2REF,XFB)
         XA=XB/SNGL(Z)
         IF(LPRINT) THEN
            write(6,*) 'CALL PYSTFU(IPY(40+JT),XA,Q2REF,XFA)',IPY(40+
     +      JT)
         ENDIF
         CALL PYSTFU(IPY(40+JT),XA,Q2REF,XFA)
         IF(IHFT.EQ.1.OR.IHFX.EQ.1) THEN
            IF(XFA(IFLA).LT.1E-10) IHFC=1
            IF(LPRINT) THEN
               write(6,*) 'IFLA = ',IFLA,' xa ',xa,ipy(40+JT), XFA(IFLA
     +         ),Q2REF
               write(6,*) ' goto 180 '
            ENDIF
            GOTO 180
         ELSEIF(XFB(IFLB).EQ.0.0) THEN
            IF(LPRINT) THEN
               write(6,*) 'IFLB = ',IFLB,' xb ',xb,ipy(40+JT), XFB(IFLB
     +         ),Q2REF
               write(6,*) ' return '
            ENDIF
            LST(21) = 54
c            pause
            RETURN
         ELSEIF(XFB(IFLB).LT.1E-20) THEN
            IF(LPRINT) THEN
               write(6,*) ' goto 110 '
            ENDIF
            GOTO 110
         ENDIF
         IF(LPRINT) THEN
            write(6,*) 'WTZ,XFA(IFLA)/XFB(IFLB),WTSF(IFLA)', WTZ,
     +      XFA(IFLA)/XFB(IFLB),WTSF(IFLA),IFLA,IFLB
         ENDIF
         IF(SNGL(WTZ)*XFA(IFLA)/XFB(IFLB).LT.
     +    draprn()*SNGL(WTSF(IFLA))) THEN
            IF(LPRINT) THEN
               write(6,*) 'WTZ check ',N,NS+2
               write(6,*) ' goto 80 or 110'
            ENDIF
            IF(ILEP.GE.1.AND.N.EQ.NS+2) GOTO 80
            IF(LPRINT) THEN
               write(6,*) 'goto 110'
            ENDIF
            GOTO 110
         ENDIF
c         pause 'after loop'
  170    CONTINUE
      ENDIF
      IF(LPRINT) THEN
         write(6,*) 'before HARD scatter in cm frame ',N,NS+4-2*MIN(1,
     +   ILEP)
      ENDIF

  180 IF(N.EQ.NS+4-2*MIN(1,ILEP)) THEN
         IF(LPRINT) THEN
            write(6,*) 'HARD scatter in cm frame '
         ENDIF
C...DEFINE TWO HARD SCATTERERS IN THEIR CM-FRAME
         DQ2(JT)=Q2B
changed         IF(IPY(14).GE.3.AND.IPY(14).LE.6) DQ2(JT)=Q2B/(1.D0-Z)
         IF(ILEP.EQ.0) THEN
            DPLCM=DSQRT((DSH+DQ2(1)+DQ2(2))**2-4.D0*DQ2(1)*DQ2(2))/DSHR
            DO 190 JR=1,2
               I=NS+2*JR-1
               IPO=19+2*JR
               K(I,1)=14
               K(I,2)=IFLS(JR+2)
               IF(IFLS(JR+2).EQ.0) K(I,2)=21
               IF(IFLS(JR+2).EQ.22) K(I,1)=11
               K(I,3)=0
               K(I,4)=IPO
               K(I,5)=IPO
               IF(K(IPO,2).EQ.22) K(I,4)=0
               IF(K(IPO,2).EQ.22) K(I,5)=0
               P(I,1)=0.D0
               P(I,2)=0.D0
               P(I,3)=DPLCM*(-1)**(JR+1)
               P(I,4)=(DSH+DQ2(3-JR)-DQ2(JR))/DSHR
               P(I,5)=-SQRT(DQ2(JR))
               K(I+1,1)=-1
               K(I+1,2)=K(IPO+1,2)
               K(I+1,3)=I
               K(I+1,4)=0
               K(I+1,5)=0
               P(I+1,1)=0.D0
               P(I+1,2)=0.D0
               P(I+1,3)=IPO
               P(I+1,4)=IPO
               P(I+1,5)=0.D0
               P(IPO+1,1)=I
               P(IPO+1,2)=I
               K(IPO,4)=MOD(K(IPO,4),MSTU(5))+I*MSTU(5)
               K(IPO,5)=MOD(K(IPO,5),MSTU(5))+I*MSTU(5)
               IF(K(IPO,2).EQ.22) K(I,4)=0
               IF(K(IPO,2).EQ.22) K(I,5)=0
  190       CONTINUE
         ELSE
C..LEPTOPRODUCTION EVENTS: BOSON AND HADRON REST FRAME
            I1=NS+2*ILEP-1
            I2=NS-2*ILEP+5
            DO 200 ITEMP=NS+1,NS+4
               DO 200 J=1,5
                  K(ITEMP,J)=0
  200       P(ITEMP,J)=0.D0
            DO 210 J=1,5
  210       P(I1,J)=P(NQ,J)
            K(NS+1,1)=11
            K(NS+3,1)=14
            IF(ILEP.EQ.2) THEN
               K(NS+1,1)=14
               K(NS+3,1)=11
            ENDIF
            K(NS+2,1)=-1
            K(NS+4,1)=-1
            K(NS+1,3)=0
            K(NS+2,3)=NS+1
            K(NS+3,3)=0
            K(NS+4,3)=NS+3
            K(I1,2)=KFL(2,ILEP)
            K(I2,2)=KFL(2,3-ILEP)
            DPD(1)=DSH+DQ2(1)+DQ2(2)
            DPD(3)=(3-2*ILEP)*DSQRT(DPD(1)**2-4D0*DQ2(1)*DQ2(2))
c.hju here are few changes for Q2 = 0
            IF(Q2LP.GE.0.5*PYPAR(22)) THEN
               P(I2,3)=(DPQS(2)*DPD(3)-DPQS(1)*DPD(1))/ (2D0*DQ2(JR))
               P(I2,4)=(DPQS(1)*DPD(3)-DPQS(2)*DPD(1))/ (2D0*DQ2(JR))
            ELSE
               P(I2,3) =- (DPD(1)**2 + 4.d0*DPQS(2)**2 *DQ2(2))/
     +         (4.d0*DPQS(1)*DPD(1))
               P(I2,4) = (DPD(1)**2 - 4.d0*DPQS(1)**2 *DQ2(2))/ (4.d0*
     +         DPQS(2)*DPD(1))
               P(I2,3)=-DPD(1)/(2D0*(DPQS(1)+DPQS(2)))-
     +                 DQ2(2)*DPQS(2)/DPD(1)
               P(I2,4)=DPD(1)/(2D0*(DPQS(1)+DPQS(2)))-
     +                 DQ2(2)*DPQS(1)/DPD(1)
cc               write(6,*) ' pysspa new ',P(I2,3),P(23,3)
cc               write(6,*) ' pysspa new',P(I2,4),P(23,4)
Cend test
               IF(P(I2,4).LT.0.D0) THEN
c                  write(6,*) 'P(I2,4) lt 0.:'
c                  goto 20
               endif
            ENDIF
c.hju end of these changes
            P(I2,5)=-SQRT(DQ2(3-ILEP))
            P(I2+1,3)=MAX(IPU1,IPU2)
            P(I2+1,4)=MAX(IPU1,IPU2)
            K(I2,4)=K(I2,4)-MOD(K(I2,4),MSTU(5))+MAX(IPU1,IPU2)
            K(I2,5)=K(I2,5)-MOD(K(I2,5),MSTU(5))+MAX(IPU1,IPU2)
            P(26-2*ILEP,1)=I2
            P(26-2*ILEP,2)=I2
            K(25-2*ILEP,4)=MOD(K(25-2*ILEP,4),MSTU(5))+I2*MSTU(5)
            K(25-2*ILEP,5)=MOD(K(25-2*ILEP,5),MSTU(5))+I2*MSTU(5)
            N=N+2
         ENDIF

      ELSEIF(N.GT.NS+4) THEN
         IF(LPRINT) THEN
            write(6,*) 'find max allowed mass'
         ENDIF
C...FIND MAXIMUM ALLOWED MASS OF TIMELIKE PARTON
changed         IF(ILEP.EQ.0) JR=3-JT
         DQ2(3)=Q2B
changed         IF(IPY(14).GE.3.AND.IPY(14).LE.6) DQ2(3)=Q2B/(1.D0-Z)
         IF(IS(1).GE.1.AND.IS(1).LE.MSTU(4)) THEN
            DPC(1)=P(IS(1),4)
            DPC(3)=0.5D0*(ABS(P(IS(1),3))+ABS(P(IS(2),3)))
         ELSE
C...IS(1) not initialized
            DPC(1)=0.D0
            DPC(3)=0.5D0*( 0.D0 +ABS(P(IS(2),3)))
         ENDIF
         DPC(2)=P(IS(2),4)
         DPD(1)=DSH+DQ2(JR)+DQ2(JT)
         DPD(2)=DSHZ+DQ2(JR)+DQ2(3)
         DPD(3)=DSQRT(DPD(1)**2-4.D0*DQ2(JR)*DQ2(JT))
         DPD(4)=DSQRT(DPD(2)**2-4.D0*DQ2(JR)*DQ2(3))
         IKIN=0
c.hju        IF((Q2S(JR).GE.0.5*PYPAR(22).AND.DPD(1)-DPD(3).GE.1D-10*DPD(1))
c.hju     &  .OR.ILEP.GE.1) IKIN=1
         IF((Q2S(JR).GE.0.5*PYPAR(22).AND.DPD(1)-DPD(3).GE.1D-10*DPD(1)
     +   )) IKIN=1
         IF(IKIN.EQ.0.AND.ILEP.EQ.0) DMSMA=(DQ2(JT)/DBLE(ZS(JT))-DQ2(3)
     +   ) *(DSH/(DSH+DQ2(JT))-DSH/(DSHZ+DQ2(3)))
         IF(IKIN.EQ.0.AND.ILEP.GE.1) DMSMA=(DPD(1)**2 * DQ2(3) +
     +   DPD(2)**2 * DQ2(JT))/DPD(1)/DPD(2) -DQ2(JT)-DQ2(3)
         IF(IKIN.EQ.1) DMSMA=(DPD(1)*DPD(2)-DPD(3)*DPD(4))/(2.D0*DQ2(JR)
     +   )-DQ2(JT)-DQ2(3)
         IF(DMSMA.LT.0.0) THEN
            IF(LPRINT) THEN
               WRITE(6,*) 'DMSMA = ',DMSMA,' IKIN = ',IKIN,' JT = ',JT
               write(6,*) 'DPC(2)=',DPC(2),' DPD(1)=',DPD(1)
               write(6,*) 'DPD(2)=',DPD(2),' DPD(3)=',DPD(3)
               write(6,*) 'DPD(4)=',DPD(4),' DQ2(JT)=',DQ2(JT),JT
               write(6,*) 'DQ2(JR)=',DQ2(JR),JR
               write(6,*) 'ZS(JT)=',ZS(JT),' DQ2(3)=',DQ2(3)
               write(6,*) 'DSH= ',DSH,'DSHZ=',DSHZ
               write(6,*) ' XS(JT) = ',XS(JT),X(JT)
            ENDIF
         ENDIF
C...GENERATE TIMELIKE PARTON SHOWER (IF REQUIRED)
         IT=N-1
         K(IT,1)=3
         K(IT,2)=IFLB-IFLS(JT+2)
         IF(IFLB-IFLS(JT+2).EQ.0) K(IT,2)=21
         P(IT,5)=DBLE(ULMASS(K(IT,2)))
         IF(DMSMA.LE.P(IT,5)**2) THEN
            IF(LPRINT) THEN
               write(6,*) 'DMSMA LT P(IT,5)**2',DMSMA,P(IT,5)**2
               write(6,*) ' really goto 20 ????? '
            ENDIF
            GOTO 20
         ENDIF
         P(IT,2)=0.D0
         DO 220 J=1,5
            K(IT+1,J)=0
  220    P(IT+1,J)=0.D0
         K(IT+1,1)=-1
         K(IT+1,2)=K(IS(JT)+1,2)
         K(IT+1,3)=IT
         IF(ITIMSHR.EQ.1) THEN
            P(IT,1)=0.D0
            IF(ILEP.EQ.0) P(IT,4)=(DSHZ-DSH-P(IT,5)**2)/DSHR
            IF(ILEP.GE.1) P(IT,4)=0.5D0*(P(IS(JT),3)*DPD(2)+ DPQS(1)*
     +      (DQ2(JT)+DQ2(3)+P(IT,5)**2))/(P(IS(JT),3)*DPQS(2)- P(IS(JT)
     +      ,4)*DPQS(1))-DPC(JT)
c            IF(P(IT,4).LT.0.0) write(6,*) 'P(IT,4) < 0.:'
            P(IT,3)=DSQRT(DMAX1(0.D0,P(IT,4)**2-P(IT,5)**2))
            CALL DUSHOW(IT,0,SQRT(MIN(SNGL(DMSMA),PYPAR(25)*Q2)))
            IF(N.GE.IT+2) P(IT,5)=P(IT+2,5)
            IF(N.GT.MSTU(4)-10) THEN
               WRITE(6,*) ' PYSSPA: no more memory in LUJETS'
               LST(21)=52
               RETURN
            ENDIF
            DO 230 I=N+1,N+8
               DO 230 J=1,5
                  K(I,J)=0
  230       P(I,J)=0.D0
         ENDIF

C...RECONSTRUCT KINEMATICS OF BRANCHING: TIMELIKE PARTON SHOWER
         DMS=P(IT,5)**2
c.hju
         DPT2 = -1.D0
c.hju
         IF(IKIN.EQ.0.AND.ILEP.EQ.0) DPT2=(DMSMA-DMS)*(DSHZ+DQ2(3))/
     +   (DSH+DQ2(JT))
         IF(IKIN.EQ.1.AND.ILEP.EQ.0) DPT2=(DMSMA-DMS)*(0.5D0*DPD(1)*
     +   DPD(2)+0.5D0*DPD(3)*DPD(4)-DQ2(JR)*(DQ2(JT)+DQ2(3)+DMS))/
     +   (4.D0*DSH*DPC(3)**2)
c.test        IF(IKIN.EQ.1.AND.ILEP.GE.1) DPT2=(DMSMA-DMS)*(0.5*DPD(1)*
         IF(ILEP.GE.1) DPT2=(DMSMA-DMS)*(0.5D0*DPD(1)* DPD(2)+
     +    0.5D0*DPD(3)*
     +   DPD(4)-DQ2(JR)*(DQ2(JT)+DQ2(3)+DMS))/ DPD(3)**2
c.hju
c.test        IF(IKIN.EQ.0.AND.ILEP.GE.1) DPT2=(DMSMA-DMS)*DPD(2)/DPD(1)
c.hju
         IF(DPT2.LT.0.) THEN
            WRITE(6,*) 'DPT2 ',DPT2
            write(6,*) ' really goto 20 ????? '
            GOTO 20
         ENDIF
         K(IT,3)=N+1
         P(IT,1)=SQRT(DPT2)
         IF(ILEP.EQ.0) THEN
            DPB(1)=(0.5D0*DPD(2)-DPC(JR)*(DSHZ+DQ2(JR)-DQ2(JT)-DMS)/
     +      DSHR)/DPC(3)-DPC(3)
            P(IT,3)=DPB(1)*(-1)**(JT+1)
            P(IT,4)=(DSHZ-DSH-DMS)/DSHR
         ELSE
            DPC(3)=DQ2(JT)+DQ2(3)+DMS
            DPB(2)=DPQS(2)*P(IS(JT),3)-DPQS(1)*DPC(JT)
            DPB(1)=0.5D0*(DPC(JT)*DPD(2)+DPQS(2)*DPC(3))/DPB(2)-
     +      P(IS(JT),3)
            P(IT,3)=DPB(1)
            P(IT,4)=0.5D0*(P(IS(JT),3)*DPD(2)+ DPQS(1)*DPC(3))/DPB(2)-
     +      DPC(JT)
ctest for numeric stability
            P(IT,4) = DSQRT(P(IT,3)**2+P(IT,1)**2+P(IT,5)**2)
cend test
            IF(P(IT,4).LE.0.0) THEN
               write(6,*) 'pysspa P(4)<0 ',
     +       0.5D0*(P(IS(JT),3)*DPD(2)+ DPQS(1)*DPC(3))/DPB(2),DPC(JT)
c               pause
c               CALL DULIST(1)
            ENDIF
         ENDIF
         IF(N.GE.IT+2) THEN
            MSTU(1)=IT+2
            DPB(1)=DSQRT(DPB(1)**2+DPT2)
            DPB(2)=DSQRT(DPB(1)**2+DMS)
            DPB(3)=P(IT+2,3)
            DPB(4)=DSQRT(DPB(3)**2+DMS)
            DBEZ=(DPB(4)*DPB(1)-DPB(3)*DPB(2))/(DPB(4)*DPB(2)-DPB(3)*
     +      DPB(1))
            CALL DUDBRB(MSTU(1),MSTU(2),0.D0,0.D0,0.D0,0.D0,DBEZ)
            THE=DLANGL(P(IT,3),P(IT,1))
            CALL DUDBRB(MSTU(1),MSTU(2),THE,0.D0,0.D0,0.D0,0.D0)
c test
            MSTU(1) = 0
cend test
         ENDIF

C...RECONSTRUCT KINEMATICS OF BRANCHING: SPACELIKE PARTON
         K(N+1,1)=14
         K(N+1,2)=IFLB
         IF(IFLB.EQ.0) K(N+1,2)=21
         K(N+1,3)=0
         P(N+1,1)=P(IT,1)
         P(N+1,2)=0.D0
         P(N+1,3)=P(IT,3)+P(IS(JT),3)
         P(N+1,4)=P(IT,4)+P(IS(JT),4)
         P(N+1,5)=-SQRT(DQ2(3))

c check that p_t of cascade is smaller than p_t of hard process
         IF(P(N+1,1).GE.SQRT(PT2H)) THEN
c           write(6,*) ' warning from pysspa: '
c        write(6,*) ' p_t of branching > p_t of hard scattering '
c     +  ,P(N+1,1),SQRT(PT2H),P(N+1,5)
         ENDIF
         DO 240 J=1,5
            K(N+2,J)=0
  240    P(N+2,J)=0.D0
         K(N+2,1)=-1
         K(N+2,2)=K(IS(JT)+1,2)
         K(N+2,3)=N+1

C...DEFINE COLOUR FLOW OF BRANCHING
         K(IS(JT),1)=14
         K(IS(JT),3)=N+1
         ID1=IT
         KN1=ISIGN(500+IABS(K(N+1,2)),2*K(N+1,2)+1)
         KD1=ISIGN(500+IABS(K(ID1,2)),2*K(ID1,2)+1)
         IF(K(N+1,2).EQ.21) KN1=500
         IF(K(ID1,2).EQ.21) KD1=500
         IF((KN1.GE.501.AND.KD1.GE.501).OR.(KN1.LT.0.AND. KD1.EQ.500)
     +   .OR.(KN1.EQ.500.AND.KD1.EQ.500.AND. draprn().GT.0.5)
     +   .OR.(KN1.EQ.500.AND.KD1.LT.0)) ID1=IS(JT)
         ID2=IT+IS(JT)-ID1
         P(N+2,3)=ID1
         P(N+2,4)=ID2
         P(ID1+1,1)=N+1
         P(ID1+1,2)=ID2
         P(ID2+1,1)=ID1
         P(ID2+1,2)=N+1
         K(N+1,4)=K(N+1,4)-MOD(K(N+1,4),MSTU(5))+ID1
         K(N+1,5)=K(N+1,5)-MOD(K(N+1,5),MSTU(5))+ID2
         K(ID1,4)=MOD(K(ID1,4),MSTU(5))+(N+1)*MSTU(5)
         K(ID1,5)=MOD(K(ID1,5),MSTU(5))+ID2*MSTU(5)
         K(ID2,4)=MOD(K(ID2,4),MSTU(5))+ID1*MSTU(5)
         K(ID2,5)=MOD(K(ID2,5),MSTU(5))+(N+1)*MSTU(5)
         N=N+2
C...BOOST TO NEW CM-FRAME
         MSTU(1)=NS+1
         IF(ILEP.EQ.0) THEN
            CALL DUDBRB(MSTU(1),MSTU(2),0.D0,0.D0,
     +      -(P(N-1,1)+P(IS(JR),1))/(P(N-1,4)+P(IS(JR),4)),
     +      0.D0,-(P(N-1,3)+P(IS(JR),3))/(P(N-1,4)+P(IS(JR),4)))
            IR=N-1+(JT-1)*(IS(1)-N+1)
            CALL DUDBRB(MSTU(1),MSTU(2), -DLANGL(P(IR,3),P(IR,1)),
     +      DBLE(PARU(2)*draprn()),0.D0,0.D0,0.D0)
         ELSE
C...REORIENTATE EVENT WITHOUT CHANGING THE BOSON FOUR MOMENTUM
            DO 250 J=1,4
  250       DPQ(J)=P(NQ,J)
            DBE1(4)=DPQ(4)+P(N-1,4)
            DO 260 J=1,3,2
  260       DBE1(J)=-(DPQ(J)+P(N-1,J))/DBE1(4)
c          write(6,*) ' DBE1(1)=',DBE1(1),'DBE1(3)=',DBE1(3)
            IF((1D0-DBE1(1)**2-DBE1(3)**2).LE.0.0) THEN
               MSTU(1) = 0
               LST(21) = 53
               RETURN
            ENDIF
            DBE1(4)=1D0/DSQRT(1D0-DBE1(1)**2-DBE1(3)**2)
            DBEP=DBE1(1)*DPQ(1)+DBE1(3)*DPQ(3)
            DGABEP=DBE1(4)*(DBE1(4)*DBEP/(1D0+DBE1(4))+DPQ(4))

            DO 270 J=1,3,2
  270       DPQ(J)=DPQ(J)+DGABEP*DBE1(J)
            DPQ(4)=DBE1(4)*(DPQ(4)+DBEP)
            DPC(1)=DSQRT(DPQ(1)**2+DPQ(3)**2)
            DBE2(4)=-(DPQ(4)*DPC(1)-DPQS(2)*DSQRT(DPQS(2)**2+DPC(1)**2-
     +      DPQ(4)**2))/(DPC(1)**2+DPQS(2)**2)
            THE=DLANGL(DPQ(3),DPQ(1))
            DBE2(1)=DBE2(4)*SIN(THE)
            DBE2(3)=DBE2(4)*COS(THE)
            DBE2(4)=1D0/(1D0-DBE2(1)**2-DBE2(3)*2)

C...CONSTRUCT THE COMBINED BOOST
            DPB(1)=DBE1(4)**2*DBE2(4)/(1D0+DBE1(4))
            DPB(2)=DBE1(1)*DBE2(1)+DBE1(3)*DBE2(3)
            DPB(3)=DBE1(4)*DBE2(4)*(1D0+DPB(2))
            DO 280 JB=1,3,2
  280       DROBO(JB+2)=(DBE1(4)*DBE2(4)*DBE1(JB)+DBE2(4)*DBE2(JB)+
     +      DPB(1)*DBE1(JB)*DPB(2))/DPB(3)
            IF(DSQRT(DROBO(3)**2+DROBO(5)**2).GT.0.99999999D0) THEN
               MSTU(1) = 0
               LST(21) = 53
               RETURN
            ENDIF
            CALL DUDBRB(MSTU(1),MSTU(2),0.D0,0.D0,
     +      DROBO(3),0.D0,DROBO(5))
            IF(ILEP.EQ.1) THE=DLANGL(P(NS+1,3),P(NS+1,1))
            IF(ILEP.EQ.2) THE=DBLE(PARU(1))+DLANGL(P(NS+3,3),P(NS+3,1))
            CALL DUDBRB(MSTU(1),MSTU(2),-THE, DBLE(PARU(2)*draprn()),
     +      0D0,0D0,0D0)
         ENDIF
         MSTU(1)=0
      ENDIF

C...SAVE QUANTITIES, LOOP BACK
      IF(LPRINT) THEN
         write(6,*) ' save quantities and loop back '
      ENDIF
      IS(JT)=N-1
      IF(ILEP.EQ.2.AND.N.EQ.NS+4) IS(JT)=N-3
      Q2S(JT)=Q2B
      DQ2(JT)=Q2B
      IF(IORDER.EQ.2) THE2(JT)=THE2T
changed      IF(IPY(14).GE.3.AND.IPY(14).LE.6) DQ2(JT)=Q2B/(1.D0-Z)
      DSH=DSHZ
      IF(Q2B.GE.0.5*PYPAR(22)) THEN
         IFLS(JT+2)=IFLS(JT)
         IFLS(JT)=IFLA
         XS(JT)=DBLE(XA)
         ZS(JT)=Z
         DO 290 IFL=-6,6
  290    XFS(JT,IFL)=DBLE(XFA(IFL))
         TEVS(JT)=TEVB
      ELSE
         IF(JT.EQ.1) IPU1=N-1
         IF(JT.EQ.2) IPU2=N-1
      ENDIF
      IF(LPRINT) THEN
         write(6,*) 'check end: N=',N,' NS+2=',NS+2
         write(6,*) MAX(IABS(1-ILEP)*Q2S(1),MIN(1,2-ILEP)*Q2S(2)),
     +   0.5*PYPAR(22)
         write(6,*) Q2S(1),Q2S(2)
      ENDIF
      IF(MAX(IABS(1-ILEP)*Q2S(1),MIN(1,2-ILEP)*Q2S(2)).GE.0.5*PYPAR(22)
     +.OR.N.LE.NS+2) GOTO 50
      IF(ILEP.EQ.0) THEN
C...BOOST HARD SCATTERING PARTONS TO FRAME OF SHOWER INITIATORS
         DO 300 J=1,3
  300    DROBO(J+2)=(P(NS+1,J)+P(NS+3,J))/(P(NS+1,4)+P(NS+3,4))
         DO 310 J=1,5
  310    P(N+2,J)=P(NS+1,J)
         MSTU(1)=N+2
         MSTU(2)=N+2
         CALL DUDBRB(N+2,N+2,0.D0,0.D0,-DROBO(3),-DROBO(4),-DROBO(5))
         ROBO(2)=DLANGL(P(N+2,1),P(N+2,2))
         ROBO(1)=DLANGL(P(N+2,3),SQRT(P(N+2,1)**2+P(N+2,2)**2))
c.test        MSTU(1)=4
         MSTU(1)=19
         MSTU(2)=NS
         CALL DUDBRB(MSTU(1),MSTU(2), ROBO(1),ROBO(2),DROBO(3),DROBO(4)
     +   ,DROBO(5))
         MSTU(1)=0
         MSTU(2)=0
      ENDIF

C...STORE USER INFORMATION
      K(21,1)=14
c.test      IF(ILEP.NE.0) K(21,1)=11
      IF(IRES(1).EQ.0) K(21,1)=11
      K(23,1)=14
      K(21,3)=NS+1
      K(23,3)=NS+3
      DO 320 JT=1,2
         KFL(1,JT)=IFLS(JT)
         IF(IFLS(JT).EQ.0) KFL(1,JT)=21

  320 PYVAR(30+JT)=SNGL(XS(JT))
      DO 330 I=NS+1,N
         DO 330 J=1,5
  330 V(I,J)=0.
c      CALL DULIST(1)
      RETURN
      END
*CMZ :  2.05/00 05/03/97  08.08.53  by  Hannes Jung
*CMZ :  2.04/03 16/01/97  11.07.35  by  Hannes Jung
*CMZ :  2.04/00 10/12/96  11.15.26  by  Hannes Jung
*CMZ :  2.03/03 22/08/96  19.17.42  by  Hannes Jung
*CMZ :  2.01/09 10/02/96  19.20.34  by  Hannes Jung
*CMZ :  2.00/01 20/04/95  17.18.33  by  Hannes Jung
*-- Author :
C*********************************************************************

      SUBROUTINE PYSTFE(KF,X,Q2,XPQ)

C...This is a dummy routine, where the user can introduce an interface
C...to his own external structure function parametrization.
C...Arguments in:
C...KF : 11 for e-, 22 for gamma, 211 for pi+, 2212 for p.
C...    Isospin conjugation for n and charge conjugation for
C...    e+, pi-, pbar and nbar is performed by PYSTFU.
C...X : x value.
C...Q2 : Q^2 value.
C...Arguments out:
C...XPQ(-6:6) : x * f(x,Q^2), with index according to KF code,
C...    except that gluon is placed in 0. Thus XPQ(0) = xg,
C...    XPQ(1) = xd, XPQ(-1) = xdbar, XPQ(2) = xu, XPQ(-2) = xubar,
C...    XPQ(3) = xs, XPQ(-3) = xsbar, XPQ(4) = xc, XPQ(-4) = xcbar,
C...    XPQ(5) = xb, XPQ(-5) = xbbar, XPQ(6) = xt, XPQ(-6) = xtbar,
C...    XPQ(11) = xe-, XPQ(-11) = xe+, XPQ(22) = xgamma.
C...
C...One such interface, to the Diemos, Ferroni, Longo, Martinelli
C...proton structure functions, already comes with the package. What
C...the user needs here is external files with the three routines
C...FXG160, FXG260 and FXG360 of the authors above, plus the
C...interpolation routine FINT, which is part of the CERN library
C...KERNLIB package. To avoid problems with unresolved external
C...references, the external calls are commented in the current
C...version. To enable this option, remove the C* at the beginning
C...of the relevant lines.
C...
C...Alternatively, the routine can be used as an interface to the
C...structure function evolution program of Tung. This can be achieved
C...by removing C* at the beginning of some of the lines below.
*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEEP,RGLUDAT2.
      REAL PMAS,PARF,VCKM
      INTEGER KCHG
      COMMON/LUDAT2/KCHG(500,3),PMAS(500,4),PARF(2000),VCKM(4,4)
C      SAVE

*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEND.

      DIMENSION XPQ(-6:6)
      CHARACTER CHDFLM(9)*5,HEADER*40
      DATA CHDFLM/'UPVAL','DOVAL','GLUON','QBAR ','UBAR ','SBAR ',
     +'CBAR ','BBAR ','TBAR '/
      DATA HEADER/'Tung evolution package has been invoked'/
      DATA INIT/0/
      IF(MSTP(51).EQ.0.AND.KF.EQ.2212) THEN
         IF(INIT.EQ.0) WRITE(6,*) ' SIMPLE SCALING FUNCTION USED'
         INIT=1
C...Simple scaling structure functions, valence quarks and gluon only.
         XPQ(0)=3.*(1.-X)**5
         XPQ(3)=0.125*(1.-X)**7
         XPQ(2)=70./32 *(1.-X)**3 *SQRT(X)
CCCC    XPQ(2)=(1.-X)**3*(1.274+.589*(1.-X)-1.675*(1.-X)**2)
         XPQ(1)=2.*XPQ(2)
         XPQ(-1)=XPQ(3)
         XPQ(-2)=XPQ(3)
         XPQ(-3)=XPQ(3)
c        RETURN
c      ENDIF

C...Proton structure function evolution from Wu-Ki Tung: parton
C...distribution functions incorporating heavy quark mass effects.
C...Allowed variable range: PARP(52) < Q < PARP(53); PARP(54) < x < 1.
      ELSE
         IF(INIT.EQ.0) THEN
            I1=0
            IF(MSTP(52).EQ.4) I1=1
            IHDRN=1
            NU=MSTP(53)
            I2=MSTP(51)
            IF(MSTP(51).GE.11) I2=MSTP(51)-3
            I3=0
            IF(MSTP(52).EQ.3) I3=1

C...Convert to Lambda in CWZ scheme (approximately linear relation).
            ALAM=0.75*PARP(1)
            TPMS=PMAS(6,1)
            QINI=PARP(52)
            QMAX=PARP(53)
            XMIN=PARP(54)

C...Initialize evolution (perform calculation or read results from
C...file).
C...Remove C* on following two lines to enable Tung initialization.
C*        CALL PDFSET(I1,IHDRN,ALAM,TPMS,QINI,QMAX,XMIN,NU,HEADER,
C*   &    I2,I3,IRET,IRR)
            INIT=1
         ENDIF

C...Put into output array.
         Q=SQRT(Q2)
         DO 10 I=-6,6
            FIXQ=0.
C...Remove C* on following line to enable structure function call.
C*      FIXQ=MAX(0.,PDF(10,1,I,X,Q,IR))
   10    XPQ(I)=X*FIXQ

C...Change order of u and d quarks from Tung to PYTHIA convention.
         XPS=XPQ(1)
         XPQ(1)=XPQ(2)
         XPQ(2)=XPS
         XPS=XPQ(-1)
         XPQ(-1)=XPQ(-2)
         XPQ(-2)=XPS
      ENDIF

      RETURN
      END
*CMZ :  2.08/00 06/06/99  16.42.15  by  Hannes Jung
*CMZ :  2.07/03 23/05/99  18.33.17  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
C*********************************************************************

      SUBROUTINE PYSTFU(KF,XI,Q2I,XPQ)
	Implicit None
	Integer KF
      REAL XI,Q2I,XPQ,SLO,SHI,EPS,RCCB,XPQHF
      DIMENSION XPQ(-6:6)
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      DOUBLE PRECISION QG2
      COMMON/SEMIH/ QG2
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
C...MODIFIED FOR USE IN HERACLES (BY H.SPIESBERGER, 8.2.93)
      Real PYSTOP,PYSLAM
	Integer NPYMOD,NPYMAX,NPYMIN
      COMMON /PYSTFUC/ PYSTOP,PYSLAM,NPYMOD,NPYMAX,NPYMIN
C Input:
C   PYSTOP = top mass
C   NPYMAX = maximal flavour
C   NPYMIN = minimal flavour
C   NPYMOD = Choice of parametrization
      Integer LUNTES,LUNDAT,LUNIN,LUNOUT,LUNRND,LPAR,LPARIN,IPART
      COMMON /HSUNTS/ LUNTES,LUNDAT,LUNIN,LUNOUT,LUNRND
      COMMON /HSPARL/ LPAR(20),LPARIN(12),IPART
*KEEP,RGRAHER.
      REAL XPQDIF,XPQPI
	Integer IHERPYS
	Integer NBQ2,NBX
      PARAMETER (NBQ2=20)
      PARAMETER (NBX=20)
      COMMON /RAHER/ IHERPYS,XPQDIF(-6:6,NBX,NBQ2),XPQPI(-6:6,NBX,NBQ2)
*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGLQ2.
      DOUBLE PRECISION Q2SUPP
      COMMON/LOWQ2S/Q2SUPP
*KEND.
      Integer NQPY,NXPY
      PARAMETER (NQPY=60,NXPY=60)

      REAL XPC(NXPY,NQPY),XXI(NXPY),Q2II(NQPY),XPRT,Q2T
      REAL CUT,XLP,YLP,W2LP,Q2LP,ULP
      DOUBLE PRECISION PARL
	Integer LLst
      COMMON /RAPTOU/ CUT(14),LLST(40),PARL(30),XLP,YLP,W2LP,Q2LP,ULP
      LOGICAL FIRST
      REAL X,Q2
	Integer KPHF
      COMMON /HEAVYF/X,Q2,KPHF
	Real GEV2NB
      EXTERNAL XPQHF
	Double Precision dq,dx
	Real dezot,qg20,qgx,alamz,xz0,fp,phi1,xd,qd,x1p,x2p
	Integer I,J,ix,iq
      DATA GEV2NB/.3893857E+6/
      DATA FIRST/.TRUE./
      SLO = 0.0
      SHI = 1.0
      EPS = 1.E-4
      Q2 = Q2I
      X = XI
      IF(KF.EQ.22.AND.Q2LP.NE.0.0) THEN
         CALL RYSTGA(X,Q2,Q2LP,XPQ)
         RETURN
      ENDIF
      IF(ISEMIH.EQ.1.AND.IDIR.EQ.1) THEN
         IF(IPRO.EQ.10.OR.IPRO.EQ.11.OR.IPRO.EQ.13.OR.IPRO.EQ.14) THEN
c unintegrated gluon for semihard approach
            DO 10  I=-6,6
   10       XPQ(I)=0.0
            QG20= 2.0
            ALAMZ = 0.056
            XZ0 = 0.333333
            IF(X.LT.XZ0) THEN
c            write(6,*) 'XZ0,X,QG2',XZ0,x,QG2
               DEZOT = EXP(3.56*SQRT(ALOG(XZ0/X)))
c               write(6,*) 'ALAMZ,DEZOT,ALAMZ**2*DEZOT',
c     &                    ALAMZ,DEZOT,ALAMZ**2*DEZOT
               QGX = QG20 + ALAMZ**2*DEZOT
            ELSE
               QGX = QG20
            ENDIF
cccc               QGX = QG20
c               write(6,*) ' QGX ALAMZ DEZOT QG20',QGX,ALAMZ,DEZOT,QG20
            IF(SNGL(QG2).GT.QGX) THEN
               FP = (QGX/SNGL(QG2))**2
c               write(6,*) ' QGX>QG2 ,FP',QGX,QG2,FP
            ELSE
c               write(6,*) ' QGX<QG2 ,FP',QGX,QG2,FP
               FP = 1.0
            ENDIF
ccc g1
            PHI1 = 0.97E6 * 0.05/(X+0.05)*(1.0 -X)**3
ccc g2
ccc            PHI1 = 0.65E6 * (1.0 - X)**5
c divide by GEV2NB because we want the gluon dimensionless
            XPQ(0) = PHI1*FP/GEV2NB
c
c            write(6,*) PHI1,FP,XPQ(0)
            GOTO 20
         ENDIF
      ENDIF
      CALL RYSTFU(KF,XI,Q2I,XPQ)
c      write(6,*) ' after rystfu ',xpq(4)
   20 CONTINUE
      IF(IHF.EQ.1) THEN
         KPHF = 4
         IF(IHFLA.GE.4) KPHF=IHFLA
         Q2 = Q2I
         X = XI
c         write(6,*) ' pystfu x,q2,xpq(4) old',x,q2,xpq(4)
         IF(FIRST) THEN
            DQ = (LOG(SSS) - LOG(QMI))/DFLOAT(NQPY-1)
            DX = (LOG10(1.D0) - LOG10(QMI/SSS))/DFLOAT(NXPY-1)
            DO 30  I=1,NXPY
               DO 30  J=1,NQPY
                  XXI(I) = SNGL(10**(LOG10(QMI/SSS) + DX*DFLOAT(I-1)))
                  IF(XXI(I).GE.1.D0) XXI(I) = 0.999
                  X = XXI(I)
                  Q2II(J) = SNGL(EXP(LOG(QMI) + DQ*DFLOAT(J-1)))
                  Q2 = Q2II(J)
                  CALL INTGA(SLO,SHI,XPQHF,EPS,RCCB)
                  XPC(I,J)=RCCB/2.
   30       CONTINUE
            FIRST=.FALSE.
         ENDIF
         XPRT = XI
         Q2T= Q2I
         IF(Q2T.LT.Q2II(1)) Q2T=Q2II(1)
         IF(XPRT.LT.XXI(1).OR.XPRT.GT.XXI(NXPY) .OR.Q2T.LT.Q2II(1)
     +    .OR.Q2T.GT.Q2II(NQPY)) THEN
c            WRITE(6,*) 'PYSTFU: X or Q2 values outside grid '
c            WRITE(6,*) ' X_min ',XXI(1),' X_max ',XXI(20), ' actual '
c     +      //'X ', XPRT
c            WRITE(6,*) ' Q2_min ',Q2II(1),' Q2_max ',Q2II(15), ' '
c     +      //'actual Q2 ',Q2T
c             write(6,*) ' this was for IPRO =',ipro,idir,ng,npom
            IF(XPRT.LT.XXI(1)) XPRT=XXI(1)
            IF(XPRT.GT.XXI(NXPY)) XPRT=XXI(NXPY)
            IF(Q2T.LT.Q2II(1)) Q2T = Q2II(1)
            IF(Q2T.GT.Q2II(NQPY)) Q2T = Q2II(NQPY)
         ENDIF
         IX = 0
   40    IX = IX + 1
         IF(XPRT.GT.XXI(IX+1)) GOTO 40
         IQ = 0
   50    IQ = IQ + 1
         IF(Q2T.GT.Q2II(IQ+1)) GOTO 50

         XD = (XPRT - XXI(IX))/(XXI(IX+1)-XXI(IX))
         QD = (Q2T - Q2II(IQ))/(Q2II(IQ+1) - Q2II(IQ))
         X1P=(XPC(IX+1,IQ)-XPC(IX,IQ))*XD +XPC(IX,IQ)
         X2P=(XPC(IX+1,IQ+1)-XPC(IX,IQ+1))*XD + XPC(IX,IQ+1)
         XPQ(KPHF) = (X2P-X1P)*QD + X1P
         XPQ(-KPHF) = XPQ(KPHF)
         X=XI
         Q2=Q2I
c         CALL INTGA(SLO,SHI,XPQHF,EPS,RCCB)

c         write(6,*) ' xpq(4),charm new',xpq(4)
c         XPQ(4)=RCCB/2.
c         XPQ(-4)=XPQ(4)
c         write(6,*) ' xpq(4),charm new',xpq(4),rccb/2.
         DO 60 I=1,6
            IF(I.EQ.IABS(KPHF)) GOTO 60
            XPQ(I) = 0.0
            XPQ(-I) = 0.0
   60    CONTINUE
      ENDIF

      RETURN
      END
*CMZ :  2.00/01 20/04/95  17.18.33  by  Hannes Jung
*-- Author :
C*********************************************************************

      SUBROUTINE PYSTGA(NFE,X,T,XPGL,XPQU,XPQD)

C...Gives photon structure function; external to PYSTFU since it
C...may be called several times for convolution of photon structure
C...functions with photons in electron structure function.
      DIMENSION DGAG(4,3),DGBG(4,3),DGCG(4,3),DGAN(4,3),DGBN(4,3),
     +DGCN(4,3),DGDN(4,3),DGEN(4,3),DGAS(4,3),DGBS(4,3),DGCS(4,3),
     +DGDS(4,3),DGES(4,3)

C...The following data lines are coefficients needed in the
C...Drees and Grassie photon structure function parametrizations.
      DATA DGAG/-.207E0,.6158E0,1.074E0,0.E0,.8926E-2,.6594E0,
     +.4766E0,.1975E-1,.03197E0,1.018E0,.2461E0,.2707E-1/
      DATA DGBG/-.1987E0,.6257E0,8.352E0,5.024E0,.5085E-1,.2774E0,
     +-.3906E0,-.3212E0,-.618E-2,.9476E0,-.6094E0,-.1067E-1/
      DATA DGCG/5.119E0,-.2752E0,-6.993E0,2.298E0,-.2313E0,.1382E0,
     +6.542E0,.5162E0,-.1216E0,.9047E0,2.653E0,.2003E-2/
      DATA DGAN/2.285E0,-.1526E-1,1330.E0,4.219E0,-.3711E0,1.061E0,
     +4.758E0,-.1503E-1,15.8E0,-.9464E0,-.5E0,-.2118E0/
      DATA DGBN/6.073E0,-.8132E0,-41.31E0,3.165E0,-.1717E0,.7815E0,
     +1.535E0,.7067E-2,2.742E0,-.7332E0,.7148E0,3.287E0/
      DATA DGCN/-.4202E0,.1778E-1,.9216E0,.18E0,.8766E-1,.2197E-1,
     +.1096E0,.204E0,.2917E-1,.4657E-1,.1785E0,.4811E-1/
      DATA DGDN/-.8083E-1,.6346E0,1.208E0,.203E0,-.8915E0,.2857E0,
     +2.973E0,.1185E0,-.342E-1,.7196E0,.7338E0,.8139E-1/
      DATA DGEN/.5526E-1,1.136E0,.9512E0,.1163E-1,-.1816E0,.5866E0,
     +2.421E0,.4059E0,-.2302E-1,.9229E0,.5873E0,-.79E-4/
      DATA DGAS/16.69E0,-.7916E0,1099.E0,4.428E0,-.1207E0,1.071E0,
     +1.977E0,-.8625E-2,6.734E0,-1.008E0,-.8594E-1,.7625E-1/
      DATA DGBS/.176E0,.4794E-1,1.047E0,.25E-1,25.E0,-1.648E0,
     +-.1563E-1,6.438E0,59.88E0,-2.983E0,4.48E0,.9686E0/
      DATA DGCS/-.208E-1,.3386E-2,4.853E0,.8404E0,-.123E-1,1.162E0,
     +.4824E0,-.11E-1,-.3226E-2,.8432E0,.3616E0,.1383E-2/
      DATA DGDS/-.1685E-1,1.353E0,1.426E0,1.239E0,-.9194E-1,.7912E0,
     +.6397E0,2.327E0,-.3321E-1,.9475E0,-.3198E0,.2132E-1/
      DATA DGES/-.1986E0,1.1E0,1.136E0,-.2779E0,.2015E-1,.9869E0,
     +-.7036E-1,.1694E-1,.1059E0,.6954E0,-.6663E0,.3683E0/

C...Photon structure function from Drees and Grassie.
C...Allowed variable range: 1 GeV^2 < Q^2 < 10000 GeV^2.
      X1=1.-X

C...Evaluate gluon content.
      DGA=DGAG(1,NFE)*T**DGAG(2,NFE)+DGAG(3,NFE)*T**(-DGAG(4,NFE))
      DGB=DGBG(1,NFE)*T**DGBG(2,NFE)+DGBG(3,NFE)*T**(-DGBG(4,NFE))
      DGC=DGCG(1,NFE)*T**DGCG(2,NFE)+DGCG(3,NFE)*T**(-DGCG(4,NFE))
      XPGL=DGA*X**DGB*X1**DGC

C...Evaluate up- and down-type quark content.
      DGA=DGAN(1,NFE)*T**DGAN(2,NFE)+DGAN(3,NFE)*T**(-DGAN(4,NFE))
      DGB=DGBN(1,NFE)*T**DGBN(2,NFE)+DGBN(3,NFE)*T**(-DGBN(4,NFE))
      DGC=DGCN(1,NFE)*T**DGCN(2,NFE)+DGCN(3,NFE)*T**(-DGCN(4,NFE))
      DGD=DGDN(1,NFE)*T**DGDN(2,NFE)+DGDN(3,NFE)*T**(-DGDN(4,NFE))
      DGE=DGEN(1,NFE)*T**DGEN(2,NFE)+DGEN(3,NFE)*T**(-DGEN(4,NFE))
      XPQN=X*(X**2+X1**2)/(DGA-DGB*LOG(X1))+DGC*X**DGD*X1**DGE
      DGA=DGAS(1,NFE)*T**DGAS(2,NFE)+DGAS(3,NFE)*T**(-DGAS(4,NFE))
      DGB=DGBS(1,NFE)*T**DGBS(2,NFE)+DGBS(3,NFE)*T**(-DGBS(4,NFE))
      DGC=DGCS(1,NFE)*T**DGCS(2,NFE)+DGCS(3,NFE)*T**(-DGCS(4,NFE))
      DGD=DGDS(1,NFE)*T**DGDS(2,NFE)+DGDS(3,NFE)*T**(-DGDS(4,NFE))
      DGE=DGES(1,NFE)*T**DGES(2,NFE)+DGES(3,NFE)*T**(-DGES(4,NFE))
      DGF=9.
      IF(NFE.EQ.2) DGF=10.
      IF(NFE.EQ.3) DGF=55./6.
      XPQS=DGF*X*(X**2+X1**2)/(DGA-DGB*LOG(X1))+DGC*X**DGD*X1**DGE
      IF(NFE.LE.1) THEN
         XPQU=(XPQS+9.*XPQN)/6.
         XPQD=(XPQS-4.5*XPQN)/6.
      ELSEIF(NFE.EQ.2) THEN
         XPQU=(XPQS+6.*XPQN)/8.
         XPQD=(XPQS-6.*XPQN)/8.
      ELSE
         XPQU=(XPQS+7.5*XPQN)/10.
         XPQD=(XPQS-5.*XPQN)/10.
      ENDIF

      RETURN
      END
*CMZ :  2.08/02 14/07/99  18.40.55  by  Hannes Jung
*CMZ :  2.08/01 23/06/99  09.43.21  by  Hannes Jung
*CMZ :  2.08/00 14/06/99  19.13.11  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  18.07.12  by  Hannes Jung
*-- Author :
      SUBROUTINE QCDGRID
      IMPLICIT None
      Double Precision X,xv,wmax
      DIMENSION X(20)
      Integer NDIM,NPOIN,NDIMEN,IMIX
      COMMON/DIVO/ NDIM,NPOIN
      COMMON /XVAL/ XV(20),NDIMEN
      REAL RQPM,RQQB,RQQBC,RQQBB,RQCDC,FL,FU,PQCD,XEPS,EPS,PQCDI
      COMMON /OALPHAS/ WMAX,IMIX
      Integer ID
      double precision xpom
      COMMON /PQPMID/xpom,ID
*KEEP,RGQCDGRID.
	Integer NY,NQ,NPPO
      PARAMETER (NY=40,NQ=20,NPPO=20)
cccc      PARAMETER (NY=80,NQ=80)
      DOUBLE PRECISION QY,QQ,QPOM,QPM,QQB,QQBH,QQBB,QCDC
      DOUBLE PRECISION QPMDF,QQBDF,QQBHDF,QQBBDF,QCDCDF
      DOUBLE PRECISION QPMPI,QQBPI,QQBHPI,QQBBPI,QCDCPI
      COMMON/QCDGRI/QY(NY),QQ(NQ),QPOM(NPPO),
     + QPMDF(NY,NQ,NPPO),QQBDF(NY,NQ,NPPO),QQBHDF(NY,NQ,NPPO),
     + QQBBDF(NY,NQ,NPPO),QCDCDF(NY,NQ,NPPO),
     + QPMPI(NY,NQ,NPPO),QQBPI(NY,NQ,NPPO),QQBHPI(NY,NQ,NPPO),
     + QQBBPI(NY,NQ,NPPO),QCDCPI(NY,NQ,NPPO),
     + QPM(NY,NQ),QQB(NY,NQ),QQBH(NY,NQ),QQBB(NY,NQ),QCDC(NY,NQ)
*KEEP,RGRAHER.
      REAL XPQDIF,XPQPI
	Integer IHERPYS
	Integer NBQ2,NBX
      PARAMETER (NBQ2=20)
      PARAMETER (NBX=20)
      COMMON /RAHER/ IHERPYS,XPQDIF(-6:6,NBX,NBQ2),XPQPI(-6:6,NBX,NBQ2)
*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.
      REAL ULMASS
      REAL SLO,SHI
      EXTERNAL FU,FL,PQCD,PQCDI,ULMASS
      double precision y,xxx,RSAFETY,xpo_max,xpo_min
      double precision RSUM,PQPM
      Integer idiro,iproo,iheraco,nflavo,ndimeno,ndimo,ngo,npomo
      Integer nny,nnq,nnpom,ipom,IHERPYSO,iy,iq,i,iprint
      DATA IPRINT/0/
      XEPS = 0.001
      XEPS = 1e-4
      SLO = 0.0
      SHI = 1.0
c      write(6,*) ' rapgap check weights ',IQCDGRID
c      write(6,*) idir,iherpys
      IDIRO = IDIR
      IPROO = IPRO
      IHERACO = IHERAC
      NFLAVO =NFLAV
      NDIMENO =NDIMEN
      NDIMO = NDIM
      IHERPYSO = IHERPYS
      NGO = NG
      NPOMO = NPOM
      IDIR = 1
      IHERAC = 0
      NDIMEN = 2
      NDIM =2
      IF(IDIRO.EQ.1) THEN
         ID = 1
      ELSEIF(IDIRO.EQ.0.AND.(NPOM.EQ.20.OR.NPOM.EQ.21)) THEN
         ID = 3
      ELSE
         ID = 2
      ENDIF
C select leading order or higher order process
      IF(IDISDIF.GE.3.AND.IDIRO.EQ.1) THEN
         write(6,*) ' this option is  not impelmented --> STOP '
         STOP
      ENDIF
      IF(IDISDIF.GE.1.AND.IDIRO.EQ.1) THEN
         IHERPYS = 0
         ID = 1
      ENDIF
      write(6,*) ' Now calcualting order alpha_s matrix elements '
      write(6,*) ' Please be patient, for diffraction it can take long'
      IF(IPRINT.EQ.1) then
         IF(ID.EQ.1) THEN
            WRITE(6,10000)
10000 FORMAT('|   y     |   q2    |  qpm    |  qqb    |  qcdc   |',
     + '  ccb    |   bbb   |')
         ELSE
            WRITE(6,10100)
10100 FORMAT('|   y     |   q2    |  x_pom  |  qpm    |  qqb    |',
     + '  qcdc   |  ccb    |   bbb   |')
         ENDIF
      endif
c choose y and q2
   10 CONTINUE
      NNY = NY - 1
      NNQ = NQ - 1
      NNPOM = NPPO -1
      IF(ID.EQ.1) THEN
         NNPOM=1
      ELSE
         XPO_MAX=1.D0-XF
         XPO_MIN=Q2MIN/YMAX/SSS
c        write(6,*) T2GKI
         T2GKI = -0.1
         XFGKI = 0.01
      ENDIF
c     write(6,*) ' qcdgrid NNpom,xpo_min,xpo_max ',NNpom,xpo_min,xpo_max
      DO 70 Ipom = 0,NNPOM
         DO 60 IY = 0,NNY
            DO 50 IQ = 0,NNQ
               DO 20 I=1,10
   20          X(I) = 0.D0
               X(1) = DFLOAT(IY)/DFLOAT(NNY)
               X(2) = DFLOAT(IQ)/DFLOAT(NNQ)
               X(3) = DFLOAT(IPOM)/DFLOAT(NNPOM)
               DO 30 I=1,20
   30          XV(I) = X(I)
               IDIR = 1
               IHERAC = 0
               NDIMEN = 2
               IMIX = 0
               IWEI = 0
               IPRO = 12
               KPA = 1
ccccc            NFLAV = 3

               Y = YMIN*(YMAX/YMIN)**X(1)
               YY = SNGL(y)
               Q2 = Q2MIN*(Q2MAX/Q2MIN)**X(2)
               IF(ID.EQ.1) THEN
                  XPOM = 1.D0
               ELSE
                  XPOM = XPO_MIN*(XPO_MAX/XPO_MIN)**X(3)
               ENDIF
cc       write(6,*) x(1),y,ymin,ymax,x(2),q2,q2min,q2max
               xxx = q2/y/sss
               IF(xxx.ge.1.) THEN
c                 write(6,*) 'iY,Iq',iy,iq
                  Q2=y*sss*0.99D0
                  goto 50
               endif
               RQPM = SNGL(PQPM(Y,Q2))
               IMIX = 1
               IWEI = 1
               KPA = 1
               RQQB=0.0
               RQQBC=0.0
               RQCDC=0.0
               if(RQPM.LE.0.0) THEN
                  RQPM = 1.e-10
                  GOTO 40
               ENDIF
               IF(IHF.EQ.0) THEN
                  IPRO = 13
c calculate maximum of diff x section
C........ gamma gluon fusion
                  WMAX = 0.D0
                  AM(1) = DBLE(ULMASS(1))
                  AM(2) = AM(1)
                  EPS = XEPS
                  IF(IQ2.EQ.3.OR.(IQ2.GE.5.AND.IQ2.LE.7)) THEN
                     CALL GADAP2(SLO,SHI,FL,FU,PQCD,EPS,RQQB)
                  else
                     CALL GADAP(SLO,SHI,PQCDI,EPS,RQQB)
                  ENDIF
c           write(6,*) ' gamma ghluon fusion'
c           CALL DULIST(1)
C........ QCDC
                  IPRO = 15
c calculate maximum of diff x section
                  WMAX = 0.D0
                  AM(1) = DBLE(ULMASS(1))
                  AM(2) = AM(1)
                  EPS = XEPS
c           write(6,*) 'event: IPRO =',IPRO,KPA
                  IF(IQ2.EQ.3.OR.(IQ2.GE.5.AND.IQ2.LE.7)) THEN
                     CALL GADAP2(SLO,SHI,FL,FU,PQCD,EPS,RQCDC)
                  else
                     CALL GADAP(SLO,SHI,PQCDI,EPS,RQCDC)
                  endif
c           write(6,*) ' QCD compton'
c           CALL DULIST(1)
               ENDIF
C........ gamma gluon fusion charm
               IPRO = 14
               KPA = 4
cccc            IF(NFLAVO.GE.4.AND.IHF.EQ.0) THEN
               IF(NFLAVO.GE.4) THEN
C........ gamma gluon fusion charm
                  AM(1) = DBLE(ULMASS(KPA))
                  AM(2) = AM(1)
c calculate maximum of diff x section
                  WMAX = 0.D0
                  EPS = XEPS
c            write(6,*) 'qcdgrid: IPRO =',IPRO,KPA,am(1)
                  IF(IQ2.EQ.3.OR.(IQ2.GE.5.AND.IQ2.LE.7)) THEN
                     CALL GADAP2(SLO,SHI,FL,FU,PQCD,EPS,RQQBC)
                  else
                     CALL GADAP(SLO,SHI,PQCDI,EPS,RQQBC)
                  endif
                  IF(IHF.EQ.1.AND.IHFLA.EQ.5) RQQBC=0
                  RQQBC=RQQBC
                  IF(NFLAVO.GE.5) THEN
c               write(6,*) 'qcdgrid bbar',nflavo
                     KPA = 5
                     AM(1) = DBLE(ULMASS(5))
                     AM(2) = AM(1)
                     EPS = XEPS
                     IF(IQ2.EQ.3.OR.(IQ2.GE.5.AND.IQ2.LE.7)) THEN
                        CALL GADAP2(SLO,SHI,FL,FU,PQCD,EPS,RQQBB)
                     else
                        CALL GADAP(SLO,SHI,PQCDI,EPS,RQQBB)
                     endif
                     IF(IHF.EQ.1.AND.IHFLA.EQ.4) RQQBB=0
                  ENDIF
               ENDIF
   40          CONTINUE
c            write(6,*) 'ccbar RQPM  RQQBC',RQPM,RQQBC
c           write(6,*) ' gamma gluon fusion c cbar'
c           CALL DULIST(1)
               QY(IY+1) = DBLE(YY)
               QQ(IQ+1) = Q2
               QPOM(IPOM+1) = XPOM
c            write(6,*) ' y = ',yy,' Q2 = ',Q2
c            write(6,*) ' RQPM = ',RQPM,' RQQB = ',RQQB,'RQCDC = ',RQCDC,
c     +      'RQQBC = ',RQQBC
c            write(6,*) 'QCDGRID',IHERPYS
               IF(ID.EQ.1) THEN
                  QPM(IY+1,IQ+1) = DBLE(RQPM)
                  QQB(IY+1,IQ+1) = DBLE(RQQB)
                  QCDC(IY+1,IQ+1) = DBLE(RQCDC)
                  QQBH(IY+1,IQ+1) = DBLE(RQQBC)
                  QQBB(IY+1,IQ+1) = DBLE(RQQBB)
               ELSEIF(ID.EQ.2) THEN
                  QPMDF(IY+1,IQ+1,IPOM+1) = DBLE(RQPM)
                  QQBDF(IY+1,IQ+1,IPOM+1) = DBLE(RQQB)
                  QCDCDF(IY+1,IQ+1,IPOM+1) = DBLE(RQCDC)
                  QQBHDF(IY+1,IQ+1,IPOM+1) = DBLE(RQQBC)
                  QQBBDF(IY+1,IQ+1,IPOM+1) = DBLE(RQQBB)
               ELSEIF(ID.EQ.3) THEN
                  QPMPI(IY+1,IQ+1,IPOM+1) = DBLE(RQPM)
                  QQBPI(IY+1,IQ+1,IPOM+1) = DBLE(RQQB)
                  QCDCPI(IY+1,IQ+1,IPOM+1) = DBLE(RQCDC)
                  QQBHPI(IY+1,IQ+1,IPOM+1) = DBLE(RQQBC)
                  QQBBPI(IY+1,IQ+1,IPOM+1) = DBLE(RQQBB)
               ENDIF
               RSAFETY = DBLE(0.05*RQPM)
               RSUM = DBLE(RQQB+RQCDC+RQQBC+RQQBB)
               if(IPRINT.EQ.1.and.RQPM.gt.2.e-10) THEN
c               if(IPRINT.EQ.1) THEN
                  IF(ID.EQ.1) THEN
                     WRITE(6,10200) yy,Q2,RQPM,RQQB,RQCDC,RQQBC,RQQBB
                  ELSE
                     WRITE(6,10300) yy,Q2,XPOM,RQPM,RQQB,RQCDC,RQQBC,
     +               RQQBB
                  ENDIF
               ENDIF
               IF(RSUM.GT.(DBLE(RQPM)+RSAFETY).and.IHF.EQ.0) THEN
                  IF(ID.EQ.1) THEN
                     WRITE(6,10000)
                     WRITE(6,10200) yy,Q2,RQPM,RQQB,RQCDC,RQQBC,RQQBB
                  ELSE
                     WRITE(6,10100)
                     WRITE(6,10300) yy,Q2,XPOM,RQPM,RQQB,RQCDC,RQQBC,
     +               RQQBB
                  ENDIF
                  write(6,*) ' QCDGRID: RSUM > RQPM ',RSUM,RQPM
                  write(6,*) ' including 5% safety margin '
                  write(6,*) ' increase pt cutoff PT2CUT '
                  write(6,*) ' program stopped now '
                  STOP
               ENDIF
10200 FORMAT(1X,7(E8.3,' |'))
10300 FORMAT(1X,8(E8.3,' |'))
   50       CONTINUE
   60    CONTINUE
   70 CONTINUE
c      call qcdgridi
      IF(IDISDIF.GE.1.AND.ID.EQ.1) THEN
         ID = 2
         IHERPYS = 1
         write(6,*) ' now  calculate inclusive DIF ',IHERPYSO
         GOTO 10
      ELSEIF(IDISDIF.EQ.2.AND.ID.EQ.2) THEN
         ID = 3
         IHERPYS = 1
         write(6,*) ' now  calculate inclusive PI ',IHERPYSO
         NG = 20
         NPOM = 20
         GOTO 10
      ENDIF
      IDIR = IDIRO
      IPRO = IPROO
      IHERAC = IHERACO
      NFLAV = NFLAVO
      NDIMEN = NDIMENO
      NDIM = NDIMO
      NG = NGO
      NPOM = NPOMO
      IMIX = 0
      IWEI = 0
      IHERPYS = IHERPYSO
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.27  by  Hannes Jung
*CMZ :  2.08/02 14/07/99  18.40.55  by  Hannes Jung
*CMZ :  2.08/01 23/06/99  07.03.33  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  08.44.27  by  Hannes Jung
*-- Author :
      SUBROUTINE QCDMIX(X,IERR)
      IMPLICIT None
      Double Precision X,XV,WMAX
      Integer NDIMEN,LST,IRES,IGENFL,IERR,IMIX
      COMMON /EPPARA/ LST(30),IRES(2)
      COMMON /OALPHAS/ WMAX,IMIX
      COMMON/GENWEI/IGENFL
      DIMENSION X(20)
      COMMON /XVAL/ XV(20),NDIMEN
      Double Precision draprn
	Real RQPM,RQQB,RQQBC,RQQBB,RQCDC,RQQBT,RQPMT
      REAL FL,FU,PQCDQQB,XEPS,PQCDI,PQCD

      Double Precision XG(20)
      Integer ID
      double precision xpom
      COMMON /PQPMID/xpom,ID
*KEEP,RGQCDGRID.
	Integer NY,NQ,NPPO
      PARAMETER (NY=40,NQ=20,NPPO=20)
cccc      PARAMETER (NY=80,NQ=80)
      DOUBLE PRECISION QY,QQ,QPOM,QPM,QQB,QQBH,QQBB,QCDC
      DOUBLE PRECISION QPMDF,QQBDF,QQBHDF,QQBBDF,QCDCDF
      DOUBLE PRECISION QPMPI,QQBPI,QQBHPI,QQBBPI,QCDCPI
      COMMON/QCDGRI/QY(NY),QQ(NQ),QPOM(NPPO),
     + QPMDF(NY,NQ,NPPO),QQBDF(NY,NQ,NPPO),QQBHDF(NY,NQ,NPPO),
     + QQBBDF(NY,NQ,NPPO),QCDCDF(NY,NQ,NPPO),
     + QPMPI(NY,NQ,NPPO),QQBPI(NY,NQ,NPPO),QQBHPI(NY,NQ,NPPO),
     + QQBBPI(NY,NQ,NPPO),QCDCPI(NY,NQ,NPPO),
     + QPM(NY,NQ),QQB(NY,NQ),QQBH(NY,NQ),QQBB(NY,NQ),QCDC(NY,NQ)
*KEEP,RGRAHER.
      REAL XPQDIF,XPQPI
	Integer IHERPYS
	Integer NBQ2,NBX
      PARAMETER (NBQ2=20)
      PARAMETER (NBX=20)
      COMMON /RAHER/ IHERPYS,XPQDIF(-6:6,NBX,NBQ2),XPQPI(-6:6,NBX,NBQ2)
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGFULL.
      INTEGER IFULL,IQCDGRID
      COMMON /OALPINI/ IFULL,IQCDGRID
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.
      Integer NDIM,NPOIN
      COMMON/DIVO/ NDIM,NPOIN
      REAL ULMASS
      REAL SLO,SHI
      REAL SNGL
      Double Precision WMG,WDUM,FXN1,DSMALL,WMAX13,WMAX14,WMAX15
      Double Precision YD,QD,X1P,X2P,WPA,SM,XM_TEST,SMIN,WTEST
      Double Precision PQPM,PQQB,PQQBC,PQQBB,PQCDC,PTEST
      Double Precision X1,Y1,xm1,xm2,xm3,xm4
      DIMENSION WMG(4,NY,NQ)
      Integer K,I,J,NERP,NX1,NX2,NCMAX,IHERPYSO,IDIRO,IGENFLO
      Integer IY,IQ,IPO,IPG,NNX1,NNX2,IFAIL,INEW,NCALL
      Integer itest,nsum,N12A,N12MX,NDIMO
      LOGICAL FIRST
      EXTERNAL FU,FL,PQCDQQB,PQPM,PQCDI,PQCD,ULMASS

      DATA WDUM/0.D0/,NERP/0/,NX1/10/,NX2/10/,NCMAX/5000/
      DATA DSMALL/1.D-4/,ITEST/1/
      DATA FIRST /.TRUE./
      data nsum/0/
      IF(FIRST) THEN
         FIRST=.FALSE.
         DO K=1,4
            DO I=1,NY
               DO J=1,NQ
                  WMG(K,I,J)=-9999.D0
               ENDDO
            ENDDO
         ENDDO
      ENDIF
      XEPS = 0.005
      IERR = 1
      SLO = 0.0
      SHI = 1.0
      IGENFLO = IGENFL
      NDIMO = NDIM
      IF(IQCDGRID.EQ.0) THEN
         IHERPYSO = IHERPYS
         IF(ITEST.EQ.1) THEN
            IDIRO = IDIR
            IF(IDIRO.EQ.1) THEN
               IHERPYS = 0
            ELSEIF(IDIRO.EQ.0) THEN
               IHERPYS = 1
            ENDIF
            IGENFL = 0
         ENDIF
         if(idir.EQ.1) THEN
            ID = 1
            xpom = 1.d0
         ELSE
            ID= 2
            xpom = DBLE(XFGKI)
            IF(NPOM.EQ.20.OR.NPOM.EQ.21) ID = 3
         endif
c         write(6,*) ' qcdmix IHERPYS =',IHERPYS,IDIR,IDIRO
C select leading order or hihger order process
         IPRO = 12
         RQPM = SNGL(FXN1(X,WDUM))
c         write(6,*) '2nd FXN1 ',RQPM,x
c         call lulist(1)
         IF(ITEST.EQ.1) THEN
            RQPM= SNGL(PQPM(DBLE(YY),Q2))
         ENDIF
         IF(RQPM.LE.0) THEN
            write(6,*) ' THIS MUST NOT HAPPEN '
            write(6,*) ' WMAX = ',WMAX,' RQPM = ',RQPM
            write(6,*) ' IDIR =',IDIR,' NG,NPOM ',NG,NPOM
            write(6,*) ' X ',X
            STOP
         ENDIF
         RQQB=0.0
         RQQBC=0.0
         RQQBB=0.0
         RQQBT=0.0
         RQCDC=0.0
c         write(6,*) 'ihf,ihfla,nflav ',ihf,ihfla,nflav
         IF(IHF.EQ.0) THEN
            IPRO = 13
            AM(1) = 0.0D0
            AM(2) = AM(1)
c calculate maximum of diff x section
C........ gamma gluon fusion
            IF(IQ2.EQ.3.OR.(IQ2.GE.5.AND.IQ2.LE.7)) THEN
               WMAX = 0.D0
c            write(6,*) 'qcdmix: IPRO =',IPRO,KPA
               CALL GADAP2(SLO,SHI,FL,FU,PQCD,XEPS,RQQB)
c            write(6,*) 'qqbar gadap2',RQQB
               WMAX13 = 4.0D0 * WMAX
c           write(6,*) ' gamma gluon fusion'
c           CALL DULIST(1)
            ELSE
cc              write(6,*) xeps,slo,shi
               CALL GADAP(SLO,SHI,PQCDI,XEPS,RQQB)
            ENDIF
c            write(6,*) 'qqbar gadap ',RQQB
            IF(IFPS.NE.10) THEN
C........ QCDC
               IPRO = 15
               IF(IQ2.EQ.3.OR.(IQ2.GE.5.AND.IQ2.LE.7)) THEN
c calculate maximum of diff x section
                  WMAX = 0.D0
c           write(6,*) 'qcdmix: IPRO =',IPRO,KPA
                  CALL GADAP2(SLO,SHI,FL,FU,PQCD,XEPS,RQCDC)
c           write(6,*) 'QCDC gadap2 ',RQCDC
                  WMAX15 = 4.0D0 * WMAX
c           write(6,*) ' QCD compton'
c           CALL DULIST(1)
               ELSE
                  CALL GADAP(SLO,SHI,PQCDI,XEPS,RQCDC)
c           write(6,*) 'QCDC gadap  ',RQCDC
               ENDIF
            ENDIF
         ENDIF
         IF(NFLAV.GE.4.AND.IHF.EQ.0) THEN
C........ gamma gluon fusion charm
            IPRO = 14
c calculate maximum of diff x section
            WMAX = 0.D0
            WMAX14 = 4.0D0 * WMAX
            AM(1) = DBLE(ULMASS(4))
            AM(2) = AM(1)
            IF(IQ2.EQ.3.OR.(IQ2.GE.5.AND.IQ2.LE.7)) THEN
c calculate maximum of diff x section
               CALL GADAP2(SLO,SHI,FL,FU,PQCD,XEPS,RQQBC)
            ELSE
               CALL GADAP(SLO,SHI,PQCDI,XEPS,RQQBC)
            ENDIF
            IF(NFLAV.GE.5) THEN
               AM(1) = DBLE(ULMASS(5))
               AM(2) = AM(1)
               IF(IQ2.EQ.3.OR.(IQ2.GE.5.AND.IQ2.LE.7)) THEN
c calculate maximum of diff x section
                  CALL GADAP2(SLO,SHI,FL,FU,PQCD,XEPS,RQQBB)
               ELSE
                  CALL GADAP(SLO,SHI,PQCDI,XEPS,RQQBB)
               ENDIF
            ENDIF
c            write(6,*) ' rqqbc,rqqbb',rqqbc,rqqbb
         ENDIF
         IF(NFLAV.GE.4.AND.IHF.GT.0) THEN
C........ gamma gluon fusion charm
            IF(IHFLA.EQ.4) THEN
               IPRO = 14
c calculate maximum of diff x section
               WMAX = 0.D0
               WMAX14 = 4.0D0 * WMAX
               AM(1) = DBLE(ULMASS(4))
               AM(2) = AM(1)
               IF(IQ2.EQ.3.OR.(IQ2.GE.5.AND.IQ2.LE.7)) THEN
                  CALL GADAP2(SLO,SHI,FL,FU,PQCD,XEPS,RQQBC)
               ELSE
                  CALL GADAP(SLO,SHI,PQCDI,XEPS,RQQBC)
               ENDIF
cc            write(6,*) 'ccbar gadap  RQQBC',RQQBC
            ELSEIF(IHFLA.EQ.5) THEN
               IPRO = 14
               AM(1) = DBLE(ULMASS(5))
               AM(2) = AM(1)
               IF(IQ2.EQ.3.OR.(IQ2.GE.5.AND.IQ2.LE.7)) THEN
                  CALL GADAP2(SLO,SHI,FL,FU,PQCD,XEPS,RQQBB)
               ELSE
                  CALL GADAP(SLO,SHI,PQCDI,XEPS,RQQBB)
               ENDIF
cc            write(6,*) 'bbbar gadap  RQQBB',RQQBB
            ENDIF
         ENDIF
c         write(6,*) ' ihf ',ihf,nflav
c         write(6,*) 'rqpm, rqqb,rqqbc,rqcdc',rqpm,rqqb,rqqbc,rqcdc
c         write(6,*) Q2
         IF(IHF.EQ.0) THEN
c inculde 0.5% uncertainty because of numerics
            RQPMT = RQPM + 0.005*RQPM
            IF(RQPM.LT.(RQQB+RQCDC+RQQBC+RQQBB).AND.
     +       RQPMT.GE.(RQQB+RQCDC+RQQBC+RQQBB)) THEN
               RQPM = RQQB+RQCDC+RQQBC+RQQBB
            ENDIF
            IF(RQPMT.LT.(RQQB+RQCDC+RQQBC+RQQBB)) THEN
               IF(NERP.LT.10) THEN
                  write(6,*) ' ****************************************'
     +            //'*****'
                  write(6,*) ' **  RQQB+RQQBC+RQCDC+RQQBB > RQPM       '
     +            //'   *'
                  write(6,*) ' * RQPM = ',RQPM
                  write(6,*) ' * RQCDC = ',RQCDC,'             *'
                  write(6,*) ' * RQQB = ',RQQB,'               *'
                  write(6,*) ' * RQQBC = ',RQQBC,' RQQBB = ',RQQBB,'*'
                  write(6,*) ' * increase PT2CUT(13):',PT2CUT(13),'  *'
                  write(6,*) ' * increase PT2CUT(15):',PT2CUT(15),'  *'
                  write(6,*) ' * NG =',NG,' NPOM= ',NPOM,' IDIR= ',
     +            IDIR
                  write(6,*) ' ****************************************'
     +            //'*****'
               ELSEIF(NERP.EQ.10) THEN
                  write(6,*) ' ****************************************'
     +            //'*****'
                  write(6,*) ' **         RQQB+RQCDC > RQPM            '
     +            //'    *'
                  write(6,*) ' **         last message printed         '
     +            //'    *'
                  write(6,*) ' ****************************************'
     +            //'*****'
               ENDIF
               NERP = NERP + 1
               RQQB = 0.
               RQQBC = 0.
               RQCDC = 0.
            ENDIF
         ENDIF
c               write(6,*) ' * RQQBC = ',RQQBC,' RQPM = ',RQPM,'*'
         IHERPYS = IHERPYSO
      ELSE
c         write(6,*) 'qcdmix :yy,Q2 ',yy,Q2,ny,nq
c         write(6,*) 'qcdmix : qy ',qy
c         write(6,*) 'qcdmix : qq ',qq
c         write(6,*) ' QCDMIX IDIR = ',IDIR
         IY = 0
   10    IY = IY + 1
         IF(IY+1.GE.NY) THEN
c          write(6,*) ' y  out of  grid',yy,NY,IY
            GOTO 20
         ENDIF
         IF(DBLE(YY).GT.QY(IY+1)) GOTO 10
   20    CONTINUE
         IQ = 0
   30    IQ = IQ + 1
         IF(IQ+1.GE.NQ) THEN
c          write(6,*) ' q2 out of  grid',q2,NQ,IQ
            GOTO 40
         ENDIF
         IF(Q2.GT.QQ(IQ+1)) GOTO 30
   40    CONTINUE
         IPO = 0
   50    IPO = IPO + 1
         IF(IPO+1.GE.NPPO) THEN
c          write(6,*) ' y  out of  grid',yy,NY,IY
            GOTO 60
         ENDIF
         IF(DBLE(XFGKI).GT.QPOM(IPO+1)) GOTO 50
   60    CONTINUE
c         write(6,*) 'qcdmix iy,iq',iy,iq,yy,q2
         YD = (DBLE(YY) - QY(IY))/(QY(IY+1) - QY(IY))
         QD = (Q2 - QQ(IQ))/(QQ(IQ+1) - QQ(IQ))
         IF(IDIR.EQ.1) THEN
            X1P=  (QQB(IY+1,IQ)-QQB(IY,IQ))* YD +QQB(IY,IQ)
            X2P=  (QQB(IY+1,IQ+1)-QQB(IY,IQ+1))* YD
     +      +QQB(IY,IQ+1)
         ELSEIF(IDIR.EQ.0.AND.NPOM.NE.20.AND.NPOM.NE.21) THEN
            X1P= (QQBDF(IY+1,IQ,IPO)-QQBDF(IY,IQ,IPO))* YD
     +      +QQBDF(IY,IQ,IPO)
            X2P= (QQBDF(IY+1,IQ+1,IPO)-QQBDF(IY,IQ+1,IPO))* YD +
     +      QQBDF(IY,IQ+1,IPO)
         ELSEIF(IDIR.EQ.0.AND.(NPOM.EQ.20.OR.NPOM.EQ.21)) THEN
            X1P= (QQBPI(IY+1,IQ,IPO)-QQBPI(IY,IQ,IPO))* YD
     +      +QQBPI(IY,IQ,IPO)
            X2P= (QQBPI(IY+1,IQ+1,IPO)-QQBPI(IY,IQ+1,IPO))* YD +
     +      QQBPI(IY,IQ+1,IPO)
         ENDIF
         RQQB = SNGL((X2P-X1P)*QD + X1P)

         IF(IDIR.EQ.1) THEN
            X1P=  (QQBH(IY+1,IQ)-QQBH(IY,IQ))* YD +QQBH(IY,IQ)
            X2P=  (QQBH(IY+1,IQ+1)-QQBH(IY,IQ+1))* YD +QQBH(IY,
     +      IQ+1)
         ELSEIF(IDIR.EQ.0.AND.NPOM.NE.20.AND.NPOM.NE.21) THEN
            X1P= (QQBHDF(IY+1,IQ,IPO)-QQBHDF(IY,IQ,IPO))* YD +
     +      QQBHDF(IY,IQ,IPO)
            X2P= (QQBHDF(IY+1,IQ+1,IPO)-QQBHDF(IY,IQ+1,IPO))* YD +
     +      QQBHDF(IY,IQ+1,IPO)
         ELSEIF(IDIR.EQ.0.AND.(NPOM.EQ.20.OR.NPOM.EQ.21)) THEN
            X1P= (QQBHPI(IY+1,IQ,IPO)-QQBHPI(IY,IQ,IPO))* YD +
     +      QQBHPI(IY,IQ,IPO)
            X2P= (QQBHPI(IY+1,IQ+1,IPO)-QQBHPI(IY,IQ+1,IPO))* YD +
     +      QQBHPI(IY,IQ+1,IPO)
         ENDIF
         RQQBC = SNGL((X2P-X1P)*QD + X1P)
         IF(IDIR.EQ.1) THEN
            X1P=  (QQBB(IY+1,IQ)-QQBB(IY,IQ))* YD +QQBB(IY,IQ)
            X2P=  (QQBB(IY+1,IQ+1)-QQBB(IY,IQ+1))* YD +QQBB(IY,
     +      IQ+1)
         ELSEIF(IDIR.EQ.0.AND.NPOM.NE.20.AND.NPOM.NE.21) THEN
            X1P= (QQBBDF(IY+1,IQ,IPO)-QQBBDF(IY,IQ,IPO))* YD +
     +      QQBBDF(IY,IQ,IPO)
            X2P= (QQBBDF(IY+1,IQ+1,IPO)-QQBBDF(IY,IQ+1,IPO))* YD +
     +      QQBBDF(IY,IQ+1,IPO)
         ELSEIF(IDIR.EQ.0.AND.(NPOM.EQ.20.OR.NPOM.EQ.21)) THEN
            X1P= (QQBBPI(IY+1,IQ,IPO)-QQBBPI(IY,IQ,IPO))* YD +
     +      QQBBPI(IY,IQ,IPO)
            X2P= (QQBBPI(IY+1,IQ+1,IPO)-QQBBPI(IY,IQ+1,IPO))* YD +
     +      QQBBPI(IY,IQ+1,IPO)
         ENDIF
         RQQBB = SNGL((X2P-X1P)*QD + X1P)


         IF(IDIR.EQ.1) THEN
            X1P= (QCDC(IY+1,IQ)-QCDC(IY,IQ))* YD +QCDC(IY,IQ)
            X2P= (QCDC(IY+1,IQ+1)-QCDC(IY,IQ+1))* YD +QCDC(IY,
     +      IQ+1)
         ELSEIF(IDIR.EQ.0.AND.NPOM.NE.20.AND.NPOM.NE.21) THEN
            X1P= (QCDCDF(IY+1,IQ,IPO)-QCDCDF(IY,IQ,IPO))* YD +
     +      QCDCDF(IY,IQ,IPO)
            X2P= (QCDCDF(IY+1,IQ+1,IPO)-QCDCDF(IY,IQ+1,IPO))* YD +
     +      QCDCDF(IY,IQ+1,IPO)
         ELSEIF(IDIR.EQ.0.AND.(NPOM.EQ.20.OR.NPOM.EQ.21)) THEN
            X1P= (QCDCPI(IY+1,IQ,IPO)-QCDCPI(IY,IQ,IPO))* YD +
     +      QCDCPI(IY,IQ,IPO)
            X2P= (QCDCPI(IY+1,IQ+1,IPO)-QCDCPI(IY,IQ+1,IPO))* YD +
     +      QCDCPI(IY,IQ+1,IPO)
         ENDIF
         RQCDC = SNGL((X2P-X1P)*QD + X1P)
         IF(IFPS.EQ.10) RQCDC  = 0.0
         IF(IDIR.EQ.1) THEN
            X1P= (QPM(IY+1,IQ)-QPM(IY,IQ))* YD +QPM(IY,IQ)
            X2P= (QPM(IY+1,IQ+1)-QPM(IY,IQ+1))* YD +QPM(IY,IQ+
     +      1)
         ELSEIF(IDIR.EQ.0.AND.NPOM.NE.20.AND.NPOM.NE.21) THEN
            X1P= (QPMDF(IY+1,IQ,IPO)-QPMDF(IY,IQ,IPO))* YD
     +      +QPMDF(IY,IQ,IPO)
            X2P= (QPMDF(IY+1,IQ+1,IPO)-QPMDF(IY,IQ+1,IPO))* YD +
     +      QPMDF(IY,IQ+1,IPO)
         ELSEIF(IDIR.EQ.0.AND.(NPOM.EQ.20.OR.NPOM.EQ.21)) THEN
            X1P= (QPMPI(IY+1,IQ,IPO)-QPMPI(IY,IQ,IPO))* YD
     +      +QPMPI(IY,IQ,IPO)
            X2P= (QPMPI(IY+1,IQ+1,IPO)-QPMPI(IY,IQ+1,IPO))* YD +
     +      QPMPI(IY,IQ+1,IPO)
         ENDIF

         RQPM = SNGL((X2P-X1P)*QD + X1P)
c         write(6,*) 'rqpm, rqqb,rqqbc,rqcdc',rqpm,rqqb,rqqbc,rqcdc
         IPRO = 12
         WPA = FXN1(X,WDUM)
         IGENFL = 0
      ENDIF

      IF(IHF.EQ.1) THEN
         IF(IHFLA.EQ.4) RQPM=RQQBC
         IF(IHFLA.EQ.5) RQPM=RQQBB
         IF(IHFLA.EQ.6) RQPM=RQQBT
      ENDIF
c      write(6,*) ' QCDMIX: RQPM,RQQB,RQQBC,RQQBB,RQCDC',
c     + RQPM,RQQB,RQQBC,RQQBB,RQCDC
      PQQB=DBLE(RQQB/RQPM)
      PQQBC=DBLE(RQQBC/RQPM)
      PQQBB=DBLE(RQQBB/RQPM)
      PQCDC=DBLE(RQCDC/RQPM)

      INEW = 0
   70 CONTINUE
c      write(6,*) ' qcdmix pqqb,pqqbc,pqqbb,pqcdc',pqqb,pqqbc,pqqbb,pqcdc
      IF((PQQB+PQCDC+PQQBC+PQQBB).GT.1.02d0) Then
         nsum = nsum + 1
         write(6,*) ' qcdmix: sum >= 1 :IPRO=12 selected'
         write(6,*) ' qcdmix: pqqb,pqqbc,pqqbb ',pqqb,pqqbc,pqqbb
         write(6,*) ' qcdmix: pqcdc ',pqcdc
         write(6,*) ' qcdmix: pqqb+pqqbc+pqqbb+pqcdc ', PQQB+PQCDC+
     +   PQQBC+PQQBB

cc         endif
         IPRO = 12
      else
         PTEST = draprn()
c select process QPM or gamma g fusion
c         write(6,*) 'before sel '
         IF((PQQB+PQCDC+PQQBC+PQQBB).LT.PTEST) THEN
            IPRO = 12
c         write(6,*) ' qpm event '
         ELSEIF((PQQB+PQCDC+PQQBB).LT.PTEST) THEN
            IPRO = 14
            KPA = 4
            WMAX = WMAX14
c         write(6,*) ' cc event '
         ELSEIF((PQQB+PQCDC).LT.PTEST) THEN
            IPRO = 14
            KPA = 5
            WMAX = WMAX14
c         write(6,*) ' bb event '
         ELSEIF(PQQB.LT.PTEST) THEN
            IPRO = 15
            WMAX = WMAX15
c         write(6,*) ' qcdc event '
         ELSE
            IPRO = 13
            WMAX = WMAX13
c         write(6,*) ' qq event '
         ENDIF
c      write(6,*) 'qcdmix y,q2,x_bj',yy,q2,q2/yy/296/296
c      write(6,*) ' ipro ptest ',ipro,ptest
      endif
      IF(IPRO.EQ.12) THEN
         WPA = FXN1(X,WDUM)
      ELSEIF(IPRO.NE.12) THEN
c        IF(IHERAC.EQ.1.and.IDIR.EQ.0) NDIMEN = 5

         IF(IHERAC.EQ.1.and.IDIR.EQ.0) Then
c          NDIM = 3
            NDIMEN = 5
         Endif
         WMAX = 0.D0
         IY = 0
   80    IY = IY + 1
         IF(IY+1.GE.NY) THEN
c          write(6,*) ' y  out of  grid',yy,NY,IY
            GOTO 90
         ENDIF
         IF(DBLE(YY).GT.QY(IY+1)) GOTO 80
   90    CONTINUE
         IQ = 0
  100    IQ = IQ + 1
         IF(IQ+1.GE.NQ) THEN
c          write(6,*) ' q2 out of  grid',q2,NQ,IQ
            GOTO 110
         ENDIF
         IF(Q2.GT.QQ(IQ+1)) GOTO 100
  110    CONTINUE
         IPG = IPRO - 11
c search for maximum of x section
         NNX1 = NX1
         NNX2 = NX2
         IFAIL = 0
         IF(WMG(IPG,IY,IQ).GT.0.D0) THEN
            WMAX=WMG(IPG,IY,IQ)
         ELSE
  120       CONTINUE
            DO 130 I = 0,NNX1
               DO 130 J = 0,NNX2
                  X1 = DFLOAT(I)/DFLOAT(NNX1)
                  Y1 = DFLOAT(J)/DFLOAT(NNX2)
                  IF(X1.EQ.0.D0) X1= DSMALL
                  IF(X1.EQ.1.D0) X1= 1.D0 - DSMALL
                  IF(Y1.EQ.0.D0) Y1= DSMALL
                  IF(Y1.EQ.1.D0) Y1= 1.D0 - DSMALL

                  IF(IDIR.EQ.0) THEN
C generate additional random numbers for order alpha_s QCD processes
C           X(NDIMEN+1) = phi in PHASE
C           X(NDIMEN+2) = cost in PHASE
C           X(NDIMEN+3) = XP2 = E_part/E_proton
C           X(NIDMEN+4) = phi electron
                     X(NDIMEN+1) = draprn()
                     X(NDIMEN+2) = DBLE(X1)
                     X(NDIMEN+3) = DBLE(Y1)
                     X(NDIMEN+4) = draprn()
c              write(6,*) ' qcdmix ',X(NDIMEN+1),X(NDIMEN+2),
c     &           NDIMEN+1,NDIMEN+2
                  ELSEIF(IDIR.EQ.1) THEN
C generate additional random numbers for order alpha_s QCD processes
C           X(NDIMEN+1) = XP2 = E_part/E_proton
C           X(NIDMEN+2) = phi electron
C           X(NDIMEN+3) = phi in PHASE
C           X(NDIMEN+4) = cost in PHASE
                     X(NDIMEN+1) = DBLE(X1)
                     X(NDIMEN+2) = draprn()
                     X(NDIMEN+3) = draprn()
                     X(NDIMEN+4) = DBLE(Y1)
                  ENDIF
                  WPA = FXN1(X,WDUM)
                  IF(WPA.LE.0.0) then
                     WPA = 0.
c                     write(6,*) 'qcdmix:wpa=0,ipro',wpa,ipro,i,j
                  endif
ctest           IF(I.eq.0.or.j.eq.0) write(6,*) ' i,j=0 WPA=',WPA,i,j
                  IF(WPA.GT.WMAX) THEN
                     xm1 = x(ndimen+1)
                     xm2 = x(ndimen+2)
                     xm3 = x(ndimen+3)
                     xm4 = x(ndimen+4)
                     WMAX = WPA
                  ENDIF
c                  IF(XMIN.GT.XMAX) THEN
c                     WRITE(6,*) 'qcdmix: XMIN  >  XMAX  ',XMIN,XMAX,
c     +               IPRO,KPA
c                     SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+
c     +               AM(2)**2))
c                     XMIN=(SMIN+Q2)/(DBLE(Yy)*SSS)
c                     write(6,*) ' 2nd xmin,smin,y,q2 ',xmin,smin,yy,q2
c                     write(6,*) ' 2nd xfgki ',xfgki
c                     IPRO = 12
c                     WPA = FXN1(X,WDUM)
c                     GOTO 140
c                  ENDIF
  130       CONTINUE
            IF(WMAX.LE.0.D0) THEN
c            WRITE(6,*) ' WMAX always 0.0: old IPRO:',IPRO
               NNX1 = NNX1 + 25
               NNX2 = NNX2 + 25
c               WRITE(6,*) ' increase nr points in  grid ',NNX1,NNX2
               IFAIL = IFAIL + 1
               IF(IFAIL.LE.1) THEN
                  GOTO 120
               ELSE
c                  WRITE(6,*) ' WMAX always 0.0: old IPRO:',IPRO
c                  WRITE(6,*) ' too many trials: select new process '
c                  write(6,*) ' IDISDIF ',IDISDIF,' IDIR ',IDIR
c                  write(6,*) ' IHERPYS ',IHERPYS
                  INEW = INEW + 1
                  IF(INEW.LE.2) THEN
                     GOTO 70
                  ELSE
                     IPRO = 12
                     WPA = FXN1(X,WDUM)
                     write(6,*) ' too many trials: select IPRO =12'
                     write(6,*) ' IDIR,XFGKI,IPO ',IDIR,XFGKI,IPO
                     GOTO 160
                  ENDIF
               ENDIF
            ENDIF
ctest            WMAX = 3.D0 * WMAX
            WMAX = 1.5D0 * WMAX
ccccc            WMG(IPG,IY,IQ)=WMAX
         ENDIF
         NCALL = 0
  140    CALL draprnV(XG,4)
         DO 150 I=1,4
  150    X(NDIMEN+I)=XG(I)
c                     X(NDIMEN+1) = xm1
c                     X(NDIMEN+2) = xm2
c                     X(NDIMEN+3) = xm3
c                     X(NDIMEN+4) = xm4
c              write(6,*) ' qcdmix 2nd',X(NDIMEN+1),X(NDIMEN+2),
c     &           NDIMEN+1,NDIMEN+2
         NCALL = NCALL+1
         WPA = FXN1(X,WDUM)
         WTEST=draprn()
cnew
         IF(WPA.LT.0.0) THEN
            IPRO = 12
            WPA = FXN1(X,WDUM)
            LST(21) = 31
            GOTO 160
         ENDIF
cnew
         IF(WMAX.LE.0.0) RETURN
         IF(WPA.GT.WMAX) THEN
            write(6,*) ' WPA > WMAX for process IPRO = ',IPRO, WPA,
     +      WMAX
            write(6,*) ' in bin IY,IQ,IPG  ',IY,IQ,IPG
c            write(6,*) ' for IDIR = ',IDIR
c            write(6,*) ' X(NDIMEN+I) ', (X(NDIMEN+I),I=1,4)
c            write(6,*) ' max at  ',xm1,xm2,xm3,xm4
c            write(6,*) ' PQQB,PQQBC,PQCDC ',PQQB,PQQBC,PQCDC,PTEST
            WMG(IPG,IY,IQ)=WPA
            IPRO = 12
            WPA = FXN1(X,WDUM)
            LST(21) = 30
         ELSE
c            write(6,*) ' qcdmix: ipro,wpa,wmax ',ipro,wpa,wmax
            IF(WPA.LE.0.0D0.AND.NCALL.LT.NCMAX) THEN

               GOTO 140
            ELSEIF(WPA.LE.0.0D0) THEN
               write(6,*) ' WPA LE 0: switch to IPRO=12',IPRO,WPA
               IPRO = 12
               WPA = FXN1(X,WDUM)
               LST(21) = 31
               GOTO 160
            ENDIF
            IF(WPA/WMAX.LT.WTEST.AND.NCALL.LT.NCMAX) THEN
               GOTO 140
            ELSEIF(NCALL.GE.NCMAX) THEN
               write(6,*) ' NCALL GT 1000: switch to IPRO=12',IPRO
               IPRO = 12
               WPA = FXN1(X,WDUM)
               LST(21) = 32
               GOTO 160
            ENDIF
         ENDIF
      ENDIF
  160 CONTINUE
      IF(WPA.NE.0.0D0) THEN
         IERR = 0
      else
         wtest = FXN1(X,WDUM)
         write(6,*) 'QCDMIX WPA = 0 IPRO ',WPA,x,IPRO,wtest
      ENDIF
      NDIM = NDIMO
      IGENFL = IGENFLO
      RETURN
      END
*CMZ :  2.07/03 24/05/99  08.50.54  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE RAEND(IK)
      IMPLICIT None
      CHARACTER* 16 CNAM
      CHARACTER* 6 CBEAM1,CBEAM2
      CHARACTER * 7 CINT
	Integer NQPM,NQQB,NQQBC,NQQBB,NQCDC,IMIX,IK,LERR
	Double Precision WMAX
      COMMON /QCDEV/ NQPM,NQQB,NQQBC,NQQBB,NQCDC
      COMMON /OALPHAS/ WMAX,IMIX
      COMMON/ERR/LERR(100)
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      Integer NTHRE,NVMRE,IVM
      COMMON/HERTHET/ NTHRE,NVMRE
      COMMON/VMESON/IVM
	Integer NDIS,NQPMDS,NQQBDS,NQQBCDS,NQQBBDS,NQCDCDS,
     +NDIF,NQPMDF,NQQBDF,NQQBCDF,NQQBBDF,NQCDCDF,
     +NPI,NQPMPI,NQQBPI,NQQBCPI,NQQBBPI,NQCDCPI,
     +NRPA,NRPB,NRPC,NRPD,NRPE,NRPF,NRPG,NPRT

      COMMON/NEVOUT/NDIS,NQPMDS,NQQBDS,NQQBCDS,NQQBBDS,NQCDCDS,
     +              NDIF,NQPMDF,NQQBDF,NQQBCDF,NQQBBDF,NQCDCDF,
     +              NPI,NQPMPI,NQQBPI,NQQBCPI,NQQBBPI,NQCDCPI,
     +              NRPA,NRPB,NRPC,NRPD,NRPE,NRPF,NRPG,NPRT
      Integer ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      COMMON /COLCON/ ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      REAL ACC1,ACC2
	Integer IINT,NCB
      COMMON /INTEGR/ ACC1,ACC2,IINT,NCB
*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGEFFIC.
      DOUBLE PRECISION AVGI,SD
      INTEGER NIN,NOUT
      COMMON/EFFIC/AVGI,SD,NIN,NOUT
C     SAVE

*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEND.
      Double Precision SIGQPM,ESIGQPM,SIGQQB,ESIGQQB,SIGQQBC,ESIGQQBC
	Double Precision SIGQQBB,ESIGQQBB,SIGQCDC,ESIGQCDC,XVIS,XVMVIS
      IF(IK.EQ.10) WRITE(6,*) 'TIME LIMIT REACHED........'
      CALL LUNAME(KBEAM(1,2),CNAM)
      CBEAM1 = CNAM
      CALL LUNAME(KBEAM(2,2),CNAM)
      CBEAM2 = CNAM
      CALL LUNAME(KINT(2,2),CNAM)
      CINT = CNAM
      IF(IMIX.NE.1) THEN
         IF(IPRO.EQ.10.OR.IPRO.EQ.13) THEN
            WRITE(6,*) ' x - section for ',CBEAM1,CBEAM2,' --> q q_'
     +      //'bar X"'
         ELSEIF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
            WRITE(6,*) ' x - section for ',CBEAM1,CBEAM2,' --> Q Q_'
     +      //'bar X"'
         ELSEIF(IPRO.EQ.12) THEN
            WRITE(6,*) ' x - section for ',CBEAM1,CBEAM2,' --> q q_bar '
     +      //'X"'
         ENDIF
         WRITE(6,10000) AVGI,SD
      ENDIF
10000 FORMAT('  sigma = ',G16.7,' nb   +/- ',G16.7)
      IF(IMIX.NE.1) THEN
         IF(IPRO.EQ.10.OR.IPRO.EQ.13)
     +   WRITE(6,*) ' [ gamma g_',CINT,' --> q q_bar] ',avgi
         IF((IPRO.EQ.11.OR.IPRO.EQ.14).and.IHFLA.EQ.4)
     +   WRITE(6,*) ' [ gamma g_',CINT,' --> c c_bar ] ',avgi
         IF((IPRO.EQ.11.OR.IPRO.EQ.14).and.IHFLA.EQ.5)
     +   WRITE(6,*) ' [ gamma g_',CINT,' --> b b_bar ] ',avgi
         IF(IPRO.EQ.12) THEN
            WRITE(6,*) ' [ gamma q_',CINT,' --> q ] ',avgi
         ENDIF
         IF(IPRO.EQ.18) THEN
            IF(IK.EQ.20) THEN
               WRITE(6,*) ' resolved gamma processes: '
               IF(IRPA.EQ.1) WRITE(6,*) ' [ g + g     --> q + q_bar ]',
     +         avgi*DFLOAT(NRPA)/DFLOAT(NPRT)
               IF(IRPB.EQ.1) WRITE(6,*) ' [ g + g     --> g + g] ',
     +         avgi*DFLOAT(NRPB)/DFLOAT(NPRT)
               IF(IRPC.EQ.1) WRITE(6,*) ' [ g + q     --> g + q ] ',
     +         avgi*DFLOAT(NRPC)/DFLOAT(NPRT)
               IF(IRPD.EQ.1) WRITE(6,*) ' [ q + q_bar --> g + g ] ',
     +         avgi*DFLOAT(NRPD)/DFLOAT(NPRT)
               IF(IRPE.EQ.1) WRITE(6,*) ' [ q + q_bar --> q + q_bar ] '
     +         , avgi*DFLOAT(NRPE)/DFLOAT(NPRT)
               IF(IRPF.EQ.1) WRITE(6,*) ' [ q + q     --> q + q ] ',
     +         avgi*DFLOAT(NRPF)/DFLOAT(NPRT)
               IF(IRPG.EQ.1)
     +	   WRITE(6,*) ' Mueller/Tang  [ q + q     --> q + q ] '
     +         , avgi*DFLOAT(NRPG)/DFLOAT(NPRT)
               IF(IRPG.EQ.2)
     +	   WRITE(6,*) ' massive glu   [ q + q     --> q + q ] '
     +         , avgi*DFLOAT(NRPG)/DFLOAT(NPRT)
            ENDIF
         ENDIF
      ENDIF
      IF(IMIX.EQ.1) THEN
         IF(IDISDIF.EQ.0) THEN
            SIGQPM = AVGI*DFLOAT(NQPM)/DFLOAT(NOUT)
            ESIGQPM = AVGI*DSQRT(DFLOAT(NQPM))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma q_',CINT,' --> q ] ',SIGQPM,' +/- ',
     +      ESIGQPM
            SIGQQB = AVGI*DFLOAT(NQQB)/DFLOAT(NOUT)
            ESIGQQB= AVGI*DSQRT(DFLOAT(NQQB))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma g_',CINT,' --> q q_bar] ',SIGQQB,
     +      ' +/- ',ESIGQQB
            SIGQQBC = AVGI*DFLOAT(NQQBC)/DFLOAT(NOUT)
            ESIGQQBC = AVGI*DSQRT(DFLOAT(NQQBC))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma g_',CINT,' --> c c_bar] ',SIGQQBC,
     +      ' +/- ',ESIGQQBC
            SIGQQBB = AVGI*DFLOAT(NQQBB)/DFLOAT(NOUT)
            ESIGQQBB = AVGI*DSQRT(DFLOAT(NQQBB))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma g_',CINT,' --> b b_bar] ',SIGQQBB,
     +      ' +/- ',ESIGQQBB
            SIGQCDC = AVGI*DFLOAT(NQCDC)/DFLOAT(NOUT)
            ESIGQCDC = AVGI*DSQRT(DFLOAT(NQCDC))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma q_',CINT,' --> q g] ',SIGQCDC, ' +/- '
     +      ,ESIGQCDC
         ELSE
            WRITE(6,*) ' global x sections '
            SIGQPM = AVGI*DFLOAT(NQPM)/DFLOAT(NOUT)
            ESIGQPM = AVGI*DSQRT(DFLOAT(NQPM))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma q_',CINT,' --> q ] ',SIGQPM,' +/- ',
     +      ESIGQPM
            SIGQQB = AVGI*DFLOAT(NQQB)/DFLOAT(NOUT)
            ESIGQQB= AVGI*DSQRT(DFLOAT(NQQB))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma g_',CINT,' --> q q_bar] ',SIGQQB,
     +      ' +/- ',ESIGQQB
            SIGQQBC = AVGI*DFLOAT(NQQBC)/DFLOAT(NOUT)
            ESIGQQBC = AVGI*DSQRT(DFLOAT(NQQBC))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma g_',CINT,' --> c c_bar] ',SIGQQBC,
     +      ' +/- ',ESIGQQBC
            SIGQQBB = AVGI*DFLOAT(NQQBB)/DFLOAT(NOUT)
            ESIGQQBB = AVGI*DSQRT(DFLOAT(NQQBB))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma g_',CINT,' --> b b_bar] ',SIGQQBB,
     +      ' +/- ',ESIGQQBB
            SIGQCDC = AVGI*DFLOAT(NQCDC)/DFLOAT(NOUT)
            ESIGQCDC = AVGI*DSQRT(DFLOAT(NQCDC))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma q_',CINT,' --> q g] ',SIGQCDC, ' +/- '
     +      ,ESIGQCDC
            WRITE(6,*) ' DIS x section: ',AVGI*DFLOAT(NDIS)/
     +      DFLOAT(NOUT)
            SIGQPM = AVGI*DFLOAT(NQPMDS)/DFLOAT(NOUT)
            ESIGQPM = AVGI*DSQRT(DFLOAT(NQPMDS))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma q_',CINT,' --> q ] ',SIGQPM,' +/- ',
     +      ESIGQPM
            SIGQQB = AVGI*DFLOAT(NQQBDS)/DFLOAT(NOUT)
            ESIGQQB= AVGI*DSQRT(DFLOAT(NQQBDS))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma g_',CINT,' --> q q_bar] ',SIGQQB,
     +      ' +/- ',ESIGQQB
            SIGQQBC = AVGI*DFLOAT(NQQBCDS)/DFLOAT(NOUT)
            ESIGQQBC = AVGI*DSQRT(DFLOAT(NQQBCDS))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma g_',CINT,' --> c c_bar] ',SIGQQBC,
     +      ' +/- ',ESIGQQBC
            SIGQQBB = AVGI*DFLOAT(NQQBBDS)/DFLOAT(NOUT)
            ESIGQQBB = AVGI*DSQRT(DFLOAT(NQQBBDS))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma g_',CINT,' --> b b_bar] ',SIGQQBB,
     +      ' +/- ',ESIGQQBB
            SIGQCDC = AVGI*DFLOAT(NQCDCDS)/DFLOAT(NOUT)
            ESIGQCDC = AVGI*DSQRT(DFLOAT(NQCDCDS))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma q_',CINT,' --> q g] ',SIGQCDC, ' +/- '
     +      ,ESIGQCDC
            WRITE(6,*) ' DIF x section ',AVGI*DFLOAT(NDIF)/DFLOAT(NOUT)
            SIGQPM = AVGI*DFLOAT(NQPMDF)/DFLOAT(NOUT)
            ESIGQPM = AVGI*DSQRT(DFLOAT(NQPMDF))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma q_',CINT,' --> q ] ',SIGQPM,' +/- ',
     +      ESIGQPM
            SIGQQB = AVGI*DFLOAT(NQQBDF)/DFLOAT(NOUT)
            ESIGQQB= AVGI*DSQRT(DFLOAT(NQQBDF))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma g_',CINT,' --> q q_bar] ',SIGQQB,
     +      ' +/- ',ESIGQQB
            SIGQQBC = AVGI*DFLOAT(NQQBCDF)/DFLOAT(NOUT)
            ESIGQQBC = AVGI*DSQRT(DFLOAT(NQQBCDF))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma g_',CINT,' --> c c_bar] ',SIGQQBC,
     +      ' +/- ',ESIGQQBC
            SIGQQBB = AVGI*DFLOAT(NQQBBDF)/DFLOAT(NOUT)
            ESIGQQBB = AVGI*DSQRT(DFLOAT(NQQBBDF))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma g_',CINT,' --> b b_bar] ',SIGQQBB,
     +      ' +/- ',ESIGQQBB
            SIGQCDC = AVGI*DFLOAT(NQCDCDF)/DFLOAT(NOUT)
            ESIGQCDC = AVGI*DSQRT(DFLOAT(NQCDCDF))/DFLOAT(NOUT)
            WRITE(6,*) ' [ gamma q_',CINT,' --> q g] ',SIGQCDC, ' +/- '
     +      ,ESIGQCDC
            IF(IDISDIF.EQ.2) THEN
               WRITE(6,*) ' PI x section ',AVGI*DFLOAT(NPI)/
     +         DFLOAT(NOUT)
               SIGQPM = AVGI*DFLOAT(NQPMPI)/DFLOAT(NOUT)
               ESIGQPM = AVGI*DSQRT(DFLOAT(NQPMPI))/DFLOAT(NOUT)
               WRITE(6,*) ' [ gamma q_',CINT,' --> q ] ',SIGQPM,' +/- '
     +         ,ESIGQPM
               SIGQQB = AVGI*DFLOAT(NQQBPI)/DFLOAT(NOUT)
               ESIGQQB= AVGI*DSQRT(DFLOAT(NQQBPI))/DFLOAT(NOUT)
               WRITE(6,*) ' [ gamma g_',CINT,' --> q q_bar] ',SIGQQB,
     +         ' +/- ',ESIGQQB
               SIGQQBC = AVGI*DFLOAT(NQQBCPI)/DFLOAT(NOUT)
               ESIGQQBC = AVGI*DSQRT(DFLOAT(NQQBCPI))/DFLOAT(NOUT)
               WRITE(6,*) ' [ gamma g_',CINT,' --> c c_bar] ',SIGQQBC,
     +         ' +/- ',ESIGQQBC
               SIGQQBB = AVGI*DFLOAT(NQQBBPI)/DFLOAT(NOUT)
               ESIGQQBB = AVGI*DSQRT(DFLOAT(NQQBBPI))/DFLOAT(NOUT)
               WRITE(6,*) ' [ gamma g_',CINT,' --> b b_bar] ',SIGQQBB,
     +         ' +/- ',ESIGQQBB
               SIGQCDC = AVGI*DFLOAT(NQCDCPI)/DFLOAT(NOUT)
               ESIGQCDC = AVGI*DSQRT(DFLOAT(NQCDCPI))/DFLOAT(NOUT)
               WRITE(6,*) ' [ gamma q_',CINT,' --> q g] ',SIGQCDC,
     +         ' +/- ',ESIGQCDC
            ENDIF
         ENDIF
      ENDIF
      IF(IK.EQ.20) THEN
         IF(IINT.EQ.0.and.IHERAC.EQ.0)  CALL SPINFO( 6 )
         IF(IHERAC.EQ.1) THEN
            write(6,*) ' Nr of events rej.by theta cut ',NTHRE
            XVIS = AVGI*DFLOAT(NOUT)/DFLOAT(NOUT+NTHRE)
            write(6,*) ' visible x section = ',XVIS
            IF(IVM.NE.0) THEN
               XVMVIS = AVGI*DFLOAT(NOUT)/DFLOAT(NIN)
               write(6,*) ' vector meson x section = ',XVMVIS
            ENDIF
            AVGI = XVIS
         ENDIF
         WRITE(6,*) ' Nr of events generated : ',NIN
         WRITE(6,*) ' Nr of events written: ',NOUT
         WRITE(6,*) ' Error summary on event generation '
         WRITE(6,*) ' Errors and their meaning meaning:'
         WRITE(6,*) ' QCDMIX: WPA>WMAX..........: ',LERR(30)
         WRITE(6,*) ' QCDMIX: WPA<0.0...........: ',LERR(31)
         WRITE(6,*) ' QCDMIX: NCALL>1000........: ',LERR(32)
         WRITE(6,*) ' LMEPS x > 0.999...........: ',LERR(45)
         WRITE(6,*) ' LMEPS boost PS error......: ',LERR(46)
         WRITE(6,*) ' LMEPS energy not conserved: ',LERR(100)
         WRITE(6,*) ' PYREMN frag. cuts.........: ',LERR(48),LERR(49)
         WRITE(6,*) ' LUPREP error..............: ',LERR(50)
         WRITE(6,*) ' PYSSPA check 1st..........: ',LERR(55)
         WRITE(6,*) ' PYSSPA no more memory.....: ',LERR(51),LERR(52)
         WRITE(6,*) ' PYSSPA boost error........: ',LERR(53)
         WRITE(6,*) ' PYSSPA xfb(iflb)=0........: ',LERR(54)
         WRITE(6,*) ' PYSSPA NTRY > 500.........: ',LERR(56)

         IF(IPRO.GT.1000) CALL HERACL(AVGI,SD,3)
      ENDIF
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.27  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  08.52.00  by  Hannes Jung
*-- Author :    Hannes Jung   13/08/96
      SUBROUTINE RALMKT(S,KT,PHISPL)
      Implicit None
      REAL KT,KTMIN,KTMAX,PHISPL,S
      Double Precision draprn
      EXTERNAL draprn
      KTMAX = SQRT(S/4.)
      KTMIN = 0.0
      PHISPL = 0.0
      KT = -LOG(draprn()*(EXP(-5.5*KTMAX) - EXP(-5.5*KTMIN))
     &  + EXP(-5.5*KTMIN))
      KT = KT/5.5
c      write(6,*) ' RALMKT ',KT,S,Ktmin,ktmax
      RETURN
      END
*CMZ :  2.08/05 28/03/2000  17.43.49  by  Hannes Jung
*CMZ :  2.08/04 10/01/2000  11.03.01  by  Hannes Jung
*CMZ :  2.08/02 13/08/99  12.44.05  by  Hannes Jung
*CMZ :  2.08/00 14/06/99  19.13.12  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  09.38.43  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE RAPGAP
      IMPLICIT None
      Double Precision XL,XU,ACC,XLB,XUB
      Integer NDI,NCALL,ITMX,NPRN,MXDIM,NDIMB,NWILDB,IG,NCALLB
      COMMON/BVEG1/XL(10),XU(10),ACC,NDI,NCALL,ITMX,NPRN
c common for bases/spring 5.1
      PARAMETER (MXDIM = 50 )
      COMMON /BPARM1/ XLB(MXDIM),XUB(MXDIM),NDIMB,NWILDB,
     +   IG(MXDIM),NCALLB
      Integer ITMX1B,ITMX2B
      Double Precision ACC1B,ACC2B
      COMMON /BPARM2/ ACC1B,ACC2B,ITMX1B,ITMX2B
*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGEFFIC.
      DOUBLE PRECISION AVGI,SD
      INTEGER NIN,NOUT
      COMMON/EFFIC/AVGI,SD,NIN,NOUT
C     SAVE

*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEEP,RGSCQ2.
      DOUBLE PRECISION SCALQ2
	Integer ISET,IP2
      COMMON/RESGAM/ISET,IP2,SCALQ2
*KEEP,RGLQ2.
      DOUBLE PRECISION Q2SUPP
      COMMON/LOWQ2S/Q2SUPP
*KEEP,PSHWR.
      INTEGER IORDER,IALPS,ITIMSHR,ISOFTG,ICCFM
      COMMON /PSHWR/IORDER,IALPS,ITIMSHR,ISOFTG,ICCFM
*KEEP,RGPRKT.
      DOUBLE PRECISION PRKT1,PRKT2,pktm
	Integer IGAMKT
      COMMON /RGPRKT/PRKT1,PRKT2,pktm,IGAMKT

*KEEP,RGPQCDPOM.
      Integer Iqqg
	COMMON/pqcdpom/ Iqqg
C     SAVE


*KEEP,RGRAHER.
      REAL XPQDIF,XPQPI
	Integer IHERPYS
	Integer NBQ2,NBX
      PARAMETER (NBQ2=20)
      PARAMETER (NBX=20)
      COMMON /RAHER/ IHERPYS,XPQDIF(-6:6,NBX,NBQ2),XPQPI(-6:6,NBX,NBQ2)
*KEEP,RGRGRIDF2.
      DOUBLE PRECISION XX,Q2X
      COMMON /RGRIDF2/ XX(NBX),Q2X(NBQ2)
      REAL F2_DIS,F2_DIF,F2_PI
      COMMON /F2VAL/ F2_DIS(NBX,NBQ2),F2_DIF(NBX,NBQ2),F2_PI(NBX,NBQ2)
cNEW
      DOUBLE PRECISION F2DIS,F2DIF,F2PI
      COMMON /F2INT/ F2DIS,F2DIF,F2PI
cNEW
*KEEP,RGFULL.
      INTEGER IFULL,IQCDGRID
      COMMON /OALPINI/ IFULL,IQCDGRID
*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEEP,RGLUDAT2.
      REAL PMAS,PARF,VCKM
      INTEGER KCHG
      COMMON/LUDAT2/KCHG(500,3),PMAS(500,4),PARF(2000),VCKM(4,4)
C      SAVE

*KEND.
      REAL ACC1,ACC2
      Integer IINT,NCB,NDIM,NPOIN,IDEG,NPOINT,ISTART
      COMMON /INTEGR/ ACC1,ACC2,IINT,NCB

      COMMON/DIVO/ NDIM,NPOIN
      REAL XMINUS(10),XPLUS(10),ANS,ERROR,PRE
      COMMON/QUADRE/IDEG
      COMMON/SAMPLE/NPOINT
      COMMON/START/ISTART
      INTEGER LST,IRES
      COMMON/EPPARA/LST(30),IRES(2)
      REAL PYPAR,PYVAR
      Integer IPY
      COMMON /PYPARA/ IPY(80),PYPAR(80),PYVAR(80)
      Integer NDIMC
      COMMON /DIMEN/ NDIMC
      Double Precision XD
      DIMENSION XD(20)
      Double Precision XG(20)
      CHARACTER CHIN*100
      CHARACTER * 16 CNAM
      CHARACTER * 7 CINT
      CHARACTER * 4 CRHO
      CHARACTER*8 VERSQQ
      REAL PARA
      Integer MSTA
      COMMON /ARDAT1/ PARA(40),MSTA(40)
      Integer IVM
      COMMON/VMESON/IVM
      REAL XPQ_DIS(-6:6),XPQ_DIF(-6:6),XPQ_PI(-6:6)
      DOUBLE PRECISION POMAX,PIMAX,WTMA
      COMMON/WEIGHT/ POMAX(NBX,NBQ2),PIMAX(NBX,NBQ2),WTMA
      DOUBLE PRECISION POM,PIM
      COMMON/WEIGHT1/ POM,PIM
      REAL XPT,Q2T
      Integer LERR,IGENFL
      COMMON/ERR/LERR(100)
      COMMON/GENWEI/IGENFL
      REAL XXI(NBX),Q2I(NBQ2)
      REAL XHF,Q2HF
      Integer KPHF
      COMMON /HEAVYF/XHF,Q2HF,KPHF
      CHARACTER CSTRU*38
      DIMENSION CSTRU(0:10)
      REAL SNGL
      DOUBLE PRECISION C1,Cg
      COMMON/BUCHMUE/C1,Cg
      Integer ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      COMMON /COLCON/ ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      Double precision DFUN,DVNOPT,USRINT,FXN1,FXNB
      Integer II,I,J,KPCH,IPROF,KPAO,Int,LU,IFIL,NFLT,IRR,idirf
      Integer idisdiff
      Integer nfltf,ngf,npomf,IDIRO,NGO,NPOMO,IHFO,IVERSQ
      Integer mstp52f,ifullf,IHERPYSO,LUCHGE
      Double Precision DOT,SQRTS,EC,DDUM,qmif,sssf,xff,t2maxf
      Double Precision CTIME
      Integer IT1,IT2
	Double Precision DQ,DX
	COMMON /qxbin/DQ,DX
      EXTERNAL DFUN,DVNOPT,USRINT,FXN1,FXNB
      LOGICAL ex
	
      Integer QFKF
      Double Precision    MQUARK, MCHARM
      COMMON /CQMASS/     MQUARK, MCHARM, QFKF
	
*KEEP,VERSQQ.
      VERSQQ = ' 2.08/06'
      IVERSQ =  20806
*KEND.
      DATA CSTRU/' Simple scaling Function      ',
     +           ' EHLQ set 1                   ',
     +           ' EHLQ set 2                   ',
     +           ' Duke-Owens set 1             ',
     +           ' Duke-Owens set 2             ',
     +           ' Morfin-Tung set 1 (S1)       ',
     +           ' Morfin-Tung set 2 (B1)       ',
     +           ' Morfin-Tung set 3 (B2)       ',
     +           ' Morfin-Tung set 4 (E1)       ',
     +           ' Gluck-Reya-Vogt LO set       ',
     +           ' Gluck-Reya-Vogt HO set       '/
      IGENFL = 0
      DO 10  I=1,100
   10 LERR(I) = 0
      ERROR = 0.0
      CHIN='PARU(11)=0.010;'
      CALL LUGIVE(CHIN)
      MCHARM = PMAS(4,1)
      ALPH=7.299D-3
      ALPHS=0.3D0
      PI=4.D0*DATAN(1.D0)
      IWEI = 0
C...  GIVE ELECTRON FOUR VECTOR
      K(1,1)=21
      K(1,2)=KE
      P(1,1) = 0.0D0
      P(1,2) = 0.0D0
      P(1,3) = DBLE(PLEPIN)
      P(1,5)=DBLE(ULMASS(KE))
      P(1,4)=DSQRT(P(1,1)**2+P(1,2)**2+P(1,3)**2+P(1,5)**2)
C...  GIVE PROTON FOUR VECTOR
      KP = 2212
      K(2,1)=21
      K(2,2)=KP
      P(2,1)= 0.0D0
      P(2,2)= 0.0D0
      P(2,3)=DBLE(PPIN)
      P(2,5)=DBLE(ULMASS(KP))
      P(2,4)=DSQRT(P(2,1)**2+P(2,2)**2+P(2,3)**2+P(2,5)**2)
      N=2
      CALL DULIST(1)
C... CALCULATE CMS ENERGY
      DO 20 I=1,4
         CM(I) =P(1,I)+P(2,I)
   20 CONTINUE

C BOOST TO EP CMS
      CALL DUDBRB(0,N,0.D0,0.D0,-CM(1)/CM(4),-CM(2)/CM(4),-CM(3)/CM(4))
      DO 30 I=1,2
         DO 30 J=1,5
            PBEAM(I,J)=P(I,J)
   30 KBEAM(I,J)=K(I,J)
      KINT(1,2) = 22
      IF(IPRO.EQ.20.OR.IPRO.EQ.21) IDIR = 0
      IF(IDIR.EQ.1) THEN
         KINT(2,2)=2212
      ELSE
         IF(NPOM.EQ.20) THEN
            KINT(2,2) = 211
         ELSEIF(NPOM.EQ.21) THEN
            KINT(2,2) = 111
         ELSE
            KINT(2,2) = 100
         ENDIF
      ENDIF
      IF(INTER.EQ.0) THEN
         KEB = KPH
      ELSEIF(INTER.EQ.2) THEN
         KEB=-24*ISIGN(1,K(1,2))
      ELSE
         WRITE(6,*) ' interaction not implemented: INTER = ',INTER
         STOP
      ENDIF
      SSS = DOT(CM,CM)
      SQRTS=DSQRT(SSS)
      EC= 0.5D0*SQRTS
      MSTA(34)=0
      IF(IPRO.EQ.10.OR.IPRO.EQ.11.OR.IPRO.EQ.12
     +.OR.IPRO.EQ.13.OR.IPRO.EQ.14.OR.IPRO.EQ.15
     +.OR.IPRO.EQ.18
     +.OR.IPRO.EQ.20.OR.IPRO.EQ.21
     +.OR.IPRO.EQ.100
     +.OR.IPRO.EQ.1200.OR.IPRO.EQ.1400
     +.OR.IPRO.EQ.30.OR.IPRO.EQ.3000
     +.OR.IPRO.EQ.99) THEN
      ELSE
         WRITE(6,*) ' wrong subprocess selected ', IPRO
         WRITE(6,*) ' PROGRAM STOPPED '
         STOP
      ENDIF
	IF(IPRO.EQ.30.OR.IPRO.EQ.3000) IDIR=0
      IF(IPRO.EQ.12.OR.IPRO.EQ.1200.OR.IPRO.EQ.1400) THEN
         IF(IFULL.EQ.0) IRES(1) = 0
      ELSEIF(IPRO.EQ.18) THEN
         IRES(1)=1
         IFULL = 0
      ELSEIF(IPRO.EQ.20) THEN
         IRES(1)=0
         IFULL = 0
      ELSE
         IFULL = 0
      ENDIF
      If (IFULL.EQ.1.OR.IPRO.EQ.13.OR.IPRO.EQ.14.OR.IPRO.EQ.20) Then
         MSTA(32) = 0
      EndIf
      IF(NG.GE.30.AND.NG.LT.100) NPOM=NG
      CALL LUNAME(KINT(2,2),CNAM)
      CINT = CNAM
      KPCH = 213
      CALL LUNAME(KPCH,CNAM)
      CRHO=CNAM
      WRITE(6,10000)

      WRITE(6,10100)

      WRITE(6,10200)

      WRITE(6,10300) VERSQQ
      IF(INTER.EQ.0) WRITE(6,10400)
      IF(INTER.EQ.2) WRITE(6,10500)
      IF(IPRO.NE.21) THEN
         IF(NG.EQ.41.OR.NG.EQ.42.AND.IPRO.LT.1000) IPRO=12
      ENDIF
      IF(IPRO.EQ.10.OR.IPRO.EQ.13) THEN
         IF(INTER.EQ.0) WRITE(6,10600) CINT
         IF(INTER.EQ.2) WRITE(6,10700) CINT
      ENDIF
      IF(IPRO.EQ.10)
     +WRITE(6,10800)

      IF(IPRO.EQ.15)
     +WRITE(6,10900)

      IF(IPRO.EQ.13)
     +WRITE(6,11000)
      IF(IPRO.EQ.18) THEN
         IF(IHFLA.GE.4) THEN
            IRPB = 0
            IF(NFLQCDC.LT.4) IRPC = 0
            IRPD = 0
c            IF(NFLQCDC.LT.4) IRPF = 0
            IRPF = 0
            IRPG = 0
         ENDIF
         WRITE(6,11100)
         IF(IRPA.NE.0) THEN
            IF(IHFLA.LT.4) write(6,11200)
            IF(IHFLA.GE.4) write(6,11300)
         ENDIF
         IF(IRPB.NE.0) write(6,11400)
         IF(IRPC.NE.0) THEN
            IF(IHFLA.LT.4) write(6,11500)
            IF(IHFLA.GE.4) write(6,11600)
         ENDIF
         IF(IRPD.NE.0) write(6,11700)
         IF(IRPE.NE.0) THEN
            IF(IHFLA.LT.4) write(6,11800)
            IF(IHFLA.GE.4) write(6,11900)
         ENDIF
         IF(IRPF.NE.0) THEN
            IF(IHFLA.LT.4) write(6,12000)
            IF(IHFLA.GE.4) write(6,12100)
         ENDIF
         IF(IRPG.EQ.1) write(6,12200)
         IF(IRPG.EQ.2) write(6,12300)

         WRITE(6,12400) SCALQ2
c         IF(IQ2.EQ.4) THEN
c            write(6,*) ' DIS resolved photons must not have Q2 as a '
c     +      //'scale'
c            write(6,*) ' PROGRAM STOPPED '
c            STOP
c         ENDIF
c         IF(IDIR.EQ.0) THEN
c            write(6,*) ' DIS resolved photons not possible for '
c     +      //'diffraction'
c            write(6,*) ' PROGRAM STOPPED '
c            STOP
c         ENDIF
      ENDIF
      IF(IPRO.EQ.20) THEN
         IF(IHFLA.GE.4) THEN
            write(6,14400) IHFLA
         ELSE
            write(6,14300) IHFLA
         ENDIF
         IF(Iqqg.eq.0) Then
            write(6,14500)
         elseif(Iqqg.eq.1) Then
            write(6,14600)
         elseif(Iqqg.eq.2) Then
            write(6,14700)
         else
            write(6,*) ' wrong Iqqg selected '
            write(6,*) ' valid values are Iqqg=0,1,2 '
            write(6,*) ' program stopped '
            stop
         endif
         IF(IFPS.EQ.3) THEN
            IFPS = 2
         ELSEIF(IFPS.EQ.1) THEN
            IFPS = 0
         ENDIF
      ELSEIF(IPRO.EQ.21) THEN
         IF(IHFLA.GE.4) THEN
            write(6,14900) IHFLA
         ELSE
            write(6,14800)IHFLA
         ENDIF
         IF(IFPS.EQ.3) THEN
            IFPS = 2
         ELSEIF(IFPS.EQ.1) THEN
            IFPS = 0
         ENDIF
      ENDIF
      IF(IPRO.EQ.30) THEN

         WRITE(6,15200)
         NPOM = 999
         NG = 999
         IFULL = 0
         PT2CUT(30) = 0.
         IF(IFPS.EQ.3) THEN
            IFPS = 2
         ELSEIF(IFPS.EQ.1) THEN
            IFPS = 0
         ENDIF

      ENDIF
      IF(IPRO.EQ.3000) THEN

         WRITE(6,15300)
         NPOM = 999
         NG =999
         IFULL = 0
         PT2CUT(30) = 0.
         IF(IFPS.EQ.3) THEN
            IFPS = 2
         ELSEIF(IFPS.EQ.1) THEN
            IFPS = 0
         ENDIF

      ENDIF
      IF(ISEMIH.EQ.1) THEN
         IF(IPRO.NE.12.AND.IPRO.NE.100) write(6,12500)
         IF(IFULL.EQ.1) write(6,12500)
      ENDIF
      IF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
         IF(INTER.EQ.0) THEN
            WRITE(6,12600) CINT
            WRITE(6,12700) MAX(4,IHFLA)
         ENDIF
         IF(INTER.EQ.2) WRITE(6,12800) CINT
         KPA=4
      ENDIF
      IF(IPRO.EQ.100) THEN
         WRITE(6,12900) CRHO

         WRITE(6,13000) CRHO
         IDIR = 0

      ENDIF
      IF(IPRO.EQ.11)
     +WRITE(6,13100)

      IF(IPRO.EQ.14) THEN
         WRITE(6,13200)
      ENDIF

      IF(IPRO.EQ.1200) THEN
         WRITE(6,13300)
         WRITE(6,13500) Q2SUPP

      ENDIF
      IHF = 0
      IF(IPRO.EQ.1400) THEN
         WRITE(6,13400)
         WRITE(6,13500) Q2SUPP
         IHFLA=MAX(4,IHFLA)
         WRITE(6,12700) IHFLA
         IHF = 1
         IPRO = 1200
         IF(IHFLA.GT.NFLAV) NFLAV=IHFLA
      ENDIF
      IF((IPRO.EQ.12.OR.IPRO.EQ.1200).AND.IDIR.EQ.0) THEN
         IF(INTER.EQ.0) WRITE(6,13600) CINT
         IF(INTER.EQ.2) WRITE(6,13700) CINT
         KPA=1
         IF(IVM.GT.0) THEN
            WRITE(6,13800) IVM

            PARJ(11)=1.
            PARJ(12)=1.
            PARJ(13)=1.
         ENDIF
         IF(IFULL.EQ.1.AND.NG.EQ.30.AND.NPOM.EQ.30) IFULL=0
         IF(IFULL.EQ.1.AND.NG.EQ.40.AND.NPOM.EQ.40) IFULL=0
         IF(IFULL.EQ.1.AND.NG.EQ.41.AND.NPOM.EQ.41) IFULL=0
         IF(IFULL.EQ.1.AND.NG.EQ.42.AND.NPOM.EQ.42) IFULL=0
cGB
         IF(IFULL.EQ.1.AND.NG.EQ.13) IFULL=0
cGB
         IF(NG.GT.30.AND.NG.LT.100) THEN
            WRITE(6,13900)
            IF(NG.EQ.30) WRITE(6,14000)
            IF(NG.EQ.40) THEN
               IF(IPRO.LT.1000) THEN
                  IPRO = 12
               ELSE
                  IPRO = 1200
               ENDIF
               WRITE(6,14100)
            ELSEIF(NG.EQ.41) THEN
               IFULL = 0
               IF(IPRO.LT.1000) THEN
                  IPRO = 12
               ELSE
                  IPRO = 1200
               ENDIF
               WRITE(6,14200)
            ELSEIF(NG.EQ.42) THEN
               IFULL = 0
               IF(IPRO.LT.1000) THEN
                  IPRO = 12
               ELSE
                  IPRO = 1200
               ENDIF
               WRITE(6,15000)
            ENDIF
         ENDIF

         IF(NG.EQ.45) THEN
            IFULL = 0
            WRITE(6,15100)
            WRITE(6,15500) C1,Cg
         ENDIF
         IF(IFULL.EQ.1.AND.NG.EQ.40) THEN
            WRITE(6,15600)

         ELSEIF(IFULL.EQ.1) THEN
            WRITE(6,15700)

            IF(IQCDGRID.EQ.0) THEN
               WRITE(6,15800)

            ELSE
               WRITE(6,15900)

            ENDIF
         ENDIF
      ELSEIF((IPRO.EQ.12.OR.IPRO.EQ.1200).AND.IDIR.EQ.1) THEN
         IF(INTER.EQ.0) WRITE(6,16000) CINT
         IF(INTER.EQ.2) WRITE(6,16100) CINT
         KPA=1
         IF(IFULL.EQ.1) THEN
            WRITE(6,16200)

            IF(IQCDGRID.EQ.0) THEN
               WRITE(6,15800)
            ELSE
               WRITE(6,15900)
            ENDIF
         ENDIF
      ENDIF
      IF(NG.EQ.45) THEN
         IFULL = 0
         WRITE(6,15100)
         WRITE(6,15500) C1,Cg
      ENDIF
      IF(IPRO.EQ.100) THEN

         WRITE(6,*)
     +    '*  EPA + gamma -->',CRHO,'  + pomeron                   *'
         IF(NPOM.GE.20) WRITE(6,*) ' Wrong NPOM selected. NPOM = ',NPOM
      ENDIF

      IF(IPRO.EQ.99) THEN

         WRITE(6,15400)
      ENDIF


      IF(THEMA.NE.180.0D0) THEN
         WRITE(6,16300) THEMA

      ELSE
         WRITE(6,*) '*  no cut on max angle of scattered electron      '
     +   //'  *'
      ENDIF
      IF(THEMI.NE.0.0D0) THEN
         WRITE(6,16400) THEMI

      ELSE
         WRITE(6,*) '*  no cut on min angle of scattered electron      '
     +   //'  *'
      ENDIF
      IF(QMI.GT.0.0) THEN
         WRITE(6,16500) QMI

      ELSE
         WRITE(6,*) '*  Q^2 _min according to kinematics               '
     +   //'  *'
      ENDIF
      IF(QMA.LT.10D8) THEN
         WRITE(6,16600) QMA

      ELSE
         WRITE(6,*) '*  Q^2 _max according to kinematics               '
     +   //'  *'
      ENDIF
      IF(YMI.GT.0.0) THEN
         WRITE(6,16700) YMI

      ELSE
         WRITE(6,*) '*  y_min according to kinematics                  '
     +   //'  *'
      ENDIF
      IF(YMA.LT.1.0) THEN
         WRITE(6,16800) YMA

      ELSE
         WRITE(6,*) '*  y_max according to kinematics                  '
     +   //'  *'
      ENDIF
      IF(IPRO.EQ.20.OR.IPRO.EQ.21.OR.IPRO.EQ.30.OR.IPRO.EQ.3000) THEN
      ELSE
         WRITE(6,16900) NFLAV
         WRITE(6,17000) NFLQCDC
      ENDIF
      IPY(8) = NFLAV
      IPROF = IPRO
      IF(IPRO.GT.1000) IPROF = IPRO/100
      IF(IPROF.EQ.12) THEN
         IF(NG.GE.41.AND.NG.LT.50) PT2CUT(IPROF) = PT2CUT(13)
      ENDIF
      IF(PT2CUT(IPROF).GT.0.0.AND.IPRO.NE.100) THEN
         WRITE(6,17100) PT2CUT(IPROF),IPRO

      ELSE
         WRITE(6,17200) IPRO

         IF(IFULL.EQ.1) THEN
            WRITE(6,17300) PT2CUT(15),PT2CUT(13)

         ENDIF
      ENDIF
cc      write(6,*) IDIR,IDISDIF
      IF(IDIR.EQ.0) IDISDIF=0
      IF(IPRO.EQ.12.OR.IPRO.EQ.1200) THEN
      ELSE
         WRITE(6,*) '* IDISDIF=0 forced, since IPRO.ne.12           '
         IDISDIF = 0
      ENDIF
      IF(NG.GE.30.and.IDISDIF.GT.0) THEN
         WRITE(6,*) '* IDISDIF=0 forced, since NG>30                '
         IDISDIF = 0
      ENDIF
      IF(IPRO.EQ.18) THEN
	   IF(IGAMKT.EQ.1) THEN
         write(6,17400) prkt1
	   ELSEIF(IGAMKT.EQ.2) THEN
         write(6,17401) prkt1,pktm
	   ELSEIF(IGAMKT.EQ.3) THEN
         write(6,17402) prkt1,pktm
	   ELSE
	   write(6,*) ' no valid distr. for prim. kt. ',
     &  'in photon selected: IGAMKT=',IGAMKT
	
	   ENDIF
      endif
      IF(IDIR.EQ.1) THEN
         write(6,17500) prkt2
      endif

      IF(IPRO.EQ.20.OR.IPRO.EQ.21) THEN
         WRITE(6,*) '* cuts for diffractive events:               '
     +   //'       *'
         WRITE(6,18000) T2MAX
         WRITE(6,18200) XF
      ELSE
         IF(IDIR.EQ.0.OR.IDISDIF.GE.1) THEN
            IF(IPRO.NE.100) THEN
               WRITE(6,*) '***         diffractive hard scattering     '
     +         //'      ***'
               IF(NG.EQ.0) THEN
                  WRITE(6,*) '* parton density in pomeron xf_0(x)=6x(1-'
     +            //'x)         *'
               ELSEIF(NG.GT.0.AND.NG.LE.5) THEN
                  WRITE(6,18400) NG,NG+1,NG
               ELSEIF(NG.EQ.10) THEN
                  WRITE(6,*) '*  parton density', 'in pomeron xf_10(x)='
     +            //'           **   (0.18+5.46x)(1-x)            '
     +            //'                   *'
               ELSEIF(NG.EQ.11) THEN
                  WRITE(6,*) '* parton density in pomeron              '
     +            //'           *'
                  WRITE(6,*) ' acc. to Donnchie Landshoff '
               ELSEIF(NG.EQ.12) THEN
                  WRITE(6,*) '* parton density in pomeron              '
     +            //'           *'
                  WRITE(6,*) '* acc. to Kniehl, Kohrs, Kramer DESY 94-'
     +            //'140         *'
                  WRITE(6,*) '* with pointlike contribution            '
     +            //'           *'
cGB
               ELSEIF(NG.EQ.13) THEN
                  Write(6,*)' '
                  WRITE(6,*) '* ==> Parton density in pomeron xf(x)=   '
     +            //'           **  (3/4){x(1-x)+(0.57/2.)(1-x)^2}'
     +            //'                   *'
                  Write(6,*)' '
cGB
               ELSEIF(NG.LT.0) THEN
                  IF(NG.ge.-15.and.NG.le.-10) Then
                  ELSEIF(NG.ge.-5.and.NG.le.-1) Then
			ELSEIF(NG.EQ.-20) THEN
                  ELSE
                     WRITE(6,*) '* user has HOPEFULLY provided gluon '
     +               //'density         *'
                     WRITE(6,*) '* via FUNCTION USDIFFR                '
     +               //'              *'
                  ENDIF
               ELSEIF(NG.EQ.30) THEN
                  WRITE(6,17900)

               ENDIF
               IF(NPOM.LT.20.OR.NPOM.GE.40) THEN

                  IF(NPOM.LT.20.AND.NPOM.GE.0) THEN
                     WRITE(6,18100) RN2,ALPHP,XF,EPSP
                  ENDIF
                  WRITE(6,*) '* cuts for diffractive events:           '
     +            //'           *'
                  WRITE(6,18000) T2MAX
                  WRITE(6,18200) XF

               ELSEIF(NPOM.EQ.20.OR.NPOM.EQ.21) THEN
                  WRITE(6,*) '* parameters for pion distribution:      '
     +            //'           *'
                  WRITE(6,18000) T2MAX
                  IF(XF.GT.0.8) THEN
                     WRITE(6,*) '* selected x_f too small for pion '
     +               //'exchange          *'
                     WRITE(6,*) '* make sure that x_f is what you want '
     +               //'              *'
                  ENDIF
                  WRITE(6,18200) XF

               ENDIF
               IF(NPOM.EQ.0) THEN
                  WRITE(6,*) '* pomeron distribution a la Streng is '
     +            //'used          *'
               ELSEIF(NPOM.EQ.1) THEN
                  WRITE(6,*) '* pomeron distribution a la Ingelman is '
     +            //'used        *'
               ELSEIF(NPOM.LT.0) THEN
                  IF(NPOM.ge.-12.and.NPOM.le.-10) Then
                  ELSEIF(NPOM.ge.-3.and.NPOM.le.-1) Then
                  ELSEIF(NPOM.eq.-20) Then
                  ELSE
                     WRITE(6,*) '* user has HOPEFULLY provided pomeron '
     +               //'distributions *'
                     WRITE(6,*) '* via FUNCTION USDIFFR                '
     +               //'              *'
                  ENDIF
               ELSEIF(NPOM.EQ.30) THEN
                  WRITE(6,18300)

               ENDIF
            ENDIF
         ENDIF
      ENDIF
      WRITE(6,*) '*****************************************************'
      IF(IFPS.NE.0.AND.IPRO.EQ.100) THEN
         WRITE(6,*) '##   no parton shower possible for IPRO = 100   ##'
         IFPS = 0
      ENDIF
      IF(IFPS.NE.0.AND.IPRO.EQ.12.AND.NG.EQ.30.AND.NPOM.EQ.30) THEN
         IF(IFPS.EQ.1.OR.IFPS.EQ.3) THEN
            WRITE(6,17600)

         ENDIF
         IF(IFPS.EQ.3) IFPS = 2
         IF(IFPS.EQ.1) IFPS = 0
      ENDIF
      IF(IFPS.EQ.0) THEN
         IPY(13) = 0
         IPY(14) = 0
      ENDIF
      IF(IFPS.NE.0) THEN
         WRITE(6,*) '##################################################'
     +   //'###'
         WRITE(6,*) '#     parton shower selection:                    '
     +   //'  #'
         IF(IFPS.EQ.0) THEN
            IPY(13) = 0
            IPY(14) = 0
         ELSEIF(IFPS.EQ.1) THEN
            IPY(13) = 0
         ELSEIF(IFPS.EQ.2) THEN
            IPY(14) = 0
         ELSEIF(IFPS.EQ.10) THEN
            IPY(13) = 0
            IPY(14) = 0
         ENDIF
         IF(IPY(14).GE.1) THEN
c            IF(ILEPTO.EQ.1) WRITE(6,*) '#     initial state parton '
c     +      //'shower a la LEPTO        #'
c            IF(ILEPTO.EQ.0) WRITE(6,*) '#     initial state parton '
c     +      //'shower a la PYTHIA       #'
            write(6,*) '#     initial state parton '
     +      //'parameters:              #'
            IF(IORDER.EQ.0) write(6,*) '#     no ordering of emitted '
     +      //'partons                #'
            IF(IORDER.EQ.1) write(6,*) '#     ordering in Q2 of '
     +      //'emitted partons             #'
            IF(IORDER.EQ.2) write(6,*) '#     ordering in Q2 and angle'
     +      //' of emitted partons   #'
            IF(IALPS.EQ.1) write(6,*) '#     alphas first order with s'
     +      //'cale Q2              #'
            IF(IALPS.EQ.2) write(6,*) '#     alphas first order with s'
     +      //'cale k_t**2=(1-z)*Q2 #'
            IF(ITIMSHR.EQ.0) write(6,*) '#     no shower of time like '
     +      //'partons                #'
            IF(ITIMSHR.EQ.1) write(6,*) '#     time like partons may '
     +      //'shower                  #'
            IF(ISOFTG.EQ.0) write(6,*) '#     soft gluons are entire'
     +      //'ly neglected          #'
            IF(ISOFTG.EQ.1) write(6,*) '#     soft gluons are resummed'
     +      //'                      #'
         ENDIF
         IF(IPY(13).EQ.1) WRITE(6,*) '#     final state parton shower  '
     +   //'                   #'
         IF(IFPS.EQ.10) Then
            WRITE(6,*) '#     parton shower with ARIADNE          '
     +      //'          #'
            write(6,*) '# BGF treatment (0/1=BGF from RAPGAP/ARIADNE)',
     +      MSTA(32)
            write(6,*) '# pomeron treatment (0/1=pom from RAPGAP/'
     +      //'ARIADNE)', MSTA(34)
            write(6,*) '# treatment of struck quark and remnant   '
     +      //'          #'
            write(6,*) '#               MSTA(30)= ',MSTA(30)
            write(6,*) '#               PARA(11)= ',PARA(11)
         ENDIF
         WRITE(6,*) '##################################################'
     +   //'###'
      ENDIF
      IF(IPRO.EQ.10.OR.
     +   IPRO.EQ.11.OR.IPRO.EQ.13.OR.IPRO.EQ.12.OR.
     +   IPRO.EQ.14.OR.IPRO.EQ.15.OR.IPRO.EQ.100) NFT = 2
      IF(IPRO.EQ.20) NFT=3
      IF(IPRO.EQ.21) NFT=2
c      IRES(1)=0
      IRES(2)=0
      WRITE(6,17700) SQRTS
      IF(IPRO.GE.1000) THEN
         IF(IRUNAEM.NE.0)
     +    write(6,*) ' alpha_em forced to be fixed for HERACLES'
         IRUNAEM=0
      ENDIF
      IF(IRUNAEM.EQ.0) THEN
         WRITE(6,*) ' alpha_em fixed; alpha_em = ',ALPH
      ELSE
         WRITE(6,*) ' running alpha_em selected '
      ENDIF
      IF(IRUNA.EQ.0) THEN
         MSTU(111) = 0
         PARU(111) = SNGL(ALPHS)
         WRITE(6,*) ' alpha_s fixed; alpha_s = ',ALPHS
      ENDIF
      IF((NG.EQ.41.OR.NG.EQ.42).AND.IDIR.EQ.0) THEN
         WRITE(6,*) ' scale for alpha_s: (p_t**2+m_q**2)/(1-beta) '
      ELSEIF(IPRO.EQ.21.AND.IDIR.EQ.0) THEN
         WRITE(6,*) ' scale for alpha_s: (p_t**2+m_q**2)/(1-beta) '
      ELSEIF(IPRO.EQ.20.AND.IDIR.EQ.0) THEN
         WRITE(6,*) ' fixed alpha_s=0.25 '
      ELSE
         IF(IQ2.EQ.1) WRITE(6,*) ' scale for alpha_s: 4*m_q**2 '
         IF(IQ2.EQ.2) WRITE(6,*) ' scale for alpha_s: shat '
         IF(IQ2.EQ.3) WRITE(6,*) ' scale for alpha_s: 4*m_q**2 + p_t **'
     +   //'2 '
         IF(IQ2.EQ.4) WRITE(6,*) ' scale for alpha_s: Q2 '
         IF(IQ2.EQ.5) WRITE(6,*) ' scale for alpha_s: Q2 + p_t **2'
         IF(IQ2.EQ.6) WRITE(6,*) ' scale for alpha_s: kt**2 (Breit fr.)'
         IF(IQ2.EQ.7) WRITE(6,*) ' scale for alpha_s: pt**2+8*pt**2/s'
         IF(IQ2.LT.1.OR.IQ2.GT.7) THEN
            WRITE(6,*) ' no valid scale selected. PROGRAM STOPS '
            STOP
         ENDIF
      ENDIF
      WRITE(6,*) ' scale is multiplied by: ',SCALFA
      WRITE(6,17800) PARU(112),MSTU(112)
      PYPAR(21) = PARU(112)

      IF(IDIR.EQ.1.OR.IDISDIF.GE.1) THEN
         WRITE(6,*) ' *** Deep Inelastic Scattering      ***'
         IF(MSTP(51).GT.10) THEN
            WRITE(6,*) ' p structure function from PDFLIB ',MSTP(51)
         ELSE
            WRITE(6,*) ' p structure function',MSTP(51),CSTRU(MSTP(51))
         ENDIF
      ENDIF


      KPAO = KPA

      IF(IPRO.LT.1000) THEN

         IF(IPRO.EQ.10.OR.IPRO.EQ.11.OR.IPRO.EQ.15) NDIM = 7
         IF(IPRO.EQ.13.OR.IPRO.EQ.14) NDIM=8
         IF(IPRO.EQ.12) NDIM=4
         IF(IPRO.EQ.100) NDIM = 4
         IF(IPRO.EQ.30) NDIM = 4
         NDIMC = 9999
   40    CALL draprnV(XG,20)
         DO 50 I=1,20
   50    XD(I)=XG(I)
         DDUM=DFUN(20,XD)
*         WRITE(6,*) ' NDIM dynamically calculated ',NDIM,NDIMC
         IF(NDIMC.GT.20) goto 40
         NDIM = NDIMC
         INT=0
         NIN=0
         NOUT=0

         IF(IINT.EQ.1) THEN
            IF(NDIM.GT.10) THEN
               write(6,*) ' more than 10 dimensions requested '
               write(6,*) ' DIVON can handle only 10 '
               write(6,*) ' user must switch to BASES integration '
               write(6,*) ' program stopped '
               stop
            endif
            DO 60 I=1,10
               XMINUS(I)=1.E-11
   60       XPLUS(I)=1.E0-XMINUS(I)
            PRE =1.75
c         PRE =0.75
            IDEG=1
            NPOINT=200
            NPOIN= NPOINT
            WRITE(6,*) ' precision parameter in DIVON = ',PRE
            WRITE(6,*) ' npoint = ',NPOINT,IDEG
            CALL PARTN(NDIM,XMINUS,XPLUS,PRE,750000)
            if(NDIM.GT.6) then
               istart = 2
               pre = 0.75
               CALL PARTN(NDIM,XMINUS,XPLUS,PRE,750000)
            endif
            CALL INTGRL(NDIM,0,400,ANS,ERROR)
c         CALL INTGRL(NDIM,1,200,ANS,ERROR)
         ELSE
********************************************************************
*     Initialization of BASES/SPRING V5.1
********************************************************************
*===> Initialization of BASES by calling BSINIT

            CALL BSINIT
            NDIMB=NDIM
            NWILDB = NDIM
            NCALLB = NCB
            ITMX1B = 30
            ACC1B = DBLE(ACC1)
            ITMX2B = 100
            ACC2B = DBLE(ACC2)
            DO 70 I=1,NDIMB
               IG(I) = 1
               XLB(I)=1.0D-12
   70       XUB(I)=1.D0
********************************************************************
*     Nimerical Integration by BASES V5.1
********************************************************************

            CALL BASES( FXNB, AVGI, SD, CTIME, IT1, IT2 )

            LU = 6
            ANS = SNGL(AVGI)
            ERROR = SNGL(SD)
         ENDIF
         SD=DBLE(ERROR)
         AVGI=DBLE(ANS)

c check for calculating QCDweights in grid
         ifil = 0
         NFLT = 6
         YMIN = DMAX1(YMI,0.00001D0)
         YMAX = DMIN1(YMA,1.D0)
         Q2MIN = DMAX1(QMI,0.5D0)
         Q2MAX = DMIN1(QMA,SSS)
         IF((IFULL.EQ.1.AND.IDIR.EQ.0).OR.(IDISDIF.GE.1)) THEN
            write(6,*) ' calculating xpq_dif in grid IFULL/IDIR/IDISDIF'
            write(6,*) ' check existence of file with pdf"s '
            inquire(FILE='pdf.dat',EXIST=ex)
            if(ex) then
               open(31,FILE='pdf.dat', FORM='unformatted',STATUS= 'OLD',
     +         IOSTAT=IRR,ERR=220)
               write(6,*) ' file 31 ',irr
               read(31) idirf,idisdiff,nfltf,ngf,npomf,mstp52f
               read(31) ifullf,qmif,sssf,xff,t2maxf
c               write(6,*) idirf,idisdiff,nfltf
c               write(6,*) ifullf,qmif,sssf
c               write(6,*) idir,idisdif,nflt
c               write(6,*) ifull,qmi,sss
               if(idirf.eq.idir.and.idisdiff.eq.idisdif.and.nfltf.eq.nf
     +         lt .and.ifullf.eq.ifull.and.ngf.eq.ng.and.npomf.eq.npom
     +         .and.mstp52f.eq.mstp(52) .and.qmif.eq.qmi.and.sssf.eq.ss
     +         s .and.xff.eq.xf.and.t2maxf.eq.t2max) then
c               if(idirf.eq.idir.and.idisdiff.eq.idisdif.and.nfltf.eq.nf
c     +         lt .and.ifullf.eq.ifull) then
                  write(6,*) ' file found with consistent parameters '
                  ifil = 1

               else
c                  write(6,*) idirf,idisdiff,nfltf
c                  write(6,*) ifullf,qmif,sssf
c                  write(6,*) idir,idisdif,nflt
c                  write(6,*) ifull,qmi,sss
                  write(6,*) ' inconsistent parameters on file on unit '
     +            //'31'
                  write(6,*) ' cold start necessary '
                  close(31)
               endif
            endif
            If(ifil.eq.0) then
               open(31,FILE='pdf.dat', FORM='unformatted',STATUS=
     +         'NEW',IOSTAT=IRR,ERR=210)
               write(6,*) ' no file found on unit 31 '
               write(6,*) ' cold start necessary '
               write(31) idir,idisdif,nflt,ng,npom,MSTP(52)
               write(31) ifull,qmi,sss,xf,t2max
            endif
            IDIRO = IDIR
            IDIR = 0
            DQ = (LOG(SSS) - LOG(QMI))/DBLE(NBQ2-1)
            DX = (LOG10(1.D0) - LOG10(QMI/SSS))/DBLE(NBX-1)
            DO 90  I=1,NBX
               POM = 0.D0
               PIM = 0.D0
               DO 90  J=1,NBQ2
                  XXI(I) = SNGL(10**(LOG10(QMI/SSS) + DX*DFLOAT(I-1)))
                  IF(XXI(I).GE.1.D0) XXI(I) = 0.999
                  XPT = XXI(I)
                  Q2I(J) = SNGL(EXP(LOG(QMI) + DQ*DFLOAT(J-1)))
                  Q2T = Q2I(J)
                  XX(I) = DBLE(XXI(I))
                  Q2X(J) = DBLE(Q2I(J))
                  XPR = XPT
                  Q2 = DBLE(Q2T)
                  If(ifil.eq.0) then
                     CALL PYSTFU(2212,XPT,Q2T,XPQ_DIF)
                     write(31) pom
                  else
                     read(31) pom
                  endif
                  IF(POM.GT.POMAX(I,J)) POMAX(I,J) = POM
                  DO 80  II = -NFLT,NFLT
                     if(ifil.eq.0) then
                        write(31) XPQ_DIF(II)
                     else
                        read(31) XPQ_DIF(II)
                     endif
                     XPQDIF(II,I,J) = XPQ_DIF(II)
                     XPQPI(II,I,J) = XPQ_DIF(II)
cc                  write(6,*)'rapgap x,q2,pom', xx(i),q2x(j),pom
cc                   write(6,*)'rapgap XOQ ',XPQ_DIF(II)
   80             CONTINUE
   90       CONTINUE
            write(6,*) ' xpq for DIF done '
            IF(IDISDIF.EQ.2) THEN
               write(6,*) ' calculating xpq_pi in grid '
               NPOMO = NPOM
               NGO = NG
               IDIR = 0
               NPOM = 20
               NG = 20
               DO 110 I=1,NBX
                  PIM = 0.D0
                  DO 110 J=1,NBQ2
                     XXI(I) = SNGL(10**(LOG10(QMI/SSS) + DX*DFLOAT(I-1)
     +               ))
                     IF(XXI(I).GE.1.D0) XXI(I) = 0.999
                     XPT = XXI(I)
                     Q2I(J) = SNGL(EXP(LOG(QMI) + DQ*DFLOAT(J-1)))
                     Q2T = Q2I(J)
                     XX(I) = DBLE(XXI(I))
                     Q2X(J) = DBLE(Q2I(J))
                     XPR = XPT
                     Q2 = DBLE(Q2T)
                     If(ifil.eq.0) then
                        CALL PYSTFU(2212,XPT,Q2T,XPQ_PI)
                        write(31) pim
                     else
                        read(31) pim
                     endif
                     IF(PIM.GT.PIMAX(I,J)) PIMAX(I,J) = PIM
                     DO 100 II = -NFLT,NFLT
                        if(ifil.eq.0) then
                           write(31) XPQ_PI(II)
                        else
                           read(31) XPQ_PI(II)
                        endif
                        XPQPI(II,I,J) = XPQ_PI(II)
c                  write(6,*)'rapgap x,q2,pom', xx(i),q2x(j),pom
  100                CONTINUE
  110          CONTINUE
               write(6,*) ' xpq for PI done '
               NG = NGO
               NPOM = NPOMO
            ENDIF
            IHERPYS = 1
c            write(6,*) ' RAPGAP: IHERPYS ',IHERPYS
            IDIR = IDIRO
         ENDIF
      ELSEIF(IPRO.EQ.1200.OR.IPRO.EQ.3000) THEN
c      write(6,*) IDIR,IDISDIF,IFULL
c      write(6,*) NG,NPOM,MSTP(51)
         YMIN = DMAX1(YMI,0.00001D0)
         YMAX = DMIN1(YMA,1.D0)
         Q2MIN = DMAX1(QMI,0.5D0)
         Q2MAX = DMIN1(QMA,SSS)
         IHERPYS = 0
         ifil = 0
         NFLT = 6
         IHFO = IHF
         IHF = 0
         IF(IDIR.EQ.0.OR.IDISDIF.GE.1) THEN
            write(6,*) ' calculating xpq_dif in grid HERACLES'
            IDIRO = IDIR
            NGO = NG
            NPOMO = NPOM
            write(6,*) ' check existence of file with pdf"s '
            inquire(FILE='pdf.dat',EXIST=ex)
            if(ex) then
               open(31,FILE='pdf.dat', FORM='unformatted',STATUS= 'OLD',
     +         IOSTAT=IRR,ERR=220)
               write(6,*) ' file 31 ',irr
               read(31) idirf,idisdiff,nfltf,ngf,npomf,mstp52f
               read(31) ifullf,qmif,sssf,xff,t2maxf
               write(6,*) idirf,idisdiff,nfltf,mstp52f
               write(6,*) ifullf,qmif,sssf,xff,t2maxf
               write(6,*) idir,idisdif,nflt,mstp(52)
               write(6,*) ifull,qmi,sss,xf,t2max
               if(idirf.eq.idir.and.idisdiff.eq.idisdif.and.nfltf.eq.nf
     +         lt .and.ifullf.eq.ifull.and.ngf.eq.ng.and.npomf.eq.npom
     +         .and.mstp52f.eq.mstp(52) .and.qmif.eq.qmi.and.sssf.eq.ss
     +         s .and.xff.eq.xf.and.t2maxf.eq.t2max) then
c               if(idirf.eq.idir.and.idisdiff.eq.idisdif.and.nfltf.eq.nf
c     +         lt .and.ifullf.eq.ifull) then
                  write(6,*) ' file found with consistent parameters '
                  ifil = 1

               else
c                  write(6,*) idirf,idisdiff,nfltf
c                  write(6,*) ifullf,qmif,sssf
c                  write(6,*) idir,idisdif,nflt
c                  write(6,*) ifull,qmi,sss
                  write(6,*) ' inconsistent parameters on file on unit '
     +            //'31'
                  write(6,*) ' cold start necessary '
                  close(31)
               endif
            endif
            If(ifil.eq.0) then
               open(31,FILE='pdf.dat', FORM='unformatted',STATUS=
     +         'NEW',IOSTAT=IRR,ERR=210)
               write(6,*) ' no file found on unit 31 '
               write(6,*) ' cold start necessary '
               write(31) idir,idisdif,nflt,ng,npom,MSTP(52)
               write(31) ifull,qmi,sss,xf,t2max
            endif
            IDIR = 0
            DQ = (LOG(SSS) - LOG(QMI))/DBLE(NBQ2-1)
            DX = (LOG10(1.D0) - LOG10(QMI/SSS))/DBLE(NBX-1)
            DO 130 I=1,NBX
               DO 130 J=1,NBQ2
                  XXI(I) = SNGL(10**(LOG10(QMI/SSS) + DX*DFLOAT(I-1)))
                  IF(XXI(I).GE.1.D0) XXI(I) = 0.999
                  XPT = XXI(I)
c                  if(xpt.lt.1.e-3) goto 120
                  Q2I(J) = SNGL(EXP(LOG(QMI) + DQ*DFLOAT(J-1)))
                  Q2T = Q2I(J)
                  XX(I) = DBLE(XXI(I))
                  Q2X(J) = DBLE(Q2I(J))
                  XPR = XPT
                  Q2 = DBLE(Q2T)
                  POM = 0.D0
                  PIM = 0.D0
c                  write(6,*) ' RAPGAP integrate pom/pi pdf: X,Q2',xpt,q2t
                  If(ifil.eq.0) then
                     CALL PYSTFU(2212,XPT,Q2T,XPQ_DIF)
c              write(6,*) 'XPT,Q2T,XPQ_DIF',XPT,Q2T,XPQ_DIF
                     IF(NG.EQ.20.or.NG.eq.21) THEN
                     write(31) pim
			   ELSE
                     write(31) pom
			   ENDIF
                  else
                     IF(NG.EQ.20.or.NG.eq.21) THEN
                     read(31) pim
			   ELSE
                     read(31) pom
			   ENDIF
                  endif
                     IF(NG.EQ.20.or.NG.eq.21) THEN
                  IF(PIM.GT.PIMAX(I,J)) PIMAX(I,J) = PIM
			   ELSE
                  IF(POM.GT.POMAX(I,J)) POMAX(I,J) = POM
                     ENDIF

                  DO 120 II = -NFLT,NFLT
                     if(ifil.eq.0) then
                        write(31) XPQ_DIF(II)
                     else
                        read(31) XPQ_DIF(II)
                     endif
                     XPQDIF(II,I,J) = XPQ_DIF(II)
                     XPQPI(II,I,J) = XPQ_DIF(II)
c                  write(6,*) xpq_dif(II),xx(i),q2x(j)
  120             CONTINUE
  130       CONTINUE
            write(6,*) ' xpq  done '
            IF(IDISDIF.EQ.2) THEN
               NPOMO = NPOM
               NGO = NG
               IDIR = 0
               NPOM = 20
               NG = 20
               PIM = 0.D0
               DO 150 I=1,NBX
                  DO 150 J=1,NBQ2
                     XXI(I) = SNGL(10**(LOG10(QMI/SSS) + DX*DFLOAT(I-1)
     +               ))
                     IF(XXI(I).GE.1.D0) XXI(I) = 0.999
                     XPT = XXI(I)
                     Q2I(J) = SNGL(EXP(LOG(QMI) + DQ*DFLOAT(J-1)))
                     Q2T = Q2I(J)
                     XX(I) = DBLE(XXI(I))
                     Q2X(J) = DBLE(Q2I(J))
                     XPR = XPT
                     Q2 = DBLE(Q2T)
                     POM = 0.D0
                     PIM = 0.D0
                     If(ifil.eq.0) then
                        CALL PYSTFU(2212,XPT,Q2T,XPQ_PI)
                        write(31) pim
                     else
                        read(31) pim
                     endif
                     IF(PIM.GT.PIMAX(I,J)) PIMAX(I,J) = PIM
			
                     DO 140 II = -NFLT,NFLT
                        if(ifil.eq.0) then
                           write(31) XPQ_PI(II)
                        else
                           read(31) XPQ_PI(II)
                        endif
                        XPQPI(II,I,J) = XPQ_PI(II)
c                  write(6,*) xpq_dif(II),xx(i),q2x(j)
  140                CONTINUE
  150          CONTINUE
               write(6,*) ' xpq for pi done '
            ENDIF
            IDIR = IDIRO
            NG = NGO
            NPOM = NPOMO
            IF(IDIR.EQ.0) IHERPYS = 1
         ENDIF
         IHF = IHFO
         CALL HERACL(AVGI,SD,1)
      ELSE
         write(6,*) 'process IPRO = ',IPRO,' not implemented  '
      ENDIF

      write(6,*) IDIR,IDISDIF,IFULL
      write(6,*) NG,NPOM,MSTP(51)
c check whether mixing of DIS, DIF, and pi exchange is wanted
      IF(IDISDIF.GE.1.AND.IDIR.EQ.1) THEN
         DQ = (LOG(SSS) - LOG(QMI))/DBLE(NBQ2-1)
         DX = (LOG10(1.D0) - LOG10(QMI/SSS))/DBLE(NBX-1)
         IHERPYSO = IHERPYS
         DO 190 I=1,NBX
            POM = 0.D0
            DO 190 J=1,NBQ2
               XXI(I) = SNGL(10**(LOG10(QMI/SSS) + DX*DFLOAT(I-1)))
               IF(XXI(I).GE.1.D0) XXI(I) = 0.999
               XPT = XXI(I)
               Q2I(J) = SNGL(EXP(LOG(QMI) + DQ*DFLOAT(J-1)))
               Q2T = Q2I(J)
               XX(I) = DBLE(XXI(I))
               Q2X(J) = DBLE(Q2I(J))
               XPR = XPT
               NPOMO = NPOM
               IDIRO = IDIR
               NGO = NG
               IDIR = 1
               IHERPYS = 0
               CALL PYSTFU(2212,XPT,Q2T,XPQ_DIS)
               F2_DIS(I,J) = 0.
               DO 160 II=-6,6
c               write(6,*) 'RAPGAP',XPQ_DIS(II),LUCHGE(II),II
  160          F2_DIS(I,J) = F2_DIS(I,J) + FLOAT(LUCHGE(II))**2 /9.0 *
     +         XPQ_DIS(II)
c               write(6,*) ' F2_DIS ',F2_DIS(I,J),XX(I),Q2X(J)
c               write(6,*) iherpys,iherpyso
               IHERPYS = IHERPYSO
               IHERPYS = 1
               IDIR = 0
               NPOM = NPOMO
               POM = 0.D0
               CALL PYSTFU(2212,XPT,Q2T,XPQ_DIF)
               IF(POM.GT.POMAX(I,J)) POMAX(I,J)=POM
               F2_DIF(I,J) = 0.
               DO 170 II=-6,6
c                  write(6,*) 'RAPGAP',XPQ_DIF(II),LUCHGE(II),II
  170          F2_DIF(I,J) = F2_DIF(I,J) + FLOAT(LUCHGE(II))**2 /9. *
     +         XPQ_DIF(II)
c               write(6,*) ' F2_DIF ',F2_DIF(I,J),XX(I),Q2X(J)
               F2_PI(I,J) = 0.
               IF(IDISDIF.EQ.2) THEN
                  IDIR = 0
                  NPOM = 20
                  NG = 20
                  PIM = 0.D0
                  CALL PYSTFU(2212,XPT,Q2T,XPQ_PI)
                  IF(PIM.GT.PIMAX(I,J)) PIMAX(I,J)=PIM
                  DO 180 II=-6,6
c               write(6,*) 'RAPGAP',XPQ_PI(II),LUCHGE(II),II
  180             F2_PI(I,J) = F2_PI(I,J) + FLOAT(LUCHGE(II))**2 /9. *
     +            XPQ_PI(II)
c               write(6,*) ' F2_PI ',F2_PI(I,J),XX(I),Q2X(J)
               ENDIF
               IDIR =IDIRO
               NPOM =NPOMO
               NG = NGO
  190    CONTINUE
         IHERPYS = IHERPYSO
         WRITE(6,18500)

         DO 200 J=1,NBQ2
            DO 200 I=1,NBX
               WRITE(6,18600) XX(I),Q2X(J),F2_DIS(I,J),F2_DIF(I,J),
     +         F2_PI(I,J)

  200    CONTINUE
      ENDIF
      IF(IFULL.EQ.1.AND.IQCDGRID.EQ.1) THEN
         CALL QCDGRID
      ENDIF

      KPA = KPAO
      RETURN
  210 write(6,*) ' error opening new file for pdf"s '
      stop
  220 write(6,*) ' error opening old file for pdf"s '
      STOP
10000 FORMAT(' *****************************************************')
10100 FORMAT(' *                                                   *')
10200 FORMAT(' *     You are using the RAPGAP MC generator         *')
10300 FORMAT(' *           version  ',A8,'                       *')
10400 FORMAT(' *    neutral current interaction selected           *')
10500 FORMAT(' *    charged current interaction selected           *')
10600 FORMAT(' *  gamma + gluon_',A6,' --> q q_bar(light quarks)   *')
10700 FORMAT(' *      W + gluon_',A6,' --> q q_bar(light quarks)   *')
10800 FORMAT(' *  EPA + gamma* gluon --> q q_bar (massless) used   *')
10900 FORMAT(' *  full ME    e q --> q gluon (massless) used       *')
11000 FORMAT(' *  full matrixelement e gluon --> e" q q_bar        *')
11100 FORMAT(' *  resolved photon processes                        *')
11200 FORMAT(' *               g + g     --> q + q_bar             *')
11300 FORMAT(' *               g + g     --> Q + Q_bar             *')
11400 FORMAT(' *               g + g     --> g + g                 *')
11500 FORMAT(' *               g + q     --> g + q                 *')
11600 FORMAT(' *               g + Q     --> g + Q                 *')
11700 FORMAT(' *               q + q_bar --> g + g                 *')
11800 FORMAT(' *               q + q_bar --> q + q_bar             *')
11900 FORMAT(' *               q + q_bar --> Q + Q_bar             *')
12000 FORMAT(' *               q + q     --> q + q                 *')
12100 FORMAT(' *               q + q     --> Q + Q                 *')
12200 FORMAT(' *  Mueller/Tang q + q     --> q + q                 *')
12300 FORMAT(' *  massive glu  q + q     --> q + q                 *')
12400 FORMAT(' *  for DIS:  scale > ',F7.3,' Q2                     *')
12500 FORMAT(' *  semihard approach for BGF a la Zotov et al       *')
12600 FORMAT(' *  gamma + gluon_',A4,
     +   ' --> Q Q_bar                   *')
12700 FORMAT(' *  heavy flavor produced is :',I3,'                   *')
12800 FORMAT(' *      W + gluon_',A4,
     +   ' --> c c_bar                   *')
12900 FORMAT(' *      gamma + pomeron --> ',A4,' + pomeron           *')
13000 FORMAT(' *  M.E.(gamma + pomeron --> ',A4,' + pomeron) = 1.E-4 *')
13100 FORMAT(' *  EPA + gamma gluon --> Q Q_bar (massive)   used   *')
13200 FORMAT(' *  full matrixelement e gluon --> e" Q Q_bar        *')
13300 FORMAT(' *  using HERACLES 4.6 for DIS                       *')
13400 FORMAT(' *  using HERACLES 4.6 for for heavy quark BGF        *')
13500 FORMAT(' *  HERACLES low q2 supp.: 1.-EXP(-',F4.2,
     +    '*Q2)          *')
13600 FORMAT(' *  gamma + q_',A7, ' --> q  (DIS diffractive)       *')
13700 FORMAT(' *      W + q_',A7, ' --> q  (DIS diffractive)       *')
13800 FORMAT(' *  vector meson production selected for IVM = ',I4)
13900 FORMAT(' *  QCD calc. for hard diffractive scattering used   *')
14000 FORMAT(' *  Nikolaev Zakharov model                          *')
*13600 FORMAT(' *  parametrisation of M. Wuesthoff  (DESY 95-166)   *')
14100 FORMAT(' *  M. Wuesthoff (ANL-HEP-PR 97-03)                  *')
14200 FORMAT(' *  Bartels, Lotter, Wuestoff (DESY 96-026)          *')
14300 FORMAT(' *  Bartels/Jung/Wuesthoff qqg for DIF DESY 99-027   *',/,
     +       ' *  gamma* p --> q q_bar g p (via 2 gluon exchange)  *',/,
     +       ' *  heaviest flavor produced:',I2,
     +       '                      *')
14400 FORMAT(' *  Bartels/Jung/Wuesthoff qqg for DIF DESY 99-027   *',/,
     +       ' *  gamma* p --> Q Q_bar g p (via 2 gluon exchange)  *',/,
     +       ' *  heaviest flavor produced:',I2,
     +       '                      *')
14500 FORMAT(' *   full integration selceted                       *')
14600 FORMAT(' *   approximate formula acc. eq.(4.5) DESY 99-027   *',/
     +       ' *   ordering in k_t: k_t_quark > k_t_gluon          *')
14700 FORMAT(' *   approximate formula acc. eq (4.5) DESY 99-027   *',/
     +       ' *   ordering in k_t: k_t_quark > k_t_gluon          *',/
     +       ' *   and suppression at large beta                   *')
14800 FORMAT(' *  Bartels, Lotter, Wuestoff (DESY 96-026)          *',/
     +       ' *  gamma* p --> q q_bar p (via 2 gluon exchange)    *',/,
     +       ' *  heaviest flavor produced:',I2,
     +       '                      *')
14900 FORMAT(' *  Bartels, Lotter, Wuestoff (DESY 96-026)          *',/
     +       ' *  gamma* p --> Q Q_bar p (via 2 gluon exchange)    *',/,
     +       ' *  heaviest flavor produced:',I2,
     +       '                      *')

15000 FORMAT(' *  M. Diehl with Donnachie/Landshoff 2 glu pomeron  *')
15100 FORMAT(' *  Buchmueller/McDermott/Hebecker DESY 97-099       *')
15200 FORMAT(' *  saturation model Golec-Biernat and Wuesthoff     *',/
     +       ' *  coded by H. Kowalski and M. Wuesthoff            *')
15300 FORMAT(' *  saturation model Golec-Biernat and Wuesthoff     *',/
     +       ' *  coded by H. Kowalski and M. Wuesthoff            *',/
     +       ' *  with rad. correction from HERACLES               *')
15400 FORMAT(' *  only phase space for gamma glu --> q q_bar g     *')
15500 FORMAT(' *  C1 = ',F6.2,' Cg = ',F6.2,
     + '                           *')
15600 FORMAT(' *  gamma glu glu --> q q_bar                        *',
     +     /,' *  gamma glu glu --> q q_bar glu                    *')
15700 FORMAT(' *  mixing of QPM and O(alpha_s) processes selected  *')
15800 FORMAT(' *      QCD weights calculated event by event        *')
15900 FORMAT(' *      QCD weights calculated in grid               *')
16000 FORMAT(' *  gamma + q_',A6, ' --> q  (DIS )                   *')
16100 FORMAT(' *      W + q_',A6, ' --> q  (DIS )                   *')
16200 FORMAT(' *  mixing of QPM and O(alpha_s) processes selected  *')
16300 FORMAT(' *  scattered electron theta_max = ',F7.3,'           *')
16400 FORMAT(' *  scattered electron theta_min = ',F7.3,'           *')
16500 FORMAT(' *  Q^2 _min = ',F7.3,'                               *')
16600 FORMAT(' *  Q^2 _max = ',F7.3,'                               *')
16700 FORMAT(' *  y _min = ',F7.3,'                                 *')
16800 FORMAT(' *  y _max = ',F7.3,'                                 *')
16900 FORMAT(' *  Nr of flavours in target sea  = ',I4,'             *')
17000 FORMAT(' *  Nr of flavours for QCDC  = ',I4,'                  *')
17100 FORMAT(' *  cut on p_t ^2  = ',f5.2,' for IPRO = ',I5,
     +       '          *')
17200 FORMAT(' *  no p_t ^2 cut imposed for IPRO = ',I4,
     +       '            *')
17300 FORMAT(' *  p_t^2 cut:',F5.2,' for IPRO=15 ',F5.2,
     +       ' for IPRO=13    *')
17400 FORMAT(' * gaussian intrinsic kt in photon:',F5.2,
     +'             *')
17401 FORMAT(' * dkt^2/(kt0^2 + kt^2) intrinsic kt in photon:      *',
     +/,' *  kt0 = ',F5.2,' ktm = ',F5.2,'                          *')
17402 FORMAT(' * dkt^2/(kt0^2 + kt^2)^2 intrinsic kt in photon:    *',
     +/,' *  kt0 = ',F5.2,' ktm = ',F5.2,'                          *')
17500 FORMAT(' *  intrinsic kt in proton:',F5.2,
     +'                     *')
17600 FORMAT(' ##    no initial state PS possible for NG,NPOM=30   ##',/
     +      ,' ##    switch to final state PS                      ##')
17700 FORMAT('  cm energy of ep system ',F10.3,' GEV')
17800 FORMAT('  Lambda_qcd = ',F5.3,' at NF= ',I2,' flavours')
17900 FORMAT(' * Nikolaev Zakharov process selected ')
18000 FORMAT(' * t_max  = ',F7.3,'                                  *')
18100 FORMAT(' * Rn**2=',F5.3,/,'   alpha_Po =',F5.3
     +    ,/,' * cut on x_f:  ',F5.3,/,'   epsilon =',F6.4)
18200 FORMAT(' * cut on x_f:  ',F5.3,
     +    '                                *')
18300 FORMAT(' * Nikolaev Zakharov process selected ')
18400 FORMAT(' * parton density in pomeron xf_',
     +             I1,' (x) = ',I1,'*(1-x)**',I1)
18500 FORMAT('    X     |   Q^2   |',
     +      ' F_2 (DIS) | F_2 (DIF) | F_2 (PI)   | ')
18600 FORMAT(' ',E8.2,' |',F8.2,' |  ',F8.4,' |   '
     +                   ,F8.4,' |   ',F8.4,' |')

      END
*CMZ :  2.08/05 28/03/2000  14.06.17  by  Hannes Jung
*CMZ :  2.08/00 23/06/99  08.08.05  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  09.56.21  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94

      SUBROUTINE RASTFU(KF,XRX,SCALA,XPQ)
      Implicit None
c note that xpq is parton density of pomeron for NG<20
c but diffractive parton density for NG>20: xpq = xpq(beta,x_pom,t2,scala)
c        also for user defined function USDIFFR(beta,scala,xpq,xpom,t2)
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEND.
cGB
      Real  XPGB
cGB
C...MODIFIED FOR USE IN HERACLES 4.2 (BY H.SPIESBERGER, 8.2.93)
      Real PYSTOP,PYSLAM
      Integer NPYMOD,NPYMAX,NPYMIN
      COMMON /PYSTFUC/ PYSTOP,PYSLAM,NPYMOD,NPYMAX,NPYMIN
C Input:
C   PYSTOP = top mass
C   NPYMAX = maximal flavour
C   NPYMIN = minimal flavour
C   NPYMOD = Choice of parametrization
      Integer LUNTES,LUNDAT,LUNIN,LUNOUT,LUNRND
      COMMON /HSUNTS/ LUNTES,LUNDAT,LUNIN,LUNOUT,LUNRND
      Integer LPAR,LPARIN,IPART
      COMMON /HSPARL/ LPAR(20),LPARIN(12),IPART
*KEEP,RGRAHER.
      REAL XPQDIF,XPQPI
	Integer IHERPYS
	Integer NBQ2,NBX
      PARAMETER (NBQ2=20)
      PARAMETER (NBX=20)
      COMMON /RAHER/ IHERPYS,XPQDIF(-6:6,NBX,NBQ2),XPQPI(-6:6,NBX,NBQ2)
*KEND.
      REAL COW(3,5,4,2),XQ(9),TS(6)
      DOUBLE PRECISION XX,QQ,UPV,DNV,USEA,DSEA,STR,CHM,BOT,TOP,GLU,
     +VAL(20)
C coded is xQ(X,SCALE) and xG(x,SCALE), not G(x) or Q(x)
      REAL XRX,X,SCALE,SCALA
      INTEGER KF
      REAL F2SIG
      LOGICAL FIRST,FIRS
      LOGICAL PDFFIRST
      COMMON /W50516/PDFFIRST

      REAL XPQ(-6:6)
      CHARACTER*20 PARM(20)
      DOUBLE PRECISION BETA,F2QT,FLQ,X_POM,T2,XGX,XDX(-4:4)
      DOUBLE PRECISION PT2GEN,PHIGEN
      COMMON/HARDPOM/PT2GEN,PHIGEN
      REAL PYGAMM
      EXTERNAL PYGAMM
      Real GEV2NB,DNC,DC,XP,EULBET,XPQU,DL1,DL2,DL3,Q2IN,ALPH_EM,SD
      Real POINT,Y,ALAM
      Real D2S_VL,D2S_VS,D2S_VC,D2S_SL,D2S_SS,D2S_SC
      Integer I,IP,IS,INIT,NPDF,NSET,KFL,KPHF
      DATA GEV2NB/.3893857E+6/
      DATA DNC/3./,DC/1./
      DATA XP/0.0/,INIT/0/,FIRST/.TRUE./,FIRS/.TRUE./
      DATA NPDF/0/
C...The following data lines are coefficients needed in the
C...Owens pion structure function parametrizations, see below.
C...Expansion coefficients for up and down valence quark distributions.
      DATA ((COW(IP,IS,1,1),IS=1,5),IP=1,3)/
     +  4.0000E-01,  7.0000E-01,  0.0000E+00,  0.0000E+00,  0.0000E+00,
     + -6.2120E-02,  6.4780E-01,  0.0000E+00,  0.0000E+00,  0.0000E+00,
     + -7.1090E-03,  1.3350E-02,  0.0000E+00,  0.0000E+00,  0.0000E+00/
      DATA ((COW(IP,IS,1,2),IS=1,5),IP=1,3)/
     +  4.0000E-01,  6.2800E-01,  0.0000E+00,  0.0000E+00,  0.0000E+00,
     + -5.9090E-02,  6.4360E-01,  0.0000E+00,  0.0000E+00,  0.0000E+00,
     + -6.5240E-03,  1.4510E-02,  0.0000E+00,  0.0000E+00,  0.0000E+00/
C...Expansion coefficients for gluon distribution.
      DATA ((COW(IP,IS,2,1),IS=1,5),IP=1,3)/
     +  8.8800E-01,  0.0000E+00,  3.1100E+00,  6.0000E+00,  0.0000E+00,
     + -1.8020E+00, -1.5760E+00, -1.3170E-01,  2.8010E+00, -1.7280E+01,
     +  1.8120E+00,  1.2000E+00,  5.0680E-01, -1.2160E+01,  2.0490E+01/
      DATA ((COW(IP,IS,2,2),IS=1,5),IP=1,3)/
     +  7.9400E-01,  0.0000E+00,  2.8900E+00,  6.0000E+00,  0.0000E+00,
     + -9.1440E-01, -1.2370E+00,  5.9660E-01, -3.6710E+00, -8.1910E+00,
     +  5.9660E-01,  6.5820E-01, -2.5500E-01, -2.3040E+00,  7.7580E+00/
C...Expansion coefficients for (up+down+strange) quark sea distribution.
      DATA ((COW(IP,IS,3,1),IS=1,5),IP=1,3)/
     +  9.0000E-01,  0.0000E+00,  5.0000E+00,  0.0000E+00,  0.0000E+00,
     + -2.4280E-01, -2.1200E-01,  8.6730E-01,  1.2660E+00,  2.3820E+00,
     +  1.3860E-01,  3.6710E-03,  4.7470E-02, -2.2150E+00,  3.4820E-01/
      DATA ((COW(IP,IS,3,2),IS=1,5),IP=1,3)/
     +  9.0000E-01,  0.0000E+00,  5.0000E+00,  0.0000E+00,  0.0000E+00,
     + -1.4170E-01, -1.6970E-01, -2.4740E+00, -2.5340E+00,  5.6210E-01,
     + -1.7400E-01, -9.6230E-02,  1.5750E+00,  1.3780E+00, -2.7010E-01/
C...Expansion coefficients for charm quark sea distribution.
      DATA ((COW(IP,IS,4,1),IS=1,5),IP=1,3)/
     +  0.0000E+00, -2.2120E-02,  2.8940E+00,  0.0000E+00,  0.0000E+00,
     +  7.9280E-02, -3.7850E-01,  9.4330E+00,  5.2480E+00,  8.3880E+00,
     + -6.1340E-02, -1.0880E-01, -1.0852E+01, -7.1870E+00, -1.1610E+01/
      DATA ((COW(IP,IS,4,2),IS=1,5),IP=1,3)/
     +  0.0000E+00, -8.8200E-02,  1.9240E+00,  0.0000E+00,  0.0000E+00,
     +  6.2290E-02, -2.8920E-01,  2.4240E-01, -4.4630E+00, -8.3670E-01,
     + -4.0990E-02, -1.0820E-01,  2.0360E+00,  5.2090E+00, -4.8400E-02/


C...Euler's beta function, requires ordinary Gamma function
      EULBET(X,Y)=PYGAMM(X)*PYGAMM(Y)/PYGAMM(X+Y)
      DO 10 I=-6,6
   10 XPQ(I) = 0.0
      IF(NG.LT.40) PT2GEN = 0.D0
      SCALE = SCALA
c      IF(IWEI.EQ.1) THEN
c         write(6,*) ' RASTFU: NG = ',NG,' NPOM = ',NPOM,' IPRO ',IPRO
c         write(6,*) ' RASTFU: KF = ',KF,' X ',X
c         ENDIF
      IF(FIRS) THEN
         write(6,*) ' RASTFU: NG = ',NG,' NPOM = ',NPOM
         FIRS=.FALSE.
      ENDIF
      X=XRX
      IF(X.LT.0.0.OR.X.GE.1) THEN
         write(6,*) ' RASTFU error: X = ',X
         IF(X.LT.0) X=0.
         IF(X.GE.1.) X=0.99999
         RETURN
      ENDIF
      IF(SCALE.LT.0.0) THEN
         write(6,*) ' RASTFU error: SCALE = ',SCALE
         SCALE = 0.0001
         RETURN
      ENDIF
      IF(NG.LT.0) THEN
         IF(NG.GE.-5.AND.NG.LE.-1) THEN
c ACTW Fit
            CALL ACTWFIT(X,SCALE,XPQ,XFGKI,T2GKI)
            IF(FIRS) THEN
               WRITE(6,*) ' ACTW pdf"s are used '
            ENDIF
            GOTO 120
         ELSEIF(NG.GE.-15.AND.NG.LE.-10) THEN
c H1 QCD Fit
            CALL H1QCDFIT(X,SCALE,XPQ,XFGKI,T2GKI)
            GOTO 120
         ELSEIF(NG.EQ.-20.AND.NG.EQ.-20) THEN
c Soft Colour Interaction approach from Buchmueller/Hebecker
            CALL SCAPDF(X,SCALE,XPQ,XFGKI,T2GKI)
            GOTO 120
         ELSE
            IF(FIRS) THEN
               WRITE(6,*) ' User defined routine USDIFFR used '
            ENDIF
            FIRST = .FALSE.
c      write(6,*) ' RASTFU: beta,scale,x_pom,t2',beta,scale,xfgki,t2gki
c      write(6,*) ' RASTFU: beta,x',beta,x
            CALL USDIFFR(X,SCALE,XPQ,XFGKI,T2GKI)
            GOTO 120
         ENDIF
      ENDIF
c         write(6,*) 'rastfu: x,scale',x,scale
      IF(NG.EQ.12) THEN

         XPQ(0) = 9./2 *X*(1.-X)
         XPQU = 3./10. *X*(1.-X)
C add pointlike contribution
c         write(6,*) ' log arg = ',SCALE*(1.-X)/0.3/0.3/X,x,scale
         DL1 = ALOG(SCALE*(1.-X)/0.3/0.3/X)
         IF(DL1.LE.0.) DL1=0.0
         DL2 = ALOG(SCALE*(1.-X)/0.3/0.3/X)
         IF(DL2.LE.0.) DL2=0.0
         DL3 = ALOG(SCALE*(1.-X)/0.5/0.5/X)
         IF(DL3.LE.0.) DL3=0.0
         POINT = DNC/8.0/SNGL(PI)**2 * DC**2*(X**2 + (1. - X)**2)
c          IF(POINT.LE.0) write(6,*) DL1,POINT,XPQ(1),X
         XPQ(1) = XPQU + X * POINT*DL1
         XPQ(-1)= XPQ(1)
         XPQ(2) = XPQU + X * POINT*DL2
         XPQ(-2)= XPQ(1)
         XPQ(3) = 3./20. *X*(1.-X) + X * POINT * DL3
         XPQ(-3) = XPQ(3)
c charm here is only for testing
c         xpq(4) = xpqu/10.
c         xpq(-4)= xpq(4)
c end testing...........................
c         IF(IWEI.EQ.1) write(6,*) ' RASTFU: 12 NG,NPOM',NG,NPOM
cGB
      ELSEIF(NG.EQ.13) THEN
         XPGB = (3./4.)*(X*(1.-X)+(0.57/2.)*(1.-X)**2)
         XPQ(0)  = 0.
         XPQ(1)  = XPGB
         XPQ(2)  = XPGB
         XPQ(3)  = XPGB
         XPQ(-1) = XPGB
         XPQ(-2) = XPGB
         XPQ(-3) = XPGB
cGB
      ELSEIF(NG.GT.0.AND.NG.LE.5) THEN
C.... xG_N (X)= (N+1)(1-X)**N
         XPQ(0) = FLOAT(NG+1)*(1.-X)**NG
         XPQ(1) = XPQ(0)/4.
         XPQ(2) = XPQ(0)/4.
         XPQ(-1) = XPQ(1)
         XPQ(-2) = XPQ(2)
c         IF(IWEI.EQ.1) write(6,*) ' RASTFU: <5 NG,NPOM',NG,NPOM
      ELSEIF(NG.EQ.10) THEN
         XPQ(0) = (0.18 + 5.46*X)*(1.-X)
c         IF(IWEI.EQ.1) write(6,*) ' RASTFU: 10 NG,NPOM',NG,NPOM
      ELSEIF(NG.EQ.0) THEN
C.... xG_0 (X)= 6x(1-X)
         XPQ(0) = 6.*(1.-X)*X
         XPQ(1) = XPQ(0)/4.
         XPQ(2) = XPQ(0)/4.
         XPQ(-1) = XPQ(1)
         XPQ(-2) = XPQ(2)
c        write(6,*) ' RASTFU: NG,NPOM',xpq(0)
c         IF(IWEI.EQ.1) write(6,*) ' RASTFU: 10 NG,NPOM',NG,NPOM
      ELSEIF(NG.EQ.11) THEN
         XP = SNGL(PI) * 0.16*x*(1-x)/3.
         DO 20 I=-2,2
   20    XPQ(I) = XP
         XPQ(0) = 0.
         XPQ(-3) = XP/2.
         XPQ(3) = XP/2.
c         IF(IWEI.EQ.1) write(6,*) ' RASTFU: 11 NG,NPOM',NG,NPOM
      ELSEIF(NG.GE.15.AND.NG.LT.20) THEN
c call parametrisation from file acc. to H1 data
         IF(NG.LE.17) THEN
            CALL RES_LS(X,SCALE,XPQ)
         ENDIF
      ELSEIF(NG.EQ.100) THEN
         IF(INIT.EQ.0) WRITE(6,*) ' SIMPLE SCALING FUNCTION USED'
         INIT=1
C...Simple scaling structure functions, valence quarks and gluon only.
C. this applies for protons....
         XPQ(0)=3.*(1.-X)**5
         XPQ(3)=0.125*(1.-X)**7
         XPQ(2)=70./32 *(1.-X)**3 *SQRT(X)
CCCC         XPQ(2)=(1.-X)**3*(1.274+.589*(1.-X)-1.675*(1.-X)**2)
         XPQ(1)=2.*XPQ(2)
         XPQ(-1)=XPQ(3)
         XPQ(-2)=XPQ(3)
         XPQ(-3)=XPQ(3)
c         IF(IWEI.EQ.1) write(6,*) ' RASTFU: 100 NG,NPOM',NG,NPOM
      ELSEIF(NG.EQ.20.OR.NG.EQ.21) THEN
C... xG(x) for pion exchange
         IF(FIRST) THEN
            IF(MSTP(52).LE.10) THEN
               WRITE(6,*) ' pi structure function in RASTFU '
            ELSE
               WRITE(6,*) ' pi structure function in PDFLIB'
            ENDIF
            FIRST = .FALSE.
         ENDIF
c        write(6,*) 'MSTP(52) = ',MSTP(52),KF
C...Call user-supplied structure function.
C...Proton structure function call.
C.. modify to call PDFLIB

         IF(MSTP(52).GE.10) THEN
C...Call PDFLIB structure functions.
            XX=DBLE(X)
            QQ=DBLE(SQRT(MAX(0.,SCALE)))
C if you use PDFLIB version 3.  then uncoment the following 2 lines
C and comment the lines with 'cold pdf'
cold pdf  PARM(1)='MODE'
cold pdf  VAL(1)=MSTP(52)
C if you use PDFLIB 4.   then use the next lines.
CNEW
            PARM(1) = 'NPTYPE'
            VAL(1) = DBLE(MSTP(52)/1000000.)
            PARM(2) = 'NGROUP'
            VAL(2) = DBLE(MOD(MSTP(52),1000000)/1000)
            PARM(3) = 'NSET'
            VAL(3) = DBLE(MOD(MOD(MSTP(52),1000000),1000))
CNEW
c            write(6,*) ' RATSFU : PDFLIB CALL ',NG,NPOM
            NPDF=NPDF+1
            PDFFIRST = .FALSE.
            IF(NPDF.LE.1) PDFFIRST=.TRUE.
c call PDFSET each time, because when DIS with normal p structure function is
c also selected one would get in confusion....
            CALL PDFSET(PARM,VAL)
            CALL STRUCTM(XX,QQ,UPV,DNV,USEA,DSEA,STR,CHM,BOT,TOP,GLU)
            XPQ(0)=SNGL(GLU)
            XPQ(1)=SNGL(DNV+DSEA)
            XPQ(-1)=SNGL(DSEA)
            XPQ(2)=SNGL(UPV+USEA)
            XPQ(-2)=SNGL(USEA)
            XPQ(3)=SNGL(STR)
            XPQ(-3)=SNGL(STR)
            XPQ(4)=SNGL(CHM)
            XPQ(-4)=SNGL(CHM)
            XPQ(5)=SNGL(BOT)
            XPQ(-5)=SNGL(BOT)
            XPQ(6)=SNGL(TOP)
            XPQ(-6)=SNGL(TOP)
c            write(6,*) ' pion pdf ',(xpq(i),i=-3,3)
            IF(NG.EQ.21) THEN
c construct partons in pi0
               DO 30 I=1,6
   30          XPQ(I) = (XPQ(I) + XPQ(-I))/2.
            ENDIF
            GOTO 120
         ENDIF
C end modify to call PDFLIB


c        write(6,*) ' rastfu :',x,SCALE
C copied from pystfu-------------------------------------------------------
C...Pion structure functions from Owens.
C...Allowed variable range: 4 GeV^2 < Q^2 < approx 2000 GeV^2.

C...Determine set, Lambda and s expansion variable.
         NSET=1
c         IF(MSTP(51).EQ.2.OR.MSTP(51).EQ.4.OR.MSTP(51).EQ.13) NSET=2
         IF(NSET.EQ.1) ALAM=0.2
         IF(NSET.EQ.2) ALAM=0.4
c        IF(MSTP(52).LE.0) THEN
c           SD=0.
c        ELSE
         Q2IN=MIN(2E3,MAX(4.,SCALE))
         SD=LOG(LOG(Q2IN/ALAM**2)/LOG(4./ALAM**2))
c         ENDIF
C...Calculate structure functions.
         DO 50 KFL=1,4
            DO 40 IS=1,5
   40       TS(IS)=COW(1,IS,KFL,NSET)+COW(2,IS,KFL,NSET)*SD+ COW(3,IS,
     +      KFL,NSET)*SD**2
            IF(KFL.EQ.1) THEN
               XQ(KFL)=X**TS(1)*(1.-X)**TS(2)/EULBET(TS(1),TS(2)+1.)
            ELSE
               XQ(KFL)=TS(1)*X**TS(2)*(1.-X)**TS(3)*(1.+TS(4)*X+TS(5)*
     +         X**2)
            ENDIF
   50    CONTINUE

C...Put into output arrays.
         XPQ(0)=XQ(2)
         XPQ(1)=XQ(3)/6.
         XPQ(2)=XQ(1)+XQ(3)/6.
         XPQ(3)=XQ(3)/6.
         XPQ(4)=XQ(4)
         XPQ(-1)=XQ(1)+XQ(3)/6.
         XPQ(-2)=XQ(3)/6.
         XPQ(-3)=XQ(3)/6.
         XPQ(-4)=XQ(4)
c         IF(IWEI.EQ.1) write(6,*) ' RASTFU: pi NG,NPOM',NG,NPOM
         IF(NG.EQ.21) THEN
c construct partons in pi0
            DO 60 I=1,6
   60       XPQ(I) = (XPQ(I) + XPQ(-I))/2.
         ENDIF
      ELSEIF(NG.EQ.30) THEN
         IF(FIRST) THEN
            WRITE(6,*) ' RASTFU: Nikolaev Zakharov process selected '
         ENDIF
         FIRST = .FALSE.
         DO 70  I=-6,6
            XPQ(I) = 0.0
   70    CONTINUE
*************************************************************************
*
* author: M.Grothe , 15.12.95
*
* D^2 SIGMA/(DT DXP) (GAMMA*P->XP) ACCORDING TO
* Genovese, Nikolaev, Zakharov, Cern/Th-95/13
*
* input : kinematic variables x_bj, x_pomeron, Q_sqrt, ABS(t)
* output: D^2 SIGMA/(DT DX_pomeron) in mbarn/GeV^2
*         D2S_VL  valence part with light quarks in final state
*         D2S_VS  valence part with strange quarks in final state
*         D2S_VC  valence part with charm quarks in final state
*         D2S_SL  sea part with light quarks in final state
*         D2S_SS  sea part with strange quarks in final state
*         D2S_SC  sea part with charm quarks in final state
*
*
*************************************************************************

         CALL NIKZAK(XPR,XFGKI,SNGL(Q2),ABS(T2GKI),
     +           D2S_VL,D2S_VS,D2S_VC,D2S_SL,D2S_SS,D2S_SC)
         ALPH_EM = SNGL(ALPH)
         IF(IRUNAEM.EQ.1) ALPH_EM = ULALEM(SNGL(Q2))

         F2SIG = SNGL(Q2/(4.D0*PI**2*DBLE(ALPH_EM)))/GEV2NB*1.E6
c sum_u,d e_q**2 = 10/9 for u and d quarks
         XPQ(1) = F2SIG*(D2S_VL+D2S_SL)*9./10.
         XPQ(-1) = XPQ(1)
         XPQ(2) = XPQ(1)
         XPQ(-2) = XPQ(1)
         XPQ(3) = F2SIG*(D2S_VS+D2S_SS)*9./2.
         XPQ(-3) = XPQ(3)
         XPQ(4) = F2SIG*(D2S_VC+D2S_SC)*9./8.
         XPQ(-4) = XPQ(4)
c         write(6,*) 'RASTFU: XPR,XFGKI,T2GKI,Q2',XPR,XFGKI,T2GKI,Q2
c         write(6,*) 'XPQ ',(XPQ(I),I=-4,4)
      ELSEIF(NG.EQ.40) THEN
         IF(FIRST) THEN
            WRITE(6,*) ' RASTFU: M. Wuesthoff model used '
         ENDIF
         FIRST = .FALSE.
         beta = dble(xpr/xfgki)
         x_pom = dble(xfgki)
         T2 = dble(t2gki)
         if(beta.lt.0.0.or.beta.gt.1.) then
            write(6,*) ' RASTFU: beta,x,xpr,xfgki ',beta,x,xpr,xfgki
         endif
         CALL F2DHW(BETA,x_pom,Q2,T2,F2QT,FLQ,XGX)
         DO 80  I=-3,3
            XPQ(I) = sngl(F2QT)*9./6.
   80    CONTINUE
         XPQ(0) = SNGL(XGX)
c         write(6,*) 'rastfu: xpq',xpq
      ELSEIF(NG.EQ.41) THEN
         IF(FIRST) THEN
            WRITE(6,*) ' RASTFU: Bartels, Lotter, Wuesthoff DESY 96-'
     +      //'026 '
         ENDIF
         FIRST = .FALSE.
         beta = dble(xpr/xfgki)
         x_pom = dble(xfgki)
         T2 = dble(t2gki)
         if(beta.lt.0.0.or.beta.gt.1.) then
            write(6,*) ' RASTFU: beta,x,xpr,xfgki ',beta,x,xpr,xfgki
         endif
         CALL F2BLW(BETA,x_pom,Q2,T2,F2QT,FLQ)
         DO 90  I=-3,3
c divide by 2 because of quark and antiquark include in calc but explicitely her
            XPQ(I) = sngl(F2QT)*9./6./2.
   90    CONTINUE
         XPQ(0) = 0.0
c         write(6,*) 'rastfu: xpq',xpq
      ELSEIF(NG.EQ.42) THEN
         IF(FIRST) THEN
            WRITE(6,*) ' RASTFU: M. Diehl calc. used '
         ENDIF
         FIRST = .FALSE.
         beta = dble(xpr/xfgki)
         x_pom = dble(xfgki)
         T2 = dble(t2gki)
         if(beta.lt.0.0.or.beta.gt.1.) then
            write(6,*) ' RASTFU: beta,x,xpr,xfgki ',beta,x,xpr,xfgki
         endif
         CALL F2MD(BETA,x_pom,Q2,T2,XDX,FLQ)
         DO 100 I=-4,4
            XPQ(I) = sngl(XDX(I))
  100    CONTINUE
         XPQ(0) = 0.0
c         write(6,*) 'rastfu: xpq',xpq
      ELSEIF(NG.EQ.45) THEN
         IF(FIRST) THEN
            WRITE(6,*) ' RASTFU: Buchmueller/McDermott/Hebecker
     +        calc. used '
         ENDIF
         FIRST = .FALSE.
         beta = dble(xpr/xfgki)
         x_pom = dble(xfgki)
         T2 = dble(t2gki)
         if(beta.lt.0.0.or.beta.gt.1.) then
            write(6,*) ' RASTFU: beta,x,xpr,xfgki ',beta,x,xpr,xfgki
         endif
         CALL F2MCD(BETA,x_pom,Q2,T2,XDX,FLQ)
         DO 110 I=-4,4
            XPQ(I) = sngl(XDX(I))
  110    CONTINUE
c         write(6,*) 'rastfu: xpq',xpq
      ELSE
         WRITE(6,*) ' requested parton distribution not implemented'
         WRITE(6,*) ' NG = ',NG,' NPOM = ',NPOM
      ENDIF
  120 CONTINUE
      DO 130 I=-6,6
         IF(XPQ(I).LT.0.0) XPQ(I) = 0.0
  130 CONTINUE
      IF(IHF.EQ.1) THEN
         DO 140 I=1,6
            KPHF = 4
            IF(I.EQ.KPHF) GOTO 140
            XPQ(I) = 0.0
            XPQ(-I) = 0.0
  140    CONTINUE
      ENDIF
      RETURN
      END
      SUBROUTINE RES_LS(X,Q2,XPQ)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      REAL XPQ(-6:6),X,Q2
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.
      DIMENSION XX(0:100),Q2X(0:100),XPD(0:100,0:100,-6:6)
      LOGICAL FIRST
      DATA FIRST/.TRUE./
      DATA NPR/0/
      IF(FIRST) THEN
         IF(NG.EQ.15) THEN
*         open(30,FILE='diff_tabnew.param.txt', FORM='formatted',STATUS=
            open(30,FILE='diff_tabnew.param.txt.sht', FORM='formatted',
     +      STATUS= 'OLD',IOSTAT=IRR,ERR=60 )
            write(6,*) ' read partons from file: diff_tabnew.param.txt'
         ELSEIF(NG.EQ.16) THEN
            open(30,FILE='h1flat.qg.dat', FORM='unformatted',STATUS=
     +      'OLD',IOSTAT=IRR,ERR=60 )
            write(6,*) ' read partons from file: h1flat.qg.dat'
         ELSEIF(NG.EQ.17) THEN
            open(30,FILE='h1flat.q.dat', FORM='unformatted',STATUS=
     +      'OLD',IOSTAT=IRR,ERR=60 )
            write(6,*) ' read partons from file: h1flat.q.dat'
         ELSE
            write(6,*) ' requested parton distribution not available'
            write(6,*) ' PROGRAM STOP !!!!!!!!!!!!!!!!!!!!!'
            STOP
         ENDIF
         READ(30,'(A)') Line
*         READ(30) XMIN,XMAX,Q2MIN,Q2MAX,NX,NQ

*         write(6,*) 'XMIN,XMAX,Q2MIN,Q2MAX,NX,NQ',
*     +    XMIN,XMAX,Q2MIN,Q2MAX,NX,NQ
         NX=100
cold     NQ=30
ctabnew     NQ=80
         NQ = 50
c xnorm comes from my norm of streng flux =58.4/16/pi=1.169
         xnorm = 1.D0/1.169D0
         DO 20 J=1,NQ
            DO 10 I=0,NX-1
cold               READ(30,*) XX(I),Q2X(J),XGLU,XPART
               READ(30,*) XX(I),Q2X(J),XPART,XGLU,xcharm
c  c.s.f is F_2_charm...
c         write(6,*) ' XX,Q2X,xGlu,xpart',xx(i),q2x(j),xglu,xpart
               do k=-3,3
                  XPD(I,J,K) = xpart/6.D0*xnorm
                  if(k.eq.0) XPD(I,J,K) = xglu*xnorm
               enddo
               XPD(I,J,-4) = xcharm*xnorm/2.D0/9.D0/4.D0
               XPD(I,J,4) = XPD(I,J,-4)
c         write(6,*) ' XX,Q2X,XPD',I,J,
c     &   XX(I),Q2X(I),(XPD(I,J,K),K=-6,6)
   10       CONTINUE
            XX(100)=1.D0
            do k=-6,6
               XPD(I,J,K) = 0.D0
            enddo
   20    Continue

c         write(6,*) (xx(i),i=0,nx)
c         write(6,*) (q2x(i),i=1,nq)
c         do 22 i=0,nx
c         do 22 j=1,nq
c  22     write(6,*) (xpd(i,j,k),k=-6,6)
         FIRST=.FALSE.
         write(6,*) ' laurent pomeron pdf read from file unit 30 '
      ENDIF


      XPRT = DBLE(X)
      Q2T= DBLE(Q2)
      IF(Q2T.LT.Q2X(1)) Q2T=Q2X(1)
      IF(XPRT.LT.XX(0).OR.XPRT.GT.XX(NX) .OR.Q2T.LT.Q2X(1) .OR.Q2T
     +.GT.Q2X(NQ)) THEN
         IF(npr.lt.5) THEN
            WRITE(6,*) 'RES : X or Q2 values outside grid '
            WRITE(6,*) ' X_min ',XX(0),' X_max ',XX(NX), ' actual '
     +      //'X ', XPRT
            WRITE(6,*) ' Q2_min ',Q2X(1),' Q2_max ',Q2X(NQ), ' ' //
     +      'actual Q2 ',Q2T
         ENDIF
         IF(XPRT.LT.XX(0)) XPRT=XX(0)
         IF(XPRT.GT.XX(NX)) XPRT=XX(NX)
         IF(Q2T.LT.Q2X(1)) Q2T = Q2X(1)
         IF(Q2T.GT.Q2X(NQ)) Q2T = Q2X(NQ)
         npr = npr + 1
      ENDIF
      IX = -1
   30 IX = IX + 1
      IF(IX.GT.NX-1) write(6,*) IX,XPRT
      IF(XPRT.GT.XX(IX+1)) GOTO 30
      IQ =  0
   40 IQ = IQ + 1
      IF(IQ.GT.NQ-1) write(6,*) IQ,Q2T
      IF(Q2T.GT.Q2X(IQ+1)) GOTO 40
      DO 50 IP=-6,6
         XPQ(IP)=0.0
         XD = (XPRT - XX(IX))/(XX(IX+1)-XX(IX))
         QD = (Q2T - Q2X(IQ))/(Q2X(IQ+1) - Q2X(IQ))
         X1P=(XPD(IX+1,IQ,IP)-XPD(IX,IQ,IP))*XD +XPD(IX,
     +   IQ,IP)
         X2P=(XPD(IX+1,IQ+1,IP)-XPD(IX,IQ+1,IP))*XD + XPD(
     +   IX,IQ+1,IP)
         XPQ(IP) = SNGL((X2P-X1P)*QD + X1P)
c         write(6,*) x2p,x1p,qd
   50 CONTINUE
c         write(6,*) 'x,q2,xpq',x,q2,(xpq(i),i=-3,3)
      return
   60 write(6,*) ' error in opening file '
      stop
      END
      SUBROUTINE RES(X,Q2,XPQ)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      REAL XPQ(-6:6),X,Q2
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.
      DIMENSION XX(0:100),Q2X(0:100),XPD(0:100,0:100,-6:6)
      LOGICAL FIRST
      DATA FIRST/.TRUE./
      DATA NPR/0/
      IF(FIRST) THEN
         IF(NG.EQ.15) THEN
            open(30,FILE='h1sing.qg.dat', FORM='unformatted',STATUS=
     +      'OLD',IOSTAT=IRR,ERR=50 )
            write(6,*) ' read partons from file: h1sing.qg.dat'
         ELSEIF(NG.EQ.16) THEN
            open(30,FILE='h1flat.qg.dat', FORM='unformatted',STATUS=
     +      'OLD',IOSTAT=IRR,ERR=50 )
            write(6,*) ' read partons from file: h1flat.qg.dat'
         ELSEIF(NG.EQ.17) THEN
            open(30,FILE='h1flat.q.dat', FORM='unformatted',STATUS=
     +      'OLD',IOSTAT=IRR,ERR=50 )
            write(6,*) ' read partons from file: h1flat.q.dat'
         ELSE
            write(6,*) ' requested parton distribution not available'
            write(6,*) ' PROGRAM STOP !!!!!!!!!!!!!!!!!!!!!'
            STOP
         ENDIF
         READ(30) XMIN,XMAX,Q2MIN,Q2MAX,NX,NQ
         write(6,*) 'XMIN,XMAX,Q2MIN,Q2MAX,NX,NQ',
     +    XMIN,XMAX,Q2MIN,Q2MAX,NX,NQ
         DO 10 J=1,NQ
            DO 10 I=0,NX
               READ(30) XX(I),Q2X(J),(XPD(I,J,K),K=-6,6)
c         write(6,*) ' XX,Q2X,XPD',I,J,
c     &   XX(I),Q2X(I),(XPD(I,J,K),K=-6,6)
   10    CONTINUE
c         write(6,*) (xx(i),i=0,nx)
c         write(6,*) (q2x(i),i=1,nq)
c         do 22 i=0,nx
c         do 22 j=1,nq
c  22     write(6,*) (xpd(i,j,k),k=-6,6)
         FIRST=.FALSE.
         write(6,*) ' pomeron parton densities read from file unit 30 '
      ENDIF


      XPRT = DBLE(X)
      Q2T= DBLE(Q2)
      if(dble(q2).lt.Q2x(1).and.npr.lt.5) then
         write(6,*) 'RES :  Q2 values outside grid '
         WRITE(6,*) ' Q2_min ',Q2X(1),' Q2_max ',Q2X(NQ), ' ' //
     +   'actual Q2 ',Q2T
         write(6,*) ' take parton densities at Q2_min = ',Q2X(1)
c         write(6,*) ' this might be ok '
c         write(6,*) ' since there is a low Q**2 supression in PYSTFU'
         npr = npr + 1
      endif
      IF(Q2T.LT.Q2X(1)) Q2T=Q2X(1)
      IF(XPRT.LT.XX(0).OR.XPRT.GT.XX(NX) .OR.Q2T.LT.Q2X(1) .OR.Q2T
     +.GT.Q2X(NQ)) THEN
         WRITE(6,*) 'RES : X or Q2 values outside grid '
         WRITE(6,*) ' X_min ',XX(0),' X_max ',XX(NX), ' actual '
     +   //'X ', XPRT
         WRITE(6,*) ' Q2_min ',Q2X(1),' Q2_max ',Q2X(NQ), ' ' //
     +   'actual Q2 ',Q2T
         IF(XPRT.LT.XX(0)) XPRT=XX(0)
         IF(XPRT.GT.XX(NX)) XPRT=XX(NX)
         IF(Q2T.LT.Q2X(0)) Q2T = Q2X(1)
         IF(Q2T.GT.Q2X(NQ)) Q2T = Q2X(NQ)
      ENDIF
      IX = -1
   20 IX = IX + 1
      IF(XPRT.GT.XX(IX+1)) GOTO 20
      IQ =  0
   30 IQ = IQ + 1
      IF(Q2T.GT.Q2X(IQ+1)) GOTO 30
      DO 40 IP=-6,6
         XPQ(IP)=0.0
         XD = (XPRT - XX(IX))/(XX(IX+1)-XX(IX))
         QD = (Q2T - Q2X(IQ))/(Q2X(IQ+1) - Q2X(IQ))
         X1P=(XPD(IX+1,IQ,IP)-XPD(IX,IQ,IP))*XD +XPD(IX,
     +   IQ,IP)
         X2P=(XPD(IX+1,IQ+1,IP)-XPD(IX,IQ+1,IP))*XD + XPD(
     +   IX,IQ+1,IP)
         XPQ(IP) = SNGL((X2P-X1P)*QD + X1P)
c         write(6,*) x2p,x1p,qd
   40 CONTINUE
c         write(6,*) 'x,q2,xpq',x,q2,(xpq(i),i=-3,3)
      return
   50 write(6,*) ' error in opening file '
      stop
      END
*CMZ :  2.08/05 10/03/2000  12.02.57  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  09.07.52  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  10.08.10  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE RAT2DI(KF,XR,T2,WTDIST)
	Implicit None
c give t distribution in proton
C KF = 100 for pomeron
C KF = 211 for pi
C XR = fractional energy of pomeron
C XP2 = fractional energy of parton to hard interaction
C T2 = t = (p - p')**2 < 0
C WTDIST = weight of distribution
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEND.
      INTEGER KF
      DOUBLE PRECISION T2,XR,WTDIST,DELTA2,MP,XE,BETA02,WMOPOL,WDIPOL
      DOUBLE PRECISION WEXPOL,WEXTHO,WEXPHO
      DOUBLE PRECISION GPPPI,mpi,ALAMD,RNHOL
      LOGICAL FIRST
      DATA DELTA2/3.26D0/,MP/0.938D0/,FIRST/.TRUE./
      DATA GPPPI/13.5/,mpi/0.139/,ALAMD/0.039D0/,RNHOL/0.93/
      DATA beta02/58.74D0/
      WTDIST = 0.D0
c        write(6,*) ' RAT2DI : NG,NPOM,KF,IPRO',NG,NPOM,KF,IPRO
c      IF(IWEI.EQ.1) THEN
c        write(6,*) ' RAT2DI : NG,NPOM,KF,IPRO',NG,NPOM,KF,IPRO
c        ENDIF
      IF(NPOM.EQ.0) THEN
         IF(FIRST) THEN
            write(6,*) ' streng pomeron is used'
            FIRST = .FALSE.
         ENDIF
c pomeron distribution from streng (hera proc. 1987)
         XE=RN2*DABS(T2)
         IF(XE.GT.170.D0) THEN
C                      WRITE(6,*) 'XE..',XE,DEXP(-XE)
            GOTO 10
         ENDIF
         WTDIST = DEXP(-XE)
         IF(WTDIST.LT.1.D-50) GOTO 10
         WTDIST = WTDIST*(XR**(1.D0-2.D0*(1.D0 + EPSP + ALPHP*T2)))
         WTDIST = WTDIST*beta02/16.D0/PI
c         write(6,*) 'rat2di : NPOM=',NPOM
c          write(6,*) 'rat2di: ',epsp,alphp,t2,rn2
      ELSEIF(NPOM.EQ.1) THEN
         IF(FIRST) THEN
            write(6,*) ' Ingelman pomeron is used'
            FIRST = .FALSE.
         ENDIF
c test with Ingelman f_pom distribution
         WTDIST =(6.38D0*DEXP(8.D0*T2) + 0.424D0*DEXP(3.D0*T2))/XR/2.3D0
c         write(6,*) 'rat2di : NPOM=',NPOM
c end Ingelman
      ELSEIF(NPOM.EQ.2) THEN
         IF(FIRST) THEN
            write(6,*) ' Donnachie Landshoff pomeron is used'
            FIRST = .FALSE.
         ENDIF
c test with Donnachie Landshoff f_pom distribution
         WTDIST = 9.D0*DELTA2/4.D0/PI**2
         WTDIST = WTDIST*(4.D0*MP**2 - 2.8D0*T2)/(4.D0*MP**2 - T2)
         WTDIST = WTDIST/(1.D0 - T2/0.7D0)
         WTDIST = WTDIST*(XR**(1.D0-2.D0*(1.D0 + EPSP + ALPHP*T2)))
c         write(6,*) 'rat2di : NPOM=',NPOM
      ELSEIF(NPOM.EQ.20.OR.NPOM.EQ.21) THEN
         IF(FIRST) THEN
            WRITE(6,*) ' pi exchange is used '
            FIRST = .FALSE.
         ENDIF
changed according to B.List/Holtmann
         WTDIST = -2.D0*GPPPI**2 *XR/16.D0/PI**2 *T2/(T2 - mpi**2)**2
c different choices for pion t dependence a la Frankfurt Mankiewiecz Strikman
c  Z.Phys. A 334 (1989) 343
c dipole form factor
         WDIPOL = (1.D0 - mpi**2/0.9D0/0.9D0)**2
     +   /(1.D0 -T2/0.9D0/0.9D0)**2
         WDIPOL = WDIPOL **2
c monopol form factor
         WMOPOL = (1.D0 - mpi**2/0.5D0/0.5D0)/(1.D0 -T2/0.5D0/0.5D0)
         WMOPOL = WMOPOL **2
c exp. form factor
         WEXPOL = dexp(1.8D0 * mpi**2) * dexp(1.8D0 *T2)
         WEXPOL = WEXPOL **2
c exp form factor from Thomas Phys. Lett. B 126 (1983) 97
         WEXTHO =  DABS(DEXP(-2.D0*ALAMD *(-T2 + mpi**2)/mpi**2))
c exp form factor  from Holtmann et al. Phys. Lett. B338 (1994) 363
         WEXPHO = DEXP(RNHOL**2*(T2-mpi**2)/XR)
c	   write(6,*) ' rat2di ',wtdist,wexpho,xr,t2,rnhol,mpi
c.....................................................................
         WTDIST = WTDIST * WEXPHO
c         write(6,*) 'rat2di : NPOM=',NPOM
         IF(NPOM.EQ.21) THEN
c construct t distribution for pi0 exchange
            WTDIST = WTDIST/2.D0
         ENDIF
      ELSEIF(NPOM.EQ.30) THEN
         IF(FIRST) THEN
            write(6,*) ' RAT2DI: Nikolaev Zakharov process selected'
            FIRST = .FALSE.
         ENDIF
         WTDIST = 1.0D0
      ELSEIF(NPOM.EQ.40) THEN
         IF(FIRST) THEN
            write(6,*) ' RAT2DI: M. Wuesthoff model used'
            FIRST = .FALSE.
         ENDIF
         WTDIST = 1.0D0
      ELSEIF(NPOM.EQ.41) THEN
         IF(FIRST) THEN
            write(6,*) ' RAT2DI: Bartels Lotter Wuesthoff calc. used'
            FIRST = .FALSE.
         ENDIF
         WTDIST = 1.0D0
      ELSEIF(NPOM.EQ.42) THEN
         IF(FIRST) THEN
            write(6,*) ' RAT2DI: M. Diehl calc. used'
            FIRST = .FALSE.
         ENDIF
         WTDIST = 1.0D0
      ELSEIF(NPOM.EQ.45) THEN
         IF(FIRST) THEN
            WRITE(6,*) ' RASTFU: Buchmueller/McDermott/Hebecker
     &        calc. used '
            FIRST = .FALSE.
         ENDIF
         WTDIST = 1.0D0
      ELSEIF(NPOM.LT.0) THEN
c user supplied pomeron distribution
         WTDIST = 1.D0
c         write(6,*) 'rat2di : NPOM=',NPOM
      ELSE
         write(6,*) ' RAT2DI: pomeron distribution ',NPOM,
     +              ' not implemented'
         write(6,*) ' RAT2DI: program stops '
         stop
      ENDIF
c	write(6,*) ' RAT2DI: ',xr,t2,wtdist
      RETURN
   10 WTDIST = 0.D0
      RETURN
      END
*CMZ :  2.08/04 26/01/2000  15.07.40  by  Hannes Jung
*CMZ :  2.08/03 07/12/99  18.22.41  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  10.08.43  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      PROGRAM RGMAIN
	Implicit None
*KEEP,RGFULL.
      INTEGER IFULL,IQCDGRID
      COMMON /OALPINI/ IFULL,IQCDGRID
*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
C---initialise JETSET 7.3 parameters
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGSCQ2.
      DOUBLE PRECISION SCALQ2
	Integer ISET,IP2
      COMMON/RESGAM/ISET,IP2,SCALQ2
*KEEP,RGLQ2.
      DOUBLE PRECISION Q2SUPP
      COMMON/LOWQ2S/Q2SUPP
*KEND.
      Integer IVM
      COMMON/VMESON/IVM
      REAL PYPAR,PYVAR
      INTEGER IPY
      COMMON /PYPARA/ IPY(80),PYPAR(80),PYVAR(80)
      Integer ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      COMMON /COLCON/ ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
C SEQUENCES FOR HERACLES.
      Double Precision THEMIN,CTHMIN,CTHCON
      COMMON /HSTCUT/ THEMIN,CTHMIN,CTHCON
*KEEP,RGHSUNTS.
      Integer LUNTES,LUNDAT,LUNIN,LUNOUT,LUNRND
      COMMON /HSUNTS/ LUNTES,LUNDAT,LUNIN,LUNOUT,LUNRND
*KEEP,RGHSOPTN.
      Integer INT2,INT3,ISAM2,ISAM3,IOPLOT,IPRINT,ICUT
      COMMON /HSOPTN/ INT2(5),INT3(15),ISAM2(5),ISAM3(15),
     +                IOPLOT,IPRINT,ICUT

*KEEP,RGHSCUTS.
      DOUBLE PRECISION XMIN,XMAX,Q2MIN,Q2MAX,YMIN,YMAX,WMIN,GMIN
      COMMON /HSCUTS/ XMIN,XMAX,Q2MIN,Q2MAX,YMIN,YMAX,WMIN,GMIN


*KEEP,RGHSVGLP.
      Integer         NPOVEG,NUMINT,NPHYP
      COMMON /HSVGLP/ NPOVEG,NUMINT,NPHYP

*KEND.
      Integer LPAR,LPARIN,IPART
      COMMON /HSPARL/ LPAR(20),LPARIN(12),IPART
      REAL*4 PAR111,PAR112,PARL11,PARL19
      INTEGER MST111,MST115
	COMMON /HSALFS/ PAR111,PAR112,PARL11,PARL19,MST111,MST115
C-MH weighting COMMONs:

      Integer I,ISEED
C---initialise JETSET 7.3 parameters
      CALL GARINI
      CALL GJEINI
C     initialize random number generator
      ISEED = 213123
      CALL H1RNIN(ISEED)
C---initialise RAPGAP parameters
      CALL GRAINI
C-- change standard parameters
C**********************************************************************
C     1ST INCOMING PARTICLE  (KE=11 ELECTRON)
C     1ST INCOMING PARTICLE  (KE=22 PHOTON)
      KE =  -11
c      KE =  22
C     LEPTON MOMENTIM (D=-30)
      PLEPIN = -27.5
C**********************************************************************
C     2ND INCOMING PARTICLE (KP = 2212 PROTON)
      KP = 2212
C     proton momentum (D=820)
      PPIN   = 820.
C**********************************************************************
C     PARTON SHOWER OFF/ON (D=10)
C     (off = 0, =1 initial state, =2 final state, =3 inital + final state
C       = 10 ariadne)

      IFPS   = 1
C**********************************************************************
C     fragmentation on/off (D=1)
C     NFRAG=1         (D=1) FRAGMENATION
C         =10 FRAGMENATION+ p dissocia
      NFRAG  = 0
C     IREM=1   p dissociation treatment
C              (D=1): P(beta') = 2(1-beta')
C         =2        :          = (a+1)(1-beta')**a
      IREM = 1
C**********************************************************************
C     fixed/running alpha_s (D=1)
      IRUNA  = 1
C     alphas parameters
C     nr of flavours wrt lambda_QCD
C     MSTU(112) = 5
C     lambda QCD
C     PARU(112) = 0.25
C     lambda QCD for MRSR2
C     PARU(112) = 0.239
C     min nr of flavours for alphas
      MSTU(113) = 3
C     max nr of flavours for alphas
      MSTU(114) = 5
C**********************************************************************
C      scale for alpha_s
C      1:  q2 = m**2
C      2:  q2 = shat
C      3:  q2 = m**2 + pt**2
C      4:  q2 = Q2
C      5:  q2 = Q2 + pt**2
      IQ2    = 2
C**********************************************************************
C      scale factor q2 = SCALFA * q2
      SCALFA = 1.D0
C**********************************************************************
C     select process to be generated
c      WRITE(6,*) ' select process IPRO and IFULL,IDIR '
c      READ(5,*) IPRO,IFULL,IDIR
c      WRITE(6,*) ' IPRO = ',IPRO,' and event mixing IFULL = ',IFULL
c      write(6,*) ' IDIR = ',IDIR,' selected '
      IDIR = 1
      IPRO = 12
      IFULL = 0
C**********************************************************************
C  Processes gamma gluon fusion using EPA and gamma glu Martix Element
C    10: gamma pommeron_gluon --> q qbar (light quarks:u,d,s)
C    11:  gamma pommeron_gluon --> Q Qbar (charm quarks)
C
C**********************************************************************
C  Process e q --> e' q'
C    12:  e q --> e' q'
C    1200:  e q --> e' q' using HERACLES
C**********************************************************************
C  Processes gamma gluon fusion using full e glu Matrix Element
C    13:  e gluon --> e' q qbar (light quarks:u,d,s)
C    14:  e gluon --> e' Q Qbar (charm quarks)
C    1400:  e gluon --> e' Q Qbar (charm quarks) using HERACLES
C    18:  resolved gamma processes
C     Matrix elements for resolved photon processes
C     gg --> qq_bar
      IRPA = 1
C     g + g --> g + g
      IRPB = 1
C     g + q --> g + q
      IRPC = 1
C     qq_bar --> gg
      IRPD = 1
C     q + q_bar --> q + q_bar
      IRPE = 1
C     qq --> qq
      IRPF = 1
c Parameters for SaS (Schuler Sjostrand) virtual photon structure function
      ISET = 3
      IP2 = 0
C**********************************************************************
C  Process gamma* pomeron --> rho pomeron
C   100: e pomeron --> e' rho pomeron
C
C**********************************************************************
C    parameters for pomeron distribution
C     gluon density in pomeron (D=0)
C     (D=0) gluon density in pomeron
C     <0 user supplied via SUBROUTINE USDIFFR
C     20 = pi+- exchange
C     21 = pi0 exchange
C     30 = Nikolaev Zakharov model
C     40 = hard pomeron M.Wuestoff
C     41 = hard pomeron  Bartels,Lotter,Wuesthoff
C     42 = 2 - glu pomeron(soft)  M.Diehl
C     45 = Buchmueller/McDermott/Hebecker

      NG   =  0
C     if MSTP(52) < 10 use inbuild structure functionsof PYTHIAfor pi
C if PDFLIB is used MSTP(51) gives
C     10^6*NPTYPE+1000*NGROUP+NSET    is used as coding scheme
C example 2001001 for NPTYPE 2 Ngroup 1 Nset 1
C      MSTP(52) = 2001001
C proton structure function
      MSTP(51) = 9
C
C
C     Q2SUPP=3.37  exponential supression factor for small Q2
C               in parton densities for HERACLES
C               =5 for Q2 > 1
C               =10 for Q2 >0.5
      Q2SUPP = 3.37

C
C     NFLAV=5 nr of flavours used in str.fct.
      NFLAV = 4
C
c photon structure function
c MSTP(56) = 1 GRS parametristaion
c          = 2 SaSgam (Schuler-Sjostrand)
c          > 1000 PDFLIB with Drees Godbole virtual gamma suppression
      MSTP(56) = 1
C
C     SCALQ2=1. scale/Q2 for resolved gamma in DIS
      SCALQ2 = 1.0
C
C select pomeron distribution
C    (D=0) pomeron density
C  =0 streng density ,
C  =1 Ingelman density,
C  =2 Donnachie Landshoff density,
C  =20 pion exchange
C  =30 Nikolaev Zakharov model
C  =40 hard pomeron M.Wuestoff
C  =41 hard pomeron  Bartels,Lotter,Wuesthoff
C  =42 2 - glu pomeron(soft)  M.Diehl
C  =45 Buchmueller/McDermott/Hebecker
C  <0 user supplied via SUBROUTINE USDIFFR
      NPOM = 0
C epsilon for rising of x Section in Streng and DL pomeron distribution
      EPSP = 0.085
      RN2  = 4.0
      ALPHP = 0.25
C cut of x_f
      XF  = 0.9
c Maximum -t allowed in generation
      T2MAX = 1.
C
C     IALMKT=0   ( no primordial kt for partons in diffraction)
C           =1 ( primordial kt for partons for IPRO=12
C                 acc. aligned jet model)
      IALMKT=0
C
c select Vector meson production
c IVM = 1 light VM
C IVM = 443 J/psi
C IVM = 553 Upsilon
C IVM = 0 no special selection
      IVM = 0
C Minimum Q^2 of electron to be generated
      QMI = 5.0d0
C Minimum y of electron to be generated
      YMI=0.04d0
C pt^2_hat cut for light quark Matrix Elements
      PT2CUT(10)=4.
      PT2CUT(13)=4.
      PT2CUT(15)=4.
      PT2CUT(18)=4.
C Maximium theta angle of scattered electron
      THEMA = 180.0D0
C Minimium theta angle of scattered electron
      THEMI =   0.0D0
c select heavy flavour code for IPRO=14,1400
c      IHFLA=5
*                                        1=cuts in x and lower Q2
*                                        2=cuts in x, lower Q2, W
*                                        3=cuts in x, y, Q2, W
*                                        must be 3 for the use of THMI!
*! (D=3) definition of cuts applied
      ICUT=3
*! (D=1) upper cut in x
      XMAX=1.0
*! (D=1E-4) lower cut in x
      XMIN=0.00001
*! (D=0) integration of the non-
      INT2(1) = 1
*                                        radiative contribution (NC)
*                                        0=off, 1=on
*! (D=0) integration of the non-
      INT2(2) = 0
*                                        radiative contribution (CC)
*                                        0=off, 1=on
*! (D=0) integration of initial
      INT3(2) = 0
*                                        state bremsstr. contr. NC
*                                        number of iterations for VEGAS
*                                        <100:VEGAS, >100:VEGAS1/2
*! (D=0) as INT3(1) but for final
      INT3(1) = 0
*                                        state bremsstr. NC
*! (D=0) as INT3(1) but for Compton
      INT3(2) = 0
*                                        contribution NC
*! (D=0) integration of initial
      INT3(3) = 0
*                                        state bremsstr. contr. CC
*                                        number of iterations for VEGAS
*                                        <100:VEGAS, >100:VEGAS1/2
*! (D=1000) number of integration
      NPOVEG=50000
*                                        points used for VEGAS
*! (D=1) only Born x-section term
      LPARIN(2) = 0
*                                        or 1=including corrections
*! (D=0) sampling of the non-
      ISAM2(1) = 1
*                                        radiative contribution (NC)
*                                        0=off, 1=on
*      ISAM2(2) = 0                  ! (D=0) sampling of the non-
*                                        radiative contribution (CC)
*                                        0=off, 1=on
*! (D=0) sampling of initial
      ISAM3(1) = 0
*                                        state bremsstrahlung  NC
*! (D=0) sampling of final
      ISAM3(2) = 0
*                                        state bremsstr. NC
*! (D=0) sampling of Compton
      ISAM3(3) = 0
*                                        contribution NC
*      ISAM3(7) = 0                   ! (D=0) sampling of initial
*                                        state bremsstrahlung  CC

C**********************************************************************
C Initialize ARIADNE
      CALL ARINIT('RAPGAP')
C--- CALCULATE X SECTION
      CALL RAPGAP
C--- print x section
      CALL RAEND(1)
C--- event generation
      DO 10 I=1,50000
         CALL EVENT
C--- user analysis routine
         CALL ANALYS
C---
   10 CONTINUE
C---PRINT NR OF GENERATED EVENTS
      CALL RAEND(20)
      STOP
      END
*CMZ :  2.08/02 14/07/99  18.39.55  by  Hannes Jung
*CMZ :  2.08/00 06/06/99  17.16.57  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  16.49.51  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94

      SUBROUTINE RYSTFU(KF,XI,Q2I,XPQ)
      Implicit None
      Integer KF
      Real XI,Q2I

C...Gives electron, photon, pi+, neutron and proton parton structure
C...functions according to a few different parametrizations. Note
C...that what is coded is x times the probability distribution,
C...i.e. xq(x,Q2) etc.
C...MODIFIED FOR USE IN HERACLES 4.2 (BY H.SPIESBERGER, 8.2.93)
      Real PYSTOP,PYSLAM
      Integer NPYMOD,NPYMAX,NPYMIN
      COMMON /PYSTFUC/ PYSTOP,PYSLAM,NPYMOD,NPYMAX,NPYMIN
C Input:
C   PYSTOP = top mass
C   NPYMAX = maximal flavour
C   NPYMIN = minimal flavour
C   NPYMOD = Choice of parametrization
      Integer LUNTES,LUNDAT,LUNIN,LUNOUT,LUNRND
      COMMON /HSUNTS/ LUNTES,LUNDAT,LUNIN,LUNOUT,LUNRND
      Integer LPAR,LPARIN,IPART
      COMMON /HSPARL/ LPAR(20),LPARIN(12),IPART
*KEEP,RGRAHER.
      REAL XPQDIF,XPQPI
	Integer IHERPYS
	Integer NBQ2,NBX
      PARAMETER (NBQ2=20)
      PARAMETER (NBX=20)
      COMMON /RAHER/ IHERPYS,XPQDIF(-6:6,NBX,NBQ2),XPQPI(-6:6,NBX,NBQ2)
*KEEP,RGRGRIDF2.
      DOUBLE PRECISION XX,Q2X
      COMMON /RGRIDF2/ XX(NBX),Q2X(NBQ2)
      REAL F2_DIS,F2_DIF,F2_PI
      COMMON /F2VAL/ F2_DIS(NBX,NBQ2),F2_DIF(NBX,NBQ2),F2_PI(NBX,NBQ2)
cNEW
      DOUBLE PRECISION F2DIS,F2DIF,F2PI
      COMMON /F2INT/ F2DIS,F2DIF,F2PI
cNEW
*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEEP,RGLUDAT2.
      REAL PMAS,PARF,VCKM
      INTEGER KCHG
      COMMON/LUDAT2/KCHG(500,3),PMAS(500,4),PARF(2000),VCKM(4,4)
C      SAVE

*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEND.
      Real XPQ,XQ,TX,TT,TS,CEHLQ,CDO,COW,CMT,EXMT,ALAM,XPQQ,SCALE
      Integer NEHLQ,NF,KPART
      DIMENSION XPQ(-6:6)
      DIMENSION XQ(9)
      DIMENSION TX(6),TT(6),TS(6),NEHLQ(8,2),
     +CEHLQ(6,6,2,8,2),CDO(3,6,5,2),COW(3,5,4,2),CMT(0:3,0:2,9,4),
     +EXMT(0:3)
      COMMON/ALPHA/NF,ALAM

      DIMENSION XPQQ(-24:24)
      COMMON /PINT/ SCALE,KPART
      DOUBLE PRECISION XXX,QQ,UPV,DNV,USEA,DSEA,STR,CHM,BOT,TOP,GLU,
     +VAL(20)
      DOUBLE PRECISION XP2,XMAX,XPRT
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      DOUBLE PRECISION Q2START,W_Q2,OMEG2
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      Real FUNX,FLOW,FUP,FXT2,ULALEM,PYGAMM
      EXTERNAL FUNX,FLOW,FUP,FXT2
      EXTERNAL ULALEM,PYGAMM
      LOGICAL PDFFIRST
      COMMON /W50516/PDFFIRST
      CHARACTER*20 PARM(20)
      Integer NPDF,IP,IS,I,IT,NX,IEX,IPN,IFL,IQ,IX,KFA,mst51
      Integer ITER,NSTP,NFE,KFL,ISTP,NSET
      Real VX,EULBET,X,Y,slo,shi,q2,q2t,xd,qd,X1P,X2P,EPS,SUM
      Real aem,PME,xl,x1l,HLE,HBE,HDE,HEE,HCB,HCA,AEMP,HLG
      Real HLW,T,SXPGL,SXPQU,SXPQD,SUMXP,WTSTP,Q2IN,SD,TMIN,TMAX,VT
      Real XQSUM,CXS,EXMTS,XC,XLL,SD2,XPS
      Real XE,XLE,XG,SUMXPP,FCONV,XPGA,XPGL,XPQU,XPQD
      DATA NPDF/0/,UPV,DNV,DSEA,STR,CHM,BOT,TOP,GLU/8*0.D0/
      DATA VX/0.0/
c.hju
C...The following data lines are coefficients needed in the
C...Owens pion structure function parametrizations, see below.
C...Expansion coefficients for up and down valence quark distributions.
      DATA ((COW(IP,IS,1,1),IS=1,5),IP=1,3)/
     +  4.0000E-01,  7.0000E-01,  0.0000E+00,  0.0000E+00,  0.0000E+00,
     + -6.2120E-02,  6.4780E-01,  0.0000E+00,  0.0000E+00,  0.0000E+00,
     + -7.1090E-03,  1.3350E-02,  0.0000E+00,  0.0000E+00,  0.0000E+00/
      DATA ((COW(IP,IS,1,2),IS=1,5),IP=1,3)/
     +  4.0000E-01,  6.2800E-01,  0.0000E+00,  0.0000E+00,  0.0000E+00,
     + -5.9090E-02,  6.4360E-01,  0.0000E+00,  0.0000E+00,  0.0000E+00,
     + -6.5240E-03,  1.4510E-02,  0.0000E+00,  0.0000E+00,  0.0000E+00/
C...Expansion coefficients for gluon distribution.
      DATA ((COW(IP,IS,2,1),IS=1,5),IP=1,3)/
     +  8.8800E-01,  0.0000E+00,  3.1100E+00,  6.0000E+00,  0.0000E+00,
     + -1.8020E+00, -1.5760E+00, -1.3170E-01,  2.8010E+00, -1.7280E+01,
     +  1.8120E+00,  1.2000E+00,  5.0680E-01, -1.2160E+01,  2.0490E+01/
      DATA ((COW(IP,IS,2,2),IS=1,5),IP=1,3)/
     +  7.9400E-01,  0.0000E+00,  2.8900E+00,  6.0000E+00,  0.0000E+00,
     + -9.1440E-01, -1.2370E+00,  5.9660E-01, -3.6710E+00, -8.1910E+00,
     +  5.9660E-01,  6.5820E-01, -2.5500E-01, -2.3040E+00,  7.7580E+00/
C...Expansion coefficients for (up+down+strange) quark sea distribution.
      DATA ((COW(IP,IS,3,1),IS=1,5),IP=1,3)/
     +  9.0000E-01,  0.0000E+00,  5.0000E+00,  0.0000E+00,  0.0000E+00,
     + -2.4280E-01, -2.1200E-01,  8.6730E-01,  1.2660E+00,  2.3820E+00,
     +  1.3860E-01,  3.6710E-03,  4.7470E-02, -2.2150E+00,  3.4820E-01/
      DATA ((COW(IP,IS,3,2),IS=1,5),IP=1,3)/
     +  9.0000E-01,  0.0000E+00,  5.0000E+00,  0.0000E+00,  0.0000E+00,
     + -1.4170E-01, -1.6970E-01, -2.4740E+00, -2.5340E+00,  5.6210E-01,
     + -1.7400E-01, -9.6230E-02,  1.5750E+00,  1.3780E+00, -2.7010E-01/
C...Expansion coefficients for charm quark sea distribution.
      DATA ((COW(IP,IS,4,1),IS=1,5),IP=1,3)/
     +  0.0000E+00, -2.2120E-02,  2.8940E+00,  0.0000E+00,  0.0000E+00,
     +  7.9280E-02, -3.7850E-01,  9.4330E+00,  5.2480E+00,  8.3880E+00,
     + -6.1340E-02, -1.0880E-01, -1.0852E+01, -7.1870E+00, -1.1610E+01/
      DATA ((COW(IP,IS,4,2),IS=1,5),IP=1,3)/
     +  0.0000E+00, -8.8200E-02,  1.9240E+00,  0.0000E+00,  0.0000E+00,
     +  6.2290E-02, -2.8920E-01,  2.4240E-01, -4.4630E+00, -8.3670E-01,
     + -4.0990E-02, -1.0820E-01,  2.0360E+00,  5.2090E+00, -4.8400E-02/

C...The following data lines are coefficients needed in the
C...Eichten, Hinchliffe, Lane, Quigg proton structure function
C...parametrizations, see below.
C...Powers of 1-x in different cases.
      DATA NEHLQ/3,4,7,5,7,7,7,7,3,4,7,6,7,7,7,7/
C...Expansion coefficients for up valence quark distribution.
      DATA (((CEHLQ(IX,IT,NX,1,1),IX=1,6),IT=1,6),NX=1,2)/
     + 7.677E-01,-2.087E-01,-3.303E-01,-2.517E-02,-1.570E-02,-1.000E-04,
     +-5.326E-01,-2.661E-01, 3.201E-01, 1.192E-01, 2.434E-02, 7.620E-03,
     + 2.162E-01, 1.881E-01,-8.375E-02,-6.515E-02,-1.743E-02,-5.040E-03,
     +-9.211E-02,-9.952E-02, 1.373E-02, 2.506E-02, 8.770E-03, 2.550E-03,
     + 3.670E-02, 4.409E-02, 9.600E-04,-7.960E-03,-3.420E-03,-1.050E-03,
     +-1.549E-02,-2.026E-02,-3.060E-03, 2.220E-03, 1.240E-03, 4.100E-04,
     + 2.395E-01, 2.905E-01, 9.778E-02, 2.149E-02, 3.440E-03, 5.000E-04,
     + 1.751E-02,-6.090E-03,-2.687E-02,-1.916E-02,-7.970E-03,-2.750E-03,
     +-5.760E-03,-5.040E-03, 1.080E-03, 2.490E-03, 1.530E-03, 7.500E-04,
     + 1.740E-03, 1.960E-03, 3.000E-04,-3.400E-04,-2.900E-04,-1.800E-04,
     +-5.300E-04,-6.400E-04,-1.700E-04, 4.000E-05, 6.000E-05, 4.000E-05,
     + 1.700E-04, 2.200E-04, 8.000E-05, 1.000E-05,-1.000E-05,-1.000E-05/
      DATA (((CEHLQ(IX,IT,NX,1,2),IX=1,6),IT=1,6),NX=1,2)/
     + 7.237E-01,-2.189E-01,-2.995E-01,-1.909E-02,-1.477E-02, 2.500E-04,
     +-5.314E-01,-2.425E-01, 3.283E-01, 1.119E-01, 2.223E-02, 7.070E-03,
     + 2.289E-01, 1.890E-01,-9.859E-02,-6.900E-02,-1.747E-02,-5.080E-03,
     +-1.041E-01,-1.084E-01, 2.108E-02, 2.975E-02, 9.830E-03, 2.830E-03,
     + 4.394E-02, 5.116E-02,-1.410E-03,-1.055E-02,-4.230E-03,-1.270E-03,
     +-1.991E-02,-2.539E-02,-2.780E-03, 3.430E-03, 1.720E-03, 5.500E-04,
     + 2.410E-01, 2.884E-01, 9.369E-02, 1.900E-02, 2.530E-03, 2.400E-04,
     + 1.765E-02,-9.220E-03,-3.037E-02,-2.085E-02,-8.440E-03,-2.810E-03,
     +-6.450E-03,-5.260E-03, 1.720E-03, 3.110E-03, 1.830E-03, 8.700E-04,
     + 2.120E-03, 2.320E-03, 2.600E-04,-4.900E-04,-3.900E-04,-2.300E-04,
     +-6.900E-04,-8.200E-04,-2.000E-04, 7.000E-05, 9.000E-05, 6.000E-05,
     + 2.400E-04, 3.100E-04, 1.100E-04, 0.000E+00,-2.000E-05,-2.000E-05/
C...Expansion coefficients for down valence quark distribution.
      DATA (((CEHLQ(IX,IT,NX,2,1),IX=1,6),IT=1,6),NX=1,2)/
     + 3.813E-01,-8.090E-02,-1.634E-01,-2.185E-02,-8.430E-03,-6.200E-04,
     +-2.948E-01,-1.435E-01, 1.665E-01, 6.638E-02, 1.473E-02, 4.080E-03,
     + 1.252E-01, 1.042E-01,-4.722E-02,-3.683E-02,-1.038E-02,-2.860E-03,
     +-5.478E-02,-5.678E-02, 8.900E-03, 1.484E-02, 5.340E-03, 1.520E-03,
     + 2.220E-02, 2.567E-02,-3.000E-05,-4.970E-03,-2.160E-03,-6.500E-04,
     +-9.530E-03,-1.204E-02,-1.510E-03, 1.510E-03, 8.300E-04, 2.700E-04,
     + 1.261E-01, 1.354E-01, 3.958E-02, 8.240E-03, 1.660E-03, 4.500E-04,
     + 3.890E-03,-1.159E-02,-1.625E-02,-9.610E-03,-3.710E-03,-1.260E-03,
     +-1.910E-03,-5.600E-04, 1.590E-03, 1.590E-03, 8.400E-04, 3.900E-04,
     + 6.400E-04, 4.900E-04,-1.500E-04,-2.900E-04,-1.800E-04,-1.000E-04,
     +-2.000E-04,-1.900E-04, 0.000E+00, 6.000E-05, 4.000E-05, 3.000E-05,
     + 7.000E-05, 8.000E-05, 2.000E-05,-1.000E-05,-1.000E-05,-1.000E-05/
      DATA (((CEHLQ(IX,IT,NX,2,2),IX=1,6),IT=1,6),NX=1,2)/
     + 3.578E-01,-8.622E-02,-1.480E-01,-1.840E-02,-7.820E-03,-4.500E-04,
     +-2.925E-01,-1.304E-01, 1.696E-01, 6.243E-02, 1.353E-02, 3.750E-03,
     + 1.318E-01, 1.041E-01,-5.486E-02,-3.872E-02,-1.038E-02,-2.850E-03,
     +-6.162E-02,-6.143E-02, 1.303E-02, 1.740E-02, 5.940E-03, 1.670E-03,
     + 2.643E-02, 2.957E-02,-1.490E-03,-6.450E-03,-2.630E-03,-7.700E-04,
     +-1.218E-02,-1.497E-02,-1.260E-03, 2.240E-03, 1.120E-03, 3.500E-04,
     + 1.263E-01, 1.334E-01, 3.732E-02, 7.070E-03, 1.260E-03, 3.400E-04,
     + 3.660E-03,-1.357E-02,-1.795E-02,-1.031E-02,-3.880E-03,-1.280E-03,
     +-2.100E-03,-3.600E-04, 2.050E-03, 1.920E-03, 9.800E-04, 4.400E-04,
     + 7.700E-04, 5.400E-04,-2.400E-04,-3.900E-04,-2.400E-04,-1.300E-04,
     +-2.600E-04,-2.300E-04, 2.000E-05, 9.000E-05, 6.000E-05, 4.000E-05,
     + 9.000E-05, 1.000E-04, 2.000E-05,-2.000E-05,-2.000E-05,-1.000E-05/
C...Expansion coefficients for up and down sea quark distributions.
      DATA (((CEHLQ(IX,IT,NX,3,1),IX=1,6),IT=1,6),NX=1,2)/
     + 6.870E-02,-6.861E-02, 2.973E-02,-5.400E-03, 3.780E-03,-9.700E-04,
     +-1.802E-02, 1.400E-04, 6.490E-03,-8.540E-03, 1.220E-03,-1.750E-03,
     +-4.650E-03, 1.480E-03,-5.930E-03, 6.000E-04,-1.030E-03,-8.000E-05,
     + 6.440E-03, 2.570E-03, 2.830E-03, 1.150E-03, 7.100E-04, 3.300E-04,
     +-3.930E-03,-2.540E-03,-1.160E-03,-7.700E-04,-3.600E-04,-1.900E-04,
     + 2.340E-03, 1.930E-03, 5.300E-04, 3.700E-04, 1.600E-04, 9.000E-05,
     + 1.014E+00,-1.106E+00, 3.374E-01,-7.444E-02, 8.850E-03,-8.700E-04,
     + 9.233E-01,-1.285E+00, 4.475E-01,-9.786E-02, 1.419E-02,-1.120E-03,
     + 4.888E-02,-1.271E-01, 8.606E-02,-2.608E-02, 4.780E-03,-6.000E-04,
     +-2.691E-02, 4.887E-02,-1.771E-02, 1.620E-03, 2.500E-04,-6.000E-05,
     + 7.040E-03,-1.113E-02, 1.590E-03, 7.000E-04,-2.000E-04, 0.000E+00,
     +-1.710E-03, 2.290E-03, 3.800E-04,-3.500E-04, 4.000E-05, 1.000E-05/
      DATA (((CEHLQ(IX,IT,NX,3,2),IX=1,6),IT=1,6),NX=1,2)/
     + 1.008E-01,-7.100E-02, 1.973E-02,-5.710E-03, 2.930E-03,-9.900E-04,
     +-5.271E-02,-1.823E-02, 1.792E-02,-6.580E-03, 1.750E-03,-1.550E-03,
     + 1.220E-02, 1.763E-02,-8.690E-03,-8.800E-04,-1.160E-03,-2.100E-04,
     +-1.190E-03,-7.180E-03, 2.360E-03, 1.890E-03, 7.700E-04, 4.100E-04,
     +-9.100E-04, 2.040E-03,-3.100E-04,-1.050E-03,-4.000E-04,-2.400E-04,
     + 1.190E-03,-1.700E-04,-2.000E-04, 4.200E-04, 1.700E-04, 1.000E-04,
     + 1.081E+00,-1.189E+00, 3.868E-01,-8.617E-02, 1.115E-02,-1.180E-03,
     + 9.917E-01,-1.396E+00, 4.998E-01,-1.159E-01, 1.674E-02,-1.720E-03,
     + 5.099E-02,-1.338E-01, 9.173E-02,-2.885E-02, 5.890E-03,-6.500E-04,
     +-3.178E-02, 5.703E-02,-2.070E-02, 2.440E-03, 1.100E-04,-9.000E-05,
     + 8.970E-03,-1.392E-02, 2.050E-03, 6.500E-04,-2.300E-04, 2.000E-05,
     +-2.340E-03, 3.010E-03, 5.000E-04,-3.900E-04, 6.000E-05, 1.000E-05/
C...Expansion coefficients for gluon distribution.
      DATA (((CEHLQ(IX,IT,NX,4,1),IX=1,6),IT=1,6),NX=1,2)/
     + 9.482E-01,-9.578E-01, 1.009E-01,-1.051E-01, 3.456E-02,-3.054E-02,
     +-9.627E-01, 5.379E-01, 3.368E-01,-9.525E-02, 1.488E-02,-2.051E-02,
     + 4.300E-01,-8.306E-02,-3.372E-01, 4.902E-02,-9.160E-03, 1.041E-02,
     +-1.925E-01,-1.790E-02, 2.183E-01, 7.490E-03, 4.140E-03,-1.860E-03,
     + 8.183E-02, 1.926E-02,-1.072E-01,-1.944E-02,-2.770E-03,-5.200E-04,
     +-3.884E-02,-1.234E-02, 5.410E-02, 1.879E-02, 3.350E-03, 1.040E-03,
     + 2.948E+01,-3.902E+01, 1.464E+01,-3.335E+00, 5.054E-01,-5.915E-02,
     + 2.559E+01,-3.955E+01, 1.661E+01,-4.299E+00, 6.904E-01,-8.243E-02,
     +-1.663E+00, 1.176E+00, 1.118E+00,-7.099E-01, 1.948E-01,-2.404E-02,
     +-2.168E-01, 8.170E-01,-7.169E-01, 1.851E-01,-1.924E-02,-3.250E-03,
     + 2.088E-01,-4.355E-01, 2.239E-01,-2.446E-02,-3.620E-03, 1.910E-03,
     +-9.097E-02, 1.601E-01,-5.681E-02,-2.500E-03, 2.580E-03,-4.700E-04/
      DATA (((CEHLQ(IX,IT,NX,4,2),IX=1,6),IT=1,6),NX=1,2)/
     + 2.367E+00, 4.453E-01, 3.660E-01, 9.467E-02, 1.341E-01, 1.661E-02,
     +-3.170E+00,-1.795E+00, 3.313E-02,-2.874E-01,-9.827E-02,-7.119E-02,
     + 1.823E+00, 1.457E+00,-2.465E-01, 3.739E-02, 6.090E-03, 1.814E-02,
     +-1.033E+00,-9.827E-01, 2.136E-01, 1.169E-01, 5.001E-02, 1.684E-02,
     + 5.133E-01, 5.259E-01,-1.173E-01,-1.139E-01,-4.988E-02,-2.021E-02,
     +-2.881E-01,-3.145E-01, 5.667E-02, 9.161E-02, 4.568E-02, 1.951E-02,
     + 3.036E+01,-4.062E+01, 1.578E+01,-3.699E+00, 6.020E-01,-7.031E-02,
     + 2.700E+01,-4.167E+01, 1.770E+01,-4.804E+00, 7.862E-01,-1.060E-01,
     +-1.909E+00, 1.357E+00, 1.127E+00,-7.181E-01, 2.232E-01,-2.481E-02,
     +-2.488E-01, 9.781E-01,-8.127E-01, 2.094E-01,-2.997E-02,-4.710E-03,
     + 2.506E-01,-5.427E-01, 2.672E-01,-3.103E-02,-1.800E-03, 2.870E-03,
     +-1.128E-01, 2.087E-01,-6.972E-02,-2.480E-03, 2.630E-03,-8.400E-04/
C...Expansion coefficients for strange sea quark distribution.
      DATA (((CEHLQ(IX,IT,NX,5,1),IX=1,6),IT=1,6),NX=1,2)/
     + 4.968E-02,-4.173E-02, 2.102E-02,-3.270E-03, 3.240E-03,-6.700E-04,
     +-6.150E-03,-1.294E-02, 6.740E-03,-6.890E-03, 9.000E-04,-1.510E-03,
     +-8.580E-03, 5.050E-03,-4.900E-03,-1.600E-04,-9.400E-04,-1.500E-04,
     + 7.840E-03, 1.510E-03, 2.220E-03, 1.400E-03, 7.000E-04, 3.500E-04,
     +-4.410E-03,-2.220E-03,-8.900E-04,-8.500E-04,-3.600E-04,-2.000E-04,
     + 2.520E-03, 1.840E-03, 4.100E-04, 3.900E-04, 1.600E-04, 9.000E-05,
     + 9.235E-01,-1.085E+00, 3.464E-01,-7.210E-02, 9.140E-03,-9.100E-04,
     + 9.315E-01,-1.274E+00, 4.512E-01,-9.775E-02, 1.380E-02,-1.310E-03,
     + 4.739E-02,-1.296E-01, 8.482E-02,-2.642E-02, 4.760E-03,-5.700E-04,
     +-2.653E-02, 4.953E-02,-1.735E-02, 1.750E-03, 2.800E-04,-6.000E-05,
     + 6.940E-03,-1.132E-02, 1.480E-03, 6.500E-04,-2.100E-04, 0.000E+00,
     +-1.680E-03, 2.340E-03, 4.200E-04,-3.400E-04, 5.000E-05, 1.000E-05/
      DATA (((CEHLQ(IX,IT,NX,5,2),IX=1,6),IT=1,6),NX=1,2)/
     + 6.478E-02,-4.537E-02, 1.643E-02,-3.490E-03, 2.710E-03,-6.700E-04,
     +-2.223E-02,-2.126E-02, 1.247E-02,-6.290E-03, 1.120E-03,-1.440E-03,
     +-1.340E-03, 1.362E-02,-6.130E-03,-7.900E-04,-9.000E-04,-2.000E-04,
     + 5.080E-03,-3.610E-03, 1.700E-03, 1.830E-03, 6.800E-04, 4.000E-04,
     +-3.580E-03, 6.000E-05,-2.600E-04,-1.050E-03,-3.800E-04,-2.300E-04,
     + 2.420E-03, 9.300E-04,-1.000E-04, 4.500E-04, 1.700E-04, 1.100E-04,
     + 9.868E-01,-1.171E+00, 3.940E-01,-8.459E-02, 1.124E-02,-1.250E-03,
     + 1.001E+00,-1.383E+00, 5.044E-01,-1.152E-01, 1.658E-02,-1.830E-03,
     + 4.928E-02,-1.368E-01, 9.021E-02,-2.935E-02, 5.800E-03,-6.600E-04,
     +-3.133E-02, 5.785E-02,-2.023E-02, 2.630E-03, 1.600E-04,-8.000E-05,
     + 8.840E-03,-1.416E-02, 1.900E-03, 5.800E-04,-2.500E-04, 1.000E-05,
     +-2.300E-03, 3.080E-03, 5.500E-04,-3.700E-04, 7.000E-05, 1.000E-05/
C...Expansion coefficients for charm sea quark distribution.
      DATA (((CEHLQ(IX,IT,NX,6,1),IX=1,6),IT=1,6),NX=1,2)/
     + 9.270E-03,-1.817E-02, 9.590E-03,-6.390E-03, 1.690E-03,-1.540E-03,
     + 5.710E-03,-1.188E-02, 6.090E-03,-4.650E-03, 1.240E-03,-1.310E-03,
     +-3.960E-03, 7.100E-03,-3.590E-03, 1.840E-03,-3.900E-04, 3.400E-04,
     + 1.120E-03,-1.960E-03, 1.120E-03,-4.800E-04, 1.000E-04,-4.000E-05,
     + 4.000E-05,-3.000E-05,-1.800E-04, 9.000E-05,-5.000E-05,-2.000E-05,
     +-4.200E-04, 7.300E-04,-1.600E-04, 5.000E-05, 5.000E-05, 5.000E-05,
     + 8.098E-01,-1.042E+00, 3.398E-01,-6.824E-02, 8.760E-03,-9.000E-04,
     + 8.961E-01,-1.217E+00, 4.339E-01,-9.287E-02, 1.304E-02,-1.290E-03,
     + 3.058E-02,-1.040E-01, 7.604E-02,-2.415E-02, 4.600E-03,-5.000E-04,
     +-2.451E-02, 4.432E-02,-1.651E-02, 1.430E-03, 1.200E-04,-1.000E-04,
     + 1.122E-02,-1.457E-02, 2.680E-03, 5.800E-04,-1.200E-04, 3.000E-05,
     +-7.730E-03, 7.330E-03,-7.600E-04,-2.400E-04, 1.000E-05, 0.000E+00/
      DATA (((CEHLQ(IX,IT,NX,6,2),IX=1,6),IT=1,6),NX=1,2)/
     + 9.980E-03,-1.945E-02, 1.055E-02,-6.870E-03, 1.860E-03,-1.560E-03,
     + 5.700E-03,-1.203E-02, 6.250E-03,-4.860E-03, 1.310E-03,-1.370E-03,
     +-4.490E-03, 7.990E-03,-4.170E-03, 2.050E-03,-4.400E-04, 3.300E-04,
     + 1.470E-03,-2.480E-03, 1.460E-03,-5.700E-04, 1.200E-04,-1.000E-05,
     +-9.000E-05, 1.500E-04,-3.200E-04, 1.200E-04,-6.000E-05,-4.000E-05,
     +-4.200E-04, 7.600E-04,-1.400E-04, 4.000E-05, 7.000E-05, 5.000E-05,
     + 8.698E-01,-1.131E+00, 3.836E-01,-8.111E-02, 1.048E-02,-1.300E-03,
     + 9.626E-01,-1.321E+00, 4.854E-01,-1.091E-01, 1.583E-02,-1.700E-03,
     + 3.057E-02,-1.088E-01, 8.022E-02,-2.676E-02, 5.590E-03,-5.600E-04,
     +-2.845E-02, 5.164E-02,-1.918E-02, 2.210E-03,-4.000E-05,-1.500E-04,
     + 1.311E-02,-1.751E-02, 3.310E-03, 5.100E-04,-1.200E-04, 5.000E-05,
     +-8.590E-03, 8.380E-03,-9.200E-04,-2.600E-04, 1.000E-05,-1.000E-05/
C...Expansion coefficients for bottom sea quark distribution.
      DATA (((CEHLQ(IX,IT,NX,7,1),IX=1,6),IT=1,6),NX=1,2)/
     + 9.010E-03,-1.401E-02, 7.150E-03,-4.130E-03, 1.260E-03,-1.040E-03,
     + 6.280E-03,-9.320E-03, 4.780E-03,-2.890E-03, 9.100E-04,-8.200E-04,
     +-2.930E-03, 4.090E-03,-1.890E-03, 7.600E-04,-2.300E-04, 1.400E-04,
     + 3.900E-04,-1.200E-03, 4.400E-04,-2.500E-04, 2.000E-05,-2.000E-05,
     + 2.600E-04, 1.400E-04,-8.000E-05, 1.000E-04, 1.000E-05, 1.000E-05,
     +-2.600E-04, 3.200E-04, 1.000E-05,-1.000E-05, 1.000E-05,-1.000E-05,
     + 8.029E-01,-1.075E+00, 3.792E-01,-7.843E-02, 1.007E-02,-1.090E-03,
     + 7.903E-01,-1.099E+00, 4.153E-01,-9.301E-02, 1.317E-02,-1.410E-03,
     +-1.704E-02,-1.130E-02, 2.882E-02,-1.341E-02, 3.040E-03,-3.600E-04,
     +-7.200E-04, 7.230E-03,-5.160E-03, 1.080E-03,-5.000E-05,-4.000E-05,
     + 3.050E-03,-4.610E-03, 1.660E-03,-1.300E-04,-1.000E-05, 1.000E-05,
     +-4.360E-03, 5.230E-03,-1.610E-03, 2.000E-04,-2.000E-05, 0.000E+00/
      DATA (((CEHLQ(IX,IT,NX,7,2),IX=1,6),IT=1,6),NX=1,2)/
     + 8.980E-03,-1.459E-02, 7.510E-03,-4.410E-03, 1.310E-03,-1.070E-03,
     + 5.970E-03,-9.440E-03, 4.800E-03,-3.020E-03, 9.100E-04,-8.500E-04,
     +-3.050E-03, 4.440E-03,-2.100E-03, 8.500E-04,-2.400E-04, 1.400E-04,
     + 5.300E-04,-1.300E-03, 5.600E-04,-2.700E-04, 3.000E-05,-2.000E-05,
     + 2.000E-04, 1.400E-04,-1.100E-04, 1.000E-04, 0.000E+00, 0.000E+00,
     +-2.600E-04, 3.200E-04, 0.000E+00,-3.000E-05, 1.000E-05,-1.000E-05,
     + 8.672E-01,-1.174E+00, 4.265E-01,-9.252E-02, 1.244E-02,-1.460E-03,
     + 8.500E-01,-1.194E+00, 4.630E-01,-1.083E-01, 1.614E-02,-1.830E-03,
     +-2.241E-02,-5.630E-03, 2.815E-02,-1.425E-02, 3.520E-03,-4.300E-04,
     +-7.300E-04, 8.030E-03,-5.780E-03, 1.380E-03,-1.300E-04,-4.000E-05,
     + 3.460E-03,-5.380E-03, 1.960E-03,-2.100E-04, 1.000E-05, 1.000E-05,
     +-4.850E-03, 5.950E-03,-1.890E-03, 2.600E-04,-3.000E-05, 0.000E+00/
C...Expansion coefficients for top sea quark distribution.
      DATA (((CEHLQ(IX,IT,NX,8,1),IX=1,6),IT=1,6),NX=1,2)/
     + 4.410E-03,-7.480E-03, 3.770E-03,-2.580E-03, 7.300E-04,-7.100E-04,
     + 3.840E-03,-6.050E-03, 3.030E-03,-2.030E-03, 5.800E-04,-5.900E-04,
     +-8.800E-04, 1.660E-03,-7.500E-04, 4.700E-04,-1.000E-04, 1.000E-04,
     +-8.000E-05,-1.500E-04, 1.200E-04,-9.000E-05, 3.000E-05, 0.000E+00,
     + 1.300E-04,-2.200E-04,-2.000E-05,-2.000E-05,-2.000E-05,-2.000E-05,
     +-7.000E-05, 1.900E-04,-4.000E-05, 2.000E-05, 0.000E+00, 0.000E+00,
     + 6.623E-01,-9.248E-01, 3.519E-01,-7.930E-02, 1.110E-02,-1.180E-03,
     + 6.380E-01,-9.062E-01, 3.582E-01,-8.479E-02, 1.265E-02,-1.390E-03,
     +-2.581E-02, 2.125E-02, 4.190E-03,-4.980E-03, 1.490E-03,-2.100E-04,
     + 7.100E-04, 5.300E-04,-1.270E-03, 3.900E-04,-5.000E-05,-1.000E-05,
     + 3.850E-03,-5.060E-03, 1.860E-03,-3.500E-04, 4.000E-05, 0.000E+00,
     +-3.530E-03, 4.460E-03,-1.500E-03, 2.700E-04,-3.000E-05, 0.000E+00/
      DATA (((CEHLQ(IX,IT,NX,8,2),IX=1,6),IT=1,6),NX=1,2)/
     + 4.260E-03,-7.530E-03, 3.830E-03,-2.680E-03, 7.600E-04,-7.300E-04,
     + 3.640E-03,-6.050E-03, 3.030E-03,-2.090E-03, 5.900E-04,-6.000E-04,
     +-9.200E-04, 1.710E-03,-8.200E-04, 5.000E-04,-1.200E-04, 1.000E-04,
     +-5.000E-05,-1.600E-04, 1.300E-04,-9.000E-05, 3.000E-05, 0.000E+00,
     + 1.300E-04,-2.100E-04,-1.000E-05,-2.000E-05,-2.000E-05,-1.000E-05,
     +-8.000E-05, 1.800E-04,-5.000E-05, 2.000E-05, 0.000E+00, 0.000E+00,
     + 7.146E-01,-1.007E+00, 3.932E-01,-9.246E-02, 1.366E-02,-1.540E-03,
     + 6.856E-01,-9.828E-01, 3.977E-01,-9.795E-02, 1.540E-02,-1.790E-03,
     +-3.053E-02, 2.758E-02, 2.150E-03,-4.880E-03, 1.640E-03,-2.500E-04,
     + 9.200E-04, 4.200E-04,-1.340E-03, 4.600E-04,-8.000E-05,-1.000E-05,
     + 4.230E-03,-5.660E-03, 2.140E-03,-4.300E-04, 6.000E-05, 0.000E+00,
     +-3.890E-03, 5.000E-03,-1.740E-03, 3.300E-04,-4.000E-05, 0.000E+00/

C...The following data lines are coefficients needed in the
C...Duke, Owens proton structure function parametrizations, see below.
C...Expansion coefficients for (up+down) valence quark distribution.
      DATA ((CDO(IP,IS,1,1),IS=1,6),IP=1,3)/
     + 4.190E-01, 3.460E+00, 4.400E+00, 0.000E+00, 0.000E+00, 0.000E+00,
     + 4.000E-03, 7.240E-01,-4.860E+00, 0.000E+00, 0.000E+00, 0.000E+00,
     +-7.000E-03,-6.600E-02, 1.330E+00, 0.000E+00, 0.000E+00, 0.000E+00/
      DATA ((CDO(IP,IS,1,2),IS=1,6),IP=1,3)/
     + 3.740E-01, 3.330E+00, 6.030E+00, 0.000E+00, 0.000E+00, 0.000E+00,
     + 1.400E-02, 7.530E-01,-6.220E+00, 0.000E+00, 0.000E+00, 0.000E+00,
     + 0.000E+00,-7.600E-02, 1.560E+00, 0.000E+00, 0.000E+00, 0.000E+00/
C...Expansion coefficients for down valence quark distribution.
      DATA ((CDO(IP,IS,2,1),IS=1,6),IP=1,3)/
     + 7.630E-01, 4.000E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00,
     +-2.370E-01, 6.270E-01,-4.210E-01, 0.000E+00, 0.000E+00, 0.000E+00,
     + 2.600E-02,-1.900E-02, 3.300E-02, 0.000E+00, 0.000E+00, 0.000E+00/
      DATA ((CDO(IP,IS,2,2),IS=1,6),IP=1,3)/
     + 7.610E-01, 3.830E+00, 0.000E+00, 0.000E+00, 0.000E+00, 0.000E+00,
     +-2.320E-01, 6.270E-01,-4.180E-01, 0.000E+00, 0.000E+00, 0.000E+00,
     + 2.300E-02,-1.900E-02, 3.600E-02, 0.000E+00, 0.000E+00, 0.000E+00/
C...Expansion coefficients for (up+down+strange) sea quark distribution.
      DATA ((CDO(IP,IS,3,1),IS=1,6),IP=1,3)/
     + 1.265E+00, 0.000E+00, 8.050E+00, 0.000E+00, 0.000E+00, 0.000E+00,
     +-1.132E+00,-3.720E-01, 1.590E+00, 6.310E+00,-1.050E+01, 1.470E+01,
     + 2.930E-01,-2.900E-02,-1.530E-01,-2.730E-01,-3.170E+00, 9.800E+00/
      DATA ((CDO(IP,IS,3,2),IS=1,6),IP=1,3)/
     + 1.670E+00, 0.000E+00, 9.150E+00, 0.000E+00, 0.000E+00, 0.000E+00,
     +-1.920E+00,-2.730E-01, 5.300E-01, 1.570E+01,-1.010E+02, 2.230E+02,
     + 5.820E-01,-1.640E-01,-7.630E-01,-2.830E+00, 4.470E+01,-1.170E+02/
C...Expansion coefficients for charm sea quark distribution.
      DATA ((CDO(IP,IS,4,1),IS=1,6),IP=1,3)/
     + 0.000E+00,-3.600E-02, 6.350E+00, 0.000E+00, 0.000E+00, 0.000E+00,
     + 1.350E-01,-2.220E-01, 3.260E+00,-3.030E+00, 1.740E+01,-1.790E+01,
     +-7.500E-02,-5.800E-02,-9.090E-01, 1.500E+00,-1.130E+01, 1.560E+01/
      DATA ((CDO(IP,IS,4,2),IS=1,6),IP=1,3)/ 0.000E+00,-1.200E-01,
     +3.510E+00, 0.000E+00, 0.000E+00, 0.000E+00, 6.700E-02,-2.330E-01,
     +3.660E+00,-4.740E-01, 9.500E+00,-1.660E+01,-3.100E-02,-2.300E-02,
     +-4.530E-01, 3.580E-01,-5.430E+00, 1.550E+01/
C...Expansion coefficients for gluon distribution.
      DATA ((CDO(IP,IS,5,1),IS=1,6),IP=1,3)/
     + 1.560E+00, 0.000E+00, 6.000E+00, 9.000E+00, 0.000E+00, 0.000E+00,
     +-1.710E+00,-9.490E-01, 1.440E+00,-7.190E+00,-1.650E+01, 1.530E+01,
     + 6.380E-01, 3.250E-01,-1.050E+00, 2.550E-01, 1.090E+01,-1.010E+01/
      DATA ((CDO(IP,IS,5,2),IS=1,6),IP=1,3)/
     + 8.790E-01, 0.000E+00, 4.000E+00, 9.000E+00, 0.000E+00, 0.000E+00,
     +-9.710E-01,-1.160E+00, 1.230E+00,-5.640E+00,-7.540E+00,-5.960E-01,
     + 4.340E-01, 4.760E-01,-2.540E-01,-8.170E-01, 5.500E+00, 1.260E-01/

C...The following data lines are coefficients needed in the
C...Morfin and Tung structure function parametrizations.
C...12 coefficients each for d(valence), u(valence), g, u(sea),
C...d(sea), s, c, b and t, in that order.
C...Expansion coefficients for set 1 (fit S1).
      DATA (((CMT(IEX,IPN,IFL,1),IFL=1,9),IPN=0,2),IEX=0,3)/
     +   1.30,  1.64,  1.86, -0.60, -0.45, -1.10, -3.87, -6.14,-12.53,
     +  -0.57, -0.33, -2.76, -1.68, -1.64, -1.66,  0.79,  2.65,  8.13,
     +  -0.08, -0.10,  0.10,  0.08,  0.05,  0.13, -0.70, -1.24, -2.64,
     +   0.18,  0.08, -0.17, -0.19, -0.18, -0.19, -0.03, -0.10, -0.38,
     +   0.16,  0.14, -0.07, -0.16, -0.19, -0.09, -0.17, -0.03,  0.34,
     +  -0.02, -0.01,  0.02,  0.04,  0.06,  0.01,  0.03, -0.02, -0.14,
     +   5.27,  3.74,  7.33,  9.31,  9.36,  9.07,  7.96,  6.90, 16.30,
     +   0.43,  0.54, -0.88, -1.17, -1.01, -1.39,  0.95,  1.52,-13.23,
     +   0.06,  0.03, -0.08,  0.29,  0.20,  0.47, -0.38, -0.50,  4.77,
     +  -1.85, -2.04, -0.88, -1.45, -1.48, -1.26,  0.60,  0.80, -0.57,
     +   1.08,  0.88,  2.47,  1.65,  1.49,  1.96,  0.60,  1.05,  3.58,
     +  -0.03,  0.02, -0.32, -0.20, -0.12, -0.36,  0.08, -0.14, -0.99/
C...Expansion coefficients for set 2 (fit B1).
      DATA (((CMT(IEX,IPN,IFL,2),IFL=1,9),IPN=0,2),IEX=0,3)/
     +   1.34,  1.62,  1.88, -0.99, -0.99, -0.99, -3.98, -6.28,-13.08,
     +  -0.57, -0.33, -2.78, -1.54, -1.54, -1.54,  0.72,  2.62,  8.54,
     +  -0.08, -0.10,  0.13,  0.10,  0.10,  0.10, -0.63, -1.18, -2.70,
     +   0.15,  0.11, -0.33, -0.33, -0.33, -0.33, -0.15, -0.18, -0.40,
     +   0.16,  0.14,  0.10,  0.03,  0.03,  0.03, -0.06,  0.02,  0.31,
     +  -0.02, -0.01, -0.04, -0.03, -0.03, -0.03,  0.00, -0.03, -0.12,
     +   5.30,  3.68,  7.52,  8.53,  8.53,  8.53,  7.46,  6.56, 15.35,
     +   0.43,  0.53, -1.13, -1.08, -1.08, -1.08,  0.96,  1.40,-11.83,
     +   0.06,  0.03,  0.04,  0.39,  0.39,  0.39, -0.30, -0.38,  4.16,
     +  -1.96, -1.94, -1.34, -1.55, -1.55, -1.55,  0.35,  0.65, -0.43,
     +   1.08,  0.87,  2.92,  2.02,  2.02,  2.02,  0.89,  1.13,  3.18,
     +  -0.03,  0.02, -0.49, -0.39, -0.39, -0.39, -0.04, -0.16, -0.82/
C...Expansion coefficients for set 3 (fit B2).
      DATA (((CMT(IEX,IPN,IFL,3),IFL=1,9),IPN=0,2),IEX=0,3)/
     +   1.38,  1.64,  1.52, -0.85, -0.85, -0.85, -3.74, -6.07,-12.08,
     +  -0.59, -0.33, -2.71, -1.43, -1.43, -1.43,  0.21,  2.33,  7.31,
     +  -0.08, -0.10,  0.15, -0.03, -0.03, -0.03, -0.50, -1.15, -2.35,
     +   0.18,  0.09, -0.72, -0.82, -0.82, -0.82, -0.58, -0.52, -0.73,
     +   0.16,  0.14,  0.45,  0.35,  0.35,  0.35,  0.24,  0.22,  0.54,
     +  -0.02, -0.01, -0.15, -0.09, -0.10, -0.10, -0.07, -0.07, -0.18,
     +   5.40,  3.74,  7.75,  9.19,  9.19,  9.19,  9.63,  8.33, 21.14,
     +   0.42,  0.54, -1.56, -0.92, -0.92, -0.92, -1.13,  0.28,-19.17,
     +   0.06,  0.03,  0.16,  0.12,  0.12,  0.12,  0.25, -0.28,  6.64,
     +  -1.91, -2.02, -2.18, -2.76, -2.76, -2.76, -1.09, -0.52, -1.92,
     +   1.11,  0.88,  3.75,  2.56,  2.56,  2.56,  2.10,  1.91,  4.59,
     +  -0.03,  0.02, -0.76, -0.40, -0.40, -0.40, -0.33, -0.31, -1.25/
C...Expansion coefficients for set 4 (fit E1).
      DATA (((CMT(IEX,IPN,IFL,4),IFL=1,9),IPN=0,2),IEX=0,3)/
     +   1.43,  1.69,  2.11, -0.84, -0.84, -0.84, -3.87, -6.09,-12.56,
     +  -0.65, -0.33, -3.01, -1.65, -1.65, -1.65,  0.85,  2.81,  8.69,
     +  -0.08, -0.11,  0.18,  0.12,  0.12,  0.12, -0.73, -1.34, -2.93,
     +   0.16,  0.11, -0.33, -0.32, -0.32, -0.32, -0.15, -0.17, -0.38,
     +   0.16,  0.14,  0.10,  0.02,  0.02,  0.02, -0.07,  0.01,  0.30,
     +  -0.02, -0.01, -0.04, -0.03, -0.03, -0.03,  0.00, -0.03, -0.12,
     +   6.17,  3.69,  7.93,  8.96,  8.96,  8.96,  7.83,  6.75, 14.62,
     +   0.43,  0.54, -1.40, -1.24, -1.24, -1.24,  1.00,  1.74,-11.27,
     +   0.06,  0.03,  0.09,  0.45,  0.45,  0.45, -0.36, -0.56,  4.29,
     +  -1.94, -1.99, -1.51, -1.70, -1.70, -1.70,  0.21,  0.54, -0.41,
     +   1.12,  0.90,  3.14,  2.15,  2.15,  2.15,  0.93,  1.15,  3.19,
     +  -0.02,  0.02, -0.55, -0.43, -0.43, -0.43, -0.03, -0.16, -0.87/

c      LOGICAL FIRST/.TRUE./
C...Euler's beta function, requires ordinary Gamma function
      EULBET(X,Y)=PYGAMM(X)*PYGAMM(Y)/PYGAMM(X+Y)

c      write(6,*) ' rystfu: iherpys,idir,KF ',iherpys,idir,KF
c      write(6,*) 'rystfu ',MSTP(51)
      SLO = 0.0
      SHI = 1.0
C...Reset structure functions, check x and hadron flavour.
      ALAM=0.
      Q2 = Q2I
      X = XI
      DO 10  KFL=-6,6
   10 XPQ(KFL)=0.
c         write(6,*) 'rystfu: IDIR,KF,Q2 :',idir,KF,q2,x
      IF(X.LE.0..OR.X.GE.1.) THEN
         WRITE(MSTU(11),10000) X
         write(6,*) 'rystfu: IDIR,KF,Q2 :',idir,KF,q2,x
         RETURN
      ENDIF
c      write(6,*) iherpys,ipro
      IF(IHERPYS.EQ.1) THEN
ccc          write(6,*) ' rystfu grid calc.'
         IF(X.GT.0.99) X=0.99
         XPRT = DBLE(X)
         Q2T= Q2
         IF(Q2T.LT.Q2X(1)) Q2T=SNGL(Q2X(1))
         IF(XPRT.LT.XX(1).OR.XPRT.GT.XX(NBX) .OR.Q2T.LT.Q2X(1) .OR.Q2T
     +   .GT.Q2X(NBQ2)) THEN
            IF(IHERAC.EQ.0) THEN
               WRITE(6,*) 'RYSTFU: X or Q2 values outside grid '
               WRITE(6,*) ' X_min ',XX(1),' X_max ',XX(NBX), ' actual '
     +         //'X ', XPRT
               WRITE(6,*) ' Q2_min ',Q2X(1),' Q2_max ',Q2X(NBQ2), ' '
     +         //'actual Q2 ',Q2T
c             write(6,*) ' this was for IPRO =',ipro,idir,ng,npom
            ENDIF
            IF(XPRT.LT.XX(1)) XPRT=XX(1)
            IF(XPRT.GT.XX(NBX)) XPRT=XX(NBX)
            IF(Q2T.LT.Q2X(1)) Q2T = SNGL(Q2X(1))
            IF(Q2T.GT.Q2X(NBQ2)) Q2T = SNGL(Q2X(NBQ2))
         ENDIF
         IX = 0
   20    IX = IX + 1
         IF(XPRT.GT.XX(IX+1)) GOTO 20
         IQ = 0
   30    IQ = IQ + 1
         IF(Q2T.GT.Q2X(IQ+1)) GOTO 30

         XD = SNGL((XPRT - XX(IX))/(XX(IX+1)-XX(IX)))
         QD = (Q2T - SNGL(Q2X(IQ)))/(SNGL(Q2X(IQ+1)) -SNGL(Q2X(IQ)))
         IF(NPOM.EQ.20.OR.NPOM.EQ.21) THEN
c            write(6,*) ' RYSTFU NPOM=',NPOM
            DO 40 I=-6,6
               X1P=(XPQPI(I,IX+1,IQ)-XPQPI(I,IX,IQ))*XD +XPQPI(I,IX,
     +         IQ)
               X2P=(XPQPI(I,IX+1,IQ+1)-XPQPI(I,IX,IQ+1))*XD + XPQPI(I,
     +         IX,IQ+1)
               XPQ(I) = (X2P-X1P)*QD + X1P
   40       CONTINUE
         ELSE
            DO 50 I=-6,6
               X1P=(XPQDIF(I,IX+1,IQ)-XPQDIF(I,IX,IQ))*XD +XPQDIF(I,IX,
     +         IQ)
               X2P=(XPQDIF(I,IX+1,IQ+1)-XPQDIF(I,IX,IQ+1))*XD +
     +         XPQDIF(I, IX,IQ+1)
               XPQ(I) = (X2P-X1P)*QD + X1P
   50       CONTINUE
         ENDIF
      ENDIF
      IF(IHERPYS.EQ.1) RETURN
c      write(6,*) ' RYSTFU: IHERPHS ',IHERPYS
      KFA=IABS(KF)
c      write(6,*) ' in rystfu : KFA= ',KFA,IDIR,IPRO,MSTP(51),MSTP(52)
      IF(KFA.NE.11.AND.KFA.NE.22.AND.KFA.NE.211.AND.KFA.NE.2112.AND.
     +KFA.NE.2212.AND.KFA.NE.100.AND.KFA.NE.111) THEN
         WRITE(MSTU(11),10100) KF
         RETURN
      ENDIF
c           write(6,*) ' in rystfu idir=0: KFA= ',KFA
      SCALE = Q2
      IF(KFA.EQ.100.OR.KFA.EQ.211.OR.KFA.EQ.111) THEN
cc            write(6,*) ' rystfu: now call RASTFU ',x,q2,kfa
         CALL RASTFU(KF,X,Q2,XPQ)
         GOTO 240
      ENDIF
      IF(IDIR.EQ.0) THEN
c      write(6,*) ' rystfu: integrate pom/pi parton distributions '
c             write(6,*) ' in rystfu int: idir=',idir,' kfa = ',kfa
         XMAX=1.d0-XF
C ... XP2 = E_glue /E_proton
C ... XX  = E_glue/E_pomeron
C ... XR  = E_pomeron/E_proton
         XPR = X
         XP2 = DBLE(X)
         IF(XP2.GT.XMAX) RETURN

c         write(6,*) ' RYSTFU : X,XMAX ',X,XP2,XMAX
         DO 60  I=-6,6
            XPQ(I) = 0.
   60    CONTINUE
c         write(6,*) ' RYSTFU :',NPOM,NG
         if(NPOM.EQ.999.AND.NG.EQ.999) THEN
            call xpq30(XPR,SCALE,XPQ)
c            write(6,*) ' RYSTFU :',XPQ(1)
         ELSE
            DO 70 I=-4,4
               KPART = I
               EPS = 1.E-3
               SUM = 0.
               IF(NG.GE.20.AND.NPOM.GE.20) THEN
                  CALL GADAP2(SLO,SHI,FLOW,FUP,FXT2,EPS,SUM)
               ELSEIF(NG.LT.0.AND.NPOM.LT.0) THEN
                  CALL GADAP2(SLO,SHI,FLOW,FUP,FXT2,EPS,SUM)
               ELSEIF(NPOM.GE.20) THEN
                  CALL GADAP2(SLO,SHI,FLOW,FUP,FXT2,EPS,SUM)
               ELSE
                  CALL GADAP(SLO,SHI,FUNX,EPS,SUM)
               ENDIF
               XPQ(KPART) = SUM
cc            write(6,*) ' rystfu kpart = ',kpart,sum
   70       CONTINUE
         ENDIF
      ELSEIF(IDIR.EQ.1) THEN
cc      write(6,*) ' rystfu idir=1'
C...Call user-supplied structure function.
C...Proton structure function call.
C.. modify to call PDFLIB

         IF(MSTP(51).GT.100) THEN
C...Call PDFLIB structure functions.
            XXX=DBLE(X)
            QQ=DBLE(SQRT(MAX(0.,Q2)))
C if you use PDFLIB version 3.  then uncoment the following 2 lines
C and comment the lines with 'cold pdf'
cold pdf  PARM(1)='MODE'
cold pdf  VAL(1)=MSTP(51)
C if you use PDFLIB 4.   then use the next lines.
CNEW
            PARM(1) = 'NPTYPE'
            MST51 = MSTP(51)
            VAL(1) = INT(MST51/1000000)

            PARM(2) = 'NGROUP'
            VAL(2) = DBLE(MOD(MST51,1000000)/1000)
            PARM(3) = 'NSET'
            VAL(3) = DBLE(MOD(MOD(MST51,1000000),1000))
CNEW
            NPDF=NPDF+1
            PDFFIRST=.FALSE.
            IF(NPDF.LE.1) PDFFIRST=.TRUE.
c call PDFSET each time, because when DIF with pi structure function is
c also selected one would get in confusion....
            CALL PDFSET(PARM,VAL)
            CALL STRUCTM(XXX,QQ,UPV,DNV,USEA,DSEA,STR,CHM,BOT,TOP,GLU)
            XPQ(0)=SNGL(GLU)
            XPQ(1)=SNGL(DNV+DSEA)
            XPQ(-1)=SNGL(DSEA)
            XPQ(2)=SNGL(UPV+USEA)
            XPQ(-2)=SNGL(USEA)
            XPQ(3)=SNGL(STR)
            XPQ(-3)=SNGL(STR)
            XPQ(4)=SNGL(CHM)
            XPQ(-4)=SNGL(CHM)
            XPQ(5)=SNGL(BOT)
            XPQ(-5)=SNGL(BOT)
            XPQ(6)=SNGL(TOP)
            XPQ(-6)=SNGL(TOP)
            GOTO 240
         ENDIF
C end modify to call PDFLIB
         IF(MSTP(51).EQ.0.AND.KFA.EQ.2212) THEN
            CALL PYSTFE(KFA,X,Q2,XPQ)
         ELSEIF(KFA.EQ.11) THEN
C...Electron structure function.
            AEM=PARU(101)
            PME=PMAS(11,1)
            XL=LOG(MAX(1E-10,X))
            X1L=LOG(MAX(1E-10,1.-X))
            HLE=LOG(MAX(3.,Q2/PME**2))
            HBE=(2.*AEM/PARU(1))*(HLE-1.)

C...Electron inside electron, see R. Kleiss et al., in Z physics at
C...LEP 1, CERN 89-08, p. 34
            IF(MSTP(11).LE.1) THEN
               HDE=1.+(AEM/PARU(1))*(1.5*HLE+1.289868)+(AEM/PARU(1))**
     +         2* (-2.164868*HLE**2+9.840808*HLE-10.130464)
               HEE=0.5*HBE*(1.-X)**(0.5*HBE-1.)*SQRT(MAX(0.,HDE))-
     +         0.25* HBE*(1.+X)+HBE**2/32.*((1.+X)*(-4.*X1L+3.*XL)- 4.*
     +         XL/(1.-X) -5.-X)
               HCB=0.5*HBE
            ELSE
               HCA=PARP(11)
               HCB=PARP(12)
               IF(MSTP(11).EQ.3) HCB=HCB+0.5*HBE
               HEE=X**HCA*(1.-X)**HCB/EULBET(1.+HCA,1.+HCB)
            ENDIF
            IF(X.GT.0.9999.AND.X.LE.0.999999) THEN
               HEE=HEE*100.**HCB/(100.**HCB-1.)
            ELSEIF(X.GT.0.999999) THEN
               HEE=0.
            ENDIF
            XPQQ(11)=X*HEE

C...Photon and (transverse) W- inside electron.
            AEMP=ULALEM(PME*SQRT(MAX(0.,Q2)))/PARU(2)
            IF(MSTP(13).LE.1) THEN
               HLG=HLE
            ELSE
               HLG=LOG((PARP(13)/PME**2)*(1.-X)/X**2)
            ENDIF
            XPQQ(22)=AEMP*HLG*(1.+(1.-X)**2)
            HLW=LOG(1.+Q2/PMAS(24,1)**2)/(4.*PARU(102))
            XPQQ(-24)=AEMP*HLW*(1.+(1.-X)**2)

C..Quarks and gluons inside photon inside electron.
            IF(MSTP(12).EQ.1) THEN
               T=ALOG(MIN(1E4,MAX(1.,Q2))/0.16)
               NF=3
               IF(Q2.GT.25.) NF=4
               IF(Q2.GT.300.) NF=5
               NFE=NF-2
               XL=LOG(MAX(1E-10,X))

C...Numerical integration of struncture function convolution.
               SXPGL=0.
               SXPQU=0.
               SXPQD=0.
               SUMXPP=0.
               ITER=-1
   80          ITER=ITER+1
               SUMXP=SUMXPP
               NSTP=2**(ITER-1)
               IF(ITER.EQ.0) NSTP=2
               SXPGL=0.5*SXPGL
               SXPQU=0.5*SXPQU
               SXPQD=0.5*SXPQD
               WTSTP=0.5/NSTP
               IF(ITER.EQ.0) WTSTP=0.5
               DO 90  ISTP=1,NSTP
                  IF(ITER.EQ.0) THEN
                     XLE=XL*(ISTP-1)
                  ELSE
                     XLE=XL*(ISTP-0.5)/NSTP
                  ENDIF
                  XE=EXP(XLE)
                  XG=MIN(0.999999,X/XE)
                  XPGA=1.+(1.-XE)**2
                  CALL PYSTGA(NFE,XG,T,XPGL,XPQU,XPQD)
                  SXPGL=SXPGL+WTSTP*XPGA*XPGL
                  SXPQU=SXPQU+WTSTP*XPGA*XPQU
   90          SXPQD=SXPQD+WTSTP*XPGA*XPQD
               SUMXPP=SXPGL+SXPQU+SXPQD
               IF(ITER.LE.2.OR.(ITER.LE.7.AND.ABS(SUMXPP-SUMXP).GT.
     +         PARP(14)*(SUMXPP+SUMXP))) GOTO 80
               FCONV=AEMP*HLE*AEM*(-XL)

C...Put into output arrays.
               XPQ(0)=FCONV*SXPGL
               XPQ(1)=FCONV*SXPQD
               XPQ(-1)=XPQ(1)
               XPQ(2)=FCONV*SXPQU
               XPQ(-2)=XPQ(2)
               XPQ(3)=FCONV*SXPQD
               XPQ(-3)=XPQ(3)
               IF(NFE.GE.2) THEN
                  XPQ(4)=FCONV*SXPQU
                  XPQ(-4)=XPQ(4)
               ENDIF
               IF(NFE.EQ.3) THEN
                  XPQ(5)=FCONV*SXPQD
                  XPQ(-5)=XPQ(5)
               ENDIF
            ENDIF

         ELSEIF(KFA.EQ.22) THEN
C...Photon structure function from Drees and Grassie.
C...Allowed variable range: 1 GeV^2 < Q^2 < 10000 GeV^2.
            T=ALOG(MIN(1E4,MAX(1.,Q2))/0.16)
            NF=3
            IF(Q2.GT.25.) NF=4
            IF(Q2.GT.300.) NF=5
            NFE=NF-2
            CALL PYSTGA(NFE,X,T,XPGL,XPQU,XPQD)
            AEM=PARU(101)

C...Put into output arrays.
            XPQ(0)=AEM*XPGL
            XPQ(1)=AEM*XPQD
            XPQ(-1)=XPQ(1)
            XPQ(2)=AEM*XPQU
            XPQ(-2)=XPQ(2)
            XPQ(3)=AEM*XPQD
            XPQ(-3)=XPQ(3)
            IF(NFE.GE.2) THEN
               XPQ(4)=AEM*XPQU
               XPQ(-4)=XPQ(4)
            ENDIF
            IF(NFE.EQ.3) THEN
               XPQ(5)=AEM*XPQD
               XPQ(-5)=XPQ(5)
            ENDIF
         ELSEIF(KFA.EQ.211) THEN
C...Pion structure functions from Owens.
C...Allowed variable range: 4 GeV^2 < Q^2 < approx 2000 GeV^2.

C...Determine set, Lambda and s expansion variable.
            NSET=1
            IF(MSTP(51).EQ.2.OR.MSTP(51).EQ.4.OR.MSTP(51).EQ.13) NSET=
     +      2
            IF(NSET.EQ.1) ALAM=0.2
            IF(NSET.EQ.2) ALAM=0.4
            IF(MSTP(52).LE.0) THEN
               SD=0.
            ELSE
               Q2IN=MIN(2E3,MAX(4.,Q2))
               SD=LOG(LOG(Q2IN/ALAM**2)/LOG(4./ALAM**2))
            ENDIF

C...Calculate structure functions.
            DO 110 KFL=1,4
               DO 100 IS=1,5
  100          TS(IS)=COW(1,IS,KFL,NSET)+COW(2,IS,KFL,NSET)*SD+ COW(3,
     +         IS, KFL,NSET)*SD**2
               IF(KFL.EQ.1) THEN
                  XQ(KFL)=X**TS(1)*(1.-X)**TS(2)/EULBET(TS(1),TS(2)+1.)
               ELSE
                  XQ(KFL)=TS(1)*X**TS(2)*(1.-X)**TS(3)*(1.+TS(4)*X+
     +            TS(5)* X**2)
               ENDIF
  110       CONTINUE

C...Put into output arrays.
            XPQ(0)=XQ(2)
            XPQ(1)=XQ(3)/6.
            XPQ(2)=XQ(1)+XQ(3)/6.
            XPQ(3)=XQ(3)/6.
            XPQ(4)=XQ(4)
            XPQ(-1)=XQ(1)+XQ(3)/6.
            XPQ(-2)=XQ(3)/6.
            XPQ(-3)=XQ(3)/6.
            XPQ(-4)=XQ(4)
         ELSEIF(MSTP(51).EQ.1.OR.MSTP(51).EQ.2) THEN
C...Proton structure functions from Eichten, Hinchliffe, Lane, Quigg.
C...Allowed variable range: 5 GeV^2 < Q^2 < 1E8 GeV^2; 1E-4 < x < 1

C...Determine set, Lamdba and x and t expansion variables.
            NSET=MSTP(51)
            IF(NSET.EQ.1) ALAM=0.2
            IF(NSET.EQ.2) ALAM=0.29
            TMIN=LOG(5./ALAM**2)
            TMAX=LOG(1E8/ALAM**2)
            IF(MSTP(52).EQ.0) THEN
               T=TMIN
            ELSE
               T=LOG(MAX(1.,Q2/ALAM**2))
            ENDIF
            VT=MAX(-1.,MIN(1.,(2.*T-TMAX-TMIN)/(TMAX-TMIN)))
            NX=1
            IF(X.LE.0.1) NX=2
            IF(NX.EQ.1) VX=(2.*X-1.1)/0.9
            IF(NX.EQ.2) VX=MAX(-1.,(2.*LOG(X)+11.51293)/6.90776)
            CXS=1.
            IF(X.LT.1E-4.AND.ABS(PARP(51)-1.).GT.0.01) CXS= (1E-4/X)**
     +      (PARP(51)-1.)

C...Chebyshev polynomials for x and t expansion.
            TX(1)=1.
            TX(2)=VX
            TX(3)=2.*VX**2-1.
            TX(4)=4.*VX**3-3.*VX
            TX(5)=8.*VX**4-8.*VX**2+1.
            TX(6)=16.*VX**5-20.*VX**3+5.*VX
            TT(1)=1.
            TT(2)=VT
            TT(3)=2.*VT**2-1.
            TT(4)=4.*VT**3-3.*VT
            TT(5)=8.*VT**4-8.*VT**2+1.
            TT(6)=16.*VT**5-20.*VT**3+5.*VT

C...Calculate structure functions.
            DO 130 KFL=1,6
               XQSUM=0.
               DO 120 IT=1,6
                  DO 120 IX=1,6
  120          XQSUM=XQSUM+CEHLQ(IX,IT,NX,KFL,NSET)*TX(IX)*TT(IT)
  130       XQ(KFL)=XQSUM*(1.-X)**NEHLQ(KFL,NSET)*CXS

C...Put into output array.
            XPQ(0)=XQ(4)
            XPQ(1)=XQ(2)+XQ(3)
            XPQ(2)=XQ(1)+XQ(3)
            XPQ(3)=XQ(5)
            XPQ(4)=XQ(6)
            XPQ(-1)=XQ(3)
            XPQ(-2)=XQ(3)
            XPQ(-3)=XQ(5)
            XPQ(-4)=XQ(6)

C...Special expansion for bottom (threshold effects).
            IF(MSTP(54).GE.5) THEN
               IF(NSET.EQ.1) TMIN=8.1905
               IF(NSET.EQ.2) TMIN=7.4474
               IF(T.LE.TMIN) GOTO 150
               VT=MAX(-1.,MIN(1.,(2.*T-TMAX-TMIN)/(TMAX-TMIN)))
               TT(1)=1.
               TT(2)=VT
               TT(3)=2.*VT**2-1.
               TT(4)=4.*VT**3-3.*VT
               TT(5)=8.*VT**4-8.*VT**2+1.
               TT(6)=16.*VT**5-20.*VT**3+5.*VT
               XQSUM=0.
               DO 140 IT=1,6
                  DO 140 IX=1,6
  140          XQSUM=XQSUM+CEHLQ(IX,IT,NX,7,NSET)*TX(IX)*TT(IT)
               XPQ(5)=XQSUM*(1.-X)**NEHLQ(7,NSET)*CXS
               XPQ(-5)=XPQ(5)
  150          CONTINUE
            ENDIF

C...Special expansion for top (threshold effects).
            IF(MSTP(54).GE.6) THEN
               IF(NSET.EQ.1) TMIN=11.5528
               IF(NSET.EQ.2) TMIN=10.8097
               TMIN=TMIN+2.*LOG(PMAS(6,1)/30.)
               TMAX=TMAX+2.*LOG(PMAS(6,1)/30.)
               IF(T.LE.TMIN) GOTO 170
               VT=MAX(-1.,MIN(1.,(2.*T-TMAX-TMIN)/(TMAX-TMIN)))
               TT(1)=1.
               TT(2)=VT
               TT(3)=2.*VT**2-1.
               TT(4)=4.*VT**3-3.*VT
               TT(5)=8.*VT**4-8.*VT**2+1.
               TT(6)=16.*VT**5-20.*VT**3+5.*VT
               XQSUM=0.
               DO 160 IT=1,6
                  DO 160 IX=1,6
  160          XQSUM=XQSUM+CEHLQ(IX,IT,NX,8,NSET)*TX(IX)*TT(IT)
               XPQ(6)=XQSUM*(1.-X)**NEHLQ(8,NSET)*CXS
               XPQ(-6)=XPQ(6)
  170          CONTINUE
            ENDIF

         ELSEIF(MSTP(51).EQ.3.OR.MSTP(51).EQ.4) THEN
C...Proton structure functions from Duke, Owens.
C...Allowed variable range: 4 GeV^2 < Q^2 < approx 1E6 GeV^2.

C...Determine set, Lambda and s expansion parameter.
            NSET=MSTP(51)-2
            IF(NSET.EQ.1) ALAM=0.2
            IF(NSET.EQ.2) ALAM=0.4
            IF(MSTP(52).LE.0) THEN
               SD=0.
            ELSE
               Q2IN=MIN(1E6,MAX(4.,Q2))
               SD=LOG(LOG(Q2IN/ALAM**2)/LOG(4./ALAM**2))
            ENDIF

C...Calculate structure functions.
            DO 190 KFL=1,5
               DO 180 IS=1,6
  180          TS(IS)=CDO(1,IS,KFL,NSET)+CDO(2,IS,KFL,NSET)*SD+ CDO(3,
     +         IS, KFL,NSET)*SD**2
               IF(KFL.LE.2) THEN
                  XQ(KFL)=X**TS(1)*(1.-X)**TS(2)*(1.+TS(3)*X)/ (EULBET(
     +            TS(1), TS(2)+1.)*(1.+TS(3)*TS(1)/(TS(1)+TS(2)+
     +            1.)))
               ELSE
                  XQ(KFL)=TS(1)*X**TS(2)*(1.-X)**TS(3)*(1.+TS(4)*X+
     +            TS(5)* X**2+ TS(6)*X**3)
               ENDIF
  190       CONTINUE

C...Put into output arrays.
            XPQ(0)=XQ(5)
            XPQ(1)=XQ(2)+XQ(3)/6.
            XPQ(2)=3.*XQ(1)-XQ(2)+XQ(3)/6.
            XPQ(3)=XQ(3)/6.
            XPQ(4)=XQ(4)
            XPQ(-1)=XQ(3)/6.
            XPQ(-2)=XQ(3)/6.
            XPQ(-3)=XQ(3)/6.
            XPQ(-4)=XQ(4)

         ELSEIF(MSTP(51).GE.5.AND.MSTP(51).LE.8) THEN
C...Proton structure functions from Morfin and Tung.
C...Allowed variable range: 4 GeV^2 < Q^2 < 1E8 GeV^2, 0 < x < 1.

C...Calculate expansion parameters.
            NSET=MSTP(51)-4
            IF(NSET.EQ.1) ALAM=0.187
            IF(NSET.EQ.2) ALAM=0.212
            IF(NSET.EQ.3) ALAM=0.191
            IF(NSET.EQ.4) ALAM=0.155
            IF(MSTP(52).EQ.0) THEN
               SD=0.
            ELSE
               SD=LOG(LOG(MAX(4.,Q2)/ALAM**2)/LOG(4./ALAM**2))
            ENDIF
            XL=LOG(MAX(1E-10,X))
            X1L=LOG(MAX(1E-10,1.-X))
            XLL=LOG(MAX(1E-10,LOG(1.+1./MAX(1E-10,X))))

C...Calculate structure functions up to b.
            DO 210 IP=1,8
               DO 200 IEX=0,3
  200          EXMT(IEX)=CMT(IEX,0,IP,NSET)+CMT(IEX,1,IP,NSET)*SD+
     +         CMT(IEX ,2,IP,NSET)*SD**2
               EXMTS=EXMT(0)+EXMT(1)*XL+EXMT(2)*X1L+EXMT(3)*XLL
               IF(EXMTS.LT.-50.) THEN
                  XQ(IP)=0.
               ELSE
                  XQ(IP)=EXP(EXMTS)
               ENDIF
  210       CONTINUE
            IF(Q2.LE.2.25) XQ(7)=0
            IF(Q2.LE.25.0) XQ(8)=0

C...Calculate t structure function, shifting effective Q scale for
C...nondefault t mass, Q_actual = Q_nominal * m_t_nominal/m_t_actual.
            IF(MSTP(52).EQ.0.OR.Q2.LE.PMAS(6,1)**2) THEN
               XQ(9)=0.
            ELSE
               SD=LOG(LOG(MAX(4.,Q2)/ALAM**2*(100./PMAS(6,1))**2)/
     +         LOG(4./ ALAM**2))
               DO 220 IEX=0,3
  220          EXMT(IEX)=CMT(IEX,0,9,NSET)+CMT(IEX,1,9,NSET)*SD+
     +         CMT(IEX, 2,9,NSET)*SD**2
               EXMTS=EXMT(0)+EXMT(1)*XL+EXMT(2)*X1L+EXMT(3)*XLL
               IF(EXMTS.LT.-50.) THEN
                  XQ(IP)=0.
               ELSE
                  XQ(IP)=EXP(EXMTS)
               ENDIF
            ENDIF

C...Put into output array.
            XPQ(0)=XQ(3)
            XPQ(1)=XQ(1)+XQ(5)
            XPQ(-1)=XQ(5)
            XPQ(2)=XQ(2)+XQ(4)
            XPQ(-2)=XQ(4)
            XPQ(3)=XQ(6)
            XPQ(-3)=XQ(6)
            XPQ(4)=XQ(7)
            XPQ(-4)=XQ(7)
            XPQ(5)=XQ(8)
            XPQ(-5)=XQ(8)
            XPQ(6)=XQ(9)
            XPQ(-6)=XQ(9)
         ELSEIF(MSTP(51).EQ.9) THEN
C...Lowest order parametrization of Gluck, Reya, Vogt.
C...Allowed variable range: 0.2 GeV^2 < Q2 < 1E6 GeV^2; 1E-4 < x < 1;
C...extended to 0.2 GeV^2 < Q2 < 1E8 GeV^2; 1E-6 < x < 1
C...after consultation with the authors.

C...Determine s and x.
            ALAM=0.25
            IF(MSTP(52).EQ.0) THEN
               SD=0.
            ELSE
               Q2IN=MIN(1E8,MAX(0.2,Q2))
               SD=LOG(LOG(Q2IN/ALAM**2)/LOG(0.2/ALAM**2))
            ENDIF
            XC=MAX(1E-6,X)
            XL=-LOG(XC)

C...Calculate structure functions.
            XQ(1)=(0.794+0.312*SD)*XC**(0.427-0.011*SD)* (1.+(6.887-
     +      2.227* SD)*XC+(-11.083+2.136*SD)*XC**2+ (3.900+1.079*SD)*
     +      XC**3)*(1.- XC)**(1.037+1.077*SD)
            XQ(2)=(0.486+0.139*SD)*XC**(0.434-0.018*SD)* (1.+(7.716-
     +      2.684* SD)*XC+(-12.768+3.122*SD)*XC**2+ (4.564+0.470*SD)*
     +      XC**3)*(1.- XC)**(1.889+1.129*SD)
            XQ(3)=(XC**(0.415+0.186*SD)*((0.786+0.942*SD)+ (5.256-
     +      5.810* SD)*XC+(-4.599+5.842*SD)*XC**2)+SD**0.592* EXP(-
     +      (0.398+2.135* SD)+SQRT(3.779*SD**1.250*XL)))* (1.-XC)**
     +      (1.622+1.980*SD)
            XQ(4)=SD**0.448*(1.-XC)**(5.540-0.445*SD)* EXP(-(4.668+
     +      1.230* SD)+SQRT((13.173-1.361*SD)*SD**0.442*XL))/ XL**
     +      (3.181-0.862* SD)
            XQ(5)=0.
            IF(SD.GT.1.125) XQ(5)=(SD-1.125)*(1.-XC)**(2.038+1.022*SD)*
     +      EXP(-(4.290+1.569*SD)+SQRT((2.982+1.452*SD)*SD**0.5*XL))
            XQ(6)=0.
            IF(SD.GT.1.603) XQ(6)=(SD-1.603)*(1.-XC)**(2.230+1.052*SD)*
     +      EXP(-(4.566+1.559*SD)+SQRT((4.147+1.268*SD)*SD**0.5*XL))

C...Put into output array - special factor for small x.
            CXS=1.
            IF(X.LT.1E-6.AND.ABS(PARP(51)-1.).GT.0.01) CXS=(1E-6/X)**
     +      (PARP(51)-1.)
            XPQ(0)=CXS*XQ(3)
            XPQ(1)=CXS*(XQ(2)+XQ(4))
            XPQ(-1)=CXS*XQ(4)
            XPQ(2)=CXS*(XQ(1)+XQ(4))
            XPQ(-2)=CXS*XQ(4)
            XPQ(3)=CXS*XQ(4)
            XPQ(-3)=CXS*XQ(4)
            XPQ(4)=CXS*XQ(5)
            XPQ(-4)=CXS*XQ(5)
            XPQ(5)=CXS*XQ(6)
            XPQ(-5)=CXS*XQ(6)
cc            write(6,*) ' GRV ',MSTP(51),' xpq(4) ',xpq(4)
         ELSEIF(MSTP(51).EQ.10) THEN
C...Higher order parametrization of Gluck, Reya, Vogt.
C...Allowed variable range: 0.2 GeV^2 < Q2 < 1E6 GeV^2; 1E-4 < x < 1;
C...extended to 0.2 GeV^2 < Q2 < 1E8 GeV^2; 1E-6 < x < 1
C...after consultation with the authors.

C...Determine s and x.
            ALAM=0.20
            IF(MSTP(52).EQ.0) THEN
               SD=0.
            ELSE
               Q2IN=MIN(1E8,MAX(0.2,Q2))
               SD=LOG(LOG(Q2IN/ALAM**2)/LOG(0.2/ALAM**2))
            ENDIF
            SD2=SD**2
            XC=MAX(1E-6,X)
            XL=-LOG(XC)

C...Calculate structure functions.
            XQ(1)=(1.364+0.989*SD-0.236*SD2)*XC**(0.593-0.048*SD)* (1.+
     +      (8.912-6.092*SD+0.852*SD2)*XC+(-16.737+7.039*SD)*XC**2+
     +      (10.275+0.806*SD-2.000*SD2)*XC**3)* (1.-XC)**(2.043+1.408*
     +      SD-0.283*SD2)
            XQ(2)=(0.835+0.527*SD-0.144*SD2)*XC**(0.600-0.054*SD)* (1.+
     +      (10.245-7.821*SD+1.325*SD2)*XC+(-19.511+10.940*SD- 1.133*
     +      SD2)* XC**2+(12.836-2.570*SD-1.041*SD2)*XC**3)* (1.-XC)**
     +      (3.083+ 1.382*SD-0.276*SD2)
            XQ(3)=(XC**(0.321-0.135*SD)*((10.51-2.299*SD)+ (-17.28+
     +      0.755* SD)*XC+(8.242+2.543*SD)*XC**2)* XL**(-2.023-0.103*
     +      SD)+SD** 1.044* EXP(-(-1.178+2.792*SD)+SQRT(2.318*SD**
     +      1.673*XL)))* (1.-XC)**(3.720+2.337*SD-0.199*SD2)
            XQ(4)=SD**0.761*(1.+(6.078-2.065*SD)*XC)*(1.-XC)**(4.654+
     +      0.603*SD-0.326*SD2)*EXP(-(4.231+1.036*SD)+SQRT(3.419*SD**
     +      0.316* XL))/XL**(0.897-0.618*SD)
            XQ(5)=0.
            IF(SD.GT.0.918) XQ(5)=(SD-0.918)*(1.-XC)**(3.328+0.859*SD)*
     +      EXP(-(3.837+1.504*SD)+SQRT((2.150+1.291*SD)*SD**0.5*XL))
            XQ(6)=0.
            IF(SD.GT.1.353) XQ(6)=(SD-1.353)*(1.-XC)**(3.382+0.909*SD)*
     +      EXP(-(4.130+1.486*SD)+SQRT((2.895+1.240*SD)*SD**0.5*XL))

C...Put into output array - special factor for small x.
            CXS=1.
            IF(X.LT.1E-6.AND.ABS(PARP(51)-1.).GT.0.01) CXS=(1E-6/X)**
     +      (PARP(51)-1.)
            XPQ(0)=CXS*XQ(3)
            XPQ(1)=CXS*(XQ(2)+XQ(4))
            XPQ(-1)=CXS*XQ(4)
            XPQ(2)=CXS*(XQ(1)+XQ(4))
            XPQ(-2)=CXS*XQ(4)
            XPQ(3)=CXS*XQ(4)
            XPQ(-3)=CXS*XQ(4)
            XPQ(4)=CXS*XQ(5)
            XPQ(-4)=CXS*XQ(5)
            XPQ(5)=CXS*XQ(6)
            XPQ(-5)=CXS*XQ(6)
c            write(6,*) ' GRV HO',MSTP(51)
C...Proton structure functions from Diemoz, Ferroni, Longo, Martinelli.
C...These are accessed via PYSTFE since the files needed may not always
C...available.
         ELSEIF(MSTP(51).GE.11.AND.MSTP(51).LE.13) THEN
            CALL PYSTFE(2212,X,Q2,XPQ)
C...Unknown proton parametrization.
         ELSE
            WRITE(MSTU(11),10200) MSTP(51)
         ENDIF

C...Isospin conjugation for neutron.
         IF(KFA.EQ.2112) THEN
            XPS=XPQ(1)
            XPQ(1)=XPQ(2)
            XPQ(2)=XPS
            XPS=XPQ(-1)
            XPQ(-1)=XPQ(-2)
            XPQ(-2)=XPS
         ENDIF

C...Charge conjugation for antiparticle.
         IF(KF.LT.0) THEN
            DO 230 KFL=1,6
               IF(KFL.EQ.21.OR.KFL.EQ.22.OR.KFL.EQ.23.OR.KFL.EQ.25)
     +         GOTO 230
               XPS=XPQ(KFL)
               XPQ(KFL)=XPQ(-KFL)
               XPQ(-KFL)=XPS
  230       CONTINUE
         ENDIF

      ELSE
         write(6,*) ' RYSTFU: no parton density caclulated '
         write(6,*) ' RYSTFU: IDIR=',IDIR,' IDISDIF = ',IDISDIF
         write(6,*) ' RYSTFU: KF = ',KF,' Q2 = ',Q2,' X = ',X
      ENDIF
  240 CONTINUE
C...Check positivity and reset above maximum allowed flavour.
      DO 250 KFL=-6,6
         XPQ(KFL)=MAX(0.,XPQ(KFL))
  250 IF(IABS(KFL).LE.8.AND.IABS(KFL).GT.MSTP(54)) XPQ(KFL)=0.
C...Formats for error printouts.
10000 FORMAT(' Error: x value outside physical range, x =',1P,E12.3)
10100 FORMAT(' Error: illegal particle code for structure function,',
     +' KF =',I5)
10200 FORMAT(' Error: bad value of parameter MSTP(51) in RYSTFU,',
     +' MSTP(51) =',I5)

      RETURN
      END
*CMZ :  2.07/03 24/05/99  16.51.32  by  Hannes Jung
*-- Author :    Hannes Jung   25/04/96
      SUBROUTINE USDIFFR(BETA,SCALE,XPQ,X_POM,T2)
	Implicit None
c note xpq is the parton density of the pomeron multiplied by the pomeron flux
c xpq = f_pomeron(x_pom,t) * beta * f(beta,scale)
      REAL T2,X_POM
      REAL BETA,SCALE
      REAL XPQ(-6:6)
c for example
      REAL beta02,rn2,epsp,alphp,pi,wtdist,xe,xp
	Integer I
      DATA beta02/58.74/,RN2/4./,EPSP/0.139/,alphp/0.3/,pi/3.1415/
c end example
      DO 10 I=-6,6
         XPQ(I)=0.0
   10 CONTINUE
c example : xq(x) = x(1-x) (only u,d quarks,gluons) and streng pomeron flux
C.... xq (X)= 6x(1-X)
c pomeron distribution from streng (hera proc. 1987)
      XE=RN2*ABS(T2)
      IF(XE.GT.170.0) THEN
         XE=170.
      ENDIF
      WTDIST = EXP(-XE)
      IF(WTDIST.LT.1.E-20) WTDIST=0.0
      WTDIST = WTDIST*(X_POM**(1.0-2.0*(1.0 + EPSP + ALPHP*T2)))
      WTDIST = WTDIST*beta02/16.0/PI
C.... beta q (beta)= 6/4 beta(1-beta)
      XP = 6.*(1.-beta)*beta
      XPQ(0) = XP*WTDIST
      XPQ(1) = XP/4.*WTDIST
      XPQ(2) = XPQ(1)
      XPQ(-1) = XPQ(1)
      XPQ(-2) = XPQ(2)
c      write(6,*) ' USDIFFR xp,wtdist,beta,x_pom,t2,scale:'
c     & ,xp,wtdist,beta,x_pom,t2,scale

      RETURN

      END
*CMZ :  2.07/03 24/05/99  16.56.39  by  Hannes Jung
*-- Author :    Hannes Jung   25/07/96

      FUNCTION XPQHF(X1)
      IMPLICIT None
      REAL X1,XPQHF,XS,sscal
      REAL X,Q2,LUCHGE,ULMASS
	Integer KPHF
      COMMON /HEAVYF/X,Q2,KPHF
      REAL XPQ(-6:6)
      REAL SNGL
	Double Precision pi,xt,xl,am,smin,chimin,xpmax,xpmin,xp,beta2
	Double Precision zqmax,zqmin,xksi,zlog,alpha_s,xg,fl,f2,wtg
	Double Precision beta,scal,alphas
      EXTERNAL LUCHGE,ULMASS
      pi=2.d0*dasin(1.d0)
      XPQHF = 0.0
      f2 = 0.0D0
      xt = 0.0D0
      AM = DBLE(ULMASS(KPHF))
      SMIN = 4.D0*AM**2
      CHIMIN=DBLE(X)*(1.D0 + SMIN/DBLE(Q2))
      CHIMIN = DMAX1(CHIMIN,DBLE(X))
      XPMIN = DBLE(X)
      XPMAX = DBLE(X)/CHIMIN
c      write(6,*) ' xpqhf x,q2',x,q2
c       write(6,*) ' xpqhf xpmax,xpmin',xpmax,xpmin
c       write(6,*) ' xpqhf: CHIMIN,x,smin,q2',CHIMIN,x,smin,q2
      if(xpmax.lt.xpmin) then
c       write(6,*) ' xpqhf xpmax,xpmin',xpmax,xpmin
c       write(6,*) ' xpqhf: CHIMIN,x,smin,q2',CHIMIN,x,smin,q2
         return
      endif
      IF(XPMIN.EQ.0.0D0) THEN
         write(6,*) ' xpqhf XPMIN CHIMIN,X ',CHIMIN,X,AM
      ENDIF
      XP = XPMIN * (XPMAX/XPMIN)**DBLE(X1)
cc      XP = XPMIN + DBLE(X1)*(XPMAX-XPMIN)
      IF((4.d0*am**2*xp/DBLE(Q2)/(1.d0-xp)).GE.1.d0) RETURN
      beta2 = 1.d0 - 4.d0*am**2*xp/DBLE(Q2)/(1.d0-xp)
      beta = dsqrt(beta2)
      ZQMAX = 1.d0 + beta
      ZQMIN = 1.d0 - beta
      xksi = am**2/DBLE(q2)
c         IF(ZQMIN.GT.0.5) RETURN
c        write(6,*) ' xpqhf CHIMIN,X,am,kphf ',CHIMIN,X,AM,KPHF
c        write(6,*) ' xpqhf beta,zqmax,zqmin',beta,zqmax,zqmin,xp
      zlog = dlog(zqmax/zqmin)
      SCAL=4.D0*AM**2
      ALPHA_S=ALPHAS(DSQRT(SCAL))
c      write(6,*) ' xpqhf alphas ',alpha_s
      xg = dble(x)/xp
      xt = zlog*(0.5d0*xp - xp**2 *(1.d0-xp) + 2.d0*xksi*xp**2*(1.d0-
     +3.d0*xp) - 4.d0*xksi**2*xp**3) + beta*(4.d0*xp**2*(1.d0-xp) -
     +0.5d0*xp -2.d0*xp**2*xksi*(1.d0-xp))
c note the following line is different in massless case from Peccei/Ruckl
c    +        + beta*(3.d0*xp**2*(1.d0-xp) - 0.5d0*xp ! Peccei/Ruckl
      xl = 2.d0*beta*xp**2*(1.d0-xp) -4.d0*xp**3*xksi*zlog
      f2 = alpha_s * xt /pi
      fl = alpha_s * xl /pi
c      write(6,*) 'x,xp,xglu ',x,xp,xg
      f2 = f2/xp
      fl = fl/xp
      if(xg.ge.1.) write(6,*) ' xpqhf  xg>1 ',xg,x,xp,x1
      XS = SNGL(XG)
      sscal = sngl(scal)
      CALL RYSTFU(2212,XS,SSCAL,XPQ)
      wtg = dble(XPQ(0))
      f2 = f2 * wtg
      if(x1.gt.1..or.x1.lt.0.) THEN
         write(6,*) 'xpqhf: x1 = ',x1,AM
      endif
c      write(6,*) ' f2,xp ',f2,xp
c      write(6,*) 'xpqhf: x1 = ',x1,AM
c      write(6,*) ' XPQHF ',f2,xp
      XPQHF = SNGL(f2* XP*DLOG(XPMAX/XPMIN))
c      write(6,*) ' xpqhf xs,scal,xpq(4) ',xs,scal,xpq(4),
c     &  f2*XP*DLOG(XPMAX/XPMIN)/2
c      CALL RYSTFU(2212,X,Q2,XPQ)
c      write(6,*) ' xpqhf x,q2,xpq(4) ',x,q2,xpq(4)
cc      XPQHF = SNGL(f2* (XPMAX-XPMIN))
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.28  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  16.58.07  by  Hannes Jung
*-- Author :    Hannes Jung   19/08/97
      FUNCTION RNDM()
	Implicit None
	Double Precision RNDM
      Double Precision draprn
      EXTERNAL draprn
      LOGICAL FIRST
      DATA FIRST/.TRUE./
      IF(FIRST) THEN
         write(6,*) 'call rndm = draprn'
         FIRST = .FALSE.
      ENDIF
      RNDM = draprn()
      RETURN
      END
*CMZ :  2.06/23 17/12/97  19.41.07  by  Hannes Jung
*-- Author :
      SUBROUTINE GARINI

*#**********************************************************************
*#
*#    SUBROUTINE GARINI
*#
*# PURPOSE: initialise ARIADNE 4.8 parameter commons
*#
*# NOTE: GARINI has to be called before call to GLECHA
*#
*# CALLED BY: GLEPTO
*#
*# CALLING: UCOPY
*#
*# AUTHOR: Peter Lanius             CREATED AT: 92/03/02
*#
*# CHANGED BY:                              AT:
*# REASON:
*#
*#**********************************************************************

C...Initialization of the common blocks used in Ariadne

      PARAMETER(MAXDIP=500,MAXPAR=500,MAXSTR=100,MAXONI=100)

      IMPLICIT DOUBLE PRECISION (D)
      IMPLICIT DOUBLE PRECISION (B)
      IMPLICIT LOGICAL (Q)

      COMMON /ARDAT1/ PARA(40),MSTA(40)
      SAVE /ARDAT1/
      COMMON /ARDAT2/ PQMAS(10)
      SAVE /ARDAT2/
      COMMON /ARDAT3/ IWRN(40)
      SAVE /ARDAT3/
      COMMON /ARHIDE/ PHAR(400),MHAR(400)
      SAVE /ARHIDE/
      COMMON /ARPOPA/ TOTSIG,PPOW,CA(3),PB(3),CF(0:6),XA(0:6),NB(0:6)
      SAVE /ARPOPA/

C-MH array for H1 specific steering of ARTUNE:
      COMMON /H1TUNE/ CH1TUN
      CHARACTER*4 CH1TUN

C...Breif explanation of parameters and switches:
C...
C...
C...Parameters:
C...
C...PARA(1) (D=0.22) lambda_QCD
C...PARA(2) (D=0.200) Constant alpha_QCD for MSTA(12)=0
C...PARA(3) (D=0.600) Cutoff in invariant p_t for QCD emission
C...PARA(4) (D=1/137) Constant alpha_EM
C...PARA(5) (D=0.600) Cutoff in invariant p_t for EM emission
C...PARA(6) (D=-1.00) Maximum allowed invariant p_t^2 (if >0)
C...PARA(7-9) not used
C...PARA(10)(D=1.000) Power in soft suppression (dimnsionality of
C...                  the extended source)
C...PARA(11)(D=0.600) Soft suppression parameter for code 1 or for
C...                  hadron on side 1 in PYTHIA or for the hadron
C...                  in LEPTO
C...PARA(12)(D=0.600) Soft suppression parameter for code 2 or for
C...                  hadron on side 2 in PYTHIA
C...PARA(13)(D=0.600) Soft suppression parameter for code 3
C...PARA(14)(D=1.000) Factor to multiply p_t of resolved photon or
C...                  or pomeron to get soft suppression parameter
C...PARA(15)(D=1.000) Power in soft suppression for resolved photon or
C...                  or pomeron
C...PARA(16)(D=-1.00) Mean of gaussian distributed mean intrinsic k_t
C...                  in pomeron (if less that 0 this is instead taken
C...                  from the corresponding hadron variables in LEPTO
C...                  or PYTHIA
C...PARA(17)(D=2.000) Maximum value of intrinsic k_t as given by
C...                  PARA(16)
C...PARA(18)(D=1.000) Maximum fraction of pomeron strf of total
C...PARA(19)(D=0.001) Minimum value of stucture function in denominator in
C...                  initial state g->qqbar
C...PARA(20)(D=0.000) Factor multiplying Q^2 before comparing with
C...                  momentum transfer in cutoff for DIS Matrix
C...                  elements. If < 0 W^2 is used as scale.
C...PARA(21)(D=1.000) Factor multiplying Q^2 when comparing with an
C...                  invariant p_T^2
C...PARA(22-24) not used
C...PARA(25)(D=2.000) exponent in propability for having a larger
C...                  fraction than a in extended emissions.
C...PARA(26)(D=9.000) Number of differently coloured dipoles
C...PARA(27)(D=0.600) Squared gives the mean value of primordial
C...                  k_t^2 for MSTA(37) > 0
C...PARA(28)(D=0.000) If > 0: Minimum energy for an emitted gluon.
C...                  If < 0: -Maximum energy for an emitted gluon.
C...PARA(29-30) not used
C...PARA(31)(D=25.00) Maximum invariant p_t^2 for clustering three jets
C...                  into two in ARCLUS
C...PARA(33-38) not used
C...PARA(39)(D=0.001) Tolerance factor for momentum conservation
C...PARA(40)(D=1E32)  Maximum allowed floating point number ("minimum"
C...                  is 1/PARA(40)
C...
C...Switches:
C...
C...MSTA(1) (R)       Ariadne mode (set by ARINIT) for treatment of
C...                  incomming events.
C...         0 =>      No special treatment
C...         1 =>      as if produced by JETSET
C...         2 =>      as if produced by PYTHIA
C...         3 =>      as if produced by LEPTO
C...MSTA(2) (I)       Initialization done and headers written
C-MH default is MSTA(3)=0!
C...MSTA(3) (D=1)     Setting of parameters in  Ariadne, JETSET,
C...                  PYTHIA and LEPTO to suitable values.
C...         0 =>      off
C...         1 =>      on
C...MSTA(4) (I)       Number of calls made to AREXEC
C...MSTA(5) (D=0)     Perform fragmentation at the end of AREXEC
C...         0 =>      off
C...         1 =>      on
C...                  When running with JETSET, PYTHIA or LEPTO this
C...                  switch is set to the value of the corresponding
C...                  switch in these programs.
C...MSTA(6) (D=-1)    Maximum number of emission (per string) in a
C...                  AREXEC call (if <0 - no limit) (Disabled when
C...                  used with PYTHIA.)
C...MSTA(7) (D=6)     File number for output (stdout) from Ariadne
C...                  set to MSTU(11) by ARINIT
C...MSTA(8) (D=6)     File number for error messages (stdout) from
C...                  Ariadne
C...MSTA(9) (D=1)     Debug mode
C...         0 =>      debug off
C...         1 =>      check that energy and momentum is conserved after
C...                   each call to AREXEC produce. Warns if change
C...                   in momentum is larger a factor PARA(39)
C...         2 =>      as for 1 but check every emission
C...         3 =>      as for 2 but dump string to /LUJETS/ after each
C...                   emission
C...MSTA(10)(D=5)     Maximum number of warnings (of each kind) issued
C...                  by Ariadne
C...MSTA(11)(D=0)     Phase space restrictions. The maximum p_t of an
C...                  emission is set to the p_t of the last emission
C...                  (otherwise no restrictions) for:
C...                    gluon  q-qbar  photon  emissions
C...         0 =>        yes     yes     yes
C...         1 =>        yes     yes     no
C...         2 =>        yes     no      yes
C...         3 =>        yes     no      no
C...         4 =>        no      no      no
C...MSTA(12)(D=1)     Running alpha_QCD
C...         0 =>      off
C...         1 =>      on
C...MSTA(13) (R)      Error experienced by Ariadne in last call to
C...                  AREXEC. Reset to 0 at each call to AREXEC
C...MSTA(14)(D=1)     The maximum allowed p_t is set to the minimum
C...                  invariant p_t of all gluons in an incomming
C...                  string
C...         0 =>      off
C...         1 =>      on except in PYTHIA where instead limit is set
C...                   to the p_T^2 of the hard interaction for
C...                   relevant sub processes.
C...         2 =>      on
C...MSTA(15)(D=5)     Number of flavours allowed in final state
C...                  gluon -> q-qbar emission
C...MSTA(16)(D=2)     Recoil treatment
C...         0 =>      minimize p_t1^2 + p_t3^2
C...         1 =>      as for 0 but pointlike string ends takes
C...                   all recoil
C...         2=>       as for 0 but also extended string ends which
C...                   have a>1 takes full recoil
C...MSTA(17)(D=3)     Recoil treatment for extended dipoles
C...         0 =>      no special treatment (but cf. MSTA(16))
C...         1 =>      emit recoil gluon (except if pointlike quark
C...                   in other dipole end for MSTA(16)=1)
C...         2 =>      emit recoilgluon according to new strategy
C...                   (except if pointlike quark in other dipole end
C...                   for MSTA(16)=1)
C...         3 =>      always emit recoilgluon according to new strategy
C...MSTA(18)(D=3)     P_t ordering of recoil gluons
C...         0 =>      off
C...         1 =>      on and require p_t larger than cutoff and mu
C...         2 =>      as 1 but p_t may be smaller than mu
C...         3 =>      as 2 but p_t may also be smaller than the cutoff
C...MSTA(19)(D=2)     Correct or quick treatment of emissions from
C...                  heavy quarks
C...         0 =>      quick
C...         1 =>      correct
C...         2 =>      as for 1 but also use max(p_t^2,Q^2) in argument
C...                   for alpha_S for LEPTO
C...MSTA(20)(D=0)     Final state photon radiation
C...         0 =>      off
C...         1 =>      on
C...         2 =>      on but turned off at the first occurence of
C...                   q-qbar emission in a string.
C...MSTA(21)(D=0)     Photon radiation when run with PYTHIA or LEPTO
C...         0 =>      off
C...         1 =>      on
C...MSTA(22)(D=1)     Transfer of recoils in Drell-Yan processes
C...         0 =>      off
C...         1 =>      on
C...         2 =>      on but no transfer if a > 1
C...         3 =>      on but modified phase space
C...        <0 =>      as for >0 but only transfer recoil from recoil
C...                   gluons
C...MSTA(23)(D=1)     Fix bug in matix element for q-qbar emissions
C...         0 =>      Wrong ME
C...         1 =>      correct ME
C...         2 =>      as 1 but use m_t as ordering variable for q-qbar
C...                   emissions instead of p_t.
C...MSTA(24)(D=2)     Quark masses to be used in q-qbar emissions
C...         0 =>      as specified in PMAS(1-8) in /ARDAT2/
C...         1 =>      "bare" quark masses as specified in PMAS(1-8)
C...                   in /LUDAT2/
C...         2 =>      "constituent" quark masses as specified in
C...                   PARF(101-108) in /LUDAT2/
C...MSTA(25)(D=1)     Generation procedure for exetended dipoles
C...         0 =>      Using restricted phase space
C...         1 =>      Using full phase space rejecting unphysical
C...                   emissions allowing larger fractions of a
C...                   according  to PARA(25)
C...         2 =>      as 1 but new definition of p_T for calculation
C...                   of a
C...         3 =>      as for 1
C...         4 =>      but use real p_t of gluon w.r.t. remnant.
C...         5 =>      but use real p_t of gluon w.r.t. struck quark.
C...MSTA(26) not used
C...MSTA(27)(D=0)     Normalize pomeron structure function
C...         0 =>      nope
C...         1 =>      jupp
C...MSTA(28)(D=0)     Final state g->QQbar options
C...          0        normal Dipole model p_t ordering
C...          1        require m_QQ < p_tg
C...          2        require m_QQ-2m_Q < p_tg
C...         <0        as for >0 but don't limit p_tQQ
C...MSTA(29)(D=0)     Treatment of gluon rings
C...          0        allowed
C...          1        disallowed
C...MSTA(30)(D=3)     Extendedness of remnants
C...         0 =>      Stuck quark point like, remnant extended with
C...                   PARA(11)
C...         1 =>      as 0 but remnant extended with PARA(11)/(1-x)
C...         2 =>      as 1 but struck quark extended with Q
C...         3 =>      as 2 but emitted quark in initial state g->qqbar
C...                   not extended.
C...MSTA(31)(D=1)     mass of extended partons
C...         0 =>      set to zero for backward compatibility
C...         1 =>      keeps value given
C...MSTA(32)(D=1)     Treatment of DIS matrix element for BGF, and inclusion
C...                  of initial state g->qqbar in cascade
C...         0 =>      use old (wrong) treatment of BGF matrix elements
C...                   events
C...         1 =>      Let Lepto only generate Electro-weak vertex.
C...                   Generate BGF with sudakov in Ariadne and perform
C...                   this if it has higher p_t^2 than the first gluon
C...                   emission
C...         2 =>      Include initial state g->qqbar in cascade and correct
C...                   first emission for matrix elements if MSTA(33)!=0
C...MSTA(33)(D=1)     Treatment of DIS matrix element for QCM
C...
C...
C...         0 =>      approximated in cascade with the dipole formula
C...                   (Also only leading log BGF)
C...         1 =>      cascade corrected in first gluon emission
C...MSTA(34)(D=2)     Include Pomeron remnants
C...         -1 =>      included using external structure functions as
C...                   supplied in subroutine ARUPOM
C...         0 =>      not included
C...         1 =>      included using built in structure functions as
C...                   defined in /ARPOPA/ with zfq(z) = cf z^xa(1-z)^nb
C...                   and fp(x) ~ x^(-ppow/2)
C...         2 =>      as for 1 but zfq(z) = cf z(1-z) and
C...                   fp(x) ~ (1-x)^3/x
C...         3 =>      as for 1 but zfq(z) = cf z(1-z) and
C...                   fp(x) ~ (1-x)^5/x
C...
C...MSTA(35)(D=0)     Colour rearrangement of dipoles in the cascade
C...                    -1 => Allow rearrangement after the cascade
C...                     0 => off
C...                     1 => Allow rearrangement within each initial
C...                          string separately
C...                     2 => As 1 but allow global rearrangements
C...                          e.g. below gluon energies of PARA(28)
C...                     3 => Allow global rearrangements from start
C...MSTA(36)(D=2)     Extension of remnant overides other switches
C...                      0 => PARA(11/12) or as defined by other switches
C...                      1 => PARA(11/12)/(1-z)
C...
C...
C...                      2 => intrinsic p_t*PARA(14)
C...                      3 => intrinsic p_t*PARA(14)/(1-x)
C...                      4 => intrinsic p_t*PARA(14)/((1-x)(1-z))
C...MSTA(37)(D=1)     Handeling of primordial k_t of proton
C...                      0 => As in program initialized for
C...                      1 => Gaussian with <k_T^2> = PARA(27)^2
C...                      2 => Exponential with <k_T^2> = PARA(27)^2
C...End of description

      REAL XPARA(40),XPHAR(400),XPQMAS(10)
      REAL XCA(3),XPB(3),XCF(0:6),XXA(0:6)
      INTEGER IMSTA(40),IMHAR(400),IIWRN(40),INB(0:6)

      DATA XPARA/0.22,0.2,0.6,0.007297353,0.6,-1.0,0.0,0.0,0.0,1.0,
     $           0.6,0.6,0.6,1.0,1.0,-1.0,2.0,1.0,0.001,0.0,
     $           1.0,0.0,2*0.0,2.0,9.0,0.6,3*0.0,
     $           25.0,7*0.0,0.001,1.0E32/
      DATA IMSTA/0,0,1,0,0,-1,6,6,1,5,
     $           0,1,0,1,5,2,3,3,2,0,
     $           0,1,1,2,1,0,0,2*0,3,
     $           1,1,1,2,0,2,1,3*0/
      DATA XPHAR/100*0.0,
     $           -1.0,-1.0,1.0,1.0,0.0,0.0,-1.0,0.0,9.0,91*0.0,
     $           100*0.0,
     $           100*0.0/
      DATA IMHAR/100*0,
     $           2,2,1,0,0,0,0,0,0,0,1,-1,1,0,0,0,0,0,0,1,7*0,1,0,1,
     $           1,1,9,1,66*0,
     $           100*0,
     $           100*0/
      DATA XPQMAS/10*0.0/
      DATA IIWRN/40*0/
      DATA XTOTSIG/2.3/
      DATA XPPOW/2.0/
      DATA XCA/6.38,0.424,0.0/
      DATA XPB/8.0,3.0,0.0/
      DATA (XCF(I),I=0,6)/0.0,1.0,1.0,0.0,0.0,0.0,0.0/
      DATA (XXA(I),I=0,6)/7*1.0/
      DATA (INB(I),I=0,6)/7*1/

      CALL UCOPY( XPARA, PARA, 40 )
      CALL UCOPY( IMSTA, MSTA, 40 )

      CALL UCOPY( XPHAR, PHAR, 400 )
      CALL UCOPY( IMHAR, MHAR, 400 )

      CALL UCOPY( XPQMAS, PQMAS, 10 )
      CALL UCOPY( IIWRN, IWRN, 40 )

      TOTSIG = XTOTSIG
      PPOW = XPPOW

      CALL UCOPY( XCA, CA, 3 )
      CALL UCOPY( XPB, PB, 3 )

      CALL UCOPY( XCF, CF, 7 )
      CALL UCOPY( XXA, XA, 7 )
      CALL UCOPY( INB, NB, 7 )

C-MH
      CH1TUN = 'EMC '

      MSTA(3) = 0

      RETURN
      END
*CMZ :  2.07/03 24/05/99  17.03.31  by  Hannes Jung
*-- Author :    Hannes Jung   26/12/97
      SUBROUTINE pdisdc
	Implicit None
c perform decay of p diss system
c special treatment to avoid delta prod.
      INTEGER N,K
      REAL P,V
      COMMON/LUJETS/N,K(4000,5),P(4000,5),V(4000,5)
*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEND.
      real ym_str,ym_had
      common/pdisc/ ym_str,ym_had
	integer npdc1,npdc2
      common/pdcyn/npdc1,npdc2
	real P18old,ETT,epzall,xmr2,ym_test
	Integer I,J,IPR,IPT1,IPT2,IPT3,IPAR1,IPAR2,IPAR3,IREP
      if(npdc1.ne.0) then
         K(npdc1,1) = 2
         K(npdc2,1) = 1
      endif
      P18old = PARJ(18)
      PARJ(18)=0.0000001
cccc      call lulist(1)
      call luexec
      PARJ(18) = P18old


c look for p dissociation
      IPR  = -999
      IPT1 = 1
      IPT2 = 1
      IPT3 = 1
      IPAR1 = -999
      IPAR2 = -999
      IPAR3 = -999
      ETT = 0.
      IREP = 0
      ym_str=0.
      ym_had=0.
c      write(6,*) ' checking p - diss '

      DO 10  J=1,5
   10 P(N+1,J) = 0.
      epzall = 0.
      Do 30  I=6,N
         IF(K(I,2).EQ.2210.AND.K(I,3).EQ.2) IPR = I
c       IF(K(I,3).EQ.IPR) THEN
c          DO 490 J=1,5
c 490         P(N+2,J) = P(N+2,J) + P(I,J)
c          write(6,*) ' IPR found',I,IPR
c          ENDIF
         IF(K(I,3).EQ.IPR.AND.IPT1.EQ.1) THEN
            IPT1 = IPT1+1
            IPAR1 = I
c          write(6,*) ' IPT1 found',IPAR1
            IF(K(I,2).EQ.2212) then
               ym_had=P(I,5)
               goto 40
            endif
         ENDIF
cc         IF(K(I,3).EQ.IPAR1.AND.IPT2.EQ.1) THEN
cc            IPT2 = IPT2 + 1
cc            IPAR2 = I
ccc          write(6,*) ' IPT2 found',IPAR2
cc         ENDIF
cccccccc         IF(K(I,3).EQ.IPAR2.AND.IPT3.EQ.1) THEN
         IF(K(I,3).EQ.IPAR1.AND.IPT2.EQ.1) THEN
c here we have the string from p diss
cc            IPT3 = IPT3 + 1
cc            IPAR3 = I
            IPT2 = IPT2 + 1
            IPAR2 = I
cc          write(6,*) ' string IPT3 found',I
            ym_str = real(P(I,5))
         ENDIF
ccc         IF(K(I,3).EQ.IPAR3) THEN
         IF(K(I,3).EQ.IPAR2) THEN
c calculate mass of string from decay products
cc         write(6,*) 'decay particles ',i
            DO 20  J=1,5
   20       P(N+1,J) = P(I,J) + P(N+1,J)
         ENDIF
   30 CONTINUE
      XMR2 = P(N+1,4)**2 - P(N+1,1)**2 - P(N+1,2)**2 - P(N+1,3)**2
      if(xmr2.gt.0.0) then
         ym_had = sqrt(real(xmr2))
      else
         ym_had = -99999.
      endif
   40 continue
ccc       write(6,*) ' my(hadr),my(str) ',ym_had,ym_str
ccc       call lulist(1)
cc      if(ym_had.gt.20.and.ym_had.le.40) then
cc      write(6,*) ' my(hadr),my(str) ',ym_had,ym_str
c       write(6,*) ' P(n+1) ',(P(n+1,i),i=1,4)
c       call lulist(1)
cc       endif
      IF(MSTU(24).NE.0) THEN
         if(npdc1.ne.0) then
            DO 50  J=1,5
   50       P(N+2,J) = P(npdc1,J) + P(npdc2,J)
            ym_test = P(N+2,4)**2-P(N+2,3)**2-P(N+2,2)**2-P(N+2,1)**2
            ym_test = sqrt(ym_test)
         endif
         WRITE(6,*) 'MSTU(24)= ',MSTU(24)
         write(6,*) ' my(hadr),my(str) ',ym_had,ym_str
         write(6,*) ' ym_test ',ym_test
         write(6,*) ' P(n+2) ',(P(n+2,i),i=1,4)
cc         CALL LULIST(1)
      ENDIF
      return
      end
*CMZ :  2.07/03 24/05/99  17.04.48  by  Hannes Jung
*-- Author :    Hannes Jung   02/02/98
      SUBROUTINE DIFFR5(X,WDIF)
      IMPLICIT None
	Double Precision X,WDIF,WPART,WT1,GEV2NB
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      DIMENSION X(20)
      DATA GEV2NB/.3893857D+6/
      WPART=0.D0
      WDIF=0.D0
      WT1=0.D0
      IF(IHERAC.EQ.0) THEN
         CALL PARTDH(X,WPART)
      ELSE
         CALL PARTDHHS(X,WPART)
      ENDIF
      IF(WPART.GT.0.) THEN
         CALL ELEQQG(WT1)
      ENDIF
      if(wt1.eq.0d0.and.wpart.ne.0.d0) then
c      write(6,*) 'diffr5 wpart,wt1',wpart,wt1
      endif
c      write(6,*) 'diffr5 wpart,wt1',wpart,wt1
      WDIF=WPART*WT1*GEV2NB
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.28  by  Hannes Jung
*CMZ :  2.08/00 14/06/99  19.13.56  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  17.25.59  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94


      SUBROUTINE partdh(X,WPART)
      IMPLICIT None
      Double Precision X,WPART,XY
*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGSTRU.
      REAL SCAL1,XPD1,SCAL2,XPD2
      COMMON/STRU/ SCAL1,XPD1,SCAL2,XPD2
C     SAVE
*KEEP,RGFULL.
      INTEGER IFULL,IQCDGRID
      COMMON /OALPINI/ IFULL,IQCDGRID
*KEND.
      Double Precision PHI
      COMMON/DIFFA/ PHI
      Double Precision draprn
      DOUBLE PRECISION ME,MP
      COMMON/XVAR/ XY(10)
      DOUBLE PRECISION STHETA,SPHI,WMAX
      DIMENSION X(20)
      Integer IJOIN,NJOIN,NDIMC,IMIX
      DIMENSION IJOIN(10)
      COMMON /DIMEN/ NDIMC
      COMMON /OALPHAS/ WMAX,IMIX
*KEEP,RGPQCDPOM.
      Integer Iqqg
	COMMON/pqcdpom/ Iqqg
C     SAVE


*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
      Integer NDIM,NPOIN,LST,IRES
      COMMON/DIVO/ NDIM,NPOIN
      COMMON/EPPARA/LST(30),IRES(2)
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      Integer IVM,IGENFL,NTHRE,NVMRE,IDEBUG
      COMMON/VMESON/IVM
      COMMON/GENWEI/IGENFL
      COMMON/HERTHET/ NTHRE,NVMRE
*KEEP,RGRAHER.
      REAL XPQDIF,XPQPI
	Integer IHERPYS
	Integer NBQ2,NBX
      PARAMETER (NBQ2=20)
      PARAMETER (NBX=20)
      COMMON /RAHER/ IHERPYS,XPQDIF(-6:6,NBX,NBQ2),XPQPI(-6:6,NBX,NBQ2)
*KEND.
      COMMON/ INTERN/IDEBUG
      Double PRecision XPOM
      COMMON/BARTELS/XPOM
      DOUBLE PRECISION   sst,betat,xppt,t,qqt
      common   /parameter/ sst,qqt,betat,xppt,t
      Double Precision DHFORMF,W12,W02,QF,QFT,YX,SMIN
      Double Precision XG1,ww,XP2,FGAM,FWEI,XX,THETE
      Double Precision WTDIST,xbj,XR,djac,beta,T2MN,T2MAX1,T2MIN,T2
      Double Precision PEGZ
      Double Precision COSTP,PHIP,PHIO,SPHP,CPHP,BOCHCK,PEP,PEZ,PEG
      Double Precision POMDGA,EN,PZC,PT,spom,WTGLU,ECM,WT,PT2,XR1,DOT
      Integer I,J,In,NFLAVP,ICHECK,ITCH,IFIXB,MSTJ24,NP,NDFF
      Integer LUCHGE
      Integer KPA2,KPAO,KPAO2,NRN,IPSR,IST,NPFIN,KI,nafl
      Integer iph,NACC
      EXTERNAL draprn,DHFORMF
      DATA QF/0.0D0/,W12/0.0D0/,NFLAVP/0/
      DATA ICHECK/0/
c      IDEBUG = 0
      itch=0
      ifixb=0
      SCAL1 = -99999.
      XPD1 = -99999.
      SCAL2 = -99999.
      XPD2 = -99999.
      MSTJ24 = MSTJ(24)
      MSTJ(24) = 0
      DO 10  IN=1,20
         K(IN,1) = 0
         K(IN,2) = 0
   10 CONTINUE

C...  GIVE BEAM  FOUR VECTORS
      DO 20 I=1,2
         DO 20 J=1,5
            K(I,J)=KBEAM(I,J)
   20 P(I,J) = PBEAM(I,J)
      ME =P(1,5)
      MP =P(2,5)
      NP=3
      N=2
      QF = 0.D0
      NFLAVP = 0
      NDFF = 0
      AM(1) = 0.0D0
      AM(2) = 0.0D0
      NFLAVP = NFLAV
      IF(IHFLA.GE.4) THEN
         KPA = IHFLA
         AM(1) = DBLE(ULMASS(KPA))
         AM(2) = AM(1)
         NFLAVP = IHFLA
      ENDIF

C.. HERE THE LIMITS ON Y( PHOTON ENERGY) AND Q**2 ARE CALCULATED
C... ACCORDING TO PROCEEDINGS OF HERA WORKSHOP 1987
C... ALI ET AL
      W02=(AM(1)+AM(2)+MP)**2
      IF(AM(1).LT.1.0D0) W02=(1.D0 + MP)**2
      W12=W02-MP*MP
      YMAX=SSS+W12+DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
      YMAX=YMAX/(2.D0*(SSS+ME*ME))
      YMIN=SSS+W12-DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
      YMIN=YMIN/(2.D0*(SSS+ME*ME))
      IF(YMI.GT.YMIN) YMIN=YMI
      IF(YMA.LT.YMAX) YMAX=YMA
c         WRITE(6,10000) YMIN,YMAX
c 10000 FORMAT(' limits on y ',/,' YMIN = ',E10.5,' YMAX = ',E10.5)

C ... select particle code for light flavour production according
C ... to charges
      IF(IHFLA.GE.4) THEN
         QF=DFLOAT(LUCHGE(4))**2
         KPA = IHFLA
      ELSE
         QF=DFLOAT(LUCHGE(1))**2 + DFLOAT(LUCHGE(2))**2 + DFLOAT(
     +   LUCHGE(3 ))**2
         QF = 2.D0*QF
         KPA = -4
         QFT = - draprn()*QF
   30    KPA=KPA+1
         QFT = QFT + DBLE(LUCHGE(KPA))**2
         IF(QFT.LT.0.0D0) GOTO 30
         IF(KPA.GT.3) write(6,*) 'fatal light quark = charm!!!!!! ',
     +   KPA
      ENDIF
      KPA2 = - KPA
      IF(IGENFL.EQ.0) THEN
         KPAO = KPA
         KPAO2 = KPA2
c          write(6,*) '0th',kpa,kpa2
      ELSEIF(IGENFL.EQ.1) THEN
         KPA = KPAO
         KPA2 = KPAO2
c         write(6,*) '1st',kpa,kpa2
      ENDIF
      AM(1) = DBLE(ULMASS(KPA))
      AM(2) = AM(1)
c         IF(IDEBUG.EQ.1) write(6,*) 'partdh KPA = ',KPA
c      write(6,*) ' ULMASS ',ULMASS(113),ULMASS(211)
C... YX IS THE PHOTON ENERGY
C... Q2 FROM PHOTON
C... XP2 IS XGLUON ( MOMENTUM FRACTION OF THE GLUON)
C... XMIN = MIN XGLUON TO PRODUCE THE INV. MASS OF GAMMA GLUON SYSTEM
C... XMAX=1.
CCC
C... GENERATE YX,Q2,XP2 ACCORDING TO 1/X SPECTRUM
C... FGAM IS THE WEIGHT OF EPA
      NRN = 0
      IPSR=0
      XMAX=1.d0-XF
      IF(IPSR.EQ.0) THEN
c.......
         IF(KE.NE.22) THEN
            NRN = NRN + 1
            YX = YMIN*((YMAX/YMIN)**X(NRN))
            IF(YX.GT.YMAX.OR.YX.LT.YMIN) GOTO 110
            Q2MIN=ME*ME*YX*YX/(1.D0-YX)
            IF(QMI.GT.Q2MIN) Q2MIN = QMI
            Q2MAX=YX*SSS - W12
            IF(QMA.LT.Q2MAX) Q2MAX = QMA
            IF(Q2MAX.LT.Q2MIN) GOTO 120
            NRN = NRN + 1
            IF(QMI.EQ.0.D0) THEN
               Q2 = Q2MIN*((Q2MAX/Q2MIN)**X(NRN))
            ELSE
c new try weighting with 1/q**4
               Q2 = Q2MIN*Q2MAX/(X(NRN)*Q2MIN + Q2MAX*(1.D0 - X(NRN)))
            ENDIF
c            write(6,*) 'partdh: Q2MIN,Q2MAX,Q2 ',Q2MIN,Q2MAX,Q2
            XMIN = 0.0D0
            SMIN = DMAX1(4.D0*PT2CUT(IPRO),
     +        2.D0*(AM(1)**2+AM(2)**2+AM(3)**2))
            XMIN=(Q2+SMIN)/YX/SSS
         ELSEIF(KE.EQ.22) THEN
            Q2 = 1.D0
            YX = 1.D0
            SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
            IF(IPRO.EQ.100) SMIN = 2.D0*(AM(1)**2+AM(2)**2)
            XMIN=SMIN/(YX*SSS)
         ELSE
            write(6,*) ' wrong KF selected; program stop '
            YX = 0.D0
         ENDIF
         XG1=YX
      ELSE
         YX = 0.D0
         XG1 = 0.D0
      ENDIF
c check for w range
      ww = dsqrt(-q2 + yx*sss)
c      if(ww.lt.50.or.ww.gt.220) goto 300


C ... XP2 = E_glue /E_proton
C ... XX  = E_glue/E_pomeron
C ... XR  = E_pomeron/E_proton
      XP2 = Q2/YX/SSS
      IF(SNGL(XP2).GT.SNGL(XMAX)) GOTO 140
      IF(SNGL(XMIN).GT.SNGL(XMAX)) GOTO 130
c      SHAT1=SSS*XG1*XP2
c      XMCHECK = DMAX1((AM(1)+AM(2))**2,DBLE(ULMASS(113)))
c      IF(SHAT1.LT.XMCHECK) GOTO 150
      ENTRY partdhHS(X,WPART)
      IF(IHERAC.EQ.1) THEN
c test
         MSTJ24 = MSTJ(24)
         MSTJ(24) = 0
         DO 40    IN=1,20
            K(IN,1) = 0
            K(IN,2) = 0
   40    CONTINUE

C...  GIVE BEAM  FOUR VECTORS
         DO 50   I=1,2
            DO 50   J=1,5
               K(I,J)=KBEAM(I,J)
   50    P(I,J) = PBEAM(I,J)
         ME =P(1,5)
         MP =P(2,5)
         NP=2
         N=2
         NFLAVP = NFLAV
         NRN = 2
         MP =P(2,5)
         IPSR=0
         XMAX= 1.d0 -XF
         IST = 0
         YX = YHS
         XP2 = XHS
         Q2 = Q2HS
         XG1 = YX
C ... select particle code for light flavour production according
C ... to charges
         QF=DFLOAT(LUCHGE(1))**2 + DFLOAT(LUCHGE(2))**2 + DFLOAT(
     +   LUCHGE(3))**2
         QF = 2.D0*QF
         KPA = -4
         QFT = - draprn()*QF
   60    KPA=KPA+1
         QFT = QFT + DBLE(LUCHGE(KPA))**2
         IF(QFT.LT.0.0D0) GOTO 60
         IF(KPA.GT.3) write(6,*) 'fatal light quark = charm!!!!!!'
     +   //' ', KPA
         KPA2 = - KPA
c         IF(IDEBUG.EQ.1) write(6,*) 'partdh KPA = ',KPA
c         write(6,*) 'parths ',Q2
c         write(6,*) 'PARTDI SSS ',SSS
C.. HERE THE LIMITS ON Y( PHOTON ENERGY) AND Q**2 ARE CALCULATED
C... ACCORDING TO PROCEEDINGS OF HERA WORKSHOP 1987
C... ALI ET AL
         W02=(1.D0 + MP)**2
         W12=W02-MP*MP
         YMAX=SSS+W12+DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
         YMAX=YMAX/(2.D0*(SSS+ME*ME))
         YMIN=SSS+W12-DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
         YMIN=YMIN/(2.D0*(SSS+ME*ME))
c         write(6,*) ' YX,YHS,YMIN,YMAX ',YX,YHS,ymin,ymax
         IF(YMI.GT.YMIN) YMIN=YMI
         IF(YMA.LT.YMAX) YMAX=YMA
c         IF(YX.GT.YMAX.OR.YX.LT.YMIN) GOTO 260
         IF(IGENFL.EQ.0) THEN
            KPAO = KPA
            KPAO2 = KPA2
         ELSE
            KPA=KPAO
            KPA2 = KPAO2
         ENDIF

         Q2MIN=ME*ME*YX*YX/(1.D0-YX)
         IF(QMI.GT.Q2MIN) Q2MIN = QMI
         Q2MAX=YX*SSS - W12
         IF(QMA.LT.Q2MAX) Q2MAX = QMA
         IF(Q2MAX.LT.Q2MIN) GOTO 120
c         write(6,*) ' PARTDHS: KPA,AM',KPA,AM(1),AM(2)
c         write(6,*) ' here in heracl partdh ',IHERAC
         IF(XP2.GT.XMAX) GOTO 130

      ENDIF

      IST = 0
      YY=SNGL(YX)
      XEL=SNGL(XG1)
      XPR=SNGL(XP2)
      PHI = 99999.D0
      NRN=NRN+1
      PHI = 2.D0*PI*X(NRN)
c      PHI = 2.D0*PI*draprn()
      IF(ICHECK.EQ.1) THEN
         write(6,*) 'partdh  phi random nrn,x(nrn),phi',nrn,x(nrn),
     +   phi
      ENDIF
      IF(ICHECK.EQ.1) THEN
         write(6,*) 'partdh  phi herac phi',phi
      ENDIF

      IF(IPSR.EQ.0) THEN
         CALL PARTI(KE,YX,FGAM,FWEI,1,IST)
      ELSEIF(IPSR.EQ.1) THEN
         WRITE(6,*) ' IPSR = 1 not implemented '
         FGAM = 0.D0
         FWEI = 0.D0
      ELSE
         WRITE(6,*) ' IPSR > 1 not implemented '
         FGAM = 0.D0
         FWEI = 0.D0
      ENDIF
c         write(6,*) 'parths Q2_gen,dot ',Q2,dot1(NIA1,NIA1)
c      write(6,*) ' partdh: iherpys',iherpys
      XX=0.D0
      XR=0.D0
      IRES(2) = 1
C here do some gymnastics to make cut on theta angle of electron
      IF(THEMA.LT.180.D0.OR.THEMI.GE.0.D0) THEN
C go first to ep LAB system
         CALL DUDBRB(3,3,0.D0,0.D0,CM(1)/CM(4),CM(2)/CM(4),CM(3)/CM(4))
         THETE = DPLU(3,14)
         CALL DUDBRB(3,3,0.D0,0.D0,-CM(1)/CM(4),
     +                -CM(2)/CM(4),-CM(3)/CM(4))
c         CALL DULIST(1)
         IF(THETE .GT. 180.01D0) THEN
            WRITE(6,*) ' FATAL: theta_electron > 180 deg ',THETE
         ENDIF
         IF(THETE .GE. THEMA) GOTO 160
         IF(THETE .LE. THEMI) GOTO 160
      ENDIF
      WTDIST = 1.D0
C end of these gymnastics
cc here for fixed beta
      xbj = q2/yx/sss
      IF(ifixb.eq.0) then
         NRN = NRN + 1
         XR = XMIN*(XMAX/XMIN)**X(NRN)
         WTDIST=WTDIST*XR*DLOG(XMAX/XMIN)
c jacobian dM**2 --> d x_pom
         djac = q2/xbj
         WTDIST = WTDIST*DJAC
      else
         beta = 0.1D0
         xr = xp2/beta
      endif
check beta
      beta = xp2/xr
      XPOM = XR
c     write(6,*) beta,xp2,xr
c      if(beta.gt.0.1) goto 300


c end of fixed beta
c      IF(IWEI.EQ.1) THEN
c           write(6,*) ' partdh: XR,X(NRN),NRN ',XR,X(NRN),NRN
c           ENDIF
      IF((XP2/XR).LT.1.D-20) GOTO 170
      XX = XP2/XR
      IF(XX.GT.1.0.OR.XX.LT.0.0) write(6,*) 'partdh xx,xpr,xr',xx,xpr,
     +xr
c      write(6,*) 'partdh xx,xpr,xr',xx,xpr,xr
      IF(ICHECK.EQ.1) THEN
         write(6,*) 'partdh XX,xr,xp2,x(NRN) ',xx,xr,xp2,x(NRN)
      ENDIF
c         IF(XX.GT.0.9999) THEN
c         write(6,*) 'XX>.9999 ',xx,xr,xp2,x(NRN)
c         ENDIF
      T2MIN=MP*MP*XR*XR/(1.D0-XR)
      T2MN = -(Q2 - XR*YX*SSS + 4.D0*DBLE(ULMASS(211))**2)
c         write(6,*) 'partdh : t2mn,t2min,t2max',t2mn,t2min,t2max
      IF(T2MN.LT.T2MAX) THEN
         T2MAX1 = T2MN
      ELSE
         T2MAX1 = T2MAX
      ENDIF

      NDFF = 5
      IF(T2MIN.GE.T2MAX1) THEN
CCC            WRITE(6,*) 'T2MIN=',T2MIN,'.GT.T2MAX1=',T2MAX1
         GOTO 180
      ENDIF
      if(itch.eq.0) then
         NRN = NRN + 1
         T2 = T2MIN * ((T2MAX1/T2MIN)**X(NRN))
C weight for t distribution
         if(wtdist.le.0.) then
            write(6,*) ' partdh: wtdist',wtdist
         endif
         WTDIST=WTDIST*dhformf(-T2)
         WTDIST = WTDIST * T2 *DLOG(T2MAX1/T2MIN)
         if(wtdist.le.0.) then
            write(6,*) ' partdh: t2,T2max1,t2min,form',t2,t2max1,t2min,
     +      dhformf(-T2)
         endif
c       write(6,*) ' partdh: wtdist ',wtdist,t2
      else
         t2 = 0d0
      endif
      IF(ICHECK.EQ.1) THEN
         write(6,*) ' partdh: T2,X(NRN),NRN ',T2,X(NRN),NRN
      ENDIF

c      IF(IWEI.EQ.1) THEN
c          write(6,*) ' partdh: T2,X(NRN),NRN ',T2,X(NRN),NRN
c          ENDIF
      XR1= T2/XR/SSS
      T2=-T2
      T2GKI = SNGL(T2)
      XFGKI = SNGL(XR)
c      write(6,*) ' partdh xpom,xr ',xpom,xr
      IF(DABS(WTDIST).LE.1.D-45) GOTO 190
      COSTP=(1.D0 - XR - XR1*XR)/(1.D0 - XR + XR1*XR)
      IF(COSTP.GT.1.D0) COSTP=1.0D0
      IF(COSTP.LT.-1.D0) COSTP=-1.0D0
C...  COSTP IS SCATTERING ANGLE OF PROTON
      if(itch.eq.0) then
         NRN = NRN + 1
         PHIP=2.D0*PI*X(NRN)
         IF(IGENFL.EQ.0) THEN
c         PHIP=2.D0*PI*X(NRN)
            PHIO = PHIP
         ELSEIF(IGENFL.EQ.1) THEN
            PHIP = PHIO
         ENDIF
      else
         PHIP = 0.D0
         PHIO = PHIP
      endif
c      PHIP = 0.D0
c      IF(IDEBUG.EQ.1) write(6,*) 'partdh: PHIP=',PHIP
      SPHP=DSIN(PHIP)
      CPHP=DCOS(PHIP)

C FINAL STATE PROTON
      NPFIN=NIA1+NDFF
      N=NPFIN
      K(NPFIN,1)=1
      K(NPFIN,2)=KP
      K(NPFIN,3)=2
      P(NPFIN,5)=DBLE(ULMASS(K(NPFIN,2)))
C NEW gymnastics because of numerical precision problems.....

c for construction of  pomeron goto gamma p system
      DBCMS(1)=  P(NIA1,1) + P(2,1)
      DBCMS(2)=  P(NIA1,2) + P(2,2)
      DBCMS(3)=  P(NIA1,3) + P(2,3)
      DBCMS(4)=  P(NIA1,4) + P(2,4)
      BOCHCK = (DBCMS(1)/DBCMS(4))**2 + (DBCMS(2)/DBCMS(4))**2
     +              + (DBCMS(3)/DBCMS(4))**2
      BOCHCK = DSQRT(BOCHCK)
      IF(BOCHCK.GT.0.99999999D0) goto 210

      CALL DUDBRB(0,0,0.D0,0.D0,
     +  -DBCMS(1)/DBCMS(4),-DBCMS(2)/DBCMS(4),
     +  -DBCMS(3)/DBCMS(4))
      SPHI = DLANGL(P(NIA1,1),P(NIA1,2))
      CALL DUDBRB(0,0,0.D0,-sphi,0.d0,0.d0,0.d0)
      STHETA = DLANGL(P(NIA1,3),P(NIA1,1))
      CALL DUDBRB(0,0,-STHETA,0.D0,0.d0,0.d0,0.d0)
c new
      PEP = DSQRT(P(2,3)**2 + DBLE(ULMASS(KP)**2))
      P(2,4) = PEP
      PEZ = ABS(P(2,3))
      PEG = P(NIA1,4)
      PEGZ = DABS(P(NIA1,3))
      POMDGA = XR * YX * SSS/2.D0
      EN= PEZ*(PEGZ*PEZ+PEG*PEP)/(PEZ*PEG+PEP*PEGZ) - ((T2-P(2,5)**2-
     +P(NPFIN,5)**2)*PEGZ/2.D0 + POMDGA*PEZ)/(PEZ*PEG+PEP*PEGZ)
      P(NPFIN,4) = EN
      PZC =       - (PEP*(PEGZ*PEZ+PEG*PEP)/(PEZ*PEG+PEP*PEGZ) +
     +             ((T2-P(2,5)**2-P(NPFIN,5)**2)*PEG/2.D0
     +             - POMDGA*PEP)/(PEZ*PEG+PEP*PEGZ))
      P(NPFIN,3) = PZC
      PT = (-(T2-P(NPFIN,5)**2)*(PEGZ*PEZ+PEG*PEP)**2 + (T2-P(2,5)**2-
     +P(NPFIN,5)**2)**2*Q2/4.D0 -P(NPFIN,5)**2*POMDGA**2 +(T2+P(2,5)**
     +2-P(NPFIN,5)**2)*POMDGA *(PEGZ*PEZ+PEG*PEP) )/(PEZ*PEG+PEGZ*PEP)*
     +*2 - P(2,5)**2
      P(NPFIN,1) = DSQRT(DMAX1(0.D0,PT))*CPHP
      P(NPFIN,2) = DSQRT(DMAX1(0.D0,PT))*SPHP
      CALL DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
      CALL DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
      CALL DUDBRB(0,0,0.D0,0.D0,
     +  DBCMS(1)/DBCMS(4),DBCMS(2)/DBCMS(4),
     +  DBCMS(3)/DBCMS(4))
c end new

C end of these gymnastics

C MOMENTA OF POMERON
      K(NIA1+1,1)=21
      K(NIA1+1,2)=KINT(2,2)
      K(NIA1+1,3)=2
      DO 70  KI=1,4
         P(NIA1+1,KI)=P(2,KI)-P(NPFIN,KI)
   70 CONTINUE
      P(NIA1+1,5)=-sqrt(ABS(DOT1(NIA1+1,NIA1+1)))
      T2GKI=-SNGL(P(NIA1+1,5)**2)
c      IF(IDEBUG.EQ.1) THEN
c         write(6,*) ' partdh: T2GKI,T2 ',T2GKI,T2
c         write(6,*) ' partdh: yx=',yx,dot1(nia1,2)/dot1(1,2)
c         write(6,*) ' partdh: xr=',xr,dot1(nia1,nia1+1)/dot1(nia1,2)
c      ENDIF
c for construction of parton in pomeron goto gamma pomeron system
      DBCMS(1)=  P(NIA1,1) + P(NIA1+1,1)
      DBCMS(2)=  P(NIA1,2) + P(NIA1+1,2)
      DBCMS(3)=  P(NIA1,3) + P(NIA1+1,3)
      DBCMS(4)=  P(NIA1,4) + P(NIA1+1,4)
      spom = dot(dbcms,dbcms)
c      IF(IWEI.EQ.1) write(6,*) ' partdh: SPOM= ',spom
      IF(SPOM.LT.0.0D0) GOTO 230
      BOCHCK = (DBCMS(1)/DBCMS(4))**2 + (DBCMS(2)/DBCMS(4))**2
     +              + (DBCMS(3)/DBCMS(4))**2
      BOCHCK = DSQRT(BOCHCK)
      IF(BOCHCK.GT.0.99999999D0) goto 210

      CALL DUDBRB(NIA1,NIA1+4,0.D0,0.D0,
     +  -DBCMS(1)/DBCMS(4),-DBCMS(2)/DBCMS(4),
     +  -DBCMS(3)/DBCMS(4))
      SPHI = DLANGL(P(NIA1,1),P(NIA1,2))
      CALL DUDBRB(NIA1,NIA1+4,0.D0,-sphi,0.d0,0.d0,0.d0)
      STHETA = DLANGL(P(NIA1,3),P(NIA1,1))
      CALL DUDBRB(NIA1,NIA1+4,-STHETA,0.d0,0.d0,0.d0,0.d0)
c            if(xpr.ne.xx*xfgki) write(6,*) xpr,xfgki*xx,xfgki,xx
c            if(iwei.eq.1) call HF1(301,sngl(xx),1.)
c            if(iwei.eq.1) write(6,*) 'partdh: beta = ',xx
C... WTGLU IS THE WEIGHT FOR XGLUON GENERATION
      WTGLU = 0.D0
c           write(6,*) ' partdh: NFLAV ',NFLAVP
      nafl =0
      DO 80 I=1,NFLAVP
         IF(INTER.LT.2) THEN
            IF(SPOM.LT.(4.*ULMASS(I)**2)) GOTO 80
         ELSEIF(INTER.EQ.2) THEN
            IF(I.GE.(NFLAVP+1)) GOTO 80
            IF(SPOM.LT.((ULMASS(I)+ULMASS(I+1))**2)) GOTO 80
         ENDIF
         NAFL = I
   80 CONTINUE
      if(nafl.le.0) then
         write(6,*) ' partdh: spom ',spom,nafl,nflavp,nflav
      endif
      KPA = KPAO
      SCAL2 = SNGL(Q2Q)
      IF(IPRO.EQ.20) THEN
         NF1=NIA1+2
         NF2=NIA1+4
         K(NF1,1)=2
         K(NF1,2)=KPA
         K(NF1,3)=NIA1
         K(NF2,1)=1
         K(NF2,2)=KPA2
         K(NF2,3)=NIA1
         IJOIN(1)=NF1
         IJOIN(3) = NF2
         IJOIN(2) = NF1+1
         NJOIN=3
C
         K(NF1+1,1)=2
         K(NF1+1,2)=KGL
         K(NF1+1,3)=NIA1
      ELSEIF(IPRO.EQ.21) THEN
         NF1=NIA1+2
         NF2=NIA1+3
         K(NF1,1)=2
         K(NF1,2)=KPA
         K(NF1,3)=NIA1
         K(NF2,1)=1
         K(NF2,2)=KPA2
         K(NF2,3)=NIA1
         IJOIN(1)=NF1
         IJOIN(2) = NF2
         NJOIN=2
      ENDIF
      CALL LUJOIN(NJOIN,IJOIN)

      DO 90  I=1,4
         P(NF1,I)=0.0D0
         P(NF1+1,I)=0.0D0
         P(NF2,I)=0.0D0
   90 CONTINUE
      SHAT=DOT(DBCMS,DBCMS)
      IF(SHAT.LE.0.0) THEN
         GOTO 240
      ENDIF

C NOW  LOOK THAT WE REALLY HAVE ENOUGH ENERGY IN GAMMA GLUON CMS SYSTEM
C...  ECM = CMS ENERGY OF GAMMA GLUON SYSTEM
      ECM =DSQRT(SHAT)
      IF(ECM.LE.(AM(1)+AM(2)+AM(3))) GOTO 250
c      write(6,*) ' ECM  ',ECM,AM(1),AM(2)
c          write(6,*) 'partdh:',x(nrn-1),x(nrn),nrn,ndim
      IF(IPRO.EQ.20) THEN
         iph=1
         if(iph.eq.0) then
            NRN=NRN+1
            XY(1)=X(NRN)
            NRN=NRN+1
            XY(2)=X(NRN)
            NRN=NRN+1
            XY(3)=X(NRN)
            NRN=NRN+1
            XY(4)=X(NRN)
            NRN=NRN+1
            XY(5)=X(NRN)
         else
c            XY(1)=draprn()
c            XY(2)=draprn()
c            XY(3)=draprn()
c            XY(4)=draprn()
c            XY(5)=draprn()
            NRN=NRN+1
            XY(1)=X(NRN)
c this is for alpha2
            NRN=NRN+1
            XY(2)=X(NRN)
c this is for mass m**2
            NRN=NRN+1
            XY(3)=X(NRN)
            NRN=NRN+1
            XY(4)=X(NRN)
            NRN=NRN+1
            XY(5)=X(NRN)

         endif
         NP = 3
      ELSEIF(IPRO.EQ.21) THEN
         NRN=NRN+1
         XY(1)=X(NRN)
         NRN=NRN+1
         XY(2)=X(NRN)
         NP = 2
      ENDIF
ccc          write(6,*) 'partdh:',nrn,ndim
      CALL PHASE(NP,ECM,AM,PCM,WT)
      IF(WT.LE.0.D0) GOTO 260
c         write(6,*) ' partdh phase 1sr :',WT,XY(2)*DLOG(1.D0/SIMIN)
c         write(6,*) ' partdh phase AM:',am(1),am(2)
      DO 100 I=1,4
         IF(IPRO.EQ.20) THEN
            P(NF1,I)=PCM(I,2)
            P(NF1+1,I)=PCM(I,1)
            P(NF2,I)=PCM(I,3)
            P(NF1,5)=AM(1)
            P(NF2,5)=AM(2)
         ELSEIF(IPRO.EQ.21) THEN
            P(NF1,I)=PCM(I,1)
            P(NF2,I)=PCM(I,2)
            P(NF1,5)=AM(1)
            P(NF2,5)=AM(2)
         ENDIF

  100 CONTINUE
      if(pcm(1,2).ne.pcm(1,2)) then
         call dulist(1)
      endif
      IF(IPRO.EQ.21) THEN
         PT2 = DPLU(NF2,9)
         CALL CUTG(PT2,NACC)
         IF(NACC.EQ.0) GOTO 270
c get weight correction from d cost --> d k_T**2
c include factor 1/2 because from cost integration two possible states
c count for pt**2 i.e. cost and -cost
c         write(6,*) ' partdh WT,1/8pi ',WT,1/(8*PI)
         WT = (8.D0*PI*DABS(P(NF2,3))*DSQRT(PT2+P(NF2,3)**2))/2.D0
      ELSEIF(IPRO.EQ.20) THEN
         IF(Iqqg.eq.0) Then
            PT2 = DPLU(NF1+1,9)
            CALL CUTG(PT2,NACC)
            IF(NACC.EQ.0) GOTO 270
         Endif
c now the other cuts are moved to eleqqg
      ENDIF
      CALL DUDBRB(NIA1,NIA1+4,STHETA,0.D0,0.d0,0.d0,0.d0)
      CALL DUDBRB(NIA1,NIA1+4,0.D0,sphi,0.d0,0.d0,0.d0)
      CALL DUDBRB(NIA1,NIA1+4,0.D0,0.D0,DBCMS(1)/DBCMS(4),
     +  DBCMS(2)/DBCMS(4),DBCMS(3)/DBCMS(4))
c      write(6,*) ' partdh before last boost'
c       call dulist(1)

C BOOST BACK TO OVERALL CMS ( now done in FXN1 )
c      call DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
c      call DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
c      write(6,*) ' end of partdh '
c       call dulist(1)
      XPR = SNGL(XP2)
      WPART=WTDIST*FWEI*WT
      PT2H = SNGL(PT2)
      SHH = SNGL(SHAT)

      NDIMC = NRN
      CALL DUEDIT(12)
      IF(WPART.LT.0.D0) THEN
         WRITE(6,*) ' WPART < 0 '
         WRITE(6,*) ' WTGLU = ',WTGLU,' FWEI = ',FWEI
         WRITE(6,*) ' WT = ',WT, 'WTDIST = ',WTDIST
         WRITE(6,*) ' NAFL =',nafl,' x = ',xpr,' xpom =',xr,' xx=',xx
      ENDIF
      IF(IGENFL.EQ.0) THEN
         KPAO = KPA
         KPAO2 = KPA2
c         write(6,*) '2nd ', kpa, kpa2
      ELSE
         KPA = KPAO
         KPA2 = KPAO2
c         write(6,*) '3rd ', kpa, kpa2
      ENDIF
c      write(6,*) 'partdh wpart,q2,xp2,yy,ipro',wpart,q2,xp2,q2q,yy,ipro
c         WRITE(6,*) 'partdh igenfl,imix,iwei ',igenfl,imix,iwei
      MSTJ(24) = MSTJ24
c      if(iwei.eq.1)      write(6,*) kpa,kpa2
c      call lulist(1)
      RETURN
  110 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: ylimit ; RETURN ',yx,ymin,ymax,x(1)
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  120 CONTINUE
      WPART = 0.D0
      IF(IWEI.EQ.1)
     +   write(6,*) ' partdh: Q2limit ; RETURN ',Q2,Q2MIN,Q2MAX
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: Q2limit ; RETURN ',Q2,Q2MIN,Q2MAX
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  130 CONTINUE
      WPART = 0.D0
c      IF(IWEI.EQ.1)
c     +write(6,*) ' partdh: xlimit ; RETURN xmin,xmax',xmin,xmax,IPRO
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: xlimit ; RETURN xmin,xmax',xmin,xmax,
     +   IPRO
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  140 CONTINUE
      WPART = 0.D0
c      write(6,*) ' partdh: xp2 limit ; RETURN ',xp2,xmax,xmin,IPRO
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: xp2 limit ; RETURN ',xp2,xmax,xmin,IPRO
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  150 CONTINUE
      WPART = 0.D0
c      IF(IWEI.EQ.1)
c     +write(6,*) ' partdh: slimit ; RETURN '
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: slimit ; RETURN ',xg1,xp2
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  160 CONTINUE
      WPART = 0.D0
c      IF(IWEI.EQ.1)
c     +write(6,*) ' partdh: theta limit ; RETURN '
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: theta limit ; RETURN '
      ENDIF
      IF(IHERAC.EQ.1) THEN
         NTHRE = NTHRE +1
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  170 CONTINUE
      WPART = 0.D0
c      write(6,*) ' partdh: xp2/xx limit ; RETURN ',IPRO
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: xp2/xx limit ; RETURN ',IPRO
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  180 CONTINUE
      WPART = 0.D0
c      write(6,*) ' partdh: tlimit ; RETURN '
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: tlimit ; RETURN ',T2,T2MIN,T2MAX1
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  190 CONTINUE
      WPART = 0.D0
c      IF(IWEI.EQ.1)
c     +write(6,*) ' partdh: wtdist limit ; RETURN ',WTDIST
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: wtdist limit ; RETURN ',WTDIST
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  200 CONTINUE
      WPART = 0.D0
c      IF(IWEI.EQ.1)
c     +write(6,*) ' partdh: wtglu limit ; RETURN ',WTGLU
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: wtglu limit ; RETURN '
         write(6,*) ' partdh: WTGLU,nafl,nflavp,spom',
     +   WTGLU,nafl,nflavp,spom
         write(6,*) ' partdh: xr,q2,xbj,t2',xr,q2,xp2,t2
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  210 CONTINUE
      WPART = 0.D0

      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: bochck limit,pom ; RETURN ',BOCHCK,NDIM,
     +   NRN
         write(6,*) ' bochk:   P(NIA1,I)',(P(NIA1,I),I=1,4)
         write(6,*) ' bochk: P(NIA1+1,I)',(P(NIA1+1,I),I=1,4)
         write(6,*) ' bochk: DBCMS ',DBCMS
         write(6,*) ' bochk: X ',X
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  220 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: bochck limit, phase ; RETURN '
         write(6,*) ' bochk:   P(NIA1,I)',(P(NIA1,I),I=1,4)
         write(6,*) ' bochk: P(NIA1+1,I)',(P(NIA1+1,I),I=1,4)
         write(6,*) ' bochk: X ',X
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  230 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: spom=',spom,' test =',
     +   (-Q2+xr*yx*sss+t2)
c         write(6,*) ' partdh: nia1,nia1+1 ',nia1,nia1+1
         write(6,*) ' partdh: yx=',yx,dot1(nia1,2)/dot1(1,2)
         write(6,*) ' partdh: xr=',xr,dot1(nia1,nia1+1)/dot1(nia1,2)
         write(6,*) ' partdh: x_bj = ',xpr
c         write(6,*) 'partdh: 2gamma pom ',2*dot1(nia1,nia1+1),
c     +    xr*yx*sss
         write(6,*) ' partdh: Q2 ',Q2,dot1(nia1,nia1)
         write(6,*) ' partdh: T2 ',T2,T2min,T2max1
c         write(6,*) ' partdh:  test',(-Q2+dot1(nia1,nia1+1)/dot1(nia1,2)
c     +    *yx*sss+t2)
c        call lulist(1)
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  240 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: shat ; RETURN :x_bj',xpr,'x_pom',xr
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  250 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: ECM limit ; RETURN ',ECM,AM(1),AM(2)
         write(6,*) ' partdh: ecm_min ',dsqrt(-q2+xmin*yx*sss),xmin
      ENDIF
      MSTJ(24) = MSTJ24
      NDIMC = 9999
      RETURN
  260 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: PHASE wt=0 ; RETURN '
      ENDIF
      MSTJ(24) = MSTJ24
      NDIMC = 9999
      RETURN

  270 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: PTCUT limit ;RETURN ',PT2,PT2CUT(IPRO),
     +   IPRO
      ENDIF

      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  280 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) '350 partdh: shat;RETURN ',shat,ulmass(211),
     +   ulmass(kpa),nflav,nflavp
         write(6,*) '350 partdh: shat ; RETURN :x_bj',xpr,'x_pom',xr
         write(6,*) '350 partdh: shat,spom',shat,spom,kpa,ipro
      endif
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  290 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: VM_mass check ',IVM,SPOM
      ENDIF
      IF(IHERAC.EQ.1) THEN
         NVMRE = NVMRE +1
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
  300 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdh: w chech '
      ENDIF
      NDIMC = 9999
      MSTJ(24) = MSTJ24
      RETURN
      END
*CMZ :  2.08/04 17/01/2000  13.14.18  by  Hannes Jung
*CMZ :  2.08/02 08/09/99  17.06.07  by  Hannes Jung
*CMZ :  2.08/00 14/06/99  19.13.57  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  17.26.32  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE ELEQQG(WT1)
C
C    e p  ----> Q Q_BAR GLUON p
C
C         P1(G)-----//////--------Q1(q)
C                  ////////
C         P2(PH)-----//////--------Q2(q_bar)
C
C    full martix element
      implicit none
*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGPQCDPOM.
      Integer Iqqg
	COMMON/pqcdpom/ Iqqg
C     SAVE


*KEND.
      DOUBLE PRECISION P0E(4),P2E(4),P3E(4)
      DOUBLE PRECISION PK1,PK2,PK3,PL
      COMMON /QQG/ PK1(4),PK2(4),PK3(4),PL(4)
      DOUBLE PRECISION QPR(4),PP(4)
      DOUBLE PRECISION a1ma1,Q2_c
      COMMON /QQG_CON/a1ma1,Q2_c
      DOUBLE PRECISION DBW2(4),DBMX(4)
      DOUBLE PRECISION STHETA,SPHI
      DOUBLE PRECISION MX2,M2,K12,K1K2,K22
      DOUBLE PRECISION WMAX
      INTEGER IMIX
      COMMON /OALPHAS/ WMAX,IMIX
      INTEGER IGENFL
      COMMON/GENWEI/IGENFL
      DOUBLE PRECISION XPOM
      COMMON/BARTELS/XPOM
      DOUBLE PRECISION WT1,sigdt_p,sigdt_m,sigdl,sigdi,WT2
      DOUBLE PRECISION alpha1,beta2,PREF,ALPH_EM,ALP,Y,W2,XB
      DOUBLE PRECISION m2bs,alpha2,beta1,a21ma2
      REAL SNGL
      REAL SLO,SHI,XEPS,EPS
      REAL SUMM11,XM11,SUMM21,XM21
      REAL SUMM12,XM12,SUMM22,XM22
      REAL SUMM1,XM1
      REAL SUMM2,XM2
      REAL FIL,FIU
      REAL L2MIN,L2MAX
      DOUBLE PRECISION DOT
      INTEGER I,iphase
      COMMON /QQG_C/L2MIN,L2MAX
      Double Precision   sst,betat,xppt,t,qqt
      common   /parameter/ sst,qqt,betat,xppt,t
      Double Precision DK,th,uh,qf2,k22fr
      EXTERNAL SUMM11,SUMM21,SUMM12,SUMM22,SUMM1,SUMM2
      EXTERNAL FIL,FIU,DOT,DK
      Double Precision D_XGX,glu,xglu,ksi,xcorr,alphas
      Double Precision FACQ2,beta,z,arg,Coeff,m2cc,mq2
      EXTERNAL ALPHAS,D_XGX,XGLU
cc iphase = 1 only phase space
c      iphase = 1
c iphase = 0 x section
      iphase = 0
      t = dble(t2gki)
      WT1 = 0.D0
      WT2 = 0.d0
      XEPS = 0.05
      SLO = 0.
      SHI = 1.
      L2MIN = 1.
      L2MIN = 0.3
      L2MAX = 1000.
      Q2_c = Q2
      WT1 = 0.0D0
      y = DBLE(YY)
      Xb = Q2/Y/SSS
c         xb = Q2/(W2 + Q2)
      ALPH_EM = ALPH
      IF(IRUNAEM.EQ.1) ALPH_EM = DBLE(ULALEM(SNGL(Q2)))
      DBMX(1)=  P(NIA1,1) + P(NIA1+1,1)
      DBMX(2)=  P(NIA1,2) + P(NIA1+1,2)
      DBMX(3)=  P(NIA1,3) + P(NIA1+1,3)
      DBMX(4)=  P(NIA1,4) + P(NIA1+1,4)
      MX2=DOT(DBMX,DBMX)
c  goto gamma p system
      DBW2(1)=  P(NIA1,1) + P(2,1)
      DBW2(2)=  P(NIA1,2) + P(2,2)
      DBW2(3)=  P(NIA1,3) + P(2,3)
      DBW2(4)=  P(NIA1,4) + P(2,4)
      W2=DOT(DBW2,DBW2)
c  goto gamma pom system
      DBW2(1)=  P(NIA1,1) + P(NIA1+1,1)
      DBW2(2)=  P(NIA1,2) + P(NIA1+1,2)
      DBW2(3)=  P(NIA1,3) + P(NIA1+1,3)
      DBW2(4)=  P(NIA1,4) + P(NIA1+1,4)

      CALL DUDBRB(0,0,0.D0,0.D0,
     +  -DBW2(1)/DBW2(4),-DBW2(2)/DBW2(4),
     +  -DBW2(3)/DBw2(4))
      SPHI = DLANGL(P(NIA1,1),P(NIA1,2))
      CALL DUDBRB(0,0,0.D0,-sphi,0.d0,0.d0,0.d0)
      STHETA = DLANGL(P(NIA1,3),P(NIA1,1))
      CALL DUDBRB(0,0,-STHETA,0.D0,0.d0,0.d0,0.d0)
c      call dulist(1)
      DO 10 I=1,4
         P0E(I) = P(1,I)
         P2E(I) = p(nia1,I)
         P3E(I) = p(nia2,I)
         PK3(I) = P(NF1,I)
         PK2(I) = P(NF1+1,I)
         PK1(I) = P(NF2,I)
         QPR(I) = P(NIA1,I) + XB*P(2,I)
         PP(I) = P(2,I)
   10 continue
      th = -Q2 - 2.d0*DOT(P2E,PK3) + P(NF1,5)**2
      uh = -Q2 - 2.D0*DOT(P2E,PK1) + P(NF2,5)**2
      beta2 = 2.D0*DOT(PK2,QPR)/(W2+Q2)
      beta1 = 2.D0*DOT(PK1,QPR)/(W2+Q2)
c     write(6,*) 'q"2 ',dot(qpr,qpr)
      alpha1 = 2.D0*DOT(PK1,PP)/(W2+Q2)
      alpha2 = 2.D0*DOT(PK2,PP)/(W2+Q2)
      m2 = DOT(PK3,PK3) + 2.D0*DOT(PK3,PK1) + DOT(PK1,PK1)
      m2 = 2.D0*DOT(PK3,PK1)
c      call dulist(1)
      if(m2.lt.1.d0) goto 50
      K12 = PK1(1)**2 + PK1(2)**2
      K22 = PK2(1)**2 + PK2(2)**2
      IF(IHFLA.GE.4) THEN
         K12 = K12 + P(NF2,5)**2
      ENDIF

      K1K2 = (PK1(1)+PK2(1))**2 + (PK1(2) + PK2(2))**2


      m2bs = MX2 - beta2 * W2
c alp = alphas fixed
      ALP = 0.25D0

      IF(alpha1.gt.1.D0.or.alpha1.lt.0.D0) THEN
         write(6,*) ' alpha1 = ',alpha1
c      write(6,*) ' K1**2 = ',K12
c      write(6,*) ' (K1+K2)**2 = ',K1K2
c      write(6,*) ' M_X**2, m**2,W**2 ',MX2,m2,W2
c      call dulist(1)
         GOTO 40
      ENDIF
c a1ma1 = alpha(1-alpha)
      a1ma1 = alpha1*(1.d0 -alpha1)
c a21ma2 = alpha^2 + (1-alpha)^2
      a21ma2=alpha1**2 + (1.d0-alpha1)**2
c now here the rest of cuts...
      If(Iqqg.eq.0) Then
         if(dabs(th).lt.pt2cut(ipro)) goto 40
         if(dabs(uh).lt.pt2cut(ipro)) goto 40
      Endif
c this cut is essential for the approximation used
      if(pk2(3).GT.0.D0) goto 40
c
      if (iphase.eq.1) goto 30
c select here approximate formula or full integration
      If(Iqqg.ge.1) then
         XM11 = 0.
         Xm22 = 0.
         Xm12 = 0.
         Xm21 = 0.
         XM1 = 0.
         XM2 = 0.
c cuts on pt
         if(K12.lt.pt2cut(ipro).AND.IHFLA.LE.3) goto 20
         if(k12.GT.m2/4.d0) goto 20
         if(k22.lt.0.001) goto 20
c alp = alphas running
         Q2Q = K12
         ALP = ALPHAS(DSQRT(Q2Q))
         k22fr = k22+0.04D0
         m2 = m2bs
cccc         ksi = dmax1(k22fr,1.d0)
         ksi = dmax1(k22fr*(MX2+Q2)/(MX2-m2),1.d0)
cccc         ALP = ALPHAS(DSQRT(ksi))
         ALP = ALPHAS(DSQRT(k12))
         glu = xglu(xpom,ksi)
         Facq2 = (Q2**2+m2**2)/(Q2+m2)**4
c        write(6,*) ' stand. Facq2 ',Facq2
         mq2 = 0.d0
         IF(IHFLA.ge.4) then
            z= (Q2 + m2)/(Q2 + MX2)
            beta = Q2/(Q2 + MX2)
            arg = beta/z
            Facq2= 2.d0*arg**2/Q2**2
c test with standard AP splitting fct
            Coeff = (arg**2 + (1.d0 -arg)**2)/2.d0
c now with heavy quark splitting fct
c acc. eq.(16) in Ellis,Sexton Nucl.Phys.B282(1987) 642
            m2cc = DOT(PK3,PK3) + 2.D0*DOT(PK3,PK1) + DOT(PK1,PK1)
            Coeff = (arg**2 + (1.d0 -arg)**2 + 2.d0*AM(1)**2/m2cc)/
     +      2.d0
c            rr=AM(1)**2/Q2
c        sqrtv=dsqrt(1.d0-4.d0*am(1)**2*arg/Q2/(1.d0-arg))
c        Coeff = (arg**2 + (1.d0 -arg)**2 +
c     &  4.d0*arg*(1.d0-3.d0*arg)*rr )*
c     &  dlog((1.d0+sqrtv)/(1.d0-sqrtv)) +
c     &      sqrtv*(-1.d0 + 4.d0*arg*(1.d0 - arg) -
c     &      4.d0*arg*(1.d0-arg)*rr)
            Facq2 = Facq2 * Coeff
            ALP = ALPHAS(DSQRT(k12)+2.d0*AM(1))
            mq2 = AM(1)**2
c        write(6,*) mq2,am(1)
c           write(6,*) ' new   Facq2 ',Facq2
         ENDIF
         XM11= SNGL(8.D0* Facq2 * (m2/k12+mq2)**2 /k22fr**2)
c add additional term
         IF(Iqqg.eq.2) Then
            XCORR = ((MX2 - m2)/(MX2+Q2))**4 * ((MX2+2.d0*m2+3.d0*Q2)/
     +      (MX2+Q2))**2
         ELSE
            XCORR = 1.D0
         ENDIF
         XM11 = XM11*SNGL(glu**2 * XCORR)
c apply a factor of 2 because we have two solutions to eq.(2.18)
         XM11 = 2.*XM11
         XM11 = SQRT(XM11)
         XM22 = XM11
c the following lines are essential for the approximation used here
c a1ma1 = alpha(1-alpha)
         a1ma1 = (k12+mq2)/m2
c a21ma2 = alpha^2 + (1-alpha)^2
         a21ma2 = 1.D0 - 2.D0*(k12+mq2)/m2
   20    Continue
      elseif(iqqg.eq.0) then
c calculate integral over l
         EPS = XEPS
         CALL GADAP2(SLO,SHI,FIL,FIU,SUMM11,EPS,XM11)
c      write(6,*) ' integral XM11 ',XM11
         EPS = XEPS
         CALL GADAP2(SLO,SHI,FIL,FIU,SUMM21,EPS,XM21)
c      write(6,*) ' integral XM21 ',XM21
         EPS = XEPS
         CALL GADAP2(SLO,SHI,FIL,FIU,SUMM12,EPS,XM12)
c      write(6,*) ' integral XM12 ',XM12
         EPS = XEPS
         CALL GADAP2(SLO,SHI,FIL,FIU,SUMM22,EPS,XM22)
c      write(6,*) ' integral XM22 ',XM22
         EPS = XEPS
         CALL GADAP2(SLO,SHI,FIL,FIU,SUMM1,EPS,XM1)
c      write(6,*) ' integral XM1 ',XM1
         EPS = XEPS
         CALL GADAP2(SLO,SHI,FIL,FIU,SUMM2,EPS,XM2)
c      write(6,*) ' integral XM2 ',XM2
      endif
   30 continue
c new prefactor for the use with lorentz invariant phase space
c according to mark
      Pref = 9.d0/32.D0/PI
c sum over light charges = 2/3
      IF(IHFLA.LE.3) THEN
         QF2 = 2.D0/3.D0
      ELSEIF(IHFLA.EQ.4) THEN
         QF2 = 4.D0/9.D0
      ELSEIF(IHFLA.EQ.5) THEN
         QF2 = 1.D0/9.D0
      ENDIF
      Pref = Pref*QF2*ALPH_EM*ALP**3
      sigdt_p = Pref*a21ma2*a1ma1* dble(XM11*
     +XM11+XM12*XM12+XM21*XM21+XM22*XM22)

      sigdt_m = Pref*a1ma1**2*
     +dble(XM11*XM11+XM12*XM12-XM21*XM21-XM22*XM22)
      sigdl = Pref*4.D0*a1ma1**3*Q2*dble(XM1*XM1+XM2*XM2)
      sigdi = Pref*a1ma1**2*(1.D0-2.D0*alpha1)*0.5D0*DSQRT(Q2)*
     +DBLE(XM11*XM1+XM12*XM2+XM1*XM11+XM2*XM22)
      if(iphase.eq.1) then
         sigdt_p =1.D0
         sigdt_m =0
         sigdl = 0
         sigdi = 0
      endif
c      write(6,*) ' pi,m2,beta2 ',pi,m2,beta2
c      write(6,*) ' Pref ',Pref,a1ma1
c      write(6,*) 'sigdt_p ',sigdt_p
c      write(6,*) 'sigdt_m ',sigdt_m
c      write(6,*) 'sigdl ',sigdl
c      write(6,*) 'sigdi ',sigdi
      wt1 = alph_em/2.d0/y/Q2/pi**2*( (1.d0 + (1.d0 - y)**2)/2.d0 *
     +sigdt_p - 2.d0*(1.d0 - y) * sigdt_m + (1.d0 - y) * sigdl + (2.d0
     +-y)*dsqrt(1.d0 - y)*sigdi)
c         write(6,*) ' wt1  ',wt1
      IF(WT1.LT.0) THEN
	   wt1  = 0.
c         write(6,*) ' wt1  ',wt1
c         write(6,*) ' a21ma2 ',a21ma2,a1ma1
c         write(6,*) 'sigdt_p ',sigdt_p
c         write(6,*) 'sigdt_m ',sigdt_m
c         write(6,*) 'sigdl ',sigdl
c         write(6,*) 'sigdi ',sigdi
      ENDIF
      IF(WT1.ne.wt1) THEN
         write(6,*) ' error wt1  ',wt1
      ENDIF
      WT2 = WT2 + WT1
   40 CONTINUE
   50 CONTINUE
c      write(6,*) ' wt1  ',wt1
c      write(6,*) ' end eleqqg '
c      call dulist(1)
      CALL DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
      CALL DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
      CALL DUDBRB(0,0,0.D0,0.D0,
     +  DBW2(1)/DBW2(4),DBW2(2)/DBW2(4),
     +  DBW2(3)/DBW2(4))
      WT1 = WT2
      RETURN
      END
      FUNCTION SUMM11(X,PHI)
      implicit none
*KEEP,RGPARAM.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
*KEND.
      REAL SUMM11,X,PHI
      DOUBLE PRECISION TIL,F_G,Y,WT
      DOUBLE PRECISION PK1,PK2,PK3,PL
      COMMON /QQG/ PK1(4),PK2(4),PK3(4),PL(4)
      REAL L2MIN,L2MAX
      COMMON /QQG_C/L2MIN,L2MAX
      EXTERNAL TIL,F_G
      Y = DBLE(L2MIN*(L2MAX/L2MIN)**X)
      WT = Y *DBLE(LOG(L2MAX/L2MIN))
      WT = WT/PI
c  phi dep
      PL(1) = DSQRT(Y)*DBLE(COS(PHI))
      PL(2) = DSQRT(Y)*DBLE(SIN(PHI))
      SUMM11 = sngl(WT*TIL(1,1)*F_G(Y)/Y)
c          write(6,*) ' summ11 x,phi ',summ11,x,phi
      IF(SUMM11.LT.0.) THEN
c         write(6,*) ' summ11 x,phi ',x,phi
c         write(6,*) 'TIL(1,1),F_G(Y) ',TIL(1,1),F_G(Y)
      ENDIF
      RETURN
      END
      FUNCTION SUMM12(X,PHI)
      implicit none
*KEEP,RGPARAM.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
*KEND.
      REAL SUMM12,X,PHI
      DOUBLE PRECISION TIL,F_G,Y,WT
      DOUBLE PRECISION PK1,PK2,PK3,PL
      COMMON /QQG/ PK1(4),PK2(4),PK3(4),PL(4)
      REAL L2MIN,L2MAX
      COMMON /QQG_C/L2MIN,L2MAX
      EXTERNAL TIL,F_G
      Y = DBLE(L2MIN*(L2MAX/L2MIN)**X)
      WT = Y *DBLE(LOG(L2MAX/L2MIN))
      WT = WT/PI
      PL(1) = DSQRT(Y)*DBLE(COS(PHI))
      PL(2) = DSQRT(Y)*DBLE(SIN(PHI))
      SUMM12 = SNGL(WT *TIL(1,2) * F_G(Y)/Y)
c         write(6,*) ' F_G(Y),Y ',F_G(Y),Y
      IF(SUMM12.LT.0.) THEN
c         write(6,*) ' summ12 x,phi ',x,phi
c         write(6,*) 'TIL(1,2),F_G(Y) ',TIL(1,2),F_G(Y)
      ENDIF
      RETURN
      END
      FUNCTION SUMM21(X,PHI)
      implicit none
*KEEP,RGPARAM.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
*KEND.
      REAL SUMM21,X,PHI
      DOUBLE PRECISION TIL,F_G,Y,WT
      DOUBLE PRECISION PK1,PK2,PK3,PL
      COMMON /QQG/ PK1(4),PK2(4),PK3(4),PL(4)
      REAL L2MIN,L2MAX
      COMMON /QQG_C/L2MIN,L2MAX
      EXTERNAL TIL,F_G
      Y = DBLE(L2MIN*(L2MAX/L2MIN)**X)
      WT = Y *DBLE(LOG(L2MAX/L2MIN))
      WT = WT/PI
      PL(1) = DSQRT(Y)*DBLE(COS(PHI))
      PL(2) = DSQRT(Y)*DBLE(SIN(PHI))
      SUMM21 = SNGL(WT * TIL(2,1) * F_G(Y)/Y)
      IF(SUMM21.LT.0.) THEN
c         write(6,*) ' summ21 x,phi ',x,phi
c         write(6,*) ' TIL(2,1),F_G(Y) ',TIL(2,1),F_G(Y)
      ENDIF
      RETURN
      END
      FUNCTION SUMM22(X,PHI)
*KEEP,RGPARAM.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
*KEND.
      REAL SUMM22,X,PHI
      DOUBLE PRECISION TIL,F_G,Y,WT
      DOUBLE PRECISION PK1,PK2,PK3,PL
      COMMON /QQG/ PK1(4),PK2(4),PK3(4),PL(4)
      REAL L2MIN,L2MAX
      COMMON /QQG_C/L2MIN,L2MAX
      EXTERNAL TIL,F_G
      Y = DBLE(L2MIN*(L2MAX/L2MIN)**X)
      WT = Y *DBLE(LOG(L2MAX/L2MIN))
      WT = WT/PI
      PL(1) = DSQRT(Y)*DBLE(COS(PHI))
      PL(2) = DSQRT(Y)*DBLE(SIN(PHI))
      SUMM22 = SNGL(WT * TIL(2,2) * F_G(Y)/Y)
      IF(SUMM22.LT.0.) THEN
c         write(6,*) ' summ22 x,phi ',x,phi
c         write(6,*) ' TIL(2,2),F_G(Y) ',TIL(2,2),F_G(Y)
      ENDIF
      RETURN
      END
      FUNCTION SUMM1(X,PHI)
      implicit none
*KEEP,RGPARAM.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
*KEND.
      REAL SUMM1,X,PHI
      DOUBLE PRECISION TIL,F_G,Y,WT
      DOUBLE PRECISION PK1,PK2,PK3,PL
      COMMON /QQG/ PK1(4),PK2(4),PK3(4),PL(4)
      REAL L2MIN,L2MAX
      COMMON /QQG_C/L2MIN,L2MAX
      EXTERNAL TIL,F_G
      Y = DBLE(L2MIN*(L2MAX/L2MIN)**X)
      WT = Y *DBLE(LOG(L2MAX/L2MIN))
      WT = WT/PI
      PL(1) = DSQRT(Y)*DBLE(COS(PHI))
      PL(2) = DSQRT(Y)*DBLE(SIN(PHI))
      SUMM1 = SNGL(WT * TIL(0,1) * F_G(Y)/Y)
      IF(SUMM1.LT.0.) THEN
c         write(6,*) ' summ1 x,phi ',x,phi
c         write(6,*) ' TIL(0,1),F_G(Y) ',TIL(0,1),F_G(Y)
      ENDIF
      RETURN
      END
      FUNCTION SUMM2(X,PHI)
      implicit none
*KEEP,RGPARAM.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
*KEND.
      REAL SUMM2,X,PHI
      DOUBLE PRECISION TIL,F_G,Y,WT
      DOUBLE PRECISION PK1,PK2,PK3,PL
      COMMON /QQG/ PK1(4),PK2(4),PK3(4),PL(4)
      REAL L2MIN,L2MAX
      COMMON /QQG_C/L2MIN,L2MAX
      EXTERNAL TIL,F_G
      Y = DBLE(L2MIN*(L2MAX/L2MIN)**X)
      WT = Y *DBLE(LOG(L2MAX/L2MIN))
      WT = WT/PI
      PL(1) = DSQRT(Y)*DBLE(COS(PHI))
      PL(2) = DSQRT(Y)*DBLE(SIN(PHI))
c      write(6,*) ' summ2 x,phi ',x,phi
      SUMM2 = SNGL(WT * TIL(0,2) * F_G(Y)/Y)
      IF(SUMM2.LT.0.) THEN
c         write(6,*) ' summ2 x,phi ',x,phi
c         write(6,*) ' TIL(0,2),F_G(Y) ',TIL(0,2),F_G(Y)
      ENDIF
      RETURN
      END
      FUNCTION FIL(XR)
      FIL = 0.
      RETURN
      END
      FUNCTION FIU(XR)
      FIU = 2.*3.1415
      RETURN
      END

      DOUBLE PRECISION FUNCTION F_G(Y)
*     IMPLICIT DOUBLE PRECISION (A-G,O-Z)
      implicit none
      DOUBLE PRECISION XPOM,Y,FT,DGRV_NL
      REAL DGRV_NLN
      DOUBLE PRECISION YOLD,XPOLD,FTOLD
      COMMON/BARTELS/XPOM
      EXTERNAL DGRV_NLN,DGRV_NL
      LOGICAL FIRST
      DATA FIRST/.TRUE./
      IF(FIRST) THEN
         YOLD = 0
         XPOLD = 0
         FTOLD = 0
         FIRST=.FALSE.
      ENDIF
      IF(Y.EQ.YOLD.AND.XPOM.EQ.XPOLD) THEN
         FT = FTOLD
      ELSE
         YOLD = Y
         XPOLD = XPOM
         IF(XPOM.GT.0.095D0) THEN
            FT = 0.0D0
         ELSE
            FT = DBLE(DGRV_NLN(XPOM,Y))
            IF(FT.LE.0) THEN
c            write(6,*) ' F_G,xpom,Y :',FT,XPOM,Y
               FT = 0.D0
            ENDIF
         ENDIF
         FTOLD = FT
      ENDIF
      F_G = FT
      RETURN
      END
      DOUBLE PRECISION FUNCTION TIL(I,L)
      implicit none
      DOUBLE PRECISION PK1,PK2,PK3,PL
      COMMON /QQG/ PK1(4),PK2(4),PK3(4),PL(4)
      DOUBLE PRECISION LK1K2,K1K2,LK1,K1,LK2
      INTEGER I,L,NM
      DOUBLE PRECISION TILT,CF,T1,T2,X2LK1K2,X2K1K2,X2LK1,X2K1,X2LK2
      DOUBLE PRECISION XK22
      DOUBLE PRECISION DK
      EXTERNAL DK
      TILT = 0.D0
      DO NM = 1,2
         CF = 1.D0
         IF(NM.EQ.2) CF = -1.D0
         IF(I.EQ.0) THEN
            LK1K2 = 1.D0
            K1K2 = 1.D0
            LK1 = -1.D0
            K1 = 1.D0
         ELSE
            LK1K2 = CF*PL(I) + PK1(I) + PK2(I)
            K1K2 = PK1(I) + PK2(I)
            LK1 = CF*PL(I) - PK1(I)
            K1 = PK1(I)
         ENDIF
         X2LK1K2 = (CF*PL(1) + PK1(1) + PK2(1))**2+ (CF*PL(2) + PK1(2)
     +   + PK2(2))**2
         X2K1K2 = (PK1(1) + PK2(1))**2 + (PK1(2) + PK2(2))**2
         X2LK1 = (CF*PL(1) - PK1(1))**2 + (CF*PL(2) - PK1(2))**2
         X2K1 = PK1(1)**2 + PK1(2)**2
         T1 = LK1K2/DK(X2LK1K2) + K1K2/DK(X2K1K2) + LK1/DK(X2LK1)
     +   - K1/DK(X2K1)
         LK2 = CF*PL(L) + PK2(L)
         X2LK2 = (CF*PL(1) + PK2(1))**2 + (CF*PL(2) + PK2(2))**2
         XK22 = PK2(1)**2 + PK2(2)**2
         T2 = LK2/X2LK2 - PK2(L)/XK22

         TILT = TILT + T1*T2
      ENDDO
      IF(TILT.LT.0) THEN
c      write(6,*) ' TIL I,L ',TILT,I,L
      ENDIF
      TIL = TILT
      RETURN
      END
      DOUBLE PRECISION FUNCTION DK(X)
      IMPLICIT NONE
      DOUBLE PRECISION X
      DOUBLE PRECISION a1ma1,Q2_c
      COMMON /QQG_CON/a1ma1,Q2_c
      DK = a1ma1*q2_c + X
      IF(DK.LT.0.) THEN
c        write(6,*) ' DK,a1ma1,q2_c,X ',DK,a1ma1,q2_c,X
      ENDIF
      RETURN
      END
*CMZ :  2.07/03 24/05/99  17.27.28  by  Hannes Jung
*-- Author :    Hannes Jung   02/02/98
      SUBROUTINE DIFFR6(X,WDIF)
      IMPLICIT None
	Double Precision X,WDIF,WPART,WT1,GEV2NB
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      DIMENSION X(20)
      DATA GEV2NB/.3893857D+6/
      WPART=0.D0
      WDIF=0.D0
      WT1=0.D0
      IF(IHERAC.EQ.0) THEN
         CALL PARTDH(X,WPART)
      ELSE
         CALL PARTDHHS(X,WPART)
      ENDIF
      IF(WPART.GT.0.) THEN
         CALL ELEQQ(WT1)
      ENDIF
      if(wt1.eq.0d0.and.wpart.ne.0.d0) then
c      write(6,*) 'diffr6 wpart,wt1',wpart,wt1
      endif
cc      write(6,*) 'diffr6 wpart,wt1',wpart,wt1
      WDIF=WPART*WT1*GEV2NB
      RETURN
      END
*CMZ :  2.08/00 06/06/99  17.46.35  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  17.27.49  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE ELEQQ(WT1)
C
C    e p  ----> Q Q_BAR  p
C
C
      implicit none
*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEND.
      DOUBLE PRECISION PK1(4),PK2(4)
      DOUBLE PRECISION DBW2(4),DBMX(4)
      DOUBLE PRECISION STHETA,SPHI,sphi1
      DOUBLE PRECISION MX2,M2
      DOUBLE PRECISION WMAX
      DOUBLE PRECISION I_L,I_T
      INTEGER IMIX
      COMMON /OALPHAS/ WMAX,IMIX
      INTEGER IGENFL
      COMMON/GENWEI/IGENFL
      DOUBLE PRECISION XPOM
      COMMON/BARTELS/XPOM
      REAL SNGL
      DOUBLE PRECISION DOT
      INTEGER I
      DOUBLE PRECISION   sst,betat,xppt,t,qqt
      common   /parameter/ sst,qqt,betat,xppt,t
      DOUBLE PRECISION WT1,sigdt,sigdl,sigdi,sigda
      DOUBLE PRECISION ALPH_EM,Y,W2,XB,PT2
      DOUBLE PRECISION PTFACT,mf,ksi,ALPHA_S,ALPHAS
      DOUBLE PRECISION pt2max,charge,const
      DOUBLE PRECISION phi
      DOUBLE PRECISION cosp,cos2p,raphi

      common   /phi/       phi
      INTEGER IPHI
      COMMON /SEL/IPHI
      DOUBLE PRECISION D_XGX,glu,dglu,xglu
      EXTERNAL ALPHAS,D_XGX,XGLU,raphi
      t = dble(t2gki)
      sst = SSS
      qqt = q2
      xppt = xpom
      iphi=0
      WT1 = 0.D0
      y = DBLE(YY)
      DBMX(1)=  P(NIA1,1) + P(NIA1+1,1)
      DBMX(2)=  P(NIA1,2) + P(NIA1+1,2)
      DBMX(3)=  P(NIA1,3) + P(NIA1+1,3)
      DBMX(4)=  P(NIA1,4) + P(NIA1+1,4)
      MX2=DOT(DBMX,DBMX)
c  goto gamma p system
      DBW2(1)=  P(NIA1,1) + P(2,1)
      DBW2(2)=  P(NIA1,2) + P(2,2)
      DBW2(3)=  P(NIA1,3) + P(2,3)
      DBW2(4)=  P(NIA1,4) + P(2,4)
      W2=DOT(DBW2,DBW2)
      xb = Q2/(W2 + Q2)

      betat = xb/xpom

c  goto gamma pom system
      DBW2(1)=  P(NIA1,1) + P(NIA1+1,1)
      DBW2(2)=  P(NIA1,2) + P(NIA1+1,2)
      DBW2(3)=  P(NIA1,3) + P(NIA1+1,3)
      DBW2(4)=  P(NIA1,4) + P(NIA1+1,4)
c     write(6,*) ' before boost '
c      call dulist(1)
      CALL DUDBRB(0,0,0.D0,0.D0,
     +  -DBW2(1)/DBW2(4),-DBW2(2)/DBW2(4),
     +  -DBW2(3)/DBw2(4))
c     write(6,*) ' before phi '
c      call dulist(1)
      SPHI = DLANGL(P(NIA1,1),P(NIA1,2))
      CALL DUDBRB(0,0,0.D0,-sphi,0.d0,0.d0,0.d0)
c     write(6,*) ' before theta '
c      call dulist(1)
      STHETA = DLANGL(P(NIA1,3),P(NIA1,1))
      CALL DUDBRB(0,0,-STHETA,0.D0,0.d0,0.d0,0.d0)
c     write(6,*) ' after boost '
c      call dulist(1)

      DO 10 I=1,4
         PK2(I) = P(NF1,I)
         PK1(I) = P(NF2,I)
   10 continue
      SPHI1 = DLANGL(P(1,1),P(1,2))
      call DUDBRB(0,0,0.D0,-sphi1,0.d0,0.d0,0.d0)
      phi =  DLANGL(P(NF1,1),P(NF1,2))
c      phitt = raphi(1,nia2,nf1)
c     write(6,*) 'eleqqf  phitt,phit ',phittt,phitt,phit
      call DUDBRB(0,0,0.D0,sphi1,0.d0,0.d0,0.d0)
      if(phi.ge.0.0) then
         PHITGKI = SNGL(PHI)
      else
         PHITGKI = SNGL(2.D0*PI+PHI)
      endif

      cosp = dcos(phi)
      cos2p = dcos(2.d0*phi)
      m2 = DOT(PK2,PK2) + 2.D0*DOT(PK2,PK1) + DOT(PK1,PK1)
      m2 = mx2
      PT2 = DBLE(PT2H)
      y = DBLE(YY)
      IF(p(nf1,5).lt.1.d0) then
         mf = 0.0d0
         charge = 2.d0/3.d0
      elseif(p(nf1,5).gt.1.d0.and.p(nf1,5).lt.4.d0) then
         mf = p(nf1,5)
         charge = 4.d0/9.d0
      endif
      ksi = (Q2 + mf**2/pt2*(Q2+m2))/m2
      glu = xglu(xpom,pt2*(1.d0+ksi))
      dglu = 0.d0
      dglu = d_xgx(xpom,pt2*(1.d0+ksi))
calculate I_T
      I_T = 2.d0/(1.d0 + ksi)**3 *(
     +      2.d0*ksi/pt2  * glu +
     +      (1.d0 -ksi -2.d0*ksi*dlog(ksi/(1.d0+ksi)))*
     +       dglu)
calculate I_L
      I_L = (pt2 + mf**2)*Q2/pt2/m2/(1.d0 + ksi)**3
     +      *((ksi - 1.d0)/pt2 * glu +
     +        (2.d0 +(1.d0-ksi)*dlog(ksi/(1.d0+ksi)))*
     +         dglu)
      if((PT2+mf**2)/m2.GT.0.25D0) GOTO 20
c jacobian dM**2 --> d x_pom
c now in partdh included
      ALPH_EM = ALPH
      IF(IRUNAEM.EQ.1) ALPH_EM = DBLE(ULALEM(SNGL(Q2)))
      Q2Q = pt2*(1.d0+ksi)
      ALPHA_S=ALPHAS(DSQRT(Q2Q))
      pt2max=m2/4.d0 - 4.d0*DBLE(ULMASS(3))**2
      if(pt2.ge.pt2max) goto 20
      PTFACT = (PT2 + mf**2)/DSQRT(1.D0 - 4.d0*(PT2+mf**2)/m2)
      const = alph_em*pi**2*alpha_s**2*charge

      sigdt = 1.d0/m2**2/pt2/12.d0*const*
     +  PTFACT*( (1.d0 - 2.d0*(pt2+mf**2)/m2)*I_T**2
     + + mf**2*pt2*m2**2/(pt2+mf**2)/Q2**2 * I_L**2
     + )
      sigdl = 1.d0/m2**2/q2*4.d0/3.d0*ptfact*const*I_L**2
      sigdi = 1.d0/m2**2/dsqrt(pt2*q2)/3.d0*const*(PT2 + mf**2)*I_T*I_L
      sigda = 1.d0/m2**3/pt2/12.d0*ptfact*const*(PT2 + mf**2)*I_T**2
c     write(6,*) ' sigs ',sigdt,sigdl,sigdi,sigda
c     write(6,*) ' I_T,I_L ',I_T,I_L,ksi
      wt1 = alph_em/2.d0/y/Q2/pi**2*(
     +      (1.d0 + (1.d0 - y)**2)/2.d0 * sigdt
     +       + (1.d0 - y) * sigdl - 2.d0*(1.d0-y)*cos2p*sigda
     +       + (2.d0 -y)*dsqrt(1.d0 - y)*cosp*sigdi)
c include t dependence a la DL
c now in partdh included
      IF(WT1.LT.0) THEN
         write(6,*) ' wt1  ',wt1
      ENDIF
      IF(WT1.NE.WT1) THEN
         write(6,*) ' wt1  ',wt1
         write(6,*) ' sigblw:sigdt,sigdl',sigdt,sigdl
         write(6,*) sigdt,sigdl,sigdi,sigda,ptfact,const,m2,I_T,I_L,
     +   PT2
         call dulist(1)
      ENDIF
      CALL DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
      CALL DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
      CALL DUDBRB(0,0,0.D0,0.D0,
     +  DBW2(1)/DBW2(4),DBW2(2)/DBW2(4),
     +  DBW2(3)/DBW2(4))
      RETURN
   20 WT1 = 0.D0
c      write(6,*) ' eleqq: set wt1=0'
      CALL DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
      CALL DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
      CALL DUDBRB(0,0,0.D0,0.D0,
     +  DBW2(1)/DBW2(4),DBW2(2)/DBW2(4),
     +  DBW2(3)/DBW2(4))
      RETURN
      END
*CMZ :  2.07/03 24/05/99  17.28.48  by  Hannes Jung
*-- Author :    Hannes Jung   02/03/97
      SUBROUTINE DIFFR7(X,WDIF)
      IMPLICIT None
	Double Precision X,WDIF,WPART,WT1,GEV2NB
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      DIMENSION X(20)
	Integer IDEBUG
      COMMON/ INTERN/IDEBUG
      DATA GEV2NB/.3893857D+6/
      WPART=0.D0
      WDIF=0.D0
      WT1=0.D0
      IF(IHERAC.EQ.0) THEN
         CALL PARTDF(X,WPART)
      ELSE
         write(6,*) ' resloved photon with HERACLES not implemented '
      ENDIF
      IF(WPART.GT.0.) THEN
         CALL ELERES(WT1)
      ENDIF
      WDIF=WPART*WT1*GEV2NB
      IF(WDIF.LE.0.D0.AND.IDEBUG.EQ.1) THEN
         write(6,*) ' DIFFR7 WPART,WT1 ',WPART,WT1
      ENDIF
c      IF(WDIF.LE.0.D0) THEN
c         write(6,*) ' DIFFR7 WPART,WT1 ',WPART,WT1
c      ENDIF
      RETURN
      END
*CMZ :  2.07/03 24/05/99  17.29.41  by  Hannes Jung
*-- Author :    Hannes Jung   25/03/98
      FUNCTION D_XGX(XX,QQ2)
	Implicit None
      DOUBLE PRECISION XGX,X,XX,QQ2,DELTA,DXGX,RERR,D_XGX
      DOUBLE PRECISION DQ2
      COMMON/gluon/X
      EXTERNAL XGX
      DELTA = 1.D-1*QQ2
      RERR = -9999.D0
      DXGX = -99999.D0
      DQ2 = QQ2
      X = XX
      CALL DFRIDR(XGX,DQ2,DELTA,DXGX,RERR)
      IF(RERR.EQ.-9999.D0) THEN
         write(6,*) ' D_XGX: error in calculating derivative of xg(x,'
     +   //'q2)'
         write(6,*) ' error = ',RERR
         DXGX = -99999.D0
      ENDIF
      IF(RERR/dxgx.GT.5.D-2) THEN
         write(6,*) ' D_XGX: large error for derivative of xg(x,'
     +   //'q2)'
         write(6,*) ' error = ',RERR/dxgx,' larger than 0.01 '
         write(6,*) ' with RERR = ',RERR,' and dxgx = ',dxgx
	   write(6,*) ' results are not reliable'
	   write(6,*) ' check selected set of pdf"s'
	   write(6,*) ' are they valid for Q2 = ',DQ2,' and x = ',XX
	   write(6,*) ' stop the program; derivative set to 0.0000 '
         DXGX = 0.D0
      ENDIF
c      write(6,*) ' D_XGX: DFRIDR DXGX,DELTA,RERR ',DXGX,DELTA,RERR
      D_XGX = DXGX
      RETURN
      END


      FUNCTION XGX(QQ2)
	Implicit none
      DOUBLE PRECISION X,XGX,QQ2
      COMMON/gluon/X
      DOUBLE PRECISION XXX,Q2,GLU,XGLU
	EXTERNAL XGLU
      Q2=QQ2
      XXX = X
      XGX = XGLU(XXX,QQ2)
      RETURN
      END
      FUNCTION XGLU(XX,QQ2)
	Implicit none
      DOUBLE PRECISION XX,XGX,QQ2,XGLU
      DOUBLE PRECISION XXX,QQ,UPV,DNV,USEA,DSEA,STR,CHM,BOT,TOP,GLU,
     +VAL(20)
      LOGICAL PDFFIRST
      COMMON /W50516/PDFFIRST
      CHARACTER*20 PARM(20)
*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEND.
      Integer MST51,NPDF
      DATA NPDF/0/,UPV,DNV,USEA,DSEA,STR,CHM,BOT,TOP,GLU/9*0.D0/
      QQ=SQRT(MAX(0.D0,QQ2))
      XXX = XX
      PARM(1) = 'NPTYPE'
      MST51 = MSTP(51)
      VAL(1) = INT(MST51/1000000)

      PARM(2) = 'NGROUP'
      VAL(2) = DBLE(MOD(MST51,1000000)/1000)
      PARM(3) = 'NSET'
      VAL(3) = DBLE(MOD(MOD(MST51,1000000),1000))
CNEW
      NPDF=NPDF+1
      PDFFIRST=.FALSE.
      IF(NPDF.LE.1) PDFFIRST=.TRUE.
c call PDFSET each time, because when DIF with pi structure function is
c also selected one would get in confusion....
      CALL PDFSET(PARM,VAL)
      CALL STRUCTM(XXX,QQ,UPV,DNV,USEA,DSEA,STR,CHM,BOT,TOP,GLU)
      XGLU = GLU
      RETURN
      END
*CMZ :  2.06/32 03/05/98  10.20.39  by  Hannes Jung
*-- Author :    Hannes Jung   06/04/98
      SUBROUTINE DFRIDR(FUNC,X,H,DFDX,ERR)
c to calculate the derivative of function FUNC
c taken from: Numerical Recepies in Fortran
c             W. H. Press, S.A. Teulolsky, W.T. Vetterling, B.P. Flannery
c             Cambridge University Press 1992
      IMPLICIT NONE
      INTEGER  NTAB
      DOUBLE PRECISION DFDX,ERR,H,X,FUNC,CON,CON2,BIG,SAFE
      PARAMETER (CON=1.4D0,CON2=CON*CON,BIG=1.D30,NTAB=10,SAFE=2.D0)
      EXTERNAL FUNC
      INTEGER I,J
      DOUBLE PRECISION ERRT,FAC,HH,A(NTAB,NTAB)
      IF(H.EQ.0.D0) THEN
         write(6,*) 'DFRIFR: h must be nonzero: program stopped'
         STOP
      ENDIF
      HH=H
      A(1,1)=(FUNC(X+HH)-FUNC(X-HH))/(2.D0*HH)
      ERR=BIG
      DO I=2,NTAB
         HH=HH/CON
         A(1,I)=(FUNC(X+HH)-FUNC(X-HH))/(2.D0*HH)
         FAC = CON2
         DO J=2,I
            A(J,I)=(A(J-1,I)*FAC-A(J-1,I-1))/(FAC-1.D0)
            FAC = CON2*FAC
            ERRT=MAX(ABS(A(J,I)-A(J-1,I)),ABS(A(J,I)-A(J-1,I-1)))
            IF(ERRT.LE.ERR) THEN
               ERR=ERRT
               DFDX=A(J,I)
            ENDIF
         ENDDO
         IF(ABS(A(I,I)-A(I-1,I-1)).GE.SAFE*ERR) RETURN
      ENDDO
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.28  by  Hannes Jung
*CMZ :  2.06/32 14/04/98  17.02.34  by  Hannes Jung
*-- Author :    Hannes Jung   14/04/98
      FUNCTION RLU()
      Double Precision draprn
      EXTERNAL draprn
      LOGICAL FIRST
      DATA FIRST/.TRUE./
      IF(FIRST) THEN
         write(6,*) 'call rlu = draprn'
         FIRST = .FALSE.
      ENDIF
      RLU =  draprn()
      RETURN
      END
*CMZ :  2.08/00 06/06/99  17.40.09  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  17.32.18  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
      FUNCTION FXNB(X)
      IMPLICIT None
	Double Precision FXNB,FXNB1,X,XG,XGF,FXN1,WEIGHT
	Integer MXDIM,I
      PARAMETER (MXDIM = 50)
      DIMENSION X(MXDIM),XGF(20)
      COMMON/XFXNB/XG(20)
      EXTERNAL FXN1
      FXNB = 0.0D0
	Weight = 0.D0
c      write(6,*) ' fxnb ',(x(i),i=1,10)
      DO 10 I=1,20
         XGF(I) = X(I)
         XG(I) = X(I)
   10 CONTINUE
c      write(6,*) ' fxnb ',xgf
      FXNB1 = FXN1(XGF,WEIGHT)
c      write(6,*) ' fxnb ',fxnb1
      FXNB = FXNB1
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.28  by  Hannes Jung
*CMZ :  2.07/03 24/05/99  17.33.19  by  Hannes Jung
*-- Author :    Hannes Jung   03/05/98
c get draprn for bases/spring
      FUNCTION DRN(ISEED)
	Implicit None
	Integer ISEED
      double precision drn1,DRN
      Double Precision draprn
	EXTERNAL draprn
      DRN1= draprn()
      DRN = DRN1
	RETURN
	END
*CMZ :  2.07/03 24/05/99  17.34.05  by  Hannes Jung
*-- Author :
      function dhformf(t)
	Implicit None
      DOUBLE PRECISION   dhformf
      DOUBLE PRECISION   t,dl
c

c use donnachie landshoff formfactor
c        f(t)=(4-2.8*t)/(4-t)*1/(1-t/0.7)^2
      dl =(4.d0-2.8d0*t)/(4.d0-t)* 1.d0/(1.d0-t/0.7d0)**2
c         write(6,*) ' dhformf : ',dl,t
      dhformf = dl**2
      return
      end
*CMZ :  2.07/03 24/05/99  17.34.39  by  Hannes Jung
*-- Author :    Hannes Jung   08/05/98
      function raphi(i1,i2,i3)
c calculate azimuthal phi angle
c i1 = electron momentum
c i2 = incoming parton momentum
c i3 = final quark momentum
c cos_phi = (i1 x i2) * (i2 x i3)/abs(i1 x i2)/abs(i2 x i3)
      Implicit none
      Integer i1,i2,i3
      Double precision te11,te12,te13,te21,te22,te23,prod,phi,raphi
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEND.
      te11 = P(i2,2)*p(i1,3)-p(i2,3)*p(i1,2)
      te12 = P(i2,3)*p(i1,1)-p(i2,1)*p(i1,3)
      te13 = P(i2,1)*p(i1,2)-p(i2,2)*p(i1,1)
      te21 = P(i2,2)*p(i3,3)-p(i2,3)*p(i3,2)
      te22 = P(i2,3)*p(i3,1)-p(i2,1)*p(i3,3)
      te23 = P(i2,1)*p(i3,2)-p(i2,2)*p(i3,1)
      prod = te11*te21 + te12*te22 + te13*te23
      prod=prod/dsqrt(te11**2+te12**2+te13**2)
      prod=prod/dsqrt(te21**2+te22**2+te23**2)
      if(abs(prod).gt.1.0d0) then
         prod= 1.d0
      endif
      phi = dacos(prod)
      if(phi.ne.phi) then
         write(6,*) ' raphi ',phi,prod
      endif
      raphi = phi
      return
      end
*CMZ :  2.08/00 14/06/99  19.13.57  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  14.42.27  by  Hannes Jung
*-- Author :    Hannes Jung   02/03/97
      SUBROUTINE DIR99(X,WDIF)
      IMPLICIT NONE
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      Double Precision GEV2NB,WPART,WDIF,WT1
      Double Precision X(20)
      INTEGER IDEBUG
      COMMON/ INTERN/IDEBUG
      DATA GEV2NB/.3893857D+6/
      WPART=0.D0
      WDIF=0.D0
      WT1=0.D0

      CALL PARTDI99(X,WPART)

      IF(WPART.GT.0.) THEN
c         CALL ELERES(WT1)
         WT1 = 1.D0
      ENDIF
cc      write(6,*) wpart,wt1
      WDIF=WPART*WT1*GEV2NB
      IF(WDIF.LE.0.D0.AND.IDEBUG.EQ.1) THEN
         write(6,*) ' DIR99 WPART,WT1 ',WPART,WT1
      ENDIF
      RETURN
      END
*CMZ :  2.08/00 06/06/99  17.48.16  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  14.37.42  by  Hannes Jung
*-- Author :    Hannes Jung   30/10/94
      SUBROUTINE DIFFR30(X,WDIF)
      IMPLICIT NONE
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEND.
      Double Precision WPART,WDIF
	Double Precision X(20)
      WPART=0.D0
      WDIF=0.D0
c      write(6,*) 'diffr30 WPART before rgsatrap'
      CALL RGSATRAP(X,WPART)
c      write(6,*) 'diffr30 WPART after rgsatrap'
c      WDIF=WPART*GEV2NB
      WDIF=WPART
c      write(6,*) 'diffr30: WDIF ',WDIF
c      call lulist(1)
      RETURN
      END


*CMZ :  2.08/00 14/06/99  19.13.57  by  Hannes Jung
*CMZ :  2.07/03 15/05/99  21.48.57  by  Hannes Jung
*CMZ :          15/05/99  21.37.38  by  Hannes Jung
* changes done for low mass diffraction by G. Briskin
*CMZ :          17/12/96  12.37.25  by  G.M. Briskin (TAU)
*-- Author :    Hannes Jung   03/04/94
      SUBROUTINE LMEPS99
* for low mass systems changes introduced by gena briskin 2.12.1996
      IMPLICIT NONE
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
      DOUBLE PRECISION PT2GEN,PHIGEN
      COMMON/HARDPOM/PT2GEN,PHIGEN
c this is the modified but original LMEPS routine LEPTO 6.1
      DOUBLE PRECISION DETOT
      DOUBLE PRECISION DROBO(5)
      REAL CUT,X,Y,W2,Q2LP,U
      DOUBLE PRECISION PARL
      Integer LLST
      COMMON /RAPTOU/ CUT(14),LLST(40),PARL(30),X,Y,W2,Q2LP,U
*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEND.
      DOUBLE PRECISION DBETA(2,3),DBETAR(2,3)
      DOUBLE PRECISION STHETA(2),SPHI(2),STHETAR(2),SPHIR(2)
      REAL PYPAR,PYVAR
      Integer IPY
      COMMON /PYPARA/ IPY(80),PYPAR(80),PYVAR(80)
      REAL XPY,SH,TH,UH,Q2PY
      Integer ISUB,KFL
      COMMON /PYPROC/ ISUB,KFL(3,2),XPY(2),SH,TH,UH,Q2PY
      REAL XQPY
      COMMON /MYINT1/ XQPY(2,-6:6)
c.hju DIMENSION KS(9,5),PS(9,5),ROBO(5),XPQ(-6:6)
      REAL XPQ1,XPQ2
      DOUBLE PRECISION ROBO
      DIMENSION ROBO(5),XPQ1(-6:6),XPQ2(-6:6)
      DOUBLE PRECISION PS(40,5)
      REAL QMAX,XPRO
c..hju
      Integer LST,IRES
      COMMON/EPPARA/LST(30),IRES(2)
      DOUBLE PRECISION DELTAP(4), DPLONG, DBTOT, DGAMMA
c..hju
      Integer ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      COMMON /COLCON/ ICOLORA,IRESPRO,IRPA,IRPB,IRPC,IRPD,IRPE,IRPF,IRPG
      Integer KS,NS
      COMMON /COLR/ KS(40,5),NS
      REAL SNGL
cGB
      Real     remPARJ32
      Integer I,J,NCALL,NPRIN,NCHECK,NIPH,NB2,NSTB,IFL,IT,IPU1,IPU2
      Integer NIEL,IRFL,NIA1T,IPOM,MSTJO
      Double Precision SHRAP,Q2LM,UMAS2,XR,DETOTR,XGTEST,Q12
      Double Precision PC1,PC2,PC3,PC4,CHEC,P1,P2,P3,P4
      Double Precision phielt,PHIROT,PZT,STHARD
*PER
        integer iLMEPSPrint, MxLMEPSPrint
        parameter (MxLMEPSPrint = 10)
        save iLMEPSPrint
*PER

      logical first
      data    first /.TRUE./
c
c      SAVE KS,PS
cGB

      DATA NCALL/0/
      DATA NPRIN/0/
      DATA NCHECK/0/
      If(first) Then
         first = .FALSE.
         remPARJ32 = PARJ(32)
*PER
         iLMEPSPrint = 0
*PER
      ELSE
         PARJ(32)=remPARJ32
      EndIf
cGB
      DO I=1,40
         DO J=1,5
            KS(I,J) = 0
            PS(I,J) = 0.D0
         ENDDO
      ENDDO

c..hju
      NCALL = NCALL + 1
      IPY(48)=0
      LST(21)=0
C ILEPTO=1 parton shower a la LEPTO
C ILEPTO=0 parton shower a la PYTHIA
      SHRAP=DBLE(SHH)
      Q2PY = SNGL(Q2Q)
      Q2LP = SNGL(Q2)
      Q2LM = Q2
      IF(IRES(1).EQ.1) THEN
         DO 10 I=1,N
            IF(K(I,1).EQ.21.AND.K(I,2).EQ.22.AND.K(I,3).EQ.1) NIPH = I
            Q2LM = 0.0d0
   10    CONTINUE
      ELSE
         NIPH = NIA1
      ENDIF
c change to e in + z direction
      DO 20  I=1,N
         P(I,3) = - P(I,3)
   20 continue
      NB2 = 2
      UMAS2 = DBLE(ULMASS(K(2,2)))**2
c.hju parl(21) = 2P.k = invariant mass s
c.hjutest      PARL(21) = 2.D0*DOT1(1,NB2)
      PARL(21) = 2.D0*DOT1(1,2)
      IF(ILEPTO.EQ.0) PARL(21) =PARL(21)+DBLE(ULMASS(K(1,2)))**2 +UMAS2
c.hju parl(22) = 2P.q P = proton(or pomeron) q = photon
      PARL(22) = 2.D0*DOT1(NB2,NIPH)
      IF(IABS(K(1,2)).EQ.22.OR.IABS(K(1,2)).EQ.23) Q2LM=0.0D0

      XPRO = XPR
      PYVAR(32) = XPRO
      XR = DBLE(XPRO)
      PYVAR(31) = XEL
      IF(NCALL.LE.NPRIN) CALL DULIST(1)
      IF(NCHECK.EQ.1) THEN
         write(6,*) ' LMEPS: 1st '
         CALL DULIST(1)
      ENDIF
      IF(ILEPTO.EQ.1) THEN
C...Transform to gamma p(or pomeron) cms, boost parameters in double precision.
         DETOT=P(NIPH,4)+P(NB2,4)
         DBETA(2,1)=(P(NIPH,1)+P(NB2,1))/DETOT
         DBETA(2,2)=(P(NIPH,2)+P(NB2,2))/DETOT
         DBETA(2,3)=(P(NIPH,3)+P(NB2,3))/DETOT
         CALL DUDBRB(0,0,0.D0,0.D0,-DBETA(2,1),-DBETA(2,2),-DBETA(2,3))
         SPHI(2)=DLANGL(P(NIPH,1),P(NIPH,2))
         CALL DUDBRB(0,0,0.D0,-SPHI(2),0.D0,0.D0,0.D0)
         STHETA(2)=DLANGL(P(NIPH,3),P(NIPH,1))
         CALL DUDBRB(0,0,-STHETA(2),0.D0,0.D0,0.D0,0.D0)
      ENDIF
c         write(6,*) ' LMEPS: in gamma p ',NB2
c         CALL DULIST(1)
      IF(ILEPTO.EQ.1.and.IRES(1).EQ.1) THEN
         NSTB = 5
         DETOTR=P(NIA1,4)+P(NIA2,4)
         DBETAR(2,1)=(P(NIA1,1)+P(NIA2,1))/DETOTR
         DBETAR(2,2)=(P(NIA1,2)+P(NIA2,2))/DETOTR
         DBETAR(2,3)=(P(NIA1,3)+P(NIA2,3))/DETOTR
         CALL DUDBRB(nstb,0,0.D0,0.D0,-DBETAR(2,1),-DBETAR(2,2),
     +   -DBETAR(2,3))
         SPHIR(2)=DLANGL(P(NIA1,1),P(NIA1,2))
         CALL DUDBRB(nstb,0,0.D0,-SPHIR(2),0.D0,0.D0,0.D0)
         STHETAR(2)=DLANGL(P(NIA1,3),P(NIA1,1))
         CALL DUDBRB(nstb,0,-STHETAR(2),0.D0,0.D0,0.D0,0.D0)

         if(ncall.le.nprin) call dulist(1)
      ENDIF
c      IF(NCHECK.EQ.1) THEN
c         write(6,*) ' LMEPS: 2nd '
c         CALL DULIST(1)
c      ENDIF

      IF(NCALL.LE.NPRIN) CALL DULIST(1)
C...Save event record in  cms
      DO 30 I=1,N
         DO 30 J=1,5
            KS(I,J)=K(I,J)
   30 PS(I,J)=P(I,J)
C...Rearrange event record to PYSSPA standard
      DO 40 J=1,5
         K(3,J)=0
         P(3,J)=0.D0
         K(4,J)=0
         P(4,J)=0.D0
         K(5,J)=KS(NIA1,J)
         P(5,J)=PS(NIA1,J)
         IF(IABS(K(1,2)).EQ.11.OR.IABS(K(1,2)).EQ.13) THEN
            K(7,J)=KS(3,J)
            P(7,J)=PS(3,J)
            K(9,J)=KS(3,J)
            P(9,J)=PS(3,J)
         ENDIF
         K(8,J)=KS(NF1,J)
         P(8,J)=PS(NF1,J)

         K(11,J) = 0
         K(12,J) = 0

C check for radiative gamma
         IF(KS(4,2).EQ.22.AND.KS(4,1).EQ.1) THEN
            K(13,J) = KS(4,J)
            P(13,J) = PS(4,J)
         ENDIF
         K(11,J)=KS(NF1+1,J)
         P(11,J)=PS(NF1+1,J)
         K(10,J)=KS(NF2,J)
   40 P(10,J)=PS(NF2,J)
      K(5,3)=3
      K(6,3)=4
      K(7,3)=5
      K(8,3)=6
      K(9,3)=5
      K(10,3)=6
      DO 50 I=5,11
   50 K(I,1)=21
      K(9,1)=0
C...Incoming parton
      DO 60 J=1,4
         IF(ILEPTO.EQ.1) THEN
            IF(IPRO.NE.12) THEN

               P(6,J)=P(8,J) + P(10,J) + P(11,J)  - P(5,J)
            ENDIF
         ELSE
            P(6,J)=PS(NIA2,J)
         ENDIF
c this redinition of incoming and outgoing parton is needed
c because in PYREMN there is a boost to correct for the long. frame in case
c there are different masses for outgoing parton and remnant.

   60 CONTINUE
c end of redefintion
      P(6,5)=0.0D0
      K(6,2)=KS(NIA2,2)
      N=15
      IF(NCALL.LE.NPRIN) THEN
         CALL DULIST(1)
      ENDIF
C...Partons with colour information in hadronic cms frame.
      DO 70  I=16,MSTU(4)
         DO 70 J=1,5
            K(I,J)=0
            P(I,J)=0.D0
   70 V(I,J)=0.
      NS=20

      DO 80  J=1,5
         N=NS+7
         K(NS+1,J)=K(5,J)
         P(NS+1,J)=P(5,J)
         K(NS+3,J)=K(6,J)
         P(NS+3,J)=P(6,J)
         K(NS+5,J)=K(8,J)
         P(NS+5,J)=P(8,J)
         K(NS+6,J)=K(11,J)
         P(NS+6,J)=P(11,J)
         K(NS+7,J)=K(10,J)
         P(NS+7,J)=P(10,J)
   80 CONTINUE
C...Old standard continuation lines
      K(NS+2,1)=-1
      K(NS+2,3)=NS+1
      K(NS+4,1)=-1
      K(NS+4,3)=NS+3
      P(NS+4,3)=28
      P(NS+4,4)=28
C...Origin and Colour info for incoming parton
      K(NS+3,1)=13
      K(NS+3,3)=2
      K(NS+3,4)=28
      K(NS+3,5)=28
C...Colour info for two outgoing partons
      K(NS+5,1)=3
      K(NS+6,1)=3
      K(NS+7,1)=3
C...Effective outgoing parton = sum of both outgoing partons
      K(NS+8,1)=14
      K(NS+8,3)=3
C... q qbar gluon event
      K(NS+5,4)=(NS+6)*MSTU(5)
      K(NS+5,5)=(NS+8)*MSTU(5)
      K(NS+6,4)=(NS+7)*MSTU(5)
      K(NS+6,5)=(NS+5)*MSTU(5)
      K(NS+7,4)=(NS+8)*MSTU(5)
      K(NS+7,5)=(NS+6)*MSTU(5)


      K(NS+5,4)=(NS+6)*MSTU(5)
      K(NS+5,5)=0
      K(NS+6,4)=(NS+8)*MSTU(5)
      K(NS+6,5)=(NS+5)*MSTU(5)
      K(NS+7,4)=0
      K(NS+7,5)=(NS+8)*MSTU(5)
      K(NS+8,2)=21
      IF(K(NS+5,2).GT.0) THEN
         K(NS+8,4)=(NS+3)*MSTU(5)+26
         K(NS+8,5)=(NS+3)*MSTU(5)+27
      ELSE
         K(NS+8,4)=(NS+3)*MSTU(5)+27
         K(NS+8,5)=(NS+3)*MSTU(5)+26
      ENDIF
      DO 90 J=1,4
         P(NS+8,J)=P(8,J)+P(10,J)+P(11,J)
   90 CONTINUE
      P(NS+8,5)=DSQRT(DMAX1(0.D0, P(NS+8,4)**2-P(NS+8,1)**2-P(NS+
     +8,2)**2- P(NS+8,3)**2))
      N=NS+8

CPHI
C...Scale for bremsstrahlung etc.

      SH = SNGL(SHRAP)
      IPY(40)=10
      IF(IPRO.EQ.12) IPY(40)=8
      IPY(47)=N
C...Save quantities for later use.
      IPY(41)=K(1,2)
      IF(IRES(1).EQ.1) IPY(41)=22
      IPY(42)=KINT(2,2)
      XPY(1)=1.
      XPY(2)=SNGL(XR)
      IF(IRES(1).EQ.1) THEN
         IPY(41)=22
         PYVAR(2) = -Q2LP +SNGL(PARL(22))
         PYVAR(31)=SNGL(SHRAP)/PYVAR(2)/PYVAR(32)
         XPY(1)=PYVAR(31)
         IF(XPY(1).GT.1.1) THEN
            write(6,*) ' LMEPS : XPY(1) > 1. ',XPY(1)
            write(6,*) ' LMEPS :s_hat, W**2, x_p',
     +        SHRAP,PYVAR(2),PYVAR(32)
            write(6,*) ' LMEPS :y, sss, q2lp, xel, xel/yy ',
     +        yy,sss,q2lp,xel,xel/yy
         ENDIF
         XPY(1)=AMIN1(1.0,XPY(1))
         CALL PYSTFU(IPY(41),XPY(1),Q2PY,XPQ1)
         IF(NCALL.LE.NPRIN) THEN
            write(6,*) ' IPY(41),XPY(1),Q2PY,XPQ1', IPY(41),XPY(1),
     +      Q2PY,XPQ1
         ENDIF
      ENDIF

c.hju CALL PYSTFU(K(2,2),XR,Q2,XPQ)
      IF(XPY(2).GT.1.) write(6,*) 'LMEPS : XPY(2) > 1. ',XPY(2)

      CALL PYSTFU(IPY(42),XPY(2),Q2PY,XPQ2)
      DO 100 I=-6,6
         IF(XPQ2(I).EQ.0.0) XPQ2(I)=1.E-11
  100 CONTINUE
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' IPY(42),XPY(2),Q2PY,XPQ2',
     +    IPY(42),XPY(2),Q2PY,XPQ2
      ENDIF
      DO 110 IFL=-6,6
         XQPY(1,IFL)=XPQ1(IFL)
  110 XQPY(2,IFL)=XPQ2(IFL)
      ISUB=39
      IPY(11)=1
      KFL(2,1)=KS(NIA1,2)
      KFL(2,2)=K(6,2)
      KFL(1,1)=KFL(2,1)
      KFL(1,2)=KFL(2,2)
      KFL(3,1)=K(1,2)
      KFL(3,2)=K(28,2)
      IF(IPRO.EQ.12) KFL(3,2)=K(8,2)
      PYVAR(2)=SNGL(PARL(21))
      IF(IRES(1).EQ.1) PYVAR(2) = -Q2LP +SNGL(PARL(22))
      PYVAR(3)=SNGL(P(1,5))
      PYVAR(4)=SNGL(P(2,5))
      PYVAR(1)=SQRT(PYVAR(2))
      PYVAR(5)=PYVAR(1)/2.


C...Generate timelike parton shower (if required)
      IF(IPY(13).EQ.1) THEN
         CALL LSCALE(1,QMAX)
         IF(IPRO.NE.12) THEN
            CALL DUSHOW(25,27,QMAX)
c        write(6,*) ' qmax,shat ',qmax,sqrt(shh)
         ELSEIF(IPRO.EQ.12) THEN
            QMAX = MIN(QMAX,SNGL(P(25,4)))
            CALL DUSHOW(25,0,QMAX)
         ENDIF
      ENDIF
      IT=25
      IF(N.GE.27) IT=27
      IF(N.GE.28) IT=28
      NS=N
C...Generate spacelike parton shower (if required)
      IPU1=0
changed
      IF(IRES(1).EQ.1) IPU1=21
      IPU2=23

      XGTEST = (P(21,5)**2 + P(IT,5)**2+DBLE(PYPAR(22)))/PARL(22)

      IF(IPY(14).GE.1.AND.XGTEST.LT.0.999) THEN
         CALL PYSSPA(IPU1,IPU2)
         IF(LST(21).NE.0) THEN
            IF(LST(21).EQ.55) THEN
            ELSE
               RETURN
            ENDIF
         ENDIF
      ENDIF
      IF(.NOT.(IPY(14).GE.1.AND.XGTEST.LT.0.999).OR.LST(21).EQ.55) THEN
         IF(LST(21).EQ.55) LST(21)=0
         DO 120 I=NS+1,NS+4
            DO 120 J=1,5
               K(I,J)=0
               P(I,J)=0.D0
  120    V(I,J)=0.
Cadded
         K(NS+1,1)=11
         K(NS+1,3)=21
         K(NS+1,2)=KFL(2,1)
         DO 130 J=1,5
  130    P(NS+1,J)=P(21,J)
         K(NS+2,1)=-1
         K(NS+2,3)=NS+1
         K(NS+3,1)=13
         K(NS+3,2)=KFL(2,2)
         K(NS+3,3)=23
         K(NS+3,4)=23
         K(NS+3,5)=23
         P(NS+3,1)= 0.D0
         P(NS+3,2)= 0.D0
         P(NS+3,5)= 0.D0
         Q12 = 0.D0
         IF(Q2LM.GT.2.D0) THEN
            P(NS+3,3)=(P(IT,5)**2+Q2LM+Q12)*(P(21,4)-P(21,3))/(2.D0*
     +      Q2LM)
            P(NS+3,4)=-P(NS+3,3)
         ELSE
            P(NS+3,3)=-(P(IT,5)**2+Q2LM+Q12)/(P(21,4)+P(21,3))/2.D0
            P(NS+3,4)=-P(NS+3,3)
         ENDIF
         IF(NCALL.LT.NPRIN) THEN
            write(6,*) ' LMEPS NS+3,23,it ',P(NS+3,3),P(23,3),P(IT,5)
            write(6,*) ' LMEPS Q2 ',Q2,P(21,5)**2
         ENDIF

         K(NS+4,1)=-1
         K(NS+4,3)=NS+3
         P(NS+4,3)=23
         P(NS+4,4)=23
         P(24,1)=NS+3
         P(24,2)=NS+3
         K(23,4)=K(23,4)+(NS+3)*MSTU(5)
         K(23,5)=K(23,5)+(NS+3)*MSTU(5)
         IPU1=0
         IPU2=NS+3
         N=N+4
      ENDIF
C...Rotate and boost outgoing parton shower
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' before rotate and boost outgoing PS '
         CALL DULIST(2)
      ENDIF
changed      IF(ILEPTO.EQ.1.AND.IPRO.NE.12.AND.N.GT.31) THEN
      IF(ILEPTO.EQ.1.AND.IPRO.NE.12.AND.N.GT.31.and.IRES(1).EQ.0) THEN
         K(N+1,1)=0
         DO 140 J=1,4
  140    P(N+1,J)=P(NS+1,J)+P(NS+3,J)
         ROBO(1)=DLANGL(P(IT,3),SQRT(P(IT,1)**2+P(IT,2)**2))
         ROBO(2)=DLANGL(P(IT,1),P(IT,2))
         CALL DUDBRB(25,NS,0.D0,-ROBO(2),0.D0,0.D0,0.D0)
         CALL DUDBRB(25,NS,-ROBO(1),0.D0,0.D0,0.D0,0.D0)
         DELTAP(1) = P(N+1,1)
         DELTAP(2) = P(N+1,2)
         DELTAP(3) = P(N+1,3) - P(IT,3)
         DELTAP(4) = DSQRT(DELTAP(1)**2+DELTAP(2)**2+DELTAP(3)**2)
         DPLONG = -(P(IT,3)*DELTAP(3))/DELTAP(4)
         DBTOT = -(DPLONG*P(IT,4)- P(N+1,4)*DSQRT(DMAX1(0.D0,P(N+1,4)**
     +   2- P(IT,4)**2+DPLONG**2)))/(DPLONG**2+P(N+1,4)**2)
         DGAMMA = 1.D0/DSQRT(1.D0-DBTOT**2)
         DO 150 I = 1,3
            DROBO(I+2)=DELTAP(I)/(DGAMMA/(DGAMMA+1.D0)* (P(N+1,4)-
     +      DGAMMA*P(IT,4))+DGAMMA*P(IT,4))
  150    CONTINUE
         CALL DUDBRB(25,NS,0.D0,0.D0,DROBO(3),DROBO(4),DROBO(5))
C...End phi-correction
      ENDIF

      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' after rotate and boost outgoing PS '
         call dulist(1)
      ENDIF
C...Hadron remnant and primordial kt
      IPY(47)=N
      IPU1=0
      PYVAR(31)=XEL
      IF(N.GT.MSTU(4)-20) THEN
         WRITE(6,*) ' LMEPS before PYREMN: no more memory in LUJETS'
         LST(21)=51
         RETURN
      ENDIF
      CALL PYREMN(IPU1,IPU2)
      IF(NCALL.LE.NPRIN) CALL DULIST(2)
      IF(IPY(48).GE.1) THEN
         LST(21)=47+IPY(48)
         RETURN
      ENDIF
C...Rearrange partons along strings
      MSTU(24)=0
      MSTU(28)=0
      IF(IFPS.EQ.10) THEN
         MSTJO = MSTJ(105)
         MSTJ(105) = -1
      ENDIF
      IF(N.GT.MSTU(4)-20) THEN
         WRITE(6,*) ' LMEPS before DUPREP: no more memory in LUJETS'
         LST(21)=51
         RETURN
      ENDIF

      CALL DUPREP(0)

cGB....
      IF(IFPS.EQ.10) THEN
         MSTJ(105) = MSTJO
      ENDIF
      IF(MSTU(24).NE.0.OR.MSTU(28).NE.0) THEN
         if (iLMEPSPrint .le. MxLMEPSPrint) then
            iLMEPSPrint = iLMEPSPrint + 1
            WRITE(6,*) ' LMEPS: LUPREP error MSTU(24)= ',MSTU(24)
            write(6,*) ' color configuration ICOLORA,IRESPRO ',
     +           ICOLORA,IRESPRO
            write(6,*) ' res. photon ?  ',IRES(1)
            call DULIST(2)
         endif
         LST(21)=50
         RETURN
      ENDIF

C...Clean up event record -> order:
C...1=inc. lepton; 2=inc. nucleon; 3=exch boson; 4=scat. lepton;
C... (4+1) = rad. gamma if any
C...5+1=inc. parton before initial shower; 6+1=inc. parton at hard scattering
C...after shower; 7+1,8+1=first,second parton from hard scattering
C...before final shower
      IF(NCALL.LT.NPRIN) CALL DULIST(1)
      DO 160 J=1,5
         K(N+2,J)=K(3,J)
         P(N+2,J)=P(3,J)
         K(N+1,J)=K(4,J)
         P(N+1,J)=P(4,J)
         K(10,J)=0
         K(11,J)=0
         K(N+3,J)=KS(32,J)
         P(N+3,J)=PS(32,J)
         K(12,J)=KS(32,J)
         P(12,J)=PS(32,J)


         K(N+4,J)=KS(NIPH,J)
         P(N+4,J)=PS(NIPH,J)
  160 CONTINUE
      DO 170 I=1,20
         DO 170 J=1,5
            PS(I,J) = P(I,J)
  170 KS(I,J) = K(I,J)
      IRFL = 0
      DO 180 J=1,5
         IPOM=0
         IF(ILEPTO.EQ.1) THEN
            K(3,J)=K(N+4,J)
            P(3,J)=P(N+4,J)
            NIA1T = 3
            NIEL=4
            K(NIEL,J)=KS(9,J)
            P(NIEL,J)=PS(9,J)
            IF(KS(13,1).NE.0) THEN
               K(NIEL+1,J)=KS(13,J)
               P(NIEL+1,J)=PS(13,J)
               NIEL = 5
            ENDIF
            IF(KS(11,1).NE.0) THEN
               K(NIEL+1+IRFL,J)=KS(31,J)
               P(NIEL+1+IRFL,J)=PS(31,J)
               IPOM = 1
            ENDIF
            IF(IABS(K(1,2)).EQ.11.OR.IABS(K(1,2)).EQ.13) K(4,1)=1

         ENDIF
         K(NIEL+1+IRFL+IPOM,J)=K(N+1,J)
         P(NIEL+1+IRFL+IPOM,J)=P(N+1,J)
         K(NIEL+2+IRFL+IPOM,J)=K(NS+3,J)
         K(NIEL+2+IRFL+IPOM,3) = NIEL+1+IRFL+IPOM
         P(NIEL+2+IRFL+IPOM,J)=P(NS+3,J)
         NIA2 = NIEL + 2 + IRFL + IPOM
         K(NIEL+3+IRFL+IPOM,J)=K(25,J)
         P(NIEL+3+IRFL+IPOM,J)=P(25,J)
         NF1 = NIEL + 3 + IRFL + IPOM
         IF(IPRO.NE.12) THEN
            K(NIEL+4+IRFL+IPOM,J)=K(26,J)
            P(NIEL+4+IRFL+IPOM,J)=P(26,J)
            K(NIEL+5+IRFL+IPOM,J)=K(27,J)
            P(NIEL+5+IRFL+IPOM,J)=P(27,J)
            NF2 = NIEL + 5 + IRFL + IPOM
         ELSEIF(IPRO.EQ.12) THEN
            K(NIEL+4+IRFL+IPOM,J)=0
            NF2=NF1
         ENDIF
  180 CONTINUE
      K(3,3)=1
      K(4,3)=1
      K(NIEL+2+IRFL+IPOM,1)=21
      K(NIEL+2+IRFL+IPOM,3)=5+IRFL+IPOM
      K(NIEL+2+IRFL+IPOM,4)=0
      K(NIEL+2+IRFL+IPOM,5)=0
      K(NIEL+3+IRFL+IPOM,1)=21
      K(NIEL+3+IRFL+IPOM,3)=NIA1T
      K(NIEL+3+IRFL+IPOM,4)=0
      K(NIEL+3+IRFL+IPOM,5)=0
      IF(IPRO.NE.12) THEN
         K(NIEL+4+IRFL+IPOM,1)=21
         K(NIEL+4+IRFL+IPOM,3)=NIA1T
         K(NIEL+4+IRFL+IPOM,4)=0
         K(NIEL+4+IRFL+IPOM,5)=0
         K(NIEL+5+IRFL+IPOM,1)=21
         K(NIEL+5+IRFL+IPOM,3)=NIA1T
         K(NIEL+5+IRFL+IPOM,4)=0
         K(NIEL+5+IRFL+IPOM,5)=0
      ENDIF
      K(25,3) = NIEL + 3 + IRFL + IPOM
      K(26,3) = NIEL + 4 + IRFL + IPOM
      K(27,3) = NIEL + 5 + IRFL + IPOM
      IF(IRES(1).EQ.1) THEN
         P(NIEL+1,5)=-DSQRT(dabs(P(NIEL+1,1)**2 + P(NIEL+1,2)**2
     +   + P(NIEL+1,3)**2 - P(NIEL+1,4)**2))
         P(NIEL+2,5)=-DSQRT(dabs(P(NIEL+2,1)**2 + P(NIEL+2,2)**2
     +   + P(NIEL+2,3)**2 - P(NIEL+2,4)**2))
      ENDIF
      NIA1 = NIA1T
C...Deactivate obsolete lines 9, 10, 21, NS+1 (extra lines with boson)
      K(21,1)=0

      IF(K(NS+1,2).EQ.K(3,2)) K(NS+1,1)=0
      K(13,1)=0
      K(14,1)=0
      K(15,1)=0
C...Zero irrelevant lines with K(I,1)<0
      DO 200 I=1,N
         IF(K(I,1).LT.0) THEN
            DO 190 J=1,5
               K(I,J)=0
  190       P(I,J)=0.D0
         ENDIF
  200 CONTINUE
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' LMEPS: before LUEDIT '
         CALL DULIST(1)
      ENDIF
C...Delete internal parton lines, i.e. with K(I,1)=13,14
c      IF(MOD(1/10,10).EQ.0) THEN
      CALL DUEDIT(14)
c      ENDIF
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' LMEPS:after LUEDIT(14) '
         CALL DULIST(1)
      ENDIF
C...Delete empty lines
      CALL DUEDIT(12)
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' LMEPS:after LUEDIT(12) '
         CALL DULIST(1)
      ENDIF
      IF(IPRO.EQ.12.AND.PT2GEN.NE.0.D0) THEN
         phielt=DLANGL(P(1,1),P(1,2))
         CALL DUDBRB(0,0,0.D0,-phielt,0.D0,0.D0,0.D0)
         PZT = DSQRT(P(NF1,4)**2 - P(NF1,5)**2 - PT2GEN)
         STHARD = DLANGL(PZT,DSQRT(PT2GEN))
         CALL DUDBRB(NF1,NF1,STHARD,0.D0,0.D0,0.D0,0.D0)
         CALL DUDBRB(NF1+2,N,STHARD,0.D0,0.D0,0.D0,0.D0)
         phirot=PHIGEN
         CALL DUDBRB(NF1,NF1,0.D0,PHIROT,0.D0,0.D0,0.D0)
         CALL DUDBRB(NF1+2,N,0.D0,PHIROT,0.D0,0.D0,0.D0)
         CALL DUDBRB(0,0,0.D0,phielt,0.D0,0.D0,0.D0)
c       nre=5
c       te11 = P(nre,2)*p(1,3)-p(nre,3)*p(1,2)
c       te12 = P(nre,3)*p(1,1)-p(nre,1)*p(1,3)
c       te13 = P(nre,1)*p(1,2)-p(nre,2)*p(1,1)
c       te21 = P(nre,2)*p(nf1,3)-p(nre,3)*p(nf1,2)
c       te22 = P(nre,3)*p(nf1,1)-p(nre,1)*p(nf1,3)
c       te23 = P(nre,1)*p(nf1,2)-p(nre,2)*p(nf1,1)
c       prod = te11*te21 + te12*te22 + te13*te23
c       write(6,*) 'sc vec_prod ',prod
c       prod=prod/dsqrt(te11**2+te12**2+te13**2)
c       prod=prod/dsqrt(te21**2+te22**2+te23**2)
c       write(6,*) ' LMEPS NF1,phielt,phirot ',NF1,phielt,phirot
c       write(6,*) ' LMEPS checking pt2,phi,phi_calc',pt2gen,phigen
c     &    ,dacos(prod)
c       write(6,*) ' LMEPS checking cos(phi,phi_calc)',cos(phigen)
c     &    ,prod
c         call dulist(1)
      ENDIF

c check for enegy momentum conservation
      DO 220 I=1,N
         IF(P(I,5).LT.0.0D0.OR.K(I,1).GT.2) GOTO 220
         DO 210 J=1,4
            IF(ABS(P(I,J)).LE.1.E-6) THEN
               P(I,J)=0.0D0
            ENDIF
  210    CONTINUE
  220 CONTINUE
      CHEC = 5.D-3
      P1 =ABS(P(1,1)+P(2,1))
      P2 =ABS(P(1,2)+P(2,2))
      P3 =ABS(P(1,3)+P(2,3))
      P4 =ABS(P(1,4)+P(2,4))
      PC1 = (ABS(DPLU(0,1)) - P1)/P4
      PC2 = (ABS(DPLU(0,2)) - P2)/P4
      PC3 = (ABS(DPLU(0,3)) - P3)/P4
      PC4 = (ABS(DPLU(0,4)) - P4)/P4
      IF(DABS(PC1).GT.CHEC.
     +   OR.DABS(PC2).GT.CHEC.
     +   OR.DABS(PC3).GT.CHEC.
     +   OR.DABS(PC4).GT.CHEC) THEN
         write(6,*) ' LMEPS: energy of final particles not correct'
     +   ,chec
         write(6,*) ' PC1 = ',PC1,pC2,pC3,pC4
         write(6,*) ' Q2 = ',Q2,' Q2_calc = ',DOT1(3,3)
         write(6,*) ' yy = ',yy,' y_calc = ',DOT1(2,3)/DOT1(2,1)
         write(6,*) ' x_bj = ',Q2/PARL(22),' W = ',SQRT(-Q2+PARL(22))
         write(6,*) ' IPRO = ',IPRO
         call DULIST(1)
         LST(21) = 100
      ENDIF
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' in gamma pom system '
         CALL DULIST(1)
      ENDIF
      IF(ILEPTO.EQ.1) THEN
         CALL DUDBRB(0,0,STHETA(2),SPHI(2),0.D0,0.D0,0.D0)
         CALL DUDBRB(0,0,0.D0,0.D0,DBETA(2,1),DBETA(2,2),DBETA(2,3))
      ENDIF
c... change z coordinate from LEPTO61 standard to rapgap standard
      do 230 i=1,n
  230 p(i,3) = - p(i,3)
      DO 240 I=1,4
         IF(ABS(P(NIEL,I)).LE.1.E-6) THEN
            P(NIEL,I)=0.0D0
         ENDIF
         P(1,I)=PBEAM(1,I)
         P(2,I)=PBEAM(2,I)
  240 CONTINUE
      IF(NCALL.LE.NPRIN) THEN
         write(6,*) ' after boost dbeta in lmeps'
         CALL DULIST(1)
      ENDIF
      IF(NCHECK.EQ.1) THEN
         write(6,*) ' LMEPS final '
         CALL DULIST(1)
      ENDIF
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.28  by  Hannes Jung
*CMZ :  2.08/00 14/06/99  19.13.58  by  Hannes Jung
*CMZ :  2.07/03 16/05/99  09.40.42  by  Hannes Jung
*-- Author :    Hannes Jung   12/01/95
      SUBROUTINE partdi99(X,WPART)
      IMPLICIT NONE
*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGSTRU.
      REAL SCAL1,XPD1,SCAL2,XPD2
      COMMON/STRU/ SCAL1,XPD1,SCAL2,XPD2
C     SAVE
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      Double Precision PHI
      COMMON/DIFFA/ PHI
      Double Precision draprn
      DOUBLE PRECISION ME,MP
      Double Precision X,XY,WPART,WEIGHT
      COMMON/XVAR/ XY(10)
      DOUBLE PRECISION STHETA,SPHI
      DIMENSION X(20)
      REAL XPQ(-6:6)
      REAL F2CC(-6:6),XF3CC(-6:6)
      Double Precision WMAX
      Integer NDIMC,IMIX,IDEBUG,NDIM,NPOIN,LST,IRES,NTHRE,NVMRE,IGENFL
      COMMON /DIMEN/ NDIMC
      COMMON /OALPHAS/ WMAX,IMIX
      COMMON/ INTERN/IDEBUG
      COMMON/DIVO/ NDIM,NPOIN
      COMMON/EPPARA/LST(30),IRES(2)
      COMMON/HERTHET/ NTHRE,NVMRE
      COMMON/GENWEI/IGENFL
      DOUBLE PRECISION QG2
      COMMON/SEMIH/ QG2
      REAL SNGL
      EXTERNAL draprn
      Double Precision QF,QFT,XR12,SMALL,ALPH_EM,GF,DOT,WTGLU
      Integer ICHECK,NFLAVP,LUCHGE,KPHF,NACC
      Double Precision  WT,W02,W12,YX,SMIN,XP2Q,XG1,XP1MIN
      Double Precision QG2MAX,QG2MIN,QG20,XZOHRN,WQG2
      Double Precision  XP2,SHAT1,PIO,FGAM,FWEI,FLUX
      Double Precision THETE,ECM,PT2,PT,WTG15,XP1,PR,t,at
      Double Precision COSTP,PHIP,PHIO,SPHP,CPHP,STHP,CTHP,BOCHCK
      Double Precision PEP,PEG,PEGZ,POMDGA,PEZ,EN,PZC,WMAT,XPINT,XP
      Integer I,J,IN,KI,MSTJ24,NP,NPP,KPA2,KPAT,KPFL,KPAO,KPAO2
      Integer NDIMEN,NRN,IST,NPFIN,NB2,nafl,KPF,KFLCH,KFLSP


      DATA QF/0.0D0/,W12/0.0D0/
      NDIMEN = NDIM
c      IDEBUG=1
c      write(6,*) ' in partdi99 ',x
      SCAL1 = -99999.
      XPD1 = -99999.
      SCAL2 = -99999.
      XPD2 = -99999.
      DO 10  IN=1,20
         K(IN,1) = 0
         K(IN,2) = 0
   10 CONTINUE

C...  GIVE BEAM  FOUR VECTORS
      DO 20 I=1,2
         DO 20 J=1,5
            K(I,J)=KBEAM(I,J)
   20 P(I,J) = PBEAM(I,J)
      ME =P(1,5)
      MP =P(2,5)
      NP=2
      NPP=3*NP
      N=2

      QF = 0.D0
      NFLAVP = 0

      IF(IPRO.EQ.10.OR.IPRO.EQ.12.OR.IPRO.EQ.13.
     +OR.IPRO.EQ.15.OR.IPRO.EQ.18) THEN
         AM(1) = 0.0D0
         AM(2) = 0.0D0
         IF(IHFLA.GE.4.AND.IPRO.EQ.18) THEN
            KPA=IHFLA
            AM(1) = DBLE(ULMASS(KPA))
            AM(2) = DBLE(ULMASS(KPA))
         ENDIF
      ELSEIF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
         IF(IWEI.EQ.0) THEN
            KPA = 4
            IF(IHFLA.GE.4) KPA=IHFLA
         ELSEIF(IWEI.EQ.1) THEN
         ENDIF
         AM(1) = DBLE(ULMASS(KPA))
         AM(2) = DBLE(ULMASS(KPA))
      ELSEIF(IPRO.EQ.99) THEN
         AM(1) = 0.0D0
         AM(2) = 0.0D0
         AM(3) = 0.0D0
         NP=3
         NPP=3*NP

      ELSE
         WRITE(6,*) ' partdi99: wrong subprocess selected: IPRO = ',IPRO
         WRITE(6,*) '**** PROGRAM STOP ****'
         STOP
      ENDIF
      IF(IPRO.EQ.14.AND.IMIX.EQ.1) THEN
      ELSE
C.. HERE THE LIMITS ON Y( PHOTON ENERGY) AND Q**2 ARE CALCULATED
C... ACCORDING TO PROCEEDINGS OF HERA WORKSHOP 1987
C... ALI ET AL
         W02=(AM(1)+AM(2)+MP)**2
         IF(IPRO.EQ.12) W02=(AM(1)+MP)**2
         IF(AM(1).LT.1.0D0) W02=(1.D0 + MP)**2
         IF(AM(1).LT.1.0D0.and.pt2cut(ipro).ne.0.)
     +     W02=(DSQRT(PT2CUT(IPRO)) + MP)**2
         W12=W02-MP*MP
         YMAX=SSS+W12+DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
         YMAX=YMAX/(2.D0*(SSS+ME*ME))
         YMIN=SSS+W12-DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
         YMIN=YMIN/(2.D0*(SSS+ME*ME))
         IF(YMI.GT.YMIN) YMIN=YMI
         IF(YMA.LT.YMAX) YMAX=YMA
      ENDIF
c         write(6,*) w02
c         WRITE(6,10500) YMIN,YMAX
c10500 FORMAT(' limits on y ',/,
c     +' YMIN = ',E10.5,' YMAX = ',E10.5)

C ... select particle code for light flavour production according
C ... to charges
      IF(IPRO.EQ.10.OR.IPRO.EQ.13.OR.IPRO.EQ.18) THEN

      ELSEIF(IPRO.EQ.99) THEN
         NFLAVP = NFLAV
         KPA = 1
      ENDIF
      IF(IGENFL.EQ.0) THEN
         KPAO = KPA
         KPAO2 = KPA2
      ELSEIF(IGENFL.EQ.1) THEN
         KPA = KPAO
         KPA2 = KPAO2
         IF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
            AM(1)=DBLE(ULMASS(KPA))
            AM(2)=DBLE(ULMASS(KPA2))
         ENDIF
      ENDIF

C... YX IS THE PHOTON ENERGY
C... Q2 FROM PHOTON
C... XP2 IS XGLUON ( MOMENTUM FRACTION OF THE GLUON)
C... XMIN = MIN XGLUON TO PRODUCE THE INV. MASS OF GAMMA GLUON SYSTEM
C... XMAX=1.
CCC
C... GENERATE YX,Q2,XP2 ACCORDING TO 1/X SPECTRUM
C... FGAM IS THE WEIGHT OF EPA
      NRN = 0
c      IRES(1)=0
      XMAX=0.999d0
      IF(IRES(1).EQ.0.OR.IPRO.EQ.12) THEN
c.......
         IF(KE.NE.22) THEN
            NRN = NRN + 1

            YX = YMIN*((YMAX/YMIN)**X(NRN))
c            write(6,*) ' y,ymax,ymin,x(NRN),NRN',yx,ymax,ymin,x(nrn),nrn
            IF(YX.GT.YMAX.OR.YX.LT.YMIN) GOTO 70
            Q2MIN=ME*ME*YX*YX/(1.D0-YX)
            IF(QMI.GT.Q2MIN) Q2MIN = QMI
            Q2MAX=YX*SSS - W12
            IF(QMA.LT.Q2MAX) Q2MAX = QMA
            IF(Q2MAX.LT.Q2MIN) GOTO 80
            NRN = NRN + 1
            IF(QMI.EQ.0.D0) THEN
               Q2 = Q2MIN*((Q2MAX/Q2MIN)**X(NRN))
            ELSE
c new try weighting with 1/q**4
               Q2 = Q2MIN*Q2MAX/(X(NRN)*Q2MIN + Q2MAX*(1.D0 - X(NRN)))
            ENDIF
            XMIN = 0.0D0
            XP2Q=Q2/YX/SSS
            QG2 = 0.D0
            WQG2 = 1.D0
            IF(IPRO.NE.12) THEN
               SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
               XMIN=(SMIN+Q2+QG2)/(YX*SSS)
               IF(IMIX.EQ.1.AND.IWEI.EQ.1) THEN
                  XMIN = DMAX1(XMIN,Q2/YX/SSS)
c                    XMAX = XR12
               ENDIF
            ELSE
               XMIN=Q2/YX/SSS
            ENDIF
         ELSEIF(KE.EQ.22) THEN
            Q2 = 0.D0
            YX = 1.D0
            QG2 = 0.D0
            WQG2 = 1.D0
c               write(6,*) ' partdi99 yx,q2 ',yx,q2
            SMIN = DMAX1(4.D0*PT2CUT(IPRO),2.D0*(AM(1)**2+AM(2)**2))
            XMIN= (SMIN+QG2)/(YX*SSS)
         ELSE
            write(6,*) ' wrong KF selected; program stop '
            YX = 0.D0
         ENDIF
      ELSE
         YX = 0.D0
         XG1 = 0.D0
      ENDIF
      XG1=YX
      XMIN=Q2/YX/SSS
      IF(XMIN.GE.XMAX) GOTO 90
C ... XP2 = E_parton /E_proton

      IF(IPRO.NE.12.AND.IMIX.EQ.0) THEN
         NRN = NRN + 1
         XP2= XMIN*((XMAX/XMIN)**X(NRN))
      ELSEIF(IPRO.NE.12.AND.IMIX.EQ.1.AND.IWEI.EQ.1) THEN
         XP2= XMIN*((XMAX/XMIN)**X(NDIMEN+1))
      ELSEIF(IPRO.EQ.12.OR.IPRO.EQ.100) THEN
         XP2 = Q2/YX/SSS
      ELSE
         XP2 = 0.D0
      ENDIF
c      write(6,*) ' xp2 ',xp2
      IF(SNGL(XP2).GE.0.9999.OR.XP2.LT.XMIN) GOTO 100
      SHAT1 = SSS*XG1*XP2
      IF(IPRO.NE.12)  SHAT1=SSS*XG1*XP2 - Q2 - QG2
c      write(6,*) ' sss,xg1,xp2,q2,qg2 ',sss,xg1,xp2,q2,qg2
      IF(SHAT1.LT.(AM(1)+AM(2))**2) GOTO110

      IST = 0
      YY=SNGL(YX)
      XEL=SNGL(XG1)
      XPR=SNGL(XP2)
      PHI = 99999.D0
      NRN=NRN+1
      PHI = 2.D0*PI*X(NRN)
      CALL PARTI(KE,YX,FGAM,FWEI,1,IST)
      XP=0.D0
      IRES(2)=1
C here do some gymnastics to make cut on theta angle of electron
      IF(THEMA.LT.180.D0.OR.THEMI.GE.0.D0) THEN
C go first to ep LAB system
         CALL DUDBRB(3,3,0.D0,0.D0,CM(1)/CM(4),CM(2)/CM(4),CM(3)/CM(4))
         THETE = DPLU(3,14)
         CALL DUDBRB(3,3,0.D0,0.D0,-CM(1)/CM(4),
     +                -CM(2)/CM(4),-CM(3)/CM(4))
c         CALL DULIST(1)
         IF(THETE .GT. 180.01D0) THEN
            WRITE(6,*) ' FATAL: theta_electron > 180 deg ',THETE
         ENDIF
         IF(THETE .GE. THEMA) GOTO 120
         IF(THETE .LE. THEMI) GOTO 120
      ENDIF
C end of these gymnastics

C FINAL STATE PROTON
      NPFIN=NIA1+4
      IF(IPRO.EQ.99) THEN
         NPFIN=NIA1+5
      ENDIF
      N=NPFIN
      K(NPFIN,1)=1
      K(NPFIN,2)=KP
      K(NPFIN,3)=2
      P(NPFIN,5)=DBLE(ULMASS(KP))
      PR = P(2,3)*(1.D0 - XP2)
      P(NPFIN,4) = PR
      CPHP=1.D0
      SPHP=DSQRT(1.D0 - CPHP**2)
	STHP=1.D0
      IF(DABS(STHP).GT.1.D0) goto 180
      CTHP=DSQRT(1.D0 - STHP**2)
      P(NPFIN,1)= PR*STHP*CPHP
      P(NPFIN,2)= PR*STHP*SPHP
      P(NPFIN,3)= PR*CTHP
c      CALL DULIST(1)
C MOMENTA OF PARTON
      K(NIA1+1,1)=21
      K(NIA1+1,2)=KGL
      IF(IPRO.EQ.12) K(NIA1+1,2) = KPA
      K(NIA1+1,3)=2
      DO 30  KI=1,4
         P(NIA1+1,KI)=P(2,KI)-P(NPFIN,KI)
   30 CONTINUE
      IF(ISEMIH.EQ.0) THEN
         P(NIA1+1,4)=ABS(P(NIA1+1,3))
         P(NIA1+1,5)=0.0D0
      ELSE
         P(NIA1+1,4)=DSQRT(P(NIA1+1,1)**2+P(NIA1+1,2)**2+P(NIA1+1,3)**2
     +               - QG2)
         P(NIA1+1,5)=-sqrt(ABS(DOT1(NIA1+1,NIA1+1)))
      ENDIF
      NIA2 = NIA1+1
c      write(6,*) ' partdi99 p(nia2,5)**2',DOT1(NIA2,NIA2)
c      write(6,*) ' partdi99 p(npfin,5)**2',DOT1(NPFIN,NPFIN)
c      write(6,*)  ' partdi99 '
c      call dulist(1)
c      pause
      IF(IPRO.NE.12) THEN
         NF1=NIA1+2
         NF2=NIA1+3
         K(NF1,1)=2

         IF(IPRO.EQ.15) THEN

         ELSE
            K(NF2,2)=KPA2
         ENDIF
         IF(IPRO.NE.15.AND.IPRO.NE.12) KPF=KPA
         K(NF1,2)=KPF
         K(NF1,3)=NIA1
         K(NF2,1)=1
         K(NF2,3)=NIA1
         P(NF1,5)=AM(1)
         P(NF2,5)=AM(2)
         NB2 = NIA2
         IF(IPRO.EQ.99) THEN
            NF1=NIA1+2
            NF2=NIA1+4
            K(NF1,1)=2
            K(NF1+1,1)=2
            K(NF2,1)=1
            K(NF1,2)=KPF
            K(NF1+1,2)=21
            K(NF2,2)=-KPF
            K(NF1,3)=NIA1
            K(NF1+1,3)=NIA1
            K(NF2,3)=NIA1
         ENDIF
C...   VECTOR OF GAMMA GLUON CMS SYSTEM

      ELSE
         NB2 = 0
      ENDIF
      DBCMS(1)=  P(NIA1,1) + P(NB2,1)
      DBCMS(2)=  P(NIA1,2) + P(NB2,2)
      DBCMS(3)=  P(NIA1,3) + P(NB2,3)
      DBCMS(4)=  P(NIA1,4) + P(NB2,4)
      DO 40  I=1,4
         P(NF1,I)=0.0D0
         P(NF2,I)=0.0D0
   40 CONTINUE
      SHAT=DOT(DBCMS,DBCMS)
      IF(SHAT.LE.0.0) THEN
         GOTO 140
      ENDIF
c          call dulist(1)
C NOW BOOST TO GAMMA GLUON
      BOCHCK = (DBCMS(1)/DBCMS(4))**2 + (DBCMS(2)/DBCMS(4))**2 +
     +(DBCMS(3)/DBCMS(4))**2
      BOCHCK = DSQRT(BOCHCK)
      IF(BOCHCK.GT.0.99999999D0) goto 130
      CALL DUDBRB(0,N,0.D0,0.D0,-DBCMS(1)/DBCMS(4),-DBCMS(2)/DBCMS(4),
     +-DBCMS(3)/DBCMS(4))
      SPHI = DLANGL(P(NIA1,1),P(NIA1,2))
      call DUDBRB(0,0,0.D0,-sphi,0.d0,0.d0,0.d0)
      STHETA = DLANGL(P(NIA1,3),P(NIA1,1))
      call DUDBRB(0,0,-STHETA,0.D0,0.d0,0.d0,0.d0)
      IF(IPRO.NE.12) THEN
C NOW  LOOK THAT WE REALLY HAVE ENOUGH ENERGY IN GAMMA GLUON CMS SYSTEM
C...  ECM = CMS ENERGY OF GAMMA GLUON SYSTEM
c         write(6,*) ECM
         ECM =DSQRT(SHAT)
C      IF(ECM.LE.(AM(1)+AM(2))) WRITE(6,*) ' ECM LE MASS',ECM
         IF(ECM.LE.(AM(1)+AM(2))) GOTO 150
c         write(6,*) ' IPRO = 13 ,NRN= ',NRN
         IF(IPRO.EQ.99) THEN
            NRN=NRN+1
            XY(1)=X(NRN)
            NRN=NRN+1
            XY(2)=X(NRN)
            NRN=NRN+1
            XY(3)=X(NRN)
            NRN=NRN+1
            XY(4)=X(NRN)
            NRN=NRN+1
            XY(5)=X(NRN)
         ELSE
            IF(IMIX.EQ.1.AND.IWEI.EQ.1) THEN
               XY(1)=X(NDIMEN+3)
               XY(2)=X(NDIMEN+4)
            ELSE
               NRN = NRN + 1
               XY(1) = X(NRN)
               NRN = NRN + 1
               XY(2) = X(NRN)
            ENDIF
         ENDIF
c         write(6,*) am(1),am(2),ipro
c         write(6,*) 'partdi99 ',XY(1),XY(2),NDIM,NDIMEN,IMIX,IWEI
         CALL PHASE(NP,ECM,AM,PCM,WT)
         IF(WT.LE.0.D0) GOTO 160
         IF(IPRO.EQ.99) THEN
            DO 50 I=1,4
               P(NF1,I)=PCM(I,1)
               P(NF1+1,I)=PCM(I,2)
               P(NF2,I)=PCM(I,3)
               P(NF1,5)=AM(1)
               P(NF1+1,5)=AM(2)
               P(NF2,5)=AM(3)
   50       CONTINUE
         ELSE
            DO 60 I=1,4
               P(NF1,I)=PCM(I,1)
               P(NF2,I)=PCM(I,2)
   60       CONTINUE
         ENDIF
c         write(6,*) ' partdi99 ', KPA,KPA2,K(NF1,2),K(NF2,2)
         PT2 = DPLU(NF1,9)
         CALL CUTG(PT2,NACC)
         IF(NACC.EQ.0) GOTO 170
cscale        IF(IPRO.EQ.11.OR.IPRO.EQ.14) THEN
cscale             Q2Q = (AM(1)+AM(2))**2
cscale            Q2Q = (AM(1)+AM(2))**2 + Q2
cscale         ELSE
         IF(IQ2.EQ.1) THEN
            Q2Q = (2.D0*AM(1))**2
         ELSEIF(IQ2.EQ.2) THEN
            Q2Q = SHAT
         ELSEIF(IQ2.EQ.3) THEN
            Q2Q = (2.D0*AM(1))**2 + PT2
         ELSEIF(IQ2.EQ.4) THEN
            Q2Q = Q2
         ELSEIF(IQ2.EQ.5) THEN
            Q2Q = Q2 + PT2 + (2.D0*AM(1))**2
c this is for testing
         ELSEIF(IQ2.EQ.6) THEN
c torbjorn suggestion
            Q2Q = PT2 + 8.D0*PT2**2/SHAT
C kt**2 as from Zeppenfeld/Mirkes
            t = AM(1)**2 - 2.D0 * DOT1(NIA1,NF1) - P(NIA1,5)**2
            at=DSQRT((t+Q2)**2+4.D0*Q2*PT2)
            Q2Q = at*(at+t+Q2)/2.D0/Q2
c         write(6,*) 'partdi99 : t,PT2,Q2,Q2Q ',t,PT2,Q2,Q2Q
         ELSEIF(IQ2.EQ.7) THEN
c torbjorn suggestion
            Q2Q = PT2 + 8.D0*PT2**2/SHAT
         ELSE
            WRITE(6,*) ' NO VALID Q2 SCALE. STOP'
            STOP
         ENDIF
cscale         ENDIF
         IF(IQ2.EQ.5) THEN
            Q2Q = Q2 + PT2*SCALFA + (2.D0*AM(1))**2
         ELSE
            Q2Q = SCALFA*Q2Q
         ENDIF

C BOOST BACK TO OVERALL CMS ( now done in FXN1 )
         call DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
         call DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
         XPR = SNGL(XP2)
c         IDIRO = IDIR
c         IDIR = 0
         if(xp2.GT.1.d0) write(6,*) 'partdi99 xp2>1',xp2,ipro
c         write(6,*) 'partdi99 xp2,xg1',xp2,xg1
         CALL PYSTFU(K(2,2),SNGL(XP2),SNGL(Q2Q),XPQ)

c         IDIR = IDIRO
C... WTGLU IS THE WEIGHT FOR XGLUON GENERATION
c for resolved photon move parton densities into ELERES
         IF(IRES(1).EQ.1) THEN
            XP = 1.D0/XP2
         ELSE
c            write(6,*) ' partdi99 ires=0'
            XP = DBLE(XPQ(0))/XP2
         ENDIF
         SCAL2 = SNGL(Q2Q)
         XPD2 = XPQ(0)
         XPINT=DLOG(XMAX/XMIN)
         WTGLU = XP2 * XP * XPINT

         IF(ISEMIH.EQ.1.AND.IPRO.NE.12.AND.IPRO.NE.15)
     +      WTGLU = WTGLU*WQG2
         WMAT=WT *WTGLU*FGAM*FWEI
         WMAT=WMAT/((2.D0*PI)**NPP)
C...  FLUX = FLUX USED FOR X-SECTION CALCULATION
         FLUX=(2.D0*PI)**4
         FLUX=FLUX/(2.D0*(SHAT+Q2))
         WPART = WMAT *FLUX
         IF(IPRO.EQ.13.OR.IPRO.EQ.14.OR.IPRO.EQ.15.OR.IPRO.EQ.99) THEN
            WPART = WTGLU * FWEI * WT
            IF(IPRO.EQ.15) THEN
               WPART = WPART*FLUX/((2.D0*PI)**NPP)
            ENDIF

         ENDIF
c         IF(WPART.LE.0) THEN
c           write(6,*) ' partdi99: SHAT,Q2 ',SHAT,Q2
c           write(6,*) ' partdi99: WTGLU,FWEI,WT,FGAM',WTGLU,FWEI,WT,FGAM
c           write(6,*) ' partdi99: XP2,XPINT,XP,WQG2 ',XP2,XPINT,XP,WQG2
c           call dulist(1)
c           ENDIF
         PT2H = SNGL(PT2)
         SHH = SNGL(SHAT)
c           call dulist(1)


      ENDIF
      NDIMC = NRN
c      write(6,*) ' end of partdi99 ',NDIMC,NRN
c      CALL DULIST(1)
c      write(6,*)  'partdi99: WPART ',WPART
      IF(IGENFL.EQ.0) THEN
         KPAO = KPA
         KPAO2 = KPA2
      ELSE
         KPA = KPAO
         KPA2 = KPAO2
      ENDIF
c      write(6,*) ' partdi99 end ,kpa,kpa1,kpa2,kpao2',kpa,kpa1,kpa2,kpao2
      RETURN
   70 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi99: ylimit ; RETURN ',yx,ymin,ymax,x(1)
      ENDIF
      NDIMC = 9999
      RETURN
   80 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi99: Q2limit ; RETURN ',Q2,Q2MIN,Q2MAX
         NDIMC = 9999
      ENDIF
      RETURN
   90 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi99: xlimit ; RETURN xmin,xmax',xmin,xmax
      ENDIF
      NDIMC = 9999
      RETURN
  100 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi99: xp2imit ; RETURN '
      ENDIF
      NDIMC = 9999
      RETURN
  110 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi99: slimit ; RETURN ',shat1,am(1),am(2),IPRO
         write(6,*) ' sss,xg1,xp2,q2,qg2 ',sss,xg1,xp2,q2,qg2
         write(6,*) ' partdi99 q2,y,sss',q2,yx,sss
      ENDIF
      NDIMC = 9999
      RETURN
  120 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi99: theta limit ; RETURN '
      ENDIF
      NDIMC = 9999
      IF(IHERAC.EQ.1) THEN
         NTHRE = NTHRE +1
      ENDIF
      RETURN
  130 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi99: bochck limit ; RETURN '
      ENDIF
      NDIMC = 9999
      RETURN
  140 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi99: shat ; RETURN '
      ENDIF
      NDIMC = 9999
      RETURN
  150 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi99: ECM limit ; RETURN '
      ENDIF
      NDIMC = 9999
      RETURN
  160 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi99: PHASE WT=0 ; RETURN '
      ENDIF
      NDIMC = 9999
      RETURN

  170 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi99: PTCUT limit ; RETURN ',PT2,KPA
      ENDIF
      NDIMC = 9999
      RETURN
  180 CONTINUE
      WPART = 0.D0
      IF(IDEBUG.EQ.1) THEN
         write(6,*) ' partdi99: QG2 limit ; RETURN ',DSQRT(QG2),PR,STHP
      ENDIF
      NDIMC = 9999
      RETURN


      END
*CMZ :  2.08/06 31/03/2000  11.20.05  by  Hannes Jung
*CMZ :  2.08/05 27/03/2000  15.57.41  by  Hannes Jung
*CMZ :  2.08/04 08/01/2000  16.54.02  by  Hannes Jung
*CMZ :  2.08/02 04/11/99  16.39.09  by  Hannes Jung
*CMZ :  2.08/00 14/06/99  19.13.58  by  Hannes Jung
*-- Author :    Hannes Jung   29/05/99
      Subroutine RGSATRAP(X,WDIF)
      Implicit NONE
*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.
      Double Precision X(20)
      Double Precision WDIF

      Double Precision  Xlow, Xup

      Double Precision  Stot, Q2s, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2s, W2, Mx2, AJAC
      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf

      Double Precision    DLQQT, DLQQL, DLQQGT, DLQQGL, DLTOT
      Double Precision    DCQQT, DCQQL, DCQQGT, DCQQGL, DLCTOT
      COMMON /CCOMPCROS/  DLQQT, DLQQL, DLQQGT, DLQQGL, DLTOT,
     &                    DCQQT, DCQQL, DCQQGT, DCQQGL, DLCTOT

      Integer         NQUAD
      COMMON /CNQUAD/ NQUAD

      Double Precision  DSIGMax,  Mx, W, DUM
	Data DUM/0.d0/
      Double Precision  EPS
      Common  /mysatrap/EPS
      Double Precision  Kt2Min, Kt2Max
      Double Precision  ZWMin, ZWMax
      Double Precision  THREEDOT
      Double Precision  Pi
      Integer NMaxWe, Iev
      Double Precision W02,W12
      DOUBLE PRECISION ME,MP
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C Get Parameters of the Wuesthoff Model

      Call SATURPAR
C -----------------------------------------------------

      WDIF = 0.
      ME =0.511e-3
      MP =0.938


      Stot = SSS

c calculate kinematically alowed y range:
      W02=(1.+MP)**2
      W12=W02-MP*MP
      YMAX=SSS+W12+DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
      YMAX=YMAX/(2.D0*(SSS+ME*ME))
      YMIN=SSS+W12-DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
      YMIN=YMIN/(2.D0*(SSS+ME*ME))


      IF(YMI.GT.YMIN) YMIN=YMI
      IF(YMA.LT.YMAX) YMAX=YMA
c     write(6,*) 'rgsatrap ',ymin,ymax

c Mx limits moved to    RGQ2W2Mx

      NQUAD = 24

c     write(6,*) ' in RGSATRAP '

c Compute diffractive sigma's by MC computation

      Call RGQ2W2Mx(X)
      IF(AJAC.LE.0) RETURN
      Call INPUTKINE

      Call COMPCROSS

      EPS = 2.*(1.-YBj)/(1.+(1.-YBj)**2)

      DLTOT = DLQQT+DLQQGT + EPS*(DLQQL)
      DLCTOT= DCQQT+DCQQGT + EPS*(DCQQL+DCQQGL) + DLTOT

      IF(DLCTOT.LE.0.0) DLCTOT=0.
      WDIF = DLCTOT

      Return
      End
*CMZ :  2.08/05 27/03/2000  15.59.09  by  Hannes Jung
*CMZ :  2.08/04 22/12/99  15.39.29  by  Hannes Jung
*CMZ :  2.08/02 02/11/99  12.47.44  by  Hannes Jung
*CMZ :  2.08/00 14/06/99  19.13.58  by  Hannes Jung
*-- Author :    Hannes Jung   30/05/99
      Subroutine RGSATREV
      Implicit None

      Double Precision  LIMKIND
      Integer           IKIND,      Nevent, Ievent
      Common /CKIND/    LIMKIND(20),IKIND , Nevent, Ievent
      Integer QFKF
      Double Precision    MQUARK, MCHARM
      COMMON /CQMASS/     MQUARK, MCHARM, QFKF

      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf
      Double Precision  Stot, Q2, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2, W2, Mx2, AJAC

      Double Precision    DLQQT, DLQQL, DLQQGT, DLQQGL, DLTOT
      Double Precision    DCQQT, DCQQL, DCQQGT, DCQQGL, DLCTOT
      COMMON /CCOMPCROS/  DLQQT, DLQQL, DLQQGT, DLQQGL, DLTOT,
     &                    DCQQT, DCQQL, DCQQGT, DCQQGL, DLCTOT

      Double Precision  EPS
      Common  /mysatrap/EPS
      Double Precision BOCHCK,SPHI,STHETA,PEP,PEZ,PEG,PEGZ
      Double Precision POMDGA,EN,PZC,PT,t2,CPHP,SPHP,spom,PHIP
      Integer NPFIN,NDFF,KI
      Double Precision RN,DOT
      Double Precision  Pi
      Double Precision draprn
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEND.

      PI = 3.1415927
      YY = Ybj
      XEL = Ybj
      XPR = Xbj
      T2GKI = Tdf
      XFGKI = xpom

      DLTOT = DLQQT+DLQQGT + EPS*(DLQQL+DLQQGL)
      DLCTOT= DCQQT+DCQQGT + EPS*(DCQQL+DCQQGL) + DLTOT

      LIMKIND(1) = DLQQT/DLCTOT
      LIMKIND(2) = LIMKIND(1) + EPS*DLQQL/DLCTOT
      LIMKIND(3) = LIMKIND(2) +     DLQQGT/DLCTOT
      LIMKIND(4) = LIMKIND(3) + EPS*DLQQGL/DLCTOT

      LIMKIND(5) = LIMKIND(4) +      DCQQT/DLCTOT
      LIMKIND(6) = LIMKIND(5) +  EPS*DCQQL/DLCTOT
      LIMKIND(7) = LIMKIND(6) +      DCQQGT/DLCTOT
      LIMKIND(8) = LIMKIND(7) +  EPS*DCQQGL/DLCTOT


      IKIND = 20
      RN = draprn()
      If(RN.le.LIMKIND(1))                      IKIND = 1
      If(RN.gt.LIMKIND(1).and.RN.le.LIMKIND(2)) IKIND = 2
      If(RN.gt.LIMKIND(2).and.RN.le.LIMKIND(3)) IKIND = 3
      If(RN.gt.LIMKIND(3).and.RN.le.LIMKIND(4)) IKIND = 4

      If(RN.gt.LIMKIND(4).and.RN.le.LIMKIND(5)) IKIND = 11
      If(RN.gt.LIMKIND(5).and.RN.le.LIMKIND(6)) IKIND = 12
      If(RN.gt.LIMKIND(6).and.RN.le.LIMKIND(7)) IKIND = 13
      If(RN.gt.LIMKIND(7).and.RN.le.LIMKIND(8)) IKIND = 14

      MQUARK = 0.0001
      If(ikind.gt.10) Then
         MQUARK = MCHARM
      Endif
      If(IKIND.eq.20) Then
         Write(*,*) 'Error IKIND '
      Endif
c     write(6,*) ' dulist '
c     write(6,*) ' in gamma p '
c     call dulist(1)
      NDFF = 4
      NF1 = NIA1+2
      NF2 = NIA1+3
      if(ikind.eq.3.or.ikind.eq.4.or.ikind.eq.13.or.ikind.eq.14) Then
         NF2 = NIA1+4
         Ndff = 5
      Endif
c     write(6,*) ' ikind ',ikind,' ndff ',ndff
      NPFIN=NIA1+NDFF
      N=NPFIN
      K(NPFIN,1)=1
      K(NPFIN,2)=KP
      IF(IABS(KINT(2,2)).EQ.211) K(NPFIN,2) = 2112
      K(NPFIN,3)=2
      P(NPFIN,5)=DBLE(ULMASS(K(NPFIN,2)))
c for construction of  pomeron goto gamma p system
      DBCMS(1)=  P(NIA1,1) + P(2,1)
      DBCMS(2)=  P(NIA1,2) + P(2,2)
      DBCMS(3)=  P(NIA1,3) + P(2,3)
      DBCMS(4)=  P(NIA1,4) + P(2,4)
      BOCHCK = (DBCMS(1)/DBCMS(4))**2 + (DBCMS(2)/DBCMS(4))**2
     +              + (DBCMS(3)/DBCMS(4))**2
      BOCHCK = DSQRT(BOCHCK)
      IF(BOCHCK.GT.0.99999999D0) goto 20
      CALL DUDBRB(0,0,0.D0,0.D0,
     +  -DBCMS(1)/DBCMS(4),-DBCMS(2)/DBCMS(4),
     +  -DBCMS(3)/DBCMS(4))
      SPHI = DLANGL(P(NIA1,1),P(NIA1,2))
      CALL DUDBRB(0,0,0.D0,-sphi,0.d0,0.d0,0.d0)
      STHETA = DLANGL(P(NIA1,3),P(NIA1,1))
      CALL DUDBRB(0,0,-STHETA,0.D0,0.d0,0.d0,0.d0)
c new
      PEP = DSQRT(P(2,3)**2 + DBLE(ULMASS(KP)**2))
      P(2,4) = PEP
      PEZ = ABS(P(2,3))
      PEG = P(NIA1,4)
      PEGZ = DABS(P(NIA1,3))
c     write(6,*) ' y = ',ybj,' xpom ',xpom
cres      POMDGA = XR * YX * SSS/2.D0
      POMDGA = xpom * Ybj * SSS/2.D0
      T2 = -Tdf
      EN= PEZ*(PEGZ*PEZ+PEG*PEP)/(PEZ*PEG+PEP*PEGZ) - ((T2-P(2,5)**2-
     +P(NPFIN,5)**2)*PEGZ/2.D0 + POMDGA*PEZ)/(PEZ*PEG+PEP*PEGZ)
      P(NPFIN,4) = EN
      PZC =       - (PEP*(PEGZ*PEZ+PEG*PEP)/(PEZ*PEG+PEP*PEGZ) +
     +             ((T2-P(2,5)**2-P(NPFIN,5)**2)*PEG/2.D0
     +             - POMDGA*PEP)/(PEZ*PEG+PEP*PEGZ))
      P(NPFIN,3) = PZC
      PT = (-(T2-P(NPFIN,5)**2)*(PEGZ*PEZ+PEG*PEP)**2 + (T2-P(2,5)**2-
     +P(NPFIN,5)**2)**2*Q2/4.D0 -P(NPFIN,5)**2*POMDGA**2 +(T2+P(2,5)**
     +2-P(NPFIN,5)**2)*POMDGA *(PEGZ*PEZ+PEG*PEP) )/(PEZ*PEG+PEGZ*PEP)*
     +*2 - P(2,5)**2
      PHIP=2.D0*PI*draprn()
      SPHP=DSIN(PHIP)
      CPHP=DCOS(PHIP)
      P(NPFIN,1) = DSQRT(DMAX1(0.D0,PT))*CPHP
      P(NPFIN,2) = DSQRT(DMAX1(0.D0,PT))*SPHP
      CALL DUDBRB(0,0,STHETA,0.D0,0.d0,0.d0,0.d0)
      CALL DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
      CALL DUDBRB(0,0,0.D0,0.D0,
     +  DBCMS(1)/DBCMS(4),DBCMS(2)/DBCMS(4),
     +  DBCMS(3)/DBCMS(4))
c MOMENTA OF POMERON
      K(NIA1+1,1)=21
      K(NIA1+1,2)=KINT(2,2)
      K(NIA1+1,3)=2
      DO 10  KI=1,4
         P(NIA1+1,KI)=P(2,KI)-P(NPFIN,KI)
   10 CONTINUE
      P(NIA1+1,5)=-sqrt(ABS(DOT1(NIA1+1,NIA1+1)))
	Nia2 = Nia1 + 1
      T2GKI=-SNGL(P(NIA1+1,5)**2)
c      IF(IDEBUG.EQ.1) THEN
c         write(6,*) ' PARTDF: T2GKI,T2 ',T2GKI,T2
c         write(6,*) ' partdf: yx=',yx,dot1(nia1,2)/dot1(1,2)
c         write(6,*) ' partdf: xr=',xr,dot1(nia1,nia1+1)/dot1(nia1,2)
c      ENDIF
c for construction of parton in pomeron goto gamma pomeron system
c     write(6,*) ' back in gamma p system '
c     call dulist(1)

      DBCMS(1)=  P(NIA1,1) + P(NIA1+1,1)
      DBCMS(2)=  P(NIA1,2) + P(NIA1+1,2)
      DBCMS(3)=  P(NIA1,3) + P(NIA1+1,3)
      DBCMS(4)=  P(NIA1,4) + P(NIA1+1,4)
      spom = dot(dbcms,dbcms)
      shh = spom
c      write(6,*) ' rgsatrev spom,t2,pt ',spom,t2,pt
      IF(SPOM.LT.0.0D0) GOTO 30
      BOCHCK = (DBCMS(1)/DBCMS(4))**2 + (DBCMS(2)/DBCMS(4))**2
     +              + (DBCMS(3)/DBCMS(4))**2
      BOCHCK = DSQRT(BOCHCK)
      IF(BOCHCK.GT.0.99999999D0) goto 40
c      write(6,*) ' now goto gamma pomeron '
      CALL DUDBRB(0,0,0.D0,0.D0,
     +  -DBCMS(1)/DBCMS(4),-DBCMS(2)/DBCMS(4),
     +  -DBCMS(3)/DBCMS(4))
      SPHI = DLANGL(P(NIA1,1),P(NIA1,2))
      CALL DUDBRB(0,0,0.D0,-sphi,0.d0,0.d0,0.d0)
      STHETA = DLANGL(P(NIA1,3),P(NIA1,1))
      CALL DUDBRB(0,0,-STHETA,0.d0,0.d0,0.d0,0.d0)
c end new


c  here construct the full event record in gamma pom system
c     call dulist(1)
c  reconstruct  four vectors of all partons
      Call PartKine
c     write(6,*) 'before rotate back'
c     call dulist(1)

      CALL DUDBRB(0,0,STHETA,0.d0,0.d0,0.d0,0.d0)
c     write(6,*) 'after theta rotate back'
c     call dulist(1)
      CALL DUDBRB(0,0,0.D0,sphi,0.d0,0.d0,0.d0)
c     write(6,*) 'after phi rotate back'
c     call dulist(1)
      CALL DUDBRB(0,0,0.D0,0.D0,
     +  DBCMS(1)/DBCMS(4),DBCMS(2)/DBCMS(4),
     +  DBCMS(3)/DBCMS(4))
c     write(6,*) 'after boost back'
c     call dulist(1)

      Return
   20 write(6,*) ' BOCHCK 1 ',BOCHCK
c     call dulist(1)
      Return
   30 write(6,*) ' SPOM ',spom
c     call dulist(1)
      Return
   40 write(6,*) ' BOCHCK 2 ',BOCHCK,ybj
c      call dulist(1)
      Return
      End
*CMZ :  2.08/05 27/03/2000  16.02.31  by  Hannes Jung
*CMZ :  2.08/04 10/01/2000  08.13.10  by  Hannes Jung
*CMZ :  2.08/02 04/11/99  16.39.09  by  Hannes Jung
*CMZ :  2.08/00 14/07/99  10.14.21  by  Hannes Jung
*-- Author :
C-------------------------------------------------------------------------
      SUBROUTINE RGQ2W2MX(X)
*-- Author :   H. Kowalski
C     Routine generates variables (Q2,W2,Mx2) and the
C     corresponding Jacobian factor AJAC in Common /CQ2W2MX/
C     The variables (Q2,W2,Mx2) are generated between limits
c     given in COMMON /GDLIMIT/
C     The routine computes also from Q2,W2,Mx2 the  variables
c     YBj, XBj, Xpom and Beta and puts them in COMMON /GDVARB1/
c
c     it generates also the variable Tdf (which plays a role of t)
c     Tdf generation is preliminary because it is to primitive
C-----------------------------------------------------------------------
      Implicit NONE
      Double Precision X(20),XG(20)
      Integer NDIMC
      COMMON /DIMEN/ NDIMC

      Double Precision Q2mins, Q2maxs, W2min, W2max, Mxmin, Mxmax
      COMMON /GDLIMIT/ Q2mins, Q2maxs, W2min, W2max, Mxmin, Mxmax

      Double Precision  Stot, Q2s, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2s, W2, Mx2, AJAC
      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf

      Double Precision  R02, LAM, SIGM0, X0, ALPHAS
      COMMON /SATURM/   R02, LAM, SIGM0, X0, ALPHAS

      DOUBLE PRECISION Q2JAC, Yjac, MxJAC

      Double Precision  RANUNI
      External          RANUNI
      Double Precision  TWOPI
      Double Precision  W2min1, W2max1,Mx2min,Mx2max
      Double Precision  W, Mx, Rsta, Rend, Tmin, Tend, mprot

      Double Precision RNQ2,RNW2,RNMX,RNT
      Double Precision YX,FGAM,FWEI,W12,W02
      Double Precision W2IN
      DOUBLE PRECISION ME,MP
      Integer NRN,I,J
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGPARA1.
      DOUBLE PRECISION SHAT,YMAX,YMIN,Q2,Q2MAX,Q2MIN
      DOUBLE PRECISION XMAX,XMIN,Q2Q,AM,PCM
      COMMON /PARAT/AM(18),SHAT,YMAX,YMIN,Q2MAX,Q2MIN,XMAX,XMIN
      COMMON /PARAE/Q2,Q2Q,PCM(4,18)
C      SAVE
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.
      Double Precision draprn
      Double precision pi

      Double Precision PHI
      COMMON/DIFFA/ PHI
      LOGICAL DEBUG
      PI = 4.D0*DATAN(1.D0)
      DEBUG = .FALSE.
C...  GIVE BEAM  FOUR VECTORS
      DO 10 I=1,2
         DO 10 J=1,5
            K(I,J)=KBEAM(I,J)
   10 P(I,J) = PBEAM(I,J)
      N=2
      ME =0.511e-3
      MP =0.938
      TWOPI = 6.2831853
c     write(6,*) ' RGQ2W2MX ',IHERAC
      NRN = 0

      IF(IHERAC.EQ.0) THEN


C
C- generate the Q2 variable
C-
         NRN = 0
         NRN = NRN + 1
         Ybj = ymin*(Ymax/Ymin)**X(NRN)
C
C- generate the Ybj variable
C-
         Ybj = ymin*(Ymax/Ymin)**X(NRN)
         YJAC = Ybj * Dlog(Ymax/Ymin)
C-
         NRN = NRN + 1
         W02=(1.+MP)**2
         W12=W02-MP*MP
         Q2MIN=ME*ME*Ybj*Ybj/(1.D0-Ybj)
         Q2MAX=Ybj*SSS - W12
         IF(QMI.GT.Q2MIN) Q2MIN = QMI
         IF(QMA.LT.Q2MAX) Q2MAX = QMA
         Q2mins = Q2MIN
         Q2maxs = Q2MAX
         Q2=Q2MIN*((Q2MAX/Q2MIN)**X(NRN))
         Q2s = Q2
         Q2JAC = Q2*DLOG(Q2MAX/Q2MIN)
         Xbj = Q2/Ybj/Stot
         PHI = 2.D0*PI*draprn()
         NDIMC = NRN
         CALL draprnV(XG,2)
         DO I=1,2
           X(NDIMC+I)=XG(I)
         ENDDO
      ELSEIF(IHERAC.EQ.1) THEN
         NRN = 2
         Ybj = YHS
         XBj = XHS
         Q2 = Q2HS
         Q2s = Q2
         YJAC = 1.
         Q2JAC = 1.

      ELSE
         write(6,*) ' RGQ2W2Mx: wrong process IHERAC = ',IHERAC
      ENDIF

      YX = Ybj
      W2 = -Q2 + ybj*Stot
      W=sqrt(W2)

      XMAX=1.d0-XF
      if(XBJ.GE.XMAX) THEN
         AJAC = 0.
         RETURN
      ENDIF
      Mxmin = 0.3

      Mxmax = max(Mxmin,dsqrt(Q2*(XMAX-XBJ)/XBJ))
c     write(6,*) ' rgQ2W2MX: Mxmin Mxmax ',Mxmin,Mxmax,xbj,stot
c     write(6,*) ' rgQ2W2MX: ymin,ymax ',ymin,ymax,ybj,q2

      CALL PARTI(KE,YX,FGAM,FWEI,1,0)

c     write(6,*) ' RGQ2W2MX '
c     call dulist(1)
c     write(6,*) ' rgq2w2mx ',FGAM,FWEI,yx,q2
c     write(6,*) ' rgq2w2mx min ',ymin,ymax,q2min,q2max

      IF(IHERAC.EQ.0) THEN
         YJAC = YJAC * FGAM
      ENDIF
C-
C- generate the Mx variable
C-

      NRN = NRN + 1
      RNMX = DLOG(Mxmin) + X(NRN)*(DLOG(Mxmax) - DLOG(Mxmin))
      Mx = DEXP(RNMX)
      MxJAC = Mx * DLOG(Mxmax/Mxmin)

      Mx2 = Mx**2

      AJAC = Q2jac*Yjac*Mxjac

c  Generate the (positive) t variable in the range t=Tmin to t= Tend
c      Tend = 5.
      Tend = T2MAX
      If(Tend.Gt.Q2) Tend = Q2 - 0.1
      Tend = -Tend
      Tmin = 0.
      Rsta = DEXP(Tend)
      Rend = DEXP(Tmin)
      NRN = NRN + 1
      RNT = Rsta + X(NRN)*(Rend-Rsta)
      Tdf = -DLOG(RNT)/6.
cccc      NDIMC = NRN
c       write(6,*) 'rgq2w2mx MX,t ',Mx2,tdf
c       write(6,*) 'rgq2w2mx x(3),x(4) ',(x(i),i=1,ndimc)
c       Tdf = 0.
C-
C-  compute the variables xb, xg, eta
C-
      Xbj = Q2/STOT/YBj
      beta = Q2/(Mx2 + Q2 + Tdf)
      Xpom = (Mx2 + Q2 + Tdf)/(W2 + Q2)
C-
      R02 = (XPOM/X0)**LAM
c      write(*,1001) Q2,Mx,W,R02,Tdf
10000 Format('Q2 ,Mx, W, R02', 5f10.2)
c  Tmin condition
      mprot = 0.9383
      tmin = mprot**2*Xpom**2/(1.-Xpom)

      If(Tdf.lt.tmin) Then
         AJAC = 0.
c         write(*,*) '***  t < Tmin  ***', Tdf, tmin
      Endif
C-

   20 RETURN
      END
*CMZ :  2.08/05 27/03/2000  16.05.12  by  Hannes Jung
*CMZ :  2.08/04 09/01/2000  13.21.10  by  Hannes Jung
*CMZ :  2.08/02 14/07/99  18.39.56  by  Hannes Jung
*-- Author :    Hannes Jung   14/07/99
      Subroutine XPQ30(X,Q2,XPQ)
      Implicit None
      Integer I
      REAL X,Q2,XPQ
      Double Precision XD,Q2D,SIGOUT,ESIGOUT,WEIOUT
      Double Precision pdfnorm
      Dimension XPQ(-6:6)
*KEEP,RGPARAM.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
*KEND.
      DOUBLE PRECISION POM,PIM
      COMMON/WEIGHT1/ POM,PIM
      Double Precision GEV2NB
      DATA GEV2NB/.3893857D+3/

      XD = X
      Q2D = Q2
      Do I=-6,6
         XPQ(I) = 0.
      Enddo

      Call SATSIGTOT(Q2D,XD,SIGOUT,ESIGOUT,WEIOUT)
c     write(6,*) 'XPQ30:Q2D,XD,SIGOUT,ESIGOUT,WEIOUT',
c     &  Q2D,XD,SIGOUT,ESIGOUT,WEIOUT
c factor 9 comes from 1/eq**2 for d_quark with eq=1/3
ccc   XPQ(1) = SIGOUT*Q2D*9.D0/4.D0/PI/PI/ALPH
      pdfnorm=1./2.d0/9.d0
      pdfnorm=Q2D*9.D0/12.D0/4.D0/PI/PI/ALPH/GEV2NB
      XPQ(1) = SIGOUT*pdfnorm
      XPQ(-1) = SIGOUT*pdfnorm
      XPQ(2) = SIGOUT*pdfnorm
      XPQ(-2) = SIGOUT*pdfnorm
      XPQ(3) = SIGOUT*pdfnorm
      XPQ(-3) = SIGOUT*pdfnorm
      POM = WEIOUT
c      write(6,*) 'XPQ30: XPQ(1) ',XPQ(1),' weight ',weiout,' x,q2 ',x,q2

      RETURN
      END
*CMZ :  2.08/05 30/03/2000  16.49.31  by  Hannes Jung
*CMZ :  2.08/02 04/11/99  16.39.09  by  Hannes Jung
*-- Author :    Hannes Jung   08/09/99
      subroutine rghaprep
      implicit none
*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
      Real     remPARJ32
      Real     remPARJ(5)
      LOGICAL FIRST
      DATA FIRST/.TRUE./
c henry's commons
      Double Precision  Stot, Q2_henry, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2_henry, W2, Mx2, AJAC
      real rgmx2
      IF(FIRST) THEN
         first = .FALSE.
         remPARJ32 = PARJ(32)
      ELSE
         PARJ(32)=remPARJ32
      ENDIF
      if(ipro.eq.30) then
         rgmx2 = real(mx2)
      else
         rgmx2 = shh
      endif
      If (RGMX2.LT.4.0.AND.IDIR.EQ.0) Then
         If(ABS(KPA).LE.2) Then
            PARJ(32) = 0.35
            GOTO 190
         ElseIf(ABS(KPA).EQ.3) Then
            PARJ(32) = 0.1
            GOTO 190
         EndIf
  190    Continue
*
         remPARJ(1) = PARJ(11)
         remPARJ(2) = PARJ(12)
         remPARJ(3) = PARJ(13)
         remPARJ(4) = PARJ(27)
         remPARJ(5) = PARJ(28)
*
         PARJ(11) = 1.0
         PARJ(12) = 1.0
         PARJ(13) = 1.0
         PARJ(27) = 0.1
         PARJ(28) = 0.9
*
         CALL DUPREP(0)
         PARJ(11) = remPARJ(1)
         PARJ(12) = remPARJ(2)
         PARJ(13) = remPARJ(3)
         PARJ(27) = remPARJ(4)
         PARJ(28) = remPARJ(5)
c      ElseIf (RGMX2.GT.9.0.AND.RGMX2.LT.14.AND. ABS(KPA) .EQ.4.AND.IDIR
c     +.EQ.0) Then
      ElseIf (RGMX2.GT.9.0.AND. ABS(KPA) .EQ.4.AND.IDIR
     +.EQ.0) Then
         remPARJ(2) = PARJ(12)
         remPARJ(3) = PARJ(13)
         PARJ(13) = 1.0
         CALL DUPREP(0)
         PARJ(13) = remPARJ(3)
         PARJ(12) = remPARJ(2)

      Else

         CALL DUPREP(0)


      ENDIF
      return
      end
*CMZ :  2.08/04 22/12/99  18.08.49  by  Hannes Jung
*CMZ :  2.06/02 09/09/97  11.19.50  by  Hannes Jung
*CMZ :  2.04/00 23/12/96  11.44.28  by  Hannes Jung
*CMZ :  1.03/01 03/04/94  16.45.55  by  Hannes Jung
*-- Author :    Hannes Jung   03/04/94
************************************************************************
      DOUBLE PRECISION FUNCTION draprn ()
************************************************************************
*
*  Purpose: random number with DOUBLE PRECISION in the interval (0,1)
*  -------  based on H1 single precision random generator H1RNV
*
*  Input  : no
*  -----
*
*  Output:  DRAPRN  -- a random number (DOUBLE PRECISION)
*  ------
*
*           Method: two random words with 24-bit mantissa are combined
*                   into one word of 48-bit mantissa
*           Result: dpraprn * 2*48 is a random integer
*                   in the interval (1,2**48-1)
*
*  Author:  A. Fedotov 16.04.1999
*
************************************************************************

      DOUBLE PRECISION TWOM24
      PARAMETER (TWOM24 = 2.D0**(-24))

      DIMENSION R(2)

*-------------------------

*  get two random numbers with single precision
      CALL H1RNV (R, 2)

C      PRINT 900, R(1) * 2.**24, R(2) * 2.**24
C 900  FORMAT (' H1RNDP:', 2F20.5)

*  combine them into one:
      DRAPRN = DBLE (R(1)) + DBLE (R(2)) * TWOM24

      RETURN
      END
	

      SUBROUTINE draprnv(RVEC,LENV)

      DOUBLE PRECISION TWOM24
      PARAMETER (TWOM24 = 2.D0**(-24))
	Integer lenv
	Double Precision RVEC(LENV)
	Real R
	Integer ld,li
	Parameter (ld=100)
	DIMENSION R(ld)
	if(lenv.gt.ld/2) then
	  write(6,*) ' draprnv : len > ld/2 ',len,ld/2
	  stop
	  endif
*  get two random numbers with single precision
      li=lenv*2
      CALL H1RNV (R, li)
      DO I=1,LENV
      RVEC(I) = DBLE(R(I)) + DBLE(R(LEN+I))*TWOM24
	enddo

	RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.29  by  Hannes Jung
*CMZ :  2.06/34 22/05/98  17.51.25  by  Hannes Jung
*CMZ :  2.06/02 29/07/97  09.17.51  by  Hannes Jung
*CMZ :  2.03/02 16/08/96  10.33.55  by  Hannes Jung
*CMZ :  2.01/09 05/03/96  09.53.48  by  Hannes Jung
*CMZ :  2.01/04 24/01/96  16.10.48  by  Hannes Jung
*CMZ :  2.01/03 20/01/96  17.12.39  by  Hannes Jung
*CMZ :  2.01/01 09/01/96  14.38.40  by  Hannes Jung
*-- Author :

      SUBROUTINE ELERHO(WT1)
C
C    POMERON-VIRTUAL GAMMA ----> POMERON*+RHO
C    double diffractive ineraction
C
      IMPLICIT REAL*8 (A-H,O-Z)
*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEND.

      DIMENSION PPG(10,5),BETA1(3),BETA2(3),
     +POMSDC(3,5)
      DOUBLE PRECISION P0(4),PG1(4),PG2(4)
      DOUBLE PRECISION SPHI,STHETA,THETA1,PHI1,THETA2,PHI2,
     +POMSPG(3),pp(2,5),
     +T46PG,XM1L,XM1H,Y,STETAS,TETA2,
     +CTETA2,XM1,XM2,XM1S,XM2S,POMNOR
      REAL XMPOMS,XMPIP,XMPIM,XMPI0,POMSDC
      COMMON/DECA2/PG1,PG2
      LOGICAL FIRST
      Double Precision draprn
      DATA FIRST/.TRUE./
      DATA NEV,IEVENT,NEVNT,NSTOP/0,1,10,200/
      DATA NEVE/0/
      DATA XM1L,XM1H/3.000,3.100/
      DATA XMPIP,XMPIM,XMPI0/0.13956755,0.13956755,0.1349734/
      XMPIS=0.0194791D0
      IF(FIRST) THEN
C     write(6,*) ' WE ARE IN ELERHO gamma* pomeron*--> rho pomeron '
         FIRST = .FALSE.
         DO J=1,10
            DO I=1,5
               PPG(J,I) = 0.
            ENDDO
         ENDDO
      ENDIF
      NEVE=0
C...all of the following vectors are or will be given in the MAIN PG cms
C...  P(1, ) is the incoming electron
c...  p(2, ) the incoming proton
c...  p(3, ) the scattered electron
c...  p(nia1, ) the virtual gamma
c...  p(nia2, ) the POMERON
c...  with nia1=4 and nia2=5
c...  p(6, ) is the RHO
C...  P(7, ) is the  EXITED POMERON
c...  p(8, ) is the scattered proton
      DO J=1,5
         P(8,J) = DBLE(P(2,J)-P(NIA2,J))
      ENDDO
      IF(IEVENT.GT.3) GO TO 10
c      PRINT *,' P(1,1)=',P(1,1),' P(1,2)=',P(1,2),' P(1,3)=',P(1,3)
c      PRINT *,' P(2,1)=',P(2,1),' P(2,2)=',P(2,2),' P(2,3)=',P(2,3)
c      PRINT *,' P(3,1)=',P(3,1),' P(3,2)=',P(3,2),' P(3,3)=',P(3,3)
c... the P(NIA2,J) being the pomeron
c      write(6,*)' elerho: nia1,nia2',nia1,nia2,' N=',n
c      PRINT *,' original POMERON end GAMMA in GP cms'
c      PRINT *,' P(5,1)=',P(5,1),' P(5,2)=',P(5,2),' P(5,3)=',P(5,3)
c      PRINT *,' P(4,1)=',P(4,1),' P(4,2)=',P(4,2),' P(4,3)=',P(4,3)
   10 CONTINUE
c
c... so,here the vectors P(NIA1,J) and P(NIA2,J) are given in the PG cms
c...but the pomeron is not  aligned with the z axis.We will now turn it, but
c...before that we conserve their values:
      DO I=1,5
         PP(1,I)=P(NIA1,I)
         PP(2,I)=P(NIA2,I)
      ENDDO
c
c
c notice the combined order in wich ULANGL and LUDBRB must be used !!!!!!
c
      SPHI=DLANGL(P(NIA2,1),P(NIA2,2))
      CALL DUDBRB(NIA1,NIA2,0.D0,-SPHI,0.D0,0.D0,0.D0)
      STHETA=DLANGL(P(NIA2,3),P(NIA2,1))
      CALL DUDBRB(NIA1,NIA2,-STHETA,0.D0,0.D0,0.D0,0.D0)
      IF(IEVENT.LE.0) THEN
         PRINT *,' CM(1)=',CM(1),' CM(2)=',CM(2),' CM(3)=',CM(3)
         PRINT *,' CM(4)=',CM(4)
         PRINT *,' DBCMS(1)=',DBCMS(1),' DBCMS(2)=',DBCMS(2)
         PRINT *,' DBCMS(3)=',DBCMS(3),' DBCMS(4)=',DBCMS(4)
      ENDIF
      IF(IEVENT.GT.0) GO TO 20
      PRINT *,' THE INITIAL ANGLE OF THE POMERON IN PG cms'
      PRINT *,' STHETA=',STHETA,' SPHI=',SPHI
      PRINT *,' APRES ROTATION'
      PRINT *,' P(5,1)=',P(5,1),' P(5,2)=',P(5,2),' P(5,3)=',P(5,3)
      PRINT *,' P(4,1)=',P(4,1),' P(4,2)=',P(4,2),' P(4,3)=',P(4,3)
c      CALL DULIST(1)

   20 CONTINUE
c
C
c...... remember the angle STHETA and SPHI
c*********************************************************************
c
C
C... IN THE POMERON-VIRTUAL GAMMA (MAIN PG CMS) CMS
C... THE VECTORS P(5, ) ,POMERON, AND P(4, ), VIRTUAL GAMMA, ARE
C... DEFINED WITH RESPECT TO AXIS PARALELES TO THE EP CMS SYSTEM BUT TRAVELING
C... WITH A VELOCITY VECTOR GIVEN BY :  -dbcms(1)/dbcms(4),-dbcms(2)/dbcms(4)
C...  -dbcms(3)/dbcms(4) . )do not forget the - sign !!!!!!!!!!)
C..  IN THIS MAIN PG CMS , THE POMERON IS NOW ALIGNED WITH THE Z AXIS.
c
c
C..  THE DOUBLE-DIFFRACTIVE INTERACTION
C...     POMERON-VIRTUAL GAMMA----> POMERONSTAR + RHO
C... FOLLOWED BY THE DECAY TO two pions OF THE POMERON*  AND THE RHO
C...-----------------------------------------------------------------
C
C
C... RELATIVE TO THE POMERON'S DIRECTION OF MOTION (which is actualy  the
c  z axis)
C... THE DIFFERENCIAL CROSS-SECTION sdd(S)/(dT*dXM1S*dXM2S) IS
C... WRITTEN AS = A*1./(XM1S*XM2S)*EXP(B*T)*FDD, if we use non linear mass axis
C...or A*1./(XM1*XM2)*EXP(B*T)FDD, if we use linear mass axis i.e.
C....we write the cross-section as:sdd(S)/(dT*dXM1*dXM2) using dXM1 in place of
C...dXM1S and dXM2 in place of dXM2S
C... WHERE T : IS THE SQUARED MOMENTUM TRANSFER BETWEEN POM AND POM*
c... and the T will be used to obtain the angular distribution of POM* in the
c. . MAIN PG CMS REFERENCE.
C...      XM1S: IS THE SQUARED MASS OF POMERON STAR
C...      XM2S: IS THE SQUARED MASS OF GAMMA STAR
C...      A : CONSTAN
C... FOR OUR PURPOSE , WE CONSIDER FDD ALSO AS CONSTANT . THE MASSES
C... XM1 AND XM2 CAN BE HANDLED AS FOLLOWS : FOR XM1 (THE MASS OF THE
C... EXCITED POMERON) WE WILL CHOSE values starting from 0.420 GeV (3*pion)
c... and following a 1/XM1 pattern .(i.e.we use linear mass axis)
C... FOR XM2 (THE MASS OF RHO ) WE WILL USE THE BREIT-WIGNER . OUR AIM
C... BEING TO GENERATE THE RIGHT T DISTRIBUTION ( FOR GIVEN VALUES OF
C... XM1 AND XM2) , WE CONCENRATE  ONLY ON EXP(BDD*T) and hand xm1 also nearly
C... fixed.





C...choice of the masses-----
      SHAT=(P(4,4)+P(5,4))**2
c      SHAT1=P(4,4)**2-(P(4,1)**2+P(4,2)**2+P(4,3)**2)+
c     &P(5,4)**2-(P(5,1)**2+P(5,2)**2+P(5,3)**2)+2.*P(4,4)*P(5,4)-
c     &2.*(P(4,1)*P(5,1)+P(4,2)*P(5,2)+P(4,3)*P(5,3))
c      IF(SHAT.NE.SHAT1) PRINT *,' SHAT=',SHAT,' SHAT1=',SHAT1
      ETOT=SQRT(SHAT)
C     PRINT *,' SHAT=',SHAT
c
      CALL HFILL(606,SNGL(ETOT),0.,1.)
C
C... for the rho
C
   30 X=draprn()
      NEVE=NEVE+1
      IF(NEVE.GE.NSTOP) WT1=0.D0
c      IF(NEVE.GE.NSTOP) PRINT *,' BBBBBBB'
      IF(NEVE.GE.NSTOP) CALL HFILL(932,1,0.,1.)
      IF(NEVE.GE.NSTOP) GO TO 70
      XM2=0.770+X*0.075D0
      Y=draprn()
      IF(Y.LT.0.5) XM2=0.770-X*0.075D0
      XM2S=XM2*XM2
      IF(XM2.LT.0.620.OR.XM2.GT.0.920) GO TO 30
C     PMAX=SQRT((SHAT-XM1MIN**2-XM2**2)**2/4.-(XM1MIN*XM2)**2)/ETOT
C     PRINT *,' XM2=',XM2

      CALL HFILL(605,SNGL(XM2),0.,1.)
C
c...for the pomeron*
c
c
c....if XM1 is not fixed
c 112  Y=draprn()
c      XM1=(1./Y)*0.420
c      IF(XM1.GT.3.) GO TO 112
c      CALL HFILL(963,SNGL(XM1),0.,1.)


c...if XM1 is fixed
c
   40 Y=draprn()
      IF(Y.EQ.0.) GO TO 40
      NEVE=NEVE+1
      IF(NEVE.GE.NSTOP) WT1=0.D0
c       IF(NEVE.GE.NSTOP) PRINT *,' AYAYA'
      IF(NEVE.GE.NSTOP) CALL HFILL(932,1,0.,1.)
      IF(NEVE.GE.NSTOP) GO TO 70
      XM1=XM1L+Y*(XM1H-XM1L)
      IF(XM1.GE.ETOT) GO TO 40
C     PRINT *,' CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC'
C     PRINT *,' CCCCCCCCCCCCCCCC XM1=',XM1,' CCCCCCCCC'
C     PRINT *,' CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC'
      XM1S=XM1*XM1
c
c
      XTOT=XM1+XM2
      IF(XTOT.GT.ETOT) GO TO 40
      PHAT=(SHAT+XM1S-XM2S)**2/(4.D0*SHAT)-XM1S
      if(PHAT.LT.0.) GO TO 30
      PHAT=SQRT(PHAT)
C...generate the interaction T (impulsion transfer) distribution.
C
C... the choice of the excited masses imposes
C... limits on the inpusion transfer, T ,
C...
C
C     PRINT *,' SHAT=',SHAT
      XMU1=-PPG(5,5)**2/SHAT
      XMU2=-PPG(6,5)**2/SHAT
      XMU3=XM1S/SHAT
      XMU4=XM2S/SHAT
C     PRINT *,' XMU1=',XMU1,' XMU2=',XMU2
C     PRINT *,' XMU3=',XMU3,' XMU4=',XMU4
      C1=1.D0-(XMU1+XMU2+XMU3+XMU4)+(XMU1-XMU2)*(XMU3-XMU4)
      C111=(1.D0-XMU1-XMU2)**2-4.*XMU1*XMU2
      C222=(1.D0-XMU3-XMU4)**2-4.*XMU3*XMU4
      IF(C111.LT.0.OR.C222.LT.0.) PRINT 10000
10000 FORMAT(' PROBLEMS WITH C1 OR C2')
      C2=SQRT(C111)*SQRT(C222)
      C3=(XMU3-XMU1)*(XMU4-XMU2)+(XMU1+XMU4-XMU2-XMU3)*(XMU1*XMU4-
     +XMU2*XMU3)
C     PRINT *,' C1=',C1,' C2=',C2
C     PRINT *,' C3=',C3
      TMIN=-SHAT*(C1+C2)/2.D0
      TMAX=-SHAT*(C1-C2)/2.D0
C     PRINT *,' TMIN=',TMIN,' TMAX=',TMAX
C
C... we must have TMIN<T<TMAX
C

      BDD=0.5*LOG(2.72D0**4+4.D0*SHAT/(XM1S*XM2S))
      YY=BDD*TMIN
C     PRINT *,' YY=',YY
      IF(YY.GT.-78.) THEN
         YMIN=EXP(BDD*TMIN)
         YMAX=EXP(BDD*TMAX)
C     PRINT *,' YMIN=',YMIN,' YMAX=',YMAX
         Y=YMIN+(YMAX-YMIN)*draprn()
C     PRINT *,' Y=',Y,' BDD=',BDD
         T=LOG(Y)/BDD
         GO TO 50
      ENDIF
      YMIN=0.D0
      YMAX=EXP(BDD*TMAX)
C     PRINT *,' YMIN=',YMIN,' YMAX=',YMAX
      Y=YMIN+(YMAX-YMIN)*draprn()
C     PRINT *,' Y=',Y,' BDD=',BDD
      T=LOG(Y)/BDD
   50 CONTINUE
c...****************************************************
c.. energy of the POMERON* and of the RHO
C...****************************************************
      P(7,4)=SQRT(PHAT**2+XM1S)
      P(6,4)=SQRT(PHAT**2+XM2S)
      EPRIE1=P(7,4)
      EPRIE2=P(6,4)
C*******************************************************
C
C...
C... using the the generated T value , get the cosinus of the the angle theta
C ..  of the pomeron* (in the MAIN PG cms
c...
      POMNOR=SQRT(P(5,1)**2+P(5,2)**2+P(5,3)**2)
      COSTH=(P(5,4)*P(7,4)+(T+P(5,5)**2-XM1S)/2.D0)/
     +(POMNOR*PHAT)
c      IF(COSTH.LT.0.) THEN
c      PRINT *,' COSTH NEGATIVE'
c      PRINT *,' XM1=',XM1,' P(5,5)=',P(5,5),' T=',T,' PHAT=',PHAT
c      ENDIF
      IF(COSTH.GE.1.) GO TO 30
      CALL HFILL(609,SNGL(EPRIE1),0.,1.)
      CALL HFILL(610,SNGL(EPRIE2),0.,1.)
      CALL HFILL(630,SNGL(PHAT),0.,1.)
      CALL HFILL(607,SNGL(XM1),0.,1.)
      CALL HFILL(608,SNGL(XTOT),0.,1.)
      CALL HFILL(631,SNGL(T),0.,1.)

C     PRINT *,' T=',T,' EPRIE1=',EPRIE1,' EPRIE2=',EPRIE2
c      PRINT *,' POMNOR=',POMNOR,' PHAT=',PHAT
c      PRINT *,' P(5,4)=',P(5,4),' P(5,5)=',P(5,5),
c    &' P(7,4)=',P(7,4)
c      PRINT *,' T=',T,' XM1S=',XM1S
      XTEST=P(5,5)
      CALL HFILL(800,SNGL(COSTH),POMNOR,1.)
      CALL HFILL(801,SNGL(COSTH),SNGL(PHAT),1.)
      CALL HFILL(802,SNGL(COSTH),SNGL(XTEST),1.)
      CALL HFILL(803,SNGL(COSTH),SNGL(T),1.)
      CALL HFILL(680,SNGL(ETOT),0.,1.)
C     PRINT *,' T=',T,' COSTH=',COSTH
      CALL HFILL(632,SNGL(COSTH),0.,1.)
C
C
C
C... excited POMERON's angles in the MAIN PG cms
***********************************************************************
C************** remember these angles !!!!!!!!!!!!!!!!!!!!!!!!!!!
      THETA1=ACOS(COSTH)
      PHI1=draprn()*6.28D0
      IF(IEVENT.LE.0)PRINT *,'POM* ANGLES FROM GENERATOR IN MAIN PG cms'
      IF(IEVENT.LE.0)PRINT *,' THETA1=',THETA1,' PHI1=',PHI1
c...
      CALL HFILL(633,SNGL(THETA1),0.,1.)
c... the POM*  four momentum in the reference MAIN PG cms
c..
c..
      P(7,1)=PHAT*SIN(THETA1)*COS(PHI1)
      P(7,2)=PHAT*SIN(THETA1)*SIN(PHI1)
      P(7,3)=PHAT*COS(THETA1)
C...FOR LATTER USE
      POMSPG(1)=P(7,1)
      POMSPG(2)=P(7,2)
      POMSPG(3)=P(7,3)
C
c...  p(7,4) is already defined
      P(7,5)=SQRT(P(7,4)**2-(P(7,1)**2+P(7,2)**2+P(7,3)**2))
c...     the RHO's  four momentum in MAIN PM cms
      P(6,1)=-P(7,1)
      P(6,2)=-P(7,2)
      P(6,3)=-P(7,3)
C      P(6,4) already defined
      P(6,5)=SQRT(P(6,4)**2-(P(6,1)**2+P(6,2)**2+ P(6,3)**2))
c..    ......the velocity vector of the POM* in the MAIN PG cms is now
      BETA1(1)=P(7,1)/P(7,4)
      BETA1(2)=P(7,2)/P(7,4)
      BETA1(3)=P(7,3)/P(7,4)
C
C... the velocity vector of the RHO in the MAIN PG cms
C
      BETA2(1)=P(6,1)/P(6,4)
      BETA2(2)=P(6,2)/P(6,4)
      BETA2(3)=P(6,3)/P(6,4)
c...the gamma*-rho momentum transfer,in quantities expressed in PG cms;
      T46PG=P(4,4)**2-(P(4,1)**2+P(4,2)**2+P(4,3)**2)+XM2S-2.D0*P(4,4)*
     +P(6,4)+2.D0*(P(4,1)*P(6,1)+P(4,2)*P(6,2)+P(4,3)*P(6,3))
      CALL HFILL(927,SNGL(T46PG),0.,1.)
      IF(IEVENT.LE.0) THEN
         PRINT *,' the velocity vector of pomeron* in the MAIN PG cms'
         PRINT *,' BETA1(1)=',BETA1(1),BETA1(2),BETA1(3)
         PRINT *,' the velocity vector of rho  in the MAIN PG cms'
         PRINT *,' BETA2(1)=',BETA2(1),BETA2(2),BETA2(3)
      ENDIF

c...in the following NF1 corresponds to the RHO and NF2 to POM*
C....in our case NF1=6 end NF2=7
C
      IF(IEVENT.LE.0) PRINT *,' NF1=',NF1,' NF2=',NF2
c
c
c.... DECAY OF THE POM* AND RHO
C....******************************
c    in the POM* cms
C... we rotate  the pom* flighing path  to the z axis
c...
c
      IF(IEVENT.LE.0)PRINT * ,' original POM* end RHO in PG cms'
      IF(IEVENT.LE.0)PRINT *,' p(7,1)=',p(7,1),' p(7,2)=',p(7,2),
     +' p(7,3)=',p(7,3)
      IF(IEVENT.LE.0)PRINT *,' p(6,1)=',p(6,1),' p(6,2)=',p(6,2),
     +' p(6,3)=',p(6,3)
      PHI1=DLANGL(P(7,1),P(7,2))
      CALL DUDBRB(7,7,0.D0,-PHI1,0.D0,0.D0,0.D0)
      THETA1=DLANGL(P(7,3),P(7,1))
      CALL DUDBRB(7,7,-THETA1,0.D0,0.D0,0.D0,0.D0)
      IF(IEVENT.LE.0) THEN
         PRINT *,' THETA1 AND PHI1 FROM ULANGL'
         PRINT *,' THETA1=',THETA1,' PHI1=',PHI1
      ENDIF
      IF(IEVENT.LE.0)PRINT * ,' POM* and RHO IMP AFTER ROTATION'
      IF(IEVENT.LE.0)PRINT *,' P(7,1)=',P(7,1),' P(7,2)=',P(7,2),
     +' P(7,3)=',P(7,3)
c...remember that for the reverse rotation we must first rotate THETA1
C...followed by the rotation PHI1
C
C..
C.. we do the same for rho (in the rho cms
c ..
c
      PHI2=DLANGL(P(6,1),P(6,2))
      CALL DUDBRB(6,6,0.D0,-PHI2,0.D0,0.D0,0.D0)
      THETA2=DLANGL(P(6,3),P(6,1))
      CALL DUDBRB(6,6,-THETA2,0.D0,0.D0,0.D0,0.D0)
      IF(IEVENT.LE.0)PRINT *,' P(6,1)=',P(6,1),' P(6,2)=',P(6,2),
     +' P(6,3)=',P(6,3)
      IF(IEVENT.LE.0)PRINT *,' ANGLES OF RHO'
      IF(IEVENT.LE.0)PRINT *,' THETA2=',THETA2,' PHI2=',PHI2
c
c
C
C...
C
      K(NF1,2) = 113
      K(NF1,1) = 11
      K(NF2,2) = 100
      K(NF2,1) = 11
c      IF(IEVENT.eq.9)  then
c      PRINT *,' BEFOR THE JUMP'
c      stop 9
c      endif
C
C... the RHO being polarised
C...  and therefor its decay angular distribution
C... in RHO giving PI+PI- is taken to be proportional to SIN(TETA)**2
C... where the reference axis is given by the rho direction of motion.
C... in this case the z axis
c   ******************************************************************
c ... For the POM* we supose no such polarisation.
c....
c... *****************************************************************
c
c..... decay of the POM* to three pions (pi+,pi-,p0)
c
      IF(IEVENT.LE.0) PRINT *,' BEGINS DECAY GDECA3 IN THREE PIONS'
      IF(IEVENT.LE.0) PRINT *,' P(7,5)=',P(7,5)
      XMPOMS=SNGL(P(7,5))
c hju line commented because XM1MIN was not defined
c      IF(XMPOMS.LT.XM1MIN) PRINT *,' PROBLEME WITH POM* MASS'


c
c
      CALL GDECA3(XMPOMS,XMPIP,XMPIM,XMPI0,POMSDC)
      IF(IEVENT.LE.0) PRINT *,' HAVE PASSED GDECA3'
      IF(IEVENT.LE.0) PRINT *,' POMSDC(1,1)=',POMSDC(1,1),
     +' POMSDC(1,2)=',POMSDC(1,2),' POMSDC(1,3)=',POMSDC(1,3)
C
C... the pion plus in the pom* cms
C
      NPI = N + 1
      K(NPI,1)=1
      K(NPI,2)=211
      K(NPI,3)=7
      DO I=1,5
         P(NPI,I)=DBLE(POMSDC(1,I))
      ENDDO
      IF(IEVENT.LE.0) THEN
         PRINT *,' the pion plus NPI=',NPI
         PRINT *,' P1=',P(NPI,1),' P2=',P(NPI,2),' P3=',P(NPI,3),' P4='
     +   , P(NPI,4)
      ENDIF
c
c.... the pi- in the POM* cms
c
      NPI = NPI + 1
      K(NPI,1)=1
      K(NPI,2)=-211
      K(NPI,3)=7
      DO I=1,5
         P(NPI,I)=DBLE(POMSDC(2,I))
      ENDDO
      IF(IEVENT.LE.0) THEN
         PRINT *,' the pion minus NPI=',NPI
         PRINT *,' P1=',P(NPI,1),' P2=',P(NPI,2),' P3=',P(NPI,3)
      ENDIF
c
c....the pi0 in the POM* cms
c
      NPI = NPI + 1
      K(NPI,1)=11
      K(NPI,2)=111
      K(NPI,3)=7
      NPI0 = NPI
      DO I=1,5
         P(NPI,I)=DBLE(POMSDC(3,I))
      ENDDO
      IF(IEVENT.LE.0) THEN
         PRINT *,' the pi zero NPI=',NPI
         PRINT *,' P1=',P(NPI,1),' P2=',P(NPI,2),' P3=',P(NPI,3)
      ENDIF


c... and after that,rotate them back with the angles of the POM*
c... in the MAIN PG cms
      CALL DUDBRB(NPI-2,NPI,THETA1,0.D0,0.D0,0.D0,0.D0)
      CALL DUDBRB(NPI-2,NPI,0.D0,PHI1,0.D0,0.D0,0.D0)
c
c... rotate back also the POM* vector and check that we get the old value
c
      CALL DUDBRB(7,7,THETA1,0.D0,0.D0,0.D0,0.D0)
      CALL DUDBRB(7,7,0.D0,PHI1,0.D0,0.D0,0.D0)

C
C...
      IF(IEVENT.LE.0) THEN
         PRINT *,'  AFTER BACKWARD ROTATION WITH THE POM* ANGLES '
         PRINT *,' FOR CHECK : THE POMERON'
         PRINT *,' P(7,1)=',P(7,1),' P(7,2)=',P(7,2),' P(7,3)=',P(7,3)
         PRINT *,' THE PI PLUS NPI=',NPI-2
         PRINT *,' P1=',P(NPI-2,1),' P2=',P(NPI-2,2),' P3=',P(NPI-2,3)
         PRINT *,' THE PI MINUS NPI=',NPI-1
         PRINT *,' P1=',P(NPI-1,1),' P2=',P(NPI-1,2),' P3=',P(NPI-1,3)
         PRINT *,' THE PI ZERO NPI=',NPI
         PRINT *,' P1=',P(NPI,1),' P2=',P(NPI,2),' P3=',P(NPI,3)
      ENDIF
c
c ...boost now the pions only back to the MAIN PG cms
C...
      CALL DUDBRB(NPI-2,NPI,0.D0,0.D0,BETA1(1),BETA1(2),BETA1(3))
      IF(IEVENT.LE.0) THEN
         PRINT *,' the pions , once back in the PG cms'
         PRINT *,' THE PI PLUS NPI=',NPI-2
         PRINT *,' P1=',P(NPI-2,1),' P2=',P(NPI-2,2),' P3=',P(NPI-2,3)
         PRINT *,' THE PI MINUS NPI=',NPI-1
         PRINT *,' P1=',P(NPI-1,1),' P2=',P(NPI-1,2),' P3=',P(NPI-1,3)
         PRINT *,' THE PI ZERO NPI=',NPI
         PRINT *,' P1=',P(NPI,1),' P2=',P(NPI,2),' P3=',P(NPI,3)
      ENDIF
C..
C.. end rotate them back with the angles of the POM in the PG cms
      CALL DUDBRB(NPI-2,NPI,STHETA,0.D0,0.D0,0.D0,0.D0)
      CALL DUDBRB(NPI-2,NPI,0.D0,SPHI,0.D0,0.D0,0.D0)
      CALL DUDBRB(7,7,STHETA,0.D0,0.D0,0.D0,0.D0)
      CALL DUDBRB(7,7,0.D0,SPHI,0.D0,0.D0,0.D0)
C...FOR LATTER USE
      POMSPG(1)=P(7,1)
      POMSPG(2)=P(7,2)
      POMSPG(3)=P(7,3)
      IF(IEVENT.LE.0) THEN
         PRINT *,'  once rotated back with the angles of the POM'
         PRINT *,' THE POMERON*'
         PRINT *,' P(7,1)=',P(7,1),' P(7,2)=',P(7,2),' P(7,3)=',P(7,3)
         PRINT *,' THE PI PLUS NPI=',NPI-2
         PRINT *,' P1=',P(NPI-2,1),' P2=',P(NPI-2,2),' P3=',P(NPI-2,3)
         PRINT *,' THE PI MINUS NPI=',NPI-1
         PRINT *,' P1=',P(NPI-1,1),' P2=',P(NPI-1,2),' P3=',P(NPI-1,3)
         PRINT *,' THE PI ZERO NPI=',NPI
         PRINT *,' P1=',P(NPI,1),' P2=',P(NPI,2),' P3=',P(NPI,3)
      ENDIF


C...
c..


c..
C
C...decay of the pizero to gamma-gamma in the PG cms
c
      DO I=1,4
         P0(I)=DBLE(P(NPI,I))
      ENDDO
      CALL P0TOGG(1,P0)
C
C...the gamma1 in the PG cms
C
      NPI=NPI+1
      K(NPI,1)=1
      K(NPI,2)=22
      K(NPI,3)=NPI0
      DO I=1,4
         P(NPI,I)=DBLE(PG1(I))
      ENDDO
      P(NPI,5)=0.D0
      IF(IEVENT.LE.0) THEN
         PRINT *,' NPI=',NPI
         PRINT *,' momentum of the photon1 in the PG cms'
         PRINT *,' P1=',P(NPI,1),' P2=',P(NPI,2),' P3=',P(NPI,3)
      ENDIF
C
C...the gamma2 in the PG cms
c
      NPI=NPI+1
      K(NPI,1)=1
      K(NPI,2)=22
      K(NPI,3)=NPI0
      DO I=1,4
         P(NPI,I)=DBLE(PG2(I))
      ENDDO
      P(NPI,5)=0.D0
      IF(IEVENT.LE.0) THEN
         PRINT *,' NPI=',NPI
         PRINT *,' momentum of the photon2 in the PG cms'
         PRINT *,' P1=',P(NPI,1),' P2=',P(NPI,2),' P3=',P(NPI,3)
      ENDIF

C..
C... decay of the RHO
C
   60 Y=draprn()
      STETAS=1.D0-Y**2
      TETA2=ASIN(SQRT(STETAS))
      Y=draprn()
      IF(Y.GT.STETAS) GO TO 60
      Y=draprn()
      IF(Y.LE.0.5) TETA2=3.14D0-TETA2
      CTETA2=COS(TETA2)
      CALL HFILL(613,SNGL(CTETA2),0.,1.)
      FI2=draprn()*6.28D0
      PHELP=SQRT(XM2S/4.D0-XMPIS)
C
C... the pion plus in the RHO CMS
C
      NPI=NPI+1
      K(NPI,1)=1
      K(NPI,2)=211
      K(NPI,3)=6
      P(NPI,1)=PHELP*SIN(TETA2)*COS(FI2)
      P(NPI,2)=PHELP*SIN(TETA2)*SIN(FI2)
      P(NPI,3)=PHELP*COS(TETA2)
      P(NPI,4)=XM2/2.D0
      P(NPI,5)=0.13956755D0
C
C
C... the pion minus in the rho cms
C
      NPI=NPI+1
      K(NPI,1)=1
      K(NPI,2)=-211
      K(NPI,3)=6
      P(NPI,1)=-P(NPI-1,1)
      P(NPI,2)=-P(NPI-1,2)
      P(NPI,3)=-P(NPI-1,3)
      P(NPI,4)=XM2/2.D0
      P(NPI,5)=0.13956755D0
      IF(IEVENT.LE.0) THEN
         PRINT *,' the pions in the RHO cms'
         PRINT *,' THE PI PLUS NPI=',NPI-1
         PRINT *,' P1=',P(NPI-1,1),' P2=',P(NPI-1,2),' P3=',P(NPI-1,3)
         PRINT *,' THE PI MINUS NPI=',NPI
         PRINT *,' P1=',P(NPI,1),' P2=',P(NPI,2),' P3=',P(NPI,3)
      ENDIF

c
C
c
      SBETA2=BETA2(1)**2+BETA2(2)**2+BETA2(3)**2
      IF(SBETA2.GE.1.) PRINT *,' PROBLEME BETA2'
      IF(SBETA2.GE.1.) RETURN
C.. rotate them back with the angles of RHO in the MAIN PG cms :
      CALL DUDBRB(NPI-1,NPI,THETA2,0.D0,0.D0,0.D0,0.D0)
      CALL DUDBRB(NPI-1,NPI,0.D0,PHI2,0.D0,0.D0,0.D0)
      CALL DUDBRB(6,6,THETA2,0.D0,0.D0,0.D0,0.D0)
      CALL DUDBRB(6,6,0.D0,PHI2,0.D0,0.D0,0.D0)

      IF(IEVENT.LE.0) THEN
         PRINT *,' the same, rotated back with the RHO PG cms angles'
         PRINT *,' THE RHO'
         PRINT *,' P(6,1)=',P(6,1),' P(6,2)=',P(6,2),' P(6,3)=',P(6,3)
         PRINT *,' THE PI PLUS NPI=',NPI-1
         PRINT *,' P1=',P(NPI-1,1),' P2=',P(NPI-1,2),' P3=',P(NPI-1,3)
         PRINT *,' THE PI MINUS NPI=',NPI
         PRINT *,' P1=',P(NPI,1),' P2=',P(NPI,2),' P3=',P(NPI,3)
      ENDIF

c
C...boost them back,the pions only, to the PG cms
      CALL DUDBRB(NPI-1,NPI,0.D0,0.D0,BETA2(1),BETA2(2),BETA2(3))
      IF(IEVENT.LE.0) THEN
         PRINT *,' the same, boosted back to the PG cms'
         PRINT *,' THE PI PLUS NPI=',NPI-1
         PRINT *,' P1=',P(NPI-1,1),' P2=',P(NPI-1,2),' P3=',P(NPI-1,3)
         PRINT *,' THE PI MINUS NPI=',NPI
         PRINT *,' P1=',P(NPI,1),' P2=',P(NPI,2),' P3=',P(NPI,3)
      ENDIF
C..
C.. end rotate them back with the angles SPHI,  STHETA, of the POM
c.. in the PG
      CALL DUDBRB(NPI-1,NPI,STHETA,0.D0,0.D0,0.D0,0.D0)
      CALL DUDBRB(NPI-1,NPI,0.D0,SPHI,0.D0,0.D0,0.D0)
      CALL DUDBRB(6,6,STHETA,0.D0,0.D0,0.D0,0.D0)
      CALL DUDBRB(6,6,0.D0,SPHI,0.D0,0.D0,0.D0)
      IF(IEVENT.LE.0) THEN
         PRINT *,' the same, once rotated back with STHETA and SPHI'
         PRINT *,' THE RHO'
         PRINT *,' P(6,1)=',P(6,1),' P(6,2)=',P(6,2),' P(6,3)=',P(6,3)
         PRINT *,' FOR COMPARISON THE POMERON* IN THE SAME PG cms'
         PRINT *,' POMSPG(1)=',POMSPG(1),' POMSPG(2)=',POMSPG(2),
     +   ' POMSPG(3)=',POMSPG(3)
         PRINT *,' THE PI PLUS NPI=',NPI-1
         PRINT *,' P1=',P(NPI-1,1),' P2=',P(NPI-1,2),' P3=',P(NPI-1,3)
         PRINT *,' THE PI MINUS NPI=',NPI
         PRINT *,' P1=',P(NPI,1),' P2=',P(NPI,2),' P3=',P(NPI,3)
      ENDIF
C
C...end finaly set back the original values for P(NIA1, ) and P(NIA2, )
      DO I=1,5
         P(NIA1,I)=PP(1,I)
         P(NIA2,I)=PP(2,I)
      ENDDO
C
C
c..
      N=NPI
c      CALL DULIST(1)
c      PRINT *,' NEVE=',NEVE
      IEVENT=IEVENT+1
c      PRINT *,' IEVENT=',IEVENT
      WT1 = 1.d0
      RETURN
   70 CONTINUE
      WT1=0.D0
c      PRINT *,' FUNY'
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.29  by  Hannes Jung
*CMZ :  2.06/34 20/05/98  09.12.55  by  Hannes Jung
*CMZ :  2.05/28 14/07/97  11.32.11  by  Hannes Jung
*CMZ :  2.01/09 10/02/96  18.32.43  by  Hannes Jung
*CMZ :  2.01/04 24/01/96  16.10.48  by  Hannes Jung
*CMZ :  2.01/03 20/01/96  17.13.34  by  Hannes Jung
*CMZ :  2.01/01 09/01/96  14.04.24  by  Hannes Jung
*-- Author :

      SUBROUTINE GDECA3(XM0,XM1,XM2,XM3,PCM)
C.
C.    ******************************************************************
C.    *                                                                *
C.    *   This routine simulates three-body decays in center-of-mass.  *
C.    *   Written by Jurgen Schukraft and Vincent Hedberg for R807.    *
C.    *   Adapted for Geant3 by Sverker Johansson (Aug-1987).          *
C.    *   (Quite extensive modifications; comments etc. are not always *
C.    *    consistent with the code anymore. )                         *
C.    *                                                                *
C.    *   As it is, the decay is done according to pure phase-space.   *
C.    *   There is code in the routine to properly treat K decays (V-A)*
C.    *   but it is not used. (Requires an additional parameter        *
C.    *   in the call, to tell which type of decay.)                   *
C.    *                                                                *
C.    *    ==>Called by : GDECAY                                       *
C.    *       Author    S. Johansson  *********                        *
C.    *                                                                *
C.    ******************************************************************
C.
***************************************************************
******* original name :                     *******************
******SUBROUTINE  D E C 3 B (ID,IP,K1,K2,K3)*******************
***************************************************************
C--------------------------------------------------------
C      O B S O L E T E   C O M M E N T   ! ! !
C     THIS ROUTINE SIMULATES THE THREE-BODY DECAYS OF:
C--------------------------------------------------------
C     ID = 1 : ETA   INTO  PI0 + PI0 + PI0     PHASE SPACE
C     ID = 2 : OMEGA INTO  PI0 + PI- + PI+        - " -
C     ID = 3 : ETAPR INTO  PI0 + PI0 + ETA        - " -
C     ID = 4 : K+/-  INTO  E+/- + PI0 + NU        (V-A)
C     ID = 5 : K0L   INTO  E+/- + PI-/+ + NU      - " -
C     ID = 6 : D     INTO  E   +  K  + NU      PHASE SPACE
C     ID = 7 : D     INTO  E   +  K* + NU         - " -
**      (** or any other decay; input is now masses
**          rather than process ID   S.J.
**          But the ID parameter could someday be useful
**          since it controls the non-phase-space code. ***)
C--------------------------------------------------------
C     THE OUTPUT COMMON BLOCK /LAB/ PLAB(20,J) IS FILLED
*       (** Not a common block anymore.  S.J. **)
C     ACCORDING TO THE ORDER OF THE SECONDARY PARTICLES
C     AS THEY APPEARE IN THE COMMENTS ABOVE. FOR EXAMPLE,
C     IN THE CASE OF ID=6 (D-MESON DECAY)
C     J = K1 IN PLAB(20,J) CORRESPONDS TO ELECTRON,
C     J = K2  -- " -- " -- " -- " --  K-MESON,
C     J = K3  -- " -- " -- " -- " --  NEUTRINO
C--------------------------------------------------------
      DIMENSION  P(20,20)
      DIMENSION  HM(4,7)
      DIMENSION  PCM(3,5)
      Double Precision  RNDMV(3)
*
****************************************************
*   Translation from new to old input parameters :
*      ( S.J. )
****************************************************
      ID = 1
      HM(1,ID) = XM1
      HM(2,ID) = XM2
      HM(3,ID) = XM3
      HM(4,ID) = XM0
      K1 = 1
      K2 = 2
      K3 = 3
      PI2 = 2. * 3.141592654
***********************
*  Original code :
C--------------------------------------------------------
C     SIMULATION OF SECONDARY PARTICLE MOMENTA
C     IN THE REST FRAME OF PARENT PARTICLE
C--------------------------------------------------------
C      print *,' in gdeca3'
C      print *,' xm0=',xm0,'xm1=',xm1,' xm2=',xm2,' xm3=',xm3
      T0=HM(4,ID)-HM(1,ID)-HM(2,ID)-HM(3,ID)
   10 CALL draprnV(RNDMV,2)
      G1=RNDMV(1)
      G2=RNDMV(2)
C      print *,' t0=',t0,' g1=',g1,' g2=',g2
      GMI=MIN(G1,G2)
      GMA=MAX(G1,G2)
C      print *,' gmi=',gmi,' gma=',gma
      TE=GMI*T0
      TM=(1.-GMA)*T0
      TN=(GMA-GMI)*T0
      PA1=SQRT(TE**2+2.*HM(1,ID)*TE)
      PA2=SQRT(TM**2+2.*HM(2,ID)*TM)
      PA3=SQRT(TN**2+2.*HM(3,ID)*TN)
C--------------------------------------------------------
C     CHECK OF THE MOMENTUM CONSERVATION
C--------------------------------------------------------
      PMMM=MAX(PA1,PA2)
      PMAX=MAX(PA3,PMMM)
      SP=PA1+PA2+PA3
      IF(PMAX.GE.SP-PMAX) GOTO 10
      P(4,K1)=TE+HM(1,ID)
      P(4,K2)=TM+HM(2,ID)
      P(4,K3)=TN+HM(3,ID)
C--------------------------------------------------------
C     ACCOUNTING FOR MATRIX ELEMENT (FOR ID=4 AND 5)
*     (** Calculates correct (V-A) decay for kaons.       **)
*     (** Now inactive.  Change ID to activate it. (S.J)  **)
C--------------------------------------------------------
      IF(ID.NE.4.AND.ID.NE.5) GOTO 20
      EEM=((HM(4,ID)-HM(2,ID))**2+HM(1,ID)**2-
     +      HM(3,ID)**2)/(2.*(HM(4,ID)-HM(2,ID)))
      HMMAX=EEM*(HM(4,ID)-HM(2,ID)-EEM)+
     +      0.5*(EEM**2-HM(1,ID)**2)
      HMA=P(4,K1)*P(4,K3)+0.25*(PA1**2+PA3**2-PA2**2)
      CALL draprnV(RNDMV,1)
      GG=RNDMV(1)
      IF(HMA.LT.GG*HMMAX) GOTO 10
C--------------------------------------------------------
C     CALCULATIONS OF MOMENTA
C--------------------------------------------------------
   20 CONTINUE
      CALL draprnV(RNDMV,3)
      CTE=2.*RNDMV(1)-1.
      STE=SQRT(ABS(1.-CTE**2))
      FE =PI2*RNDMV(2)
      CFE=COS(FE)
      SFE=SIN(FE)
      P(1,K1)=PA1*STE*CFE
      P(2,K1)=PA1*STE*SFE
      P(3,K1)=PA1*CTE
c      PRINT *,' P(1,K1)=',P(1,K1),' P(2,K1)=',P(2,K1),
c     &' P(3,K1)=',P(3,K1)
      CTEN=(PA2**2-PA1**2-PA3**2)/(2.*PA1*PA3)
      STEN=SQRT(ABS(1.-CTEN**2))
      FEN =PI2*RNDMV(3)
      CFEN=COS(FEN)
      SFEN=SIN(FEN)
      P(1,K3)=PA3*(STEN*CFEN*CTE*CFE-STEN*SFEN*SFE+CTEN*STE*CFE)
      P(2,K3)=PA3*(STEN*CFEN*CTE*SFE+STEN*SFEN*CFE+CTEN*STE*SFE)
      P(3,K3)=PA3*(-STEN*CFEN*STE+CTEN*CTE)
c      PRINT *,' P(1,K3)=',P(1,K3),' P(2,K3)=',P(2,K3),
c     &' P(3,K3)=',P(3,K3)
      P(1,K2)=-P(1,K1)-P(1,K3)
      P(2,K2)=-P(2,K1)-P(2,K3)
      P(3,K2)=-P(3,K1)-P(3,K3)
c      PRINT *,' P(1,K2)=',P(1,K2),' P(2,K2)=',P(2,K2),
c     &' P(3,K2)=',P(3,K2)

C-------------------------------------------------------
***   Re-translation from old to new output arrays : ***
***     (S.J.)                                       ***
***-----------------------------------------------

      DO 40 J=1,3
         DO 30 I=1,4
            PCM(J,I) = P(I,J)
   30    CONTINUE
   40 CONTINUE
      PCM(1,5)=XM1
      PCM(2,5)=XM2
      PCM(3,5)=XM3
      PCM(1,4)=SQRT(XM1**2+PCM(1,1)**2+PCM(1,2)**2+PCM(1,3)**2)
      PCM(2,4)=SQRT(XM2**2+PCM(2,1)**2+PCM(2,2)**2+PCM(2,3)**2)
      PCM(3,4)=SQRT(XM3**2+PCM(3,1)**2+PCM(3,2)**2+PCM(3,3)**2)
c      PRINT *,' PCM(1,1)=',PCM(1,1),' PCM(1,2)=',PCM(1,2),
c     &' PCM(1,3)=',PCM(1,3)
c      PRINT *,' PCM(2,1)=',PCM(2,1),' PCM(2,2)=',PCM(2,2),
c     &' PCM(2,3)=',PCM(2,3)
c      PRINT *,' PCM(3,1)=',PCM(3,1),' PCM(3,2)=',PCM(3,2),
c     &' PCM(3,3)=',PCM(3,3)
      RETURN
      END
*CMZ :  2.06/34 20/05/98  09.12.55  by  Hannes Jung
*CMZ :  2.01/09 26/02/96  14.47.32  by  Hannes Jung
*CMZ :  2.01/04 24/01/96  16.10.48  by  Hannes Jung
*CMZ :  2.01/03 20/01/96  17.13.34  by  Hannes Jung
*CMZ :  2.01/01 09/01/96  14.04.24  by  Hannes Jung
*-- Author :

      SUBROUTINE P0TOGG( JPI0, PPI0 )
C--------------------------------------------------------------------
C       LET PI0 DECAY INTO GAMMA GAMMA
C
C  INPUT
      INTEGER JPI0
      REAL * 8 EG0,MP0
      COMMON/DECA2/PG1,PG2
C                                       ! INDEX OF PI0
c       JPI0 IS 1 IN OUR CASE
      REAL*8 PPI0(4)
C                                       ! FOUR MOMENTUM OF PI0 IN LAB
C  OUTPUT
C       /MCLIST/
C  VAR
      integer k, jgamma
      REAL VEC(3)
      real*8 PG1(4), PG2(4)
      DATA EG0,MP0/0.0674867,0.1349734/
C  BEGIN
C
C     GENERATE GAMMAS IN THE PI-SYSTEMS..........................
      CALL GENSPH(VEC)
C
C...EG0 IS THE MASS OF PIZERO /2.
      PG1(4)=EG0
      PG2(4)=EG0

      DO 10 K=1,3
         PG1(K) = EG0 * DBLE(VEC(K))
         PG2(K) = -PG1(K)
   10 CONTINUE
C
C     BOOST THE GAMMAS TO THE LAB SYSTEM..................
      CALL DBOOST(PPI0,MP0,PG1,PG1)
      CALL DBOOST(PPI0,MP0,PG2,PG2)


      RETURN
      END
*CMZ :  2.06/34 20/05/98  09.12.55  by  Hannes Jung
*CMZ :  2.01/09 10/02/96  18.32.43  by  Hannes Jung
*CMZ :  2.01/03 20/01/96  17.13.34  by  Hannes Jung
*CMZ :  2.01/01 09/01/96  14.04.24  by  Hannes Jung
*-- Author :

      SUBROUTINE DBOOST(P0,U0,PA,PB)
C---------------------------------------------------------C
C 4-MOMENTUM PA IN THE REST FRAME OF PARTICLE 0 IS        C
C EVALUATED IN THE FRAME WHERE PARTILE 0 HAS A 4-MOMENTUM C
C P0 AND RETURNED AS PB. U0 IS THE MASS OF THE PARTICLE 0.C
C PA AND PB CAN SHARE THE SAME MEMORY. OCT-86 HITOSHI     C
C THIS IS THE DOUBLE PRECISION VERSION OF LBOOST.         C
C---------------------------------------------------------C
      DOUBLE PRECISION P0(4),PA(4),PB(4),U0
      DOUBLE PRECISION EP,CONS
C
      EP=(PA(4)*P0(4)+PA(1)*P0(1)+PA(2)*P0(2)+PA(3)*P0(3))/U0
      CONS=(PA(4)+EP)/(U0+P0(4))
      PB(1)=PA(1)+CONS*P0(1)
      PB(2)=PA(2)+CONS*P0(2)
      PB(3)=PA(3)+CONS*P0(3)
      PB(4)=EP
C
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.29  by  Hannes Jung
*CMZ :  2.06/34 20/05/98  09.12.55  by  Hannes Jung
*CMZ :  2.05/28 14/07/97  11.32.12  by  Hannes Jung
*CMZ :  2.01/09 10/02/96  18.32.43  by  Hannes Jung
*CMZ :  2.01/04 24/01/96  16.10.48  by  Hannes Jung
*CMZ :  2.01/03 20/01/96  17.13.34  by  Hannes Jung
*CMZ :  2.01/01 09/01/96  14.04.24  by  Hannes Jung
*-- Author :

      SUBROUTINE GENSPH(VEC)
C--------------------------------------------------------C
C GENERATES AN UNIT-LENGTH VECTOR UNIFORMLY IN 4PI.      C
C USES 1 SQRT AND NO SIN,COS'S. HITOSHI OCT-86           C
C--------------------------------------------------------C
      REAL VEC(3)
C
      Double Precision RNDMV(2)
   10 CALL draprnV(RNDMV,2)
      U1=2.*RNDMV(1)-1.
      U2=2.*RNDMV(2)-1.
      S=U1*U1+U2*U2
      IF(S.GE.1.) GOTO 10
C
      CO2=2.*SQRT(1.-S)
      VEC(1)=U1*CO2
      VEC(2)=U2*CO2
      VEC(3)=1.-2.*S
C
      RETURN
      END
*CMZ :  2.01/09 05/03/96  11.14.58  by  Hannes Jung
*CMZ :  2.01/04 24/01/96  16.10.26  by  Hannes Jung
*CMZ :  2.01/03 20/01/96  17.11.46  by  Hannes Jung
*CMZ :  2.01/01 05/01/96  12.53.32  by  Hannes Jung
*CMZ :  2.01/00 01/01/96  17.20.42  by  Hannes Jung
*CMZ :  2.00/30 31/12/95  15.10.06  by  Hannes Jung
*-- Author :    Hannes Jung   31/12/95

      SUBROUTINE NIKZAK(XBJ,XP,Q2,ABS_T,
     +           D2S_VL,D2S_VS,D2S_VC,D2S_SL,D2S_SS,D2S_SC)

*************************************************************************
*
* author: M.Grothe , 5.1.96
*
* D^2 SIGMA/(DT DXP) (GAMMA*P->XP) ACCORDING TO
* Genovese, Nikolaev, Zakharov, Cern/Th-95/13
*
* input : kinematic variables x_bj, x_pomeron, Q_sqrt, ABS(t)
* output: D^2 SIGMA/(DT DX_pomeron) in mbarn/GeV^2
*         D2S_VL  valence part with light quarks in final state
*         D2S_VS  valence part with strange quarks in final state
*         D2S_VC  valence part with charm quarks in final state
*         D2S_SL  sea part with light quarks in final state
*         D2S_SS  sea part with strange quarks in final state
*         D2S_SC  sea part with charm quarks in final state
*
*
*************************************************************************

      IMPLICIT NONE

      REAL XBJ,XP,Q2,ABS_T,BETA
      REAL CONST_VAL,CONST_SEA,D2S_VAL,D2S_SEA,DENOM_VAL,DENOM_SEA
      REAL D2S_VL,D2S_VS,D2S_VC,D2S_SL,D2S_SS,D2S_SC

      REAL ALPHA,PI

      REAL FLUX_SEA,FLUX_VAL,B_EL,B_3P,C_VAL,C_SEA,F_VAL,F_SEA
      REAL XP_0,SIGTOTPP

      PI        = 4.0*ATAN(1.0)
      ALPHA     = 1./137.

*!  in mbarn
      SIGTOTPP  = 40.
      XP_0      = 0.03

*!  in GeV^-2
      B_3P      = 6.
*!  in GeV^-2
      B_EL      = 12.

      C_VAL     = 0.27
      C_SEA     = 0.063

*******************************************************************************
C IN CASE XP < XP_0:
C  FLUX_VAL  = (XP_0/XP)**0.259 * (XP+0.00149)**0.2142 / (XP_0+0.00149)**0.2142
C            = CONST_VAL * (XP+0.00149)**0.2142 / XP**0.259
C  CONST_VAL = XP_0**0.259 / (XP_0+0.00149)**0.2142
C            = 0.845796
C  FLUX_SEA  = (XP_0/XP)**0.58 * (XP+0.0023)**0.48 / (XP_0+0.0023)**0.48
C            = CONST_SEA * (XP+0.0023)**0.48 / XP**0.58
C  CONST_SEA = XP_0**0.58 / (XP_0+0.0023)**0.48
C            = 0.679694
C ELSE:
C   FLUX_VAL  =1.
C   FLUX_SEA  =1.
C F_VAL     = C_VAL * BETA * (1-BETA)
C F_SEA     = C_SEA * (1-BETA)**2
*******************************************************************************

      CONST_VAL = 0.845796
      CONST_SEA = 0.679694

      IF (XP.GT.XP_0) THEN
         FLUX_VAL =1.
         FLUX_SEA =1
      ELSE
         FLUX_VAL = CONST_VAL * (XP+0.00149)**0.2142 / XP**0.259
         FLUX_SEA = CONST_SEA * (XP+0.0023)**0.48 / XP**0.58
      ENDIF

      BETA      = XBJ/XP

      F_VAL     = C_VAL * BETA * (1-BETA)
      F_SEA     = C_SEA * (1-BETA) * (1-BETA)

      D2S_VAL   = PI/4. * ALPHA * SIGTOTPP / Q2 * 1/XP
     +             * FLUX_VAL * F_VAL * EXP(-B_EL*ABS_T)

      D2S_SEA   = PI/4. * ALPHA * SIGTOTPP / Q2 * 1/XP
     +             * FLUX_SEA * F_SEA * EXP(-B_3P*ABS_T)
      IF(D2S_VAL.LE.0.0) D2S_VAL = 1.E-20
*******************************************************************************
C flavour decomposition for valence part:
C    A(u)=A(ubar)=A(d)=A(dbar)=0.20 of fraction in normal DIS
C    A(s)=A(sbar)=0.11
C    A(c)=A(cbar)=0.02
C flavour decomposition for sea part:
C    A(u)=A(ubar)=A(d)=A(dbar)=0.048 of fraction in normal DIS
C    A(s)=A(sbar)=0.040
C    A(c)=A(cbar)=0.009
*******************************************************************************

      DENOM_VAL  = 10./9.*0.20 + 2./9.*0.11 + 8./9.*0.02
      DENOM_SEA  = 10./9.*0.048 + 2./9.*0.040 + 8./9.*0.009

      D2S_VL     = D2S_VAL * 0.20*10./9./DENOM_VAL
      D2S_VS     = D2S_VAL * 0.11*2./9./DENOM_VAL
      D2S_VC     = D2S_VAL * 0.02*8./9./DENOM_VAL
      D2S_SL     = D2S_SEA * 0.048*10./9./DENOM_SEA
      D2S_SS     = D2S_SEA * 0.040*2./9./DENOM_SEA
      D2S_SC     = D2S_SEA * 0.009*8./9./DENOM_SEA
c      write(6,*) 'NIKZAK',XBJ,XP,Q2,ABS_T,
c     +           D2S_VL,D2S_VS,D2S_VC,D2S_SL,D2S_SS,D2S_SC
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.29  by  Hannes Jung
*CMZ :  2.06/34 20/05/98  09.12.56  by  Hannes Jung
*CMZ :  2.06/29 15/03/98  14.20.39  by  Hannes Jung
*CMZ :  2.06/27 01/02/98  12.55.36  by  Hannes Jung
*CMZ :  2.06/26 21/01/98  17.46.26  by  Hannes Jung
*CMZ :  2.06/24 14/01/98  19.40.49  by  Hannes Jung
*CMZ :  2.05/05 20/03/97  12.01.07  by  Hannes Jung
*CMZ :  2.04/00 03/12/96  09.39.16  by  Hannes Jung
*CMZ :  2.03/04 08/09/96  14.54.40  by  Hannes Jung
*CMZ :  2.03/03 19/08/96  17.22.58  by  Hannes Jung
*CMZ :  2.02/03 01/08/96  09.33.47  by  Hannes Jung
*CMZ :  2.02/01 02/07/96  18.53.24  by  Hannes Jung
*CMZ :  2.01/18 19/06/96  11.40.39  by  Hannes Jung
*CMZ :  2.01/17 05/06/96  10.36.55  by  Hannes Jung
*CMZ :  2.01/16 23/05/96  12.18.53  by  Hannes Jung
*CMZ :  2.01/15 14/05/96  16.21.03  by  Hannes Jung
*CMZ :  2.01/14 13/05/96  15.59.42  by  Hannes Jung
*CMZ :  2.01/09 07/03/96  13.50.54  by  Hannes Jung
*-- Author :
      SUBROUTINE F2DHW(BETA,X_POM,Q2,T2,F2QTF,FLQF,XGX)
* calculate  F_2^D in the hard approach of M. Wuesthoff
      IMPLICIT DOUBLE PRECISION (A-G,O-Z)
      DOUBLE PRECISION PT2GEN,PHIGEN
      COMMON/HARDPOM/PT2GEN,PHIGEN
*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEND.
      EXTERNAL POM,FG
      DATA SMALL/1.D-6/
      q02=1.0d0
      NTRY = 100
      NI = 5
      F2QTF = 0.D0
      FLQF = 0.D0
      XGX = 0.D0
c      write(6,*) 'F2DHW: beta,xpom,q2,t2',beta,x_pom,q2,t2
c      write(6,*) ' f2dhw iwei',iwei
      xi0=log(4.0d0*q02/q2*beta)
      xi1=12.d0
      F2QMAX = 0.D0
      DO 10 IRN = 1,NTRY
         rn1 = draprn()
         v=exp(xi0+rn1*(xi1-xi0))
         wv=(xi1-xi0)*v
c
         rn2 = draprn()
         z=beta/(beta+rn2*(1.d0-beta))
         wz = z**2 *(1.d0 -beta)/beta
         CALL XNTOTAL(F2QT,F2G,F2QL,Q2,x_pom,BETA,V,Z,T2)
         F2QTF = F2QTF + F2QT * wv/NTRY + F2G * wv * wz/NTRY
         FLQF =FLQF + F2QL * wv/NTRY
c get the gluon
         xng = 0.d0
c
c
         xpom=pom(x_pom,-t2,v)
         xpom = xpom/x_pom
         if (v.lt.q02/q2) then
            xng=0.0d0
         else
            xng=fg(beta,v)/v
            xng=xng**2/q02
            xng=xng*9.0d0/4.0d0
c
            xng = xng/16.d0 * xpom
         endif
         xgx = xgx + xng*wv/ntry

   10 CONTINUE
c          write(6,*) ' f2dhw f2qtf xng,xpom',f2qtf,xng,xpom

c      write(6,*) 'f2dhw : ',f2gf
      DO 20 I1 = 0,NI
         DO 20 I2 = 0,NI
            rn1 = dfloat(I1)/dfloat(NI)
            if(rn1.eq.0.d0) rn1 = small
            if(rn1.eq.1.d0) rn1 = 1.d0 - small
            v=exp(xi0+rn1*(xi1-xi0))
            wv=(xi1-xi0)*v
c
            rn2 = dfloat(I2)/dfloat(NI)
            if(rn2.eq.0.d0) rn2 = small
            if(rn2.eq.1.d0) rn2 = 1.d0 - small
            z=beta/(beta+rn2*(1.d0-beta))
            wz = z**2 *(1.d0 -beta)/beta
            CALL XNTOTAL(F2QT,F2G,F2QL,Q2,x_pom,BETA,V,Z,T2)
            F2TEST = (F2QT+F2QL)*wv + F2G*wv*wz
c         write(6,*) ' f2dhw 1st: (F2g) ',F2g,z,v,wv,wz
c         write(6,*) ' f2dhw 1st: (F2QT+F2QL),wv ',F2TEST,(F2QT+F2QL)*wv
            IF(F2TEST.GE.F2QMAX) F2QMAX = F2TEST

   20 CONTINUE
      F2QMAX = 5.D0*F2QMAX
   30 CONTINUE
      if(iwei.eq.1) then
         rn1 = draprn()
         v=exp(xi0+rn1*(xi1-xi0))
         wv=(xi1-xi0)*v
         rn2 = draprn()
         z=beta/(beta+rn2*(1.d0-beta))
         wz = z**2 *(1.d0 -beta)/beta
         CALL XNTOTAL(F2QT,F2G,F2QL,Q2,x_pom,BETA,V,Z,T2)
         F2GEN = (F2QT+F2QL)*wv + F2G*wv*wz
         F2RN = draprn()
         IF(F2GEN.GE.F2QMAX) THEN
            write(6,*) ' F2DHW : F2GEN > F2MAX ',F2GEN,F2QMAX
         ELSEIF(F2GEN.LE.0.D0.OR.F2QMAX.LE.0.D0) THEN
            write(6,*) ' F2DHW: F2GEN OR F2MAX < 0 ',F2GEN,F2QMAX
            write(6,*) ' F2DHW: beta,x_pom,q2,t2',beta,x_pom,q2,t2
         ENDIF
c rotation with pt2gen is done in pyremn similar to primordial pt
         IF(F2QMAX*F2RN.GT.F2GEN) GOTO 30
         FT = F2G*wv*wz/F2GEN
         PT2TT = (1.d0 - beta)*q02/v
         IF(FT.GE.draprn()) THEN
            PT2GEN = (1.d0 - z)*q02/v
         ELSE
            PT2GEN = (1.d0 - beta)*q02/v
         ENDIF
c      write(6,*) ' F2DHW final : PT2GEN,v,beta,q2,z',pt2gen,v,beta,q2,z
c      write(6,*) ' F2DHW final : PT2GEN(beta),PT2GEN',pt2tt,pt2gen
c      write(6,*) ' F2DHW final :F2GEN,F2G*wv*wz',F2GEN,F2G*wv*wz
      endif
      RETURN
      END
c-----------------------------------------------------
      double precision function pom(xp,t,v)
      implicit DOUBLE PRECISION (a-g,o-z)

c
c
      q02=1.0d0
      pm=1.09d0
      eps=0.08d0
      if (log(q02/v).gt.-2.0d0) then
         pm=pm/(log(q02/v)+3.0d0)**0.558d0
         eps=eps+0.0997d0*log(log(q02/v)+3.0d0)
      endif
      pm=pm**2
      eps=2.0d0*eps
      pm=pm*(0.05d0/xp)**eps
c
      fm=(4.0d0+2.8d0*t)**2/(4.0d0+t)**2
      form=fm/(1.0d0+t/0.7d0)**4*xp**(0.5d0*t)
c      form=exp(-2.0d0*b*t)*xp**(0.5d0*t)
c
      pom=pm*form
c      write(6,*) 'pom: xp,t,v ',xp,t,v
c      write(6,*) 'pom: pm,form',pm,form
c      write(6,*) ' old pom = ',pm*form
C new parameters from ANL-HEP-PR 97-03
c new pomeron flux (gluon density)
      A = 0.877d0
      B = 0.133d0
      C = 0.596d0
      x0 = 0.05d0
      alpom = 0.085
      scale = 1.d0/v
      lnscale=log(scale/q02)
      if(lnscale.lt.0d0) lnscale=0.d0
      if(scale.gt.q02) then
         alpom = alpom + B*log(lnscale+1.d0)
      endif
c here we use (x0/xp)**alpom instead of (x0/xp)**(1-alpom) as in the paper
c which is presumably a typing error
      pm = A * (x0/xp)**(alpom) *(lnscale + 1.d0)**(-C)
c new form of t dependence
      B_D = 5.9d0
      form = exp(-B_D*t)
c      form = form/B_D
c      write(6,*) ' wuesthoff v,t,xp:',v,t,xp,pm,form
      pom = pm**2 * form
c      write(6,*) ' new pom = ',pm*form

c
      return
      end
c------------------------------------------------------------
      double precision function fql(beta,v)
      implicit DOUBLE PRECISION (a-g,o-z)
      DOUBLE PRECISION nql,lnln

c
c      double precision beta,v,root,lnln,nql
c
      if (v.gt.1.0d3) then
         nql=log(beta*v)
      else
         root=sqrt(v**2+2.0d0*(1.0d0-2.0d0*beta)*v+1.0d0)
c
         lnln=root-(1.0d0-2.0d0*beta+v)
         lnln=lnln/(root+(1.0d0-2.0d0*beta)*v+1.0d0)
         lnln=log(lnln)
c
         nql=log(1.0d0/beta)
         nql=nql+lnln/root
         nql=nql+(1.0d0/root-1.0d0)*log(v)
      endif
c
      fql=nql
c       write(6,*)'nql=',nql,'v = ',v,' beta = ',beta
      return
      end
c---------------------------------------------------------------
      double precision function fqt(beta,v)
      implicit DOUBLE PRECISION (a-g,o-z)
      DOUBLE PRECISION nqt,lnln
c
c      double precision beta,v,root,lnln,nqt,xa,xb
c
      if (v.gt.1.0d3) then
         nqt=2.0d0*((1.0d0-beta)*log(v)-beta*log(beta))
      else
         root=sqrt(v**2+2.0d0*(1.0d0-2.0d0*beta)*v+1.0d0)
c
         lnln=root-(1.0d0-2.0d0*beta+v)
         lnln=lnln/(root+(1.0d0-2.0d0*beta)*v+1.0d0)
         lnln=log(lnln)
         xa=1.0d0-2.0d0*beta
         xb=(xa+v)/root
c
         nqt=xa*log(1.0d0/beta)
         nqt=nqt+xb*lnln
         nqt=nqt+(xb-xa)*log(v)
      endif
c
      fqt=nqt
c      write(6,*)'nqt=',nqt,' v = ',v,' beta = ',beta
      return
      end
c---------------------------------------------------------------
      double precision function fg(z,v)
      implicit DOUBLE PRECISION (a-g,o-z)
      DOUBLE PRECISION ng,lnln

c
c      double precision z,v,root,lnln,ng,xa,xb
c
      if ((1.0d0-z)*v**2/(v-1.0d0)**2.lt.1.0d-3
     +                          .and.v.gt.1.0d0) then
         ng=(3.0d0*v-5.0d0)*v/(v-1.0d0)**2
         ng=ng+2.0d0*(1.0d0+1.0d0/(v-1.0d0)**3)*log(v)
         ng=ng*(1.0d0-z)**2
      elseif (v.gt.1.0d3) then
         ng=2.0d0*(z-1.0d0-z**2*log(z)-(1.0d0-z)**2*log(v))
      else
         root=sqrt(v**2+2.0d0*(1.0d0-2.0d0*z)*v+1.0d0)
c
         lnln=root-(1.0d0-2.0d0*z+v)
         lnln=lnln/(root+(1.0d0-2.0d0*z)*v+1.0d0)
         lnln=log(lnln)
         xa=1.0d0+v-2.0d0*z*(1.0d0-z)
         xb=root-2.0d0*z*(1.0d0-z)/root
c
         ng=xa*log(1.0d0/z)
         ng=ng+(2.0d0*v-xa+xb)*log(v)
         ng=ng+xb*lnln
      endif
      ng=ng/(1.0d0-z)
c       write(6,*)'ng= ',ng,' v = ',v,' beta = ',beta
c
      fg=ng
      return
      end
c---------------------------------------------------------------------
      subroutine xntotal(xnqt,xng,xnql,q2,x_pom,beta,v,z,t)
c
c
      implicit DOUBLE PRECISION (a-g,o-z)
      DOUBLE PRECISION lim
c      double precision xnqt,fqt,xng,fg,xnql,fql,lim,
c     +                 q2,yb,beta,v,z,t,x_pom,jacob,pom,xpom,alp
c
c
      pi=2.0d0*asin(1.0d0)
      q02=1.0d0
      alp=0.25d0
      xng = 0.d0
      xnqt = 0.d0
      xnql = 0.d0
c
c
      xpom=pom(x_pom,-t,v)
      xpom = xpom/x_pom
      if (v.lt.q02/q2) then
         xng=0.0d0
      else
         xng=fg(z,v)/v
         xng=xng**2/q02*((1.0d0-beta/z)**2+(beta/z)**2)
         xng=xng*9.0d0/4.0d0*alp/8.0d0/pi*log(v*q2/q02)
c
         xng = xng/12.d0/z**2 * xpom * beta
c          write(6,*) ' xntotal xng,xpom',xng,xpom

      endif
c
      xnql=fql(beta,v)
      xnql=xnql**2/q2/v**3*4.0d0/3.0d0
c
      xnql = xnql/6.d0 * xpom * beta**3
c
c      write(6,*) ' xntotal xnql,xpom',xnql,xpom
      xnqt=fqt(beta,v)/v
      xnqt=xnqt**2/q02/6.0d0/(1.0d0-beta)
      xnqt=xnqt/sqrt(1.0d0-4.0d0*q02/q2*beta/v)
c add in new factor from ANL-HEP-PR-97-03
cccccccc      xnqt=xnqt*(1.0d0-2.0d0*q02/q2*beta/v)
      xnqt = xnqt/12.d0*beta *xpom
c      write(6,*) ' xntotal xnqt,xpom',xnqt,xpom
c
      lim=1.0d0-4.0d0*q02/q2*beta/v
      if (lim.lt.0.01d0) then
         xnql=xnql*20.0d0
         xnqt=xnqt*20.0d0
      else
         xnql=xnql/dsqrt(lim)
         xnqt=xnqt/dsqrt(lim)
      endif
c
      return
      end
*CMZ :  2.08/04 22/12/99  15.39.29  by  Hannes Jung
*CMZ :  2.06/34 20/05/98  09.12.56  by  Hannes Jung
*CMZ :  2.06/31 25/03/98  16.02.23  by  Hannes Jung
*CMZ :  2.06/28 12/03/98  14.44.31  by  Hannes Jung
*CMZ :  2.05/05 20/03/97  12.01.08  by  Hannes Jung
*CMZ :  2.04/00 23/12/96  11.32.31  by  Hannes Jung
*CMZ :  2.03/07 16/09/96  08.58.52  by  Hannes Jung
*CMZ :  2.03/05 06/09/96  08.15.27  by  Hannes Jung
*CMZ :  2.03/04 27/08/96  17.16.20  by  Hannes Jung
*CMZ :  2.03/03 21/08/96  09.28.27  by  Hannes Jung
*CMZ :  2.03/02 18/08/96  17.43.17  by  Hannes Jung
*CMZ :  2.02/03 01/08/96  09.40.25  by  Hannes Jung
*CMZ :  2.02/02 25/07/96  12.26.13  by  Hannes Jung
*CMZ :  2.02/00 02/07/96  17.40.39  by  Hannes Jung
*CMZ :  2.01/19 24/06/96  12.34.52  by  Hannes Jung
*CMZ :  2.01/18 20/06/96  11.21.16  by  Hannes Jung
*CMZ :  2.01/17 05/06/96  15.53.05  by  Hannes Jung
*CMZ :  2.01/15 19/05/96  13.20.55  by  Hannes Jung
*-- Author :    Hans Lotter   19/05/96
      SUBROUTINE F2BLW(BET,X_POM,Q2,T2,F2QT,FLQ)
* calculate  F_2^D in the hard approach of J. Bartels, H. Lotter, M. Wuesthoff
*                                          (DESY 96-026)
* the subroutines come from H. Lotter
* THANKS A LOT
*

      IMPLICIT DOUBLE PRECISION (A-G,O-Z)
      DOUBLE PRECISION PT2GEN,PHIGEN
      COMMON/HARDPOM/PT2GEN,PHIGEN
      common   /phi/       phi
      common   /parameter/ s,q,beta,xp,t
      INTEGER IPHI
      COMMON /SEL/IPHI
*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGPARA.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE


*KEND.

      REAL * 4 SLO,SHI,FBLW,XEPS,RESULT,ULMASS
      EXTERNAL FBLW,ULMASS
      DATA SMALL/1.D-6/
      IPHI = 0
      XEPS = 0.01
      SLO = SNGL(SMALL)
      SHI = 1. - SLO
      q = Q2
      beta = bet
      xp = x_pom
      t = t2
      phi = 0.d0
      aem=1.d0/137.d0
      pi=2.d0*dasin(1.d0)
      s = SSS
      pt2min=pt2cut(12)
      xm=q2/beta-q2 + t
      pt2max=xm/4.d0 - 4.d0*DBLE(ULMASS(3))**2
      F2QT = 0.D0
      FLQ = 0.D0
      if(pt2min.gt.pt2max) return
      NI = 25

c      write(6,*) 'F2BLW: beta,xpom,q2,t2',beta,x_pom,q2,t2
      CALL INTGA(SLO,SHI,FBLW,XEPS,RESULT)
c      write(6,*) ' after INTGA : ',RESULT
c          write(6,*) ' f2blw  xng,xpom',,xng,xpom
c      write(6,*) 'f2blw f2qt ',f2qt
      F2QT=DBLE(RESULT)
      FLQ=0.0D0

   10 CONTINUE
c         write(6,*) ' f2blw iwei =',iwei
      if(iwei.eq.1) then
c         write(6,*) ' f2blw iwei =1'
         F2QMAX = 0.D0
         DO 20 I1 = 0,NI
            rn1 = dfloat(I1)/dfloat(NI)
            if(rn1.eq.0.d0) rn1 = small
            if(rn1.eq.1.d0) rn1 = 1.d0 - small
c weighting with 1/pt**4
            pt2 = pt2min*pt2max/(rn1*pt2min + pt2max*(1.D0 - rn1))
            wpt2 = pt2**2*(pt2max-pt2min)/pt2min/pt2max
            if(rn1.gt.0.998d0) goto 20
            CALL SIGBLW(pt2,sigt,sigl)
            F2TEST = sigt*Q2/(4.D0*PI**2*aem)*wpt2
c         write(6,*) ' f2blw 1st: F2TEST,wpt2 ',F2TEST,wpt2,sigt,pt2
            IF(F2TEST.GE.F2QMAX) F2QMAX = F2TEST

   20    CONTINUE
         F2QMAX = 2.D0*F2QMAX
   30    CONTINUE
         iphi = 1
         rn1 = draprn()
c weighting with 1/pt**4
         pt2 = pt2min*pt2max/(rn1*pt2min + pt2max*(1.D0 - rn1))
         wpt2 =  pt2**2*(pt2max-pt2min)/pt2min/pt2max
         if(rn1.gt.0.998d0) goto 30
         rn2 = draprn()
c chi integration (0 - 2*pi)
         PHI = rn2*2.d0*pi

         CALL SIGBLW(pt2,sigt,sigl)
         F2GEN =  sigt*Q2/(4.D0*PI**2*aem)*wpt2
         F2RN = draprn()
         IF(F2GEN.GE.F2QMAX) THEN
            write(6,*) ' F2BLW : F2GEN > F2MAX ',F2GEN,F2QMAX
         ELSEIF(F2GEN.LT.0.D0.OR.F2QMAX.LT.0.D0) THEN
            write(6,*) ' F2BLW: F2GEN OR F2MAX < 0 ',F2GEN,F2QMAX
            write(6,*) ' F2BLW: beta,x_pom,q2,t2',beta,x_pom,q2,t2
            write(6,*) ' F2BLW: sigt,wpt2 ',sigt,wpt2
         ENDIF
c rotation with pt2gen is done in pyremn similar to primordial pt
         IF(F2QMAX*F2RN.GT.F2GEN) THEN
c            write(6,*) 'F2QMAX*F2RN.GT.F2GEN',F2QMAX,F2RN,F2GEN
            GOTO 30
         ENDIF
         PT2GEN = pt2
         PHIGEN = PHI
c         write(6,*) ' F2BLW final : PT2GEN',pt2gen,' phigen ',phigen
      endif
      RETURN
      END

      FUNCTION FBLW(X)
      IMPLICIT DOUBLE PRECISION (A-G,O-Z)
      DOUBLE PRECISION PT2GEN,PHIGEN
      COMMON/HARDPOM/PT2GEN,PHIGEN
      common   /phi/       phi
      common   /parameter/ s,q,beta,xp,t
*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEND.
      REAL * 4 X,FBLW,ULMASS
      EXTERNAL ULMASS
      aem=1.d0/137.d0
      pi=2.d0*dasin(1.d0)
      pt2min=pt2cut(12)
      xm=q/beta-q + t
      pt2max=xm/4.d0 - 4.d0*DBLE(ULMASS(3))**2
      F2QT = 0.D0

      FBLW = 0.0
c      write(6,*) ' FBLW ',pt2min,pt2max,x
      if(pt2min.gt.pt2max) return
      rn1 = dble(x)
c weighting with 1/pt**2
c      pt2 = pt2min*(pt2max/pt2min)**rn1
c      wpt2 = log(pt2max/pt2min)*pt2
c weighting with 1/pt**4
      pt2 = pt2max*pt2min/(pt2max + rn1*(pt2min-pt2max))
      wpt2 = pt2**2*(pt2max-pt2min)/pt2max/pt2min
      CALL SIGBLW(pt2,sigt,sigl)
c         write(6,*) 'f2blw sig,pt2 ',f2qt,pt2
      F2QT=sigt*q/(4.D0*PI**2*aem)*wpt2
      FLQ=sigL*q/(4.D0*PI**2*aem)*wpt2
c          write(6,*) ' f2blw xng,xpom',,xng,xpom
c       write(6,*) ' s,q,beta,xp,t ',s,q,beta,xp,t
c       write(6,*) 'f2blw f2qt ',f2qt,pt2,x
      FBLW = SNGL(F2QT)
      RETURN
      END

      subroutine sigblw(pt,sigt,sigl)
c
c     <sig> berechnet den wq als funktion von pt^2, die anderen
c     kinematischen variablen werden im common uebergeben.
c     pt,q und m stehen immer fuer physikalisch pt^2,Q^2,M^2 .
c
c     die gluonstrukturfunktion wird im up grv_nl berechnet,
c     die ableitung der strfkt. in dgrv_nl.
c
c     das up gamma berechnet einen vorfaktor. es ruft ein
c     programm zur berechnung von running alpha_s auf.
c     durch das up dlformf wird implizit die t-integration
c     ausgefuehrt.
c
c     sigt, sigl, und sigi repraesentieren den gamma^* - p
c     wq fuer transversale und longitudinale photonen sowie
c     den interferenzterm.
c
      implicit none
      DOUBLE PRECISION   sigt,sigl,sigi,sigtt,epsilon
      DOUBLE PRECISION   dlformf
      DOUBLE PRECISION   s,q,xb,pt,m,beta,xp,t
      DOUBLE PRECISION   fact,facl,pi
      DOUBLE PRECISION   grv_nl,dgrv_nl
      DOUBLE PRECISION   gamma
      DOUBLE PRECISION   phi
c
      common   /phi/       phi
      common   /parameter/ s,q,beta,xp,t
      INTEGER IPHI
      COMMON /SEL/IPHI
*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEND.
c
      pi=2.d0*dasin(1.d0)
      fact=4.d0/3.d0
      facl=4.d0/3.d0
c
      m=q/beta-q
      xb=beta*xp
c
c
      sigtt=gamma(pt*(q+m)/m)*
     +      fact*
     +     (1.d0-2.d0/m*pt)/dsqrt(1.d0-4.d0*pt/m)/pt**2*
     +     m**2/(q+m)**4*
     +     (
     +      grv_nl( xb*(q+m)/q,pt*(q+m)/m)*beta    +
     +      1.d0*
     +      pt*dgrv_nl( xb*(q+m)/q,pt*(q+m)/m)*(
     +       1.5d0*(1.d0-4.d0/3.d0*beta)  -
     +       1.d0*(1.d0-beta-(1.d0-beta)*dlog(beta)+dlog(beta))  )
     +     )**2
     +     *dlformf(m,q,xb,0)
c include jacobian dM**2 --> dx_pom
      sigtt = sigtt*q/xb
c
c
      sigl=gamma(pt*(q+m)/m)*
     +     facl*1.d0/dsqrt(1.d0-4.d0*pt/m)*
     +     q/(q+m)**4/pt*
     +     (
     +      grv_nl( xb*(q+m)/q,pt*(q+m)/m)*(2.d0*beta-1.d0) +
     +      1.d0*
     +      pt*dgrv_nl( xb*(q+m)/q,pt*(q+m)/m)*(
     +       3.d0*(1.d0-beta)  -
     +       (1.d0-beta-2.d0*(1.d0-beta)*dlog(beta)+dlog(beta))  )
     +     )**2
     +     *dlformf(m,q,xb,0)
c include jacobian dM**2 --> dbeta
      sigl = sigl*q/xb
c
      sigi=gamma(pt*(q+m)/m)
     +      /m**2*dsqrt(pt/q)*4.d0/3.d0*
     +      m*q*m**2/pt**2/(q+m)**4*
     +     (
     +      grv_nl( xb*(q+m)/q,pt*(q+m)/m)*beta    +
     +      1.d0*
     +      pt*dgrv_nl( xb*(q+m)/q,pt*(q+m)/m)*(
     +       1.5d0*(1.d0-4.d0/3.d0*beta)  -
     +       1.d0*(1.d0-beta-(1.d0-beta)*dlog(beta)+dlog(beta))  )
     +     )*
     +     (
     +      grv_nl( xb*(q+m)/q,pt*(q+m)/m)*(2.d0*beta-1.d0) +
     +      1.d0*
     +      pt*dgrv_nl( xb*(q+m)/q,pt*(q+m)/m)*(
     +       3.d0*(1.d0-beta)  -
     +       (1.d0-beta-2.d0*(1.d0-beta)*dlog(beta)+dlog(beta))  )
     +     )
     +     *dlformf(m,q,xb,0)
c include jacobian dM**2 --> dbeta
      sigi = sigi*q/xb
      epsilon =(1.d0 - dble(yy))/(1.d0 - dble(yy) + dble(yy)**2/2.d0)
      if(iphi.eq.1) then
         sigt =    ((1.d0-2.d0*epsilon*dcos(2.d0*phi)*1.d0*
     +             pt/m/(1.d0-2.d0*pt/m)
     +              )*sigtt
     +             + (2.d0-dble(yy))*dsqrt(1.d0-dble(yy))*sigi*dcos(phi)
     +               /(1.d0 - dble(yy) + dble(yy)**2/2.d0)
     +             + epsilon*sigl
     +              )
     +              /2.d0/pi
         sigl = sigl/2.d0/pi
      else
         sigt = sigtt + epsilon*sigl
      endif
      if(sigt.lt.0.0) then
         write(6,*) ' sigt<0.0',sigtt,epsilon
         write(6,*) ' sigt1',-2.d0*epsilon*dcos(2.d0*phi)*1.d0*
     +    pt/m/(1.d0-2.d0*pt/m)
         write(6,*) ' sigt2',(2.d0-dble(yy))*dsqrt(1.d0-dble(yy))
     +    *sigi*dcos(phi)
         write(6,*) ' sigt3 yy',yy,q/xb/s,xb,phi
         write(6,*) ' sigl sigt',sigl,sigt
      endif
c
      return
      end


      function gamma(q)
      DOUBLE PRECISION   gamma,q
      DOUBLE PRECISION   aem,alphasl,pi,charge
      common   /cons/   aem,pi
comment on aem: since we use f2 aem is cancelled, so it doesnt matter
      aem=1.d0/137.d0
      pi=2.d0*dasin(1.d0)
      charge=1.D0/3.D0*1.D0/3.D0+2.D0/3.D0*2.D0/3.D0+1.D0/3.D0*1.D0/3.D0
      gamma=aem*alphasl(q)**2*pi**2*charge
      return
      end
c
      FUNCTION ALPHAsl(Q)
      IMPLICIT REAL*8 (A-H,P-Z)
      pi=2.d0*dasin(1.d0)
      ZETAM = 91.161D0
      ALPHAZ = 0.12D0
      FLAVOR = 4.0D0
      BZERO = 11.0D0 - 2.0D0*FLAVOR/ 3.0D0
      ALPHAsl = ALPHAZ/ (1 + ALPHAZ*BZERO*DLOG(dsqrt(Q)/ZETAM)/2.0D0/PI)
c here use for consistency alphas(SQRT(Q))
c      write(6,*) ' blw alphas ',alphasl
      alphasl = alphas(dsqrt(Q))
c      write(6,*) ' my alphas ',alphasl
      RETURN
      END


      function dlformf(m,q,xb,i)
      DOUBLE PRECISION   dlformf,m,xb,q,xp
      DOUBLE PRECISION   a,b1,b2
      DOUBLE PRECISION   dexpin
      DOUBLE PRECISION   s,wmax,wmin
      DOUBLE PRECISION   ss,beta,xpp,t,qq,alphap,dl
      common   /parameter/ ss,qq,beta,xpp,t
      integer  i
c
      common   /hera/   s,wmax,wmin
c
      xp=xb*(q+m)/q
      a=dlog(1.d0/xp)
c
      if(i.eq.1) then
         dlformf=0.30119d0
      else if(i.eq.2) then
         b1=dexpin(0.35d0*a)
         b2=dexp(0.35d0*a)
         dlformf=-0.00191*b1*b2*a**3-0.085699*a+0.04559*dexp(2.d0*a)*
     +   dexpin(2.d0*a)+0.00546*a**2-0.052477*a*dexp(2*a)* dexpin(2.d0*
     +   a)-0.02274*a*b1*b2+0.0245331*a**2*b1*b2+ 0.380649-0.04558633*
     +   b1*b2
      elseif(i.eq.0) then
c use donnachie landshoff formfactor
c        f(t)=(1/x)^(alpha'*t)*(4-2.8*t)/(4-t)*1/(1-t/0.7)^2
c        alpha' = 0.25
         alphap = 0.25d0
         dl =(1.d0/xp)**(alphap*t)*(4.d0-2.8d0*t)/(4.d0-t)*
     +   1.d0/(1.d0-t/0.7d0)**2
c         write(6,*) ' dlformf : ',dl
         dlformf = dl**2
      end if
      return
      end


      function grv_nl(x,q)
      implicit none
      DOUBLE PRECISION grv_nl,x,q,s1,s2
      s1 = (1-x)**(0.3404D1+0.83D0*dlog(0.5848488801D0*dlog(0.162591051D
     +2*q)))
      s2 = x**(0.1724D1+0.157D0*dlog(0.5848488801D0*dlog(0.162591051D2*q
     +)))*(0.7517D1-0.2547D1*dlog(0.5848488801D0*dlog(0.162591051D2*q))+
     +(0.3409D2-0.5221D2*dsqrt(dlog(0.5848488801D0*dlog(0.162591051D2*q)
     +))+0.1747D2*dlog(0.5848488801D0*dlog(0.162591051D2*q)))*x+(0.4039D
     +1+0.1491D1*dlog(0.5848488801D0*dlog(0.162591051D2*q)))*x**2)*dlog(
     +1/x)**(0.8D0+0.1016D1*dlog(0.5848488801D0*dlog(0.162591051D2*q)))+
     +dlog(0.5848488801D0*dlog(0.162591051D2*q))**0.1014D1*dexp(0.1112D1
     +-0.3438D1*dlog(0.5848488801D0*dlog(0.162591051D2*q))+0.302D0*dlog(
     +0.5848488801D0*dlog(0.162591051D2*q))**2+dsqrt((0.3256D1-0.436D0*d
     +log(0.5848488801D0*dlog(0.162591051D2*q)))*dlog(0.5848488801D0*dlo
     +g(0.162591051D2*q))**0.1738D1*dlog(1/x)))
      grv_nl = s1*s2
      return
      end


      function dgrv_nl(x,q)
      implicit none
      DOUBLE PRECISION   dgrv_nl,x,q
      DOUBLE PRECISION s1,s2,s3,s4,s5,s6,s7,s8,s9,s10
      DOUBLE PRECISION s11,s12,s13,s14
      integer itest
      data itest/1/
      if(itest.eq.0) then
         dgrv_nl = 0.d0
      else
         s2 = 0.83D0*(1-x)**(0.3404D1+0.83D0*dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q)))/q
         s3 = 1/dlog(0.162591051D2*q)*dlog(1-x)*(x**(0.1724D1+0.157D0*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q)))*(0.7517D1-
     +   0.2547D1*dlog(0.5848488801D0*dlog(0.162591051D2*q))+(0.3409D2-
     +   0.5221D2*dsqrt(dlog(0.5848488801D0*dlog(0.162591051D2*q)))+
     +   0.1747D2*dlog(0.5848488801D0*dlog(0.162591051D2*q)))*x+
     +   (0.4039D1+0.1491D1*dlog(0.5848488801D0*dlog(0.162591051D2*q)))
     +   *x**2)*dlog(1/x)**(0.8D0+0.1016D1*dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q)))+dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q))**0.1014D1*dexp(0.1112D1-0.3438D1*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q))+0.302D0*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q))**2+dsqrt((0.3256D1-
     +   0.436D0*dlog(0.5848488801D0*dlog(0.162591051D2*q)))*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q))**0.1738D1*dlog(1/x)
     +   )))
         s1 = s2*s3
         s3 = (1-x)**(0.3404D1+0.83D0*dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q)))
         s6 = 0.157D0*x**(0.1724D1+0.157D0*dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q)))/q/dlog(0.162591051D2*q)*dlog(x)*
     +   (0.7517D1-0.2547D1*dlog(0.5848488801D0*dlog(0.162591051D2*q))+
     +   (0.3409D2-0.5221D2*dsqrt(dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q)))+0.1747D2*dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q)))*x+(0.4039D1+0.1491D1*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q)))*x**2)*dlog(1/x)**
     +   (0.8D0+0.1016D1*dlog(0.5848488801D0*dlog(0.162591051D2*q)))
         s7 = x**(0.1724D1+0.157D0*dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q)))*(-0.2547D1/q/dlog(0.162591051D2*q)+(-
     +   0.26105D2/dsqrt(dlog(0.5848488801D0*dlog(0.162591051D2*q)))/q/
     +   dlog(0.162591051D2*q)+0.1747D2/q/dlog(0.162591051D2*q))*x+
     +   0.1491D1/q/dlog(0.162591051D2*q)*x**2)*dlog(1/x)**(0.8D0+
     +   0.1016D1*dlog(0.5848488801D0*dlog(0.162591051D2*q)))
         s5 = s6+s7
         s6 = s5+0.1016D1*x**(0.1724D1+0.157D0*dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q)))*(0.7517D1-0.2547D1*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q))+(0.3409D2-0.5221D2*
     +   dsqrt(dlog(0.5848488801D0*dlog(0.162591051D2*q)))+0.1747D2*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q)))*x+(0.4039D1+
     +   0.1491D1*dlog(0.5848488801D0*dlog(0.162591051D2*q)))*x**2)*
     +   dlog(1/x)**(0.8D0+0.1016D1*dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q)))/q/dlog(0.162591051D2*q)*dlog(dlog(1/x)
     +   )
         s7 = s6
         s9 = 0.1014D1*dlog(0.5848488801D0*dlog(0.162591051D2*q))**
     +   0.14D-1*dexp(0.1112D1-0.3438D1*dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q))+0.302D0*dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q))**2+dsqrt((0.3256D1-0.436D0*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q)))*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q))**0.1738D1*dlog(1/x)
     +   ))/q/dlog(0.162591051D2*q)
         s11 = dlog(0.5848488801D0*dlog(0.162591051D2*q))**0.1014D1
         s13 = -0.3438D1/q/dlog(0.162591051D2*q)+0.604D0*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q))/q/
     +   dlog(0.162591051D2*q)+1/dsqrt((0.3256D1-0.436D0*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q)))*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q))**0.1738D1*dlog(1/x)
     +   )*(-0.436D0/q/dlog(0.162591051D2*q)*dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q))**0.1738D1*dlog(1/x)+0.1738D1*(0.3256D1-
     +   0.436D0*dlog(0.5848488801D0*dlog(0.162591051D2*q)))*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q))**0.738D0*dlog(1/x)/
     +   q/dlog(0.162591051D2*q))/2
         s14 = dexp(0.1112D1-0.3438D1*dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q))+0.302D0*dlog(0.5848488801D0*
     +   dlog(0.162591051D2*q))**2+dsqrt((0.3256D1-0.436D0*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q)))*
     +   dlog(0.5848488801D0*dlog(0.162591051D2*q))**0.1738D1*dlog(1/x)
     +   ))
         s12 = s13*s14
         s10 = s11*s12
         s8 = s9+s10
         s4 = s7+s8
         s2 = s3*s4
c multiplying with q give p_t**2 *dgrv	
c         dgrv_nl = (s1+s2)*q
c now put this factor in x section calc...
         dgrv_nl = (s1+s2)
      endif
      return
      end
*CMZ :  2.08/04 22/12/99  15.39.30  by  Hannes Jung
*CMZ :  2.06/34 20/05/98  09.12.56  by  Hannes Jung
*CMZ :  2.06/26 23/01/98  22.07.10  by  Hannes Jung
*CMZ :  2.06/10 16/10/97  10.32.53  by  Hannes Jung
*CMZ :  2.06/02 29/07/97  09.22.42  by  Hannes Jung
*CMZ :  2.05/05 20/03/97  12.36.52  by  Hannes Jung
*CMZ :  2.03/04 05/09/96  17.11.59  by  Hannes Jung
*CMZ :  2.03/03 22/08/96  19.41.59  by  Hannes Jung
*CMZ :  2.03/02 16/08/96  15.14.32  by  Hannes Jung
*CMZ :  2.02/03 01/08/96  09.49.34  by  Hannes Jung
*CMZ :  2.02/02 25/07/96  12.26.14  by  Hannes Jung
*CMZ :  2.02/01 02/07/96  18.57.50  by  Hannes Jung
*CMZ :  2.02/00 02/07/96  17.58.21  by  Hannes Jung
*CMZ :  2.01/19 25/06/96  12.14.36  by  Hannes Jung
*CMZ :  2.01/18 20/06/96  11.21.16  by  Hannes Jung
*CMZ :  2.01/15 20/05/96  07.27.09  by  Hannes Jung
*-- Author :    Hannes Jung   19/05/96

      SUBROUTINE F2MD(BETA,X_POM,Q2,T2,XDX,FLQ)
* calculate  F_2^D in the approach of M. Diehl
      IMPLICIT DOUBLE PRECISION (A-G,O-Z)
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGPARAM.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEND.
      DOUBLE PRECISION mq,mp,mx2,beta0,mu0
      DOUBLE PRECISION PT2GEN,PHIGEN
      DOUBLE PRECISION XDX(-4:4)
      COMMON/HARDPOM/PT2GEN,PHIGEN
      DOUBLE PRECISION PT2MD,PHIMD
      COMMON/PT/PT2MD,PHIMD
      COMMON /PARMD/ bet,xpom,q2t,t2t,mq,eq2
      COMMON /SEL/IPHI
      REAL ULMASS
      EXTERNAL ULMASS,LUCHGE
      REAL SLO,SHI,FMD,XEPS,RESULT
*KEEP,RGLUDAT2.
      REAL PMAS,PARF,VCKM
      INTEGER KCHG
      COMMON/LUDAT2/KCHG(500,3),PMAS(500,4),PARF(2000),VCKM(4,4)
C      SAVE

*KEND.
      EXTERNAL FMD
      DATA SMALL/1.D-6/
      IPHI = 0
      pi=2.d0*dasin(1.d0)
      XEPS = 0.01
      SLO = SNGL(SMALL)
      SHI = 1. - SLO
      q2t = q2
      t2t = t2
      bet = beta
      xpom = x_pom
c      write(6,*) ' xpom',x_pom,beta,q2,t2
      mp = 0.938d0
      mx2 = Q2*(1.d0-beta)/beta + t2
c      write(6,*) ' f2md mx2,t2 ',mx2,t2
      eq2 = 2.d0/3.d0
      beta0 = 2.d0
      mu0 = 1.2d0
      mq = 0.3d0
      alphas0 = 1.d0
      NI = 25
      DO 10 I=-4,4
   10 XDX(I)=0.d0
      F2GF = 0.D0
      pt2min=pt2cut(12)
c      write(6,*) ' F2MD ptmin,pt2cut',pt2min,pt2cut(12)
c      write(6,*) 'F2MD: beta,xpom,q2,t2,f1t',beta,x_pom,q2,t2
      F2QMAX = 0.D0
      DO 20 IP=1,NFLAV
c current quark masses
c         mq=dble(ulmass(ip))
c constituent quark masses
         mq=dble(PARF(100+IP))
         eq2 = dble(LUCHGE(IP))**2/9.0d0
c         write(6,*) ' mass ',mq,eq2,ip
         F2QTF =0.d0
         CALL INTGA(SLO,SHI,FMD,XEPS,RESULT)
c        write(6,*) ' after INTGA : ',RESULT
         F2QTF=DBLE(RESULT)
         XDX(IP)=F2QTF/eq2/2.D0
   20 CONTINUE
      XDX(-4)=XDX(4)
      XDX(-3)=XDX(3)
      XDX(-2)=XDX(2)
      XDX(-1)=XDX(1)
      XDX(0) = 0.d0
c      write(6,*) ' F2MD:F2QTF ',F2QTF,XDX
c      write(6,*) ' F2MD final : PT2GEN,v,beta,q2',pt2gen,v,beta,q2
      if(iwei.eq.1) then
         F2QMAX = 0.D0
         q2t = q2
         t2t = t2
         bet = beta
         xpom = x_pom
c      write(6,*) ' xpom',x_pom,beta,q2,t2
         mp = 0.938d0
         mx2 = Q2*(1.d0-beta)/beta + t2
         DO 30 I1 = 0,NI
            ip = KPA
c current quark masses
c           mq=dble(ulmass(ip))
c constituent quark masses
            mq=dble(PARF(100+IP))
            eq2 = dble(LUCHGE(IP))**2/9.0d0
            rn2 = dfloat(I1)/dfloat(NI)
            if(rn2.eq.0.d0) rn2 = small
            if(rn2.eq.1.d0) rn2 = 1.d0 - small


            F2QT = dble(FMD(SNGL(rn2)))
c         FLQ =  sigl * wpt2
            F2TEST = F2QT
c         write(6,*) ' f2md 1st: F2QT FLQ ',F2QT,FLQ,rn2
c         write(6,*) ' pt2,wpt2,sigt',pt2,wpt2,sigt
            IF(F2TEST.GE.F2QMAX) F2QMAX = F2TEST
   30    CONTINUE
         F2QMAX = 2.0D0*F2QMAX

   40    CONTINUE
         IPHI = 1
         rn1 = draprn()
         rn2 = draprn()
c chi integration (0 - 2*pi)
         PHIMD = rn1*2.d0*pi
         if(rn2.gt.0.998d0) goto 40
         F2GEN = dble(FMD(SNGL(rn2)))
         PT2GEN = PT2MD
         PHIGEN = PHIMD
         F2RN = draprn()
c            write(6,*) ' F2MD: KPA = ',IP
c            write(6,*) ' F2MD : F2GEN F2MAX ',F2GEN,F2QMAX
c            write(6,*) ' f2MD: pt2,pl2,chi ',pt2,pl2,chi
         IF(F2GEN.GE.F2QMAX) THEN
            write(6,*) ' F2MD : F2GEN > F2MAX ',F2GEN,F2QMAX
         ELSEIF(F2GEN.LT.0.D0.OR.F2QMAX.LT.0.D0) THEN
            write(6,*) ' F2MD : F2GEN OR F2MAX < 0 ',F2GEN,F2QMAX
            write(6,*) ' F2MD : beta,x_pom,q2,t2',beta,x_pom,q2,t2

         ENDIF
c rotation with pt2gen is done in pyremn similar to primordial pt
         IF(F2QMAX*F2RN.GT.F2GEN) GOTO 40
c        write(6,*) ' F2MD final : PT2GEN,PHIGEN',pt2gen,phigen
      endif
      RETURN
      END

      FUNCTION FMD(X)
      IMPLICIT DOUBLE PRECISION (A-G,O-Z)
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEND.
      DOUBLE PRECISION mq,mx2
      DOUBLE PRECISION PT2MD,PHIMD
      COMMON/PT/PT2MD,PHIMD
      COMMON /PARMD/ beta,xpom,q2,t2,mq,eq2
      REAL ULMASS
      EXTERNAL ULMASS,LUCHGE
      REAL X,FMD
      DATA SMALL/1.D-6/
      pi=2.d0*dasin(1.d0)
      pt2min=pt2cut(12)
      mx2 = Q2*(1.d0-beta)/beta + t2
      FLQ = 0.D0
      F2Q = 0.D0
      FMD = 0.
c      write(6,*) 'F2MD: beta,xpom,q2,t2,f1t',beta,x_pom,q2,t2,f1t
      wchi = 2.d0*pi
c try 1/pt**4
      pt2max = mx2/4.d0 - 4.d0*mq**2
c         write(6,*) pt2min,pt2max
      if(pt2min.gt.pt2max) return
      rn2 = dble(x)
      pt2 = pt2max*pt2min/(pt2max + rn2*(pt2min-pt2max))
      pl2 = mx2/4.d0 - mq**2 - pt2
      wpt2 = pt2**2*(pt2max-pt2min)/pt2max/pt2min
c multply wpt2 with jacobian pt -> pl : pt/pl
c and account for divergence at high pt --> pl --> 0
      if(rn2.gt.0.998d0) return
      wpt2=wpt2*dsqrt(pt2)/dsqrt(pl2)
      call sigmd(pt2,sigt,sigl)
c now from sigma to F2, FL
      F2Q = sigt*Q2/4.d0/pi * wpt2
      FLQ = sigl*Q2/4.d0/pi * wpt2
      IF(F2Q.LE.0.0) THEN
         write(6,*) 'FMD<0 ',sigt,sigl,wpt2
      ENDIF
c      write(6,*) 'F2Q ',F2Q
      pt2md=pt2
      FMD = SNGL(F2Q)
      RETURN
      END
      SUBROUTINE SIGMD(pt2,sigt,sigl)
c note that sigt,sigl is here defined as q2/4/pi*sigt (sigl)
c is actually the structure funtion
      IMPLICIT DOUBLE PRECISION (A-G,O-Z)
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGRAPGKI.
      REAL YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      COMMON/RAPGKI/ YY,XEL,XPR,PT2H,SHH,T2GKI,XFGKI
      REAL ZQGKI,XPGKI,PHITGKI
      COMMON/MEINFO/ZQGKI,XPGKI,PHITGKI
C     SAVE

*KEND.
      DOUBLE PRECISION lambda2,mq,mp,mx2,beta0,mu0
      DOUBLE PRECISION PT2MD,PHIMD
      COMMON/PT/PT2MD,PHIMD
      COMMON/HARDPOM/PT2GEN,PHIGEN
      COMMON /PARMD/ beta,xpom,q2,t2,mq,eq2
      COMMON /SEL/IPHI
      REAL ULMASS
      EXTERNAL ULMASS,LUCHGE
      sigt = 0.d0
      sigl = 0.d0
      mp = 0.938d0
      mp = 1.D0
      mx2 = Q2*(1.d0-beta)/beta + t2
      alpha_p=1.08d0 + t2/2.d0
      f1t = (4.d0*mp**2 - 2.8d0*t2)/(4.d0*mp**2 - t2)
      f1t = f1t/(1.d0 - t2/0.7d0)**2
c      write(6,*) ' F2MD t2: ',t2
      beta0 = 2.d0
      mu0 = 1.1d0
      betamu = beta0*mu0
      alphas0 = 1.d0
      pi=2.d0*dasin(1.d0)
c      write(6,*) 'sigMD: beta,xpom,q2,t2,f1t',beta,xpom,q2,t2,f1t
c      write(6,*) ' pt2 ',pt2
      pl2 = mx2/4.d0 - mq**2 - pt2
      if(pl2.le.0.0D0.or.pt2.le.0.0d0) return
      pl = dsqrt(pl2)
      pt = dsqrt(pt2)

c now F2MD
      lambda2 = (pt**2 + mq**2)/(1.d0 - beta)
      alpha_s=alphas(dsqrt(lambda2))
      if(alpha_s.lt.0.d0) alpha_s=0.d0
      if(alpha_s.ge.1.d0) alpha_s=1.d0
      xm = mx2/(pt2+mq**2)
      xp = pt2/(pt2+mq**2)
      aa = (1.d0-beta)*xp
      sigpp = xm**2*(1.d0 -2.d0/xm)*xp*(1.d0-aa)**2
      sigpp = sigpp+ 0.25d0*xm**2*mq**2/(pt2+mq**2)*(1.d0-2.d0* aa)**2
      sigl = Q2/mx2 *xm *(1.d0 -2.d0*aa)**2
      sigpm = 2.d0*xm*xp*(1.d0-aa)**2
      sigp0 = -2.d0*dsqrt(q2)/dsqrt(mx2)*xm*pl/pt*xp
      sigp0 = sigp0*(1.d0-aa)*(1.d0-2.d0*aa)
      sigt = sigpp
      comfac = 1.d0/dsqrt(mx2)*f1t**2 *xpom**(2.d0* (1.d0-
     +alpha_p))/xpom*27.d0/2.d0/pi**3 *eq2*alpha_s/alphas0*betamu**4/
     +(mx2+q2)**2 *(1.d0-beta)
c            write(6,*) 'SIGMD: pt2,comfac,sigt',pt2,comfac,sigt
      epsilon =(1.d0 - dble(yy))/(1.d0 - dble(yy) + dble(yy)**2/2.d0)
      if(iphi.eq.1) then
         sigt = comfac/2.D0/pi*(sigt + epsilon*sigl
     +    - epsilon*dcos(2.d0*phimd)*sigpm
     +    - dsqrt(2.d0*epsilon*(1.d0+epsilon))*dcos(phimd)*sigp0)
         sigl = comfac*sigl
      else
         sigt = comfac*(sigt+epsilon*sigl)
         sigl = comfac*sigl
      endif
      if(sigt.lt.0.0) then
         write(6,*) ' sigt<0.0 ',comfac,epsilon,phimd,sigpp
         write(6,*) ' sigt1 ',- epsilon*dcos(2.d0*phigen)*sigpm
         write(6,*) ' sigt2 ',- dsqrt(2.d0*epsilon*(1.d0+epsilon))
         write(6,*) ' sigt3 ',dcos(phimd)*sigp0
      endif
      RETURN
      END
*CMZ :  2.06/00 17/07/97  14.24.16  by  Hannes Jung
*CMZ :  2.05/28 15/07/97  10.27.09  by  Hannes Jung
*-- Author :    Hannes Jung   15/07/97
      SUBROUTINE F2MCD(BETA,X_POM,Q2,T2,XDX,FLQ)
* calculate   in the approach of M. McDermott
      IMPLICIT DOUBLE PRECISION (A-G,O-Z)
*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGPARAM.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEND.
      DOUBLE PRECISION PT2GEN,PHIGEN
      COMMON/HARDPOM/PT2GEN,PHIGEN
      COMMON /SEL/IPHI
      DOUBLE PRECISION XDX(-4:4)
      DOUBLE PRECISION C1,Cg
      COMMON/BUCHMUE/C1,Cg
*KEEP,RGLUDAT2.
      REAL PMAS,PARF,VCKM
      INTEGER KCHG
      COMMON/LUDAT2/KCHG(500,3),PMAS(500,4),PARF(2000),VCKM(4,4)
C      SAVE

*KEND.
      EXTERNAL FMD
      DATA SMALL/1.D-6/
      IPHI = 0
c      C1 = 1.d0
c      Cg = 1.d0
      q2t = q2
      t2t = t2
      bet = beta
      xpom = x_pom
      ymcd = xpom*bet
      umcd = xpom/ymcd - 1.d0
c      write(6,*) ' xpom',x_pom,beta,q2,t2
c include Donnacchi/Landshoff dipole form factor for t
      dl =(4.d0-2.8d0*t2t)/(4.d0-t2t)*
     +   1.d0/(1.d0-t2t/0.7d0)**2
      DO 10 I=-4,4
   10 XDX(I)=0.d0
c 1/xpom removed due to jacobian dy/dx_g=x_pom
      XDX(0) = C1/(cg + umcd)/xpom/bet*dl
      XDX(-4)=XDX(4)
      XDX(-3)=XDX(3)
      XDX(-2)=XDX(2)
      XDX(-1)=XDX(1)
      RETURN
      END

*CMZ :  2.08/04 17/01/2000  13.18.52  by  Hannes Jung
*CMZ :  2.06/31 25/03/98  16.03.43  by  Hannes Jung
*CMZ :  2.06/28 11/02/98  02.31.42  by  Hannes Jung
*-- Author :
      function dgrv_nln(dx,dq)

      implicit none
      double precision dx,dq
      REAL   dgrv_nln,x,q
      REAL s1,s2,s3,s4,s5,s6,s7,s8,s9,s10
      REAL s11,s12,s13,s14
      integer itest
      data itest/1/
      x = real(dx)
      q = real(dq)
      dgrv_nln = 0.e0
	if(q.lt.0.35) return
      if(itest.eq.0) then
         dgrv_nln = 0.e0
      else
         s2 = 0.83e0*(1-x)**(0.3404e1+0.83e0*log(0.5848488801e0*
     +   log(0.162591051e2*q)))/q
         s3 = 1/log(0.162591051e2*q)*log(1-x)*(x**(0.1724e1+0.157e0*
     +   log(0.5848488801e0*log(0.162591051e2*q)))*(0.7517e1-
     +   0.2547e1*log(0.5848488801e0*log(0.162591051e2*q))+(0.3409e2-
     +   0.5221e2*sqrt(log(0.5848488801e0*log(0.162591051e2*q)))+
     +   0.1747e2*log(0.5848488801e0*log(0.162591051e2*q)))*x+
     +   (0.4039e1+0.1491e1*log(0.5848488801e0*log(0.162591051e2*q)))
     +   *x**2)*log(1/x)**(0.8e0+0.1016e1*log(0.5848488801e0*
     +   log(0.162591051e2*q)))+log(0.5848488801e0*
     +   log(0.162591051e2*q))**0.1014e1*exp(0.1112e1-0.3438e1*
     +   log(0.5848488801e0*log(0.162591051e2*q))+0.302e0*
     +   log(0.5848488801e0*log(0.162591051e2*q))**2+sqrt((0.3256e1-
     +   0.436e0*log(0.5848488801e0*log(0.162591051e2*q)))*
     +   log(0.5848488801e0*log(0.162591051e2*q))**0.1738e1*log(1/x)
     +   )))
         s1 = s2*s3
         s3 = (1-x)**(0.3404e1+0.83e0*log(0.5848488801e0*
     +   log(0.162591051e2*q)))
         s6 = 0.157e0*x**(0.1724e1+0.157e0*log(0.5848488801e0*
     +   log(0.162591051e2*q)))/q/log(0.162591051e2*q)*log(x)*
     +   (0.7517e1-0.2547e1*log(0.5848488801e0*log(0.162591051e2*q))+
     +   (0.3409e2-0.5221e2*sqrt(log(0.5848488801e0*
     +   log(0.162591051e2*q)))+0.1747e2*log(0.5848488801e0*
     +   log(0.162591051e2*q)))*x+(0.4039e1+0.1491e1*
     +   log(0.5848488801e0*log(0.162591051e2*q)))*x**2)*log(1/x)**
     +   (0.8e0+0.1016e1*log(0.5848488801e0*log(0.162591051e2*q)))
         s7 = x**(0.1724e1+0.157e0*log(0.5848488801e0*
     +   log(0.162591051e2*q)))*(-0.2547e1/q/log(0.162591051e2*q)+(-
     +   0.26105e2/sqrt(log(0.5848488801e0*log(0.162591051e2*q)))/q/
     +   log(0.162591051e2*q)+0.1747e2/q/log(0.162591051e2*q))*x+
     +   0.1491e1/q/log(0.162591051e2*q)*x**2)*log(1/x)**(0.8e0+
     +   0.1016e1*log(0.5848488801e0*log(0.162591051e2*q)))
         s5 = s6+s7
         s6 = s5+0.1016e1*x**(0.1724e1+0.157e0*log(0.5848488801e0*
     +   log(0.162591051e2*q)))*(0.7517e1-0.2547e1*
     +   log(0.5848488801e0*log(0.162591051e2*q))+(0.3409e2-0.5221e2*
     +   sqrt(log(0.5848488801e0*log(0.162591051e2*q)))+0.1747e2*
     +   log(0.5848488801e0*log(0.162591051e2*q)))*x+(0.4039e1+
     +   0.1491e1*log(0.5848488801e0*log(0.162591051e2*q)))*x**2)*
     +   log(1/x)**(0.8e0+0.1016e1*log(0.5848488801e0*
     +   log(0.162591051e2*q)))/q/log(0.162591051e2*q)*log(log(1/x)
     +   )
         s7 = s6
         s9 = 0.1014e1*log(0.5848488801e0*log(0.162591051e2*q))**
     +   0.14e-1*exp(0.1112e1-0.3438e1*log(0.5848488801e0*
     +   log(0.162591051e2*q))+0.302e0*log(0.5848488801e0*
     +   log(0.162591051e2*q))**2+sqrt((0.3256e1-0.436e0*
     +   log(0.5848488801e0*log(0.162591051e2*q)))*
     +   log(0.5848488801e0*log(0.162591051e2*q))**0.1738e1*log(1/x)
     +   ))/q/log(0.162591051e2*q)
         s11 = log(0.5848488801e0*log(0.162591051e2*q))**0.1014e1
         s13 = -0.3438e1/q/log(0.162591051e2*q)+0.604e0*
     +   log(0.5848488801e0*log(0.162591051e2*q))/q/
     +   log(0.162591051e2*q)+1/sqrt((0.3256e1-0.436e0*
     +   log(0.5848488801e0*log(0.162591051e2*q)))*
     +   log(0.5848488801e0*log(0.162591051e2*q))**0.1738e1*log(1/x)
     +   )*(-0.436e0/q/log(0.162591051e2*q)*log(0.5848488801e0*
     +   log(0.162591051e2*q))**0.1738e1*log(1/x)+0.1738e1*(0.3256e1-
     +   0.436e0*log(0.5848488801e0*log(0.162591051e2*q)))*
     +   log(0.5848488801e0*log(0.162591051e2*q))**0.738e0*log(1/x)/
     +   q/log(0.162591051e2*q))/2
         s14 = exp(0.1112e1-0.3438e1*log(0.5848488801e0*
     +   log(0.162591051e2*q))+0.302e0*log(0.5848488801e0*
     +   log(0.162591051e2*q))**2+sqrt((0.3256e1-0.436e0*
     +   log(0.5848488801e0*log(0.162591051e2*q)))*
     +   log(0.5848488801e0*log(0.162591051e2*q))**0.1738e1*log(1/x)
     +   ))
         s12 = s13*s14
         s10 = s11*s12
         s8 = s9+s10
         s4 = s7+s8
         s2 = s3*s4
         dgrv_nln = ((s1+s2))
	
      endif
      return
      end
*CMZ :  2.05/00 03/03/97  17.00.42  by  Hannes Jung
*-- Author :
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
*                                                                 *
*           G R S - LO - VIRTUAL PHOTON PARAMETRIZATIONS          *
*                                                                 *
*                 FOR A DETAILED EXPLANATION SEE                  *
*                M. GLUECK, E.REYA, M. STRATMANN :                *
*                    PHYS. REV. D51 (1995) 3220                   *
*                                                                 *
*   THE PARAMETRIZATIONS ARE FITTED TO THE EVOLVED PARTONS FOR    *
*        Q**2 / GEV**2  BETWEEN   0.6   AND  5.E4                 *
*                       AND (!)  Q**2 > 5 P**2                    *
*        P**2 / GEV**2  BETWEEN   0.0   AND  10.                  *
*                       P**2 = 0  <=> REAL PHOTON                 *
*             X         BETWEEN  1.E-4  AND   1.                  *
*                                                                 *
*   HEAVY QUARK THRESHOLDS  Q(H) = M(H)  IN THE BETA FUNCTION :   *
*                   M(C)  =  1.5,  M(B)  =  4.5                   *
*   CORRESPONDING LAMBDA(F) VALUES IN GEV FOR  Q**2 > M(H)**2 :   *
*      LO :   LAMBDA(3)  =  0.232,   LAMBDA(4)  =  0.200,         *
*             LAMBDA(5)  =  0.153,                                *
*   THE NUMBER OF ACTIVE QUARK FLAVOURS IS  NF = 3  EVERYWHERE    *
*   EXCEPT IN THE BETA FUNCTION, I.E. THE HEAVY QUARKS C,B,...    *
*   ARE NOT PRESENT AS PARTONS IN THE Q2-EVOLUTION.               *
*                                                                 *
*   PLEASE REPORT ANY STRANGE BEHAVIOUR TO :                      *
*          STRAT@HAL1.PHYSIK.UNI-DORTMUND.DE                      *
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
*
*...INPUT PARAMETERS :
*
*    X   = MOMENTUM FRACTION
*    Q2  = SCALE Q**2 IN GEV**2
*    P2  = VIRTUALITY OF THE PHOTON IN GEV**2
*
*...OUTPUT (ALWAYS X TIMES THE DISTRIBUTION DIVIDED BY ALPHA_EM) :
*
********************************************************
      subroutine grspar(x,q2,p2,ugam,dgam,sgam,ggam)
      implicit double precision (a-z)
      integer check
c
c     check limits :
c
      check=0
      if(x.lt.0.0001d0) check=1
      if((q2.lt.0.6d0).or.(q2.gt.50000.d0))  check=1
      if(q2.lt.5.d0*p2) check=1
c
c     calculate distributions
c
      if(check.eq.0) then
         call grscalc(x,q2,p2,ugam,dgam,sgam,ggam)
      else
         write(6,*) 'x/q2/p2 - limits exceeded',x,q2,p2
      endif
c
      return
      end

c
      subroutine grscalc(x,q2,p2,ugam,dgam,sgam,ggam)
      implicit double precision (a-z)
      dimension u1(40),ds1(40),g1(40)
      dimension ud2(20),s2(20),g2(20)
      dimension up0(20),dsp0(20),gp0(20)
      save u1,ds1,g1,ud2,s2,g2,up0,dsp0,gp0
c
      data u1/-0.139d0,0.783d0,0.132d0,0.087d0,0.003d0,-0.0134d0,
     #   0.009d0,-0.017d0,0.092d0,-0.516d0,-0.085d0,0.439d0,
     #   0.013d0,0.108d0,-0.019d0,-0.272d0,-0.167d0,0.138d0,
     #   0.076d0,0.026d0,-0.013d0,0.27d0,0.107d0,-0.097d0,0.04d0,
     #   0.064d0,0.011d0,0.002d0,0.057d0,-0.057d0,0.162d0,
     #   -0.172d0,0.124d0,-0.016d0,-0.065d0,0.044d0,-1.009d0,
     #   0.622d0,0.227d0,-0.184d0/
      data ds1/0.033d0,0.007d0,-0.0516d0,0.12d0,0.001d0,-0.013d0,
     #   0.018d0,-0.028d0,0.102d0,-0.595d0,-0.114d0,0.669d0,
     #   0.022d0,0.001d0,-0.003d0,-0.0583d0,-0.041d0,0.035d0,
     #   0.009d0,0.009d0,0.004d0,0.054d0,0.025d0,-0.02d0,
     #   0.007d0,0.021d0,0.01d0,0.004d0,-0.067d0,0.06d0,-0.148d0,
     #   0.13d0,0.032d0,-0.009d0,-0.06d0,0.036d0,-0.39d0,0.033d0,
     #   0.245d0,-0.171d0/
      data g1/0.025d0,0.d0,-0.018d0,0.112d0,-0.025d0,0.177d0,
     #   -0.022d0,0.024d0,0.001d0,-0.0104d0,0.d0,0.d0,-1.082d0,
     #   -1.666d0,0.d0,0.086d0,0.d0,0.053d0,0.005d0,-0.058d0,
     #   0.034d0,0.073d0,1.08d0,1.63d0,-0.0256d0,-0.088d0,0.d0,
     #   0.d0,-0.004d0,0.016d0,0.007d0,-0.012d0,0.01d0,-0.673d0,
     #   0.126d0,-0.167d0,0.032d0,-0.227d0,0.086d0,-0.159d0/
      data ud2/0.756d0,0.187d0,0.109d0,-0.163d0,0.002d0,0.004d0,
     #   0.054d0,-0.039d0,22.53d0,-21.02d0,5.608d0,0.332d0,
     #   -0.008d0,-0.021d0,0.381d0,0.572d0,4.774d0,1.436d0,
     #   -0.614d0,3.548d0/
      data s2/0.902d0,0.182d0,0.271d0,-0.346d0,0.017d0,-0.01d0,
     #   -0.011d0,0.0065d0,17.1d0,-13.29d0,6.519d0,0.031d0,
     #   -0.0176d0,0.003d0,1.243d0,0.804d0,4.709d0,1.499d0,
     #   -0.48d0,3.401d0/
      data g2/0.364d0,1.31d0,0.86d0,-0.254d0,0.611d0,0.008d0,
     #   -0.097d0,-2.412d0,-0.843d0,2.248d0,-0.201d0,1.33d0,
     #   0.572d0,0.44d0,1.233d0,0.009d0,0.954d0,1.862d0,3.791d0,
     #   -0.079d0/
      data up0/1.551d0,0.105d0,1.089d0,-0.172d0,3.822d0,-2.162d0,
     #   0.533d0,-0.467d0,-0.412d0,0.2d0,0.377d0,0.299d0,0.487d0,
     #   0.0766d0,0.119d0,0.063d0,7.605d0,0.234d0,-0.567d0,
     #   2.294d0/
      data dsp0/2.484d0,1.214d0,1.088d0,-0.1735d0,4.293d0,
     #   -2.802d0,0.5975d0,-0.1193d0,-0.0872d0,0.0418d0,0.128d0,
     #   0.0337d0,0.127d0,0.0135d0,0.14d0,0.0423d0,6.946d0,
     #   0.814d0,1.531d0,0.124d0/
      data gp0/1.682d0,1.1d0,0.5888d0,-0.4714d0,0.5362d0,0.0127d0,
     #   -2.438d0,0.03399d0,0.07825d0,0.05842d0,0.08393d0,2.348d0,
     #   -0.07182d0,1.084d0,0.3098d0,-0.07514d0,3.327d0,1.1d0,
     #   2.264d0,0.2675d0/
c
      mu2=0.25d0
      lam2=0.232d0*0.232d0
c
      if(p2.le.0.25d0) then
         s=log(log(q2/lam2)/log(mu2/lam2))
         lp1=0.d0
         lp2=0.d0
      else
         s=log(log(q2/lam2)/log(p2/lam2))
         lp1=log(p2/mu2)*log(p2/mu2)
         lp2=log(p2/mu2+log(p2/mu2))
      endif
c
      alp=up0(1)+lp1*u1(1)+lp2*u1(2)
      bet=up0(2)+lp1*u1(3)+lp2*u1(4)
      a=up0(3)+lp1*u1(5)+lp2*u1(6)+
     #  (up0(4)+lp1*u1(7)+lp2*u1(8))*s
      b=up0(5)+lp1*u1(9)+lp2*u1(10)+
     #  (up0(6)+lp1*u1(11)+lp2*u1(12))*s**0.5+
     #  (up0(7)+lp1*u1(13)+lp2*u1(14))*s**2
      gb=up0(8)+lp1*u1(15)+lp2*u1(16)+
     #  (up0(9)+lp1*u1(17)+lp2*u1(18))*s+
     #  (up0(10)+lp1*u1(19)+lp2*u1(20))*s**2
      ga=up0(11)+lp1*u1(21)+lp2*u1(22)+
     #  (up0(12)+lp1*u1(23)+lp2*u1(24))*s**0.5
      gc=up0(13)+lp1*u1(25)+lp2*u1(33)+
     #  (up0(14)+lp1*u1(26)+lp2*u1(34))*s
      gd=up0(15)+lp1*u1(27)+lp2*u1(35)+
     #  (up0(16)+lp1*u1(28)+lp2*u1(36))*s
      ge=up0(17)+lp1*u1(29)+lp2*u1(37)+
     #  (up0(18)+lp1*u1(30)+lp2*u1(38))*s
      gep=up0(19)+lp1*u1(31)+lp2*u1(39)+
     #  (up0(20)+lp1*u1(32)+lp2*u1(40))*s
      upart1=grsf2(x,s,alp,bet,a,b,ga,gb,gc,gd,ge,gep)
c
      alp=dsp0(1)+lp1*ds1(1)+lp2*ds1(2)
      bet=dsp0(2)+lp1*ds1(3)+lp2*ds1(4)
      a=dsp0(3)+lp1*ds1(5)+lp2*ds1(6)+
     #  (dsp0(4)+lp1*ds1(7)+lp2*ds1(8))*s
      b=dsp0(5)+lp1*ds1(9)+lp2*ds1(10)+
     #  (dsp0(6)+lp1*ds1(11)+lp2*ds1(12))*s**0.5+
     #  (dsp0(7)+lp1*ds1(13)+lp2*ds1(14))*s**2
      gb=dsp0(8)+lp1*ds1(15)+lp2*ds1(16)+
     #  (dsp0(9)+lp1*ds1(17)+lp2*ds1(18))*s+
     #  (dsp0(10)+lp1*ds1(19)+lp2*ds1(20))*s**2
      ga=dsp0(11)+lp1*ds1(21)+lp2*ds1(22)+
     #  (dsp0(12)+lp1*ds1(23)+lp2*ds1(24))*s
      gc=dsp0(13)+lp1*ds1(25)+lp2*ds1(33)+
     #  (dsp0(14)+lp1*ds1(26)+lp2*ds1(34))*s
      gd=dsp0(15)+lp1*ds1(27)+lp2*ds1(35)+
     #  (dsp0(16)+lp1*ds1(28)+lp2*ds1(36))*s
      ge=dsp0(17)+lp1*ds1(29)+lp2*ds1(37)+
     #  (dsp0(18)+lp1*ds1(30)+lp2*ds1(38))*s
      gep=dsp0(19)+lp1*ds1(31)+lp2*ds1(39)+
     #  (dsp0(20)+lp1*ds1(32)+lp2*ds1(40))*s
      dspart1=grsf2(x,s,alp,bet,a,b,ga,gb,gc,gd,ge,gep)
c
      alp=gp0(1)+lp1*g1(1)+lp2*g1(2)
      bet=gp0(2)+lp1*g1(3)+lp2*g1(4)
      a=gp0(3)+lp1*g1(5)+lp2*g1(6)+
     #  (gp0(4)+lp1*g1(7)+lp2*g1(8))*s**0.5
      b=gp0(5)+lp1*g1(9)+lp2*g1(10)+
     #  (gp0(6)+lp1*g1(11)+lp2*g1(12))*s**2
      gb=gp0(7)+lp1*g1(13)+lp2*g1(14)+
     #  (gp0(8)+lp1*g1(15)+lp2*g1(16))*s
      ga=gp0(9)+lp1*g1(17)+lp2*g1(18)+
     #  (gp0(10)+lp1*g1(19)+lp2*g1(20))*s**0.5+
     #  (gp0(11)+lp1*g1(21)+lp2*g1(22))*s**2
      gc=gp0(12)+lp1*g1(23)+lp2*g1(24)+
     #  (gp0(13)+lp1*g1(25)+lp2*g1(26))*s**2
      gd=gp0(14)+lp1*g1(27)+lp2*g1(28)+
     #  (gp0(15)+lp1*g1(29)+lp2*g1(30))*s+
     #  (gp0(16)+lp1*g1(31)+lp2*g1(32))*s**2
      ge=gp0(17)+lp1*g1(33)+lp2*g1(34)+
     #  (gp0(18)+lp1*g1(35)+lp2*g1(36))*s
      gep=gp0(19)+lp1*g1(37)+lp2*g1(38)+
     #  (gp0(20)+lp1*g1(39)+lp2*g1(40))*s
      gpart1=grsf2(x,s,alp,bet,a,b,ga,gb,gc,gd,ge,gep)
c
      s=log(log(q2/lam2)/log(mu2/lam2))
      suppr=1.d0/(1.d0+p2/0.59d0)**2
c
      alp=ud2(1)
      bet=ud2(2)
      a=ud2(3)+ud2(4)*s
      ga=ud2(5)+ud2(6)*s**0.5
      gc=ud2(7)+ud2(8)*s
      b=ud2(9)+ud2(10)*s+ud2(11)*s**2
      gb=ud2(12)+ud2(13)*s+ud2(14)*s**2
      gd=ud2(15)+ud2(16)*s
      ge=ud2(17)+ud2(18)*s
      gep=ud2(19)+ud2(20)*s
      udpart2=suppr*grsf1(x,s,alp,bet,a,b,ga,gb,gc,gd,ge,gep)
c
      alp=s2(1)
      bet=s2(2)
      a=s2(3)+s2(4)*s
      ga=s2(5)+s2(6)*s**0.5
      gc=s2(7)+s2(8)*s
      b=s2(9)+s2(10)*s+s2(11)*s**2
      gb=s2(12)+s2(13)*s+s2(14)*s**2
      gd=s2(15)+s2(16)*s
      ge=s2(17)+s2(18)*s
      gep=s2(19)+s2(20)*s
      spart2=suppr*grsf2(x,s,alp,bet,a,b,ga,gb,gc,gd,ge,gep)
c
      alp=g2(1)
      bet=g2(2)
      a=g2(3)+g2(4)*s**0.5
      b=g2(5)+g2(6)*s**2
      gb=g2(7)+g2(8)*s
      ga=g2(9)+g2(10)*s**0.5+g2(11)*s**2
      gc=g2(12)+g2(13)*s**2
      gd=g2(14)+g2(15)*s+g2(16)*s**2
      ge=g2(17)+g2(18)*s
      gep=g2(19)+g2(20)*s
      gpart2=suppr*grsf1(x,s,alp,bet,a,b,ga,gb,gc,gd,ge,gep)
c
      ugam=upart1+udpart2
      dgam=dspart1+udpart2
      sgam=dspart1+spart2
      ggam=gpart1+gpart2
c
      return
      end

c
      double precision function grsf1(x,s,alp,bet,a,b,ga,gb,gc,gd,
     #                                ge,gep)
      implicit double precision (a-z)
      grsf1=(x**a*(ga+gb*sqrt(x)+gc*x**b)+
     #      s**alp*exp(-ge+sqrt(gep*s**bet*log(1.d0/x))))*
     #      (1.d0-x)**gd
      return
      end

      double precision function grsf2(x,s,alp,bet,a,b,ga,gb,gc,gd,
     #                                ge,gep)
      implicit double precision (a-z)
      grsf2=(s*x**a*(ga+gb*sqrt(x)+gc*x**b)+
     #      s**alp*exp(-ge+sqrt(gep*s**bet*log(1.d0/x))))*
     #      (1.d0-x)**gd
      return
      end
*CMZ :  2.06/34 20/05/98  09.12.56  by  Hannes Jung
*CMZ :  2.06/30 18/03/98  13.30.04  by  Hannes Jung
*CMZ :  2.06/29 15/03/98  14.20.08  by  Hannes Jung
*CMZ :  2.06/19 19/11/97  10.41.40  by  Hannes Jung
*CMZ :  2.06/16 29/10/97  09.37.37  by  Hannes Jung
*CMZ :  2.06/15 22/10/97  17.43.35  by  Hannes Jung
*CMZ :  2.06/11 17/10/97  13.05.17  by  Hannes Jung
*CMZ :  2.06/02 22/08/97  03.04.20  by  Hannes Jung
*CMZ :  2.06/00 16/07/97  15.21.49  by  Hannes Jung
*CMZ :  2.05/21 26/06/97  17.47.14  by  Hannes Jung
*CMZ :  2.05/13 26/05/97  12.30.13  by  Hannes Jung
*CMZ :  2.05/09 06/05/97  18.38.07  by  Hannes Jung
*CMZ :  2.05/07 24/04/97  17.59.59  by  Hannes Jung
*CMZ :  2.05/06 23/04/97  06.59.50  by  Hannes Jung
*CMZ :  2.05/05 20/03/97  22.41.09  by  Hannes Jung
*CMZ :  2.05/00 05/03/97  08.10.05  by  Hannes Jung
*-- Author :    Hannes Jung   03/03/97
      SUBROUTINE RYSTGA(XS,SCAL,Q2S,XPG)
      REAL XS,SCAL,Q2S,XPG(-6:6)
      DOUBLE PRECISION X,Q2,P2,UGAM,DGAM,SGAM,GGAM
      DOUBLE PRECISION PP2
      DIMENSION XPDFGM(-6:6)
*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGSCQ2.
      DOUBLE PRECISION SCALQ2
	Integer ISET,IP2
      COMMON/RESGAM/ISET,IP2,SCALQ2
*KEND.
      DOUBLE PRECISION XXX,QQ,UPV,DNV,USEA,DSEA,STR,CHM,BOT,TOP,GLU,
     +VAL(20)
      CHARACTER*20 PARM(20)
      LOGICAL FIRST,PDFFIRST,TEST
      COMMON /W50516/PDFFIRST
      DATA NPDF/0/,UPV,DNV,SEA,STR,CHM,BOT,TOP,GLU/8*0.D0/
      DATA FIRST/.TRUE./
      DATA TEST/.FALSE./
c      DATA IGAMPDF/1/
      IGAMPDF=MSTP(56)
c IGAMPDF = 1  --> GRS - LO - VIRTUAL PHOTON PARAMETRIZATIONS
c IGAMPDF = 2  --> SaSgam version 2 - parton distributions of the photon
      X=DBLE(XS)
      Q2=DBLE(SCAL)
      P2=DBLE(Q2S)
      DO 10 I=-6,6
   10 XPG(I)=1.e-21
ccccc  10 XPG(I)=0.0

      IF(FIRST) THEN
         FIRST=.FALSE.
         write(6,*) ' parton densities in the photon '
         write(6,10000) SCALQ2
10000    FORMAT('  cut scale > ',F6.2,' Q2 ')
         IF(IGAMPDF.EQ.1) THEN
            write(6,*) ' GRS - LO - parametrisation'
         ELSEIF(IGAMPDF.EQ.2) THEN
            write(6,*) ' SaSgam version 2 (Schuler - Sjostrand) '
            write(6,*) ' ISET = ',ISET,' IPS = ',IP2
         ELSEIF(IGAMPDF.GT.1000) THEN
            write(6,*) ' PDFLIB used with ',IGAMPDF
            IF(OMEG2.GT.0D0) THEN
               write(6,*) ' virtual photon suppression a la Drees-'
     +         //'Godbole'
               write(6,*) ' L=(ln(scal+omega^2)/(Q^2+omega^2))/',
     +         '(ln(scal+omega^2)/omega^2)) '
               write(6,*) ' with omega**2 = ',OMEG2
            ENDIF
         ENDIF
      ENDIF
      IF(XS.GE.1.0) RETURN
c check that scale > gamma virtuality
      IF(Q2.LT.SCALQ2*1.0001*P2) RETURN
      IF(IGAMPDF.EQ.1) THEN
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
*                                                                 *
*           G R S - LO - VIRTUAL PHOTON PARAMETRIZATIONS          *
*                                                                 *
*                 FOR A DETAILED EXPLANATION SEE                  *
*                M. GLUECK, E.REYA, M. STRATMANN :                *
*                    PHYS. REV. D51 (1995) 3220                   *
*                                                                 *
*   THE PARAMETRIZATIONS ARE FITTED TO THE EVOLVED PARTONS FOR    *
*        Q**2 / GEV**2  BETWEEN   0.6   AND  5.E4                 *
*                       AND (!)  Q**2 > 5 P**2                    *
*        P**2 / GEV**2  BETWEEN   0.0   AND  10.                  *
*                       P**2 = 0  <=> REAL PHOTON                 *
*             X         BETWEEN  1.E-4  AND   1.                  *
*                                                                 *
*   HEAVY QUARK THRESHOLDS  Q(H) = M(H)  IN THE BETA FUNCTION :   *
*                   M(C)  =  1.5,  M(B)  =  4.5                   *
*   CORRESPONDING LAMBDA(F) VALUES IN GEV FOR  Q**2 > M(H)**2 :   *
*      LO :   LAMBDA(3)  =  0.232,   LAMBDA(4)  =  0.200,         *
*             LAMBDA(5)  =  0.153,                                *
*   THE NUMBER OF ACTIVE QUARK FLAVOURS IS  NF = 3  EVERYWHERE    *
*   EXCEPT IN THE BETA FUNCTION, I.E. THE HEAVY QUARKS C,B,...    *
*   ARE NOT PRESENT AS PARTONS IN THE Q2-EVOLUTION.               *
*                                                                 *
*   PLEASE REPORT ANY STRANGE BEHAVIOUR TO :                      *
*          STRAT@HAL1.PHYSIK.UNI-DORTMUND.DE                      *
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
*
*...INPUT PARAMETERS :
*
*    X   = MOMENTUM FRACTION
*    Q2  = SCALE Q**2 IN GEV**2
*    P2  = VIRTUALITY OF THE PHOTON IN GEV**2
*
*...OUTPUT (ALWAYS X TIMES THE DISTRIBUTION DIVIDED BY ALPHA_EM) :
*
********************************************************
         IF(Q2.GE.5D4) RETURN
         IF(Q2.LE.5.D0*P2.OR.P2.GT.10.D0) THEN

         ELSE
            call grspar(x,q2,p2,ugam,dgam,sgam,ggam)
            XPG(0)=SNGL(GGAM)/137.
            XPG(1)=SNGL(DGAM)/137.
            XPG(2)=SNGL(UGAM)/137.
            XPG(3)=SNGL(SGAM)/137.
            XPG(-1)=XPG(1)
            XPG(-2)=XPG(2)
            XPG(-3)=XPG(3)
            XPG(-4)=XPG(4)
            XPG(-5)=XPG(5)
            XPG(-6)=XPG(6)
            IF(TEST) THEN
               write(6,*) ' old GRS ',XPG(0),XPG(1)
               XXX=DBLE(XS)
               QQ=DBLE((MAX(0.,SCAL)))
C if you use PDFLIB version 3.  then uncoment the following 2 lines
C and comment the lines with 'cold pdf'
cold pdf  PARM(1)='MODE'
cold pdf  VAL(1)=MSTP(51)
C if you use PDFLIB 4.   then use the next lines.
CNEW
               ITEST = 3005004
               PARM(1) = 'NPTYPE'
               VAL(1) = INT(ITEST/1000000)
               PARM(2) = 'NGROUP'
               VAL(2) = DBLE(MOD(ITEST,1000000)/1000)
               PARM(3) = 'NSET'
               VAL(3) = DBLE(MOD(MOD(ITEST,1000000),1000))
CNEW
               NPDF=NPDF+1
               PDFFIRST=.FALSE.
               IF(NPDF.LE.1) PDFFIRST=.TRUE.
c call PDFSET each time, because when DIF with pi structure function is
c also selected one would get in confusion....
               CALL PDFSET(PARM,VAL)
cc         CALL STRUCTM(XXX,QQ,UPV,DNV,USEA,DSEA,STR,CHM,BOT,TOP,GLU)
c new calling sequence needed
               CALL STRUCTP(XXX,QQ,P2,IP2, UPV,DNV,USEA,DSEA,STR,CHM,
     +         BOT,TOP,GLU)
               Q2SUP = 1.D0
               XPG(0)=SNGL(GLU)*Q2SUP**2
               XPG(1)=SNGL(DSEA)*Q2SUP
               XPG(-1)=SNGL(DSEA)*Q2SUP
               XPG(2)=SNGL(USEA)*Q2SUP
               XPG(-2)=SNGL(USEA)*Q2SUP
               XPG(3)=SNGL(STR)*Q2SUP
               XPG(-3)=SNGL(STR)*Q2SUP
               XPG(4)=SNGL(CHM)*Q2SUP
               XPG(-4)=SNGL(CHM)*Q2SUP
               XPG(5)=SNGL(BOT)*Q2SUP
               XPG(-5)=SNGL(BOT)*Q2SUP
               XPG(6)=SNGL(TOP)*Q2SUP
               XPG(-6)=SNGL(TOP)*Q2SUP
               write(6,*) ' NEW GRS ',XPG(0),XPG(1)
            ENDIF
         ENDIF
      ELSEIF(IGAMPDF.EQ.2) THEN
         CALL SASGAM(ISET,XS,SCAL,Q2S,IP2,F2GM,XPDFGM)
C...The calling sequence is the following:
C     CALL SASGAM(ISET,X,Q2,P2,IP2,F2GM,XPDFGM)
C           IP2 : scheme used to evaluate off-shell anomalous component.
C               = 0 : recommended default, see = 7.
C               = 1 : dipole dampening by integration; very time-consuming.
C               = 2 : P_0^2 = max( Q_0^2, P^2 )
C               = 3 : P'_0^2 = Q_0^2 + P^2.
C               = 4 : P_{eff} that preserves momentum sum.
C               = 5 : P_{int} that preserves momentum and average
C                     evolution range.
C               = 6 : P_{eff}, matched to P_0 in P2 -> Q2 limit.
C               = 7 : P_{eff}, matched to P_0 in P2 -> Q2 limit.
C...The breakdown by component is stored in the commonblock SASCOM,
C               with elements as above.
C           XPVMD : rho, omega, phi VMD part only of output.
C           XPANL : d, u, s anomalous part only of output.
C           XPANH : c, b anomalous part only of output.
C           XPBEH : c, b Bethe-Heitler part only of output.
C           XPDIR : Cgamma (direct contribution) part only of output.
         DO 20 I=-6,6
   20    XPG(I)=XPDFGM(I)

      ELSEIF(IGAMPDF.GT.1000) THEN
C...Call PDFLIB structure functions.
         XXX=DBLE(XS)
         QQ=DBLE((MAX(0.,SCAL)))
         PARM(1) = 'NPTYPE'
         VAL(1) = INT(IGAMPDF/1000000)
         PARM(2) = 'NGROUP'
         VAL(2) = DBLE(MOD(IGAMPDF,1000000)/1000)
         PARM(3) = 'NSET'
         VAL(3) = DBLE(MOD(MOD(IGAMPDF,1000000),1000))
CNEW
c         call PDFSET each time, because when DIF with pi structure function is
c also selected one would get in confusion....
         NPDF=NPDF+1
         PDFFIRST=.FALSE.
         IF(NPDF.LE.1) PDFFIRST=.TRUE.
         CALL PDFSET(PARM,VAL)
c new calling sequence needed
c now here QQ is in GeV**2 and not as before in GeV
         IF(OMEG2.LT.0.D0) THEN
            Q2SUP = 1.D0
            PP2 = P2
         ELSE
            Q2SUP = SNGL(LOG((DBLE(SCAL)+OMEG2)/(P2+OMEG2))/ LOG((DBLE(
     +      SCAL)+OMEG2)/OMEG2))
            PP2 = 0.D0
         ENDIF
         CALL STRUCTP(XXX,QQ,PP2,IP2,
     +     UPV,DNV,USEA,DSEA,STR,CHM,BOT,TOP,GLU)
         XPG(0)=SNGL(GLU)*Q2SUP**2
         XPG(1)=SNGL(DSEA)*Q2SUP
         XPG(-1)=SNGL(DSEA)*Q2SUP
         XPG(2)=SNGL(USEA)*Q2SUP
         XPG(-2)=SNGL(USEA)*Q2SUP
         XPG(3)=SNGL(STR)*Q2SUP
         XPG(-3)=SNGL(STR)*Q2SUP
         XPG(4)=SNGL(CHM)*Q2SUP
         XPG(-4)=SNGL(CHM)*Q2SUP
         XPG(5)=SNGL(BOT)*Q2SUP
         XPG(-5)=SNGL(BOT)*Q2SUP
         XPG(6)=SNGL(TOP)*Q2SUP
         XPG(-6)=SNGL(TOP)*Q2SUP
      ELSE
         write(6,*) ' photon parametrisation not implemented ',IGAMPDF
      ENDIF
      RETURN
      END
*CMZ :  2.05/23 30/06/97  12.06.47  by  Hannes Jung
*CMZ :  2.05/06 22/04/97  21.05.41  by  Hannes Jung
*-- Author :    Hannes Jung   22/04/97

C...SaSgam version 2 - parton distributions of the photon
C...by Gerhard A. Schuler and Torbjorn Sjostrand
C...For further information see Z. Phys. C68 (1995) 607
C...and Phys. Lett. B376 (1996) 193.

C...18 January 1996: original code.
C...22 July 1996: calculation of BETA moved in SASBEH.

C!!!Note that one further call parameter - IP2 - has been added
C!!!to the SASGAM argument list compared with version 1.

C...The user should only need to call the SASGAM routine,
C...which in turn calls the auxiliary routines SASVMD, SASANO,
C...SASBEH and SASDIR. The package is self-contained.

C...One particular aspect of these parametrizations is that F2 for
C...the photon is not obtained just as the charge-squared-weighted
C...sum of quark distributions, but differ in the treatment of
C...heavy flavours (in F2 the DIS relation W2 = Q2*(1-x)/x restricts
C...the kinematics range of heavy-flavour production, but the same
C...kinematics is not relevant e.g. for jet production) and, for the
C...'MSbar' fits, in the addition of a Cgamma term related to the
C...separation of direct processes. Schematically:
C...PDF = VMD (rho, omega, phi) + anomalous (d, u, s, c, b).
C...F2  = VMD (rho, omega, phi) + anomalous (d, u, s) +
C...      Bethe-Heitler (c, b) (+ Cgamma (d, u, s)).
C...The J/psi and Upsilon states have not been included in the VMD sum,
C...but low c and b masses in the other components should compensate
C...for this in a duality sense.

C...The calling sequence is the following:
C     CALL SASGAM(ISET,X,Q2,P2,IP2,F2GM,XPDFGM)
C...with the following declaration statement:
C     DIMENSION XPDFGM(-6:6)
C...and, optionally, further information in:
C     COMMON/SASCOM/XPVMD(-6:6),XPANL(-6:6),XPANH(-6:6),XPBEH(-6:6),
C    &XPDIR(-6:6)
C     COMMON/SASVAL/VXPVMD(-6:6),VXPANL(-6:6),VXPANH(-6:6),VXPDGM(-6:6)
C...Input:  ISET = 1 : SaS set 1D ('DIS',   Q0 = 0.6 GeV)
C                = 2 : SaS set 1M ('MSbar', Q0 = 0.6 GeV)
C                = 3 : SaS set 2D ('DIS',   Q0 =  2  GeV)
C                = 4 : SaS set 2M ('MSbar', Q0 =  2  GeV)
C           X : x value.
C           Q2 : Q2 value.
C           P2 : P2 value; should be = 0. for an on-shell photon.
C           IP2 : scheme used to evaluate off-shell anomalous component.
C               = 0 : recommended default, see = 7.
C               = 1 : dipole dampening by integration; very time-consuming.
C               = 2 : P_0^2 = max( Q_0^2, P^2 )
C               = 3 : P'_0^2 = Q_0^2 + P^2.
C               = 4 : P_{eff} that preserves momentum sum.
C               = 5 : P_{int} that preserves momentum and average
C                     evolution range.
C               = 6 : P_{eff}, matched to P_0 in P2 -> Q2 limit.
C               = 7 : P_{eff}, matched to P_0 in P2 -> Q2 limit.
C...Output: F2GM : F2 value of the photon (including factors of alpha_em).
C           XPFDGM :  x times parton distribution functions of the photon,
C               with elements 0 = g, 1 = d, 2 = u, 3 = s, 4 = c, 5 = b,
C               6 = t (always empty!), - for antiquarks (result is same).
C...The breakdown by component is stored in the commonblock SASCOM,
C               with elements as above.
C           XPVMD : rho, omega, phi VMD part only of output.
C           XPANL : d, u, s anomalous part only of output.
C           XPANH : c, b anomalous part only of output.
C           XPBEH : c, b Bethe-Heitler part only of output.
C           XPDIR : Cgamma (direct contribution) part only of output.
C...The above arrays do not distinguish valence and sea contributions,
C...although this information is available internally. The additional
C...commonblock SASVAL provides the valence part only of the above
C...distributions. Array names VXPVMD, VXPANL and VXPANH correspond
C...to XPVMD, XPANL and XPANH, while XPBEH and XPDIR are valence only
C...and therefore not given doubly. VXPDGM gives the sum of valence
C...parts, and so matches XPDFGM. The difference, i.e. XPVMD-VXPVMD
C...and so on, gives the sea part only.

      SUBROUTINE SASGAM(ISET,X,Q2,P2,IP2,F2GM,XPDFGM)
C...Purpose: to construct the F2 and parton distributions of the photon
C...by summing homogeneous (VMD) and inhomogeneous (anomalous) terms.
C...For F2, c and b are included by the Bethe-Heitler formula;
C...in the 'MSbar' scheme additionally a Cgamma term is added.
      DIMENSION XPDFGM(-6:6)
      COMMON/SASCOM/XPVMD(-6:6),XPANL(-6:6),XPANH(-6:6),XPBEH(-6:6),
     +XPDIR(-6:6)
      COMMON/SASVAL/VXPVMD(-6:6),VXPANL(-6:6),VXPANH(-6:6),VXPDGM(-6:6)
      SAVE /SASCOM/,/SASVAL/

C...Temporary array.
      DIMENSION XPGA(-6:6), VXPGA(-6:6)
C...Charm and bottom masses (low to compensate for J/psi etc.).
      DATA PMC/1.3/, PMB/4.6/
C...alpha_em and alpha_em/(2*pi).
      DATA AEM/0.007297/, AEM2PI/0.0011614/
C...Lambda value for 4 flavours.
      DATA ALAM/0.20/
C...Mixture u/(u+d), = 0.5 for incoherent and = 0.8 for coherent sum.
      DATA FRACU/0.8/
C...VMD couplings f_V**2/(4*pi).
      DATA FRHO/2.20/, FOMEGA/23.6/, FPHI/18.4/
C...Masses for rho (=omega) and phi.
      DATA PMRHO/0.770/, PMPHI/1.020/
C...Number of points in integration for IP2=1.
      DATA NSTEP/100/

C...Reset output.
      F2GM=0.
      DO 10  KFL=-6,6
         XPDFGM(KFL)=0.
         XPVMD(KFL)=0.
         XPANL(KFL)=0.
         XPANH(KFL)=0.
         XPBEH(KFL)=0.
         XPDIR(KFL)=0.
         VXPVMD(KFL)=0.
         VXPANL(KFL)=0.
         VXPANH(KFL)=0.
         VXPDGM(KFL)=0.
   10 CONTINUE

C...Check that input sensible.
      IF(ISET.LE.0.OR.ISET.GE.5) THEN
         WRITE(*,*) ' FATAL ERROR: SaSgam called for unknown set'
         WRITE(*,*) ' ISET = ',ISET
         STOP
      ENDIF
      IF(X.LE.0..OR.X.GT.1.) THEN
         WRITE(*,*) ' FATAL ERROR: SaSgam called for unphysical x'
         WRITE(*,*) ' X = ',X
         STOP
      ENDIF

C...Set Q0 cut-off parameter as function of set used.
      IF(ISET.LE.2) THEN
         Q0=0.6
      ELSE
         Q0=2.
      ENDIF
      Q02=Q0**2

C...Scale choice for off-shell photon; common factors.
      Q2A=Q2
      FACNOR=1.
      IF(IP2.EQ.1) THEN
         P2MX=P2+Q02
         Q2A=Q2+P2*Q02/MAX(Q02,Q2)
         FACNOR=LOG(Q2/Q02)/NSTEP
      ELSEIF(IP2.EQ.2) THEN
         P2MX=MAX(P2,Q02)
      ELSEIF(IP2.EQ.3) THEN
         P2MX=P2+Q02
         Q2A=Q2+P2*Q02/MAX(Q02,Q2)
      ELSEIF(IP2.EQ.4) THEN
         P2MX=Q2*(Q02+P2)/(Q2+P2)*EXP(P2*(Q2-Q02)/ ((Q2+P2)*(Q02+P2)))
      ELSEIF(IP2.EQ.5) THEN
         P2MXA=Q2*(Q02+P2)/(Q2+P2)*EXP(P2*(Q2-Q02)/ ((Q2+P2)*(Q02+P2)))
         P2MX=Q0*SQRT(P2MXA)
         FACNOR=LOG(Q2/P2MXA)/LOG(Q2/P2MX)
      ELSEIF(IP2.EQ.6) THEN
         P2MX=Q2*(Q02+P2)/(Q2+P2)*EXP(P2*(Q2-Q02)/ ((Q2+P2)*(Q02+P2)))
         P2MX=MAX(0.,1.-P2/Q2)*P2MX+MIN(1.,P2/Q2)*MAX(P2,Q02)
      ELSE
         P2MXA=Q2*(Q02+P2)/(Q2+P2)*EXP(P2*(Q2-Q02)/ ((Q2+P2)*(Q02+P2)))
         P2MX=Q0*SQRT(P2MXA)
         P2MXB=P2MX
         P2MX=MAX(0.,1.-P2/Q2)*P2MX+MIN(1.,P2/Q2)*MAX(P2,Q02)
         P2MXB=MAX(0.,1.-P2/Q2)*P2MXB+MIN(1.,P2/Q2)*P2MXA
         FACNOR=LOG(Q2/P2MXA)/LOG(Q2/P2MXB)
      ENDIF

C...Call VMD parametrization for d quark and use to give rho, omega,
C...phi. Note dipole dampening for off-shell photon.
      CALL SASVMD(ISET,1,X,Q2A,P2MX,ALAM,XPGA,VXPGA)
      XFVAL=VXPGA(1)
      XPGA(1)=XPGA(2)
      XPGA(-1)=XPGA(-2)
      FACUD=AEM*(1./FRHO+1./FOMEGA)*(PMRHO**2/(PMRHO**2+P2))**2
      FACS=AEM*(1./FPHI)*(PMPHI**2/(PMPHI**2+P2))**2
      DO 20  KFL=-5,5
         XPVMD(KFL)=(FACUD+FACS)*XPGA(KFL)
   20 CONTINUE
      XPVMD(1)=XPVMD(1)+(1.-FRACU)*FACUD*XFVAL
      XPVMD(2)=XPVMD(2)+FRACU*FACUD*XFVAL
      XPVMD(3)=XPVMD(3)+FACS*XFVAL
      XPVMD(-1)=XPVMD(-1)+(1.-FRACU)*FACUD*XFVAL
      XPVMD(-2)=XPVMD(-2)+FRACU*FACUD*XFVAL
      XPVMD(-3)=XPVMD(-3)+FACS*XFVAL
      VXPVMD(1)=(1.-FRACU)*FACUD*XFVAL
      VXPVMD(2)=FRACU*FACUD*XFVAL
      VXPVMD(3)=FACS*XFVAL
      VXPVMD(-1)=(1.-FRACU)*FACUD*XFVAL
      VXPVMD(-2)=FRACU*FACUD*XFVAL
      VXPVMD(-3)=FACS*XFVAL

      IF(IP2.NE.1) THEN
C...Anomalous parametrizations for different strategies
C...for off-shell photons; except full integration.

C...Call anomalous parametrization for d + u + s.
         CALL SASANO(-3,X,Q2A,P2MX,ALAM,XPGA,VXPGA)
         DO 30  KFL=-5,5
            XPANL(KFL)=FACNOR*XPGA(KFL)
            VXPANL(KFL)=FACNOR*VXPGA(KFL)
   30    CONTINUE

C...Call anomalous parametrization for c and b.
         CALL SASANO(4,X,Q2A,P2MX,ALAM,XPGA,VXPGA)
         DO 40  KFL=-5,5
            XPANH(KFL)=FACNOR*XPGA(KFL)
            VXPANH(KFL)=FACNOR*VXPGA(KFL)
   40    CONTINUE
         CALL SASANO(5,X,Q2A,P2MX,ALAM,XPGA,VXPGA)
         DO 50  KFL=-5,5
            XPANH(KFL)=XPANH(KFL)+FACNOR*XPGA(KFL)
            VXPANH(KFL)=VXPANH(KFL)+FACNOR*VXPGA(KFL)
   50    CONTINUE

      ELSE
C...Special option: loop over flavours and integrate over k2.
         DO 80  KF=1,5
            DO 70  ISTEP=1,NSTEP
               Q2STEP=Q02*(Q2/Q02)**((ISTEP-0.5)/NSTEP)
               IF((KF.EQ.4.AND.Q2STEP.LT.PMC**2).OR. (KF.EQ.5.AND.Q2STE
     +         P.LT.PMB**2)) GOTO 70
               CALL SASVMD(0,KF,X,Q2,Q2STEP,ALAM,XPGA,VXPGA)
               FACQ=AEM2PI*(Q2STEP/(Q2STEP+P2))**2*FACNOR
               IF(MOD(KF,2).EQ.0) FACQ=FACQ*(8./9.)
               IF(MOD(KF,2).EQ.1) FACQ=FACQ*(2./9.)
               DO 60  KFL=-5,5
                  IF(KF.LE.3) XPANL(KFL)=XPANL(KFL)+FACQ*XPGA(KFL)
                  IF(KF.GE.4) XPANH(KFL)=XPANH(KFL)+FACQ*XPGA(KFL)
                  IF(KF.LE.3) VXPANL(KFL)=VXPANL(KFL)+FACQ*VXPGA(KFL)
                  IF(KF.GE.4) VXPANH(KFL)=VXPANH(KFL)+FACQ*VXPGA(KFL)
   60          CONTINUE
   70       CONTINUE
   80    CONTINUE
      ENDIF

C...Call Bethe-Heitler term expression for charm and bottom.
      CALL SASBEH(4,X,Q2,P2,PMC**2,XPBH)
      XPBEH(4)=XPBH
      XPBEH(-4)=XPBH
      CALL SASBEH(5,X,Q2,P2,PMB**2,XPBH)
      XPBEH(5)=XPBH
      XPBEH(-5)=XPBH

C...For MSbar subtraction call C^gamma term expression for d, u, s.
      IF(ISET.EQ.2.OR.ISET.EQ.4) THEN
         CALL SASDIR(X,Q2,P2,Q02,XPGA)
         DO 90  KFL=-5,5
            XPDIR(KFL)=XPGA(KFL)
   90    CONTINUE
      ENDIF

C...Store result in output array.
      DO 100 KFL=-5,5
         CHSQ=1./9.
         IF(IABS(KFL).EQ.2.OR.IABS(KFL).EQ.4) CHSQ=4./9.
         XPF2=XPVMD(KFL)+XPANL(KFL)+XPBEH(KFL)+XPDIR(KFL)
         IF(KFL.NE.0) F2GM=F2GM+CHSQ*XPF2
         XPDFGM(KFL)=XPVMD(KFL)+XPANL(KFL)+XPANH(KFL)
         VXPDGM(KFL)=VXPVMD(KFL)+VXPANL(KFL)+VXPANH(KFL)
  100 CONTINUE

      RETURN
      END

C*********************************************************************

      SUBROUTINE SASVMD(ISET,KF,X,Q2,P2,ALAM,XPGA,VXPGA)
C...Purpose: to evaluate the VMD parton distributions of a photon,
C...evolved homogeneously from an initial scale P2 to Q2.
C...Does not include dipole suppression factor.
C...ISET is parton distribution set, see above;
C...additionally ISET=0 is used for the evolution of an anomalous photon
C...which branched at a scale P2 and then evolved homogeneously to Q2.
C...ALAM is the 4-flavour Lambda, which is automatically converted
C...to 3- and 5-flavour equivalents as needed.
      DIMENSION XPGA(-6:6), VXPGA(-6:6)
      DATA PMC/1.3/, PMB/4.6/, AEM/0.007297/, AEM2PI/0.0011614/

C...Reset output.
      DO 10  KFL=-6,6
         XPGA(KFL)=0.
         VXPGA(KFL)=0.
   10 CONTINUE
      KFA=IABS(KF)

C...Calculate Lambda; protect against unphysical Q2 and P2 input.
      ALAM3=ALAM*(PMC/ALAM)**(2./27.)
      ALAM5=ALAM*(ALAM/PMB)**(2./23.)
      P2EFF=MAX(P2,1.2*ALAM3**2)
      IF(KFA.EQ.4) P2EFF=MAX(P2EFF,PMC**2)
      IF(KFA.EQ.5) P2EFF=MAX(P2EFF,PMB**2)
      Q2EFF=MAX(Q2,P2EFF)

C...Find number of flavours at lower and upper scale.
      NFP=4
      IF(P2EFF.LT.PMC**2) NFP=3
      IF(P2EFF.GT.PMB**2) NFP=5
      NFQ=4
      IF(Q2EFF.LT.PMC**2) NFQ=3
      IF(Q2EFF.GT.PMB**2) NFQ=5

C...Find s as sum of 3-, 4- and 5-flavour parts.
      S=0.
      IF(NFP.EQ.3) THEN
         Q2DIV=PMC**2
         IF(NFQ.EQ.3) Q2DIV=Q2EFF
         S=S+(6./27.)*LOG(LOG(Q2DIV/ALAM3**2)/LOG(P2EFF/ALAM3**2))
      ENDIF
      IF(NFP.LE.4.AND.NFQ.GE.4) THEN
         P2DIV=P2EFF
         IF(NFP.EQ.3) P2DIV=PMC**2
         Q2DIV=Q2EFF
         IF(NFQ.EQ.5) Q2DIV=PMB**2
         S=S+(6./25.)*LOG(LOG(Q2DIV/ALAM**2)/LOG(P2DIV/ALAM**2))
      ENDIF
      IF(NFQ.EQ.5) THEN
         P2DIV=PMB**2
         IF(NFP.EQ.5) P2DIV=P2EFF
         S=S+(6./23.)*LOG(LOG(Q2EFF/ALAM5**2)/LOG(P2DIV/ALAM5**2))
      ENDIF

C...Calculate frequent combinations of x and s.
      X1=1.-X
      XL=-LOG(X)
      S2=S**2
      S3=S**3
      S4=S**4

C...Evaluate homogeneous anomalous parton distributions below or
C...above threshold.
      IF(ISET.EQ.0) THEN
         IF(Q2.LE.P2.OR.(KFA.EQ.4.AND.Q2.LT.PMC**2).OR. (KFA.EQ.5.AND.Q
     +   2.LT.PMB**2)) THEN
            XVAL = X * 1.5 * (X**2+X1**2)
            XGLU = 0.
            XSEA = 0.
         ELSE
            XVAL = (1.5/(1.-0.197*S+4.33*S2)*X**2 + (1.5+2.10*S)/
     +      (1.+3.29*S)*X1**2 + 5.23*S/(1.+1.17*S+19.9*S3)*X*X1) *
     +      X**(1./(1.+1.5*S)) * (1.-X**2)**(2.667*S)
            XGLU = 4.*S/(1.+4.76*S+15.2*S2+29.3*S4) * X**(-2.03*S/(1.+
     +      2.44*S)) * (X1*XL)**(1.333*S) * ((4.*X**2+7.*X+4.)*X1/3. -
     +      2.*X*(1.+X)*XL)
            XSEA = S2/(1.+4.54*S+8.19*S2+8.05*S3) * X**(-1.54*S/(1.+
     +      1.29*S)) * X1**(2.667*S) * ((8.-73.*X+62.*X**2)*X1/9. +
     +      (3.-8.*X**2/3.)*X*XL + (2.*X-1.)*X*XL**2)
         ENDIF

C...Evaluate set 1D parton distributions below or above threshold.
      ELSEIF(ISET.EQ.1) THEN
         IF(Q2.LE.P2.OR.(KFA.EQ.4.AND.Q2.LT.PMC**2).OR. (KFA.EQ.5.AND.Q
     +   2.LT.PMB**2)) THEN
            XVAL = 1.294 * X**0.80 * X1**0.76
            XGLU = 1.273 * X**0.40 * X1**1.76
            XSEA = 0.100 * X1**3.76
         ELSE
            XVAL = 1.294/(1.+0.252*S+3.079*S2) * X**(0.80-0.13*S) *
     +      X1**(0.76+0.667*S) * XL**(2.*S)
            XGLU = 7.90*S/(1.+5.50*S) * EXP(-5.16*S) * X**(-1.90*S/(1.+
     +      3.60*S)) * X1**1.30 * XL**(0.50+3.*S) + 1.273 * EXP(-10.*S)
     +      * X**0.40 * X1**(1.76+3.*S)
            XSEA = (0.1-0.397*S2+1.121*S3)/(1.+5.61*S2+5.26*S3) *
     +      X**(-7.32*S2/(1.+10.3*S2)) * X1**((3.76+15.*S+12.*S2)/(1.+
     +      4.*S))
            XSEA0 = 0.100 * X1**3.76
         ENDIF

C...Evaluate set 1M parton distributions below or above threshold.
      ELSEIF(ISET.EQ.2) THEN
         IF(Q2.LE.P2.OR.(KFA.EQ.4.AND.Q2.LT.PMC**2).OR. (KFA.EQ.5.AND.Q
     +   2.LT.PMB**2)) THEN
            XVAL = 0.8477 * X**0.51 * X1**1.37
            XGLU = 3.42 * X**0.255 * X1**2.37
            XSEA = 0.
         ELSE
            XVAL = 0.8477/(1.+1.37*S+2.18*S2+3.73*S3) * X**(0.51+0.21*
     +      S) * X1**1.37 * XL**(2.667*S)
            XGLU = 24.*S/(1.+9.6*S+0.92*S2+14.34*S3) * EXP(-5.94*S) *
     +      X**((-0.013-1.80*S)/(1.+3.14*S)) * X1**(2.37+0.4*S) *
     +      XL**(0.32+3.6*S) + 3.42 * EXP(-12.*S) * X**0.255 * X1**
     +      (2.37+3.*S)
            XSEA = 0.842*S/(1.+21.3*S-33.2*S2+229.*S3) * X**((0.13-
     +      2.90*S)/(1.+5.44*S)) * X1**(3.45+0.5*S) * XL**(2.8*S)
            XSEA0 = 0.
         ENDIF

C...Evaluate set 2D parton distributions below or above threshold.
      ELSEIF(ISET.EQ.3) THEN
         IF(Q2.LE.P2.OR.(KFA.EQ.4.AND.Q2.LT.PMC**2).OR. (KFA.EQ.5.AND.Q
     +   2.LT.PMB**2)) THEN
            XVAL = X**0.46 * X1**0.64 + 0.76 * X
            XGLU = 1.925 * X1**2
            XSEA = 0.242 * X1**4
         ELSE
            XVAL = (1.+0.186*S)/(1.-0.209*S+1.495*S2) * X**(0.46+0.25*
     +      S) * X1**((0.64+0.14*S+5.*S2)/(1.+S)) * XL**(1.9*S) +
     +      (0.76+0.4*S) * X * X1**(2.667*S)
            XGLU = (1.925+5.55*S+147.*S2)/(1.-3.59*S+3.32*S2) * EXP(-
     +      18.67*S) * X**((-5.81*S-5.34*S2)/(1.+29.*S-4.26*S2))
     +      * X1**((2.-5.9*S)/(1.+1.7*S)) * XL**(9.3*S/(1.+1.7*S))
            XSEA = (0.242-0.252*S+1.19*S2)/(1.-0.607*S+21.95*S2) *
     +      X**(-12.1*S2/(1.+2.62*S+16.7*S2)) * X1**4 * XL**S
            XSEA0 = 0.242 * X1**4
         ENDIF

C...Evaluate set 2M parton distributions below or above threshold.
      ELSEIF(ISET.EQ.4) THEN
         IF(Q2.LE.P2.OR.(KFA.EQ.4.AND.Q2.LT.PMC**2).OR. (KFA.EQ.5.AND.Q
     +   2.LT.PMB**2)) THEN
            XVAL = 1.168 * X**0.50 * X1**2.60 + 0.965 * X
            XGLU = 1.808 * X1**2
            XSEA = 0.209 * X1**4
         ELSE
            XVAL = (1.168+1.771*S+29.35*S2) * EXP(-5.776*S) * X**((0.5+
     +      0.208*S)/(1.-0.794*S+1.516*S2)) * X1**((2.6+7.6*S)/(1.+5.*
     +      S)) * XL**(5.15*S/(1.+2.*S)) + (0.965+22.35*S)/(1.+18.4*S)
     +      * X * X1**(2.667*S)
            XGLU = (1.808+29.9*S)/(1.+26.4*S) * EXP(-5.28*S) * X**((-
     +      5.35*S-10.11*S2)/(1.+31.71*S)) * X1**((2.-7.3*S+4.*S2)/(1.+
     +      2.5*S)) * XL**(10.9*S/(1.+2.5*S))
            XSEA = (0.209+0.644*S2)/(1.+0.319*S+17.6*S2) * X**((-0.373*
     +      S-7.71*S2)/(1.+0.815*S+11.0*S2)) * X1**(4.+S) * XL**(0.45*
     +      S)
            XSEA0 = 0.209 * X1**4
         ENDIF
      ENDIF

C...Threshold factors for c and b sea.
      SLL=LOG(LOG(Q2EFF/ALAM**2)/LOG(P2EFF/ALAM**2))
      XCHM=0.
      IF(Q2.GT.PMC**2.AND.Q2.GT.1.001*P2EFF) THEN
         SCH=MAX(0.,LOG(LOG(PMC**2/ALAM**2)/LOG(P2EFF/ALAM**2)))
         IF(ISET.EQ.0) THEN
            XCHM=XSEA*(1.-(SCH/SLL)**2)
         ELSE
            XCHM=MAX(0.,XSEA-XSEA0*X1**(2.667*S))*(1.-SCH/SLL)
         ENDIF
      ENDIF
      XBOT=0.
      IF(Q2.GT.PMB**2.AND.Q2.GT.1.001*P2EFF) THEN
         SBT=MAX(0.,LOG(LOG(PMB**2/ALAM**2)/LOG(P2EFF/ALAM**2)))
         IF(ISET.EQ.0) THEN
            XBOT=XSEA*(1.-(SBT/SLL)**2)
         ELSE
            XBOT=MAX(0.,XSEA-XSEA0*X1**(2.667*S))*(1.-SBT/SLL)
         ENDIF
      ENDIF

C...Fill parton distributions.
      XPGA(0)=XGLU
      XPGA(1)=XSEA
      XPGA(2)=XSEA
      XPGA(3)=XSEA
      XPGA(4)=XCHM
      XPGA(5)=XBOT
      XPGA(KFA)=XPGA(KFA)+XVAL
      DO 20  KFL=1,5
         XPGA(-KFL)=XPGA(KFL)
   20 CONTINUE
      VXPGA(KFA)=XVAL
      VXPGA(-KFA)=XVAL

      RETURN
      END

C*********************************************************************

      SUBROUTINE SASANO(KF,X,Q2,P2,ALAM,XPGA,VXPGA)
C...Purpose: to evaluate the parton distributions of the anomalous
C...photon, inhomogeneously evolved from a scale P2 (where it vanishes)
C...to Q2.
C...KF=0 gives the sum over (up to) 5 flavours,
C...KF<0 limits to flavours up to abs(KF),
C...KF>0 is for flavour KF only.
C...ALAM is the 4-flavour Lambda, which is automatically converted
C...to 3- and 5-flavour equivalents as needed.
      DIMENSION XPGA(-6:6), VXPGA(-6:6), ALAMSQ(3:5)
      DATA PMC/1.3/, PMB/4.6/, AEM/0.007297/, AEM2PI/0.0011614/

C...Reset output.
      DO 10  KFL=-6,6
         XPGA(KFL)=0.
         VXPGA(KFL)=0.
   10 CONTINUE
      IF(Q2.LE.P2) RETURN
      KFA=IABS(KF)

C...Calculate Lambda; protect against unphysical Q2 and P2 input.
      ALAMSQ(3)=(ALAM*(PMC/ALAM)**(2./27.))**2
      ALAMSQ(4)=ALAM**2
      ALAMSQ(5)=(ALAM*(ALAM/PMB)**(2./23.))**2
      P2EFF=MAX(P2,1.2*ALAMSQ(3))
      IF(KF.EQ.4) P2EFF=MAX(P2EFF,PMC**2)
      IF(KF.EQ.5) P2EFF=MAX(P2EFF,PMB**2)
      Q2EFF=MAX(Q2,P2EFF)
      XL=-LOG(X)

C...Find number of flavours at lower and upper scale.
      NFP=4
      IF(P2EFF.LT.PMC**2) NFP=3
      IF(P2EFF.GT.PMB**2) NFP=5
      NFQ=4
      IF(Q2EFF.LT.PMC**2) NFQ=3
      IF(Q2EFF.GT.PMB**2) NFQ=5

C...Define range of flavour loop.
      IF(KF.EQ.0) THEN
         KFLMN=1
         KFLMX=5
      ELSEIF(KF.LT.0) THEN
         KFLMN=1
         KFLMX=KFA
      ELSE
         KFLMN=KFA
         KFLMX=KFA
      ENDIF

C...Loop over flavours the photon can branch into.
      DO 20  KFL=KFLMN,KFLMX

C...Light flavours: calculate t range and (approximate) s range.
         IF(KFL.LE.3.AND.(KFL.EQ.1.OR.KFL.EQ.KF)) THEN
            TDIFF=LOG(Q2EFF/P2EFF)
            S=(6./(33.-2.*NFQ))*LOG(LOG(Q2EFF/ALAMSQ(NFQ))/ LOG(P2EFF/
     +      ALAMSQ(NFQ)))
            IF(NFQ.GT.NFP) THEN
               Q2DIV=PMB**2
               IF(NFQ.EQ.4) Q2DIV=PMC**2
               SNFQ=(6./(33.-2.*NFQ))*LOG(LOG(Q2DIV/ALAMSQ(NFQ))/
     +         LOG(P2EFF/ALAMSQ(NFQ)))
               SNFP=(6./(33.-2.*(NFQ-1)))*LOG(LOG(Q2DIV/ALAMSQ(NFQ-1))/
     +         LOG(P2EFF/ALAMSQ(NFQ-1)))
               S=S+(LOG(Q2DIV/P2EFF)/LOG(Q2EFF/P2EFF))*(SNFP-SNFQ)
            ENDIF
            IF(NFQ.EQ.5.AND.NFP.EQ.3) THEN
               Q2DIV=PMC**2
               SNF4=(6./(33.-2.*4))*LOG(LOG(Q2DIV/ALAMSQ(4))/ LOG(P2EFF
     +         /ALAMSQ(4)))
               SNF3=(6./(33.-2.*3))*LOG(LOG(Q2DIV/ALAMSQ(3))/ LOG(P2EFF
     +         /ALAMSQ(3)))
               S=S+(LOG(Q2DIV/P2EFF)/LOG(Q2EFF/P2EFF))*(SNF3-SNF4)
            ENDIF

C...u and s quark do not need a separate treatment when d has been done.
         ELSEIF(KFL.EQ.2.OR.KFL.EQ.3) THEN

C...Charm: as above, but only include range above c threshold.
         ELSEIF(KFL.EQ.4) THEN
            IF(Q2.LE.PMC**2) GOTO 20
            P2EFF=MAX(P2EFF,PMC**2)
            Q2EFF=MAX(Q2EFF,P2EFF)
            TDIFF=LOG(Q2EFF/P2EFF)
            S=(6./(33.-2.*NFQ))*LOG(LOG(Q2EFF/ALAMSQ(NFQ))/ LOG(P2EFF/
     +      ALAMSQ(NFQ)))
            IF(NFQ.EQ.5.AND.NFP.EQ.4) THEN
               Q2DIV=PMB**2
               SNFQ=(6./(33.-2.*NFQ))*LOG(LOG(Q2DIV/ALAMSQ(NFQ))/
     +         LOG(P2EFF/ALAMSQ(NFQ)))
               SNFP=(6./(33.-2.*(NFQ-1)))*LOG(LOG(Q2DIV/ALAMSQ(NFQ-1))/
     +         LOG(P2EFF/ALAMSQ(NFQ-1)))
               S=S+(LOG(Q2DIV/P2EFF)/LOG(Q2EFF/P2EFF))*(SNFP-SNFQ)
            ENDIF

C...Bottom: as above, but only include range above b threshold.
         ELSEIF(KFL.EQ.5) THEN
            IF(Q2.LE.PMB**2) GOTO 20
            P2EFF=MAX(P2EFF,PMB**2)
            Q2EFF=MAX(Q2,P2EFF)
            TDIFF=LOG(Q2EFF/P2EFF)
            S=(6./(33.-2.*NFQ))*LOG(LOG(Q2EFF/ALAMSQ(NFQ))/ LOG(P2EFF/
     +      ALAMSQ(NFQ)))
         ENDIF

C...Evaluate flavour-dependent prefactor (charge^2 etc.).
         CHSQ=1./9.
         IF(KFL.EQ.2.OR.KFL.EQ.4) CHSQ=4./9.
         FAC=AEM2PI*2.*CHSQ*TDIFF

C...Evaluate parton distributions (normalized to unit momentum sum).
         IF(KFL.EQ.1.OR.KFL.EQ.4.OR.KFL.EQ.5.OR.KFL.EQ.KF) THEN
            XVAL= ((1.5+2.49*S+26.9*S**2)/(1.+32.3*S**2)*X**2 + (1.5-
     +      0.49*S+7.83*S**2)/(1.+7.68*S**2)*(1.-X)**2 + 1.5*S/(1.-3.2*
     +      S+7.*S**2)*X*(1.-X)) * X**(1./(1.+0.58*S)) * (1.-X**2)**
     +      (2.5*S/(1.+10.*S))
            XGLU= 2.*S/(1.+4.*S+7.*S**2) * X**(-1.67*S/(1.+2.*S)) *
     +      (1.-X**2)**(1.2*S) * ((4.*X**2+7.*X+4.)*(1.-X)/3. - 2.*X*
     +      (1.+X)*XL)
            XSEA= 0.333*S**2/(1.+4.90*S+4.69*S**2+21.4*S**3) * X**(-
     +      1.18*S/(1.+1.22*S)) * (1.-X)**(1.2*S) * ((8.-73.*X+62.*X**
     +      2)*(1.-X)/9. + (3.-8.*X**2/3.)*X*XL + (2.*X-1.)*X*XL**2)

C...Threshold factors for c and b sea.
            SLL=LOG(LOG(Q2EFF/ALAM**2)/LOG(P2EFF/ALAM**2))
            XCHM=0.
            IF(Q2.GT.PMC**2.AND.Q2.GT.1.001*P2EFF) THEN
               SCH=MAX(0.,LOG(LOG(PMC**2/ALAM**2)/LOG(P2EFF/ALAM**2)))
               XCHM=XSEA*(1.-(SCH/SLL)**3)
            ENDIF
            XBOT=0.
            IF(Q2.GT.PMB**2.AND.Q2.GT.1.001*P2EFF) THEN
               SBT=MAX(0.,LOG(LOG(PMB**2/ALAM**2)/LOG(P2EFF/ALAM**2)))
               XBOT=XSEA*(1.-(SBT/SLL)**3)
            ENDIF
         ENDIF

C...Add contribution of each valence flavour.
         XPGA(0)=XPGA(0)+FAC*XGLU
         XPGA(1)=XPGA(1)+FAC*XSEA
         XPGA(2)=XPGA(2)+FAC*XSEA
         XPGA(3)=XPGA(3)+FAC*XSEA
         XPGA(4)=XPGA(4)+FAC*XCHM
         XPGA(5)=XPGA(5)+FAC*XBOT
         XPGA(KFL)=XPGA(KFL)+FAC*XVAL
         VXPGA(KFL)=VXPGA(KFL)+FAC*XVAL
   20 CONTINUE
      DO 30  KFL=1,5
         XPGA(-KFL)=XPGA(KFL)
         VXPGA(-KFL)=VXPGA(KFL)
   30 CONTINUE

      RETURN
      END

C*********************************************************************

      SUBROUTINE SASBEH(KF,X,Q2,P2,PM2,XPBH)
C...Purpose: to evaluate the Bethe-Heitler cross section for
C...heavy flavour production.
      DATA AEM2PI/0.0011614/

C...Reset output.
      XPBH=0.
      SIGBH=0.

C...Check kinematics limits.
      IF(X.GE.Q2/(4.*PM2+Q2+P2)) RETURN
      W2=Q2*(1.-X)/X-P2
      BETA2=1.-4.*PM2/W2
      IF(BETA2.LT.1E-10) RETURN
      BETA=SQRT(BETA2)
      RMQ=4.*PM2/Q2

C...Simple case: P2 = 0.
      IF(P2.LT.1E-4) THEN
         IF(BETA.LT.0.99) THEN
            XBL=LOG((1.+BETA)/(1.-BETA))
         ELSE
            XBL=LOG((1.+BETA)**2*W2/(4.*PM2))
         ENDIF
         SIGBH=BETA*(8.*X*(1.-X)-1.-RMQ*X*(1.-X))+ XBL*(X**2+(1.-X)**2+
     +   RMQ*X*(1.-3.*X)-0.5*RMQ**2*X**2)

C...Complicated case: P2 > 0, based on approximation of
C...C.T. Hill and G.G. Ross, Nucl. Phys. B148 (1979) 373
      ELSE
         RPQ=1.-4.*X**2*P2/Q2
         IF(RPQ.GT.1E-10) THEN
            RPBE=SQRT(RPQ*BETA2)
            IF(RPBE.LT.0.99) THEN
               XBL=LOG((1.+RPBE)/(1.-RPBE))
               XBI=2.*RPBE/(1.-RPBE**2)
            ELSE
               RPBESN=4.*PM2/W2+(4.*X**2*P2/Q2)*BETA2
               XBL=LOG((1.+RPBE)**2/RPBESN)
               XBI=2.*RPBE/RPBESN
            ENDIF
            SIGBH=BETA*(6.*X*(1.-X)-1.)+ XBL*(X**2+(1.-X)**2+RMQ*X*(1.-
     +      3.*X)-0.5*RMQ**2*X**2)+ XBI*(2.*X/Q2)*(PM2*X*(2.-RMQ)-P2*X)
         ENDIF
      ENDIF

C...Multiply by charge-squared etc. to get parton distribution.
      CHSQ=1./9.
      IF(IABS(KF).EQ.2.OR.IABS(KF).EQ.4) CHSQ=4./9.
      XPBH=3.*CHSQ*AEM2PI*X*SIGBH

      RETURN
      END

C*********************************************************************

      SUBROUTINE SASDIR(X,Q2,P2,Q02,XPGA)
C...Purpose: to evaluate the direct contribution, i.e. the C^gamma term,
C...as needed in MSbar parametrizations.
      DIMENSION XPGA(-6:6)
      DATA PMC/1.3/, PMB/4.6/, AEM2PI/0.0011614/

C...Reset output.
      DO 10  KFL=-6,6
         XPGA(KFL)=0.
   10 CONTINUE

C...Evaluate common x-dependent expression.
      XTMP = (X**2+(1.-X)**2) * (-LOG(X)) - 1.
      CGAM = 3.*AEM2PI*X * (XTMP*(1.+P2/(P2+Q02)) + 6.*X*(1.-X))

C...d, u, s part by simple charge factor.
      XPGA(1)=(1./9.)*CGAM
      XPGA(2)=(4./9.)*CGAM
      XPGA(3)=(1./9.)*CGAM

C...Also fill for antiquarks.
      DO 20  KF=1,5
         XPGA(-KF)=XPGA(KF)
   20 CONTINUE

      RETURN
      END
*CMZ :  2.06/29 15/03/98  13.45.09  by  Hannes Jung
*CMZ :  2.06/17 12/08/97  20.38.58  by  Julian Phillips
*CMZ :  2.03/12 11/10/96  13.36.58  by  Hannes Jung
*CMZ :  2.03/08 13/09/96  20.13.30  by  Julian Phillips
*CMZ :  1.00/03 08/07/96  16.48.11  by  Julian Phillips
*-- Author :    Julian Phillips   08/07/96
      SUBROUTINE PION_INIT(NPTYPE,NGROUP,NSET)

C Initialise PDFlib for extraction of pion and creation of meson
      IMPLICIT REAL*8 (A-G,O-Z)
      CHARACTER*20 PARM(20)
      DOUBLE PRECISION VAL(20),NPTYPE,NGROUP,NSET
      LOGICAL FIRST
      LOGICAL PDFFIRST
      COMMON/W50516/PDFFIRST

      DATA FIRST/.TRUE./
      PDFFIRST = FIRST
C      INTEGER NPTYPE,NGROUP,NSET

C Initialise for Pion Structure Function
      PARM(1) = 'NPTYPE'
      VAL(1) = NPTYPE
      PARM(2) = 'NGROUP'
      VAL(2) = NGROUP
      PARM(3) = 'NSET'
      VAL(3) = NSET

C Inform User of Action
      IF(FIRST) THEN
         FIRST = .FALSE.
         WRITE(6,*)'Initilising for PION structure function'
         WRITE(6,*)PARM(1),VAL(1)
         WRITE(6,*)PARM(2),VAL(2)
         WRITE(6,*)PARM(3),VAL(3)
      ENDIF

      CALL PDFSET(PARM,VAL)

      RETURN
      END
*CMZ :  2.03/12 11/10/96  13.36.58  by  Hannes Jung
*CMZ :  2.03/08 18/09/96  19.03.02  by  Julian Phillips
*CMZ :  1.00/03 08/07/96  16.50.06  by  Julian Phillips
*-- Author :    Julian Phillips   08/07/96
C Construct PDFs for pion or other meson
      SUBROUTINE PION_XPQ(XX,Q2,XPQ)
      IMPLICIT REAL*8 (A-G,O-Z)
      DIMENSION XPQ(-6:6)
      DOUBLE PRECISION XX,QQ,UPV,DNV,SEA,STR,CHM,BOT,TOP,GLU

C PDFlib only contains data for the negative pion, so here the dval and
C uval are swapped to give a positive pion
*! ud isospin 0 meson
      ISF=2
C      ISF=1 ! pi+

      QQ = DSQRT(Q2)

C Initialise
      DO I=-6,6
         XPQ(I) = 0.D0
      ENDDO

      IF(XX.GE.1. .OR. XX.LE.0.) RETURN

      CALL STRUCTF(XX,QQ,UPV,DNV,SEA,STR,CHM,BOT,TOP,GLU)

C Positive Pion
      IF(ISF.EQ.1) THEN
*! Gluon
         XPQ(0)= GLU
*! D
         XPQ(1)= UPV+SEA
*! Dbar
         XPQ(-1)= SEA
*! U
         XPQ(2)= DNV+SEA
*! Ubar
         XPQ(-2)= SEA
*! S
         XPQ(3)= STR
*! Sbar
         XPQ(-3)= STR
*! C
         XPQ(4)= CHM
*! Cbar
         XPQ(-4)= CHM
*! B
         XPQ(5)= BOT
*! Bbar
         XPQ(-5)= BOT
*! T
         XPQ(6)= TOP
*! Tbar
         XPQ(-6)= TOP
      ELSEIF(ISF.EQ.2) THEN
C Flavour singlet meson (f2)
         VAL = UPV/2.D0
*! Gluon
         XPQ(0)= GLU
*! D
         XPQ(1)= VAL+SEA
*! Dbar
         XPQ(-1)= VAL+SEA
*! U
         XPQ(2)= VAL+SEA
*! Ubar
         XPQ(-2)= VAL+SEA
*! S
         XPQ(3)= STR
*! Sbar
         XPQ(-3)= STR
*! C
         XPQ(4)= CHM
*! Cbar
         XPQ(-4)= CHM
*! B
         XPQ(5)= BOT
*! Bbar
         XPQ(-5)= BOT
*! T
         XPQ(6)= TOP
*! Tbar
         XPQ(-6)= TOP
      ENDIF

      RETURN
      END
*CMZ :  2.07/02 23/03/99  16.46.55  by  Hannes Jung
*CMZ :  2.07/01 11/02/99  18.53.12  by  Hannes Jung
*CMZ :  2.06/41 21/07/98  16.43.12  by  Hannes Jung
*CMZ :  2.06/34 18/05/98  22.50.06  by  Hannes Jung
*CMZ :  2.06/32 07/04/98  08.28.39  by  Hannes Jung
*CMZ :  2.06/29 15/03/98  13.45.09  by  Hannes Jung
*CMZ :  2.06/28 10/03/98  17.08.43  by  Hannes Jung
*CMZ :  2.06/24 14/01/98  19.40.49  by  Hannes Jung
*CMZ :  2.06/23 29/12/97  17.48.30  by  Hannes Jung
*CMZ :  2.06/18 07/11/97  15.57.13  by  Hannes Jung
*CMZ :  2.06/17 03/11/97  13.25.29  by  Julian Phillips
*CMZ :  2.05/25 04/07/97  12.23.37  by  Hannes Jung
*CMZ :  2.05/20 16/06/97  16.12.29  by  Hannes Jung
*CMZ :  2.03/12 11/10/96  13.36.58  by  Hannes Jung
*CMZ :  2.03/09 04/10/96  16.10.04  by  Julian Phillips
*CMZ :  2.03/08 02/10/96  21.26.02  by  Julian Phillips
*-- Author :    Julian Phillips   13/09/96
*###################################################################
* H1 QCD/Regge Fits
*
* Note on xpq: elements 0,1,2,3,4,5,6 are g,d,u,s,c,b,t
*              ie xpq(1)=d !
* Options
* -------
*
* NPOM = -10 H1 FINAL 1994 FIT (Flux Part)
* NG   = -10 H1 FINAL 1994 FIT (Fit 1, Quarks Only)
* NG   = -11 H1 FINAL 1994 FIT (Fit 2, Quarks + Flat Gluon)
* NG   = -12 H1 FINAL 1994 FIT (Fit 3, Quarks + Flat Gluon)
*####################################################################

      SUBROUTINE H1QCDFIT(BETA_IN,Q2_IN,XPQ,X_POM_IN,T2_IN)

      IMPLICIT REAL*8 (A-G,O-Z)
      REAL*4 T2_IN,X_POM_IN,BETA_IN,Q2_IN,XPQ(-6:6)
      DIMENSION XPQP(-6:6),XPQM(-6:6)
      LOGICAL FIRST
      INTEGER ICALL
      DATA ICALL/0/
      LOGICAL FLAG
      DATA FLAG/.FALSE./
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.

C Function for integral over t
      T_INT(A_TMIN,A_TMAX,B)=(-DEXP(-B*A_TMAX)/B) + (DEXP(-B*A_TMIN)/B)
      DATA FIRST/.TRUE./
      Icall = icall + 1
      if(icall.eq.1) then
         first=.true.
      else
         first=.false.
      endif
C      IF(FIRST) WRITE(6,*)'NPOM',NPOM
C Set Parameters for fits
      IF(NPOM.GT.-10) THEN
*! alpha_prime for the pomeron
         APPOM=0.0D0
*! b0 for pomeron
         B0POM=6.0D0
*! alpha_prime for the meson
         APMES=0.86D0
*! b0 for meson
         B0MES=1.4D0
      ELSEIF(NPOM.LE.-10 .AND. NPOM.GE.-12) THEN
         APPOM=0.26D0
         B0POM=4.6D0
         APMES=0.9D0
         B0MES=2.0D0
      ELSE
         WRITE(6,*)'H1QCDFIT: Unknown fit',NPOM
         STOP
      ENDIF

      IF(NPOM.LE.-10 .AND. NPOM.GE.-12) THEN
         CP=1.D0
*! Note: 2*alpha(0)-1 -> this is alpha(0)=1.20
         PP=1.40D0
*!  "        "             "   " alpha(0)=0.57
         PM=0.14D0
         IF(NG.EQ.-10) THEN
            CM=0.011816D0
         ELSEIF(NG.EQ.-11) THEN
            CM=0.0086814D0
         ELSEIF(NG.EQ.-12) THEN
            CM=0.00863D0
         ELSEIF(NG.EQ.-13) THEN
            CM=0.011816D0
         ELSEIF(NG.EQ.-14) THEN
            CM=0.0086814D0
         ELSEIF(NG.EQ.-15) THEN
            CM=0.00863D0
         ELSE
            WRITE(6,*)'H1QCDFIT - Unknown 1994 Final fit',ABS(NG)-9
            STOP
         ENDIF
      ENDIF

C Inform user of folly
      IF(FIRST) THEN
         WRITE(6,*)'#############################################'
         WRITE(6,*)'#           H1QCD fit Selected              #'
         WRITE(6,*)'#       for Q2 > 75  fix pdf at Q2 = 75     #'
         WRITE(6,*)'#       for Q2 < 4.5 fix pdf at Q2 = 4.5    #'
         WRITE(6,*)'#   for beta < 0.04  fix pdf at beta = 0.04 #'
         IF(NPOM.LE.-10 .AND. NPOM.GE.-12) THEN
            WRITE(6,*)'# Final 1994 Fits                           #'
            WRITE(6,*)'# FIT number in paper is ',ABS(NG)-9
            IF(NPOM.EQ.-10) WRITE(6,*)'# Pomeron Part Only'
            IF(NPOM.EQ.-11) WRITE(6,*)'# Meson Part Only'
            IF(NPOM.EQ.-12) WRITE(6,*)'# Pomeron + Meson'
         ELSE
            WRITE(6,*)'# NPOM=',NPOM,'not implemented              #'
            STOP
         ENDIF
         WRITE(6,*)'#############################################'
      ENDIF

C Input quantities are REAL*4 -> Convert to REAL*8
      BETA =DBLE(BETA_IN)
      if(BETA.LT.0.04) BETA = 0.04D0
      Q2   =DBLE(Q2_IN)
      if(Q2.GT.75d0) Q2=75.d0
      if(Q2.LT.4.5d0) Q2=4.5d0
      X_POM=DBLE(X_POM_IN)
      T2   =DBLE(T2_IN)
      IF(NPOM.NE.-3) THEN
C Initialise PDF Pion
         IF(NPOM.EQ.-10 .OR. NPOM.EQ.-11 .OR. NPOM.EQ.-12) THEN
*! LO-Owens Set 1
            CALL PION_INIT(2.D0,1.D0,1.D0)
         ENDIF
      ENDIF

C Final 1994 Fits from paper
      IF(NPOM.LE.-10 .AND. NPOM.GE.-12) THEN
         IF(FIRST) THEN
            IFIT=ABS(NG)-9
         ELSE
            IFIT=0
         ENDIF
         CALL QCD_1994(BETA,Q2,XPQP,IFIT)
c use Q instead of Q2 for PDFLIB 6.4.98
ccc         CALL PFTOPDG( BETA,DSQRT(Q2),XPQM)
         CALL PFTOPDG( BETA,Q2,XPQM)
         XPR=0.003D0
         ATMIN = (0.93827231D0*XPR)**2/(1.D0-XPR)
         DP = T_INT(ATMIN,1.D0,B0POM+2.D0*APPOM*LOG(1.D0/XPR)) *XPR**(-
     +   PP)
         DM = T_INT(ATMIN,1.D0,B0MES+2.D0*APMES*LOG(1.D0/XPR)) *XPR**(-
     +   PM)
         FLUX_P = 0.D0
         FLUX_M = 0.D0
         CALL FLUXH1(X_POM,T2,APPOM,B0POM,CP,PP,FLUX_P)
         CALL FLUXH1(X_POM,T2,APMES,B0MES,CM,PM,FLUX_M)
         FLUX_P = FLUX_P/(DP*XPR)
         FLUX_M = FLUX_M/(DM*XPR)
      ENDIF

      DO I=-6,6
         XPQ(I)=0.
         IF(ABS(I).LT.6) THEN
            IF(NPOM.EQ.-10 .OR. NPOM.EQ.-3) THEN
               XPQ(I)=REAL(XPQP(I)*FLUX_P)
            ELSEIF(NPOM.EQ.-11 ) THEN
               XPQ(I)=REAL(XPQM(I)*FLUX_M)
            ELSEIF(NPOM.EQ.-12) THEN
               XPQ(I)=REAL(XPQM(I)*FLUX_M+XPQP(I)*FLUX_P)
            ENDIF
            IF(XPQ(I).LT.1E-10) XPQ(I)=0.
         ENDIF
         IF(FLAG) WRITE(6,*)'I,XPQ(I)',I,XPQ(I)
      ENDDO

      FIRST=.FALSE.

      RETURN
      END
*CMZ :  2.03/12 11/10/96  13.36.58  by  Hannes Jung
*CMZ :  2.03/08 13/09/96  21.15.58  by  Julian Phillips
*-- Author :    Julian Phillips   13/09/96
      SUBROUTINE FLUXH1(X_POM,T2,AP,B0,C,P,FLUX)
*#########################################################
* Generic flux template
*#########################################################
      IMPLICIT REAL*8 (A-G,O-Z)

      B = B0 + 2.D0*AP*LOG(1.D0/X_POM)

      BT=B*DABS(T2)
      IF(BT.GT.170D0) THEN
         FLUX=0.D0
      ELSE
         FLUX=C*(X_POM**(-P))*DEXP(-BT)
      ENDIF

      RETURN
      END
*CMZ :  2.06/39 16/07/98  11.40.09  by  Hannes Jung
*CMZ :  2.06/38 10/07/98  19.31.42  by  Hannes Jung
*CMZ :  2.06/20 26/11/97  09.43.14  by  Hannes Jung
*CMZ :  2.06/19 19/11/97  10.41.57  by  Hannes Jung
*CMZ :  2.06/17 12/08/97  20.27.32  by  Julian Phillips
*-- Author :
*-- Author :    Julian Phillips   05/08/97
*###########################################################
* Main routine for parameterisations of final H1 1994
* QCD fits to F2D(3)
*
*   Input:    zt=x_{i/IP}
*            q2t=photon virtuality
*           ifit=1,2,3 (NLO fits as in paper)
*           ifit=4,5,6 (LO fits)
*           Call with IFIT>0 to initialise the parameterisation,
*           then call with ifit=0 for subsequent access.
*
*   Output: xpq(-6:6): PDG style array of partons, 0=gluon
*
* Note that the parameterisations are leading order, and are
* only valid in the kinematic range
*         0.04<beta<1.0
*         4.5<Q2<75 GeV2
* THIS IS THE KINEMATIC RANGE IN WHICH RESULTS ARE AVAILABLE
* TO THE WORLD.
*###########################################################
* To aid H1 Monte Carlo production, I have extended the
* parameterisation to the largest kinematic range in
* which I have any faith whatsoever in the parameterisation:
*         0.01<beta<1.0
*         3.0<Q2<100 GeV2
* For values of Q^2 or beta outside the specified range,
* the parameterisation is taken from the nearest valid
* beta and/or q2 value.
*
* YOU SHOULD NOT EXPECT THE MONTE CARLO TO LOOK LIKE THE
* DATA IN THE REGION Q2<4.5 OR BETA<0.04 SO DON'T SAY
* I DIDN'T WARN YOU.
*
* The pion structure function used is just an unmodified
* one, but RAPGAP will generate events with as if the
* particle was neutral, but with more u and d quarks
* in the current jet than expected.
*
* J.P.Phillips, 5/8/97
*###########################################################
      SUBROUTINE QCD_1994(ZT1,Q2T1,XPQ,IFIT)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER IQ2,IZ,NQ2,NZ,IFIT
      PARAMETER (NQ2MAX=30,NZMAX=50)
      DIMENSION IPAR(3), XPQ(-6:6)
      DATA IPAR/1,4,0/
      DIMENSION UDS_GRD(NZMAX,NQ2MAX),C_GRD(NZMAX,NQ2MAX),
     +          G_GRD(NZMAX,NQ2MAX)
      COMMON /CPARAM/ UDS_GRD,C_GRD,G_GRD

C Initialise Parameterisation from data statements
      IF(IFIT.GT.0) THEN
         WRITE(6,*)'Initialising fit',IFIT
         IF(IFIT.EQ.1) CALL I_NLO_Q3G0
         IF(IFIT.EQ.2) CALL I_NLO_Q3G1
         IF(IFIT.EQ.3) CALL I_NLO_Q3G3
         IF(IFIT.EQ.4) CALL I_LO_Q3G0
         IF(IFIT.EQ.5) CALL I_LO_Q3G1
         IF(IFIT.EQ.6) CALL I_LO_Q3G3
      ENDIF

C Initialise xpq
      DO I=-6,6
         XPQ(I)=0.D0
      ENDDO
      ZT = ZT1
      Q2T = Q2T1
      IF(ZT.GT.0.99D0) THEN
c            WRITE(6,*)' QCD_94 zt,q2t ',ZT,Q2T
         ZT = 0.99D0
      ENDIF
      IF(Q2T.GT.99.9D0) THEN
c            WRITE(6,*)' QCD_94 zt,q2t ',ZT,Q2T
         Q2T = 99.9D0
      ENDIF

C Define grid
*! Q2min
      Q2L = 3.D0
*! Q2max
      Q2U = 99.99D0
*! beta_min
      ZL  = 0.01D0
*! beta_mid (end of log binning)
      ZM  = 0.50D0
*! beta_max
      ZU  = 0.9999D0
*! Points in Q2 grid
      NQ2 = 30
*! Points in log beta grid
      NZa = 25
*! Total points in grid
      NZ  = 50
      DQ2 = DLOG(Q2U/Q2L)/DFLOAT(NQ2-1)
      DZa = DLOG(ZM/ZL)/DFLOAT(NZa-1)
      DZb = (ZU-ZM)/DFLOAT(NZ-NZa)

C Check input parameters
      Q2T=MIN(Q2U-0.01D0,MAX(Q2L,Q2T))
      ZT =MIN(ZU,MAX(ZL,ZT))

C Lower Grid Point
      IQ2 = INT(DLOG(Q2T/Q2L)/DQ2)+1
      IZ  = INT(DLOG(MIN(ZT,ZM)/ZL)/DZa)+1
     +      + INT(MAX(0.D0,ZT-ZM)/DZb)

C Central and boundary z,Q2 points for interpolation
      DLQ2  = DLOG(Q2T)
      DLQ21 = DLOG(Q2L)+DFLOAT(IQ2-1)*DQ2
      DLQ22 = DLOG(Q2L)+DFLOAT(IQ2)*DQ2
      IF(IZ.LT.NZa) THEN
*! Logarithmic interpolation
         DLZ = DLOG(ZT)
         DLZ1 = DLOG(DEXP(DLOG(ZL)+DFLOAT(MIN(IZ,NZa)-1)*DZa) +
     +   DFLOAT(MAX(IZ-NZa,0))*DZb)
         DLZ2 = DLOG(DEXP(DLOG(ZL)+DFLOAT(MIN(IZ+1,NZa)-1)*DZa) +
     +   DFLOAT(MAX(IZ+1-NZa,0))*DZb)
      ELSE
*! Linear interpolation
         DLZ = ZT
         DLZ1 = DEXP(DLOG(ZL)+DFLOAT(MIN(IZ,NZa)-1)*DZa) +
     +   DFLOAT(MAX(IZ-NZa,0))*DZb
         DLZ2 = DEXP(DLOG(ZL)+DFLOAT(MIN(IZ+1,NZa)-1)*DZa) +
     +   DFLOAT(MAX(IZ+1-NZa,0))*DZb
      ENDIF

C Light Flavour Singlet
      UDS11 = UDS_GRD(IZ,IQ2)
      UDS12 = UDS_GRD(IZ,IQ2+1)
      UDS21 = UDS_GRD(IZ+1,IQ2)
      UDS22 = UDS_GRD(IZ+1,IQ2+1)

C Charm
      C11 = C_GRD(IZ,IQ2)
      C12 = C_GRD(IZ,IQ2+1)
      C21 = C_GRD(IZ+1,IQ2)
      C22 = C_GRD(IZ+1,IQ2+1)

C Gluon
      G11 = G_GRD(IZ,IQ2)
      G12 = G_GRD(IZ,IQ2+1)
      G21 = G_GRD(IZ+1,IQ2)
      G22 = G_GRD(IZ+1,IQ2+1)

C Interpolate to parton distributions to ZT,Q2T
      UDS_T = XYINTER(DLZ1,DLZ2,DLQ21,DLQ22,DLZ,DLQ2,
     +     UDS11,UDS12,UDS21,UDS22)
      C_T = XYINTER(DLZ1,DLZ2,DLQ21,DLQ22,DLZ,DLQ2,
     +     C11,C12,C21,C22)
      G_T = XYINTER(DLZ1,DLZ2,DLQ21,DLQ22,DLZ,DLQ2,
     +     G11,G12,G21,G22)

C Fill XPQ array
      XPQ(-4) = C_T
      XPQ(-3) = UDS_T
      XPQ(-2) = UDS_T
      XPQ(-1) = UDS_T
      XPQ( 0) = G_T
      XPQ( 1) = UDS_T
      XPQ( 2) = UDS_T
      XPQ( 3) = UDS_T
      XPQ( 4) = C_T

C Check output
      DO I=-6,6
         IF(XPQ(I).LT.-0.1D-10) THEN
            WRITE(6,*)'Error in H1 fit parameterisation',XPQ(I)
            WRITE(6,*)' at zt,q2t ',ZT,Q2T
            STOP
         ENDIF
      ENDDO

      RETURN
      END
*CMZ :  2.06/29 15/03/98  20.29.59  by  Hannes Jung
*CMZ :  2.06/17 11/08/97  1400.2 71/6
*-- Author :
      SUBROUTINE I_LO_Q3G0
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NQ2MAX=30,NZMAX=50)
      DIMENSION UDS_GRD(NZMAX,NQ2MAX),C_GRD(NZMAX,NQ2MAX),
     &          G_GRD(NZMAX,NQ2MAX)
      DIMENSION UDS_GRDL(NZMAX,NQ2MAX),C_GRDL(NZMAX,NQ2MAX),
     &          G_GRDL(NZMAX,NQ2MAX)
      COMMON /CPARAM/ UDS_GRD,C_GRD,G_GRD
      data ((uds_grdl(i,j),j=1,30),i=1,10)/
     & 0.11851D-01, 0.11861D-01, 0.11877D-01, 0.11899D-01, 0.11925D-01,
     & 0.11956D-01, 0.11990D-01, 0.12029D-01, 0.12072D-01, 0.12118D-01,
     & 0.12169D-01, 0.12221D-01, 0.12277D-01, 0.12336D-01, 0.12398D-01,
     & 0.12463D-01, 0.12531D-01, 0.12600D-01, 0.12672D-01, 0.12746D-01,
     & 0.12822D-01, 0.12900D-01, 0.12980D-01, 0.13062D-01, 0.13146D-01,
     & 0.13231D-01, 0.13318D-01, 0.13406D-01, 0.13496D-01, 0.13587D-01,
     & 0.11907D-01, 0.11918D-01, 0.11935D-01, 0.11957D-01, 0.11984D-01,
     & 0.12015D-01, 0.12048D-01, 0.12087D-01, 0.12129D-01, 0.12174D-01,
     & 0.12223D-01, 0.12274D-01, 0.12328D-01, 0.12385D-01, 0.12445D-01,
     & 0.12507D-01, 0.12572D-01, 0.12639D-01, 0.12707D-01, 0.12778D-01,
     & 0.12851D-01, 0.12925D-01, 0.13002D-01, 0.13080D-01, 0.13159D-01,
     & 0.13240D-01, 0.13322D-01, 0.13406D-01, 0.13491D-01, 0.13577D-01,
     & 0.11974D-01, 0.11986D-01, 0.12004D-01, 0.12026D-01, 0.12053D-01,
     & 0.12084D-01, 0.12118D-01, 0.12155D-01, 0.12197D-01, 0.12241D-01,
     & 0.12289D-01, 0.12339D-01, 0.12391D-01, 0.12446D-01, 0.12504D-01,
     & 0.12564D-01, 0.12626D-01, 0.12690D-01, 0.12756D-01, 0.12823D-01,
     & 0.12893D-01, 0.12964D-01, 0.13036D-01, 0.13111D-01, 0.13186D-01,
     & 0.13263D-01, 0.13341D-01, 0.13420D-01, 0.13500D-01, 0.13582D-01,
     & 0.12054D-01, 0.12067D-01, 0.12086D-01, 0.12109D-01, 0.12136D-01,
     & 0.12167D-01, 0.12201D-01, 0.12238D-01, 0.12279D-01, 0.12323D-01,
     & 0.12369D-01, 0.12417D-01, 0.12468D-01, 0.12522D-01, 0.12578D-01,
     & 0.12635D-01, 0.12695D-01, 0.12757D-01, 0.12820D-01, 0.12884D-01,
     & 0.12951D-01, 0.13018D-01, 0.13088D-01, 0.13158D-01, 0.13230D-01,
     & 0.13303D-01, 0.13377D-01, 0.13452D-01, 0.13528D-01, 0.13604D-01,
     & 0.12146D-01, 0.12162D-01, 0.12182D-01, 0.12206D-01, 0.12233D-01,
     & 0.12264D-01, 0.12298D-01, 0.12335D-01, 0.12375D-01, 0.12418D-01,
     & 0.12463D-01, 0.12511D-01, 0.12560D-01, 0.12612D-01, 0.12666D-01,
     & 0.12722D-01, 0.12779D-01, 0.12838D-01, 0.12899D-01, 0.12961D-01,
     & 0.13024D-01, 0.13089D-01, 0.13155D-01, 0.13222D-01, 0.13290D-01,
     & 0.13359D-01, 0.13429D-01, 0.13500D-01, 0.13572D-01, 0.13645D-01,
     & 0.12255D-01, 0.12272D-01, 0.12293D-01, 0.12318D-01, 0.12346D-01,
     & 0.12377D-01, 0.12412D-01, 0.12448D-01, 0.12488D-01, 0.12530D-01,
     & 0.12575D-01, 0.12621D-01, 0.12670D-01, 0.12720D-01, 0.12772D-01,
     & 0.12826D-01, 0.12881D-01, 0.12938D-01, 0.12996D-01, 0.13055D-01,
     & 0.13116D-01, 0.13178D-01, 0.13241D-01, 0.13304D-01, 0.13369D-01,
     & 0.13435D-01, 0.13501D-01, 0.13568D-01, 0.13636D-01, 0.13705D-01,
     & 0.12382D-01, 0.12401D-01, 0.12423D-01, 0.12449D-01, 0.12478D-01,
     & 0.12510D-01, 0.12544D-01, 0.12581D-01, 0.12620D-01, 0.12662D-01,
     & 0.12706D-01, 0.12751D-01, 0.12799D-01, 0.12848D-01, 0.12898D-01,
     & 0.12950D-01, 0.13004D-01, 0.13058D-01, 0.13114D-01, 0.13171D-01,
     & 0.13229D-01, 0.13288D-01, 0.13348D-01, 0.13408D-01, 0.13470D-01,
     & 0.13532D-01, 0.13595D-01, 0.13659D-01, 0.13723D-01, 0.13787D-01,
     & 0.12532D-01, 0.12553D-01, 0.12577D-01, 0.12604D-01, 0.12633D-01,
     & 0.12666D-01, 0.12701D-01, 0.12738D-01, 0.12777D-01, 0.12818D-01,
     & 0.12861D-01, 0.12906D-01, 0.12952D-01, 0.13000D-01, 0.13049D-01,
     & 0.13100D-01, 0.13151D-01, 0.13204D-01, 0.13258D-01, 0.13312D-01,
     & 0.13368D-01, 0.13424D-01, 0.13481D-01, 0.13539D-01, 0.13597D-01,
     & 0.13656D-01, 0.13716D-01, 0.13776D-01, 0.13837D-01, 0.13898D-01,
     & 0.12710D-01, 0.12733D-01, 0.12758D-01, 0.12786D-01, 0.12817D-01,
     & 0.12850D-01, 0.12886D-01, 0.12923D-01, 0.12962D-01, 0.13003D-01,
     & 0.13046D-01, 0.13090D-01, 0.13135D-01, 0.13182D-01, 0.13230D-01,
     & 0.13278D-01, 0.13328D-01, 0.13379D-01, 0.13431D-01, 0.13483D-01,
     & 0.13537D-01, 0.13590D-01, 0.13645D-01, 0.13700D-01, 0.13755D-01,
     & 0.13812D-01, 0.13868D-01, 0.13925D-01, 0.13982D-01, 0.14040D-01,
     & 0.12917D-01, 0.12942D-01, 0.12969D-01, 0.12999D-01, 0.13031D-01,
     & 0.13065D-01, 0.13101D-01, 0.13139D-01, 0.13178D-01, 0.13219D-01,
     & 0.13261D-01, 0.13304D-01, 0.13349D-01, 0.13394D-01, 0.13441D-01,
     & 0.13488D-01, 0.13536D-01, 0.13586D-01, 0.13635D-01, 0.13686D-01,
     & 0.13737D-01, 0.13788D-01, 0.13840D-01, 0.13893D-01, 0.13945D-01,
     & 0.13999D-01, 0.14052D-01, 0.14106D-01, 0.14160D-01, 0.14214D-01/

      data ((uds_grdl(i,j),j=1,30),i=11,20)/
     & 0.13160D-01, 0.13187D-01, 0.13216D-01, 0.13247D-01, 0.13280D-01,
     & 0.13315D-01, 0.13352D-01, 0.13390D-01, 0.13429D-01, 0.13470D-01,
     & 0.13511D-01, 0.13554D-01, 0.13598D-01, 0.13643D-01, 0.13688D-01,
     & 0.13734D-01, 0.13781D-01, 0.13828D-01, 0.13876D-01, 0.13924D-01,
     & 0.13973D-01, 0.14022D-01, 0.14072D-01, 0.14122D-01, 0.14172D-01,
     & 0.14222D-01, 0.14273D-01, 0.14324D-01, 0.14374D-01, 0.14425D-01,
     & 0.13447D-01, 0.13476D-01, 0.13506D-01, 0.13539D-01, 0.13573D-01,
     & 0.13609D-01, 0.13646D-01, 0.13685D-01, 0.13724D-01, 0.13765D-01,
     & 0.13806D-01, 0.13848D-01, 0.13891D-01, 0.13935D-01, 0.13979D-01,
     & 0.14024D-01, 0.14069D-01, 0.14114D-01, 0.14161D-01, 0.14207D-01,
     & 0.14254D-01, 0.14301D-01, 0.14348D-01, 0.14395D-01, 0.14442D-01,
     & 0.14490D-01, 0.14538D-01, 0.14586D-01, 0.14633D-01, 0.14681D-01,
     & 0.13781D-01, 0.13812D-01, 0.13845D-01, 0.13879D-01, 0.13914D-01,
     & 0.13951D-01, 0.13988D-01, 0.14027D-01, 0.14066D-01, 0.14107D-01,
     & 0.14147D-01, 0.14189D-01, 0.14231D-01, 0.14274D-01, 0.14317D-01,
     & 0.14360D-01, 0.14404D-01, 0.14447D-01, 0.14492D-01, 0.14536D-01,
     & 0.14581D-01, 0.14625D-01, 0.14670D-01, 0.14714D-01, 0.14759D-01,
     & 0.14804D-01, 0.14849D-01, 0.14894D-01, 0.14938D-01, 0.14983D-01,
     & 0.14176D-01, 0.14209D-01, 0.14244D-01, 0.14279D-01, 0.14315D-01,
     & 0.14352D-01, 0.14390D-01, 0.14429D-01, 0.14468D-01, 0.14508D-01,
     & 0.14548D-01, 0.14589D-01, 0.14630D-01, 0.14671D-01, 0.14713D-01,
     & 0.14755D-01, 0.14796D-01, 0.14838D-01, 0.14881D-01, 0.14923D-01,
     & 0.14965D-01, 0.15007D-01, 0.15049D-01, 0.15091D-01, 0.15133D-01,
     & 0.15175D-01, 0.15217D-01, 0.15259D-01, 0.15300D-01, 0.15341D-01,
     & 0.14642D-01, 0.14676D-01, 0.14712D-01, 0.14748D-01, 0.14785D-01,
     & 0.14822D-01, 0.14860D-01, 0.14899D-01, 0.14938D-01, 0.14977D-01,
     & 0.15016D-01, 0.15055D-01, 0.15095D-01, 0.15135D-01, 0.15175D-01,
     & 0.15214D-01, 0.15254D-01, 0.15294D-01, 0.15334D-01, 0.15374D-01,
     & 0.15413D-01, 0.15453D-01, 0.15492D-01, 0.15531D-01, 0.15570D-01,
     & 0.15608D-01, 0.15647D-01, 0.15686D-01, 0.15724D-01, 0.15761D-01,
     & 0.15176D-01, 0.15212D-01, 0.15248D-01, 0.15284D-01, 0.15321D-01,
     & 0.15358D-01, 0.15396D-01, 0.15434D-01, 0.15471D-01, 0.15509D-01,
     & 0.15547D-01, 0.15585D-01, 0.15622D-01, 0.15660D-01, 0.15698D-01,
     & 0.15735D-01, 0.15772D-01, 0.15809D-01, 0.15846D-01, 0.15883D-01,
     & 0.15919D-01, 0.15955D-01, 0.15991D-01, 0.16027D-01, 0.16062D-01,
     & 0.16098D-01, 0.16133D-01, 0.16167D-01, 0.16201D-01, 0.16235D-01,
     & 0.15799D-01, 0.15835D-01, 0.15871D-01, 0.15907D-01, 0.15943D-01,
     & 0.15979D-01, 0.16015D-01, 0.16051D-01, 0.16087D-01, 0.16122D-01,
     & 0.16157D-01, 0.16193D-01, 0.16228D-01, 0.16263D-01, 0.16297D-01,
     & 0.16331D-01, 0.16365D-01, 0.16399D-01, 0.16432D-01, 0.16465D-01,
     & 0.16498D-01, 0.16530D-01, 0.16562D-01, 0.16593D-01, 0.16625D-01,
     & 0.16656D-01, 0.16686D-01, 0.16717D-01, 0.16746D-01, 0.16776D-01,
     & 0.16519D-01, 0.16553D-01, 0.16588D-01, 0.16622D-01, 0.16655D-01,
     & 0.16689D-01, 0.16722D-01, 0.16755D-01, 0.16788D-01, 0.16820D-01,
     & 0.16852D-01, 0.16884D-01, 0.16915D-01, 0.16946D-01, 0.16976D-01,
     & 0.17006D-01, 0.17035D-01, 0.17064D-01, 0.17093D-01, 0.17121D-01,
     & 0.17149D-01, 0.17176D-01, 0.17203D-01, 0.17230D-01, 0.17256D-01,
     & 0.17282D-01, 0.17307D-01, 0.17332D-01, 0.17356D-01, 0.17380D-01,
     & 0.17344D-01, 0.17376D-01, 0.17407D-01, 0.17437D-01, 0.17467D-01,
     & 0.17496D-01, 0.17525D-01, 0.17553D-01, 0.17581D-01, 0.17608D-01,
     & 0.17635D-01, 0.17661D-01, 0.17686D-01, 0.17712D-01, 0.17736D-01,
     & 0.17760D-01, 0.17783D-01, 0.17806D-01, 0.17829D-01, 0.17851D-01,
     & 0.17873D-01, 0.17894D-01, 0.17914D-01, 0.17934D-01, 0.17954D-01,
     & 0.17973D-01, 0.17992D-01, 0.18010D-01, 0.18028D-01, 0.18045D-01,
     & 0.18282D-01, 0.18307D-01, 0.18332D-01, 0.18356D-01, 0.18379D-01,
     & 0.18401D-01, 0.18423D-01, 0.18444D-01, 0.18464D-01, 0.18484D-01,
     & 0.18503D-01, 0.18522D-01, 0.18539D-01, 0.18557D-01, 0.18573D-01,
     & 0.18589D-01, 0.18604D-01, 0.18619D-01, 0.18634D-01, 0.18648D-01,
     & 0.18661D-01, 0.18674D-01, 0.18686D-01, 0.18697D-01, 0.18709D-01,
     & 0.18720D-01, 0.18730D-01, 0.18740D-01, 0.18749D-01, 0.18758D-01/

      data ((uds_grdl(i,j),j=1,30),i=21,30)/
     & 0.19331D-01, 0.19346D-01, 0.19361D-01, 0.19375D-01, 0.19387D-01,
     & 0.19399D-01, 0.19411D-01, 0.19421D-01, 0.19431D-01, 0.19440D-01,
     & 0.19448D-01, 0.19456D-01, 0.19463D-01, 0.19469D-01, 0.19475D-01,
     & 0.19480D-01, 0.19484D-01, 0.19488D-01, 0.19491D-01, 0.19494D-01,
     & 0.19497D-01, 0.19499D-01, 0.19500D-01, 0.19501D-01, 0.19501D-01,
     & 0.19501D-01, 0.19501D-01, 0.19500D-01, 0.19499D-01, 0.19498D-01,
     & 0.20470D-01, 0.20470D-01, 0.20469D-01, 0.20468D-01, 0.20465D-01,
     & 0.20462D-01, 0.20458D-01, 0.20453D-01, 0.20447D-01, 0.20441D-01,
     & 0.20434D-01, 0.20426D-01, 0.20418D-01, 0.20409D-01, 0.20400D-01,
     & 0.20390D-01, 0.20380D-01, 0.20369D-01, 0.20358D-01, 0.20346D-01,
     & 0.20334D-01, 0.20322D-01, 0.20309D-01, 0.20296D-01, 0.20282D-01,
     & 0.20268D-01, 0.20254D-01, 0.20240D-01, 0.20225D-01, 0.20210D-01,
     & 0.21685D-01, 0.21663D-01, 0.21640D-01, 0.21616D-01, 0.21591D-01,
     & 0.21566D-01, 0.21540D-01, 0.21514D-01, 0.21487D-01, 0.21460D-01,
     & 0.21432D-01, 0.21404D-01, 0.21375D-01, 0.21346D-01, 0.21317D-01,
     & 0.21287D-01, 0.21257D-01, 0.21227D-01, 0.21197D-01, 0.21166D-01,
     & 0.21135D-01, 0.21104D-01, 0.21073D-01, 0.21042D-01, 0.21010D-01,
     & 0.20978D-01, 0.20947D-01, 0.20915D-01, 0.20883D-01, 0.20851D-01,
     & 0.22914D-01, 0.22860D-01, 0.22806D-01, 0.22751D-01, 0.22696D-01,
     & 0.22640D-01, 0.22585D-01, 0.22529D-01, 0.22474D-01, 0.22418D-01,
     & 0.22362D-01, 0.22306D-01, 0.22250D-01, 0.22195D-01, 0.22139D-01,
     & 0.22083D-01, 0.22028D-01, 0.21972D-01, 0.21917D-01, 0.21862D-01,
     & 0.21807D-01, 0.21752D-01, 0.21697D-01, 0.21643D-01, 0.21588D-01,
     & 0.21534D-01, 0.21480D-01, 0.21426D-01, 0.21373D-01, 0.21319D-01,
     & 0.24031D-01, 0.23932D-01, 0.23834D-01, 0.23736D-01, 0.23639D-01,
     & 0.23542D-01, 0.23446D-01, 0.23351D-01, 0.23257D-01, 0.23163D-01,
     & 0.23070D-01, 0.22978D-01, 0.22886D-01, 0.22795D-01, 0.22705D-01,
     & 0.22616D-01, 0.22527D-01, 0.22439D-01, 0.22352D-01, 0.22265D-01,
     & 0.22179D-01, 0.22094D-01, 0.22010D-01, 0.21926D-01, 0.21843D-01,
     & 0.21761D-01, 0.21679D-01, 0.21598D-01, 0.21518D-01, 0.21438D-01,
     & 0.24265D-01, 0.24153D-01, 0.24042D-01, 0.23932D-01, 0.23823D-01,
     & 0.23715D-01, 0.23607D-01, 0.23501D-01, 0.23395D-01, 0.23291D-01,
     & 0.23187D-01, 0.23084D-01, 0.22983D-01, 0.22882D-01, 0.22782D-01,
     & 0.22683D-01, 0.22585D-01, 0.22488D-01, 0.22392D-01, 0.22297D-01,
     & 0.22202D-01, 0.22109D-01, 0.22016D-01, 0.21925D-01, 0.21834D-01,
     & 0.21744D-01, 0.21654D-01, 0.21566D-01, 0.21478D-01, 0.21392D-01,
     & 0.24472D-01, 0.24347D-01, 0.24222D-01, 0.24099D-01, 0.23977D-01,
     & 0.23857D-01, 0.23737D-01, 0.23619D-01, 0.23502D-01, 0.23387D-01,
     & 0.23273D-01, 0.23159D-01, 0.23047D-01, 0.22936D-01, 0.22827D-01,
     & 0.22718D-01, 0.22611D-01, 0.22505D-01, 0.22399D-01, 0.22295D-01,
     & 0.22192D-01, 0.22090D-01, 0.21990D-01, 0.21890D-01, 0.21791D-01,
     & 0.21693D-01, 0.21596D-01, 0.21501D-01, 0.21406D-01, 0.21312D-01,
     & 0.24651D-01, 0.24512D-01, 0.24374D-01, 0.24237D-01, 0.24103D-01,
     & 0.23969D-01, 0.23838D-01, 0.23708D-01, 0.23579D-01, 0.23452D-01,
     & 0.23327D-01, 0.23203D-01, 0.23080D-01, 0.22959D-01, 0.22839D-01,
     & 0.22721D-01, 0.22604D-01, 0.22488D-01, 0.22374D-01, 0.22261D-01,
     & 0.22149D-01, 0.22039D-01, 0.21930D-01, 0.21822D-01, 0.21715D-01,
     & 0.21609D-01, 0.21505D-01, 0.21402D-01, 0.21300D-01, 0.21199D-01,
     & 0.24802D-01, 0.24647D-01, 0.24495D-01, 0.24345D-01, 0.24197D-01,
     & 0.24051D-01, 0.23906D-01, 0.23764D-01, 0.23624D-01, 0.23485D-01,
     & 0.23348D-01, 0.23213D-01, 0.23080D-01, 0.22948D-01, 0.22818D-01,
     & 0.22690D-01, 0.22564D-01, 0.22439D-01, 0.22315D-01, 0.22193D-01,
     & 0.22072D-01, 0.21953D-01, 0.21836D-01, 0.21720D-01, 0.21605D-01,
     & 0.21492D-01, 0.21379D-01, 0.21269D-01, 0.21159D-01, 0.21051D-01,
     & 0.24923D-01, 0.24754D-01, 0.24587D-01, 0.24422D-01, 0.24261D-01,
     & 0.24101D-01, 0.23944D-01, 0.23789D-01, 0.23636D-01, 0.23486D-01,
     & 0.23337D-01, 0.23191D-01, 0.23047D-01, 0.22904D-01, 0.22764D-01,
     & 0.22626D-01, 0.22489D-01, 0.22355D-01, 0.22222D-01, 0.22091D-01,
     & 0.21961D-01, 0.21834D-01, 0.21708D-01, 0.21583D-01, 0.21461D-01,
     & 0.21339D-01, 0.21219D-01, 0.21101D-01, 0.20984D-01, 0.20869D-01/

      data ((uds_grdl(i,j),j=1,30),i=31,40)/
     & 0.25014D-01, 0.24829D-01, 0.24647D-01, 0.24468D-01, 0.24292D-01,
     & 0.24119D-01, 0.23948D-01, 0.23781D-01, 0.23615D-01, 0.23453D-01,
     & 0.23293D-01, 0.23135D-01, 0.22979D-01, 0.22826D-01, 0.22675D-01,
     & 0.22527D-01, 0.22380D-01, 0.22236D-01, 0.22094D-01, 0.21953D-01,
     & 0.21815D-01, 0.21679D-01, 0.21544D-01, 0.21412D-01, 0.21281D-01,
     & 0.21152D-01, 0.21024D-01, 0.20899D-01, 0.20775D-01, 0.20652D-01,
     & 0.25075D-01, 0.24874D-01, 0.24676D-01, 0.24482D-01, 0.24292D-01,
     & 0.24104D-01, 0.23920D-01, 0.23739D-01, 0.23561D-01, 0.23386D-01,
     & 0.23213D-01, 0.23044D-01, 0.22877D-01, 0.22713D-01, 0.22551D-01,
     & 0.22392D-01, 0.22236D-01, 0.22082D-01, 0.21930D-01, 0.21780D-01,
     & 0.21633D-01, 0.21488D-01, 0.21345D-01, 0.21204D-01, 0.21065D-01,
     & 0.20928D-01, 0.20793D-01, 0.20660D-01, 0.20529D-01, 0.20399D-01,
     & 0.25105D-01, 0.24886D-01, 0.24673D-01, 0.24463D-01, 0.24258D-01,
     & 0.24056D-01, 0.23857D-01, 0.23663D-01, 0.23471D-01, 0.23284D-01,
     & 0.23099D-01, 0.22918D-01, 0.22739D-01, 0.22564D-01, 0.22391D-01,
     & 0.22222D-01, 0.22055D-01, 0.21891D-01, 0.21730D-01, 0.21571D-01,
     & 0.21414D-01, 0.21260D-01, 0.21109D-01, 0.20960D-01, 0.20813D-01,
     & 0.20668D-01, 0.20525D-01, 0.20385D-01, 0.20246D-01, 0.20110D-01,
     & 0.25103D-01, 0.24867D-01, 0.24637D-01, 0.24411D-01, 0.24190D-01,
     & 0.23973D-01, 0.23760D-01, 0.23551D-01, 0.23346D-01, 0.23146D-01,
     & 0.22949D-01, 0.22755D-01, 0.22565D-01, 0.22378D-01, 0.22194D-01,
     & 0.22014D-01, 0.21837D-01, 0.21663D-01, 0.21492D-01, 0.21324D-01,
     & 0.21158D-01, 0.20995D-01, 0.20835D-01, 0.20678D-01, 0.20523D-01,
     & 0.20370D-01, 0.20220D-01, 0.20072D-01, 0.19927D-01, 0.19783D-01,
     & 0.25069D-01, 0.24815D-01, 0.24568D-01, 0.24325D-01, 0.24088D-01,
     & 0.23856D-01, 0.23628D-01, 0.23405D-01, 0.23186D-01, 0.22972D-01,
     & 0.22762D-01, 0.22556D-01, 0.22354D-01, 0.22155D-01, 0.21961D-01,
     & 0.21770D-01, 0.21582D-01, 0.21398D-01, 0.21217D-01, 0.21039D-01,
     & 0.20864D-01, 0.20693D-01, 0.20524D-01, 0.20359D-01, 0.20196D-01,
     & 0.20035D-01, 0.19877D-01, 0.19722D-01, 0.19569D-01, 0.19419D-01,
     & 0.24996D-01, 0.24723D-01, 0.24457D-01, 0.24197D-01, 0.23944D-01,
     & 0.23695D-01, 0.23452D-01, 0.23214D-01, 0.22981D-01, 0.22753D-01,
     & 0.22530D-01, 0.22311D-01, 0.22096D-01, 0.21886D-01, 0.21680D-01,
     & 0.21478D-01, 0.21280D-01, 0.21086D-01, 0.20895D-01, 0.20707D-01,
     & 0.20523D-01, 0.20343D-01, 0.20166D-01, 0.19992D-01, 0.19821D-01,
     & 0.19652D-01, 0.19487D-01, 0.19325D-01, 0.19165D-01, 0.19008D-01,
     & 0.24890D-01, 0.24598D-01, 0.24313D-01, 0.24035D-01, 0.23764D-01,
     & 0.23499D-01, 0.23240D-01, 0.22986D-01, 0.22739D-01, 0.22497D-01,
     & 0.22260D-01, 0.22028D-01, 0.21801D-01, 0.21578D-01, 0.21361D-01,
     & 0.21148D-01, 0.20939D-01, 0.20734D-01, 0.20533D-01, 0.20336D-01,
     & 0.20143D-01, 0.19953D-01, 0.19767D-01, 0.19585D-01, 0.19406D-01,
     & 0.19230D-01, 0.19057D-01, 0.18887D-01, 0.18721D-01, 0.18557D-01,
     & 0.24748D-01, 0.24435D-01, 0.24130D-01, 0.23833D-01, 0.23544D-01,
     & 0.23262D-01, 0.22985D-01, 0.22716D-01, 0.22453D-01, 0.22197D-01,
     & 0.21946D-01, 0.21701D-01, 0.21460D-01, 0.21226D-01, 0.20996D-01,
     & 0.20772D-01, 0.20552D-01, 0.20337D-01, 0.20126D-01, 0.19919D-01,
     & 0.19716D-01, 0.19518D-01, 0.19324D-01, 0.19133D-01, 0.18946D-01,
     & 0.18762D-01, 0.18582D-01, 0.18405D-01, 0.18232D-01, 0.18062D-01,
     & 0.24566D-01, 0.24231D-01, 0.23905D-01, 0.23588D-01, 0.23279D-01,
     & 0.22979D-01, 0.22685D-01, 0.22399D-01, 0.22121D-01, 0.21849D-01,
     & 0.21584D-01, 0.21324D-01, 0.21071D-01, 0.20824D-01, 0.20582D-01,
     & 0.20346D-01, 0.20115D-01, 0.19889D-01, 0.19668D-01, 0.19451D-01,
     & 0.19240D-01, 0.19032D-01, 0.18829D-01, 0.18630D-01, 0.18436D-01,
     & 0.18244D-01, 0.18057D-01, 0.17873D-01, 0.17693D-01, 0.17516D-01,
     & 0.24340D-01, 0.23981D-01, 0.23633D-01, 0.23295D-01, 0.22966D-01,
     & 0.22647D-01, 0.22335D-01, 0.22032D-01, 0.21736D-01, 0.21449D-01,
     & 0.21169D-01, 0.20895D-01, 0.20628D-01, 0.20367D-01, 0.20113D-01,
     & 0.19865D-01, 0.19623D-01, 0.19386D-01, 0.19155D-01, 0.18928D-01,
     & 0.18707D-01, 0.18491D-01, 0.18279D-01, 0.18072D-01, 0.17869D-01,
     & 0.17670D-01, 0.17476D-01, 0.17285D-01, 0.17099D-01, 0.16916D-01/

      data ((uds_grdl(i,j),j=1,30),i=41,50)/
     & 0.24067D-01, 0.23682D-01, 0.23310D-01, 0.22949D-01, 0.22598D-01,
     & 0.22258D-01, 0.21927D-01, 0.21605D-01, 0.21293D-01, 0.20989D-01,
     & 0.20693D-01, 0.20404D-01, 0.20123D-01, 0.19849D-01, 0.19583D-01,
     & 0.19323D-01, 0.19069D-01, 0.18821D-01, 0.18579D-01, 0.18343D-01,
     & 0.18112D-01, 0.17887D-01, 0.17667D-01, 0.17452D-01, 0.17242D-01,
     & 0.17035D-01, 0.16834D-01, 0.16637D-01, 0.16444D-01, 0.16255D-01,
     & 0.23737D-01, 0.23326D-01, 0.22928D-01, 0.22542D-01, 0.22169D-01,
     & 0.21807D-01, 0.21455D-01, 0.21114D-01, 0.20783D-01, 0.20462D-01,
     & 0.20149D-01, 0.19845D-01, 0.19549D-01, 0.19262D-01, 0.18982D-01,
     & 0.18709D-01, 0.18444D-01, 0.18185D-01, 0.17932D-01, 0.17686D-01,
     & 0.17446D-01, 0.17211D-01, 0.16983D-01, 0.16760D-01, 0.16542D-01,
     & 0.16329D-01, 0.16120D-01, 0.15917D-01, 0.15718D-01, 0.15523D-01,
     & 0.23341D-01, 0.22899D-01, 0.22473D-01, 0.22061D-01, 0.21662D-01,
     & 0.21277D-01, 0.20903D-01, 0.20541D-01, 0.20191D-01, 0.19851D-01,
     & 0.19521D-01, 0.19201D-01, 0.18890D-01, 0.18588D-01, 0.18294D-01,
     & 0.18009D-01, 0.17731D-01, 0.17461D-01, 0.17198D-01, 0.16942D-01,
     & 0.16693D-01, 0.16450D-01, 0.16213D-01, 0.15982D-01, 0.15757D-01,
     & 0.15537D-01, 0.15322D-01, 0.15113D-01, 0.14909D-01, 0.14709D-01,
     & 0.22859D-01, 0.22384D-01, 0.21926D-01, 0.21484D-01, 0.21059D-01,
     & 0.20647D-01, 0.20250D-01, 0.19866D-01, 0.19494D-01, 0.19135D-01,
     & 0.18787D-01, 0.18449D-01, 0.18122D-01, 0.17805D-01, 0.17498D-01,
     & 0.17199D-01, 0.16910D-01, 0.16628D-01, 0.16354D-01, 0.16089D-01,
     & 0.15830D-01, 0.15578D-01, 0.15334D-01, 0.15096D-01, 0.14864D-01,
     & 0.14638D-01, 0.14417D-01, 0.14203D-01, 0.13994D-01, 0.13789D-01,
     & 0.22249D-01, 0.21735D-01, 0.21242D-01, 0.20768D-01, 0.20312D-01,
     & 0.19872D-01, 0.19449D-01, 0.19040D-01, 0.18647D-01, 0.18267D-01,
     & 0.17899D-01, 0.17545D-01, 0.17201D-01, 0.16869D-01, 0.16548D-01,
     & 0.16237D-01, 0.15935D-01, 0.15643D-01, 0.15360D-01, 0.15085D-01,
     & 0.14818D-01, 0.14559D-01, 0.14307D-01, 0.14063D-01, 0.13825D-01,
     & 0.13594D-01, 0.13370D-01, 0.13151D-01, 0.12938D-01, 0.12731D-01,
     & 0.21465D-01, 0.20905D-01, 0.20370D-01, 0.19858D-01, 0.19367D-01,
     & 0.18896D-01, 0.18445D-01, 0.18011D-01, 0.17595D-01, 0.17193D-01,
     & 0.16807D-01, 0.16435D-01, 0.16077D-01, 0.15731D-01, 0.15398D-01,
     & 0.15075D-01, 0.14763D-01, 0.14462D-01, 0.14171D-01, 0.13890D-01,
     & 0.13617D-01, 0.13352D-01, 0.13096D-01, 0.12848D-01, 0.12607D-01,
     & 0.12373D-01, 0.12147D-01, 0.11926D-01, 0.11712D-01, 0.11504D-01,
     & 0.20439D-01, 0.19848D-01, 0.19283D-01, 0.18743D-01, 0.18225D-01,
     & 0.17728D-01, 0.17251D-01, 0.16793D-01, 0.16354D-01, 0.15932D-01,
     & 0.15526D-01, 0.15135D-01, 0.14759D-01, 0.14397D-01, 0.14049D-01,
     & 0.13712D-01, 0.13388D-01, 0.13076D-01, 0.12774D-01, 0.12483D-01,
     & 0.12202D-01, 0.11930D-01, 0.11668D-01, 0.11413D-01, 0.11167D-01,
     & 0.10930D-01, 0.10700D-01, 0.10477D-01, 0.10261D-01, 0.10052D-01,
     & 0.19387D-01, 0.18634D-01, 0.17922D-01, 0.17251D-01, 0.16616D-01,
     & 0.16017D-01, 0.15455D-01, 0.14921D-01, 0.14413D-01, 0.13931D-01,
     & 0.13473D-01, 0.13039D-01, 0.12628D-01, 0.12235D-01, 0.11860D-01,
     & 0.11501D-01, 0.11158D-01, 0.10831D-01, 0.10521D-01, 0.10223D-01,
     & 0.99372D-02, 0.96628D-02, 0.93993D-02, 0.91462D-02, 0.89034D-02,
     & 0.86724D-02, 0.84499D-02, 0.82353D-02, 0.80285D-02, 0.78291D-02,
     & 0.13489D-01, 0.12851D-01, 0.12255D-01, 0.11696D-01, 0.11172D-01,
     & 0.10683D-01, 0.10230D-01, 0.98028D-02, 0.94000D-02, 0.90200D-02,
     & 0.86614D-02, 0.83266D-02, 0.80117D-02, 0.77128D-02, 0.74290D-02,
     & 0.71595D-02, 0.69036D-02, 0.66617D-02, 0.64347D-02, 0.62179D-02,
     & 0.60109D-02, 0.58132D-02, 0.56244D-02, 0.54441D-02, 0.52721D-02,
     & 0.51106D-02, 0.49557D-02, 0.48069D-02, 0.46641D-02, 0.45271D-02,
     & 0.86035D-03, 0.81571D-03, 0.77405D-03, 0.73516D-03, 0.69887D-03,
     & 0.66509D-03, 0.63404D-03, 0.60485D-03, 0.57739D-03, 0.55158D-03,
     & 0.52732D-03, 0.50478D-03, 0.48370D-03, 0.46373D-03, 0.44483D-03,
     & 0.42694D-03, 0.41000D-03, 0.39406D-03, 0.37919D-03, 0.36503D-03,
     & 0.35154D-03, 0.33869D-03, 0.32646D-03, 0.31480D-03, 0.30373D-03,
     & 0.29340D-03, 0.28351D-03, 0.27404D-03, 0.26498D-03, 0.25629D-03/

      data ((g_grdl(i,j),j=1,30),i=1,10)/
     & 0.10003D-07, 0.48421D-02, 0.97179D-02, 0.14621D-01, 0.19547D-01,
     & 0.24491D-01, 0.29451D-01, 0.34419D-01, 0.39392D-01, 0.44367D-01,
     & 0.49342D-01, 0.54318D-01, 0.59291D-01, 0.64255D-01, 0.69207D-01,
     & 0.74148D-01, 0.79075D-01, 0.83990D-01, 0.88897D-01, 0.93783D-01,
     & 0.98650D-01, 0.10349D+00, 0.10832D+00, 0.11312D+00, 0.11790D+00,
     & 0.12267D+00, 0.12742D+00, 0.13214D+00, 0.13683D+00, 0.14149D+00,
     & 0.10002D-07, 0.46868D-02, 0.93934D-02, 0.14115D-01, 0.18848D-01,
     & 0.23588D-01, 0.28336D-01, 0.33083D-01, 0.37825D-01, 0.42561D-01,
     & 0.47288D-01, 0.52011D-01, 0.56725D-01, 0.61421D-01, 0.66100D-01,
     & 0.70761D-01, 0.75403D-01, 0.80028D-01, 0.84641D-01, 0.89229D-01,
     & 0.93792D-01, 0.98329D-01, 0.10284D+00, 0.10733D+00, 0.11179D+00,
     & 0.11624D+00, 0.12066D+00, 0.12505D+00, 0.12941D+00, 0.13375D+00,
     & 0.10002D-07, 0.45302D-02, 0.90674D-02, 0.13608D-01, 0.18148D-01,
     & 0.22687D-01, 0.27227D-01, 0.31756D-01, 0.36272D-01, 0.40773D-01,
     & 0.45259D-01, 0.49735D-01, 0.54195D-01, 0.58632D-01, 0.63046D-01,
     & 0.67436D-01, 0.71802D-01, 0.76148D-01, 0.80477D-01, 0.84778D-01,
     & 0.89049D-01, 0.93291D-01, 0.97505D-01, 0.10169D+00, 0.10585D+00,
     & 0.10999D+00, 0.11410D+00, 0.11818D+00, 0.12223D+00, 0.12624D+00,
     & 0.10003D-07, 0.43728D-02, 0.87407D-02, 0.13101D-01, 0.17452D-01,
     & 0.21792D-01, 0.26126D-01, 0.30441D-01, 0.34735D-01, 0.39007D-01,
     & 0.43258D-01, 0.47493D-01, 0.51708D-01, 0.55893D-01, 0.60051D-01,
     & 0.64180D-01, 0.68280D-01, 0.72356D-01, 0.76413D-01, 0.80437D-01,
     & 0.84429D-01, 0.88388D-01, 0.92316D-01, 0.96213D-01, 0.10008D+00,
     & 0.10393D+00, 0.10775D+00, 0.11153D+00, 0.11528D+00, 0.11899D+00,
     & 0.10003D-07, 0.42130D-02, 0.84102D-02, 0.12590D-01, 0.16751D-01,
     & 0.20893D-01, 0.25023D-01, 0.29126D-01, 0.33201D-01, 0.37249D-01,
     & 0.41268D-01, 0.45268D-01, 0.49242D-01, 0.53182D-01, 0.57089D-01,
     & 0.60964D-01, 0.64807D-01, 0.68622D-01, 0.72415D-01, 0.76172D-01,
     & 0.79893D-01, 0.83580D-01, 0.87233D-01, 0.90853D-01, 0.94441D-01,
     & 0.98011D-01, 0.10154D+00, 0.10504D+00, 0.10851D+00, 0.11194D+00,
     & 0.10003D-07, 0.40507D-02, 0.80757D-02, 0.12074D-01, 0.16046D-01,
     & 0.19991D-01, 0.23918D-01, 0.27811D-01, 0.31670D-01, 0.35496D-01,
     & 0.39289D-01, 0.43058D-01, 0.46796D-01, 0.50497D-01, 0.54161D-01,
     & 0.57789D-01, 0.61381D-01, 0.64943D-01, 0.68480D-01, 0.71979D-01,
     & 0.75440D-01, 0.78865D-01, 0.82253D-01, 0.85607D-01, 0.88927D-01,
     & 0.92228D-01, 0.95491D-01, 0.98718D-01, 0.10191D+00, 0.10507D+00,
     & 0.10002D-07, 0.38860D-02, 0.77373D-02, 0.11554D-01, 0.15336D-01,
     & 0.19085D-01, 0.22810D-01, 0.26496D-01, 0.30142D-01, 0.33750D-01,
     & 0.37320D-01, 0.40862D-01, 0.44370D-01, 0.47837D-01, 0.51264D-01,
     & 0.54652D-01, 0.58002D-01, 0.61319D-01, 0.64609D-01, 0.67858D-01,
     & 0.71068D-01, 0.74240D-01, 0.77374D-01, 0.80473D-01, 0.83536D-01,
     & 0.86579D-01, 0.89584D-01, 0.92551D-01, 0.95483D-01, 0.98379D-01,
     & 0.10001D-07, 0.37195D-02, 0.73961D-02, 0.11031D-01, 0.14624D-01,
     & 0.18179D-01, 0.21705D-01, 0.25185D-01, 0.28622D-01, 0.32016D-01,
     & 0.35369D-01, 0.38690D-01, 0.41973D-01, 0.45213D-01, 0.48410D-01,
     & 0.51566D-01, 0.54682D-01, 0.57762D-01, 0.60814D-01, 0.63824D-01,
     & 0.66793D-01, 0.69722D-01, 0.72614D-01, 0.75468D-01, 0.78287D-01,
     & 0.81083D-01, 0.83841D-01, 0.86562D-01, 0.89247D-01, 0.91896D-01,
     & 0.10002D-07, 0.35513D-02, 0.70527D-02, 0.10506D-01, 0.13912D-01,
     & 0.17274D-01, 0.20602D-01, 0.23881D-01, 0.27112D-01, 0.30297D-01,
     & 0.33437D-01, 0.36543D-01, 0.39608D-01, 0.42628D-01, 0.45603D-01,
     & 0.48534D-01, 0.51424D-01, 0.54277D-01, 0.57099D-01, 0.59879D-01,
     & 0.62617D-01, 0.65315D-01, 0.67974D-01, 0.70596D-01, 0.73181D-01,
     & 0.75744D-01, 0.78268D-01, 0.80754D-01, 0.83205D-01, 0.85621D-01,
     & 0.10001D-07, 0.33798D-02, 0.67037D-02, 0.99737D-02, 0.13192D-01,
     & 0.16361D-01, 0.19492D-01, 0.22571D-01, 0.25598D-01, 0.28577D-01,
     & 0.31508D-01, 0.34402D-01, 0.37253D-01, 0.40057D-01, 0.42814D-01,
     & 0.45528D-01, 0.48198D-01, 0.50830D-01, 0.53430D-01, 0.55987D-01,
     & 0.58502D-01, 0.60977D-01, 0.63413D-01, 0.65811D-01, 0.68173D-01,
     & 0.70511D-01, 0.72811D-01, 0.75074D-01, 0.77301D-01, 0.79494D-01/

      data ((g_grdl(i,j),j=1,30),i=11,20)/
     & 0.99996D-08, 0.32054D-02, 0.63496D-02, 0.94353D-02, 0.12465D-01,
     & 0.15442D-01, 0.18377D-01, 0.21257D-01, 0.24083D-01, 0.26858D-01,
     & 0.29583D-01, 0.32269D-01, 0.34911D-01, 0.37505D-01, 0.40051D-01,
     & 0.42552D-01, 0.45009D-01, 0.47427D-01, 0.49813D-01, 0.52155D-01,
     & 0.54455D-01, 0.56715D-01, 0.58936D-01, 0.61120D-01, 0.63268D-01,
     & 0.65391D-01, 0.67477D-01, 0.69527D-01, 0.71542D-01, 0.73523D-01,
     & 0.99991D-08, 0.30293D-02, 0.59932D-02, 0.88949D-02, 0.11737D-01,
     & 0.14524D-01, 0.17265D-01, 0.19949D-01, 0.22578D-01, 0.25154D-01,
     & 0.27679D-01, 0.30163D-01, 0.32601D-01, 0.34991D-01, 0.37333D-01,
     & 0.39629D-01, 0.41881D-01, 0.44095D-01, 0.46274D-01, 0.48411D-01,
     & 0.50506D-01, 0.52562D-01, 0.54579D-01, 0.56559D-01, 0.58505D-01,
     & 0.60424D-01, 0.62308D-01, 0.64156D-01, 0.65970D-01, 0.67752D-01,
     & 0.99973D-08, 0.28498D-02, 0.56310D-02, 0.83470D-02, 0.11001D-01,
     & 0.13597D-01, 0.16146D-01, 0.18635D-01, 0.21068D-01, 0.23448D-01,
     & 0.25775D-01, 0.28060D-01, 0.30300D-01, 0.32490D-01, 0.34633D-01,
     & 0.36730D-01, 0.38784D-01, 0.40798D-01, 0.42779D-01, 0.44717D-01,
     & 0.46615D-01, 0.48473D-01, 0.50295D-01, 0.52080D-01, 0.53831D-01,
     & 0.55556D-01, 0.57246D-01, 0.58903D-01, 0.60526D-01, 0.62119D-01,
     & 0.99985D-08, 0.26693D-02, 0.52677D-02, 0.77989D-02, 0.10266D-01,
     & 0.12674D-01, 0.15033D-01, 0.17331D-01, 0.19573D-01, 0.21761D-01,
     & 0.23896D-01, 0.25989D-01, 0.28035D-01, 0.30033D-01, 0.31984D-01,
     & 0.33890D-01, 0.35753D-01, 0.37577D-01, 0.39367D-01, 0.41116D-01,
     & 0.42826D-01, 0.44498D-01, 0.46134D-01, 0.47734D-01, 0.49302D-01,
     & 0.50843D-01, 0.52351D-01, 0.53827D-01, 0.55272D-01, 0.56686D-01,
     & 0.10003D-07, 0.24873D-02, 0.49022D-02, 0.72487D-02, 0.95305D-02,
     & 0.11752D-01, 0.13922D-01, 0.16033D-01, 0.18087D-01, 0.20087D-01,
     & 0.22035D-01, 0.23940D-01, 0.25799D-01, 0.27611D-01, 0.29376D-01,
     & 0.31098D-01, 0.32777D-01, 0.34419D-01, 0.36026D-01, 0.37594D-01,
     & 0.39124D-01, 0.40618D-01, 0.42077D-01, 0.43502D-01, 0.44895D-01,
     & 0.46263D-01, 0.47599D-01, 0.48904D-01, 0.50180D-01, 0.51427D-01,
     & 0.10001D-07, 0.23012D-02, 0.45296D-02, 0.66894D-02, 0.87842D-02,
     & 0.10819D-01, 0.12801D-01, 0.14724D-01, 0.16592D-01, 0.18406D-01,
     & 0.20171D-01, 0.21891D-01, 0.23566D-01, 0.25195D-01, 0.26780D-01,
     & 0.28322D-01, 0.29824D-01, 0.31288D-01, 0.32720D-01, 0.34113D-01,
     & 0.35471D-01, 0.36793D-01, 0.38083D-01, 0.39340D-01, 0.40568D-01,
     & 0.41770D-01, 0.42942D-01, 0.44086D-01, 0.45202D-01, 0.46291D-01,
     & 0.10001D-07, 0.21138D-02, 0.41554D-02, 0.61287D-02, 0.80379D-02,
     & 0.98871D-02, 0.11684D-01, 0.13423D-01, 0.15108D-01, 0.16742D-01,
     & 0.18326D-01, 0.19867D-01, 0.21365D-01, 0.22817D-01, 0.24228D-01,
     & 0.25598D-01, 0.26929D-01, 0.28224D-01, 0.29487D-01, 0.30714D-01,
     & 0.31907D-01, 0.33068D-01, 0.34197D-01, 0.35296D-01, 0.36366D-01,
     & 0.37413D-01, 0.38431D-01, 0.39423D-01, 0.40389D-01, 0.41330D-01,
     & 0.10001D-07, 0.19251D-02, 0.37792D-02, 0.55665D-02, 0.72910D-02,
     & 0.89569D-02, 0.10571D-01, 0.12129D-01, 0.13635D-01, 0.15091D-01,
     & 0.16501D-01, 0.17868D-01, 0.19193D-01, 0.20475D-01, 0.21718D-01,
     & 0.22922D-01, 0.24089D-01, 0.25223D-01, 0.26325D-01, 0.27394D-01,
     & 0.28431D-01, 0.29438D-01, 0.30415D-01, 0.31364D-01, 0.32287D-01,
     & 0.33187D-01, 0.34061D-01, 0.34910D-01, 0.35736D-01, 0.36539D-01,
     & 0.10002D-07, 0.17356D-02, 0.34024D-02, 0.50048D-02, 0.65463D-02,
     & 0.80312D-02, 0.94652D-02, 0.10846D-01, 0.12178D-01, 0.13461D-01,
     & 0.14701D-01, 0.15899D-01, 0.17058D-01, 0.18177D-01, 0.19258D-01,
     & 0.20304D-01, 0.21315D-01, 0.22294D-01, 0.23244D-01, 0.24163D-01,
     & 0.25052D-01, 0.25914D-01, 0.26748D-01, 0.27557D-01, 0.28342D-01,
     & 0.29104D-01, 0.29843D-01, 0.30559D-01, 0.31255D-01, 0.31929D-01,
     & 0.10003D-07, 0.15460D-02, 0.30263D-02, 0.44450D-02, 0.58059D-02,
     & 0.71126D-02, 0.83701D-02, 0.95780D-02, 0.10739D-01, 0.11856D-01,
     & 0.12930D-01, 0.13967D-01, 0.14965D-01, 0.15928D-01, 0.16855D-01,
     & 0.17749D-01, 0.18612D-01, 0.19445D-01, 0.20250D-01, 0.21027D-01,
     & 0.21777D-01, 0.22502D-01, 0.23203D-01, 0.23881D-01, 0.24536D-01,
     & 0.25170D-01, 0.25784D-01, 0.26378D-01, 0.26952D-01, 0.27508D-01/

      data ((g_grdl(i,j),j=1,30),i=21,30)/
     & 0.10004D-07, 0.13567D-02, 0.26517D-02, 0.38888D-02, 0.50717D-02,
     & 0.62036D-02, 0.72885D-02, 0.83276D-02, 0.93233D-02, 0.10278D-01,
     & 0.11194D-01, 0.12074D-01, 0.12920D-01, 0.13732D-01, 0.14512D-01,
     & 0.15263D-01, 0.15984D-01, 0.16679D-01, 0.17348D-01, 0.17992D-01,
     & 0.18612D-01, 0.19210D-01, 0.19785D-01, 0.20341D-01, 0.20876D-01,
     & 0.21392D-01, 0.21889D-01, 0.22370D-01, 0.22833D-01, 0.23281D-01,
     & 0.99978D-08, 0.11673D-02, 0.22776D-02, 0.33345D-02, 0.43415D-02,
     & 0.53015D-02, 0.62174D-02, 0.70917D-02, 0.79268D-02, 0.87249D-02,
     & 0.94880D-02, 0.10218D-01, 0.10916D-01, 0.11585D-01, 0.12226D-01,
     & 0.12840D-01, 0.13428D-01, 0.13993D-01, 0.14534D-01, 0.15053D-01,
     & 0.15551D-01, 0.16030D-01, 0.16490D-01, 0.16931D-01, 0.17356D-01,
     & 0.17763D-01, 0.18154D-01, 0.18530D-01, 0.18893D-01, 0.19241D-01,
     & 0.99975D-08, 0.98178D-03, 0.19120D-02, 0.27942D-02, 0.36312D-02,
     & 0.44257D-02, 0.51797D-02, 0.58968D-02, 0.65792D-02, 0.72288D-02,
     & 0.78475D-02, 0.84361D-02, 0.89969D-02, 0.95319D-02, 0.10043D-01,
     & 0.10530D-01, 0.10996D-01, 0.11440D-01, 0.11863D-01, 0.12268D-01,
     & 0.12656D-01, 0.13026D-01, 0.13381D-01, 0.13720D-01, 0.14044D-01,
     & 0.14353D-01, 0.14650D-01, 0.14933D-01, 0.15205D-01, 0.15466D-01,
     & 0.10002D-07, 0.80078D-03, 0.15562D-02, 0.22693D-02, 0.29428D-02,
     & 0.35788D-02, 0.41784D-02, 0.47463D-02, 0.52842D-02, 0.57940D-02,
     & 0.62771D-02, 0.67339D-02, 0.71667D-02, 0.75778D-02, 0.79684D-02,
     & 0.83396D-02, 0.86924D-02, 0.90270D-02, 0.93436D-02, 0.96451D-02,
     & 0.99322D-02, 0.10206D-01, 0.10466D-01, 0.10713D-01, 0.10949D-01,
     & 0.11171D-01, 0.11383D-01, 0.11585D-01, 0.11778D-01, 0.11962D-01,
     & 0.10001D-07, 0.62346D-03, 0.12085D-02, 0.17578D-02, 0.22736D-02,
     & 0.27576D-02, 0.32100D-02, 0.36362D-02, 0.40377D-02, 0.44160D-02,
     & 0.47725D-02, 0.51066D-02, 0.54209D-02, 0.57178D-02, 0.59983D-02,
     & 0.62633D-02, 0.65135D-02, 0.67491D-02, 0.69696D-02, 0.71785D-02,
     & 0.73762D-02, 0.75632D-02, 0.77401D-02, 0.79072D-02, 0.80650D-02,
     & 0.82118D-02, 0.83508D-02, 0.84825D-02, 0.86071D-02, 0.87249D-02,
     & 0.10001D-07, 0.58174D-03, 0.11269D-02, 0.16379D-02, 0.21169D-02,
     & 0.25657D-02, 0.29841D-02, 0.33777D-02, 0.37480D-02, 0.40963D-02,
     & 0.44239D-02, 0.47302D-02, 0.50177D-02, 0.52889D-02, 0.55447D-02,
     & 0.57859D-02, 0.60133D-02, 0.62269D-02, 0.64262D-02, 0.66147D-02,
     & 0.67927D-02, 0.69608D-02, 0.71195D-02, 0.72692D-02, 0.74101D-02,
     & 0.75406D-02, 0.76640D-02, 0.77806D-02, 0.78907D-02, 0.79945D-02,
     & 0.10000D-07, 0.54198D-03, 0.10491D-02, 0.15237D-02, 0.19680D-02,
     & 0.23834D-02, 0.27697D-02, 0.31325D-02, 0.34733D-02, 0.37933D-02,
     & 0.40938D-02, 0.43741D-02, 0.46365D-02, 0.48837D-02, 0.51164D-02,
     & 0.53355D-02, 0.55416D-02, 0.57347D-02, 0.59143D-02, 0.60839D-02,
     & 0.62437D-02, 0.63944D-02, 0.65363D-02, 0.66699D-02, 0.67953D-02,
     & 0.69109D-02, 0.70199D-02, 0.71227D-02, 0.72195D-02, 0.73106D-02,
     & 0.10000D-07, 0.50405D-03, 0.97498D-03, 0.14150D-02, 0.18263D-02,
     & 0.22100D-02, 0.25659D-02, 0.28996D-02, 0.32126D-02, 0.35060D-02,
     & 0.37810D-02, 0.40368D-02, 0.42757D-02, 0.45003D-02, 0.47115D-02,
     & 0.49099D-02, 0.50962D-02, 0.52703D-02, 0.54317D-02, 0.55837D-02,
     & 0.57267D-02, 0.58613D-02, 0.59877D-02, 0.61064D-02, 0.62176D-02,
     & 0.63195D-02, 0.64154D-02, 0.65056D-02, 0.65903D-02, 0.66697D-02,
     & 0.10000D-07, 0.46783D-03, 0.90424D-03, 0.13114D-02, 0.16912D-02,
     & 0.20449D-02, 0.23720D-02, 0.26783D-02, 0.29650D-02, 0.32333D-02,
     & 0.34843D-02, 0.37171D-02, 0.39339D-02, 0.41375D-02, 0.43285D-02,
     & 0.45076D-02, 0.46755D-02, 0.48318D-02, 0.49763D-02, 0.51120D-02,
     & 0.52395D-02, 0.53592D-02, 0.54714D-02, 0.55764D-02, 0.56744D-02,
     & 0.57638D-02, 0.58477D-02, 0.59263D-02, 0.60000D-02, 0.60689D-02,
     & 0.10000D-07, 0.43320D-03, 0.83667D-03, 0.12124D-02, 0.15624D-02,
     & 0.18876D-02, 0.21874D-02, 0.24676D-02, 0.27296D-02, 0.29742D-02,
     & 0.32026D-02, 0.34138D-02, 0.36100D-02, 0.37938D-02, 0.39660D-02,
     & 0.41271D-02, 0.42778D-02, 0.44177D-02, 0.45464D-02, 0.46671D-02,
     & 0.47802D-02, 0.48861D-02, 0.49851D-02, 0.50776D-02, 0.51636D-02,
     & 0.52414D-02, 0.53143D-02, 0.53825D-02, 0.54461D-02, 0.55054D-02/

      data ((g_grdl(i,j),j=1,30),i=31,40)/
     & 0.10000D-07, 0.40008D-03, 0.77209D-03, 0.11180D-02, 0.14394D-02,
     & 0.17376D-02, 0.20115D-02, 0.22672D-02, 0.25056D-02, 0.27280D-02,
     & 0.29351D-02, 0.31260D-02, 0.33028D-02, 0.34682D-02, 0.36228D-02,
     & 0.37671D-02, 0.39017D-02, 0.40263D-02, 0.41404D-02, 0.42472D-02,
     & 0.43470D-02, 0.44402D-02, 0.45272D-02, 0.46080D-02, 0.46830D-02,
     & 0.47504D-02, 0.48133D-02, 0.48719D-02, 0.49263D-02, 0.49769D-02,
     & 0.10000D-07, 0.36837D-03, 0.71033D-03, 0.10277D-02, 0.13221D-02,
     & 0.15945D-02, 0.18439D-02, 0.20762D-02, 0.22926D-02, 0.24938D-02,
     & 0.26810D-02, 0.28527D-02, 0.30114D-02, 0.31595D-02, 0.32976D-02,
     & 0.34263D-02, 0.35460D-02, 0.36564D-02, 0.37570D-02, 0.38509D-02,
     & 0.39385D-02, 0.40200D-02, 0.40958D-02, 0.41661D-02, 0.42310D-02,
     & 0.42888D-02, 0.43426D-02, 0.43925D-02, 0.44386D-02, 0.44813D-02,
     & 0.10000D-07, 0.33801D-03, 0.65123D-03, 0.94137D-03, 0.12100D-02,
     & 0.14579D-02, 0.16841D-02, 0.18944D-02, 0.20898D-02, 0.22712D-02,
     & 0.24395D-02, 0.25933D-02, 0.27350D-02, 0.28669D-02, 0.29897D-02,
     & 0.31037D-02, 0.32096D-02, 0.33068D-02, 0.33949D-02, 0.34770D-02,
     & 0.35532D-02, 0.36240D-02, 0.36896D-02, 0.37502D-02, 0.38059D-02,
     & 0.38550D-02, 0.39005D-02, 0.39425D-02, 0.39812D-02, 0.40167D-02,
     & 0.10000D-07, 0.30896D-03, 0.59474D-03, 0.85892D-03, 0.11030D-02,
     & 0.13277D-02, 0.15318D-02, 0.17213D-02, 0.18969D-02, 0.20597D-02,
     & 0.22102D-02, 0.23473D-02, 0.24730D-02, 0.25899D-02, 0.26983D-02,
     & 0.27988D-02, 0.28918D-02, 0.29768D-02, 0.30534D-02, 0.31245D-02,
     & 0.31904D-02, 0.32514D-02, 0.33076D-02, 0.33593D-02, 0.34066D-02,
     & 0.34479D-02, 0.34859D-02, 0.35208D-02, 0.35528D-02, 0.35820D-02,
     & 0.10001D-07, 0.28118D-03, 0.54076D-03, 0.78024D-03, 0.10010D-02,
     & 0.12037D-02, 0.13870D-02, 0.15568D-02, 0.17138D-02, 0.18590D-02,
     & 0.19929D-02, 0.21143D-02, 0.22252D-02, 0.23280D-02, 0.24232D-02,
     & 0.25111D-02, 0.25922D-02, 0.26661D-02, 0.27321D-02, 0.27932D-02,
     & 0.28496D-02, 0.29016D-02, 0.29493D-02, 0.29930D-02, 0.30328D-02,
     & 0.30669D-02, 0.30982D-02, 0.31268D-02, 0.31528D-02, 0.31763D-02,
     & 0.99998D-08, 0.25435D-03, 0.48868D-03, 0.70439D-03, 0.90274D-03,
     & 0.10844D-02, 0.12478D-02, 0.13988D-02, 0.15383D-02, 0.16667D-02,
     & 0.17850D-02, 0.18916D-02, 0.19886D-02, 0.20782D-02, 0.21610D-02,
     & 0.22372D-02, 0.23072D-02, 0.23706D-02, 0.24269D-02, 0.24787D-02,
     & 0.25265D-02, 0.25702D-02, 0.26102D-02, 0.26466D-02, 0.26795D-02,
     & 0.27072D-02, 0.27325D-02, 0.27554D-02, 0.27760D-02, 0.27945D-02,
     & 0.99996D-08, 0.22875D-03, 0.43904D-03, 0.63217D-03, 0.80930D-03,
     & 0.97099D-03, 0.11157D-02, 0.12492D-02, 0.13720D-02, 0.14849D-02,
     & 0.15885D-02, 0.16813D-02, 0.17654D-02, 0.18429D-02, 0.19142D-02,
     & 0.19796D-02, 0.20395D-02, 0.20934D-02, 0.21407D-02, 0.21842D-02,
     & 0.22241D-02, 0.22604D-02, 0.22934D-02, 0.23233D-02, 0.23500D-02,
     & 0.23720D-02, 0.23920D-02, 0.24099D-02, 0.24258D-02, 0.24399D-02,
     & 0.99998D-08, 0.20426D-03, 0.39161D-03, 0.56324D-03, 0.72023D-03,
     & 0.86304D-03, 0.99012D-03, 0.11070D-02, 0.12143D-02, 0.13126D-02,
     & 0.14025D-02, 0.14825D-02, 0.15546D-02, 0.16209D-02, 0.16816D-02,
     & 0.17371D-02, 0.17877D-02, 0.18329D-02, 0.18722D-02, 0.19081D-02,
     & 0.19408D-02, 0.19705D-02, 0.19972D-02, 0.20212D-02, 0.20425D-02,
     & 0.20596D-02, 0.20748D-02, 0.20884D-02, 0.21002D-02, 0.21105D-02,
     & 0.99999D-08, 0.18079D-03, 0.34621D-03, 0.49735D-03, 0.63518D-03,
     & 0.76010D-03, 0.87053D-03, 0.97181D-03, 0.10645D-02, 0.11492D-02,
     & 0.12263D-02, 0.12944D-02, 0.13555D-02, 0.14114D-02, 0.14624D-02,
     & 0.15088D-02, 0.15508D-02, 0.15882D-02, 0.16202D-02, 0.16492D-02,
     & 0.16756D-02, 0.16992D-02, 0.17204D-02, 0.17392D-02, 0.17557D-02,
     & 0.17684D-02, 0.17796D-02, 0.17893D-02, 0.17977D-02, 0.18046D-02,
     & 0.99999D-08, 0.15833D-03, 0.30281D-03, 0.43443D-03, 0.55408D-03,
     & 0.66207D-03, 0.75683D-03, 0.84348D-03, 0.92253D-03, 0.99444D-03,
     & 0.10597D-02, 0.11169D-02, 0.11677D-02, 0.12141D-02, 0.12562D-02,
     & 0.12943D-02, 0.13287D-02, 0.13588D-02, 0.13843D-02, 0.14073D-02,
     & 0.14279D-02, 0.14463D-02, 0.14626D-02, 0.14769D-02, 0.14891D-02,
     & 0.14981D-02, 0.15058D-02, 0.15123D-02, 0.15177D-02, 0.15219D-02/

      data ((g_grdl(i,j),j=1,30),i=41,50)/
     & 0.10000D-07, 0.13686D-03, 0.26139D-03, 0.37448D-03, 0.47691D-03,
     & 0.56895D-03, 0.64901D-03, 0.72199D-03, 0.78831D-03, 0.84840D-03,
     & 0.90263D-03, 0.94975D-03, 0.99127D-03, 0.10289D-02, 0.10630D-02,
     & 0.10937D-02, 0.11211D-02, 0.11449D-02, 0.11646D-02, 0.11822D-02,
     & 0.11978D-02, 0.12116D-02, 0.12236D-02, 0.12340D-02, 0.12426D-02,
     & 0.12484D-02, 0.12533D-02, 0.12571D-02, 0.12600D-02, 0.12620D-02,
     & 0.10000D-07, 0.11635D-03, 0.22190D-03, 0.31740D-03, 0.40357D-03,
     & 0.48059D-03, 0.54692D-03, 0.60716D-03, 0.66168D-03, 0.71084D-03,
     & 0.75497D-03, 0.79287D-03, 0.82593D-03, 0.85577D-03, 0.88258D-03,
     & 0.90652D-03, 0.92774D-03, 0.94592D-03, 0.96053D-03, 0.97347D-03,
     & 0.98481D-03, 0.99464D-03, 0.10030D-02, 0.10101D-02, 0.10157D-02,
     & 0.10189D-02, 0.10214D-02, 0.10231D-02, 0.10241D-02, 0.10244D-02,
     & 0.10000D-07, 0.96818D-04, 0.18433D-03, 0.26321D-03, 0.33405D-03,
     & 0.39700D-03, 0.45058D-03, 0.49902D-03, 0.54266D-03, 0.58179D-03,
     & 0.61670D-03, 0.64625D-03, 0.67172D-03, 0.69455D-03, 0.71490D-03,
     & 0.73291D-03, 0.74870D-03, 0.76197D-03, 0.77224D-03, 0.78119D-03,
     & 0.78889D-03, 0.79539D-03, 0.80076D-03, 0.80505D-03, 0.80824D-03,
     & 0.80947D-03, 0.81011D-03, 0.81017D-03, 0.80970D-03, 0.80871D-03,
     & 0.10000D-07, 0.78260D-04, 0.14872D-03, 0.21194D-03, 0.26842D-03,
     & 0.31826D-03, 0.36007D-03, 0.39770D-03, 0.43139D-03, 0.46142D-03,
     & 0.48799D-03, 0.51009D-03, 0.52884D-03, 0.54550D-03, 0.56021D-03,
     & 0.57307D-03, 0.58418D-03, 0.59327D-03, 0.59992D-03, 0.60557D-03,
     & 0.61028D-03, 0.61408D-03, 0.61703D-03, 0.61917D-03, 0.62047D-03,
     & 0.62021D-03, 0.61953D-03, 0.61846D-03, 0.61700D-03, 0.61518D-03,
     & 0.10000D-07, 0.60731D-04, 0.11515D-03, 0.16373D-03, 0.20687D-03,
     & 0.24461D-03, 0.27570D-03, 0.30351D-03, 0.32825D-03, 0.35011D-03,
     & 0.36928D-03, 0.38486D-03, 0.39778D-03, 0.40914D-03, 0.41904D-03,
     & 0.42754D-03, 0.43474D-03, 0.44039D-03, 0.44414D-03, 0.44718D-03,
     & 0.44955D-03, 0.45128D-03, 0.45240D-03, 0.45295D-03, 0.45291D-03,
     & 0.45168D-03, 0.45018D-03, 0.44842D-03, 0.44642D-03, 0.44419D-03,
     & 0.10000D-07, 0.44309D-04, 0.83796D-04, 0.11881D-03, 0.14968D-03,
     & 0.17640D-03, 0.19788D-03, 0.21695D-03, 0.23377D-03, 0.24847D-03,
     & 0.26120D-03, 0.27121D-03, 0.27925D-03, 0.28620D-03, 0.29214D-03,
     & 0.29711D-03, 0.30117D-03, 0.30413D-03, 0.30570D-03, 0.30682D-03,
     & 0.30751D-03, 0.30779D-03, 0.30768D-03, 0.30721D-03, 0.30635D-03,
     & 0.30465D-03, 0.30281D-03, 0.30083D-03, 0.29872D-03, 0.29648D-03,
     & 0.10000D-07, 0.29027D-04, 0.54707D-04, 0.77291D-04, 0.96997D-04,
     & 0.11380D-03, 0.12682D-03, 0.13827D-03, 0.14824D-03, 0.15684D-03,
     & 0.16415D-03, 0.16961D-03, 0.17376D-03, 0.17726D-03, 0.18015D-03,
     & 0.18246D-03, 0.18422D-03, 0.18529D-03, 0.18548D-03, 0.18543D-03,
     & 0.18515D-03, 0.18464D-03, 0.18393D-03, 0.18303D-03, 0.18191D-03,
     & 0.18029D-03, 0.17862D-03, 0.17689D-03, 0.17510D-03, 0.17327D-03,
     & 0.10000D-07, 0.15062D-04, 0.28303D-04, 0.39862D-04, 0.49859D-04,
     & 0.58271D-04, 0.64555D-04, 0.70030D-04, 0.74748D-04, 0.78757D-04,
     & 0.82103D-04, 0.84459D-04, 0.86135D-04, 0.87499D-04, 0.88571D-04,
     & 0.89366D-04, 0.89901D-04, 0.90097D-04, 0.89848D-04, 0.89497D-04,
     & 0.89049D-04, 0.88509D-04, 0.87883D-04, 0.87174D-04, 0.86376D-04,
     & 0.85340D-04, 0.84289D-04, 0.83225D-04, 0.82147D-04, 0.81058D-04,
     & 0.10000D-07, 0.49081D-05, 0.91811D-05, 0.12874D-04, 0.16029D-04,
     & 0.18633D-04, 0.20471D-04, 0.22049D-04, 0.23385D-04, 0.24493D-04,
     & 0.25389D-04, 0.25950D-04, 0.26290D-04, 0.26541D-04, 0.26708D-04,
     & 0.26796D-04, 0.26810D-04, 0.26723D-04, 0.26497D-04, 0.26249D-04,
     & 0.25979D-04, 0.25689D-04, 0.25380D-04, 0.25053D-04, 0.24705D-04,
     & 0.24290D-04, 0.23877D-04, 0.23465D-04, 0.23056D-04, 0.22649D-04,
     & 0.10000D-07, 0.12592D-06, 0.22440D-06, 0.30673D-06, 0.37406D-06,
     & 0.42564D-06, 0.45367D-06, 0.47582D-06, 0.49250D-06, 0.50407D-06,
     & 0.51084D-06, 0.50885D-06, 0.50154D-06, 0.49307D-06, 0.48351D-06,
     & 0.47292D-06, 0.46137D-06, 0.44808D-06, 0.43202D-06, 0.41622D-06,
     & 0.40068D-06, 0.38537D-06, 0.37030D-06, 0.35546D-06, 0.34076D-06,
     & 0.32525D-06, 0.31029D-06, 0.29587D-06, 0.28194D-06, 0.26851D-06/

      data ((c_grdl(i,j),j=1,30),i=1,10)/
     & 0.18780D-05, 0.18839D-05, 0.18892D-05, 0.18938D-05, 0.18979D-05,
     & 0.19016D-05, 0.19048D-05, 0.19076D-05, 0.19102D-05, 0.19124D-05,
     & 0.19144D-05, 0.19162D-05, 0.19177D-05, 0.19191D-05, 0.19203D-05,
     & 0.19214D-05, 0.19224D-05, 0.19232D-05, 0.19240D-05, 0.19247D-05,
     & 0.19253D-05, 0.19258D-05, 0.19262D-05, 0.19267D-05, 0.19270D-05,
     & 0.19273D-05, 0.19276D-05, 0.19279D-05, 0.19281D-05, 0.19283D-05,
     & 0.18619D-05, 0.18689D-05, 0.18750D-05, 0.18805D-05, 0.18854D-05,
     & 0.18896D-05, 0.18934D-05, 0.18968D-05, 0.18998D-05, 0.19024D-05,
     & 0.19048D-05, 0.19069D-05, 0.19087D-05, 0.19103D-05, 0.19118D-05,
     & 0.19130D-05, 0.19142D-05, 0.19152D-05, 0.19161D-05, 0.19169D-05,
     & 0.19176D-05, 0.19182D-05, 0.19187D-05, 0.19192D-05, 0.19196D-05,
     & 0.19200D-05, 0.19204D-05, 0.19207D-05, 0.19209D-05, 0.19212D-05,
     & 0.18429D-05, 0.18511D-05, 0.18584D-05, 0.18649D-05, 0.18706D-05,
     & 0.18756D-05, 0.18801D-05, 0.18841D-05, 0.18876D-05, 0.18907D-05,
     & 0.18934D-05, 0.18959D-05, 0.18981D-05, 0.19000D-05, 0.19017D-05,
     & 0.19032D-05, 0.19045D-05, 0.19057D-05, 0.19067D-05, 0.19077D-05,
     & 0.19085D-05, 0.19092D-05, 0.19099D-05, 0.19104D-05, 0.19110D-05,
     & 0.19114D-05, 0.19118D-05, 0.19122D-05, 0.19125D-05, 0.19127D-05,
     & 0.18206D-05, 0.18303D-05, 0.18388D-05, 0.18464D-05, 0.18531D-05,
     & 0.18591D-05, 0.18644D-05, 0.18690D-05, 0.18732D-05, 0.18768D-05,
     & 0.18801D-05, 0.18830D-05, 0.18855D-05, 0.18878D-05, 0.18898D-05,
     & 0.18916D-05, 0.18931D-05, 0.18945D-05, 0.18958D-05, 0.18969D-05,
     & 0.18978D-05, 0.18987D-05, 0.18994D-05, 0.19001D-05, 0.19007D-05,
     & 0.19012D-05, 0.19017D-05, 0.19021D-05, 0.19025D-05, 0.19028D-05,
     & 0.17943D-05, 0.18057D-05, 0.18158D-05, 0.18247D-05, 0.18326D-05,
     & 0.18396D-05, 0.18458D-05, 0.18513D-05, 0.18562D-05, 0.18605D-05,
     & 0.18644D-05, 0.18678D-05, 0.18708D-05, 0.18734D-05, 0.18758D-05,
     & 0.18779D-05, 0.18797D-05, 0.18814D-05, 0.18828D-05, 0.18841D-05,
     & 0.18852D-05, 0.18863D-05, 0.18872D-05, 0.18879D-05, 0.18887D-05,
     & 0.18893D-05, 0.18898D-05, 0.18903D-05, 0.18908D-05, 0.18911D-05,
     & 0.17634D-05, 0.17768D-05, 0.17886D-05, 0.17991D-05, 0.18084D-05,
     & 0.18167D-05, 0.18240D-05, 0.18305D-05, 0.18362D-05, 0.18413D-05,
     & 0.18458D-05, 0.18498D-05, 0.18534D-05, 0.18565D-05, 0.18593D-05,
     & 0.18617D-05, 0.18639D-05, 0.18659D-05, 0.18676D-05, 0.18691D-05,
     & 0.18704D-05, 0.18716D-05, 0.18727D-05, 0.18736D-05, 0.18744D-05,
     & 0.18752D-05, 0.18758D-05, 0.18764D-05, 0.18769D-05, 0.18774D-05,
     & 0.25004D-05, 0.23172D-05, 0.20454D-05, 0.17690D-05, 0.17800D-05,
     & 0.17897D-05, 0.17983D-05, 0.18060D-05, 0.18127D-05, 0.18187D-05,
     & 0.18240D-05, 0.18287D-05, 0.18329D-05, 0.18366D-05, 0.18399D-05,
     & 0.18428D-05, 0.18453D-05, 0.18476D-05, 0.18496D-05, 0.18514D-05,
     & 0.18530D-05, 0.18544D-05, 0.18556D-05, 0.18567D-05, 0.18577D-05,
     & 0.18586D-05, 0.18593D-05, 0.18600D-05, 0.18606D-05, 0.18612D-05,
     & 0.28123D-05, 0.26980D-05, 0.25725D-05, 0.24307D-05, 0.22596D-05,
     & 0.20028D-05, 0.17681D-05, 0.17771D-05, 0.17850D-05, 0.17921D-05,
     & 0.17983D-05, 0.18039D-05, 0.18088D-05, 0.18131D-05, 0.18170D-05,
     & 0.18204D-05, 0.18234D-05, 0.18261D-05, 0.18285D-05, 0.18306D-05,
     & 0.18324D-05, 0.18341D-05, 0.18356D-05, 0.18369D-05, 0.18380D-05,
     & 0.18390D-05, 0.18399D-05, 0.18407D-05, 0.18414D-05, 0.18421D-05,
     & 0.30358D-05, 0.29514D-05, 0.28616D-05, 0.27667D-05, 0.26663D-05,
     & 0.25592D-05, 0.24429D-05, 0.23118D-05, 0.21509D-05, 0.18587D-05,
     & 0.17681D-05, 0.17746D-05, 0.17804D-05, 0.17855D-05, 0.17900D-05,
     & 0.17941D-05, 0.17976D-05, 0.18008D-05, 0.18036D-05, 0.18060D-05,
     & 0.18082D-05, 0.18102D-05, 0.18119D-05, 0.18134D-05, 0.18148D-05,
     & 0.18160D-05, 0.18171D-05, 0.18180D-05, 0.18188D-05, 0.18196D-05,
     & 0.32014D-05, 0.31394D-05, 0.30726D-05, 0.30019D-05, 0.29283D-05,
     & 0.28524D-05, 0.27745D-05, 0.26949D-05, 0.26134D-05, 0.25297D-05,
     & 0.24429D-05, 0.23514D-05, 0.22523D-05, 0.21388D-05, 0.19889D-05,
     & 0.17631D-05, 0.17673D-05, 0.17710D-05, 0.17743D-05, 0.17772D-05,
     & 0.17798D-05, 0.17821D-05, 0.17841D-05, 0.17859D-05, 0.17875D-05,
     & 0.17889D-05, 0.17901D-05, 0.17912D-05, 0.17922D-05, 0.17931D-05/

      data ((c_grdl(i,j),j=1,30),i=11,20)/
     & 0.33147D-05, 0.32744D-05, 0.32279D-05, 0.31767D-05, 0.31223D-05,
     & 0.30657D-05, 0.30077D-05, 0.29491D-05, 0.28904D-05, 0.28321D-05,
     & 0.27745D-05, 0.27179D-05, 0.26624D-05, 0.26082D-05, 0.25553D-05,
     & 0.25038D-05, 0.24535D-05, 0.24046D-05, 0.23568D-05, 0.23100D-05,
     & 0.22642D-05, 0.22190D-05, 0.21740D-05, 0.21290D-05, 0.20833D-05,
     & 0.20358D-05, 0.19848D-05, 0.19260D-05, 0.18426D-05, 0.17619D-05,
     & 0.33730D-05, 0.33559D-05, 0.33307D-05, 0.32991D-05, 0.32627D-05,
     & 0.32229D-05, 0.31810D-05, 0.31378D-05, 0.30941D-05, 0.30505D-05,
     & 0.30077D-05, 0.29659D-05, 0.29255D-05, 0.28867D-05, 0.28497D-05,
     & 0.28146D-05, 0.27814D-05, 0.27503D-05, 0.27211D-05, 0.26940D-05,
     & 0.26687D-05, 0.26454D-05, 0.26239D-05, 0.26041D-05, 0.25859D-05,
     & 0.25693D-05, 0.25542D-05, 0.25404D-05, 0.25279D-05, 0.25166D-05,
     & 0.33696D-05, 0.33790D-05, 0.33775D-05, 0.33671D-05, 0.33500D-05,
     & 0.33278D-05, 0.33018D-05, 0.32732D-05, 0.32431D-05, 0.32121D-05,
     & 0.31810D-05, 0.31502D-05, 0.31202D-05, 0.30913D-05, 0.30637D-05,
     & 0.30375D-05, 0.30128D-05, 0.29897D-05, 0.29683D-05, 0.29484D-05,
     & 0.29301D-05, 0.29132D-05, 0.28978D-05, 0.28838D-05, 0.28710D-05,
     & 0.28594D-05, 0.28489D-05, 0.28394D-05, 0.28309D-05, 0.28232D-05,
     & 0.32954D-05, 0.33352D-05, 0.33609D-05, 0.33749D-05, 0.33796D-05,
     & 0.33768D-05, 0.33682D-05, 0.33554D-05, 0.33394D-05, 0.33213D-05,
     & 0.33018D-05, 0.32816D-05, 0.32613D-05, 0.32411D-05, 0.32215D-05,
     & 0.32026D-05, 0.31847D-05, 0.31678D-05, 0.31520D-05, 0.31372D-05,
     & 0.31236D-05, 0.31111D-05, 0.30996D-05, 0.30891D-05, 0.30796D-05,
     & 0.30709D-05, 0.30631D-05, 0.30560D-05, 0.30496D-05, 0.30439D-05,
     & 0.31420D-05, 0.32154D-05, 0.32718D-05, 0.33136D-05, 0.33432D-05,
     & 0.33628D-05, 0.33742D-05, 0.33791D-05, 0.33790D-05, 0.33750D-05,
     & 0.33682D-05, 0.33594D-05, 0.33493D-05, 0.33383D-05, 0.33269D-05,
     & 0.33155D-05, 0.33042D-05, 0.32933D-05, 0.32828D-05, 0.32729D-05,
     & 0.32636D-05, 0.32549D-05, 0.32469D-05, 0.32396D-05, 0.32328D-05,
     & 0.32267D-05, 0.32211D-05, 0.32160D-05, 0.32114D-05, 0.32073D-05,
     & 0.29032D-05, 0.30125D-05, 0.31020D-05, 0.31742D-05, 0.32317D-05,
     & 0.32765D-05, 0.33107D-05, 0.33360D-05, 0.33542D-05, 0.33665D-05,
     & 0.33742D-05, 0.33783D-05, 0.33796D-05, 0.33789D-05, 0.33766D-05,
     & 0.33732D-05, 0.33691D-05, 0.33647D-05, 0.33600D-05, 0.33552D-05,
     & 0.33505D-05, 0.33459D-05, 0.33416D-05, 0.33374D-05, 0.33336D-05,
     & 0.33300D-05, 0.33267D-05, 0.33237D-05, 0.33209D-05, 0.33184D-05,
     & 0.25769D-05, 0.27220D-05, 0.28459D-05, 0.29505D-05, 0.30377D-05,
     & 0.31099D-05, 0.31690D-05, 0.32170D-05, 0.32557D-05, 0.32865D-05,
     & 0.33107D-05, 0.33296D-05, 0.33441D-05, 0.33551D-05, 0.33633D-05,
     & 0.33693D-05, 0.33735D-05, 0.33763D-05, 0.33781D-05, 0.33792D-05,
     & 0.33796D-05, 0.33796D-05, 0.33793D-05, 0.33787D-05, 0.33781D-05,
     & 0.33773D-05, 0.33765D-05, 0.33757D-05, 0.33749D-05, 0.33741D-05,
     & 0.21692D-05, 0.23466D-05, 0.25030D-05, 0.26389D-05, 0.27565D-05,
     & 0.28571D-05, 0.29427D-05, 0.30150D-05, 0.30758D-05, 0.31266D-05,
     & 0.31690D-05, 0.32043D-05, 0.32336D-05, 0.32579D-05, 0.32779D-05,
     & 0.32945D-05, 0.33081D-05, 0.33193D-05, 0.33286D-05, 0.33363D-05,
     & 0.33426D-05, 0.33479D-05, 0.33522D-05, 0.33558D-05, 0.33588D-05,
     & 0.33613D-05, 0.33634D-05, 0.33652D-05, 0.33667D-05, 0.33679D-05,
     & 0.16990D-05, 0.18989D-05, 0.20808D-05, 0.22444D-05, 0.23896D-05,
     & 0.25174D-05, 0.26287D-05, 0.27254D-05, 0.28091D-05, 0.28810D-05,
     & 0.29427D-05, 0.29956D-05, 0.30407D-05, 0.30793D-05, 0.31122D-05,
     & 0.31403D-05, 0.31643D-05, 0.31848D-05, 0.32025D-05, 0.32176D-05,
     & 0.32305D-05, 0.32417D-05, 0.32513D-05, 0.32596D-05, 0.32667D-05,
     & 0.32729D-05, 0.32783D-05, 0.32830D-05, 0.32870D-05, 0.32906D-05,
     & 0.30531D-05, 0.28863D-05, 0.16017D-05, 0.17829D-05, 0.19484D-05,
     & 0.20979D-05, 0.22319D-05, 0.23509D-05, 0.24560D-05, 0.25482D-05,
     & 0.26287D-05, 0.26991D-05, 0.27605D-05, 0.28140D-05, 0.28604D-05,
     & 0.29008D-05, 0.29358D-05, 0.29663D-05, 0.29928D-05, 0.30158D-05,
     & 0.30359D-05, 0.30534D-05, 0.30687D-05, 0.30820D-05, 0.30937D-05,
     & 0.31039D-05, 0.31128D-05, 0.31207D-05, 0.31276D-05, 0.31336D-05/

      data ((c_grdl(i,j),j=1,30),i=21,30)/
     & 0.23190D-05, 0.27357D-05, 0.29983D-05, 0.30407D-05, 0.27429D-05,
     & 0.16204D-05, 0.17689D-05, 0.19038D-05, 0.20254D-05, 0.21346D-05,
     & 0.22319D-05, 0.23183D-05, 0.23948D-05, 0.24622D-05, 0.25216D-05,
     & 0.25737D-05, 0.26196D-05, 0.26599D-05, 0.26954D-05, 0.27265D-05,
     & 0.27539D-05, 0.27780D-05, 0.27992D-05, 0.28178D-05, 0.28342D-05,
     & 0.28486D-05, 0.28613D-05, 0.28725D-05, 0.28824D-05, 0.28911D-05,
     & 0.25745D-05, 0.26373D-05, 0.25793D-05, 0.25043D-05, 0.28219D-05,
     & 0.30136D-05, 0.30474D-05, 0.28747D-05, 0.23139D-05, 0.16608D-05,
     & 0.17689D-05, 0.18666D-05, 0.19543D-05, 0.20327D-05, 0.21029D-05,
     & 0.21653D-05, 0.22208D-05, 0.22700D-05, 0.23136D-05, 0.23523D-05,
     & 0.23865D-05, 0.24167D-05, 0.24435D-05, 0.24671D-05, 0.24880D-05,
     & 0.25065D-05, 0.25228D-05, 0.25372D-05, 0.25499D-05, 0.25612D-05,
     & 0.88133D-06, 0.17490D-05, 0.25062D-05, 0.25842D-05, 0.25532D-05,
     & 0.25186D-05, 0.24742D-05, 0.27447D-05, 0.29359D-05, 0.30392D-05,
     & 0.30473D-05, 0.29503D-05, 0.27210D-05, 0.22447D-05, 0.16259D-05,
     & 0.16947D-05, 0.17565D-05, 0.18118D-05, 0.18613D-05, 0.19054D-05,
     & 0.19447D-05, 0.19797D-05, 0.20108D-05, 0.20384D-05, 0.20630D-05,
     & 0.20849D-05, 0.21043D-05, 0.21215D-05, 0.21367D-05, 0.21503D-05,
     & 0.53557D-09, 0.12340D-06, 0.54952D-06, 0.12225D-05, 0.19789D-05,
     & 0.25498D-05, 0.26236D-05, 0.26377D-05, 0.26329D-05, 0.22314D-05,
     & 0.24743D-05, 0.26749D-05, 0.28316D-05, 0.29451D-05, 0.30177D-05,
     & 0.30521D-05, 0.30517D-05, 0.30198D-05, 0.29590D-05, 0.28710D-05,
     & 0.27560D-05, 0.26116D-05, 0.24295D-05, 0.21830D-05, 0.15824D-05,
     & 0.16062D-05, 0.16274D-05, 0.16463D-05, 0.16631D-05, 0.16780D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.18356D-07, 0.20570D-06,
     & 0.60737D-06, 0.11626D-05, 0.17721D-05, 0.23138D-05, 0.25912D-05,
     & 0.26235D-05, 0.26108D-05, 0.25630D-05, 0.26333D-05, 0.24923D-05,
     & 0.23093D-05, 0.24472D-05, 0.25651D-05, 0.26646D-05, 0.27475D-05,
     & 0.28158D-05, 0.28715D-05, 0.29164D-05, 0.29522D-05, 0.29803D-05,
     & 0.30021D-05, 0.30188D-05, 0.30313D-05, 0.30404D-05, 0.30468D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.50389D-07,
     & 0.28817D-06, 0.70734D-06, 0.12456D-05, 0.18142D-05, 0.23120D-05,
     & 0.25912D-05, 0.26357D-05, 0.25678D-05, 0.26273D-05, 0.26132D-05,
     & 0.26210D-05, 0.24042D-05, 0.23086D-05, 0.24215D-05, 0.25190D-05,
     & 0.26025D-05, 0.26735D-05, 0.27337D-05, 0.27843D-05, 0.28269D-05,
     & 0.28626D-05, 0.28925D-05, 0.29174D-05, 0.29381D-05, 0.29554D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.22845D-08,
     & 0.95710D-07, 0.36883D-06, 0.79233D-06, 0.13052D-05, 0.18321D-05,
     & 0.22915D-05, 0.25771D-05, 0.26207D-05, 0.25036D-05, 0.26288D-05,
     & 0.25545D-05, 0.26259D-05, 0.26167D-05, 0.24637D-05, 0.22677D-05,
     & 0.23605D-05, 0.24415D-05, 0.25119D-05, 0.25727D-05, 0.26252D-05,
     & 0.26704D-05, 0.27094D-05, 0.27428D-05, 0.27717D-05, 0.27965D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.13373D-07, 0.14810D-06, 0.44226D-06, 0.85840D-06, 0.13405D-05,
     & 0.18262D-05, 0.22518D-05, 0.25432D-05, 0.25779D-05, 0.26096D-05,
     & 0.25737D-05, 0.26377D-05, 0.25675D-05, 0.26239D-05, 0.26283D-05,
     & 0.25652D-05, 0.23211D-05, 0.22694D-05, 0.23366D-05, 0.23954D-05,
     & 0.24470D-05, 0.24921D-05, 0.25314D-05, 0.25658D-05, 0.25958D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.34345D-07, 0.20143D-06, 0.50387D-06, 0.90370D-06,
     & 0.13517D-05, 0.17973D-05, 0.21921D-05, 0.24857D-05, 0.25760D-05,
     & 0.26311D-05, 0.24808D-05, 0.25938D-05, 0.26377D-05, 0.25519D-05,
     & 0.26073D-05, 0.26320D-05, 0.26252D-05, 0.25827D-05, 0.24870D-05,
     & 0.22078D-05, 0.22566D-05, 0.22997D-05, 0.23376D-05, 0.23709D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.12845D-08, 0.62364D-07, 0.25040D-06, 0.55031D-06,
     & 0.92727D-06, 0.13392D-05, 0.17461D-05, 0.21118D-05, 0.24024D-05,
     & 0.25770D-05, 0.25734D-05, 0.26355D-05, 0.24910D-05, 0.25838D-05,
     & 0.26327D-05, 0.26213D-05, 0.25650D-05, 0.26038D-05, 0.26261D-05,
     & 0.26333D-05, 0.26266D-05, 0.26066D-05, 0.25728D-05, 0.25231D-05/

      data ((c_grdl(i,j),j=1,30),i=31,40)/
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.72516D-08, 0.92381D-07, 0.29070D-06,
     & 0.57961D-06, 0.92922D-06, 0.13044D-05, 0.16738D-05, 0.20110D-05,
     & 0.22930D-05, 0.24986D-05, 0.25925D-05, 0.25882D-05, 0.26358D-05,
     & 0.25026D-05, 0.25442D-05, 0.26017D-05, 0.26328D-05, 0.26339D-05,
     & 0.25635D-05, 0.25671D-05, 0.25930D-05, 0.26114D-05, 0.26236D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.17676D-07, 0.12018D-06,
     & 0.31915D-06, 0.59108D-06, 0.91052D-06, 0.12489D-05, 0.15820D-05,
     & 0.18904D-05, 0.21586D-05, 0.23742D-05, 0.25261D-05, 0.25925D-05,
     & 0.25697D-05, 0.26268D-05, 0.26277D-05, 0.24685D-05, 0.25294D-05,
     & 0.25754D-05, 0.26079D-05, 0.26283D-05, 0.26373D-05, 0.26345D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.18373D-09, 0.30361D-07,
     & 0.14227D-06, 0.33453D-06, 0.58507D-06, 0.87285D-06, 0.11750D-05,
     & 0.14727D-05, 0.17518D-05, 0.20016D-05, 0.22144D-05, 0.23851D-05,
     & 0.25100D-05, 0.25822D-05, 0.25622D-05, 0.25821D-05, 0.26226D-05,
     & 0.26357D-05, 0.26154D-05, 0.25015D-05, 0.25008D-05, 0.25336D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.18017D-08,
     & 0.42605D-07, 0.15658D-06, 0.33658D-06, 0.56285D-06, 0.81848D-06,
     & 0.10852D-05, 0.13486D-05, 0.15981D-05, 0.18260D-05, 0.20275D-05,
     & 0.21995D-05, 0.23410D-05, 0.24518D-05, 0.25321D-05, 0.25806D-05,
     & 0.25899D-05, 0.25406D-05, 0.25813D-05, 0.26097D-05, 0.26274D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.46955D-08, 0.52036D-07, 0.16209D-06, 0.32596D-06, 0.52640D-06,
     & 0.75001D-06, 0.98247D-06, 0.12129D-05, 0.14327D-05, 0.16367D-05,
     & 0.18212D-05, 0.19844D-05, 0.21258D-05, 0.22458D-05, 0.23454D-05,
     & 0.24262D-05, 0.24896D-05, 0.25370D-05, 0.25697D-05, 0.25883D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.77974D-08, 0.57132D-07, 0.15881D-06, 0.30406D-06,
     & 0.47826D-06, 0.67066D-06, 0.87059D-06, 0.10691D-05, 0.12599D-05,
     & 0.14388D-05, 0.16032D-05, 0.17518D-05, 0.18841D-05, 0.20006D-05,
     & 0.21019D-05, 0.21893D-05, 0.22639D-05, 0.23272D-05, 0.23804D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.10046D-07, 0.57370D-07, 0.14762D-06,
     & 0.27286D-06, 0.42137D-06, 0.58403D-06, 0.75311D-06, 0.92143D-06,
     & 0.10843D-05, 0.12382D-05, 0.13810D-05, 0.15119D-05, 0.16304D-05,
     & 0.17367D-05, 0.18314D-05, 0.19151D-05, 0.19888D-05, 0.20535D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.34160D-10, 0.10791D-07, 0.53035D-07,
     & 0.13004D-06, 0.23485D-06, 0.35891D-06, 0.49376D-06, 0.63387D-06,
     & 0.77421D-06, 0.91037D-06, 0.10400D-05, 0.11615D-05, 0.12735D-05,
     & 0.13760D-05, 0.14691D-05, 0.15530D-05, 0.16283D-05, 0.16955D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.92776D-10, 0.99134D-08,
     & 0.45065D-07, 0.10805D-06, 0.19305D-06, 0.29403D-06, 0.40346D-06,
     & 0.51714D-06, 0.63131D-06, 0.74299D-06, 0.84980D-06, 0.95031D-06,
     & 0.10439D-05, 0.11302D-05, 0.12089D-05, 0.12805D-05, 0.13452D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.77970D-10,
     & 0.77712D-08, 0.34864D-07, 0.83838D-07, 0.15034D-06, 0.22949D-06,
     & 0.31655D-06, 0.40659D-06, 0.49727D-06, 0.58632D-06, 0.67208D-06,
     & 0.75339D-06, 0.82940D-06, 0.89972D-06, 0.96440D-06, 0.10235D-05/

      data ((c_grdl(i,j),j=1,30),i=41,50)/
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.15536D-10, 0.50342D-08, 0.24105D-07, 0.59815D-07, 0.10952D-06,
     & 0.16919D-06, 0.23555D-06, 0.30538D-06, 0.37548D-06, 0.44455D-06,
     & 0.51136D-06, 0.57499D-06, 0.63486D-06, 0.69064D-06, 0.74219D-06,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.24693D-08, 0.14336D-07, 0.38098D-07,
     & 0.72919D-07, 0.11590D-06, 0.16413D-06, 0.21557D-06, 0.26833D-06,
     & 0.32052D-06, 0.37093D-06, 0.41915D-06, 0.46471D-06, 0.50733D-06,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.70775D-09, 0.67723D-08,
     & 0.20763D-07, 0.42817D-07, 0.71509D-07, 0.10473D-06, 0.14065D-06,
     & 0.17790D-06, 0.21537D-06, 0.25223D-06, 0.28780D-06, 0.32130D-06,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.22002D-10,
     & 0.20745D-08, 0.88241D-08, 0.20873D-07, 0.37809D-07, 0.58644D-07,
     & 0.81936D-07, 0.10665D-06, 0.13183D-06, 0.15684D-06, 0.18125D-06,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.16734D-09, 0.22738D-08, 0.74253D-08, 0.15708D-07,
     & 0.26746D-07, 0.39962D-07, 0.54675D-07, 0.70129D-07, 0.85815D-07,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.89582D-10, 0.12617D-08,
     & 0.40877D-08, 0.85877D-08, 0.14550D-07, 0.21664D-07, 0.29598D-07,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.21863D-09, 0.11389D-08, 0.28364D-08, 0.52465D-08,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.13090D-10,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00/

      DO I=1,50
        DO J=1,30
          UDS_GRD(I,J) = UDS_GRDL(I,J)
          G_GRD(I,J)   = G_GRDL(I,J)
          C_GRD(I,J)   = C_GRDL(I,J)
        ENDDO
      ENDDO

      RETURN
      END
*CMZ :  2.06/31 23/06/99  12.57.26  by  Hannes Jung
*CMZ :  2.06/17 11/08/97  .2 71/6
*-- Author :
      SUBROUTINE I_LO_Q3G1
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NQ2MAX=30,NZMAX=50)
      DIMENSION UDS_GRD(NZMAX,NQ2MAX),C_GRD(NZMAX,NQ2MAX),
     &          G_GRD(NZMAX,NQ2MAX)
      DIMENSION UDS_GRDL(NZMAX,NQ2MAX),C_GRDL(NZMAX,NQ2MAX),
     &          G_GRDL(NZMAX,NQ2MAX)
      COMMON /CPARAM/ UDS_GRD,C_GRD,G_GRD
      data ((uds_grdl(i,j),j=1,30),i=1,10)/
     & 0.49423D-03, 0.17306D-02, 0.30223D-02, 0.43643D-02, 0.57517D-02,
     & 0.71793D-02, 0.86382D-02, 0.10135D-01, 0.11665D-01, 0.13227D-01,
     & 0.14818D-01, 0.16431D-01, 0.18066D-01, 0.19725D-01, 0.21405D-01,
     & 0.23104D-01, 0.24821D-01, 0.26554D-01, 0.28298D-01, 0.30057D-01,
     & 0.31829D-01, 0.33611D-01, 0.35404D-01, 0.37206D-01, 0.39016D-01,
     & 0.40834D-01, 0.42657D-01, 0.44487D-01, 0.46321D-01, 0.48160D-01,
     & 0.52294D-03, 0.17560D-02, 0.30382D-02, 0.43650D-02, 0.57320D-02,
     & 0.71347D-02, 0.85659D-02, 0.10030D-01, 0.11523D-01, 0.13043D-01,
     & 0.14587D-01, 0.16151D-01, 0.17735D-01, 0.19337D-01, 0.20957D-01,
     & 0.22593D-01, 0.24243D-01, 0.25906D-01, 0.27580D-01, 0.29264D-01,
     & 0.30957D-01, 0.32659D-01, 0.34369D-01, 0.36084D-01, 0.37806D-01,
     & 0.39534D-01, 0.41266D-01, 0.43001D-01, 0.44738D-01, 0.46478D-01,
     & 0.55769D-03, 0.17869D-02, 0.30594D-02, 0.43708D-02, 0.57175D-02,
     & 0.70954D-02, 0.84989D-02, 0.99301D-02, 0.11386D-01, 0.12865D-01,
     & 0.14364D-01, 0.15880D-01, 0.17412D-01, 0.18960D-01, 0.20521D-01,
     & 0.22095D-01, 0.23680D-01, 0.25275D-01, 0.26879D-01, 0.28491D-01,
     & 0.30109D-01, 0.31732D-01, 0.33361D-01, 0.34994D-01, 0.36630D-01,
     & 0.38271D-01, 0.39914D-01, 0.41558D-01, 0.43203D-01, 0.44847D-01,
     & 0.59992D-03, 0.18249D-02, 0.30874D-02, 0.43834D-02, 0.57098D-02,
     & 0.70630D-02, 0.84390D-02, 0.98379D-02, 0.11257D-01, 0.12695D-01,
     & 0.14150D-01, 0.15619D-01, 0.17101D-01, 0.18595D-01, 0.20100D-01,
     & 0.21613D-01, 0.23135D-01, 0.24664D-01, 0.26201D-01, 0.27742D-01,
     & 0.29287D-01, 0.30835D-01, 0.32385D-01, 0.33938D-01, 0.35492D-01,
     & 0.37050D-01, 0.38607D-01, 0.40164D-01, 0.41719D-01, 0.43272D-01,
     & 0.65136D-03, 0.18714D-02, 0.31233D-02, 0.44035D-02, 0.57092D-02,
     & 0.70375D-02, 0.83858D-02, 0.97523D-02, 0.11135D-01, 0.12533D-01,
     & 0.13943D-01, 0.15366D-01, 0.16798D-01, 0.18239D-01, 0.19688D-01,
     & 0.21142D-01, 0.22602D-01, 0.24067D-01, 0.25537D-01, 0.27009D-01,
     & 0.28483D-01, 0.29957D-01, 0.31432D-01, 0.32907D-01, 0.34381D-01,
     & 0.35858D-01, 0.37333D-01, 0.38804D-01, 0.40273D-01, 0.41738D-01,
     & 0.71430D-03, 0.19287D-02, 0.31692D-02, 0.44332D-02, 0.57178D-02,
     & 0.70209D-02, 0.83410D-02, 0.96751D-02, 0.11022D-01, 0.12379D-01,
     & 0.13745D-01, 0.15122D-01, 0.16505D-01, 0.17894D-01, 0.19287D-01,
     & 0.20683D-01, 0.22082D-01, 0.23484D-01, 0.24890D-01, 0.26295D-01,
     & 0.27699D-01, 0.29101D-01, 0.30502D-01, 0.31901D-01, 0.33298D-01,
     & 0.34697D-01, 0.36091D-01, 0.37481D-01, 0.38866D-01, 0.40247D-01,
     & 0.79165D-03, 0.19994D-02, 0.32280D-02, 0.44750D-02, 0.57382D-02,
     & 0.70158D-02, 0.83074D-02, 0.96088D-02, 0.10919D-01, 0.12236D-01,
     & 0.13559D-01, 0.14890D-01, 0.16225D-01, 0.17562D-01, 0.18900D-01,
     & 0.20239D-01, 0.21579D-01, 0.22919D-01, 0.24261D-01, 0.25600D-01,
     & 0.26936D-01, 0.28269D-01, 0.29598D-01, 0.30924D-01, 0.32246D-01,
     & 0.33568D-01, 0.34885D-01, 0.36195D-01, 0.37500D-01, 0.38798D-01,
     & 0.88719D-03, 0.20875D-02, 0.33035D-02, 0.45331D-02, 0.57744D-02,
     & 0.70263D-02, 0.82891D-02, 0.95579D-02, 0.10832D-01, 0.12109D-01,
     & 0.13389D-01, 0.14674D-01, 0.15962D-01, 0.17248D-01, 0.18533D-01,
     & 0.19816D-01, 0.21097D-01, 0.22377D-01, 0.23657D-01, 0.24933D-01,
     & 0.26203D-01, 0.27468D-01, 0.28728D-01, 0.29982D-01, 0.31232D-01,
     & 0.32480D-01, 0.33722D-01, 0.34956D-01, 0.36183D-01, 0.37403D-01,
     & 0.10057D-02, 0.21977D-02, 0.34004D-02, 0.46120D-02, 0.58312D-02,
     & 0.70570D-02, 0.82909D-02, 0.95270D-02, 0.10764D-01, 0.12003D-01,
     & 0.13241D-01, 0.14481D-01, 0.15721D-01, 0.16957D-01, 0.18190D-01,
     & 0.19418D-01, 0.20643D-01, 0.21864D-01, 0.23084D-01, 0.24297D-01,
     & 0.25503D-01, 0.26703D-01, 0.27896D-01, 0.29081D-01, 0.30261D-01,
     & 0.31439D-01, 0.32608D-01, 0.33769D-01, 0.34921D-01, 0.36065D-01,
     & 0.11533D-02, 0.23357D-02, 0.35239D-02, 0.47166D-02, 0.59127D-02,
     & 0.71118D-02, 0.83159D-02, 0.95188D-02, 0.10720D-01, 0.11918D-01,
     & 0.13114D-01, 0.14309D-01, 0.15502D-01, 0.16689D-01, 0.17869D-01,
     & 0.19044D-01, 0.20212D-01, 0.21376D-01, 0.22536D-01, 0.23688D-01,
     & 0.24832D-01, 0.25967D-01, 0.27094D-01, 0.28213D-01, 0.29325D-01,
     & 0.30433D-01, 0.31533D-01, 0.32622D-01, 0.33702D-01, 0.34773D-01/

      data ((uds_grdl(i,j),j=1,30),i=11,20)/
     & 0.13379D-02, 0.25092D-02, 0.36816D-02, 0.48543D-02, 0.60264D-02,
     & 0.71979D-02, 0.83716D-02, 0.95405D-02, 0.10704D-01, 0.11863D-01,
     & 0.13016D-01, 0.14167D-01, 0.15312D-01, 0.16450D-01, 0.17579D-01,
     & 0.18700D-01, 0.19813D-01, 0.20920D-01, 0.22022D-01, 0.23114D-01,
     & 0.24196D-01, 0.25269D-01, 0.26332D-01, 0.27386D-01, 0.28431D-01,
     & 0.29473D-01, 0.30504D-01, 0.31524D-01, 0.32534D-01, 0.33534D-01,
     & 0.15697D-02, 0.27285D-02, 0.38841D-02, 0.50357D-02, 0.61830D-02,
     & 0.73264D-02, 0.84690D-02, 0.96037D-02, 0.10730D-01, 0.11849D-01,
     & 0.12960D-01, 0.14066D-01, 0.15165D-01, 0.16254D-01, 0.17333D-01,
     & 0.18401D-01, 0.19460D-01, 0.20511D-01, 0.21556D-01, 0.22590D-01,
     & 0.23613D-01, 0.24625D-01, 0.25626D-01, 0.26617D-01, 0.27598D-01,
     & 0.28574D-01, 0.29540D-01, 0.30493D-01, 0.31437D-01, 0.32369D-01,
     & 0.18615D-02, 0.30060D-02, 0.41428D-02, 0.52719D-02, 0.63931D-02,
     & 0.75070D-02, 0.86173D-02, 0.97167D-02, 0.10806D-01, 0.11884D-01,
     & 0.12952D-01, 0.14013D-01, 0.15065D-01, 0.16105D-01, 0.17133D-01,
     & 0.18150D-01, 0.19155D-01, 0.20151D-01, 0.21140D-01, 0.22116D-01,
     & 0.23080D-01, 0.24032D-01, 0.24972D-01, 0.25901D-01, 0.26820D-01,
     & 0.27733D-01, 0.28634D-01, 0.29523D-01, 0.30401D-01, 0.31268D-01,
     & 0.22298D-02, 0.33581D-02, 0.44749D-02, 0.55802D-02, 0.66742D-02,
     & 0.77578D-02, 0.88350D-02, 0.98987D-02, 0.10949D-01, 0.11987D-01,
     & 0.13012D-01, 0.14029D-01, 0.15034D-01, 0.16026D-01, 0.17004D-01,
     & 0.17969D-01, 0.18922D-01, 0.19863D-01, 0.20797D-01, 0.21717D-01,
     & 0.22623D-01, 0.23517D-01, 0.24399D-01, 0.25268D-01, 0.26126D-01,
     & 0.26978D-01, 0.27817D-01, 0.28644D-01, 0.29459D-01, 0.30262D-01,
     & 0.26946D-02, 0.38048D-02, 0.48997D-02, 0.59796D-02, 0.70450D-02,
     & 0.80971D-02, 0.91400D-02, 0.10167D-01, 0.11178D-01, 0.12175D-01,
     & 0.13157D-01, 0.14128D-01, 0.15087D-01, 0.16031D-01, 0.16959D-01,
     & 0.17873D-01, 0.18774D-01, 0.19662D-01, 0.20541D-01, 0.21405D-01,
     & 0.22256D-01, 0.23092D-01, 0.23916D-01, 0.24727D-01, 0.25527D-01,
     & 0.26319D-01, 0.27097D-01, 0.27864D-01, 0.28618D-01, 0.29360D-01,
     & 0.32820D-02, 0.43705D-02, 0.54401D-02, 0.64915D-02, 0.75254D-02,
     & 0.85433D-02, 0.95494D-02, 0.10537D-01, 0.11507D-01, 0.12461D-01,
     & 0.13398D-01, 0.14323D-01, 0.15233D-01, 0.16127D-01, 0.17005D-01,
     & 0.17867D-01, 0.18715D-01, 0.19549D-01, 0.20373D-01, 0.21181D-01,
     & 0.21975D-01, 0.22755D-01, 0.23521D-01, 0.24274D-01, 0.25015D-01,
     & 0.25748D-01, 0.26467D-01, 0.27173D-01, 0.27868D-01, 0.28550D-01,
     & 0.40218D-02, 0.50852D-02, 0.61265D-02, 0.71466D-02, 0.81465D-02,
     & 0.91278D-02, 0.10095D-01, 0.11042D-01, 0.11969D-01, 0.12877D-01,
     & 0.13768D-01, 0.14645D-01, 0.15506D-01, 0.16350D-01, 0.17176D-01,
     & 0.17986D-01, 0.18780D-01, 0.19560D-01, 0.20329D-01, 0.21082D-01,
     & 0.21819D-01, 0.22542D-01, 0.23252D-01, 0.23947D-01, 0.24630D-01,
     & 0.25304D-01, 0.25965D-01, 0.26613D-01, 0.27248D-01, 0.27871D-01,
     & 0.49496D-02, 0.59836D-02, 0.69925D-02, 0.79775D-02, 0.89398D-02,
     & 0.98811D-02, 0.10806D-01, 0.11709D-01, 0.12590D-01, 0.13452D-01,
     & 0.14294D-01, 0.15121D-01, 0.15931D-01, 0.16722D-01, 0.17495D-01,
     & 0.18251D-01, 0.18991D-01, 0.19716D-01, 0.20428D-01, 0.21125D-01,
     & 0.21806D-01, 0.22472D-01, 0.23124D-01, 0.23762D-01, 0.24387D-01,
     & 0.25002D-01, 0.25604D-01, 0.26194D-01, 0.26771D-01, 0.27335D-01,
     & 0.61045D-02, 0.71036D-02, 0.80749D-02, 0.90199D-02, 0.99401D-02,
     & 0.10837D-01, 0.11716D-01, 0.12570D-01, 0.13403D-01, 0.14214D-01,
     & 0.15004D-01, 0.15778D-01, 0.16534D-01, 0.17271D-01, 0.17989D-01,
     & 0.18689D-01, 0.19372D-01, 0.20040D-01, 0.20695D-01, 0.21333D-01,
     & 0.21956D-01, 0.22564D-01, 0.23157D-01, 0.23737D-01, 0.24303D-01,
     & 0.24860D-01, 0.25403D-01, 0.25933D-01, 0.26452D-01, 0.26958D-01,
     & 0.75259D-02, 0.84829D-02, 0.94099D-02, 0.10309D-01, 0.11180D-01,
     & 0.12027D-01, 0.12854D-01, 0.13655D-01, 0.14433D-01, 0.15189D-01,
     & 0.15924D-01, 0.16640D-01, 0.17338D-01, 0.18016D-01, 0.18675D-01,
     & 0.19316D-01, 0.19940D-01, 0.20547D-01, 0.21142D-01, 0.21719D-01,
     & 0.22282D-01, 0.22829D-01, 0.23362D-01, 0.23881D-01, 0.24387D-01,
     & 0.24883D-01, 0.25366D-01, 0.25836D-01, 0.26295D-01, 0.26741D-01/

      data ((uds_grdl(i,j),j=1,30),i=21,30)/
     & 0.92464D-02, 0.10152D-01, 0.11026D-01, 0.11869D-01, 0.12685D-01,
     & 0.13474D-01, 0.14241D-01, 0.14982D-01, 0.15699D-01, 0.16393D-01,
     & 0.17065D-01, 0.17718D-01, 0.18352D-01, 0.18966D-01, 0.19561D-01,
     & 0.20137D-01, 0.20697D-01, 0.21240D-01, 0.21769D-01, 0.22282D-01,
     & 0.22780D-01, 0.23263D-01, 0.23732D-01, 0.24188D-01, 0.24631D-01,
     & 0.25063D-01, 0.25482D-01, 0.25890D-01, 0.26286D-01, 0.26671D-01,
     & 0.11281D-01, 0.12122D-01, 0.12929D-01, 0.13705D-01, 0.14453D-01,
     & 0.15172D-01, 0.15868D-01, 0.16538D-01, 0.17184D-01, 0.17806D-01,
     & 0.18406D-01, 0.18987D-01, 0.19548D-01, 0.20090D-01, 0.20613D-01,
     & 0.21117D-01, 0.21605D-01, 0.22077D-01, 0.22534D-01, 0.22976D-01,
     & 0.23403D-01, 0.23816D-01, 0.24215D-01, 0.24601D-01, 0.24975D-01,
     & 0.25339D-01, 0.25690D-01, 0.26030D-01, 0.26359D-01, 0.26678D-01,
     & 0.13598D-01, 0.14358D-01, 0.15084D-01, 0.15778D-01, 0.16443D-01,
     & 0.17080D-01, 0.17692D-01, 0.18279D-01, 0.18841D-01, 0.19380D-01,
     & 0.19898D-01, 0.20395D-01, 0.20874D-01, 0.21333D-01, 0.21774D-01,
     & 0.22198D-01, 0.22605D-01, 0.22997D-01, 0.23375D-01, 0.23738D-01,
     & 0.24087D-01, 0.24422D-01, 0.24746D-01, 0.25056D-01, 0.25356D-01,
     & 0.25644D-01, 0.25922D-01, 0.26190D-01, 0.26447D-01, 0.26695D-01,
     & 0.16096D-01, 0.16754D-01, 0.17379D-01, 0.17972D-01, 0.18536D-01,
     & 0.19073D-01, 0.19584D-01, 0.20071D-01, 0.20534D-01, 0.20975D-01,
     & 0.21395D-01, 0.21796D-01, 0.22178D-01, 0.22542D-01, 0.22889D-01,
     & 0.23220D-01, 0.23536D-01, 0.23837D-01, 0.24125D-01, 0.24399D-01,
     & 0.24661D-01, 0.24911D-01, 0.25149D-01, 0.25376D-01, 0.25593D-01,
     & 0.25800D-01, 0.25997D-01, 0.26185D-01, 0.26364D-01, 0.26535D-01,
     & 0.18549D-01, 0.19077D-01, 0.19573D-01, 0.20039D-01, 0.20477D-01,
     & 0.20890D-01, 0.21277D-01, 0.21641D-01, 0.21984D-01, 0.22307D-01,
     & 0.22611D-01, 0.22896D-01, 0.23165D-01, 0.23417D-01, 0.23655D-01,
     & 0.23878D-01, 0.24088D-01, 0.24285D-01, 0.24470D-01, 0.24643D-01,
     & 0.24805D-01, 0.24958D-01, 0.25101D-01, 0.25235D-01, 0.25360D-01,
     & 0.25475D-01, 0.25583D-01, 0.25684D-01, 0.25778D-01, 0.25865D-01,
     & 0.19092D-01, 0.19583D-01, 0.20044D-01, 0.20475D-01, 0.20878D-01,
     & 0.21257D-01, 0.21610D-01, 0.21942D-01, 0.22253D-01, 0.22544D-01,
     & 0.22816D-01, 0.23071D-01, 0.23309D-01, 0.23532D-01, 0.23741D-01,
     & 0.23936D-01, 0.24119D-01, 0.24289D-01, 0.24446D-01, 0.24593D-01,
     & 0.24730D-01, 0.24858D-01, 0.24977D-01, 0.25087D-01, 0.25188D-01,
     & 0.25281D-01, 0.25366D-01, 0.25445D-01, 0.25517D-01, 0.25583D-01,
     & 0.19582D-01, 0.20037D-01, 0.20461D-01, 0.20857D-01, 0.21226D-01,
     & 0.21569D-01, 0.21889D-01, 0.22188D-01, 0.22466D-01, 0.22726D-01,
     & 0.22967D-01, 0.23191D-01, 0.23399D-01, 0.23593D-01, 0.23773D-01,
     & 0.23941D-01, 0.24096D-01, 0.24239D-01, 0.24370D-01, 0.24492D-01,
     & 0.24604D-01, 0.24707D-01, 0.24801D-01, 0.24888D-01, 0.24967D-01,
     & 0.25037D-01, 0.25100D-01, 0.25157D-01, 0.25209D-01, 0.25254D-01,
     & 0.20019D-01, 0.20436D-01, 0.20824D-01, 0.21183D-01, 0.21517D-01,
     & 0.21826D-01, 0.22112D-01, 0.22377D-01, 0.22623D-01, 0.22851D-01,
     & 0.23062D-01, 0.23255D-01, 0.23434D-01, 0.23598D-01, 0.23750D-01,
     & 0.23890D-01, 0.24018D-01, 0.24134D-01, 0.24240D-01, 0.24336D-01,
     & 0.24423D-01, 0.24502D-01, 0.24573D-01, 0.24637D-01, 0.24693D-01,
     & 0.24741D-01, 0.24783D-01, 0.24820D-01, 0.24851D-01, 0.24877D-01,
     & 0.20399D-01, 0.20778D-01, 0.21129D-01, 0.21452D-01, 0.21750D-01,
     & 0.22025D-01, 0.22276D-01, 0.22508D-01, 0.22722D-01, 0.22918D-01,
     & 0.23098D-01, 0.23261D-01, 0.23409D-01, 0.23545D-01, 0.23669D-01,
     & 0.23781D-01, 0.23883D-01, 0.23973D-01, 0.24053D-01, 0.24124D-01,
     & 0.24187D-01, 0.24243D-01, 0.24291D-01, 0.24333D-01, 0.24367D-01,
     & 0.24394D-01, 0.24415D-01, 0.24431D-01, 0.24443D-01, 0.24450D-01,
     & 0.20722D-01, 0.21062D-01, 0.21375D-01, 0.21661D-01, 0.21924D-01,
     & 0.22164D-01, 0.22381D-01, 0.22579D-01, 0.22760D-01, 0.22925D-01,
     & 0.23074D-01, 0.23207D-01, 0.23326D-01, 0.23433D-01, 0.23529D-01,
     & 0.23614D-01, 0.23690D-01, 0.23755D-01, 0.23809D-01, 0.23856D-01,
     & 0.23896D-01, 0.23928D-01, 0.23954D-01, 0.23974D-01, 0.23987D-01,
     & 0.23993D-01, 0.23995D-01, 0.23991D-01, 0.23984D-01, 0.23972D-01/

      data ((uds_grdl(i,j),j=1,30),i=31,40)/
     & 0.20984D-01, 0.21285D-01, 0.21559D-01, 0.21809D-01, 0.22036D-01,
     & 0.22241D-01, 0.22423D-01, 0.22588D-01, 0.22737D-01, 0.22870D-01,
     & 0.22988D-01, 0.23092D-01, 0.23182D-01, 0.23261D-01, 0.23329D-01,
     & 0.23388D-01, 0.23437D-01, 0.23477D-01, 0.23507D-01, 0.23530D-01,
     & 0.23547D-01, 0.23557D-01, 0.23561D-01, 0.23560D-01, 0.23553D-01,
     & 0.23539D-01, 0.23521D-01, 0.23499D-01, 0.23473D-01, 0.23444D-01,
     & 0.21184D-01, 0.21446D-01, 0.21682D-01, 0.21894D-01, 0.22085D-01,
     & 0.22255D-01, 0.22403D-01, 0.22534D-01, 0.22651D-01, 0.22752D-01,
     & 0.22841D-01, 0.22914D-01, 0.22976D-01, 0.23027D-01, 0.23068D-01,
     & 0.23101D-01, 0.23125D-01, 0.23141D-01, 0.23147D-01, 0.23146D-01,
     & 0.23141D-01, 0.23129D-01, 0.23112D-01, 0.23091D-01, 0.23064D-01,
     & 0.23031D-01, 0.22994D-01, 0.22954D-01, 0.22910D-01, 0.22864D-01,
     & 0.21322D-01, 0.21544D-01, 0.21741D-01, 0.21916D-01, 0.22070D-01,
     & 0.22205D-01, 0.22318D-01, 0.22417D-01, 0.22501D-01, 0.22572D-01,
     & 0.22630D-01, 0.22674D-01, 0.22707D-01, 0.22731D-01, 0.22746D-01,
     & 0.22753D-01, 0.22753D-01, 0.22744D-01, 0.22727D-01, 0.22704D-01,
     & 0.22676D-01, 0.22644D-01, 0.22607D-01, 0.22566D-01, 0.22520D-01,
     & 0.22468D-01, 0.22413D-01, 0.22356D-01, 0.22296D-01, 0.22234D-01,
     & 0.21397D-01, 0.21578D-01, 0.21736D-01, 0.21873D-01, 0.21991D-01,
     & 0.22090D-01, 0.22169D-01, 0.22235D-01, 0.22287D-01, 0.22327D-01,
     & 0.22355D-01, 0.22371D-01, 0.22376D-01, 0.22373D-01, 0.22362D-01,
     & 0.22344D-01, 0.22319D-01, 0.22288D-01, 0.22248D-01, 0.22203D-01,
     & 0.22155D-01, 0.22102D-01, 0.22046D-01, 0.21985D-01, 0.21922D-01,
     & 0.21852D-01, 0.21781D-01, 0.21707D-01, 0.21631D-01, 0.21554D-01,
     & 0.21407D-01, 0.21547D-01, 0.21666D-01, 0.21765D-01, 0.21846D-01,
     & 0.21910D-01, 0.21956D-01, 0.21988D-01, 0.22009D-01, 0.22018D-01,
     & 0.22018D-01, 0.22005D-01, 0.21982D-01, 0.21953D-01, 0.21917D-01,
     & 0.21875D-01, 0.21827D-01, 0.21772D-01, 0.21711D-01, 0.21645D-01,
     & 0.21577D-01, 0.21505D-01, 0.21429D-01, 0.21351D-01, 0.21270D-01,
     & 0.21184D-01, 0.21097D-01, 0.21007D-01, 0.20917D-01, 0.20825D-01,
     & 0.21347D-01, 0.21445D-01, 0.21524D-01, 0.21585D-01, 0.21629D-01,
     & 0.21658D-01, 0.21669D-01, 0.21668D-01, 0.21657D-01, 0.21637D-01,
     & 0.21607D-01, 0.21567D-01, 0.21517D-01, 0.21462D-01, 0.21401D-01,
     & 0.21336D-01, 0.21265D-01, 0.21189D-01, 0.21106D-01, 0.21020D-01,
     & 0.20932D-01, 0.20842D-01, 0.20749D-01, 0.20654D-01, 0.20556D-01,
     & 0.20454D-01, 0.20351D-01, 0.20248D-01, 0.20143D-01, 0.20038D-01,
     & 0.21222D-01, 0.21278D-01, 0.21317D-01, 0.21339D-01, 0.21347D-01,
     & 0.21341D-01, 0.21318D-01, 0.21285D-01, 0.21243D-01, 0.21193D-01,
     & 0.21135D-01, 0.21067D-01, 0.20991D-01, 0.20911D-01, 0.20827D-01,
     & 0.20738D-01, 0.20645D-01, 0.20548D-01, 0.20445D-01, 0.20341D-01,
     & 0.20234D-01, 0.20126D-01, 0.20016D-01, 0.19905D-01, 0.19792D-01,
     & 0.19676D-01, 0.19559D-01, 0.19442D-01, 0.19324D-01, 0.19207D-01,
     & 0.21030D-01, 0.21043D-01, 0.21042D-01, 0.21026D-01, 0.20997D-01,
     & 0.20955D-01, 0.20899D-01, 0.20834D-01, 0.20762D-01, 0.20682D-01,
     & 0.20596D-01, 0.20502D-01, 0.20401D-01, 0.20297D-01, 0.20189D-01,
     & 0.20078D-01, 0.19965D-01, 0.19848D-01, 0.19726D-01, 0.19603D-01,
     & 0.19479D-01, 0.19354D-01, 0.19229D-01, 0.19103D-01, 0.18976D-01,
     & 0.18845D-01, 0.18716D-01, 0.18586D-01, 0.18457D-01, 0.18329D-01,
     & 0.20768D-01, 0.20739D-01, 0.20697D-01, 0.20642D-01, 0.20576D-01,
     & 0.20500D-01, 0.20410D-01, 0.20313D-01, 0.20211D-01, 0.20103D-01,
     & 0.19990D-01, 0.19869D-01, 0.19744D-01, 0.19616D-01, 0.19486D-01,
     & 0.19354D-01, 0.19221D-01, 0.19085D-01, 0.18945D-01, 0.18805D-01,
     & 0.18665D-01, 0.18525D-01, 0.18385D-01, 0.18245D-01, 0.18104D-01,
     & 0.17962D-01, 0.17820D-01, 0.17680D-01, 0.17540D-01, 0.17402D-01,
     & 0.20436D-01, 0.20363D-01, 0.20279D-01, 0.20186D-01, 0.20083D-01,
     & 0.19972D-01, 0.19849D-01, 0.19721D-01, 0.19589D-01, 0.19453D-01,
     & 0.19313D-01, 0.19168D-01, 0.19018D-01, 0.18868D-01, 0.18717D-01,
     & 0.18565D-01, 0.18413D-01, 0.18259D-01, 0.18102D-01, 0.17946D-01,
     & 0.17791D-01, 0.17636D-01, 0.17483D-01, 0.17330D-01, 0.17178D-01,
     & 0.17024D-01, 0.16872D-01, 0.16722D-01, 0.16573D-01, 0.16426D-01/

      data ((uds_grdl(i,j),j=1,30),i=41,50)/
     & 0.20030D-01, 0.19913D-01, 0.19787D-01, 0.19654D-01, 0.19515D-01,
     & 0.19369D-01, 0.19212D-01, 0.19054D-01, 0.18892D-01, 0.18729D-01,
     & 0.18564D-01, 0.18394D-01, 0.18222D-01, 0.18050D-01, 0.17879D-01,
     & 0.17708D-01, 0.17538D-01, 0.17367D-01, 0.17195D-01, 0.17024D-01,
     & 0.16855D-01, 0.16688D-01, 0.16523D-01, 0.16359D-01, 0.16196D-01,
     & 0.16033D-01, 0.15871D-01, 0.15712D-01, 0.15556D-01, 0.15401D-01,
     & 0.19547D-01, 0.19384D-01, 0.19217D-01, 0.19045D-01, 0.18868D-01,
     & 0.18687D-01, 0.18498D-01, 0.18309D-01, 0.18119D-01, 0.17929D-01,
     & 0.17739D-01, 0.17546D-01, 0.17352D-01, 0.17160D-01, 0.16970D-01,
     & 0.16781D-01, 0.16594D-01, 0.16408D-01, 0.16221D-01, 0.16037D-01,
     & 0.15856D-01, 0.15677D-01, 0.15501D-01, 0.15327D-01, 0.15155D-01,
     & 0.14983D-01, 0.14814D-01, 0.14648D-01, 0.14485D-01, 0.14324D-01,
     & 0.18980D-01, 0.18771D-01, 0.18561D-01, 0.18348D-01, 0.18134D-01,
     & 0.17919D-01, 0.17698D-01, 0.17478D-01, 0.17261D-01, 0.17045D-01,
     & 0.16830D-01, 0.16615D-01, 0.16401D-01, 0.16190D-01, 0.15982D-01,
     & 0.15777D-01, 0.15575D-01, 0.15374D-01, 0.15175D-01, 0.14980D-01,
     & 0.14787D-01, 0.14599D-01, 0.14413D-01, 0.14231D-01, 0.14051D-01,
     & 0.13873D-01, 0.13698D-01, 0.13527D-01, 0.13358D-01, 0.13193D-01,
     & 0.18318D-01, 0.18062D-01, 0.17808D-01, 0.17554D-01, 0.17303D-01,
     & 0.17052D-01, 0.16800D-01, 0.16551D-01, 0.16306D-01, 0.16065D-01,
     & 0.15827D-01, 0.15591D-01, 0.15357D-01, 0.15129D-01, 0.14904D-01,
     & 0.14684D-01, 0.14468D-01, 0.14256D-01, 0.14046D-01, 0.13840D-01,
     & 0.13639D-01, 0.13442D-01, 0.13249D-01, 0.13060D-01, 0.12875D-01,
     & 0.12692D-01, 0.12513D-01, 0.12337D-01, 0.12166D-01, 0.11998D-01,
     & 0.17534D-01, 0.17228D-01, 0.16929D-01, 0.16634D-01, 0.16345D-01,
     & 0.16060D-01, 0.15776D-01, 0.15498D-01, 0.15227D-01, 0.14962D-01,
     & 0.14703D-01, 0.14447D-01, 0.14196D-01, 0.13952D-01, 0.13713D-01,
     & 0.13480D-01, 0.13253D-01, 0.13030D-01, 0.12812D-01, 0.12598D-01,
     & 0.12390D-01, 0.12187D-01, 0.11990D-01, 0.11796D-01, 0.11608D-01,
     & 0.11422D-01, 0.11241D-01, 0.11065D-01, 0.10892D-01, 0.10724D-01,
     & 0.16597D-01, 0.16239D-01, 0.15891D-01, 0.15554D-01, 0.15225D-01,
     & 0.14905D-01, 0.14591D-01, 0.14287D-01, 0.13992D-01, 0.13705D-01,
     & 0.13426D-01, 0.13154D-01, 0.12889D-01, 0.12631D-01, 0.12382D-01,
     & 0.12139D-01, 0.11903D-01, 0.11674D-01, 0.11450D-01, 0.11232D-01,
     & 0.11021D-01, 0.10816D-01, 0.10616D-01, 0.10422D-01, 0.10232D-01,
     & 0.10048D-01, 0.98682D-02, 0.96934D-02, 0.95233D-02, 0.93576D-02,
     & 0.15463D-01, 0.15064D-01, 0.14680D-01, 0.14308D-01, 0.13948D-01,
     & 0.13600D-01, 0.13259D-01, 0.12931D-01, 0.12614D-01, 0.12308D-01,
     & 0.12012D-01, 0.11725D-01, 0.11446D-01, 0.11177D-01, 0.10917D-01,
     & 0.10665D-01, 0.10422D-01, 0.10186D-01, 0.99576D-02, 0.97363D-02,
     & 0.95221D-02, 0.93148D-02, 0.91139D-02, 0.89193D-02, 0.87307D-02,
     & 0.85476D-02, 0.83701D-02, 0.81980D-02, 0.80310D-02, 0.78689D-02,
     & 0.14272D-01, 0.13746D-01, 0.13248D-01, 0.12775D-01, 0.12328D-01,
     & 0.11903D-01, 0.11500D-01, 0.11117D-01, 0.10753D-01, 0.10405D-01,
     & 0.10074D-01, 0.97593D-02, 0.94593D-02, 0.91724D-02, 0.88978D-02,
     & 0.86351D-02, 0.83835D-02, 0.81431D-02, 0.79139D-02, 0.76937D-02,
     & 0.74822D-02, 0.72790D-02, 0.70836D-02, 0.68958D-02, 0.67154D-02,
     & 0.65432D-02, 0.63772D-02, 0.62171D-02, 0.60627D-02, 0.59137D-02,
     & 0.97399D-02, 0.92902D-02, 0.88685D-02, 0.84728D-02, 0.81015D-02,
     & 0.77537D-02, 0.74306D-02, 0.71256D-02, 0.68375D-02, 0.65655D-02,
     & 0.63085D-02, 0.60678D-02, 0.58412D-02, 0.56258D-02, 0.54212D-02,
     & 0.52268D-02, 0.50420D-02, 0.48671D-02, 0.47027D-02, 0.45457D-02,
     & 0.43956D-02, 0.42522D-02, 0.41152D-02, 0.39843D-02, 0.38594D-02,
     & 0.37419D-02, 0.36292D-02, 0.35209D-02, 0.34170D-02, 0.33171D-02,
     & 0.61454D-03, 0.58290D-03, 0.55335D-03, 0.52575D-03, 0.49997D-03,
     & 0.47594D-03, 0.45381D-03, 0.43299D-03, 0.41341D-03, 0.39498D-03,
     & 0.37765D-03, 0.36154D-03, 0.34646D-03, 0.33217D-03, 0.31864D-03,
     & 0.30582D-03, 0.29369D-03, 0.28227D-03, 0.27161D-03, 0.26146D-03,
     & 0.25179D-03, 0.24257D-03, 0.23380D-03, 0.22544D-03, 0.21749D-03,
     & 0.21008D-03, 0.20299D-03, 0.19619D-03, 0.18968D-03, 0.18345D-03/

      data ((g_grdl(i,j),j=1,30),i=1,10)/
     & 0.80813D+00, 0.88720D+00, 0.96575D+00, 0.10438D+01, 0.11213D+01,
     & 0.11982D+01, 0.12748D+01, 0.13508D+01, 0.14260D+01, 0.15006D+01,
     & 0.15745D+01, 0.16479D+01, 0.17208D+01, 0.17928D+01, 0.18641D+01,
     & 0.19347D+01, 0.20046D+01, 0.20738D+01, 0.21425D+01, 0.22105D+01,
     & 0.22777D+01, 0.23441D+01, 0.24098D+01, 0.24748D+01, 0.25391D+01,
     & 0.26030D+01, 0.26662D+01, 0.27286D+01, 0.27902D+01, 0.28512D+01,
     & 0.80806D+00, 0.88348D+00, 0.95821D+00, 0.10323D+01, 0.11056D+01,
     & 0.11784D+01, 0.12507D+01, 0.13222D+01, 0.13930D+01, 0.14629D+01,
     & 0.15322D+01, 0.16008D+01, 0.16688D+01, 0.17360D+01, 0.18024D+01,
     & 0.18680D+01, 0.19328D+01, 0.19970D+01, 0.20606D+01, 0.21235D+01,
     & 0.21855D+01, 0.22467D+01, 0.23072D+01, 0.23670D+01, 0.24260D+01,
     & 0.24847D+01, 0.25426D+01, 0.25997D+01, 0.26561D+01, 0.27118D+01,
     & 0.80804D+00, 0.87981D+00, 0.95076D+00, 0.10209D+01, 0.10902D+01,
     & 0.11589D+01, 0.12269D+01, 0.12941D+01, 0.13605D+01, 0.14260D+01,
     & 0.14907D+01, 0.15547D+01, 0.16181D+01, 0.16806D+01, 0.17422D+01,
     & 0.18030D+01, 0.18630D+01, 0.19223D+01, 0.19811D+01, 0.20390D+01,
     & 0.20961D+01, 0.21524D+01, 0.22079D+01, 0.22627D+01, 0.23168D+01,
     & 0.23705D+01, 0.24234D+01, 0.24755D+01, 0.25269D+01, 0.25776D+01,
     & 0.80810D+00, 0.87625D+00, 0.94346D+00, 0.10097D+01, 0.10751D+01,
     & 0.11397D+01, 0.12037D+01, 0.12666D+01, 0.13287D+01, 0.13899D+01,
     & 0.14502D+01, 0.15098D+01, 0.15687D+01, 0.16266D+01, 0.16837D+01,
     & 0.17399D+01, 0.17953D+01, 0.18500D+01, 0.19041D+01, 0.19573D+01,
     & 0.20098D+01, 0.20614D+01, 0.21122D+01, 0.21623D+01, 0.22117D+01,
     & 0.22606D+01, 0.23088D+01, 0.23562D+01, 0.24029D+01, 0.24489D+01,
     & 0.80810D+00, 0.87264D+00, 0.93612D+00, 0.99859D+00, 0.10601D+01,
     & 0.11206D+01, 0.11805D+01, 0.12394D+01, 0.12973D+01, 0.13542D+01,
     & 0.14103D+01, 0.14656D+01, 0.15201D+01, 0.15737D+01, 0.16264D+01,
     & 0.16782D+01, 0.17291D+01, 0.17794D+01, 0.18290D+01, 0.18777D+01,
     & 0.19257D+01, 0.19728D+01, 0.20192D+01, 0.20648D+01, 0.21097D+01,
     & 0.21541D+01, 0.21978D+01, 0.22407D+01, 0.22830D+01, 0.23245D+01,
     & 0.80804D+00, 0.86896D+00, 0.92875D+00, 0.98743D+00, 0.10451D+01,
     & 0.11017D+01, 0.11576D+01, 0.12124D+01, 0.12663D+01, 0.13191D+01,
     & 0.13710D+01, 0.14221D+01, 0.14724D+01, 0.15217D+01, 0.15702D+01,
     & 0.16177D+01, 0.16644D+01, 0.17104D+01, 0.17557D+01, 0.18002D+01,
     & 0.18438D+01, 0.18867D+01, 0.19288D+01, 0.19701D+01, 0.20108D+01,
     & 0.20510D+01, 0.20904D+01, 0.21291D+01, 0.21671D+01, 0.22045D+01,
     & 0.80792D+00, 0.86524D+00, 0.92135D+00, 0.97628D+00, 0.10301D+01,
     & 0.10829D+01, 0.11349D+01, 0.11858D+01, 0.12356D+01, 0.12844D+01,
     & 0.13323D+01, 0.13793D+01, 0.14256D+01, 0.14708D+01, 0.15152D+01,
     & 0.15586D+01, 0.16012D+01, 0.16431D+01, 0.16843D+01, 0.17247D+01,
     & 0.17643D+01, 0.18030D+01, 0.18411D+01, 0.18784D+01, 0.19150D+01,
     & 0.19511D+01, 0.19865D+01, 0.20212D+01, 0.20553D+01, 0.20887D+01,
     & 0.80784D+00, 0.86158D+00, 0.91405D+00, 0.96530D+00, 0.10154D+01,
     & 0.10644D+01, 0.11126D+01, 0.11596D+01, 0.12056D+01, 0.12505D+01,
     & 0.12944D+01, 0.13376D+01, 0.13799D+01, 0.14212D+01, 0.14617D+01,
     & 0.15012D+01, 0.15399D+01, 0.15778D+01, 0.16152D+01, 0.16516D+01,
     & 0.16873D+01, 0.17222D+01, 0.17564D+01, 0.17899D+01, 0.18227D+01,
     & 0.18550D+01, 0.18866D+01, 0.19176D+01, 0.19479D+01, 0.19776D+01,
     & 0.80784D+00, 0.85804D+00, 0.90691D+00, 0.95453D+00, 0.10010D+01,
     & 0.10463D+01, 0.10907D+01, 0.11340D+01, 0.11762D+01, 0.12174D+01,
     & 0.12576D+01, 0.12970D+01, 0.13355D+01, 0.13731D+01, 0.14098D+01,
     & 0.14456D+01, 0.14805D+01, 0.15147D+01, 0.15483D+01, 0.15811D+01,
     & 0.16131D+01, 0.16444D+01, 0.16749D+01, 0.17048D+01, 0.17340D+01,
     & 0.17627D+01, 0.17908D+01, 0.18182D+01, 0.18450D+01, 0.18713D+01,
     & 0.80773D+00, 0.85439D+00, 0.89969D+00, 0.94371D+00, 0.98652D+00,
     & 0.10282D+01, 0.10690D+01, 0.11086D+01, 0.11472D+01, 0.11847D+01,
     & 0.12212D+01, 0.12570D+01, 0.12918D+01, 0.13258D+01, 0.13588D+01,
     & 0.13910D+01, 0.14224D+01, 0.14531D+01, 0.14831D+01, 0.15123D+01,
     & 0.15408D+01, 0.15686D+01, 0.15957D+01, 0.16222D+01, 0.16480D+01,
     & 0.16733D+01, 0.16980D+01, 0.17221D+01, 0.17456D+01, 0.17686D+01/

      data ((g_grdl(i,j),j=1,30),i=11,20)/
     & 0.80754D+00, 0.85066D+00, 0.89242D+00, 0.93289D+00, 0.97215D+00,
     & 0.10103D+01, 0.10475D+01, 0.10835D+01, 0.11185D+01, 0.11525D+01,
     & 0.11855D+01, 0.12177D+01, 0.12490D+01, 0.12795D+01, 0.13090D+01,
     & 0.13378D+01, 0.13657D+01, 0.13930D+01, 0.14196D+01, 0.14455D+01,
     & 0.14706D+01, 0.14951D+01, 0.15190D+01, 0.15422D+01, 0.15648D+01,
     & 0.15869D+01, 0.16084D+01, 0.16294D+01, 0.16498D+01, 0.16697D+01,
     & 0.80741D+00, 0.84705D+00, 0.88533D+00, 0.92232D+00, 0.95809D+00,
     & 0.99275D+00, 0.10264D+01, 0.10590D+01, 0.10906D+01, 0.11211D+01,
     & 0.11507D+01, 0.11795D+01, 0.12075D+01, 0.12346D+01, 0.12609D+01,
     & 0.12863D+01, 0.13110D+01, 0.13351D+01, 0.13585D+01, 0.13812D+01,
     & 0.14032D+01, 0.14246D+01, 0.14453D+01, 0.14655D+01, 0.14851D+01,
     & 0.15042D+01, 0.15228D+01, 0.15409D+01, 0.15584D+01, 0.15754D+01,
     & 0.80717D+00, 0.84334D+00, 0.87816D+00, 0.91170D+00, 0.94405D+00,
     & 0.97529D+00, 0.10056D+01, 0.10348D+01, 0.10630D+01, 0.10902D+01,
     & 0.11165D+01, 0.11420D+01, 0.11667D+01, 0.11906D+01, 0.12137D+01,
     & 0.12360D+01, 0.12576D+01, 0.12785D+01, 0.12989D+01, 0.13185D+01,
     & 0.13376D+01, 0.13560D+01, 0.13739D+01, 0.13912D+01, 0.14079D+01,
     & 0.14242D+01, 0.14400D+01, 0.14553D+01, 0.14702D+01, 0.14845D+01,
     & 0.80714D+00, 0.83990D+00, 0.87132D+00, 0.90150D+00, 0.93051D+00,
     & 0.95843D+00, 0.98541D+00, 0.10113D+01, 0.10363D+01, 0.10603D+01,
     & 0.10835D+01, 0.11059D+01, 0.11275D+01, 0.11483D+01, 0.11683D+01,
     & 0.11876D+01, 0.12063D+01, 0.12243D+01, 0.12418D+01, 0.12586D+01,
     & 0.12748D+01, 0.12905D+01, 0.13056D+01, 0.13202D+01, 0.13343D+01,
     & 0.13480D+01, 0.13612D+01, 0.13740D+01, 0.13863D+01, 0.13982D+01,
     & 0.80735D+00, 0.83672D+00, 0.86481D+00, 0.89169D+00, 0.91743D+00,
     & 0.94212D+00, 0.96588D+00, 0.98864D+00, 0.10105D+01, 0.10314D+01,
     & 0.10515D+01, 0.10709D+01, 0.10895D+01, 0.11074D+01, 0.11245D+01,
     & 0.11410D+01, 0.11568D+01, 0.11721D+01, 0.11868D+01, 0.12009D+01,
     & 0.12145D+01, 0.12276D+01, 0.12401D+01, 0.12522D+01, 0.12639D+01,
     & 0.12751D+01, 0.12859D+01, 0.12962D+01, 0.13062D+01, 0.13158D+01,
     & 0.80704D+00, 0.83305D+00, 0.85782D+00, 0.88143D+00, 0.90395D+00,
     & 0.92546D+00, 0.94606D+00, 0.96572D+00, 0.98450D+00, 0.10024D+01,
     & 0.10196D+01, 0.10360D+01, 0.10518D+01, 0.10668D+01, 0.10812D+01,
     & 0.10950D+01, 0.11081D+01, 0.11207D+01, 0.11328D+01, 0.11444D+01,
     & 0.11555D+01, 0.11661D+01, 0.11762D+01, 0.11859D+01, 0.11952D+01,
     & 0.12041D+01, 0.12126D+01, 0.12208D+01, 0.12286D+01, 0.12360D+01,
     & 0.80683D+00, 0.82952D+00, 0.85103D+00, 0.87143D+00, 0.89080D+00,
     & 0.90920D+00, 0.92674D+00, 0.94339D+00, 0.95921D+00, 0.97426D+00,
     & 0.98856D+00, 0.10022D+01, 0.10152D+01, 0.10275D+01, 0.10392D+01,
     & 0.10504D+01, 0.10610D+01, 0.10711D+01, 0.10808D+01, 0.10899D+01,
     & 0.10986D+01, 0.11069D+01, 0.11148D+01, 0.11222D+01, 0.11293D+01,
     & 0.11361D+01, 0.11425D+01, 0.11485D+01, 0.11543D+01, 0.11598D+01,
     & 0.80658D+00, 0.82598D+00, 0.84426D+00, 0.86151D+00, 0.87779D+00,
     & 0.89316D+00, 0.90770D+00, 0.92142D+00, 0.93438D+00, 0.94662D+00,
     & 0.95818D+00, 0.96911D+00, 0.97943D+00, 0.98918D+00, 0.99838D+00,
     & 0.10071D+01, 0.10153D+01, 0.10230D+01, 0.10303D+01, 0.10371D+01,
     & 0.10436D+01, 0.10497D+01, 0.10554D+01, 0.10608D+01, 0.10658D+01,
     & 0.10705D+01, 0.10750D+01, 0.10791D+01, 0.10830D+01, 0.10866D+01,
     & 0.80631D+00, 0.82244D+00, 0.83754D+00, 0.85168D+00, 0.86492D+00,
     & 0.87732D+00, 0.88894D+00, 0.89981D+00, 0.90999D+00, 0.91951D+00,
     & 0.92842D+00, 0.93674D+00, 0.94451D+00, 0.95177D+00, 0.95854D+00,
     & 0.96486D+00, 0.97074D+00, 0.97620D+00, 0.98125D+00, 0.98594D+00,
     & 0.99029D+00, 0.99430D+00, 0.99801D+00, 0.10014D+01, 0.10045D+01,
     & 0.10074D+01, 0.10099D+01, 0.10123D+01, 0.10144D+01, 0.10163D+01,
     & 0.80596D+00, 0.81885D+00, 0.83080D+00, 0.84187D+00, 0.85212D+00,
     & 0.86159D+00, 0.87034D+00, 0.87842D+00, 0.88588D+00, 0.89276D+00,
     & 0.89909D+00, 0.90489D+00, 0.91019D+00, 0.91505D+00, 0.91948D+00,
     & 0.92352D+00, 0.92718D+00, 0.93048D+00, 0.93340D+00, 0.93603D+00,
     & 0.93836D+00, 0.94042D+00, 0.94221D+00, 0.94376D+00, 0.94506D+00,
     & 0.94610D+00, 0.94693D+00, 0.94757D+00, 0.94803D+00, 0.94832D+00/

      data ((g_grdl(i,j),j=1,30),i=21,30)/
     & 0.80549D+00, 0.81514D+00, 0.82393D+00, 0.83194D+00, 0.83921D+00,
     & 0.84579D+00, 0.85170D+00, 0.85703D+00, 0.86182D+00, 0.86611D+00,
     & 0.86991D+00, 0.87324D+00, 0.87613D+00, 0.87866D+00, 0.88082D+00,
     & 0.88266D+00, 0.88417D+00, 0.88538D+00, 0.88626D+00, 0.88690D+00,
     & 0.88730D+00, 0.88749D+00, 0.88746D+00, 0.88724D+00, 0.88682D+00,
     & 0.88616D+00, 0.88536D+00, 0.88440D+00, 0.88332D+00, 0.88210D+00,
     & 0.80426D+00, 0.81060D+00, 0.81620D+00, 0.82111D+00, 0.82538D+00,
     & 0.82905D+00, 0.83211D+00, 0.83469D+00, 0.83681D+00, 0.83851D+00,
     & 0.83981D+00, 0.84069D+00, 0.84121D+00, 0.84143D+00, 0.84137D+00,
     & 0.84104D+00, 0.84046D+00, 0.83963D+00, 0.83852D+00, 0.83724D+00,
     & 0.83578D+00, 0.83415D+00, 0.83237D+00, 0.83045D+00, 0.82838D+00,
     & 0.82611D+00, 0.82374D+00, 0.82128D+00, 0.81872D+00, 0.81608D+00,
     & 0.80325D+00, 0.80621D+00, 0.80854D+00, 0.81030D+00, 0.81153D+00,
     & 0.81225D+00, 0.81243D+00, 0.81223D+00, 0.81167D+00, 0.81077D+00,
     & 0.80956D+00, 0.80800D+00, 0.80616D+00, 0.80409D+00, 0.80182D+00,
     & 0.79936D+00, 0.79672D+00, 0.79388D+00, 0.79083D+00, 0.78766D+00,
     & 0.78439D+00, 0.78101D+00, 0.77753D+00, 0.77397D+00, 0.77031D+00,
     & 0.76650D+00, 0.76263D+00, 0.75873D+00, 0.75478D+00, 0.75079D+00,
     & 0.80222D+00, 0.80162D+00, 0.80052D+00, 0.79897D+00, 0.79701D+00,
     & 0.79464D+00, 0.79183D+00, 0.78874D+00, 0.78540D+00, 0.78182D+00,
     & 0.77803D+00, 0.77397D+00, 0.76970D+00, 0.76530D+00, 0.76079D+00,
     & 0.75617D+00, 0.75144D+00, 0.74659D+00, 0.74159D+00, 0.73655D+00,
     & 0.73146D+00, 0.72634D+00, 0.72119D+00, 0.71601D+00, 0.71080D+00,
     & 0.70547D+00, 0.70016D+00, 0.69486D+00, 0.68956D+00, 0.68428D+00,
     & 0.80002D+00, 0.79545D+00, 0.79055D+00, 0.78535D+00, 0.77988D+00,
     & 0.77414D+00, 0.76805D+00, 0.76183D+00, 0.75548D+00, 0.74902D+00,
     & 0.74246D+00, 0.73573D+00, 0.72888D+00, 0.72202D+00, 0.71514D+00,
     & 0.70826D+00, 0.70136D+00, 0.69443D+00, 0.68741D+00, 0.68044D+00,
     & 0.67351D+00, 0.66662D+00, 0.65978D+00, 0.65298D+00, 0.64622D+00,
     & 0.63940D+00, 0.63266D+00, 0.62599D+00, 0.61940D+00, 0.61287D+00,
     & 0.79934D+00, 0.79372D+00, 0.78782D+00, 0.78167D+00, 0.77528D+00,
     & 0.76867D+00, 0.76173D+00, 0.75469D+00, 0.74757D+00, 0.74037D+00,
     & 0.73310D+00, 0.72568D+00, 0.71818D+00, 0.71069D+00, 0.70322D+00,
     & 0.69576D+00, 0.68832D+00, 0.68087D+00, 0.67335D+00, 0.66590D+00,
     & 0.65852D+00, 0.65120D+00, 0.64395D+00, 0.63676D+00, 0.62962D+00,
     & 0.62245D+00, 0.61537D+00, 0.60838D+00, 0.60148D+00, 0.59466D+00,
     & 0.79861D+00, 0.79193D+00, 0.78503D+00, 0.77791D+00, 0.77061D+00,
     & 0.76311D+00, 0.75532D+00, 0.74748D+00, 0.73959D+00, 0.73165D+00,
     & 0.72368D+00, 0.71558D+00, 0.70744D+00, 0.69933D+00, 0.69128D+00,
     & 0.68326D+00, 0.67529D+00, 0.66732D+00, 0.65932D+00, 0.65141D+00,
     & 0.64359D+00, 0.63585D+00, 0.62820D+00, 0.62063D+00, 0.61314D+00,
     & 0.60562D+00, 0.59822D+00, 0.59092D+00, 0.58372D+00, 0.57663D+00,
     & 0.79781D+00, 0.79008D+00, 0.78216D+00, 0.77407D+00, 0.76585D+00,
     & 0.75747D+00, 0.74883D+00, 0.74017D+00, 0.73151D+00, 0.72283D+00,
     & 0.71416D+00, 0.70539D+00, 0.69660D+00, 0.68789D+00, 0.67925D+00,
     & 0.67068D+00, 0.66218D+00, 0.65372D+00, 0.64524D+00, 0.63688D+00,
     & 0.62863D+00, 0.62048D+00, 0.61245D+00, 0.60451D+00, 0.59667D+00,
     & 0.58883D+00, 0.58111D+00, 0.57352D+00, 0.56605D+00, 0.55869D+00,
     & 0.79695D+00, 0.78812D+00, 0.77917D+00, 0.77011D+00, 0.76095D+00,
     & 0.75167D+00, 0.74218D+00, 0.73271D+00, 0.72327D+00, 0.71386D+00,
     & 0.70448D+00, 0.69505D+00, 0.68562D+00, 0.67630D+00, 0.66709D+00,
     & 0.65798D+00, 0.64896D+00, 0.64001D+00, 0.63106D+00, 0.62226D+00,
     & 0.61359D+00, 0.60505D+00, 0.59664D+00, 0.58835D+00, 0.58018D+00,
     & 0.57202D+00, 0.56401D+00, 0.55614D+00, 0.54840D+00, 0.54080D+00,
     & 0.79599D+00, 0.78607D+00, 0.77606D+00, 0.76600D+00, 0.75589D+00,
     & 0.74572D+00, 0.73535D+00, 0.72506D+00, 0.71483D+00, 0.70468D+00,
     & 0.69461D+00, 0.68450D+00, 0.67444D+00, 0.66451D+00, 0.65473D+00,
     & 0.64508D+00, 0.63555D+00, 0.62611D+00, 0.61671D+00, 0.60747D+00,
     & 0.59840D+00, 0.58947D+00, 0.58070D+00, 0.57207D+00, 0.56358D+00,
     & 0.55512D+00, 0.54682D+00, 0.53869D+00, 0.53070D+00, 0.52287D+00/

      data ((g_grdl(i,j),j=1,30),i=31,40)/
     & 0.79494D+00, 0.78388D+00, 0.77280D+00, 0.76171D+00, 0.75064D+00,
     & 0.73954D+00, 0.72829D+00, 0.71716D+00, 0.70615D+00, 0.69525D+00,
     & 0.68447D+00, 0.67369D+00, 0.66299D+00, 0.65247D+00, 0.64211D+00,
     & 0.63193D+00, 0.62190D+00, 0.61198D+00, 0.60213D+00, 0.59247D+00,
     & 0.58300D+00, 0.57370D+00, 0.56457D+00, 0.55562D+00, 0.54681D+00,
     & 0.53807D+00, 0.52950D+00, 0.52112D+00, 0.51290D+00, 0.50484D+00,
     & 0.79377D+00, 0.78153D+00, 0.76934D+00, 0.75721D+00, 0.74514D+00,
     & 0.73310D+00, 0.72095D+00, 0.70897D+00, 0.69716D+00, 0.68551D+00,
     & 0.67401D+00, 0.66255D+00, 0.65121D+00, 0.64009D+00, 0.62917D+00,
     & 0.61845D+00, 0.60792D+00, 0.59754D+00, 0.58725D+00, 0.57717D+00,
     & 0.56731D+00, 0.55765D+00, 0.54818D+00, 0.53891D+00, 0.52981D+00,
     & 0.52079D+00, 0.51198D+00, 0.50335D+00, 0.49491D+00, 0.48666D+00,
     & 0.79248D+00, 0.77902D+00, 0.76568D+00, 0.75246D+00, 0.73937D+00,
     & 0.72636D+00, 0.71329D+00, 0.70044D+00, 0.68781D+00, 0.67539D+00,
     & 0.66317D+00, 0.65103D+00, 0.63905D+00, 0.62732D+00, 0.61584D+00,
     & 0.60459D+00, 0.59356D+00, 0.58271D+00, 0.57199D+00, 0.56151D+00,
     & 0.55127D+00, 0.54125D+00, 0.53146D+00, 0.52188D+00, 0.51250D+00,
     & 0.50323D+00, 0.49417D+00, 0.48533D+00, 0.47669D+00, 0.46824D+00,
     & 0.79104D+00, 0.77630D+00, 0.76177D+00, 0.74742D+00, 0.73326D+00,
     & 0.71926D+00, 0.70524D+00, 0.69150D+00, 0.67804D+00, 0.66484D+00,
     & 0.65189D+00, 0.63906D+00, 0.62643D+00, 0.61410D+00, 0.60205D+00,
     & 0.59028D+00, 0.57876D+00, 0.56745D+00, 0.55630D+00, 0.54543D+00,
     & 0.53482D+00, 0.52447D+00, 0.51436D+00, 0.50449D+00, 0.49484D+00,
     & 0.48532D+00, 0.47605D+00, 0.46700D+00, 0.45817D+00, 0.44956D+00,
     & 0.78945D+00, 0.77338D+00, 0.75760D+00, 0.74208D+00, 0.72682D+00,
     & 0.71178D+00, 0.69679D+00, 0.68214D+00, 0.66782D+00, 0.65381D+00,
     & 0.64011D+00, 0.62659D+00, 0.61331D+00, 0.60037D+00, 0.58775D+00,
     & 0.57545D+00, 0.56345D+00, 0.55169D+00, 0.54012D+00, 0.52887D+00,
     & 0.51790D+00, 0.50722D+00, 0.49682D+00, 0.48667D+00, 0.47677D+00,
     & 0.46703D+00, 0.45755D+00, 0.44832D+00, 0.43933D+00, 0.43056D+00,
     & 0.78747D+00, 0.76999D+00, 0.75287D+00, 0.73612D+00, 0.71970D+00,
     & 0.70358D+00, 0.68757D+00, 0.67198D+00, 0.65678D+00, 0.64196D+00,
     & 0.62750D+00, 0.61326D+00, 0.59933D+00, 0.58578D+00, 0.57260D+00,
     & 0.55978D+00, 0.54729D+00, 0.53509D+00, 0.52312D+00, 0.51150D+00,
     & 0.50019D+00, 0.48920D+00, 0.47851D+00, 0.46810D+00, 0.45797D+00,
     & 0.44803D+00, 0.43837D+00, 0.42897D+00, 0.41984D+00, 0.41095D+00,
     & 0.78530D+00, 0.76632D+00, 0.74781D+00, 0.72976D+00, 0.71213D+00,
     & 0.69488D+00, 0.67781D+00, 0.66124D+00, 0.64513D+00, 0.62947D+00,
     & 0.61422D+00, 0.59927D+00, 0.58467D+00, 0.57051D+00, 0.55677D+00,
     & 0.54342D+00, 0.53046D+00, 0.51782D+00, 0.50547D+00, 0.49348D+00,
     & 0.48185D+00, 0.47057D+00, 0.45961D+00, 0.44897D+00, 0.43862D+00,
     & 0.42850D+00, 0.41868D+00, 0.40915D+00, 0.39989D+00, 0.39090D+00,
     & 0.78281D+00, 0.76222D+00, 0.74222D+00, 0.72278D+00, 0.70388D+00,
     & 0.68544D+00, 0.66728D+00, 0.64969D+00, 0.63264D+00, 0.61611D+00,
     & 0.60007D+00, 0.58439D+00, 0.56912D+00, 0.55435D+00, 0.54005D+00,
     & 0.52619D+00, 0.51276D+00, 0.49970D+00, 0.48697D+00, 0.47465D+00,
     & 0.46272D+00, 0.45116D+00, 0.43996D+00, 0.42910D+00, 0.41856D+00,
     & 0.40830D+00, 0.39835D+00, 0.38871D+00, 0.37936D+00, 0.37029D+00,
     & 0.77986D+00, 0.75754D+00, 0.73594D+00, 0.71503D+00, 0.69476D+00,
     & 0.67507D+00, 0.65575D+00, 0.63711D+00, 0.61909D+00, 0.60166D+00,
     & 0.58481D+00, 0.56839D+00, 0.55245D+00, 0.53707D+00, 0.52221D+00,
     & 0.50784D+00, 0.49396D+00, 0.48050D+00, 0.46742D+00, 0.45478D+00,
     & 0.44257D+00, 0.43076D+00, 0.41934D+00, 0.40830D+00, 0.39760D+00,
     & 0.38722D+00, 0.37718D+00, 0.36746D+00, 0.35805D+00, 0.34894D+00,
     & 0.77631D+00, 0.75212D+00, 0.72881D+00, 0.70631D+00, 0.68459D+00,
     & 0.66357D+00, 0.64304D+00, 0.62328D+00, 0.60425D+00, 0.58590D+00,
     & 0.56820D+00, 0.55103D+00, 0.53442D+00, 0.51843D+00, 0.50301D+00,
     & 0.48816D+00, 0.47383D+00, 0.45999D+00, 0.44659D+00, 0.43367D+00,
     & 0.42121D+00, 0.40919D+00, 0.39758D+00, 0.38638D+00, 0.37557D+00,
     & 0.36511D+00, 0.35501D+00, 0.34526D+00, 0.33583D+00, 0.32672D+00/

      data ((g_grdl(i,j),j=1,30),i=41,50)/
     & 0.77204D+00, 0.74579D+00, 0.72059D+00, 0.69638D+00, 0.67309D+00,
     & 0.65065D+00, 0.62885D+00, 0.60794D+00, 0.58786D+00, 0.56856D+00,
     & 0.55000D+00, 0.53208D+00, 0.51481D+00, 0.49822D+00, 0.48228D+00,
     & 0.46695D+00, 0.45221D+00, 0.43802D+00, 0.42433D+00, 0.41116D+00,
     & 0.39849D+00, 0.38630D+00, 0.37455D+00, 0.36324D+00, 0.35235D+00,
     & 0.34186D+00, 0.33176D+00, 0.32201D+00, 0.31261D+00, 0.30354D+00,
     & 0.76674D+00, 0.73824D+00, 0.71099D+00, 0.68491D+00, 0.65994D+00,
     & 0.63597D+00, 0.61283D+00, 0.59069D+00, 0.56951D+00, 0.54922D+00,
     & 0.52979D+00, 0.51111D+00, 0.49318D+00, 0.47601D+00, 0.45956D+00,
     & 0.44378D+00, 0.42866D+00, 0.41415D+00, 0.40023D+00, 0.38686D+00,
     & 0.37404D+00, 0.36172D+00, 0.34989D+00, 0.33852D+00, 0.32761D+00,
     & 0.31716D+00, 0.30711D+00, 0.29744D+00, 0.28813D+00, 0.27916D+00,
     & 0.76000D+00, 0.72898D+00, 0.69945D+00, 0.67133D+00, 0.64451D+00,
     & 0.61890D+00, 0.59434D+00, 0.57094D+00, 0.54862D+00, 0.52734D+00,
     & 0.50702D+00, 0.48760D+00, 0.46905D+00, 0.45133D+00, 0.43441D+00,
     & 0.41824D+00, 0.40278D+00, 0.38802D+00, 0.37393D+00, 0.36045D+00,
     & 0.34753D+00, 0.33516D+00, 0.32332D+00, 0.31197D+00, 0.30111D+00,
     & 0.29078D+00, 0.28086D+00, 0.27133D+00, 0.26219D+00, 0.25340D+00,
     & 0.75112D+00, 0.71727D+00, 0.68521D+00, 0.65482D+00, 0.62598D+00,
     & 0.59860D+00, 0.57254D+00, 0.54781D+00, 0.52433D+00, 0.50202D+00,
     & 0.48082D+00, 0.46070D+00, 0.44158D+00, 0.42338D+00, 0.40606D+00,
     & 0.38956D+00, 0.37386D+00, 0.35893D+00, 0.34478D+00, 0.33128D+00,
     & 0.31839D+00, 0.30607D+00, 0.29432D+00, 0.28309D+00, 0.27239D+00,
     & 0.26228D+00, 0.25261D+00, 0.24334D+00, 0.23445D+00, 0.22595D+00,
     & 0.73856D+00, 0.70151D+00, 0.66660D+00, 0.63369D+00, 0.60266D+00,
     & 0.57338D+00, 0.54580D+00, 0.51974D+00, 0.49510D+00, 0.47182D+00,
     & 0.44981D+00, 0.42909D+00, 0.40952D+00, 0.39097D+00, 0.37338D+00,
     & 0.35670D+00, 0.34089D+00, 0.32595D+00, 0.31191D+00, 0.29854D+00,
     & 0.28582D+00, 0.27372D+00, 0.26221D+00, 0.25125D+00, 0.24085D+00,
     & 0.23112D+00, 0.22183D+00, 0.21295D+00, 0.20447D+00, 0.19637D+00,
     & 0.72073D+00, 0.67995D+00, 0.64179D+00, 0.60607D+00, 0.57263D+00,
     & 0.54137D+00, 0.51235D+00, 0.48506D+00, 0.45941D+00, 0.43530D+00,
     & 0.41263D+00, 0.39151D+00, 0.37173D+00, 0.35304D+00, 0.33541D+00,
     & 0.31876D+00, 0.30304D+00, 0.28830D+00, 0.27458D+00, 0.26156D+00,
     & 0.24922D+00, 0.23752D+00, 0.22644D+00, 0.21594D+00, 0.20601D+00,
     & 0.19684D+00, 0.18811D+00, 0.17979D+00, 0.17187D+00, 0.16433D+00,
     & 0.69515D+00, 0.65115D+00, 0.61012D+00, 0.57185D+00, 0.53616D+00,
     & 0.50293D+00, 0.47215D+00, 0.44338D+00, 0.41648D+00, 0.39135D+00,
     & 0.36789D+00, 0.34625D+00, 0.32615D+00, 0.30728D+00, 0.28958D+00,
     & 0.27299D+00, 0.25745D+00, 0.24302D+00, 0.22980D+00, 0.21733D+00,
     & 0.20557D+00, 0.19449D+00, 0.18405D+00, 0.17424D+00, 0.16504D+00,
     & 0.15671D+00, 0.14882D+00, 0.14134D+00, 0.13425D+00, 0.12754D+00,
     & 0.66986D+00, 0.61402D+00, 0.56298D+00, 0.51641D+00, 0.47400D+00,
     & 0.43569D+00, 0.40235D+00, 0.37162D+00, 0.34334D+00, 0.31735D+00,
     & 0.29353D+00, 0.27244D+00, 0.25346D+00, 0.23582D+00, 0.21945D+00,
     & 0.20428D+00, 0.19026D+00, 0.17752D+00, 0.16627D+00, 0.15574D+00,
     & 0.14588D+00, 0.13667D+00, 0.12808D+00, 0.12006D+00, 0.11264D+00,
     & 0.10617D+00, 0.10007D+00, 0.94319D-01, 0.88902D-01, 0.83806D-01,
     & 0.47111D+00, 0.42420D+00, 0.38182D+00, 0.34364D+00, 0.30938D+00,
     & 0.27906D+00, 0.25381D+00, 0.23076D+00, 0.20978D+00, 0.19074D+00,
     & 0.17351D+00, 0.15878D+00, 0.14586D+00, 0.13396D+00, 0.12301D+00,
     & 0.11296D+00, 0.10377D+00, 0.95588D-01, 0.88621D-01, 0.82135D-01,
     & 0.76107D-01, 0.70514D-01, 0.65336D-01, 0.60554D-01, 0.56175D-01,
     & 0.52507D-01, 0.49063D-01, 0.45834D-01, 0.42810D-01, 0.39983D-01,
     & 0.30227D-01, 0.26950D-01, 0.24004D-01, 0.21366D-01, 0.19013D-01,
     & 0.16949D-01, 0.15266D-01, 0.13738D-01, 0.12353D-01, 0.11105D-01,
     & 0.99836D-02, 0.90418D-02, 0.82281D-02, 0.74817D-02, 0.67988D-02,
     & 0.61759D-02, 0.56099D-02, 0.51118D-02, 0.46976D-02, 0.43136D-02,
     & 0.39583D-02, 0.36304D-02, 0.33286D-02, 0.30515D-02, 0.27999D-02,
     & 0.25953D-02, 0.24039D-02, 0.22252D-02, 0.20587D-02, 0.19037D-02/

      data ((c_grdl(i,j),j=1,30),i=1,10)/
     & 0.21356D-02, 0.21381D-02, 0.21403D-02, 0.21422D-02, 0.21438D-02,
     & 0.21453D-02, 0.21466D-02, 0.21478D-02, 0.21488D-02, 0.21497D-02,
     & 0.21504D-02, 0.21511D-02, 0.21518D-02, 0.21523D-02, 0.21528D-02,
     & 0.21532D-02, 0.21536D-02, 0.21539D-02, 0.21542D-02, 0.21545D-02,
     & 0.21547D-02, 0.21549D-02, 0.21551D-02, 0.21552D-02, 0.21554D-02,
     & 0.21555D-02, 0.21556D-02, 0.21557D-02, 0.21558D-02, 0.21559D-02,
     & 0.21289D-02, 0.21318D-02, 0.21344D-02, 0.21367D-02, 0.21387D-02,
     & 0.21405D-02, 0.21420D-02, 0.21434D-02, 0.21446D-02, 0.21457D-02,
     & 0.21466D-02, 0.21474D-02, 0.21482D-02, 0.21488D-02, 0.21494D-02,
     & 0.21499D-02, 0.21504D-02, 0.21508D-02, 0.21511D-02, 0.21514D-02,
     & 0.21517D-02, 0.21519D-02, 0.21521D-02, 0.21523D-02, 0.21525D-02,
     & 0.21527D-02, 0.21528D-02, 0.21529D-02, 0.21530D-02, 0.21531D-02,
     & 0.21207D-02, 0.21242D-02, 0.21274D-02, 0.21301D-02, 0.21325D-02,
     & 0.21346D-02, 0.21365D-02, 0.21382D-02, 0.21396D-02, 0.21409D-02,
     & 0.21420D-02, 0.21430D-02, 0.21439D-02, 0.21447D-02, 0.21454D-02,
     & 0.21460D-02, 0.21465D-02, 0.21470D-02, 0.21474D-02, 0.21478D-02,
     & 0.21481D-02, 0.21484D-02, 0.21486D-02, 0.21489D-02, 0.21491D-02,
     & 0.21492D-02, 0.21494D-02, 0.21495D-02, 0.21497D-02, 0.21498D-02,
     & 0.21108D-02, 0.21151D-02, 0.21189D-02, 0.21222D-02, 0.21251D-02,
     & 0.21277D-02, 0.21299D-02, 0.21319D-02, 0.21336D-02, 0.21352D-02,
     & 0.21365D-02, 0.21377D-02, 0.21388D-02, 0.21397D-02, 0.21405D-02,
     & 0.21412D-02, 0.21419D-02, 0.21425D-02, 0.21430D-02, 0.21434D-02,
     & 0.21438D-02, 0.21441D-02, 0.21445D-02, 0.21447D-02, 0.21450D-02,
     & 0.21452D-02, 0.21454D-02, 0.21455D-02, 0.21457D-02, 0.21458D-02,
     & 0.20989D-02, 0.21041D-02, 0.21087D-02, 0.21127D-02, 0.21162D-02,
     & 0.21192D-02, 0.21220D-02, 0.21243D-02, 0.21264D-02, 0.21283D-02,
     & 0.21299D-02, 0.21313D-02, 0.21326D-02, 0.21337D-02, 0.21347D-02,
     & 0.21356D-02, 0.21364D-02, 0.21370D-02, 0.21376D-02, 0.21382D-02,
     & 0.21387D-02, 0.21391D-02, 0.21394D-02, 0.21398D-02, 0.21401D-02,
     & 0.21403D-02, 0.21405D-02, 0.21407D-02, 0.21409D-02, 0.21411D-02,
     & 0.20844D-02, 0.20907D-02, 0.20962D-02, 0.21011D-02, 0.21053D-02,
     & 0.21091D-02, 0.21124D-02, 0.21152D-02, 0.21178D-02, 0.21200D-02,
     & 0.21220D-02, 0.21237D-02, 0.21252D-02, 0.21266D-02, 0.21277D-02,
     & 0.21288D-02, 0.21297D-02, 0.21305D-02, 0.21313D-02, 0.21319D-02,
     & 0.21325D-02, 0.21330D-02, 0.21334D-02, 0.21338D-02, 0.21342D-02,
     & 0.21345D-02, 0.21347D-02, 0.21350D-02, 0.21352D-02, 0.21354D-02,
     & 0.20933D-02, 0.20209D-02, 0.19139D-02, 0.20871D-02, 0.20922D-02,
     & 0.20968D-02, 0.21007D-02, 0.21042D-02, 0.21073D-02, 0.21100D-02,
     & 0.21124D-02, 0.21144D-02, 0.21163D-02, 0.21179D-02, 0.21193D-02,
     & 0.21206D-02, 0.21217D-02, 0.21227D-02, 0.21236D-02, 0.21244D-02,
     & 0.21250D-02, 0.21256D-02, 0.21262D-02, 0.21267D-02, 0.21271D-02,
     & 0.21274D-02, 0.21278D-02, 0.21281D-02, 0.21283D-02, 0.21285D-02,
     & 0.22187D-02, 0.21723D-02, 0.21220D-02, 0.20657D-02, 0.19982D-02,
     & 0.18971D-02, 0.20866D-02, 0.20909D-02, 0.20946D-02, 0.20979D-02,
     & 0.21007D-02, 0.21033D-02, 0.21055D-02, 0.21075D-02, 0.21092D-02,
     & 0.21107D-02, 0.21121D-02, 0.21133D-02, 0.21143D-02, 0.21153D-02,
     & 0.21161D-02, 0.21168D-02, 0.21175D-02, 0.21180D-02, 0.21185D-02,
     & 0.21190D-02, 0.21194D-02, 0.21197D-02, 0.21200D-02, 0.21203D-02,
     & 0.23122D-02, 0.22763D-02, 0.22389D-02, 0.22001D-02, 0.21595D-02,
     & 0.21167D-02, 0.20705D-02, 0.20187D-02, 0.19554D-02, 0.20972D-02,
     & 0.20866D-02, 0.20897D-02, 0.20924D-02, 0.20948D-02, 0.20969D-02,
     & 0.20988D-02, 0.21004D-02, 0.21019D-02, 0.21031D-02, 0.21043D-02,
     & 0.21053D-02, 0.21061D-02, 0.21069D-02, 0.21076D-02, 0.21082D-02,
     & 0.21088D-02, 0.21092D-02, 0.21097D-02, 0.21100D-02, 0.21104D-02,
     & 0.23860D-02, 0.23576D-02, 0.23281D-02, 0.22977D-02, 0.22666D-02,
     & 0.22352D-02, 0.22033D-02, 0.21710D-02, 0.21383D-02, 0.21049D-02,
     & 0.20705D-02, 0.20344D-02, 0.19953D-02, 0.19506D-02, 0.18917D-02,
     & 0.20842D-02, 0.20862D-02, 0.20880D-02, 0.20895D-02, 0.20909D-02,
     & 0.20921D-02, 0.20932D-02, 0.20941D-02, 0.20950D-02, 0.20957D-02,
     & 0.20964D-02, 0.20970D-02, 0.20975D-02, 0.20979D-02, 0.20983D-02/

      data ((c_grdl(i,j),j=1,30),i=11,20)/
     & 0.24430D-02, 0.24215D-02, 0.23985D-02, 0.23746D-02, 0.23500D-02,
     & 0.23251D-02, 0.23001D-02, 0.22753D-02, 0.22509D-02, 0.22268D-02,
     & 0.22033D-02, 0.21803D-02, 0.21580D-02, 0.21362D-02, 0.21151D-02,
     & 0.20946D-02, 0.20747D-02, 0.20553D-02, 0.20365D-02, 0.20180D-02,
     & 0.20000D-02, 0.19822D-02, 0.19645D-02, 0.19468D-02, 0.19288D-02,
     & 0.19101D-02, 0.18900D-02, 0.18668D-02, 0.20949D-02, 0.20837D-02,
     & 0.24818D-02, 0.24681D-02, 0.24521D-02, 0.24344D-02, 0.24156D-02,
     & 0.23962D-02, 0.23765D-02, 0.23569D-02, 0.23375D-02, 0.23185D-02,
     & 0.23001D-02, 0.22824D-02, 0.22655D-02, 0.22493D-02, 0.22340D-02,
     & 0.22196D-02, 0.22061D-02, 0.21934D-02, 0.21816D-02, 0.21707D-02,
     & 0.21605D-02, 0.21511D-02, 0.21425D-02, 0.21346D-02, 0.21273D-02,
     & 0.21207D-02, 0.21147D-02, 0.21092D-02, 0.21042D-02, 0.20997D-02,
     & 0.24989D-02, 0.24948D-02, 0.24870D-02, 0.24765D-02, 0.24641D-02,
     & 0.24504D-02, 0.24359D-02, 0.24209D-02, 0.24058D-02, 0.23910D-02,
     & 0.23765D-02, 0.23625D-02, 0.23491D-02, 0.23363D-02, 0.23242D-02,
     & 0.23129D-02, 0.23023D-02, 0.22925D-02, 0.22834D-02, 0.22750D-02,
     & 0.22674D-02, 0.22603D-02, 0.22539D-02, 0.22481D-02, 0.22428D-02,
     & 0.22380D-02, 0.22337D-02, 0.22298D-02, 0.22263D-02, 0.22232D-02,
     & 0.24894D-02, 0.24970D-02, 0.24993D-02, 0.24977D-02, 0.24930D-02,
     & 0.24861D-02, 0.24775D-02, 0.24678D-02, 0.24574D-02, 0.24467D-02,
     & 0.24359D-02, 0.24252D-02, 0.24148D-02, 0.24049D-02, 0.23955D-02,
     & 0.23866D-02, 0.23782D-02, 0.23705D-02, 0.23633D-02, 0.23567D-02,
     & 0.23506D-02, 0.23450D-02, 0.23399D-02, 0.23353D-02, 0.23311D-02,
     & 0.23274D-02, 0.23240D-02, 0.23209D-02, 0.23181D-02, 0.23157D-02,
     & 0.24473D-02, 0.24691D-02, 0.24839D-02, 0.24932D-02, 0.24980D-02,
     & 0.24993D-02, 0.24980D-02, 0.24946D-02, 0.24898D-02, 0.24839D-02,
     & 0.24775D-02, 0.24706D-02, 0.24636D-02, 0.24567D-02, 0.24499D-02,
     & 0.24434D-02, 0.24372D-02, 0.24313D-02, 0.24258D-02, 0.24207D-02,
     & 0.24160D-02, 0.24117D-02, 0.24077D-02, 0.24042D-02, 0.24009D-02,
     & 0.23979D-02, 0.23953D-02, 0.23929D-02, 0.23907D-02, 0.23888D-02,
     & 0.23655D-02, 0.24045D-02, 0.24346D-02, 0.24571D-02, 0.24736D-02,
     & 0.24851D-02, 0.24927D-02, 0.24971D-02, 0.24991D-02, 0.24992D-02,
     & 0.24980D-02, 0.24957D-02, 0.24928D-02, 0.24894D-02, 0.24858D-02,
     & 0.24820D-02, 0.24783D-02, 0.24746D-02, 0.24710D-02, 0.24676D-02,
     & 0.24645D-02, 0.24615D-02, 0.24587D-02, 0.24562D-02, 0.24539D-02,
     & 0.24517D-02, 0.24498D-02, 0.24480D-02, 0.24464D-02, 0.24450D-02,
     & 0.22364D-02, 0.22959D-02, 0.23441D-02, 0.23827D-02, 0.24132D-02,
     & 0.24371D-02, 0.24555D-02, 0.24695D-02, 0.24799D-02, 0.24874D-02,
     & 0.24927D-02, 0.24961D-02, 0.24981D-02, 0.24991D-02, 0.24993D-02,
     & 0.24990D-02, 0.24982D-02, 0.24971D-02, 0.24959D-02, 0.24946D-02,
     & 0.24932D-02, 0.24918D-02, 0.24904D-02, 0.24892D-02, 0.24879D-02,
     & 0.24868D-02, 0.24857D-02, 0.24847D-02, 0.24838D-02, 0.24830D-02,
     & 0.20566D-02, 0.21376D-02, 0.22048D-02, 0.22622D-02, 0.23096D-02,
     & 0.23483D-02, 0.23799D-02, 0.24054D-02, 0.24260D-02, 0.24424D-02,
     & 0.24555D-02, 0.24659D-02, 0.24741D-02, 0.24805D-02, 0.24854D-02,
     & 0.24892D-02, 0.24921D-02, 0.24943D-02, 0.24959D-02, 0.24971D-02,
     & 0.24980D-02, 0.24985D-02, 0.24989D-02, 0.24992D-02, 0.24993D-02,
     & 0.24993D-02, 0.24993D-02, 0.24993D-02, 0.24992D-02, 0.24991D-02,
     & 0.18146D-02, 0.19227D-02, 0.20142D-02, 0.20916D-02, 0.21564D-02,
     & 0.22110D-02, 0.22580D-02, 0.22973D-02, 0.23300D-02, 0.23573D-02,
     & 0.23799D-02, 0.23986D-02, 0.24142D-02, 0.24271D-02, 0.24378D-02,
     & 0.24467D-02, 0.24541D-02, 0.24603D-02, 0.24654D-02, 0.24697D-02,
     & 0.24733D-02, 0.24763D-02, 0.24788D-02, 0.24809D-02, 0.24827D-02,
     & 0.24842D-02, 0.24855D-02, 0.24866D-02, 0.24876D-02, 0.24884D-02,
     & 0.23599D-02, 0.22672D-02, 0.17590D-02, 0.18610D-02, 0.19482D-02,
     & 0.20225D-02, 0.20858D-02, 0.21395D-02, 0.21849D-02, 0.22242D-02,
     & 0.22580D-02, 0.22867D-02, 0.23112D-02, 0.23319D-02, 0.23496D-02,
     & 0.23646D-02, 0.23774D-02, 0.23883D-02, 0.23977D-02, 0.24057D-02,
     & 0.24126D-02, 0.24185D-02, 0.24236D-02, 0.24280D-02, 0.24319D-02,
     & 0.24352D-02, 0.24380D-02, 0.24406D-02, 0.24427D-02, 0.24446D-02/

      data ((c_grdl(i,j),j=1,30),i=21,30)/
     & 0.20932D-02, 0.22643D-02, 0.23511D-02, 0.23430D-02, 0.22061D-02,
     & 0.17698D-02, 0.18533D-02, 0.19252D-02, 0.19870D-02, 0.20402D-02,
     & 0.20859D-02, 0.21251D-02, 0.21587D-02, 0.21875D-02, 0.22128D-02,
     & 0.22350D-02, 0.22542D-02, 0.22708D-02, 0.22852D-02, 0.22977D-02,
     & 0.23085D-02, 0.23180D-02, 0.23262D-02, 0.23334D-02, 0.23396D-02,
     & 0.23451D-02, 0.23499D-02, 0.23541D-02, 0.23578D-02, 0.23610D-02,
     & 0.21884D-02, 0.22139D-02, 0.21873D-02, 0.21732D-02, 0.22952D-02,
     & 0.23548D-02, 0.23477D-02, 0.22622D-02, 0.20343D-02, 0.17930D-02,
     & 0.18533D-02, 0.19057D-02, 0.19512D-02, 0.19906D-02, 0.20250D-02,
     & 0.20548D-02, 0.20807D-02, 0.21033D-02, 0.21230D-02, 0.21401D-02,
     & 0.21551D-02, 0.21681D-02, 0.21795D-02, 0.21895D-02, 0.21983D-02,
     & 0.22063D-02, 0.22133D-02, 0.22195D-02, 0.22249D-02, 0.22297D-02,
     & 0.12386D-02, 0.17985D-02, 0.21588D-02, 0.21913D-02, 0.21797D-02,
     & 0.21633D-02, 0.21606D-02, 0.22676D-02, 0.23331D-02, 0.23597D-02,
     & 0.23477D-02, 0.22962D-02, 0.21971D-02, 0.20072D-02, 0.17730D-02,
     & 0.18122D-02, 0.18465D-02, 0.18766D-02, 0.19029D-02, 0.19260D-02,
     & 0.19463D-02, 0.19641D-02, 0.19797D-02, 0.19935D-02, 0.20056D-02,
     & 0.20162D-02, 0.20256D-02, 0.20339D-02, 0.20412D-02, 0.20476D-02,
     & 0.82716D-05, 0.40190D-03, 0.95340D-03, 0.14829D-02, 0.19187D-02,
     & 0.21767D-02, 0.22070D-02, 0.22140D-02, 0.22100D-02, 0.20533D-02,
     & 0.21606D-02, 0.22414D-02, 0.22986D-02, 0.23359D-02, 0.23558D-02,
     & 0.23601D-02, 0.23512D-02, 0.23307D-02, 0.23003D-02, 0.22605D-02,
     & 0.22116D-02, 0.21525D-02, 0.20799D-02, 0.19831D-02, 0.17477D-02,
     & 0.17616D-02, 0.17739D-02, 0.17847D-02, 0.17943D-02, 0.18028D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.12116D-03, 0.54261D-03,
     & 0.10084D-02, 0.14425D-02, 0.18110D-02, 0.20769D-02, 0.21939D-02,
     & 0.22069D-02, 0.22042D-02, 0.21836D-02, 0.22099D-02, 0.21530D-02,
     & 0.20888D-02, 0.21491D-02, 0.21981D-02, 0.22374D-02, 0.22686D-02,
     & 0.22931D-02, 0.23121D-02, 0.23269D-02, 0.23381D-02, 0.23463D-02,
     & 0.23521D-02, 0.23560D-02, 0.23585D-02, 0.23599D-02, 0.23604D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.23286D-03,
     & 0.65780D-03, 0.10971D-02, 0.14981D-02, 0.18336D-02, 0.20761D-02,
     & 0.21938D-02, 0.22122D-02, 0.21872D-02, 0.22093D-02, 0.22030D-02,
     & 0.22043D-02, 0.21187D-02, 0.20885D-02, 0.21381D-02, 0.21793D-02,
     & 0.22131D-02, 0.22409D-02, 0.22635D-02, 0.22819D-02, 0.22969D-02,
     & 0.23091D-02, 0.23191D-02, 0.23272D-02, 0.23338D-02, 0.23390D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.26676D-04,
     & 0.34522D-03, 0.75878D-03, 0.11672D-02, 0.15369D-02, 0.18431D-02,
     & 0.20670D-02, 0.21880D-02, 0.22067D-02, 0.21607D-02, 0.22110D-02,
     & 0.21802D-02, 0.22077D-02, 0.22025D-02, 0.21418D-02, 0.20700D-02,
     & 0.21116D-02, 0.21468D-02, 0.21763D-02, 0.22012D-02, 0.22221D-02,
     & 0.22397D-02, 0.22545D-02, 0.22669D-02, 0.22774D-02, 0.22863D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.97572D-04, 0.44784D-03, 0.84266D-03, 0.12206D-02, 0.15594D-02,
     & 0.18400D-02, 0.20491D-02, 0.21740D-02, 0.21898D-02, 0.22014D-02,
     & 0.21895D-02, 0.22140D-02, 0.21854D-02, 0.22070D-02, 0.22075D-02,
     & 0.21817D-02, 0.20863D-02, 0.20707D-02, 0.21010D-02, 0.21269D-02,
     & 0.21491D-02, 0.21681D-02, 0.21844D-02, 0.21984D-02, 0.22105D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.18298D-03, 0.53604D-03, 0.90775D-03, 0.12560D-02,
     & 0.15664D-02, 0.18246D-02, 0.20217D-02, 0.21504D-02, 0.21880D-02,
     & 0.22107D-02, 0.21511D-02, 0.21976D-02, 0.22140D-02, 0.21792D-02,
     & 0.22008D-02, 0.22097D-02, 0.22061D-02, 0.21887D-02, 0.21509D-02,
     & 0.20423D-02, 0.20649D-02, 0.20845D-02, 0.21014D-02, 0.21162D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.16949D-04, 0.26564D-03, 0.60742D-03, 0.95417D-03,
     & 0.12740D-02, 0.15585D-02, 0.17969D-02, 0.19839D-02, 0.21153D-02,
     & 0.21880D-02, 0.21879D-02, 0.22120D-02, 0.21554D-02, 0.21936D-02,
     & 0.22124D-02, 0.22068D-02, 0.21844D-02, 0.21994D-02, 0.22078D-02,
     & 0.22100D-02, 0.22067D-02, 0.21983D-02, 0.21847D-02, 0.21651D-02/

      data ((c_grdl(i,j),j=1,30),i=31,40)/
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.63312D-04, 0.33792D-03, 0.66112D-03,
     & 0.98240D-03, 0.12755D-02, 0.15364D-02, 0.17570D-02, 0.19348D-02,
     & 0.20676D-02, 0.21557D-02, 0.21944D-02, 0.21939D-02, 0.22122D-02,
     & 0.21591D-02, 0.21775D-02, 0.22007D-02, 0.22125D-02, 0.22121D-02,
     & 0.21837D-02, 0.21852D-02, 0.21953D-02, 0.22023D-02, 0.22069D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.11810D-03, 0.39558D-03,
     & 0.69758D-03, 0.99323D-03, 0.12612D-02, 0.15003D-02, 0.17048D-02,
     & 0.18736D-02, 0.20061D-02, 0.21032D-02, 0.21668D-02, 0.21944D-02,
     & 0.21864D-02, 0.22090D-02, 0.22087D-02, 0.21458D-02, 0.21714D-02,
     & 0.21902D-02, 0.22031D-02, 0.22109D-02, 0.22139D-02, 0.22124D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.32897D-05, 0.16902D-03,
     & 0.43732D-03, 0.71688D-03, 0.98757D-03, 0.12320D-02, 0.14509D-02,
     & 0.16407D-02, 0.18000D-02, 0.19301D-02, 0.20321D-02, 0.21079D-02,
     & 0.21603D-02, 0.21901D-02, 0.21826D-02, 0.21915D-02, 0.22074D-02,
     & 0.22121D-02, 0.22037D-02, 0.21587D-02, 0.21595D-02, 0.21732D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.22166D-04,
     & 0.20975D-03, 0.46281D-03, 0.71943D-03, 0.96635D-03, 0.11886D-02,
     & 0.13891D-02, 0.15645D-02, 0.17141D-02, 0.18399D-02, 0.19429D-02,
     & 0.20252D-02, 0.20888D-02, 0.21363D-02, 0.21693D-02, 0.21894D-02,
     & 0.21934D-02, 0.21745D-02, 0.21911D-02, 0.22025D-02, 0.22093D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.46067D-04, 0.23758D-03, 0.47232D-03, 0.70609D-03, 0.93054D-03,
     & 0.11329D-02, 0.13154D-02, 0.14764D-02, 0.16165D-02, 0.17361D-02,
     & 0.18373D-02, 0.19215D-02, 0.19906D-02, 0.20464D-02, 0.20907D-02,
     & 0.21255D-02, 0.21520D-02, 0.21714D-02, 0.21850D-02, 0.21926D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.66707D-04, 0.25174D-03, 0.46668D-03, 0.67845D-03,
     & 0.88123D-03, 0.10653D-02, 0.12302D-02, 0.13779D-02, 0.15076D-02,
     & 0.16202D-02, 0.17171D-02, 0.18000D-02, 0.18704D-02, 0.19296D-02,
     & 0.19792D-02, 0.20205D-02, 0.20546D-02, 0.20828D-02, 0.21059D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.79894D-04, 0.25238D-03, 0.44698D-03,
     & 0.63782D-03, 0.81954D-03, 0.98658D-03, 0.11354D-02, 0.12696D-02,
     & 0.13885D-02, 0.14933D-02, 0.15848D-02, 0.16639D-02, 0.17326D-02,
     & 0.17918D-02, 0.18427D-02, 0.18864D-02, 0.19238D-02, 0.19557D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.70623D-06, 0.84020D-04, 0.24041D-03,
     & 0.41466D-03, 0.58557D-03, 0.74686D-03, 0.89736D-03, 0.10326D-02,
     & 0.11527D-02, 0.12611D-02, 0.13572D-02, 0.14417D-02, 0.15164D-02,
     & 0.15817D-02, 0.16385D-02, 0.16880D-02, 0.17314D-02, 0.17691D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.17825D-05, 0.79147D-04,
     & 0.21723D-03, 0.37119D-03, 0.52293D-03, 0.66548D-03, 0.79925D-03,
     & 0.92124D-03, 0.10303D-02, 0.11271D-02, 0.12137D-02, 0.12915D-02,
     & 0.13600D-02, 0.14203D-02, 0.14738D-02, 0.15209D-02, 0.15623D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.15209D-05,
     & 0.66546D-04, 0.18475D-03, 0.31857D-03, 0.45183D-03, 0.57790D-03,
     & 0.69433D-03, 0.80282D-03, 0.90097D-03, 0.98874D-03, 0.10666D-02,
     & 0.11357D-02, 0.11974D-02, 0.12529D-02, 0.13020D-02, 0.13453D-02/

      data ((c_grdl(i,j),j=1,30),i=41,50)/
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.33293D-06, 0.48504D-04, 0.14534D-03, 0.25894D-03, 0.37417D-03,
     & 0.48430D-03, 0.58657D-03, 0.68015D-03, 0.76668D-03, 0.84516D-03,
     & 0.91538D-03, 0.97800D-03, 0.10335D-02, 0.10828D-02, 0.11264D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.28330D-04, 0.10237D-03, 0.19547D-03,
     & 0.29259D-03, 0.38703D-03, 0.47578D-03, 0.55751D-03, 0.63180D-03,
     & 0.69930D-03, 0.76128D-03, 0.81705D-03, 0.86689D-03, 0.91128D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.10434D-04, 0.60258D-04,
     & 0.13162D-03, 0.21040D-03, 0.28911D-03, 0.36435D-03, 0.43438D-03,
     & 0.49864D-03, 0.55720D-03, 0.60994D-03, 0.65731D-03, 0.70027D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.46510D-06,
     & 0.24751D-04, 0.72876D-04, 0.13208D-03, 0.19454D-03, 0.25582D-03,
     & 0.31415D-03, 0.36832D-03, 0.41805D-03, 0.46327D-03, 0.50404D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.30285D-05, 0.26579D-04, 0.64402D-04, 0.10899D-03,
     & 0.15563D-03, 0.20147D-03, 0.24499D-03, 0.28566D-03, 0.32313D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.17265D-05, 0.16708D-04,
     & 0.41547D-04, 0.71479D-04, 0.10342D-03, 0.13540D-03, 0.16625D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.38338D-05, 0.15388D-04, 0.31512D-04, 0.50005D-04,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.28207D-06,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00/

      DO I=1,50
        DO J=1,30
          UDS_GRD(I,J) = UDS_GRDL(I,J)
          G_GRD(I,J)   = G_GRDL(I,J)
          C_GRD(I,J)   = C_GRDL(I,J)
        ENDDO
      ENDDO

      RETURN
      END
*CMZ :  2.06/29 23/06/99  12.57.26  by  Hannes Jung
*CMZ :  2.06/17 11/08/97  140.2 71/6
*-- Author :
      SUBROUTINE I_LO_Q3G3
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NQ2MAX=30,NZMAX=50)
      DIMENSION UDS_GRD(NZMAX,NQ2MAX),C_GRD(NZMAX,NQ2MAX),
     &          G_GRD(NZMAX,NQ2MAX)
      DIMENSION UDS_GRDL(NZMAX,NQ2MAX),C_GRDL(NZMAX,NQ2MAX),
     &          G_GRDL(NZMAX,NQ2MAX)
      COMMON /CPARAM/ UDS_GRD,C_GRD,G_GRD

      data ((uds_grdl(i,j),j=1,30),i=1,10)/
     & 0.87730D-03, 0.24960D-02, 0.41586D-02, 0.58604D-02, 0.75974D-02,
     & 0.93648D-02, 0.11154D-01, 0.12973D-01, 0.14817D-01, 0.16684D-01,
     & 0.18572D-01, 0.20475D-01, 0.22393D-01, 0.24329D-01, 0.26279D-01,
     & 0.28242D-01, 0.30217D-01, 0.32201D-01, 0.34193D-01, 0.36193D-01,
     & 0.38202D-01, 0.40216D-01, 0.42236D-01, 0.44261D-01, 0.46290D-01,
     & 0.48322D-01, 0.50356D-01, 0.52392D-01, 0.54430D-01, 0.56468D-01,
     & 0.91285D-03, 0.25022D-02, 0.41289D-02, 0.57889D-02, 0.74787D-02,
     & 0.91941D-02, 0.10929D-01, 0.12687D-01, 0.14466D-01, 0.16263D-01,
     & 0.18077D-01, 0.19904D-01, 0.21743D-01, 0.23595D-01, 0.25458D-01,
     & 0.27330D-01, 0.29211D-01, 0.31099D-01, 0.32992D-01, 0.34891D-01,
     & 0.36795D-01, 0.38702D-01, 0.40613D-01, 0.42526D-01, 0.44440D-01,
     & 0.46357D-01, 0.48273D-01, 0.50189D-01, 0.52105D-01, 0.54019D-01,
     & 0.95550D-03, 0.25132D-02, 0.41022D-02, 0.57190D-02, 0.73603D-02,
     & 0.90227D-02, 0.10701D-01, 0.12398D-01, 0.14112D-01, 0.15840D-01,
     & 0.17581D-01, 0.19332D-01, 0.21093D-01, 0.22862D-01, 0.24639D-01,
     & 0.26422D-01, 0.28211D-01, 0.30005D-01, 0.31802D-01, 0.33602D-01,
     & 0.35404D-01, 0.37207D-01, 0.39012D-01, 0.40816D-01, 0.42620D-01,
     & 0.44425D-01, 0.46228D-01, 0.48029D-01, 0.49827D-01, 0.51622D-01,
     & 0.10068D-02, 0.25308D-02, 0.40804D-02, 0.56524D-02, 0.72442D-02,
     & 0.88529D-02, 0.10475D-01, 0.12111D-01, 0.13759D-01, 0.15419D-01,
     & 0.17087D-01, 0.18763D-01, 0.20445D-01, 0.22133D-01, 0.23826D-01,
     & 0.25523D-01, 0.27222D-01, 0.28923D-01, 0.30627D-01, 0.32331D-01,
     & 0.34034D-01, 0.35737D-01, 0.37438D-01, 0.39138D-01, 0.40836D-01,
     & 0.42533D-01, 0.44227D-01, 0.45917D-01, 0.47603D-01, 0.49284D-01,
     & 0.10687D-02, 0.25565D-02, 0.40644D-02, 0.55900D-02, 0.71308D-02,
     & 0.86846D-02, 0.10249D-01, 0.11823D-01, 0.13406D-01, 0.14996D-01,
     & 0.16592D-01, 0.18193D-01, 0.19798D-01, 0.21406D-01, 0.23015D-01,
     & 0.24626D-01, 0.26237D-01, 0.27848D-01, 0.29460D-01, 0.31070D-01,
     & 0.32678D-01, 0.34282D-01, 0.35884D-01, 0.37482D-01, 0.39076D-01,
     & 0.40670D-01, 0.42258D-01, 0.43841D-01, 0.45419D-01, 0.46990D-01,
     & 0.11433D-02, 0.25925D-02, 0.40569D-02, 0.55342D-02, 0.70226D-02,
     & 0.85203D-02, 0.10026D-01, 0.11537D-01, 0.13054D-01, 0.14575D-01,
     & 0.16099D-01, 0.17626D-01, 0.19154D-01, 0.20682D-01, 0.22210D-01,
     & 0.23736D-01, 0.25260D-01, 0.26783D-01, 0.28305D-01, 0.29824D-01,
     & 0.31337D-01, 0.32847D-01, 0.34351D-01, 0.35851D-01, 0.37346D-01,
     & 0.38839D-01, 0.40325D-01, 0.41805D-01, 0.43278D-01, 0.44744D-01,
     & 0.12339D-02, 0.26421D-02, 0.40609D-02, 0.54884D-02, 0.69231D-02,
     & 0.83637D-02, 0.98094D-02, 0.11258D-01, 0.12709D-01, 0.14160D-01,
     & 0.15612D-01, 0.17065D-01, 0.18517D-01, 0.19967D-01, 0.21414D-01,
     & 0.22857D-01, 0.24297D-01, 0.25734D-01, 0.27168D-01, 0.28597D-01,
     & 0.30020D-01, 0.31437D-01, 0.32847D-01, 0.34252D-01, 0.35650D-01,
     & 0.37046D-01, 0.38434D-01, 0.39814D-01, 0.41187D-01, 0.42552D-01,
     & 0.13442D-02, 0.27094D-02, 0.40810D-02, 0.54576D-02, 0.68377D-02,
     & 0.82206D-02, 0.96063D-02, 0.10992D-01, 0.12376D-01, 0.13760D-01,
     & 0.15141D-01, 0.16521D-01, 0.17898D-01, 0.19271D-01, 0.20639D-01,
     & 0.22001D-01, 0.23359D-01, 0.24711D-01, 0.26061D-01, 0.27403D-01,
     & 0.28738D-01, 0.30065D-01, 0.31386D-01, 0.32698D-01, 0.34004D-01,
     & 0.35307D-01, 0.36601D-01, 0.37886D-01, 0.39163D-01, 0.40431D-01,
     & 0.14789D-02, 0.27995D-02, 0.41227D-02, 0.54473D-02, 0.67724D-02,
     & 0.80973D-02, 0.94228D-02, 0.10745D-01, 0.12065D-01, 0.13380D-01,
     & 0.14691D-01, 0.16000D-01, 0.17304D-01, 0.18601D-01, 0.19892D-01,
     & 0.21176D-01, 0.22454D-01, 0.23725D-01, 0.24992D-01, 0.26251D-01,
     & 0.27501D-01, 0.28743D-01, 0.29977D-01, 0.31202D-01, 0.32420D-01,
     & 0.33633D-01, 0.34837D-01, 0.36032D-01, 0.37217D-01, 0.38394D-01,
     & 0.16439D-02, 0.29181D-02, 0.41913D-02, 0.54628D-02, 0.67318D-02,
     & 0.79982D-02, 0.92631D-02, 0.10523D-01, 0.11777D-01, 0.13025D-01,
     & 0.14267D-01, 0.15504D-01, 0.16736D-01, 0.17960D-01, 0.19176D-01,
     & 0.20383D-01, 0.21583D-01, 0.22775D-01, 0.23962D-01, 0.25140D-01,
     & 0.26308D-01, 0.27467D-01, 0.28617D-01, 0.29758D-01, 0.30891D-01,
     & 0.32019D-01, 0.33136D-01, 0.34244D-01, 0.35343D-01, 0.36431D-01/

      data ((uds_grdl(i,j),j=1,30),i=11,20)/
     & 0.18468D-02, 0.30729D-02, 0.42950D-02, 0.55126D-02, 0.67251D-02,
     & 0.79327D-02, 0.91371D-02, 0.10334D-01, 0.11523D-01, 0.12705D-01,
     & 0.13879D-01, 0.15047D-01, 0.16208D-01, 0.17360D-01, 0.18502D-01,
     & 0.19635D-01, 0.20759D-01, 0.21875D-01, 0.22985D-01, 0.24084D-01,
     & 0.25174D-01, 0.26253D-01, 0.27323D-01, 0.28383D-01, 0.29434D-01,
     & 0.30480D-01, 0.31515D-01, 0.32540D-01, 0.33556D-01, 0.34561D-01,
     & 0.20972D-02, 0.32746D-02, 0.44452D-02, 0.56088D-02, 0.67652D-02,
     & 0.79147D-02, 0.90593D-02, 0.10195D-01, 0.11321D-01, 0.12437D-01,
     & 0.13545D-01, 0.14646D-01, 0.15739D-01, 0.16821D-01, 0.17892D-01,
     & 0.18954D-01, 0.20005D-01, 0.21048D-01, 0.22084D-01, 0.23109D-01,
     & 0.24124D-01, 0.25128D-01, 0.26121D-01, 0.27105D-01, 0.28079D-01,
     & 0.29047D-01, 0.30005D-01, 0.30952D-01, 0.31889D-01, 0.32816D-01,
     & 0.24067D-02, 0.35344D-02, 0.46531D-02, 0.57626D-02, 0.68629D-02,
     & 0.79546D-02, 0.90400D-02, 0.10114D-01, 0.11178D-01, 0.12232D-01,
     & 0.13275D-01, 0.14310D-01, 0.15336D-01, 0.16350D-01, 0.17354D-01,
     & 0.18346D-01, 0.19328D-01, 0.20300D-01, 0.21265D-01, 0.22219D-01,
     & 0.23161D-01, 0.24093D-01, 0.25014D-01, 0.25924D-01, 0.26825D-01,
     & 0.27720D-01, 0.28604D-01, 0.29477D-01, 0.30340D-01, 0.31193D-01,
     & 0.27904D-02, 0.38688D-02, 0.49361D-02, 0.59925D-02, 0.70381D-02,
     & 0.80735D-02, 0.91013D-02, 0.10117D-01, 0.11121D-01, 0.12113D-01,
     & 0.13094D-01, 0.14067D-01, 0.15029D-01, 0.15979D-01, 0.16918D-01,
     & 0.17844D-01, 0.18760D-01, 0.19666D-01, 0.20564D-01, 0.21450D-01,
     & 0.22325D-01, 0.23188D-01, 0.24041D-01, 0.24883D-01, 0.25715D-01,
     & 0.26541D-01, 0.27356D-01, 0.28160D-01, 0.28954D-01, 0.29738D-01,
     & 0.32657D-02, 0.42955D-02, 0.53126D-02, 0.63170D-02, 0.73093D-02,
     & 0.82902D-02, 0.92624D-02, 0.10221D-01, 0.11168D-01, 0.12101D-01,
     & 0.13023D-01, 0.13936D-01, 0.14837D-01, 0.15726D-01, 0.16603D-01,
     & 0.17467D-01, 0.18321D-01, 0.19163D-01, 0.19998D-01, 0.20821D-01,
     & 0.21632D-01, 0.22431D-01, 0.23220D-01, 0.23998D-01, 0.24766D-01,
     & 0.25527D-01, 0.26277D-01, 0.27017D-01, 0.27747D-01, 0.28466D-01,
     & 0.38548D-02, 0.48361D-02, 0.58031D-02, 0.67563D-02, 0.76961D-02,
     & 0.86235D-02, 0.95413D-02, 0.10445D-01, 0.11335D-01, 0.12212D-01,
     & 0.13077D-01, 0.13931D-01, 0.14775D-01, 0.15605D-01, 0.16422D-01,
     & 0.17227D-01, 0.18021D-01, 0.18804D-01, 0.19578D-01, 0.20340D-01,
     & 0.21090D-01, 0.21829D-01, 0.22557D-01, 0.23274D-01, 0.23982D-01,
     & 0.24682D-01, 0.25372D-01, 0.26051D-01, 0.26720D-01, 0.27378D-01,
     & 0.45826D-02, 0.55168D-02, 0.64355D-02, 0.73393D-02, 0.82287D-02,
     & 0.91048D-02, 0.99707D-02, 0.10822D-01, 0.11659D-01, 0.12482D-01,
     & 0.13292D-01, 0.14092D-01, 0.14880D-01, 0.15655D-01, 0.16416D-01,
     & 0.17165D-01, 0.17903D-01, 0.18629D-01, 0.19347D-01, 0.20052D-01,
     & 0.20746D-01, 0.21428D-01, 0.22099D-01, 0.22760D-01, 0.23410D-01,
     & 0.24054D-01, 0.24687D-01, 0.25309D-01, 0.25922D-01, 0.26524D-01,
     & 0.54775D-02, 0.63660D-02, 0.72382D-02, 0.80945D-02, 0.89357D-02,
     & 0.97628D-02, 0.10579D-01, 0.11380D-01, 0.12166D-01, 0.12938D-01,
     & 0.13697D-01, 0.14445D-01, 0.15181D-01, 0.15903D-01, 0.16612D-01,
     & 0.17308D-01, 0.17993D-01, 0.18666D-01, 0.19331D-01, 0.19983D-01,
     & 0.20623D-01, 0.21252D-01, 0.21870D-01, 0.22477D-01, 0.23075D-01,
     & 0.23665D-01, 0.24245D-01, 0.24815D-01, 0.25374D-01, 0.25924D-01,
     & 0.65686D-02, 0.74134D-02, 0.82410D-02, 0.90519D-02, 0.98470D-02,
     & 0.10628D-01, 0.11397D-01, 0.12150D-01, 0.12888D-01, 0.13612D-01,
     & 0.14321D-01, 0.15020D-01, 0.15707D-01, 0.16379D-01, 0.17039D-01,
     & 0.17685D-01, 0.18320D-01, 0.18943D-01, 0.19557D-01, 0.20159D-01,
     & 0.20749D-01, 0.21328D-01, 0.21896D-01, 0.22453D-01, 0.23001D-01,
     & 0.23541D-01, 0.24071D-01, 0.24591D-01, 0.25100D-01, 0.25601D-01,
     & 0.78819D-02, 0.86849D-02, 0.94698D-02, 0.10237D-01, 0.10988D-01,
     & 0.11724D-01, 0.12448D-01, 0.13156D-01, 0.13849D-01, 0.14526D-01,
     & 0.15189D-01, 0.15841D-01, 0.16481D-01, 0.17106D-01, 0.17718D-01,
     & 0.18317D-01, 0.18903D-01, 0.19479D-01, 0.20045D-01, 0.20599D-01,
     & 0.21141D-01, 0.21672D-01, 0.22192D-01, 0.22701D-01, 0.23201D-01,
     & 0.23693D-01, 0.24175D-01, 0.24647D-01, 0.25109D-01, 0.25562D-01/

      data ((uds_grdl(i,j),j=1,30),i=21,30)/
     & 0.94326D-02, 0.10196D-01, 0.10939D-01, 0.11665D-01, 0.12374D-01,
     & 0.13067D-01, 0.13748D-01, 0.14412D-01, 0.15060D-01, 0.15692D-01,
     & 0.16310D-01, 0.16917D-01, 0.17510D-01, 0.18090D-01, 0.18655D-01,
     & 0.19208D-01, 0.19748D-01, 0.20276D-01, 0.20796D-01, 0.21303D-01,
     & 0.21798D-01, 0.22282D-01, 0.22754D-01, 0.23217D-01, 0.23669D-01,
     & 0.24114D-01, 0.24549D-01, 0.24974D-01, 0.25389D-01, 0.25795D-01,
     & 0.11212D-01, 0.11936D-01, 0.12639D-01, 0.13323D-01, 0.13990D-01,
     & 0.14640D-01, 0.15277D-01, 0.15897D-01, 0.16500D-01, 0.17087D-01,
     & 0.17660D-01, 0.18220D-01, 0.18767D-01, 0.19299D-01, 0.19818D-01,
     & 0.20323D-01, 0.20815D-01, 0.21296D-01, 0.21767D-01, 0.22225D-01,
     & 0.22672D-01, 0.23107D-01, 0.23531D-01, 0.23945D-01, 0.24348D-01,
     & 0.24745D-01, 0.25131D-01, 0.25507D-01, 0.25874D-01, 0.26231D-01,
     & 0.13164D-01, 0.13850D-01, 0.14514D-01, 0.15157D-01, 0.15782D-01,
     & 0.16389D-01, 0.16982D-01, 0.17557D-01, 0.18114D-01, 0.18655D-01,
     & 0.19180D-01, 0.19692D-01, 0.20191D-01, 0.20674D-01, 0.21143D-01,
     & 0.21598D-01, 0.22039D-01, 0.22469D-01, 0.22889D-01, 0.23297D-01,
     & 0.23692D-01, 0.24075D-01, 0.24447D-01, 0.24809D-01, 0.25160D-01,
     & 0.25504D-01, 0.25838D-01, 0.26162D-01, 0.26476D-01, 0.26782D-01,
     & 0.15159D-01, 0.15807D-01, 0.16431D-01, 0.17033D-01, 0.17613D-01,
     & 0.18175D-01, 0.18721D-01, 0.19247D-01, 0.19755D-01, 0.20245D-01,
     & 0.20717D-01, 0.21176D-01, 0.21621D-01, 0.22049D-01, 0.22462D-01,
     & 0.22861D-01, 0.23246D-01, 0.23619D-01, 0.23981D-01, 0.24330D-01,
     & 0.24666D-01, 0.24991D-01, 0.25304D-01, 0.25607D-01, 0.25899D-01,
     & 0.26183D-01, 0.26457D-01, 0.26722D-01, 0.26977D-01, 0.27223D-01,
     & 0.16943D-01, 0.17550D-01, 0.18129D-01, 0.18683D-01, 0.19213D-01,
     & 0.19721D-01, 0.20211D-01, 0.20680D-01, 0.21127D-01, 0.21555D-01,
     & 0.21965D-01, 0.22359D-01, 0.22737D-01, 0.23098D-01, 0.23443D-01,
     & 0.23773D-01, 0.24089D-01, 0.24391D-01, 0.24682D-01, 0.24959D-01,
     & 0.25224D-01, 0.25477D-01, 0.25719D-01, 0.25950D-01, 0.26171D-01,
     & 0.26383D-01, 0.26585D-01, 0.26778D-01, 0.26961D-01, 0.27137D-01,
     & 0.17298D-01, 0.17894D-01, 0.18461D-01, 0.19002D-01, 0.19518D-01,
     & 0.20012D-01, 0.20486D-01, 0.20938D-01, 0.21368D-01, 0.21779D-01,
     & 0.22171D-01, 0.22547D-01, 0.22906D-01, 0.23249D-01, 0.23575D-01,
     & 0.23886D-01, 0.24182D-01, 0.24465D-01, 0.24735D-01, 0.24993D-01,
     & 0.25238D-01, 0.25472D-01, 0.25694D-01, 0.25906D-01, 0.26107D-01,
     & 0.26299D-01, 0.26481D-01, 0.26654D-01, 0.26818D-01, 0.26974D-01,
     & 0.17599D-01, 0.18184D-01, 0.18738D-01, 0.19266D-01, 0.19767D-01,
     & 0.20245D-01, 0.20703D-01, 0.21138D-01, 0.21552D-01, 0.21945D-01,
     & 0.22319D-01, 0.22675D-01, 0.23015D-01, 0.23338D-01, 0.23645D-01,
     & 0.23936D-01, 0.24213D-01, 0.24476D-01, 0.24726D-01, 0.24963D-01,
     & 0.25188D-01, 0.25402D-01, 0.25604D-01, 0.25796D-01, 0.25977D-01,
     & 0.26149D-01, 0.26311D-01, 0.26464D-01, 0.26609D-01, 0.26746D-01,
     & 0.17845D-01, 0.18417D-01, 0.18959D-01, 0.19472D-01, 0.19959D-01,
     & 0.20421D-01, 0.20862D-01, 0.21279D-01, 0.21675D-01, 0.22049D-01,
     & 0.22404D-01, 0.22741D-01, 0.23061D-01, 0.23364D-01, 0.23651D-01,
     & 0.23922D-01, 0.24178D-01, 0.24420D-01, 0.24650D-01, 0.24866D-01,
     & 0.25071D-01, 0.25264D-01, 0.25446D-01, 0.25617D-01, 0.25778D-01,
     & 0.25930D-01, 0.26072D-01, 0.26206D-01, 0.26331D-01, 0.26448D-01,
     & 0.18033D-01, 0.18593D-01, 0.19121D-01, 0.19619D-01, 0.20090D-01,
     & 0.20535D-01, 0.20958D-01, 0.21357D-01, 0.21734D-01, 0.22089D-01,
     & 0.22424D-01, 0.22742D-01, 0.23041D-01, 0.23323D-01, 0.23589D-01,
     & 0.23839D-01, 0.24074D-01, 0.24296D-01, 0.24504D-01, 0.24699D-01,
     & 0.24883D-01, 0.25055D-01, 0.25216D-01, 0.25367D-01, 0.25508D-01,
     & 0.25639D-01, 0.25761D-01, 0.25874D-01, 0.25980D-01, 0.26078D-01,
     & 0.18163D-01, 0.18709D-01, 0.19223D-01, 0.19705D-01, 0.20160D-01,
     & 0.20587D-01, 0.20991D-01, 0.21371D-01, 0.21728D-01, 0.22063D-01,
     & 0.22378D-01, 0.22674D-01, 0.22952D-01, 0.23212D-01, 0.23456D-01,
     & 0.23685D-01, 0.23899D-01, 0.24099D-01, 0.24285D-01, 0.24459D-01,
     & 0.24622D-01, 0.24772D-01, 0.24913D-01, 0.25043D-01, 0.25163D-01,
     & 0.25273D-01, 0.25375D-01, 0.25468D-01, 0.25554D-01, 0.25632D-01/

      data ((uds_grdl(i,j),j=1,30),i=31,40)/
     & 0.18234D-01, 0.18766D-01, 0.19263D-01, 0.19729D-01, 0.20165D-01,
     & 0.20574D-01, 0.20958D-01, 0.21317D-01, 0.21653D-01, 0.21968D-01,
     & 0.22261D-01, 0.22535D-01, 0.22791D-01, 0.23029D-01, 0.23251D-01,
     & 0.23458D-01, 0.23650D-01, 0.23828D-01, 0.23992D-01, 0.24144D-01,
     & 0.24284D-01, 0.24413D-01, 0.24533D-01, 0.24642D-01, 0.24741D-01,
     & 0.24830D-01, 0.24911D-01, 0.24985D-01, 0.25050D-01, 0.25109D-01,
     & 0.18246D-01, 0.18761D-01, 0.19241D-01, 0.19689D-01, 0.20106D-01,
     & 0.20495D-01, 0.20857D-01, 0.21195D-01, 0.21509D-01, 0.21801D-01,
     & 0.22072D-01, 0.22323D-01, 0.22556D-01, 0.22771D-01, 0.22970D-01,
     & 0.23154D-01, 0.23324D-01, 0.23479D-01, 0.23620D-01, 0.23750D-01,
     & 0.23868D-01, 0.23976D-01, 0.24073D-01, 0.24161D-01, 0.24240D-01,
     & 0.24308D-01, 0.24369D-01, 0.24422D-01, 0.24468D-01, 0.24508D-01,
     & 0.18197D-01, 0.18694D-01, 0.19156D-01, 0.19583D-01, 0.19980D-01,
     & 0.20347D-01, 0.20687D-01, 0.21002D-01, 0.21293D-01, 0.21562D-01,
     & 0.21810D-01, 0.22037D-01, 0.22245D-01, 0.22437D-01, 0.22612D-01,
     & 0.22773D-01, 0.22919D-01, 0.23051D-01, 0.23169D-01, 0.23276D-01,
     & 0.23372D-01, 0.23457D-01, 0.23533D-01, 0.23600D-01, 0.23658D-01,
     & 0.23705D-01, 0.23745D-01, 0.23778D-01, 0.23805D-01, 0.23826D-01,
     & 0.18089D-01, 0.18566D-01, 0.19006D-01, 0.19412D-01, 0.19787D-01,
     & 0.20131D-01, 0.20447D-01, 0.20737D-01, 0.21003D-01, 0.21248D-01,
     & 0.21471D-01, 0.21673D-01, 0.21857D-01, 0.22024D-01, 0.22175D-01,
     & 0.22311D-01, 0.22434D-01, 0.22543D-01, 0.22637D-01, 0.22721D-01,
     & 0.22794D-01, 0.22858D-01, 0.22912D-01, 0.22958D-01, 0.22995D-01,
     & 0.23021D-01, 0.23041D-01, 0.23054D-01, 0.23062D-01, 0.23063D-01,
     & 0.17922D-01, 0.18376D-01, 0.18793D-01, 0.19176D-01, 0.19526D-01,
     & 0.19846D-01, 0.20135D-01, 0.20399D-01, 0.20640D-01, 0.20859D-01,
     & 0.21057D-01, 0.21233D-01, 0.21390D-01, 0.21532D-01, 0.21658D-01,
     & 0.21770D-01, 0.21868D-01, 0.21953D-01, 0.22024D-01, 0.22084D-01,
     & 0.22135D-01, 0.22176D-01, 0.22209D-01, 0.22234D-01, 0.22250D-01,
     & 0.22256D-01, 0.22256D-01, 0.22250D-01, 0.22238D-01, 0.22222D-01,
     & 0.17690D-01, 0.18118D-01, 0.18510D-01, 0.18866D-01, 0.19189D-01,
     & 0.19482D-01, 0.19743D-01, 0.19980D-01, 0.20193D-01, 0.20384D-01,
     & 0.20555D-01, 0.20704D-01, 0.20834D-01, 0.20949D-01, 0.21050D-01,
     & 0.21137D-01, 0.21211D-01, 0.21271D-01, 0.21317D-01, 0.21354D-01,
     & 0.21382D-01, 0.21401D-01, 0.21412D-01, 0.21416D-01, 0.21412D-01,
     & 0.21398D-01, 0.21378D-01, 0.21353D-01, 0.21323D-01, 0.21289D-01,
     & 0.17400D-01, 0.17801D-01, 0.18163D-01, 0.18490D-01, 0.18785D-01,
     & 0.19049D-01, 0.19280D-01, 0.19487D-01, 0.19671D-01, 0.19834D-01,
     & 0.19976D-01, 0.20097D-01, 0.20200D-01, 0.20288D-01, 0.20362D-01,
     & 0.20423D-01, 0.20472D-01, 0.20508D-01, 0.20530D-01, 0.20543D-01,
     & 0.20549D-01, 0.20546D-01, 0.20536D-01, 0.20519D-01, 0.20495D-01,
     & 0.20461D-01, 0.20423D-01, 0.20379D-01, 0.20332D-01, 0.20281D-01,
     & 0.17053D-01, 0.17421D-01, 0.17751D-01, 0.18047D-01, 0.18310D-01,
     & 0.18542D-01, 0.18741D-01, 0.18916D-01, 0.19070D-01, 0.19203D-01,
     & 0.19316D-01, 0.19408D-01, 0.19482D-01, 0.19542D-01, 0.19590D-01,
     & 0.19625D-01, 0.19649D-01, 0.19660D-01, 0.19658D-01, 0.19649D-01,
     & 0.19631D-01, 0.19607D-01, 0.19577D-01, 0.19540D-01, 0.19497D-01,
     & 0.19444D-01, 0.19387D-01, 0.19327D-01, 0.19263D-01, 0.19196D-01,
     & 0.16646D-01, 0.16977D-01, 0.17272D-01, 0.17533D-01, 0.17762D-01,
     & 0.17960D-01, 0.18124D-01, 0.18266D-01, 0.18387D-01, 0.18489D-01,
     & 0.18572D-01, 0.18634D-01, 0.18679D-01, 0.18711D-01, 0.18731D-01,
     & 0.18740D-01, 0.18739D-01, 0.18726D-01, 0.18700D-01, 0.18667D-01,
     & 0.18628D-01, 0.18583D-01, 0.18533D-01, 0.18477D-01, 0.18415D-01,
     & 0.18345D-01, 0.18271D-01, 0.18194D-01, 0.18115D-01, 0.18033D-01,
     & 0.16180D-01, 0.16471D-01, 0.16726D-01, 0.16948D-01, 0.17139D-01,
     & 0.17300D-01, 0.17428D-01, 0.17535D-01, 0.17622D-01, 0.17691D-01,
     & 0.17742D-01, 0.17773D-01, 0.17788D-01, 0.17791D-01, 0.17784D-01,
     & 0.17767D-01, 0.17741D-01, 0.17704D-01, 0.17655D-01, 0.17600D-01,
     & 0.17540D-01, 0.17475D-01, 0.17405D-01, 0.17331D-01, 0.17252D-01,
     & 0.17165D-01, 0.17075D-01, 0.16984D-01, 0.16890D-01, 0.16795D-01/

      data ((uds_grdl(i,j),j=1,30),i=41,50)/
     & 0.15654D-01, 0.15899D-01, 0.16110D-01, 0.16290D-01, 0.16440D-01,
     & 0.16561D-01, 0.16650D-01, 0.16719D-01, 0.16771D-01, 0.16806D-01,
     & 0.16825D-01, 0.16824D-01, 0.16809D-01, 0.16783D-01, 0.16749D-01,
     & 0.16706D-01, 0.16655D-01, 0.16595D-01, 0.16523D-01, 0.16447D-01,
     & 0.16367D-01, 0.16283D-01, 0.16195D-01, 0.16104D-01, 0.16010D-01,
     & 0.15907D-01, 0.15803D-01, 0.15698D-01, 0.15592D-01, 0.15485D-01,
     & 0.15068D-01, 0.15262D-01, 0.15424D-01, 0.15557D-01, 0.15663D-01,
     & 0.15742D-01, 0.15789D-01, 0.15819D-01, 0.15833D-01, 0.15833D-01,
     & 0.15818D-01, 0.15786D-01, 0.15740D-01, 0.15686D-01, 0.15625D-01,
     & 0.15556D-01, 0.15481D-01, 0.15398D-01, 0.15305D-01, 0.15210D-01,
     & 0.15111D-01, 0.15009D-01, 0.14905D-01, 0.14798D-01, 0.14689D-01,
     & 0.14574D-01, 0.14458D-01, 0.14341D-01, 0.14224D-01, 0.14107D-01,
     & 0.14419D-01, 0.14556D-01, 0.14664D-01, 0.14746D-01, 0.14803D-01,
     & 0.14836D-01, 0.14840D-01, 0.14829D-01, 0.14805D-01, 0.14768D-01,
     & 0.14720D-01, 0.14655D-01, 0.14579D-01, 0.14497D-01, 0.14409D-01,
     & 0.14317D-01, 0.14219D-01, 0.14115D-01, 0.14002D-01, 0.13888D-01,
     & 0.13772D-01, 0.13655D-01, 0.13536D-01, 0.13417D-01, 0.13295D-01,
     & 0.13169D-01, 0.13043D-01, 0.12917D-01, 0.12792D-01, 0.12667D-01,
     & 0.13701D-01, 0.13774D-01, 0.13823D-01, 0.13849D-01, 0.13855D-01,
     & 0.13839D-01, 0.13797D-01, 0.13744D-01, 0.13680D-01, 0.13606D-01,
     & 0.13524D-01, 0.13428D-01, 0.13323D-01, 0.13214D-01, 0.13101D-01,
     & 0.12985D-01, 0.12866D-01, 0.12743D-01, 0.12613D-01, 0.12483D-01,
     & 0.12352D-01, 0.12222D-01, 0.12091D-01, 0.11960D-01, 0.11829D-01,
     & 0.11694D-01, 0.11561D-01, 0.11429D-01, 0.11298D-01, 0.11168D-01,
     & 0.12898D-01, 0.12901D-01, 0.12884D-01, 0.12850D-01, 0.12800D-01,
     & 0.12734D-01, 0.12645D-01, 0.12548D-01, 0.12445D-01, 0.12335D-01,
     & 0.12219D-01, 0.12093D-01, 0.11960D-01, 0.11826D-01, 0.11691D-01,
     & 0.11554D-01, 0.11417D-01, 0.11277D-01, 0.11132D-01, 0.10989D-01,
     & 0.10847D-01, 0.10707D-01, 0.10567D-01, 0.10429D-01, 0.10291D-01,
     & 0.10152D-01, 0.10014D-01, 0.98791D-02, 0.97459D-02, 0.96148D-02,
     & 0.11992D-01, 0.11916D-01, 0.11828D-01, 0.11730D-01, 0.11621D-01,
     & 0.11501D-01, 0.11364D-01, 0.11225D-01, 0.11082D-01, 0.10937D-01,
     & 0.10790D-01, 0.10636D-01, 0.10479D-01, 0.10323D-01, 0.10169D-01,
     & 0.10015D-01, 0.98626D-02, 0.97100D-02, 0.95556D-02, 0.94039D-02,
     & 0.92547D-02, 0.91081D-02, 0.89639D-02, 0.88221D-02, 0.86823D-02,
     & 0.85422D-02, 0.84051D-02, 0.82708D-02, 0.81393D-02, 0.80105D-02,
     & 0.10955D-01, 0.10804D-01, 0.10647D-01, 0.10485D-01, 0.10319D-01,
     & 0.10148D-01, 0.99665D-02, 0.97859D-02, 0.96066D-02, 0.94287D-02,
     & 0.92522D-02, 0.90733D-02, 0.88948D-02, 0.87201D-02, 0.85490D-02,
     & 0.83813D-02, 0.82170D-02, 0.80549D-02, 0.78937D-02, 0.77367D-02,
     & 0.75836D-02, 0.74344D-02, 0.72888D-02, 0.71468D-02, 0.70080D-02,
     & 0.68709D-02, 0.67374D-02, 0.66075D-02, 0.64810D-02, 0.63577D-02,
     & 0.98746D-02, 0.95861D-02, 0.93077D-02, 0.90388D-02, 0.87789D-02,
     & 0.85270D-02, 0.82800D-02, 0.80424D-02, 0.78137D-02, 0.75932D-02,
     & 0.73807D-02, 0.71746D-02, 0.69754D-02, 0.67836D-02, 0.65989D-02,
     & 0.64210D-02, 0.62496D-02, 0.60842D-02, 0.59243D-02, 0.57701D-02,
     & 0.56215D-02, 0.54782D-02, 0.53398D-02, 0.52063D-02, 0.50774D-02,
     & 0.49531D-02, 0.48330D-02, 0.47168D-02, 0.46046D-02, 0.44960D-02,
     & 0.66257D-02, 0.63472D-02, 0.60843D-02, 0.58358D-02, 0.56008D-02,
     & 0.53786D-02, 0.51690D-02, 0.49701D-02, 0.47814D-02, 0.46024D-02,
     & 0.44324D-02, 0.42717D-02, 0.41193D-02, 0.39741D-02, 0.38357D-02,
     & 0.37038D-02, 0.35781D-02, 0.34586D-02, 0.33455D-02, 0.32372D-02,
     & 0.31336D-02, 0.30344D-02, 0.29395D-02, 0.28487D-02, 0.27617D-02,
     & 0.26795D-02, 0.26006D-02, 0.25247D-02, 0.24517D-02, 0.23816D-02,
     & 0.41397D-03, 0.39347D-03, 0.37426D-03, 0.35624D-03, 0.33935D-03,
     & 0.32352D-03, 0.30881D-03, 0.29494D-03, 0.28187D-03, 0.26955D-03,
     & 0.25792D-03, 0.24706D-03, 0.23685D-03, 0.22718D-03, 0.21800D-03,
     & 0.20931D-03, 0.20106D-03, 0.19328D-03, 0.18600D-03, 0.17906D-03,
     & 0.17244D-03, 0.16614D-03, 0.16013D-03, 0.15441D-03, 0.14896D-03,
     & 0.14387D-03, 0.13900D-03, 0.13433D-03, 0.12986D-03, 0.12557D-03/

      data ((g_grdl(i,j),j=1,30),i=1,10)/
     & 0.11776D+01, 0.12610D+01, 0.13438D+01, 0.14257D+01, 0.15070D+01,
     & 0.15875D+01, 0.16674D+01, 0.17466D+01, 0.18249D+01, 0.19023D+01,
     & 0.19790D+01, 0.20551D+01, 0.21305D+01, 0.22050D+01, 0.22786D+01,
     & 0.23515D+01, 0.24235D+01, 0.24949D+01, 0.25656D+01, 0.26356D+01,
     & 0.27047D+01, 0.27730D+01, 0.28405D+01, 0.29073D+01, 0.29734D+01,
     & 0.30390D+01, 0.31038D+01, 0.31678D+01, 0.32311D+01, 0.32936D+01,
     & 0.11699D+01, 0.12484D+01, 0.13260D+01, 0.14027D+01, 0.14787D+01,
     & 0.15538D+01, 0.16283D+01, 0.17019D+01, 0.17746D+01, 0.18464D+01,
     & 0.19174D+01, 0.19878D+01, 0.20574D+01, 0.21261D+01, 0.21939D+01,
     & 0.22609D+01, 0.23271D+01, 0.23925D+01, 0.24574D+01, 0.25214D+01,
     & 0.25846D+01, 0.26470D+01, 0.27086D+01, 0.27694D+01, 0.28296D+01,
     & 0.28892D+01, 0.29481D+01, 0.30062D+01, 0.30636D+01, 0.31203D+01,
     & 0.11610D+01, 0.12346D+01, 0.13072D+01, 0.13788D+01, 0.14495D+01,
     & 0.15194D+01, 0.15886D+01, 0.16569D+01, 0.17242D+01, 0.17906D+01,
     & 0.18561D+01, 0.19210D+01, 0.19850D+01, 0.20482D+01, 0.21104D+01,
     & 0.21718D+01, 0.22324D+01, 0.22923D+01, 0.23516D+01, 0.24100D+01,
     & 0.24675D+01, 0.25243D+01, 0.25803D+01, 0.26356D+01, 0.26901D+01,
     & 0.27442D+01, 0.27975D+01, 0.28501D+01, 0.29019D+01, 0.29530D+01,
     & 0.11508D+01, 0.12196D+01, 0.12872D+01, 0.13539D+01, 0.14196D+01,
     & 0.14844D+01, 0.15485D+01, 0.16115D+01, 0.16737D+01, 0.17348D+01,
     & 0.17951D+01, 0.18547D+01, 0.19135D+01, 0.19713D+01, 0.20283D+01,
     & 0.20844D+01, 0.21397D+01, 0.21943D+01, 0.22482D+01, 0.23013D+01,
     & 0.23536D+01, 0.24051D+01, 0.24558D+01, 0.25058D+01, 0.25551D+01,
     & 0.26039D+01, 0.26520D+01, 0.26994D+01, 0.27460D+01, 0.27920D+01,
     & 0.11389D+01, 0.12028D+01, 0.12657D+01, 0.13275D+01, 0.13883D+01,
     & 0.14481D+01, 0.15072D+01, 0.15653D+01, 0.16224D+01, 0.16785D+01,
     & 0.17337D+01, 0.17883D+01, 0.18420D+01, 0.18947D+01, 0.19467D+01,
     & 0.19977D+01, 0.20479D+01, 0.20974D+01, 0.21463D+01, 0.21944D+01,
     & 0.22417D+01, 0.22882D+01, 0.23339D+01, 0.23790D+01, 0.24233D+01,
     & 0.24672D+01, 0.25104D+01, 0.25528D+01, 0.25946D+01, 0.26357D+01,
     & 0.11249D+01, 0.11842D+01, 0.12423D+01, 0.12993D+01, 0.13553D+01,
     & 0.14104D+01, 0.14646D+01, 0.15179D+01, 0.15701D+01, 0.16214D+01,
     & 0.16718D+01, 0.17215D+01, 0.17703D+01, 0.18183D+01, 0.18653D+01,
     & 0.19116D+01, 0.19570D+01, 0.20017D+01, 0.20458D+01, 0.20891D+01,
     & 0.21316D+01, 0.21734D+01, 0.22145D+01, 0.22548D+01, 0.22945D+01,
     & 0.23338D+01, 0.23723D+01, 0.24102D+01, 0.24474D+01, 0.24840D+01,
     & 0.11087D+01, 0.11633D+01, 0.12169D+01, 0.12693D+01, 0.13206D+01,
     & 0.13710D+01, 0.14206D+01, 0.14692D+01, 0.15168D+01, 0.15634D+01,
     & 0.16091D+01, 0.16542D+01, 0.16984D+01, 0.17417D+01, 0.17842D+01,
     & 0.18258D+01, 0.18667D+01, 0.19069D+01, 0.19465D+01, 0.19853D+01,
     & 0.20233D+01, 0.20606D+01, 0.20973D+01, 0.21333D+01, 0.21686D+01,
     & 0.22035D+01, 0.22377D+01, 0.22713D+01, 0.23043D+01, 0.23367D+01,
     & 0.10900D+01, 0.11402D+01, 0.11893D+01, 0.12372D+01, 0.12841D+01,
     & 0.13300D+01, 0.13751D+01, 0.14192D+01, 0.14623D+01, 0.15045D+01,
     & 0.15459D+01, 0.15865D+01, 0.16263D+01, 0.16653D+01, 0.17034D+01,
     & 0.17407D+01, 0.17773D+01, 0.18132D+01, 0.18486D+01, 0.18832D+01,
     & 0.19170D+01, 0.19502D+01, 0.19827D+01, 0.20146D+01, 0.20459D+01,
     & 0.20768D+01, 0.21070D+01, 0.21366D+01, 0.21656D+01, 0.21941D+01,
     & 0.10687D+01, 0.11146D+01, 0.11593D+01, 0.12030D+01, 0.12456D+01,
     & 0.12872D+01, 0.13280D+01, 0.13679D+01, 0.14068D+01, 0.14448D+01,
     & 0.14819D+01, 0.15184D+01, 0.15540D+01, 0.15889D+01, 0.16230D+01,
     & 0.16563D+01, 0.16888D+01, 0.17208D+01, 0.17521D+01, 0.17828D+01,
     & 0.18128D+01, 0.18421D+01, 0.18708D+01, 0.18989D+01, 0.19264D+01,
     & 0.19535D+01, 0.19801D+01, 0.20060D+01, 0.20315D+01, 0.20563D+01,
     & 0.10442D+01, 0.10859D+01, 0.11264D+01, 0.11659D+01, 0.12044D+01,
     & 0.12419D+01, 0.12786D+01, 0.13144D+01, 0.13493D+01, 0.13833D+01,
     & 0.14165D+01, 0.14490D+01, 0.14807D+01, 0.15117D+01, 0.15419D+01,
     & 0.15714D+01, 0.16002D+01, 0.16284D+01, 0.16561D+01, 0.16831D+01,
     & 0.17094D+01, 0.17352D+01, 0.17603D+01, 0.17849D+01, 0.18089D+01,
     & 0.18326D+01, 0.18557D+01, 0.18783D+01, 0.19003D+01, 0.19219D+01/

      data ((g_grdl(i,j),j=1,30),i=11,20)/
     & 0.10161D+01, 0.10538D+01, 0.10903D+01, 0.11258D+01, 0.11604D+01,
     & 0.11940D+01, 0.12268D+01, 0.12588D+01, 0.12898D+01, 0.13201D+01,
     & 0.13495D+01, 0.13783D+01, 0.14064D+01, 0.14337D+01, 0.14604D+01,
     & 0.14863D+01, 0.15116D+01, 0.15363D+01, 0.15605D+01, 0.15841D+01,
     & 0.16071D+01, 0.16295D+01, 0.16514D+01, 0.16727D+01, 0.16936D+01,
     & 0.17140D+01, 0.17340D+01, 0.17535D+01, 0.17725D+01, 0.17910D+01,
     & 0.98456D+00, 0.10184D+01, 0.10511D+01, 0.10829D+01, 0.11137D+01,
     & 0.11437D+01, 0.11729D+01, 0.12012D+01, 0.12288D+01, 0.12555D+01,
     & 0.12815D+01, 0.13068D+01, 0.13315D+01, 0.13555D+01, 0.13789D+01,
     & 0.14016D+01, 0.14237D+01, 0.14452D+01, 0.14663D+01, 0.14867D+01,
     & 0.15067D+01, 0.15261D+01, 0.15449D+01, 0.15633D+01, 0.15813D+01,
     & 0.15989D+01, 0.16160D+01, 0.16327D+01, 0.16489D+01, 0.16647D+01,
     & 0.94894D+00, 0.97913D+00, 0.10083D+01, 0.10366D+01, 0.10639D+01,
     & 0.10904D+01, 0.11162D+01, 0.11412D+01, 0.11655D+01, 0.11889D+01,
     & 0.12117D+01, 0.12339D+01, 0.12555D+01, 0.12764D+01, 0.12967D+01,
     & 0.13164D+01, 0.13355D+01, 0.13541D+01, 0.13723D+01, 0.13899D+01,
     & 0.14071D+01, 0.14237D+01, 0.14399D+01, 0.14556D+01, 0.14709D+01,
     & 0.14859D+01, 0.15005D+01, 0.15146D+01, 0.15283D+01, 0.15417D+01,
     & 0.90968D+00, 0.93653D+00, 0.96243D+00, 0.98743D+00, 0.10116D+01,
     & 0.10350D+01, 0.10577D+01, 0.10796D+01, 0.11008D+01, 0.11213D+01,
     & 0.11412D+01, 0.11605D+01, 0.11793D+01, 0.11974D+01, 0.12150D+01,
     & 0.12320D+01, 0.12485D+01, 0.12645D+01, 0.12801D+01, 0.12952D+01,
     & 0.13098D+01, 0.13240D+01, 0.13378D+01, 0.13511D+01, 0.13641D+01,
     & 0.13767D+01, 0.13890D+01, 0.14009D+01, 0.14125D+01, 0.14237D+01,
     & 0.86681D+00, 0.89060D+00, 0.91349D+00, 0.93554D+00, 0.95679D+00,
     & 0.97732D+00, 0.99721D+00, 0.10164D+01, 0.10349D+01, 0.10528D+01,
     & 0.10700D+01, 0.10868D+01, 0.11030D+01, 0.11186D+01, 0.11337D+01,
     & 0.11483D+01, 0.11625D+01, 0.11762D+01, 0.11895D+01, 0.12023D+01,
     & 0.12148D+01, 0.12268D+01, 0.12384D+01, 0.12497D+01, 0.12606D+01,
     & 0.12712D+01, 0.12815D+01, 0.12914D+01, 0.13011D+01, 0.13104D+01,
     & 0.81958D+00, 0.84061D+00, 0.86080D+00, 0.88021D+00, 0.89887D+00,
     & 0.91685D+00, 0.93424D+00, 0.95097D+00, 0.96708D+00, 0.98259D+00,
     & 0.99753D+00, 0.10120D+01, 0.10260D+01, 0.10394D+01, 0.10524D+01,
     & 0.10649D+01, 0.10770D+01, 0.10886D+01, 0.10999D+01, 0.11108D+01,
     & 0.11213D+01, 0.11315D+01, 0.11413D+01, 0.11507D+01, 0.11598D+01,
     & 0.11687D+01, 0.11772D+01, 0.11855D+01, 0.11934D+01, 0.12011D+01,
     & 0.76943D+00, 0.78807D+00, 0.80592D+00, 0.82304D+00, 0.83946D+00,
     & 0.85525D+00, 0.87049D+00, 0.88511D+00, 0.89915D+00, 0.91263D+00,
     & 0.92560D+00, 0.93811D+00, 0.95017D+00, 0.96175D+00, 0.97289D+00,
     & 0.98360D+00, 0.99390D+00, 0.10038D+01, 0.10134D+01, 0.10226D+01,
     & 0.10315D+01, 0.10400D+01, 0.10483D+01, 0.10562D+01, 0.10638D+01,
     & 0.10711D+01, 0.10782D+01, 0.10850D+01, 0.10915D+01, 0.10978D+01,
     & 0.71713D+00, 0.73378D+00, 0.74969D+00, 0.76490D+00, 0.77947D+00,
     & 0.79343D+00, 0.80688D+00, 0.81975D+00, 0.83207D+00, 0.84388D+00,
     & 0.85520D+00, 0.86609D+00, 0.87656D+00, 0.88659D+00, 0.89620D+00,
     & 0.90542D+00, 0.91425D+00, 0.92275D+00, 0.93092D+00, 0.93876D+00,
     & 0.94627D+00, 0.95347D+00, 0.96037D+00, 0.96698D+00, 0.97332D+00,
     & 0.97943D+00, 0.98528D+00, 0.99089D+00, 0.99625D+00, 0.10014D+01,
     & 0.66425D+00, 0.67935D+00, 0.69374D+00, 0.70747D+00, 0.72057D+00,
     & 0.73310D+00, 0.74514D+00, 0.75663D+00, 0.76759D+00, 0.77807D+00,
     & 0.78808D+00, 0.79769D+00, 0.80690D+00, 0.81568D+00, 0.82408D+00,
     & 0.83209D+00, 0.83976D+00, 0.84709D+00, 0.85413D+00, 0.86084D+00,
     & 0.86725D+00, 0.87337D+00, 0.87920D+00, 0.88477D+00, 0.89009D+00,
     & 0.89519D+00, 0.90004D+00, 0.90467D+00, 0.90907D+00, 0.91326D+00,
     & 0.61295D+00, 0.62696D+00, 0.64028D+00, 0.65295D+00, 0.66500D+00,
     & 0.67650D+00, 0.68750D+00, 0.69797D+00, 0.70794D+00, 0.71742D+00,
     & 0.72645D+00, 0.73509D+00, 0.74333D+00, 0.75116D+00, 0.75862D+00,
     & 0.76571D+00, 0.77245D+00, 0.77888D+00, 0.78502D+00, 0.79085D+00,
     & 0.79639D+00, 0.80164D+00, 0.80663D+00, 0.81136D+00, 0.81584D+00,
     & 0.82012D+00, 0.82416D+00, 0.82798D+00, 0.83160D+00, 0.83501D+00/

      data ((g_grdl(i,j),j=1,30),i=21,30)/
     & 0.56623D+00, 0.57963D+00, 0.59232D+00, 0.60434D+00, 0.61574D+00,
     & 0.62657D+00, 0.63691D+00, 0.64670D+00, 0.65598D+00, 0.66478D+00,
     & 0.67311D+00, 0.68105D+00, 0.68859D+00, 0.69572D+00, 0.70247D+00,
     & 0.70885D+00, 0.71489D+00, 0.72061D+00, 0.72604D+00, 0.73116D+00,
     & 0.73599D+00, 0.74055D+00, 0.74484D+00, 0.74887D+00, 0.75267D+00,
     & 0.75625D+00, 0.75960D+00, 0.76275D+00, 0.76568D+00, 0.76843D+00,
     & 0.52784D+00, 0.54109D+00, 0.55358D+00, 0.56536D+00, 0.57647D+00,
     & 0.58698D+00, 0.59695D+00, 0.60634D+00, 0.61520D+00, 0.62354D+00,
     & 0.63140D+00, 0.63884D+00, 0.64585D+00, 0.65244D+00, 0.65864D+00,
     & 0.66445D+00, 0.66991D+00, 0.67504D+00, 0.67985D+00, 0.68436D+00,
     & 0.68856D+00, 0.69249D+00, 0.69614D+00, 0.69955D+00, 0.70270D+00,
     & 0.70562D+00, 0.70832D+00, 0.71081D+00, 0.71310D+00, 0.71519D+00,
     & 0.50484D+00, 0.51835D+00, 0.53101D+00, 0.54287D+00, 0.55398D+00,
     & 0.56441D+00, 0.57422D+00, 0.58340D+00, 0.59198D+00, 0.60000D+00,
     & 0.60749D+00, 0.61450D+00, 0.62104D+00, 0.62713D+00, 0.63279D+00,
     & 0.63805D+00, 0.64292D+00, 0.64743D+00, 0.65159D+00, 0.65542D+00,
     & 0.65895D+00, 0.66218D+00, 0.66514D+00, 0.66783D+00, 0.67026D+00,
     & 0.67242D+00, 0.67437D+00, 0.67610D+00, 0.67763D+00, 0.67897D+00,
     & 0.50606D+00, 0.52008D+00, 0.53309D+00, 0.54516D+00, 0.55635D+00,
     & 0.56672D+00, 0.57634D+00, 0.58523D+00, 0.59345D+00, 0.60101D+00,
     & 0.60798D+00, 0.61437D+00, 0.62023D+00, 0.62558D+00, 0.63047D+00,
     & 0.63491D+00, 0.63894D+00, 0.64255D+00, 0.64576D+00, 0.64862D+00,
     & 0.65116D+00, 0.65340D+00, 0.65534D+00, 0.65701D+00, 0.65840D+00,
     & 0.65948D+00, 0.66035D+00, 0.66100D+00, 0.66146D+00, 0.66172D+00,
     & 0.54625D+00, 0.56052D+00, 0.57356D+00, 0.58544D+00, 0.59625D+00,
     & 0.60606D+00, 0.61488D+00, 0.62287D+00, 0.63005D+00, 0.63650D+00,
     & 0.64225D+00, 0.64728D+00, 0.65169D+00, 0.65555D+00, 0.65890D+00,
     & 0.66176D+00, 0.66417D+00, 0.66612D+00, 0.66758D+00, 0.66870D+00,
     & 0.66949D+00, 0.66997D+00, 0.67016D+00, 0.67007D+00, 0.66971D+00,
     & 0.66898D+00, 0.66805D+00, 0.66693D+00, 0.66562D+00, 0.66415D+00,
     & 0.56452D+00, 0.57871D+00, 0.59159D+00, 0.60325D+00, 0.61379D+00,
     & 0.62327D+00, 0.63169D+00, 0.63923D+00, 0.64595D+00, 0.65191D+00,
     & 0.65715D+00, 0.66163D+00, 0.66546D+00, 0.66874D+00, 0.67150D+00,
     & 0.67377D+00, 0.67558D+00, 0.67692D+00, 0.67775D+00, 0.67825D+00,
     & 0.67842D+00, 0.67829D+00, 0.67787D+00, 0.67718D+00, 0.67621D+00,
     & 0.67487D+00, 0.67333D+00, 0.67162D+00, 0.66974D+00, 0.66769D+00,
     & 0.58621D+00, 0.60017D+00, 0.61277D+00, 0.62410D+00, 0.63425D+00,
     & 0.64328D+00, 0.65119D+00, 0.65819D+00, 0.66435D+00, 0.66972D+00,
     & 0.67435D+00, 0.67818D+00, 0.68134D+00, 0.68395D+00, 0.68603D+00,
     & 0.68762D+00, 0.68875D+00, 0.68940D+00, 0.68952D+00, 0.68931D+00,
     & 0.68879D+00, 0.68797D+00, 0.68687D+00, 0.68550D+00, 0.68387D+00,
     & 0.68185D+00, 0.67965D+00, 0.67728D+00, 0.67476D+00, 0.67209D+00,
     & 0.61147D+00, 0.62511D+00, 0.63731D+00, 0.64818D+00, 0.65781D+00,
     & 0.66627D+00, 0.67352D+00, 0.67984D+00, 0.68530D+00, 0.68995D+00,
     & 0.69384D+00, 0.69690D+00, 0.69927D+00, 0.70108D+00, 0.70237D+00,
     & 0.70318D+00, 0.70352D+00, 0.70337D+00, 0.70268D+00, 0.70168D+00,
     & 0.70038D+00, 0.69879D+00, 0.69693D+00, 0.69482D+00, 0.69245D+00,
     & 0.68968D+00, 0.68675D+00, 0.68367D+00, 0.68045D+00, 0.67709D+00,
     & 0.64050D+00, 0.65361D+00, 0.66523D+00, 0.67547D+00, 0.68442D+00,
     & 0.69215D+00, 0.69859D+00, 0.70410D+00, 0.70872D+00, 0.71252D+00,
     & 0.71554D+00, 0.71770D+00, 0.71915D+00, 0.72005D+00, 0.72044D+00,
     & 0.72034D+00, 0.71979D+00, 0.71875D+00, 0.71716D+00, 0.71526D+00,
     & 0.71308D+00, 0.71063D+00, 0.70793D+00, 0.70499D+00, 0.70181D+00,
     & 0.69822D+00, 0.69449D+00, 0.69063D+00, 0.68664D+00, 0.68254D+00,
     & 0.67349D+00, 0.68590D+00, 0.69676D+00, 0.70618D+00, 0.71428D+00,
     & 0.72109D+00, 0.72654D+00, 0.73104D+00, 0.73464D+00, 0.73742D+00,
     & 0.73942D+00, 0.74052D+00, 0.74089D+00, 0.74074D+00, 0.74008D+00,
     & 0.73895D+00, 0.73739D+00, 0.73533D+00, 0.73271D+00, 0.72982D+00,
     & 0.72666D+00, 0.72326D+00, 0.71962D+00, 0.71577D+00, 0.71169D+00,
     & 0.70720D+00, 0.70259D+00, 0.69788D+00, 0.69308D+00, 0.68817D+00/

      data ((g_grdl(i,j),j=1,30),i=31,40)/
     & 0.71066D+00, 0.72211D+00, 0.73196D+00, 0.74034D+00, 0.74735D+00,
     & 0.75304D+00, 0.75729D+00, 0.76058D+00, 0.76299D+00, 0.76457D+00,
     & 0.76537D+00, 0.76524D+00, 0.76439D+00, 0.76302D+00, 0.76117D+00,
     & 0.75888D+00, 0.75616D+00, 0.75297D+00, 0.74920D+00, 0.74520D+00,
     & 0.74095D+00, 0.73649D+00, 0.73183D+00, 0.72697D+00, 0.72191D+00,
     & 0.71643D+00, 0.71088D+00, 0.70525D+00, 0.69954D+00, 0.69377D+00,
     & 0.75226D+00, 0.76246D+00, 0.77104D+00, 0.77810D+00, 0.78377D+00,
     & 0.78809D+00, 0.79089D+00, 0.79275D+00, 0.79374D+00, 0.79390D+00,
     & 0.79330D+00, 0.79176D+00, 0.78948D+00, 0.78673D+00, 0.78353D+00,
     & 0.77992D+00, 0.77590D+00, 0.77143D+00, 0.76639D+00, 0.76114D+00,
     & 0.75570D+00, 0.75007D+00, 0.74427D+00, 0.73831D+00, 0.73218D+00,
     & 0.72564D+00, 0.71906D+00, 0.71243D+00, 0.70577D+00, 0.69906D+00,
     & 0.79853D+00, 0.80715D+00, 0.81412D+00, 0.81957D+00, 0.82361D+00,
     & 0.82628D+00, 0.82735D+00, 0.82751D+00, 0.82682D+00, 0.82533D+00,
     & 0.82311D+00, 0.81993D+00, 0.81603D+00, 0.81170D+00, 0.80697D+00,
     & 0.80186D+00, 0.79639D+00, 0.79049D+00, 0.78403D+00, 0.77742D+00,
     & 0.77065D+00, 0.76374D+00, 0.75670D+00, 0.74953D+00, 0.74223D+00,
     & 0.73455D+00, 0.72685D+00, 0.71916D+00, 0.71146D+00, 0.70376D+00,
     & 0.84970D+00, 0.85632D+00, 0.86130D+00, 0.86476D+00, 0.86682D+00,
     & 0.86750D+00, 0.86655D+00, 0.86472D+00, 0.86209D+00, 0.85870D+00,
     & 0.85461D+00, 0.84957D+00, 0.84384D+00, 0.83774D+00, 0.83128D+00,
     & 0.82450D+00, 0.81741D+00, 0.80992D+00, 0.80190D+00, 0.79377D+00,
     & 0.78555D+00, 0.77724D+00, 0.76884D+00, 0.76037D+00, 0.75181D+00,
     & 0.74289D+00, 0.73400D+00, 0.72516D+00, 0.71636D+00, 0.70761D+00,
     & 0.90602D+00, 0.91020D+00, 0.91276D+00, 0.91384D+00, 0.91353D+00,
     & 0.91187D+00, 0.90850D+00, 0.90434D+00, 0.89943D+00, 0.89384D+00,
     & 0.88760D+00, 0.88042D+00, 0.87260D+00, 0.86448D+00, 0.85608D+00,
     & 0.84742D+00, 0.83852D+00, 0.82927D+00, 0.81953D+00, 0.80976D+00,
     & 0.79995D+00, 0.79011D+00, 0.78025D+00, 0.77037D+00, 0.76045D+00,
     & 0.75020D+00, 0.74006D+00, 0.73000D+00, 0.72004D+00, 0.71017D+00,
     & 0.96802D+00, 0.96914D+00, 0.96871D+00, 0.96687D+00, 0.96371D+00,
     & 0.95923D+00, 0.95306D+00, 0.94618D+00, 0.93864D+00, 0.93051D+00,
     & 0.92181D+00, 0.91221D+00, 0.90204D+00, 0.89165D+00, 0.88108D+00,
     & 0.87033D+00, 0.85942D+00, 0.84823D+00, 0.83660D+00, 0.82501D+00,
     & 0.81346D+00, 0.80196D+00, 0.79051D+00, 0.77910D+00, 0.76772D+00,
     & 0.75606D+00, 0.74457D+00, 0.73322D+00, 0.72203D+00, 0.71098D+00,
     & 0.10356D+01, 0.10330D+01, 0.10290D+01, 0.10237D+01, 0.10172D+01,
     & 0.10094D+01, 0.99998D+00, 0.98994D+00, 0.97937D+00, 0.96832D+00,
     & 0.95681D+00, 0.94447D+00, 0.93164D+00, 0.91872D+00, 0.90573D+00,
     & 0.89266D+00, 0.87952D+00, 0.86620D+00, 0.85251D+00, 0.83896D+00,
     & 0.82555D+00, 0.81226D+00, 0.79910D+00, 0.78607D+00, 0.77314D+00,
     & 0.76000D+00, 0.74709D+00, 0.73440D+00, 0.72193D+00, 0.70965D+00,
     & 0.11090D+01, 0.11020D+01, 0.10937D+01, 0.10842D+01, 0.10737D+01,
     & 0.10621D+01, 0.10488D+01, 0.10352D+01, 0.10211D+01, 0.10068D+01,
     & 0.99208D+00, 0.97667D+00, 0.96089D+00, 0.94516D+00, 0.92949D+00,
     & 0.91387D+00, 0.89830D+00, 0.88266D+00, 0.86675D+00, 0.85109D+00,
     & 0.83566D+00, 0.82047D+00, 0.80550D+00, 0.79074D+00, 0.77617D+00,
     & 0.76149D+00, 0.74711D+00, 0.73302D+00, 0.71922D+00, 0.70569D+00,
     & 0.11884D+01, 0.11760D+01, 0.11626D+01, 0.11482D+01, 0.11330D+01,
     & 0.11169D+01, 0.10992D+01, 0.10814D+01, 0.10634D+01, 0.10452D+01,
     & 0.10270D+01, 0.10081D+01, 0.98904D+00, 0.97019D+00, 0.95156D+00,
     & 0.93314D+00, 0.91492D+00, 0.89676D+00, 0.87846D+00, 0.86054D+00,
     & 0.84297D+00, 0.82575D+00, 0.80887D+00, 0.79230D+00, 0.77602D+00,
     & 0.75974D+00, 0.74385D+00, 0.72833D+00, 0.71318D+00, 0.69838D+00,
     & 0.12739D+01, 0.12551D+01, 0.12356D+01, 0.12154D+01, 0.11947D+01,
     & 0.11733D+01, 0.11505D+01, 0.11279D+01, 0.11053D+01, 0.10829D+01,
     & 0.10605D+01, 0.10378D+01, 0.10151D+01, 0.99283D+00, 0.97095D+00,
     & 0.94947D+00, 0.92836D+00, 0.90749D+00, 0.88665D+00, 0.86632D+00,
     & 0.84650D+00, 0.82715D+00, 0.80827D+00, 0.78982D+00, 0.77178D+00,
     & 0.75387D+00, 0.73645D+00, 0.71950D+00, 0.70299D+00, 0.68692D+00/

      data ((g_grdl(i,j),j=1,30),i=41,50)/
     & 0.13655D+01, 0.13389D+01, 0.13120D+01, 0.12850D+01, 0.12578D+01,
     & 0.12302D+01, 0.12017D+01, 0.11736D+01, 0.11460D+01, 0.11187D+01,
     & 0.10918D+01, 0.10649D+01, 0.10382D+01, 0.10121D+01, 0.98672D+00,
     & 0.96194D+00, 0.93775D+00, 0.91398D+00, 0.89046D+00, 0.86762D+00,
     & 0.84543D+00, 0.82388D+00, 0.80292D+00, 0.78254D+00, 0.76270D+00,
     & 0.74317D+00, 0.72422D+00, 0.70584D+00, 0.68800D+00, 0.67069D+00,
     & 0.14626D+01, 0.14268D+01, 0.13913D+01, 0.13562D+01, 0.13214D+01,
     & 0.12868D+01, 0.12516D+01, 0.12172D+01, 0.11837D+01, 0.11510D+01,
     & 0.11191D+01, 0.10874D+01, 0.10563D+01, 0.10262D+01, 0.99695D+00,
     & 0.96861D+00, 0.94111D+00, 0.91429D+00, 0.88798D+00, 0.86254D+00,
     & 0.83794D+00, 0.81413D+00, 0.79109D+00, 0.76878D+00, 0.74715D+00,
     & 0.72605D+00, 0.70564D+00, 0.68590D+00, 0.66681D+00, 0.64833D+00,
     & 0.15644D+01, 0.15175D+01, 0.14717D+01, 0.14270D+01, 0.13834D+01,
     & 0.13406D+01, 0.12978D+01, 0.12564D+01, 0.12163D+01, 0.11776D+01,
     & 0.11400D+01, 0.11032D+01, 0.10674D+01, 0.10329D+01, 0.99963D+00,
     & 0.96754D+00, 0.93658D+00, 0.90661D+00, 0.87747D+00, 0.84941D+00,
     & 0.82238D+00, 0.79634D+00, 0.77125D+00, 0.74705D+00, 0.72372D+00,
     & 0.70115D+00, 0.67940D+00, 0.65843D+00, 0.63821D+00, 0.61871D+00,
     & 0.16689D+01, 0.16088D+01, 0.15508D+01, 0.14948D+01, 0.14408D+01,
     & 0.13885D+01, 0.13370D+01, 0.12877D+01, 0.12403D+01, 0.11948D+01,
     & 0.11511D+01, 0.11087D+01, 0.10679D+01, 0.10288D+01, 0.99130D+00,
     & 0.95534D+00, 0.92084D+00, 0.88771D+00, 0.85583D+00, 0.82525D+00,
     & 0.79593D+00, 0.76780D+00, 0.74081D+00, 0.71491D+00, 0.69005D+00,
     & 0.66627D+00, 0.64342D+00, 0.62146D+00, 0.60035D+00, 0.58007D+00,
     & 0.17714D+01, 0.16953D+01, 0.16227D+01, 0.15535D+01, 0.14874D+01,
     & 0.14242D+01, 0.13631D+01, 0.13049D+01, 0.12496D+01, 0.11968D+01,
     & 0.11465D+01, 0.10984D+01, 0.10525D+01, 0.10088D+01, 0.96706D+00,
     & 0.92732D+00, 0.88942D+00, 0.85333D+00, 0.81899D+00, 0.78619D+00,
     & 0.75488D+00, 0.72498D+00, 0.69642D+00, 0.66915D+00, 0.64313D+00,
     & 0.61853D+00, 0.59496D+00, 0.57240D+00, 0.55080D+00, 0.53011D+00,
     & 0.18667D+01, 0.17712D+01, 0.16811D+01, 0.15962D+01, 0.15161D+01,
     & 0.14404D+01, 0.13691D+01, 0.13016D+01, 0.12379D+01, 0.11776D+01,
     & 0.11206D+01, 0.10669D+01, 0.10162D+01, 0.96810D+00, 0.92254D+00,
     & 0.87936D+00, 0.83844D+00, 0.79979D+00, 0.76347D+00, 0.72894D+00,
     & 0.69611D+00, 0.66492D+00, 0.63527D+00, 0.60711D+00, 0.58041D+00,
     & 0.55550D+00, 0.53173D+00, 0.50906D+00, 0.48744D+00, 0.46683D+00,
     & 0.19466D+01, 0.18319D+01, 0.17242D+01, 0.16230D+01, 0.15281D+01,
     & 0.14389D+01, 0.13550D+01, 0.12762D+01, 0.12023D+01, 0.11329D+01,
     & 0.10679D+01, 0.10074D+01, 0.95080D+00, 0.89757D+00, 0.84752D+00,
     & 0.80050D+00, 0.75633D+00, 0.71514D+00, 0.67715D+00, 0.64127D+00,
     & 0.60739D+00, 0.57542D+00, 0.54528D+00, 0.51687D+00, 0.49018D+00,
     & 0.46590D+00, 0.44285D+00, 0.42099D+00, 0.40026D+00, 0.38061D+00,
     & 0.20464D+01, 0.18775D+01, 0.17230D+01, 0.15820D+01, 0.14534D+01,
     & 0.13371D+01, 0.12357D+01, 0.11421D+01, 0.10559D+01, 0.97671D+00,
     & 0.90402D+00, 0.83958D+00, 0.78148D+00, 0.72747D+00, 0.67734D+00,
     & 0.63087D+00, 0.58787D+00, 0.54877D+00, 0.51420D+00, 0.48182D+00,
     & 0.45151D+00, 0.42317D+00, 0.39671D+00, 0.37204D+00, 0.34917D+00,
     & 0.32922D+00, 0.31039D+00, 0.29263D+00, 0.27591D+00, 0.26017D+00,
     & 0.15202D+01, 0.13687D+01, 0.12319D+01, 0.11087D+01, 0.99810D+00,
     & 0.90022D+00, 0.81872D+00, 0.74434D+00, 0.67663D+00, 0.61517D+00,
     & 0.55960D+00, 0.51206D+00, 0.47038D+00, 0.43197D+00, 0.39664D+00,
     & 0.36423D+00, 0.33458D+00, 0.30818D+00, 0.28570D+00, 0.26478D+00,
     & 0.24534D+00, 0.22730D+00, 0.21060D+00, 0.19517D+00, 0.18105D+00,
     & 0.16922D+00, 0.15812D+00, 0.14770D+00, 0.13795D+00, 0.12884D+00,
     & 0.10036D+00, 0.89501D-01, 0.79740D-01, 0.70996D-01, 0.63198D-01,
     & 0.56356D-01, 0.50773D-01, 0.45701D-01, 0.41109D-01, 0.36966D-01,
     & 0.33244D-01, 0.30117D-01, 0.27414D-01, 0.24935D-01, 0.22666D-01,
     & 0.20596D-01, 0.18714D-01, 0.17058D-01, 0.15680D-01, 0.14403D-01,
     & 0.13221D-01, 0.12129D-01, 0.11124D-01, 0.10202D-01, 0.93642D-02,
     & 0.86822D-02, 0.80444D-02, 0.74487D-02, 0.68934D-02, 0.63767D-02/

      data ((c_grdl(i,j),j=1,30),i=1,10)/
     & 0.48881D-02, 0.48920D-02, 0.48953D-02, 0.48983D-02, 0.49009D-02,
     & 0.49032D-02, 0.49052D-02, 0.49070D-02, 0.49085D-02, 0.49099D-02,
     & 0.49111D-02, 0.49122D-02, 0.49132D-02, 0.49140D-02, 0.49147D-02,
     & 0.49154D-02, 0.49160D-02, 0.49165D-02, 0.49169D-02, 0.49174D-02,
     & 0.49177D-02, 0.49180D-02, 0.49183D-02, 0.49186D-02, 0.49188D-02,
     & 0.49190D-02, 0.49191D-02, 0.49193D-02, 0.49194D-02, 0.49195D-02,
     & 0.48775D-02, 0.48821D-02, 0.48862D-02, 0.48897D-02, 0.48929D-02,
     & 0.48956D-02, 0.48981D-02, 0.49002D-02, 0.49021D-02, 0.49037D-02,
     & 0.49052D-02, 0.49065D-02, 0.49076D-02, 0.49086D-02, 0.49095D-02,
     & 0.49103D-02, 0.49110D-02, 0.49116D-02, 0.49121D-02, 0.49126D-02,
     & 0.49131D-02, 0.49134D-02, 0.49138D-02, 0.49141D-02, 0.49143D-02,
     & 0.49146D-02, 0.49148D-02, 0.49149D-02, 0.49151D-02, 0.49152D-02,
     & 0.48646D-02, 0.48702D-02, 0.48751D-02, 0.48795D-02, 0.48832D-02,
     & 0.48866D-02, 0.48895D-02, 0.48920D-02, 0.48943D-02, 0.48963D-02,
     & 0.48981D-02, 0.48996D-02, 0.49010D-02, 0.49022D-02, 0.49032D-02,
     & 0.49042D-02, 0.49050D-02, 0.49058D-02, 0.49064D-02, 0.49070D-02,
     & 0.49075D-02, 0.49079D-02, 0.49083D-02, 0.49087D-02, 0.49090D-02,
     & 0.49093D-02, 0.49095D-02, 0.49097D-02, 0.49099D-02, 0.49101D-02,
     & 0.48490D-02, 0.48558D-02, 0.48618D-02, 0.48670D-02, 0.48716D-02,
     & 0.48756D-02, 0.48791D-02, 0.48822D-02, 0.48850D-02, 0.48874D-02,
     & 0.48895D-02, 0.48913D-02, 0.48930D-02, 0.48944D-02, 0.48957D-02,
     & 0.48969D-02, 0.48979D-02, 0.48987D-02, 0.48995D-02, 0.49002D-02,
     & 0.49008D-02, 0.49014D-02, 0.49018D-02, 0.49023D-02, 0.49026D-02,
     & 0.49030D-02, 0.49033D-02, 0.49035D-02, 0.49038D-02, 0.49040D-02,
     & 0.48300D-02, 0.48383D-02, 0.48456D-02, 0.48519D-02, 0.48575D-02,
     & 0.48623D-02, 0.48666D-02, 0.48704D-02, 0.48737D-02, 0.48766D-02,
     & 0.48791D-02, 0.48814D-02, 0.48834D-02, 0.48851D-02, 0.48867D-02,
     & 0.48880D-02, 0.48892D-02, 0.48903D-02, 0.48912D-02, 0.48921D-02,
     & 0.48928D-02, 0.48935D-02, 0.48940D-02, 0.48945D-02, 0.48950D-02,
     & 0.48954D-02, 0.48957D-02, 0.48961D-02, 0.48963D-02, 0.48966D-02,
     & 0.48067D-02, 0.48169D-02, 0.48258D-02, 0.48335D-02, 0.48403D-02,
     & 0.48462D-02, 0.48514D-02, 0.48560D-02, 0.48600D-02, 0.48635D-02,
     & 0.48666D-02, 0.48693D-02, 0.48717D-02, 0.48739D-02, 0.48757D-02,
     & 0.48774D-02, 0.48788D-02, 0.48801D-02, 0.48813D-02, 0.48823D-02,
     & 0.48832D-02, 0.48839D-02, 0.48846D-02, 0.48852D-02, 0.48858D-02,
     & 0.48863D-02, 0.48867D-02, 0.48871D-02, 0.48874D-02, 0.48877D-02,
     & 0.49459D-02, 0.49141D-02, 0.48631D-02, 0.48111D-02, 0.48194D-02,
     & 0.48266D-02, 0.48330D-02, 0.48385D-02, 0.48434D-02, 0.48477D-02,
     & 0.48514D-02, 0.48548D-02, 0.48577D-02, 0.48602D-02, 0.48625D-02,
     & 0.48645D-02, 0.48663D-02, 0.48678D-02, 0.48692D-02, 0.48704D-02,
     & 0.48715D-02, 0.48724D-02, 0.48733D-02, 0.48740D-02, 0.48747D-02,
     & 0.48753D-02, 0.48758D-02, 0.48762D-02, 0.48766D-02, 0.48770D-02,
     & 0.49938D-02, 0.49773D-02, 0.49577D-02, 0.49341D-02, 0.49037D-02,
     & 0.48547D-02, 0.48104D-02, 0.48172D-02, 0.48231D-02, 0.48284D-02,
     & 0.48330D-02, 0.48370D-02, 0.48406D-02, 0.48437D-02, 0.48464D-02,
     & 0.48489D-02, 0.48510D-02, 0.48529D-02, 0.48546D-02, 0.48561D-02,
     & 0.48574D-02, 0.48585D-02, 0.48595D-02, 0.48604D-02, 0.48612D-02,
     & 0.48619D-02, 0.48625D-02, 0.48631D-02, 0.48636D-02, 0.48640D-02,
     & 0.50205D-02, 0.50115D-02, 0.50004D-02, 0.49874D-02, 0.49725D-02,
     & 0.49555D-02, 0.49361D-02, 0.49132D-02, 0.48834D-02, 0.48256D-02,
     & 0.48104D-02, 0.48153D-02, 0.48197D-02, 0.48235D-02, 0.48269D-02,
     & 0.48298D-02, 0.48324D-02, 0.48347D-02, 0.48368D-02, 0.48386D-02,
     & 0.48402D-02, 0.48416D-02, 0.48428D-02, 0.48439D-02, 0.48449D-02,
     & 0.48457D-02, 0.48465D-02, 0.48472D-02, 0.48478D-02, 0.48483D-02,
     & 0.50313D-02, 0.50287D-02, 0.50239D-02, 0.50171D-02, 0.50088D-02,
     & 0.49992D-02, 0.49885D-02, 0.49768D-02, 0.49642D-02, 0.49507D-02,
     & 0.49361D-02, 0.49202D-02, 0.49024D-02, 0.48812D-02, 0.48520D-02,
     & 0.48065D-02, 0.48097D-02, 0.48125D-02, 0.48150D-02, 0.48172D-02,
     & 0.48192D-02, 0.48209D-02, 0.48224D-02, 0.48238D-02, 0.48249D-02,
     & 0.48260D-02, 0.48269D-02, 0.48277D-02, 0.48285D-02, 0.48291D-02/

      data ((c_grdl(i,j),j=1,30),i=11,20)/
     & 0.52877D-02, 0.50303D-02, 0.50315D-02, 0.50305D-02, 0.50277D-02,
     & 0.50233D-02, 0.50177D-02, 0.50113D-02, 0.50041D-02, 0.49965D-02,
     & 0.49885D-02, 0.49803D-02, 0.49719D-02, 0.49634D-02, 0.49549D-02,
     & 0.49464D-02, 0.49380D-02, 0.49295D-02, 0.49212D-02, 0.49128D-02,
     & 0.49045D-02, 0.48962D-02, 0.48878D-02, 0.48793D-02, 0.48705D-02,
     & 0.48612D-02, 0.48512D-02, 0.48393D-02, 0.48222D-02, 0.48056D-02,
     & 0.53595D-02, 0.53329D-02, 0.53038D-02, 0.50283D-02, 0.50308D-02,
     & 0.50315D-02, 0.50307D-02, 0.50286D-02, 0.50256D-02, 0.50219D-02,
     & 0.50177D-02, 0.50132D-02, 0.50085D-02, 0.50037D-02, 0.49988D-02,
     & 0.49941D-02, 0.49895D-02, 0.49850D-02, 0.49807D-02, 0.49767D-02,
     & 0.49728D-02, 0.49692D-02, 0.49659D-02, 0.49627D-02, 0.49598D-02,
     & 0.49572D-02, 0.49547D-02, 0.49525D-02, 0.49504D-02, 0.49486D-02,
     & 0.54025D-02, 0.53887D-02, 0.53705D-02, 0.53490D-02, 0.53255D-02,
     & 0.53008D-02, 0.52754D-02, 0.50303D-02, 0.50313D-02, 0.50314D-02,
     & 0.50307D-02, 0.50293D-02, 0.50275D-02, 0.50254D-02, 0.50231D-02,
     & 0.50207D-02, 0.50182D-02, 0.50158D-02, 0.50135D-02, 0.50112D-02,
     & 0.50090D-02, 0.50070D-02, 0.50051D-02, 0.50033D-02, 0.50016D-02,
     & 0.50001D-02, 0.49987D-02, 0.49975D-02, 0.49963D-02, 0.49953D-02,
     & 0.54083D-02, 0.54111D-02, 0.54069D-02, 0.53975D-02, 0.53843D-02,
     & 0.53684D-02, 0.53508D-02, 0.53322D-02, 0.53132D-02, 0.52941D-02,
     & 0.52754D-02, 0.50298D-02, 0.50309D-02, 0.50314D-02, 0.50315D-02,
     & 0.50313D-02, 0.50308D-02, 0.50302D-02, 0.50294D-02, 0.50286D-02,
     & 0.50277D-02, 0.50269D-02, 0.50260D-02, 0.50252D-02, 0.50245D-02,
     & 0.50237D-02, 0.50230D-02, 0.50224D-02, 0.50218D-02, 0.50213D-02,
     & 0.53655D-02, 0.53899D-02, 0.54041D-02, 0.54104D-02, 0.54106D-02,
     & 0.54062D-02, 0.53985D-02, 0.53883D-02, 0.53766D-02, 0.53639D-02,
     & 0.53508D-02, 0.53376D-02, 0.53246D-02, 0.53119D-02, 0.52999D-02,
     & 0.52884D-02, 0.52777D-02, 0.50289D-02, 0.50297D-02, 0.50304D-02,
     & 0.50308D-02, 0.50310D-02, 0.50312D-02, 0.50314D-02, 0.50315D-02,
     & 0.50315D-02, 0.50315D-02, 0.50315D-02, 0.50314D-02, 0.50314D-02,
     & 0.52605D-02, 0.53124D-02, 0.53503D-02, 0.53768D-02, 0.53945D-02,
     & 0.54050D-02, 0.54101D-02, 0.54111D-02, 0.54089D-02, 0.54044D-02,
     & 0.53984D-02, 0.53914D-02, 0.53838D-02, 0.53758D-02, 0.53678D-02,
     & 0.53600D-02, 0.53524D-02, 0.53452D-02, 0.53384D-02, 0.53320D-02,
     & 0.53260D-02, 0.53206D-02, 0.53156D-02, 0.53110D-02, 0.53068D-02,
     & 0.53030D-02, 0.52996D-02, 0.52965D-02, 0.52937D-02, 0.52912D-02,
     & 0.50741D-02, 0.51622D-02, 0.52309D-02, 0.52837D-02, 0.53236D-02,
     & 0.53534D-02, 0.53750D-02, 0.53903D-02, 0.54006D-02, 0.54069D-02,
     & 0.54101D-02, 0.54111D-02, 0.54105D-02, 0.54086D-02, 0.54060D-02,
     & 0.54028D-02, 0.53992D-02, 0.53955D-02, 0.53918D-02, 0.53882D-02,
     & 0.53847D-02, 0.53813D-02, 0.53782D-02, 0.53752D-02, 0.53725D-02,
     & 0.53700D-02, 0.53677D-02, 0.53656D-02, 0.53637D-02, 0.53620D-02,
     & 0.47997D-02, 0.49262D-02, 0.50262D-02, 0.51127D-02, 0.51820D-02,
     & 0.52369D-02, 0.52800D-02, 0.53136D-02, 0.53398D-02, 0.53598D-02,
     & 0.53751D-02, 0.53865D-02, 0.53950D-02, 0.54011D-02, 0.54053D-02,
     & 0.54081D-02, 0.54099D-02, 0.54108D-02, 0.54111D-02, 0.54110D-02,
     & 0.54106D-02, 0.54100D-02, 0.54093D-02, 0.54085D-02, 0.54076D-02,
     & 0.54067D-02, 0.54059D-02, 0.54051D-02, 0.54043D-02, 0.54036D-02,
     & 0.43896D-02, 0.45786D-02, 0.47314D-02, 0.48552D-02, 0.49546D-02,
     & 0.50357D-02, 0.51064D-02, 0.51642D-02, 0.52112D-02, 0.52492D-02,
     & 0.52800D-02, 0.53048D-02, 0.53249D-02, 0.53412D-02, 0.53543D-02,
     & 0.53649D-02, 0.53734D-02, 0.53804D-02, 0.53860D-02, 0.53905D-02,
     & 0.53942D-02, 0.53971D-02, 0.53995D-02, 0.54015D-02, 0.54030D-02,
     & 0.54043D-02, 0.54054D-02, 0.54062D-02, 0.54069D-02, 0.54075D-02,
     & 0.51956D-02, 0.50371D-02, 0.47096D-02, 0.44717D-02, 0.46218D-02,
     & 0.47449D-02, 0.48461D-02, 0.49291D-02, 0.49966D-02, 0.50557D-02,
     & 0.51064D-02, 0.51489D-02, 0.51843D-02, 0.52138D-02, 0.52386D-02,
     & 0.52593D-02, 0.52766D-02, 0.52912D-02, 0.53035D-02, 0.53139D-02,
     & 0.53228D-02, 0.53304D-02, 0.53368D-02, 0.53423D-02, 0.53470D-02,
     & 0.53511D-02, 0.53546D-02, 0.53576D-02, 0.53602D-02, 0.53625D-02/

      data ((c_grdl(i,j),j=1,30),i=21,30)/
     & 0.48264D-02, 0.50826D-02, 0.51937D-02, 0.51605D-02, 0.49439D-02,
     & 0.47258D-02, 0.44583D-02, 0.45829D-02, 0.46866D-02, 0.47734D-02,
     & 0.48462D-02, 0.49071D-02, 0.49579D-02, 0.50005D-02, 0.50384D-02,
     & 0.50721D-02, 0.51008D-02, 0.51254D-02, 0.51466D-02, 0.51648D-02,
     & 0.51805D-02, 0.51941D-02, 0.52058D-02, 0.52159D-02, 0.52247D-02,
     & 0.52324D-02, 0.52390D-02, 0.52449D-02, 0.52499D-02, 0.52544D-02,
     & 0.49620D-02, 0.50023D-02, 0.49581D-02, 0.49505D-02, 0.51243D-02,
     & 0.51973D-02, 0.51690D-02, 0.50292D-02, 0.46897D-02, 0.47595D-02,
     & 0.44584D-02, 0.45496D-02, 0.46269D-02, 0.46926D-02, 0.47488D-02,
     & 0.47968D-02, 0.48381D-02, 0.48735D-02, 0.49038D-02, 0.49300D-02,
     & 0.49525D-02, 0.49720D-02, 0.49888D-02, 0.50034D-02, 0.50162D-02,
     & 0.50285D-02, 0.50392D-02, 0.50486D-02, 0.50569D-02, 0.50641D-02,
     & 0.32276D-02, 0.43192D-02, 0.49142D-02, 0.49664D-02, 0.49502D-02,
     & 0.49223D-02, 0.49313D-02, 0.50871D-02, 0.51730D-02, 0.51999D-02,
     & 0.51690D-02, 0.50825D-02, 0.49303D-02, 0.46500D-02, 0.47304D-02,
     & 0.43853D-02, 0.44463D-02, 0.44991D-02, 0.45447D-02, 0.45843D-02,
     & 0.46187D-02, 0.46485D-02, 0.46745D-02, 0.46972D-02, 0.47172D-02,
     & 0.47346D-02, 0.47499D-02, 0.47633D-02, 0.47751D-02, 0.47854D-02,
     & 0.27337D-04, 0.12108D-02, 0.26021D-02, 0.37257D-02, 0.45296D-02,
     & 0.49415D-02, 0.49896D-02, 0.50022D-02, 0.49934D-02, 0.47625D-02,
     & 0.49314D-02, 0.50507D-02, 0.51287D-02, 0.51765D-02, 0.51980D-02,
     & 0.51965D-02, 0.51757D-02, 0.51390D-02, 0.50891D-02, 0.50266D-02,
     & 0.49520D-02, 0.48637D-02, 0.47565D-02, 0.46146D-02, 0.46924D-02,
     & 0.47135D-02, 0.47317D-02, 0.47476D-02, 0.43531D-02, 0.43684D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.38758D-03, 0.15905D-02,
     & 0.27275D-02, 0.36454D-02, 0.43415D-02, 0.47891D-02, 0.49685D-02,
     & 0.49896D-02, 0.49886D-02, 0.49560D-02, 0.49931D-02, 0.49070D-02,
     & 0.48195D-02, 0.49138D-02, 0.49879D-02, 0.50451D-02, 0.50886D-02,
     & 0.51215D-02, 0.51459D-02, 0.51652D-02, 0.51791D-02, 0.51886D-02,
     & 0.51947D-02, 0.51982D-02, 0.51998D-02, 0.51998D-02, 0.51988D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.72651D-03,
     & 0.18859D-02, 0.29241D-02, 0.37558D-02, 0.43816D-02, 0.47878D-02,
     & 0.49681D-02, 0.49976D-02, 0.49632D-02, 0.49947D-02, 0.49839D-02,
     & 0.49840D-02, 0.48567D-02, 0.48190D-02, 0.48968D-02, 0.49597D-02,
     & 0.50100D-02, 0.50499D-02, 0.50816D-02, 0.51066D-02, 0.51266D-02,
     & 0.51422D-02, 0.51550D-02, 0.51656D-02, 0.51738D-02, 0.51802D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.87480D-04,
     & 0.10520D-02, 0.21379D-02, 0.30748D-02, 0.38315D-02, 0.43984D-02,
     & 0.47735D-02, 0.49590D-02, 0.49896D-02, 0.49227D-02, 0.49984D-02,
     & 0.49510D-02, 0.49905D-02, 0.49812D-02, 0.48906D-02, 0.47894D-02,
     & 0.48555D-02, 0.49101D-02, 0.49553D-02, 0.49924D-02, 0.50230D-02,
     & 0.50483D-02, 0.50691D-02, 0.50862D-02, 0.51004D-02, 0.51124D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.31385D-03, 0.13370D-02, 0.23418D-02, 0.31893D-02, 0.38751D-02,
     & 0.43929D-02, 0.47452D-02, 0.49372D-02, 0.49641D-02, 0.49813D-02,
     & 0.49667D-02, 0.50023D-02, 0.49586D-02, 0.49895D-02, 0.49890D-02,
     & 0.49497D-02, 0.48092D-02, 0.47907D-02, 0.48388D-02, 0.48793D-02,
     & 0.49137D-02, 0.49428D-02, 0.49674D-02, 0.49883D-02, 0.50061D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.57729D-03, 0.15732D-02, 0.24960D-02, 0.32643D-02,
     & 0.38886D-02, 0.43656D-02, 0.47013D-02, 0.49018D-02, 0.49600D-02,
     & 0.49955D-02, 0.49077D-02, 0.49788D-02, 0.50022D-02, 0.49495D-02,
     & 0.49806D-02, 0.49932D-02, 0.49868D-02, 0.49602D-02, 0.49039D-02,
     & 0.47447D-02, 0.47813D-02, 0.48126D-02, 0.48395D-02, 0.48626D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.55786D-04, 0.82288D-03, 0.17584D-02, 0.26039D-02,
     & 0.33022D-02, 0.38735D-02, 0.43163D-02, 0.46393D-02, 0.48484D-02,
     & 0.49589D-02, 0.49613D-02, 0.49973D-02, 0.49144D-02, 0.49728D-02,
     & 0.50004D-02, 0.49909D-02, 0.49571D-02, 0.49787D-02, 0.49906D-02,
     & 0.49933D-02, 0.49878D-02, 0.49748D-02, 0.49542D-02, 0.49249D-02/

      data ((c_grdl(i,j),j=1,30),i=31,40)/
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.20539D-03, 0.10313D-02, 0.18943D-02,
     & 0.26685D-02, 0.33053D-02, 0.38305D-02, 0.42444D-02, 0.45569D-02,
     & 0.47745D-02, 0.49097D-02, 0.49691D-02, 0.49704D-02, 0.49976D-02,
     & 0.49190D-02, 0.49485D-02, 0.49834D-02, 0.50005D-02, 0.49991D-02,
     & 0.49562D-02, 0.49584D-02, 0.49728D-02, 0.49829D-02, 0.49894D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.37806D-03, 0.11932D-02,
     & 0.19858D-02, 0.26932D-02, 0.32754D-02, 0.37601D-02, 0.41489D-02,
     & 0.44518D-02, 0.46758D-02, 0.48297D-02, 0.49261D-02, 0.49691D-02,
     & 0.49589D-02, 0.49931D-02, 0.49921D-02, 0.48995D-02, 0.49392D-02,
     & 0.49678D-02, 0.49870D-02, 0.49982D-02, 0.50023D-02, 0.49996D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.10908D-04, 0.53489D-03,
     & 0.13083D-02, 0.20340D-02, 0.26803D-02, 0.32135D-02, 0.36623D-02,
     & 0.40297D-02, 0.43219D-02, 0.45490D-02, 0.47180D-02, 0.48370D-02,
     & 0.49165D-02, 0.49623D-02, 0.49520D-02, 0.49667D-02, 0.49907D-02,
     & 0.49975D-02, 0.49847D-02, 0.49184D-02, 0.49208D-02, 0.49419D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.72807D-04,
     & 0.65777D-03, 0.13777D-02, 0.20403D-02, 0.26319D-02, 0.31209D-02,
     & 0.35386D-02, 0.38849D-02, 0.41659D-02, 0.43927D-02, 0.45707D-02,
     & 0.47069D-02, 0.48076D-02, 0.48805D-02, 0.49299D-02, 0.49612D-02,
     & 0.49678D-02, 0.49406D-02, 0.49661D-02, 0.49833D-02, 0.49934D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.15015D-03, 0.74047D-03, 0.14034D-02, 0.20070D-02, 0.25492D-02,
     & 0.30016D-02, 0.33883D-02, 0.37130D-02, 0.39842D-02, 0.42063D-02,
     & 0.43882D-02, 0.45344D-02, 0.46504D-02, 0.47410D-02, 0.48106D-02,
     & 0.48640D-02, 0.49041D-02, 0.49332D-02, 0.49543D-02, 0.49662D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.21621D-03, 0.78218D-03, 0.13882D-02, 0.19379D-02,
     & 0.24336D-02, 0.28543D-02, 0.32098D-02, 0.35159D-02, 0.37743D-02,
     & 0.39913D-02, 0.41714D-02, 0.43219D-02, 0.44461D-02, 0.45481D-02,
     & 0.46315D-02, 0.46992D-02, 0.47540D-02, 0.47982D-02, 0.48338D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.25809D-03, 0.78408D-03, 0.13347D-02,
     & 0.18357D-02, 0.22862D-02, 0.26781D-02, 0.30071D-02, 0.32929D-02,
     & 0.35374D-02, 0.37462D-02, 0.39238D-02, 0.40731D-02, 0.41999D-02,
     & 0.43072D-02, 0.43977D-02, 0.44739D-02, 0.45382D-02, 0.45923D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.23486D-05, 0.27114D-03, 0.74882D-03,
     & 0.12461D-02, 0.17023D-02, 0.21085D-02, 0.24716D-02, 0.27818D-02,
     & 0.30439D-02, 0.32751D-02, 0.34739D-02, 0.36438D-02, 0.37917D-02,
     & 0.39179D-02, 0.40256D-02, 0.41177D-02, 0.41976D-02, 0.42662D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.59191D-05, 0.25572D-03,
     & 0.68010D-03, 0.11251D-02, 0.15386D-02, 0.19053D-02, 0.22370D-02,
     & 0.25275D-02, 0.27767D-02, 0.29891D-02, 0.31748D-02, 0.33386D-02,
     & 0.34796D-02, 0.36010D-02, 0.37078D-02, 0.38005D-02, 0.38807D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.50521D-05,
     & 0.21569D-03, 0.58262D-03, 0.97608D-03, 0.13479D-02, 0.16825D-02,
     & 0.19777D-02, 0.22457D-02, 0.24801D-02, 0.26830D-02, 0.28571D-02,
     & 0.30076D-02, 0.31398D-02, 0.32578D-02, 0.33605D-02, 0.34497D-02/

      data ((c_grdl(i,j),j=1,30),i=41,50)/
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.11080D-05, 0.15799D-03, 0.46241D-03, 0.80331D-03, 0.11335D-02,
     & 0.14356D-02, 0.17049D-02, 0.19422D-02, 0.21573D-02, 0.23478D-02,
     & 0.25139D-02, 0.26585D-02, 0.27838D-02, 0.28927D-02, 0.29877D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.92848D-04, 0.32890D-03, 0.61498D-03,
     & 0.90134D-03, 0.11694D-02, 0.14128D-02, 0.16295D-02, 0.18205D-02,
     & 0.19900D-02, 0.21441D-02, 0.22802D-02, 0.23997D-02, 0.25043D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.34445D-04, 0.19564D-03,
     & 0.42003D-03, 0.65973D-03, 0.89124D-03, 0.11060D-02, 0.13003D-02,
     & 0.14740D-02, 0.16287D-02, 0.17649D-02, 0.18847D-02, 0.19925D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.15475D-05,
     & 0.81221D-04, 0.23583D-03, 0.42148D-03, 0.61215D-03, 0.79416D-03,
     & 0.96341D-03, 0.11171D-02, 0.12554D-02, 0.13790D-02, 0.14883D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.10044D-04, 0.87164D-04, 0.20886D-03, 0.34963D-03,
     & 0.49398D-03, 0.63299D-03, 0.76234D-03, 0.88124D-03, 0.98915D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.57337D-05, 0.54998D-04,
     & 0.13560D-03, 0.23139D-03, 0.33218D-03, 0.43175D-03, 0.52646D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.12707D-04, 0.50681D-04, 0.10317D-03, 0.16280D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.93890D-06,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00/

      DO I=1,50
        DO J=1,30
          UDS_GRD(I,J) = UDS_GRDL(I,J)
          G_GRD(I,J)   = G_GRDL(I,J)
          C_GRD(I,J)   = C_GRDL(I,J)
        ENDDO
      ENDDO

      RETURN
      END
*CMZ :  2.08/01 16/06/99  19.30.58  by  Hannes Jung
*CMZ :  2.06/29 15/03/98  20.30.01  by  Hannes Jung
*CMZ :  2.06/17 11/08/97  140.2 71/6
*-- Author :
C========================================================================
C 2D Interpolation to point within square (path dependent but simple)
C========================================================================
      FUNCTION XYINTER(X1,X2,Y1,Y2,XT,YT,F11,F12,F21,F22)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)

      XEXP = (XT-X1)/(X2-X1)
      YEXP = (YT-Y1)/(Y2-Y1)

      XYINTER = F11 + XEXP*(F21-F11)
     &          + YEXP*(F12 + XEXP*(F22-F12) - (F11 + XEXP*(F21-F11)))
      RETURN
      END
*CMZ :  2.06/29 15/03/98  20.30.01  by  Hannes Jung
*CMZ :  2.06/17 11/08/97  140.2 71/6
*-- Author :
      SUBROUTINE I_NLO_Q3G0
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NQ2MAX=30,NZMAX=50)
      DIMENSION UDS_GRD(NZMAX,NQ2MAX),C_GRD(NZMAX,NQ2MAX),
     &          G_GRD(NZMAX,NQ2MAX)
      DIMENSION UDS_GRDL(NZMAX,NQ2MAX),C_GRDL(NZMAX,NQ2MAX),
     &          G_GRDL(NZMAX,NQ2MAX)
      COMMON /CPARAM/ UDS_GRD,C_GRD,G_GRD

      data ((uds_grdl(i,j),j=1,30),i=1,10)/
     & 0.11592D-01, 0.11667D-01, 0.11748D-01, 0.11835D-01, 0.11926D-01,
     & 0.12021D-01, 0.12120D-01, 0.12223D-01, 0.12330D-01, 0.12439D-01,
     & 0.12552D-01, 0.12668D-01, 0.12786D-01, 0.12907D-01, 0.13030D-01,
     & 0.13155D-01, 0.13282D-01, 0.13411D-01, 0.13541D-01, 0.13674D-01,
     & 0.13807D-01, 0.13942D-01, 0.14079D-01, 0.14217D-01, 0.14356D-01,
     & 0.14495D-01, 0.14636D-01, 0.14778D-01, 0.14920D-01, 0.15063D-01,
     & 0.11649D-01, 0.11722D-01, 0.11801D-01, 0.11884D-01, 0.11972D-01,
     & 0.12064D-01, 0.12159D-01, 0.12258D-01, 0.12360D-01, 0.12465D-01,
     & 0.12573D-01, 0.12683D-01, 0.12795D-01, 0.12910D-01, 0.13027D-01,
     & 0.13146D-01, 0.13266D-01, 0.13388D-01, 0.13512D-01, 0.13637D-01,
     & 0.13763D-01, 0.13891D-01, 0.14019D-01, 0.14149D-01, 0.14280D-01,
     & 0.14411D-01, 0.14543D-01, 0.14676D-01, 0.14810D-01, 0.14944D-01,
     & 0.11717D-01, 0.11788D-01, 0.11864D-01, 0.11945D-01, 0.12030D-01,
     & 0.12118D-01, 0.12209D-01, 0.12304D-01, 0.12402D-01, 0.12502D-01,
     & 0.12605D-01, 0.12710D-01, 0.12817D-01, 0.12926D-01, 0.13037D-01,
     & 0.13149D-01, 0.13264D-01, 0.13379D-01, 0.13496D-01, 0.13614D-01,
     & 0.13733D-01, 0.13853D-01, 0.13975D-01, 0.14097D-01, 0.14219D-01,
     & 0.14343D-01, 0.14467D-01, 0.14592D-01, 0.14717D-01, 0.14843D-01,
     & 0.11798D-01, 0.11868D-01, 0.11942D-01, 0.12020D-01, 0.12101D-01,
     & 0.12186D-01, 0.12274D-01, 0.12365D-01, 0.12459D-01, 0.12555D-01,
     & 0.12653D-01, 0.12753D-01, 0.12855D-01, 0.12959D-01, 0.13064D-01,
     & 0.13171D-01, 0.13279D-01, 0.13388D-01, 0.13499D-01, 0.13610D-01,
     & 0.13722D-01, 0.13836D-01, 0.13950D-01, 0.14064D-01, 0.14180D-01,
     & 0.14296D-01, 0.14412D-01, 0.14529D-01, 0.14646D-01, 0.14764D-01,
     & 0.11892D-01, 0.11960D-01, 0.12032D-01, 0.12108D-01, 0.12187D-01,
     & 0.12269D-01, 0.12353D-01, 0.12441D-01, 0.12530D-01, 0.12622D-01,
     & 0.12716D-01, 0.12811D-01, 0.12908D-01, 0.13007D-01, 0.13107D-01,
     & 0.13208D-01, 0.13310D-01, 0.13413D-01, 0.13518D-01, 0.13623D-01,
     & 0.13729D-01, 0.13836D-01, 0.13943D-01, 0.14051D-01, 0.14159D-01,
     & 0.14268D-01, 0.14377D-01, 0.14486D-01, 0.14596D-01, 0.14706D-01,
     & 0.12003D-01, 0.12069D-01, 0.12139D-01, 0.12212D-01, 0.12289D-01,
     & 0.12368D-01, 0.12449D-01, 0.12533D-01, 0.12619D-01, 0.12706D-01,
     & 0.12796D-01, 0.12887D-01, 0.12979D-01, 0.13073D-01, 0.13168D-01,
     & 0.13264D-01, 0.13360D-01, 0.13458D-01, 0.13557D-01, 0.13656D-01,
     & 0.13755D-01, 0.13856D-01, 0.13956D-01, 0.14058D-01, 0.14159D-01,
     & 0.14261D-01, 0.14363D-01, 0.14465D-01, 0.14568D-01, 0.14670D-01,
     & 0.12132D-01, 0.12197D-01, 0.12265D-01, 0.12336D-01, 0.12410D-01,
     & 0.12487D-01, 0.12565D-01, 0.12646D-01, 0.12728D-01, 0.12812D-01,
     & 0.12897D-01, 0.12984D-01, 0.13072D-01, 0.13161D-01, 0.13251D-01,
     & 0.13342D-01, 0.13433D-01, 0.13525D-01, 0.13618D-01, 0.13712D-01,
     & 0.13806D-01, 0.13900D-01, 0.13994D-01, 0.14089D-01, 0.14184D-01,
     & 0.14280D-01, 0.14375D-01, 0.14471D-01, 0.14566D-01, 0.14662D-01,
     & 0.12285D-01, 0.12348D-01, 0.12415D-01, 0.12484D-01, 0.12556D-01,
     & 0.12630D-01, 0.12706D-01, 0.12783D-01, 0.12862D-01, 0.12942D-01,
     & 0.13024D-01, 0.13106D-01, 0.13190D-01, 0.13275D-01, 0.13360D-01,
     & 0.13446D-01, 0.13532D-01, 0.13619D-01, 0.13707D-01, 0.13795D-01,
     & 0.13883D-01, 0.13972D-01, 0.14060D-01, 0.14149D-01, 0.14238D-01,
     & 0.14327D-01, 0.14416D-01, 0.14505D-01, 0.14594D-01, 0.14683D-01,
     & 0.12466D-01, 0.12529D-01, 0.12594D-01, 0.12661D-01, 0.12731D-01,
     & 0.12802D-01, 0.12876D-01, 0.12950D-01, 0.13026D-01, 0.13103D-01,
     & 0.13181D-01, 0.13260D-01, 0.13339D-01, 0.13420D-01, 0.13500D-01,
     & 0.13582D-01, 0.13663D-01, 0.13746D-01, 0.13828D-01, 0.13911D-01,
     & 0.13994D-01, 0.14077D-01, 0.14160D-01, 0.14243D-01, 0.14326D-01,
     & 0.14409D-01, 0.14492D-01, 0.14575D-01, 0.14658D-01, 0.14741D-01,
     & 0.12677D-01, 0.12739D-01, 0.12803D-01, 0.12869D-01, 0.12937D-01,
     & 0.13006D-01, 0.13077D-01, 0.13148D-01, 0.13221D-01, 0.13295D-01,
     & 0.13369D-01, 0.13444D-01, 0.13520D-01, 0.13597D-01, 0.13673D-01,
     & 0.13750D-01, 0.13827D-01, 0.13905D-01, 0.13982D-01, 0.14060D-01,
     & 0.14138D-01, 0.14216D-01, 0.14293D-01, 0.14371D-01, 0.14448D-01,
     & 0.14526D-01, 0.14603D-01, 0.14680D-01, 0.14757D-01, 0.14834D-01/

      data ((uds_grdl(i,j),j=1,30),i=11,20)/
     & 0.12924D-01, 0.12985D-01, 0.13048D-01, 0.13113D-01, 0.13179D-01,
     & 0.13246D-01, 0.13314D-01, 0.13383D-01, 0.13453D-01, 0.13524D-01,
     & 0.13594D-01, 0.13666D-01, 0.13738D-01, 0.13811D-01, 0.13883D-01,
     & 0.13956D-01, 0.14028D-01, 0.14101D-01, 0.14174D-01, 0.14247D-01,
     & 0.14320D-01, 0.14393D-01, 0.14465D-01, 0.14537D-01, 0.14609D-01,
     & 0.14681D-01, 0.14753D-01, 0.14824D-01, 0.14896D-01, 0.14966D-01,
     & 0.13216D-01, 0.13277D-01, 0.13339D-01, 0.13402D-01, 0.13466D-01,
     & 0.13531D-01, 0.13597D-01, 0.13663D-01, 0.13731D-01, 0.13798D-01,
     & 0.13866D-01, 0.13934D-01, 0.14002D-01, 0.14071D-01, 0.14139D-01,
     & 0.14208D-01, 0.14276D-01, 0.14344D-01, 0.14413D-01, 0.14481D-01,
     & 0.14549D-01, 0.14617D-01, 0.14684D-01, 0.14751D-01, 0.14818D-01,
     & 0.14885D-01, 0.14951D-01, 0.15017D-01, 0.15083D-01, 0.15148D-01,
     & 0.13558D-01, 0.13618D-01, 0.13678D-01, 0.13740D-01, 0.13802D-01,
     & 0.13865D-01, 0.13929D-01, 0.13993D-01, 0.14057D-01, 0.14121D-01,
     & 0.14186D-01, 0.14250D-01, 0.14315D-01, 0.14380D-01, 0.14444D-01,
     & 0.14508D-01, 0.14572D-01, 0.14636D-01, 0.14700D-01, 0.14764D-01,
     & 0.14827D-01, 0.14889D-01, 0.14952D-01, 0.15014D-01, 0.15075D-01,
     & 0.15137D-01, 0.15198D-01, 0.15258D-01, 0.15318D-01, 0.15378D-01,
     & 0.13962D-01, 0.14020D-01, 0.14080D-01, 0.14140D-01, 0.14200D-01,
     & 0.14261D-01, 0.14322D-01, 0.14383D-01, 0.14444D-01, 0.14505D-01,
     & 0.14566D-01, 0.14627D-01, 0.14688D-01, 0.14749D-01, 0.14809D-01,
     & 0.14869D-01, 0.14929D-01, 0.14988D-01, 0.15047D-01, 0.15106D-01,
     & 0.15164D-01, 0.15222D-01, 0.15279D-01, 0.15336D-01, 0.15392D-01,
     & 0.15448D-01, 0.15504D-01, 0.15559D-01, 0.15614D-01, 0.15668D-01,
     & 0.14437D-01, 0.14495D-01, 0.14553D-01, 0.14611D-01, 0.14669D-01,
     & 0.14727D-01, 0.14785D-01, 0.14843D-01, 0.14901D-01, 0.14958D-01,
     & 0.15016D-01, 0.15073D-01, 0.15130D-01, 0.15186D-01, 0.15242D-01,
     & 0.15297D-01, 0.15352D-01, 0.15407D-01, 0.15461D-01, 0.15515D-01,
     & 0.15568D-01, 0.15621D-01, 0.15673D-01, 0.15724D-01, 0.15775D-01,
     & 0.15826D-01, 0.15876D-01, 0.15925D-01, 0.15974D-01, 0.16022D-01,
     & 0.14985D-01, 0.15041D-01, 0.15096D-01, 0.15152D-01, 0.15207D-01,
     & 0.15262D-01, 0.15317D-01, 0.15371D-01, 0.15425D-01, 0.15478D-01,
     & 0.15531D-01, 0.15584D-01, 0.15636D-01, 0.15688D-01, 0.15739D-01,
     & 0.15789D-01, 0.15839D-01, 0.15888D-01, 0.15937D-01, 0.15985D-01,
     & 0.16033D-01, 0.16080D-01, 0.16126D-01, 0.16171D-01, 0.16217D-01,
     & 0.16261D-01, 0.16305D-01, 0.16349D-01, 0.16392D-01, 0.16434D-01,
     & 0.15625D-01, 0.15678D-01, 0.15730D-01, 0.15782D-01, 0.15833D-01,
     & 0.15884D-01, 0.15934D-01, 0.15984D-01, 0.16033D-01, 0.16082D-01,
     & 0.16129D-01, 0.16177D-01, 0.16223D-01, 0.16269D-01, 0.16315D-01,
     & 0.16359D-01, 0.16403D-01, 0.16446D-01, 0.16489D-01, 0.16531D-01,
     & 0.16572D-01, 0.16613D-01, 0.16653D-01, 0.16692D-01, 0.16731D-01,
     & 0.16769D-01, 0.16806D-01, 0.16843D-01, 0.16880D-01, 0.16915D-01,
     & 0.16366D-01, 0.16414D-01, 0.16462D-01, 0.16508D-01, 0.16554D-01,
     & 0.16599D-01, 0.16644D-01, 0.16688D-01, 0.16731D-01, 0.16773D-01,
     & 0.16814D-01, 0.16855D-01, 0.16895D-01, 0.16934D-01, 0.16973D-01,
     & 0.17010D-01, 0.17047D-01, 0.17083D-01, 0.17119D-01, 0.17154D-01,
     & 0.17188D-01, 0.17221D-01, 0.17253D-01, 0.17285D-01, 0.17316D-01,
     & 0.17347D-01, 0.17377D-01, 0.17407D-01, 0.17435D-01, 0.17463D-01,
     & 0.17218D-01, 0.17260D-01, 0.17300D-01, 0.17340D-01, 0.17379D-01,
     & 0.17416D-01, 0.17453D-01, 0.17489D-01, 0.17524D-01, 0.17558D-01,
     & 0.17591D-01, 0.17624D-01, 0.17655D-01, 0.17686D-01, 0.17716D-01,
     & 0.17744D-01, 0.17773D-01, 0.17800D-01, 0.17827D-01, 0.17853D-01,
     & 0.17878D-01, 0.17902D-01, 0.17926D-01, 0.17949D-01, 0.17971D-01,
     & 0.17993D-01, 0.18015D-01, 0.18035D-01, 0.18055D-01, 0.18075D-01,
     & 0.18189D-01, 0.18221D-01, 0.18252D-01, 0.18282D-01, 0.18310D-01,
     & 0.18337D-01, 0.18364D-01, 0.18389D-01, 0.18413D-01, 0.18436D-01,
     & 0.18459D-01, 0.18480D-01, 0.18501D-01, 0.18521D-01, 0.18539D-01,
     & 0.18557D-01, 0.18575D-01, 0.18591D-01, 0.18607D-01, 0.18622D-01,
     & 0.18636D-01, 0.18650D-01, 0.18663D-01, 0.18675D-01, 0.18687D-01,
     & 0.18698D-01, 0.18709D-01, 0.18719D-01, 0.18728D-01, 0.18737D-01/

      data ((uds_grdl(i,j),j=1,30),i=21,30)/
     & 0.19281D-01, 0.19299D-01, 0.19316D-01, 0.19331D-01, 0.19345D-01,
     & 0.19358D-01, 0.19370D-01, 0.19381D-01, 0.19391D-01, 0.19400D-01,
     & 0.19408D-01, 0.19415D-01, 0.19421D-01, 0.19427D-01, 0.19432D-01,
     & 0.19436D-01, 0.19439D-01, 0.19442D-01, 0.19444D-01, 0.19445D-01,
     & 0.19446D-01, 0.19446D-01, 0.19446D-01, 0.19445D-01, 0.19443D-01,
     & 0.19441D-01, 0.19439D-01, 0.19436D-01, 0.19433D-01, 0.19429D-01,
     & 0.20475D-01, 0.20473D-01, 0.20469D-01, 0.20464D-01, 0.20458D-01,
     & 0.20452D-01, 0.20444D-01, 0.20435D-01, 0.20426D-01, 0.20416D-01,
     & 0.20405D-01, 0.20393D-01, 0.20381D-01, 0.20368D-01, 0.20354D-01,
     & 0.20340D-01, 0.20325D-01, 0.20310D-01, 0.20295D-01, 0.20278D-01,
     & 0.20262D-01, 0.20245D-01, 0.20228D-01, 0.20210D-01, 0.20192D-01,
     & 0.20173D-01, 0.20155D-01, 0.20136D-01, 0.20117D-01, 0.20097D-01,
     & 0.21760D-01, 0.21729D-01, 0.21697D-01, 0.21665D-01, 0.21632D-01,
     & 0.21598D-01, 0.21564D-01, 0.21529D-01, 0.21494D-01, 0.21458D-01,
     & 0.21422D-01, 0.21385D-01, 0.21348D-01, 0.21311D-01, 0.21274D-01,
     & 0.21236D-01, 0.21199D-01, 0.21161D-01, 0.21122D-01, 0.21084D-01,
     & 0.21046D-01, 0.21007D-01, 0.20969D-01, 0.20930D-01, 0.20891D-01,
     & 0.20852D-01, 0.20814D-01, 0.20775D-01, 0.20736D-01, 0.20697D-01,
     & 0.23077D-01, 0.23007D-01, 0.22936D-01, 0.22866D-01, 0.22796D-01,
     & 0.22726D-01, 0.22657D-01, 0.22587D-01, 0.22517D-01, 0.22448D-01,
     & 0.22379D-01, 0.22310D-01, 0.22242D-01, 0.22173D-01, 0.22105D-01,
     & 0.22038D-01, 0.21970D-01, 0.21903D-01, 0.21837D-01, 0.21770D-01,
     & 0.21704D-01, 0.21639D-01, 0.21574D-01, 0.21509D-01, 0.21445D-01,
     & 0.21380D-01, 0.21317D-01, 0.21253D-01, 0.21190D-01, 0.21128D-01,
     & 0.24302D-01, 0.24179D-01, 0.24056D-01, 0.23935D-01, 0.23815D-01,
     & 0.23697D-01, 0.23580D-01, 0.23464D-01, 0.23349D-01, 0.23236D-01,
     & 0.23124D-01, 0.23013D-01, 0.22904D-01, 0.22795D-01, 0.22688D-01,
     & 0.22582D-01, 0.22477D-01, 0.22374D-01, 0.22271D-01, 0.22169D-01,
     & 0.22069D-01, 0.21970D-01, 0.21871D-01, 0.21774D-01, 0.21678D-01,
     & 0.21583D-01, 0.21489D-01, 0.21396D-01, 0.21303D-01, 0.21212D-01,
     & 0.24567D-01, 0.24427D-01, 0.24290D-01, 0.24154D-01, 0.24020D-01,
     & 0.23888D-01, 0.23757D-01, 0.23628D-01, 0.23501D-01, 0.23375D-01,
     & 0.23251D-01, 0.23129D-01, 0.23007D-01, 0.22888D-01, 0.22770D-01,
     & 0.22653D-01, 0.22538D-01, 0.22424D-01, 0.22311D-01, 0.22200D-01,
     & 0.22090D-01, 0.21982D-01, 0.21875D-01, 0.21769D-01, 0.21664D-01,
     & 0.21560D-01, 0.21458D-01, 0.21357D-01, 0.21257D-01, 0.21158D-01,
     & 0.24804D-01, 0.24648D-01, 0.24495D-01, 0.24344D-01, 0.24196D-01,
     & 0.24049D-01, 0.23905D-01, 0.23762D-01, 0.23622D-01, 0.23483D-01,
     & 0.23347D-01, 0.23212D-01, 0.23079D-01, 0.22948D-01, 0.22819D-01,
     & 0.22692D-01, 0.22566D-01, 0.22442D-01, 0.22319D-01, 0.22198D-01,
     & 0.22079D-01, 0.21961D-01, 0.21845D-01, 0.21730D-01, 0.21617D-01,
     & 0.21505D-01, 0.21394D-01, 0.21285D-01, 0.21177D-01, 0.21070D-01,
     & 0.25013D-01, 0.24841D-01, 0.24672D-01, 0.24505D-01, 0.24342D-01,
     & 0.24181D-01, 0.24022D-01, 0.23865D-01, 0.23712D-01, 0.23560D-01,
     & 0.23411D-01, 0.23264D-01, 0.23119D-01, 0.22977D-01, 0.22836D-01,
     & 0.22698D-01, 0.22561D-01, 0.22427D-01, 0.22294D-01, 0.22163D-01,
     & 0.22034D-01, 0.21907D-01, 0.21782D-01, 0.21658D-01, 0.21536D-01,
     & 0.21415D-01, 0.21296D-01, 0.21179D-01, 0.21063D-01, 0.20949D-01,
     & 0.25194D-01, 0.25004D-01, 0.24819D-01, 0.24636D-01, 0.24457D-01,
     & 0.24281D-01, 0.24107D-01, 0.23937D-01, 0.23769D-01, 0.23605D-01,
     & 0.23443D-01, 0.23283D-01, 0.23126D-01, 0.22972D-01, 0.22820D-01,
     & 0.22670D-01, 0.22523D-01, 0.22378D-01, 0.22235D-01, 0.22094D-01,
     & 0.21956D-01, 0.21819D-01, 0.21685D-01, 0.21552D-01, 0.21421D-01,
     & 0.21292D-01, 0.21165D-01, 0.21040D-01, 0.20916D-01, 0.20794D-01,
     & 0.25345D-01, 0.25138D-01, 0.24935D-01, 0.24736D-01, 0.24541D-01,
     & 0.24349D-01, 0.24161D-01, 0.23976D-01, 0.23794D-01, 0.23616D-01,
     & 0.23441D-01, 0.23269D-01, 0.23100D-01, 0.22933D-01, 0.22770D-01,
     & 0.22609D-01, 0.22451D-01, 0.22295D-01, 0.22142D-01, 0.21991D-01,
     & 0.21843D-01, 0.21697D-01, 0.21553D-01, 0.21411D-01, 0.21272D-01,
     & 0.21134D-01, 0.20999D-01, 0.20865D-01, 0.20734D-01, 0.20605D-01/

      data ((uds_grdl(i,j),j=1,30),i=31,40)/
     & 0.25467D-01, 0.25242D-01, 0.25021D-01, 0.24805D-01, 0.24593D-01,
     & 0.24385D-01, 0.24182D-01, 0.23982D-01, 0.23786D-01, 0.23594D-01,
     & 0.23406D-01, 0.23220D-01, 0.23038D-01, 0.22860D-01, 0.22685D-01,
     & 0.22512D-01, 0.22343D-01, 0.22177D-01, 0.22013D-01, 0.21852D-01,
     & 0.21694D-01, 0.21539D-01, 0.21386D-01, 0.21235D-01, 0.21087D-01,
     & 0.20941D-01, 0.20797D-01, 0.20656D-01, 0.20517D-01, 0.20380D-01,
     & 0.25558D-01, 0.25314D-01, 0.25074D-01, 0.24841D-01, 0.24612D-01,
     & 0.24388D-01, 0.24169D-01, 0.23954D-01, 0.23743D-01, 0.23537D-01,
     & 0.23335D-01, 0.23137D-01, 0.22942D-01, 0.22751D-01, 0.22564D-01,
     & 0.22380D-01, 0.22200D-01, 0.22023D-01, 0.21848D-01, 0.21677D-01,
     & 0.21509D-01, 0.21344D-01, 0.21182D-01, 0.21023D-01, 0.20866D-01,
     & 0.20712D-01, 0.20560D-01, 0.20410D-01, 0.20263D-01, 0.20119D-01,
     & 0.25618D-01, 0.25354D-01, 0.25096D-01, 0.24844D-01, 0.24598D-01,
     & 0.24357D-01, 0.24121D-01, 0.23891D-01, 0.23665D-01, 0.23445D-01,
     & 0.23229D-01, 0.23017D-01, 0.22809D-01, 0.22606D-01, 0.22406D-01,
     & 0.22211D-01, 0.22019D-01, 0.21831D-01, 0.21646D-01, 0.21465D-01,
     & 0.21287D-01, 0.21113D-01, 0.20941D-01, 0.20773D-01, 0.20608D-01,
     & 0.20445D-01, 0.20285D-01, 0.20127D-01, 0.19973D-01, 0.19821D-01,
     & 0.25646D-01, 0.25361D-01, 0.25083D-01, 0.24813D-01, 0.24548D-01,
     & 0.24290D-01, 0.24038D-01, 0.23791D-01, 0.23551D-01, 0.23315D-01,
     & 0.23085D-01, 0.22860D-01, 0.22639D-01, 0.22423D-01, 0.22211D-01,
     & 0.22004D-01, 0.21801D-01, 0.21602D-01, 0.21406D-01, 0.21215D-01,
     & 0.21027D-01, 0.20843D-01, 0.20662D-01, 0.20485D-01, 0.20311D-01,
     & 0.20140D-01, 0.19972D-01, 0.19807D-01, 0.19645D-01, 0.19486D-01,
     & 0.25642D-01, 0.25336D-01, 0.25038D-01, 0.24748D-01, 0.24465D-01,
     & 0.24189D-01, 0.23919D-01, 0.23656D-01, 0.23400D-01, 0.23149D-01,
     & 0.22905D-01, 0.22665D-01, 0.22431D-01, 0.22202D-01, 0.21978D-01,
     & 0.21759D-01, 0.21544D-01, 0.21334D-01, 0.21128D-01, 0.20926D-01,
     & 0.20728D-01, 0.20535D-01, 0.20345D-01, 0.20159D-01, 0.19976D-01,
     & 0.19796D-01, 0.19620D-01, 0.19448D-01, 0.19278D-01, 0.19112D-01,
     & 0.25599D-01, 0.25270D-01, 0.24950D-01, 0.24640D-01, 0.24338D-01,
     & 0.24043D-01, 0.23756D-01, 0.23476D-01, 0.23203D-01, 0.22937D-01,
     & 0.22677D-01, 0.22423D-01, 0.22175D-01, 0.21933D-01, 0.21696D-01,
     & 0.21465D-01, 0.21239D-01, 0.21018D-01, 0.20801D-01, 0.20589D-01,
     & 0.20381D-01, 0.20178D-01, 0.19979D-01, 0.19784D-01, 0.19593D-01,
     & 0.19405D-01, 0.19221D-01, 0.19041D-01, 0.18864D-01, 0.18690D-01,
     & 0.25522D-01, 0.25170D-01, 0.24828D-01, 0.24496D-01, 0.24174D-01,
     & 0.23860D-01, 0.23555D-01, 0.23257D-01, 0.22967D-01, 0.22685D-01,
     & 0.22410D-01, 0.22142D-01, 0.21880D-01, 0.21624D-01, 0.21375D-01,
     & 0.21131D-01, 0.20893D-01, 0.20660D-01, 0.20433D-01, 0.20210D-01,
     & 0.19992D-01, 0.19780D-01, 0.19571D-01, 0.19368D-01, 0.19168D-01,
     & 0.18972D-01, 0.18780D-01, 0.18592D-01, 0.18408D-01, 0.18228D-01,
     & 0.25408D-01, 0.25031D-01, 0.24666D-01, 0.24312D-01, 0.23969D-01,
     & 0.23635D-01, 0.23310D-01, 0.22994D-01, 0.22687D-01, 0.22389D-01,
     & 0.22098D-01, 0.21814D-01, 0.21538D-01, 0.21269D-01, 0.21006D-01,
     & 0.20750D-01, 0.20500D-01, 0.20256D-01, 0.20018D-01, 0.19785D-01,
     & 0.19557D-01, 0.19335D-01, 0.19117D-01, 0.18905D-01, 0.18697D-01,
     & 0.18493D-01, 0.18293D-01, 0.18098D-01, 0.17907D-01, 0.17720D-01,
     & 0.25253D-01, 0.24850D-01, 0.24460D-01, 0.24083D-01, 0.23717D-01,
     & 0.23362D-01, 0.23017D-01, 0.22683D-01, 0.22358D-01, 0.22042D-01,
     & 0.21735D-01, 0.21436D-01, 0.21145D-01, 0.20861D-01, 0.20586D-01,
     & 0.20317D-01, 0.20055D-01, 0.19799D-01, 0.19550D-01, 0.19306D-01,
     & 0.19069D-01, 0.18837D-01, 0.18610D-01, 0.18389D-01, 0.18173D-01,
     & 0.17961D-01, 0.17754D-01, 0.17552D-01, 0.17354D-01, 0.17161D-01,
     & 0.25053D-01, 0.24623D-01, 0.24206D-01, 0.23804D-01, 0.23415D-01,
     & 0.23038D-01, 0.22672D-01, 0.22317D-01, 0.21974D-01, 0.21640D-01,
     & 0.21316D-01, 0.21001D-01, 0.20695D-01, 0.20397D-01, 0.20107D-01,
     & 0.19826D-01, 0.19551D-01, 0.19284D-01, 0.19024D-01, 0.18770D-01,
     & 0.18522D-01, 0.18281D-01, 0.18045D-01, 0.17815D-01, 0.17591D-01,
     & 0.17372D-01, 0.17158D-01, 0.16948D-01, 0.16744D-01, 0.16544D-01/

      data ((uds_grdl(i,j),j=1,30),i=41,50)/
     & 0.24804D-01, 0.24343D-01, 0.23899D-01, 0.23470D-01, 0.23055D-01,
     & 0.22655D-01, 0.22267D-01, 0.21891D-01, 0.21528D-01, 0.21175D-01,
     & 0.20834D-01, 0.20502D-01, 0.20181D-01, 0.19868D-01, 0.19565D-01,
     & 0.19270D-01, 0.18983D-01, 0.18704D-01, 0.18433D-01, 0.18168D-01,
     & 0.17911D-01, 0.17660D-01, 0.17416D-01, 0.17178D-01, 0.16946D-01,
     & 0.16719D-01, 0.16498D-01, 0.16282D-01, 0.16072D-01, 0.15866D-01,
     & 0.24498D-01, 0.24005D-01, 0.23530D-01, 0.23072D-01, 0.22631D-01,
     & 0.22205D-01, 0.21793D-01, 0.21395D-01, 0.21011D-01, 0.20639D-01,
     & 0.20279D-01, 0.19931D-01, 0.19593D-01, 0.19265D-01, 0.18947D-01,
     & 0.18639D-01, 0.18339D-01, 0.18049D-01, 0.17766D-01, 0.17491D-01,
     & 0.17224D-01, 0.16964D-01, 0.16711D-01, 0.16465D-01, 0.16225D-01,
     & 0.15992D-01, 0.15764D-01, 0.15542D-01, 0.15326D-01, 0.15114D-01,
     & 0.24123D-01, 0.23593D-01, 0.23085D-01, 0.22595D-01, 0.22125D-01,
     & 0.21671D-01, 0.21235D-01, 0.20813D-01, 0.20407D-01, 0.20015D-01,
     & 0.19635D-01, 0.19269D-01, 0.18914D-01, 0.18571D-01, 0.18239D-01,
     & 0.17917D-01, 0.17605D-01, 0.17302D-01, 0.17009D-01, 0.16724D-01,
     & 0.16447D-01, 0.16179D-01, 0.15917D-01, 0.15664D-01, 0.15417D-01,
     & 0.15177D-01, 0.14943D-01, 0.14715D-01, 0.14494D-01, 0.14278D-01,
     & 0.23659D-01, 0.23089D-01, 0.22543D-01, 0.22020D-01, 0.21517D-01,
     & 0.21034D-01, 0.20570D-01, 0.20123D-01, 0.19693D-01, 0.19279D-01,
     & 0.18879D-01, 0.18494D-01, 0.18122D-01, 0.17763D-01, 0.17415D-01,
     & 0.17080D-01, 0.16755D-01, 0.16440D-01, 0.16136D-01, 0.15841D-01,
     & 0.15556D-01, 0.15279D-01, 0.15010D-01, 0.14749D-01, 0.14495D-01,
     & 0.14250D-01, 0.14011D-01, 0.13779D-01, 0.13553D-01, 0.13333D-01,
     & 0.23061D-01, 0.22446D-01, 0.21858D-01, 0.21296D-01, 0.20757D-01,
     & 0.20242D-01, 0.19748D-01, 0.19274D-01, 0.18819D-01, 0.18382D-01,
     & 0.17961D-01, 0.17557D-01, 0.17168D-01, 0.16793D-01, 0.16431D-01,
     & 0.16082D-01, 0.15745D-01, 0.15420D-01, 0.15106D-01, 0.14803D-01,
     & 0.14509D-01, 0.14225D-01, 0.13950D-01, 0.13683D-01, 0.13425D-01,
     & 0.13176D-01, 0.12934D-01, 0.12698D-01, 0.12470D-01, 0.12249D-01,
     & 0.22282D-01, 0.21611D-01, 0.20972D-01, 0.20364D-01, 0.19785D-01,
     & 0.19233D-01, 0.18708D-01, 0.18206D-01, 0.17726D-01, 0.17265D-01,
     & 0.16824D-01, 0.16402D-01, 0.15998D-01, 0.15609D-01, 0.15235D-01,
     & 0.14875D-01, 0.14529D-01, 0.14196D-01, 0.13875D-01, 0.13566D-01,
     & 0.13268D-01, 0.12980D-01, 0.12701D-01, 0.12432D-01, 0.12172D-01,
     & 0.11922D-01, 0.11679D-01, 0.11444D-01, 0.11216D-01, 0.10995D-01,
     & 0.21251D-01, 0.20541D-01, 0.19866D-01, 0.19224D-01, 0.18612D-01,
     & 0.18030D-01, 0.17474D-01, 0.16944D-01, 0.16438D-01, 0.15953D-01,
     & 0.15490D-01, 0.15048D-01, 0.14624D-01, 0.14218D-01, 0.13829D-01,
     & 0.13455D-01, 0.13096D-01, 0.12752D-01, 0.12422D-01, 0.12105D-01,
     & 0.11799D-01, 0.11504D-01, 0.11221D-01, 0.10948D-01, 0.10684D-01,
     & 0.10432D-01, 0.10188D-01, 0.99523D-02, 0.97246D-02, 0.95045D-02,
     & 0.20194D-01, 0.19290D-01, 0.18444D-01, 0.17649D-01, 0.16904D-01,
     & 0.16206D-01, 0.15559D-01, 0.14948D-01, 0.14371D-01, 0.13826D-01,
     & 0.13310D-01, 0.12827D-01, 0.12372D-01, 0.11940D-01, 0.11529D-01,
     & 0.11137D-01, 0.10765D-01, 0.10413D-01, 0.10081D-01, 0.97639D-02,
     & 0.94605D-02, 0.91703D-02, 0.88927D-02, 0.86271D-02, 0.83733D-02,
     & 0.81342D-02, 0.79044D-02, 0.76835D-02, 0.74712D-02, 0.72671D-02,
     & 0.14067D-01, 0.13304D-01, 0.12595D-01, 0.11936D-01, 0.11323D-01,
     & 0.10756D-01, 0.10239D-01, 0.97547D-02, 0.93004D-02, 0.88745D-02,
     & 0.84753D-02, 0.81069D-02, 0.77637D-02, 0.74394D-02, 0.71329D-02,
     & 0.68433D-02, 0.65697D-02, 0.63131D-02, 0.60750D-02, 0.58484D-02,
     & 0.56328D-02, 0.54277D-02, 0.52325D-02, 0.50469D-02, 0.48708D-02,
     & 0.47073D-02, 0.45509D-02, 0.44011D-02, 0.42578D-02, 0.41207D-02,
     & 0.89783D-03, 0.84445D-03, 0.79500D-03, 0.74918D-03, 0.70677D-03,
     & 0.66768D-03, 0.63239D-03, 0.59940D-03, 0.56857D-03, 0.53977D-03,
     & 0.51287D-03, 0.48823D-03, 0.46540D-03, 0.44389D-03, 0.42362D-03,
     & 0.40454D-03, 0.38657D-03, 0.36980D-03, 0.35435D-03, 0.33969D-03,
     & 0.32578D-03, 0.31259D-03, 0.30007D-03, 0.28821D-03, 0.27699D-03,
     & 0.26666D-03, 0.25681D-03, 0.24739D-03, 0.23841D-03, 0.22983D-03/

      data ((g_grdl(i,j),j=1,30),i=1,10)/
     & 0.10003D-07, 0.50248D-02, 0.10108D-01, 0.15241D-01, 0.20417D-01,
     & 0.25630D-01, 0.30879D-01, 0.36151D-01, 0.41441D-01, 0.46746D-01,
     & 0.52060D-01, 0.57390D-01, 0.62726D-01, 0.68059D-01, 0.73387D-01,
     & 0.78708D-01, 0.84021D-01, 0.89329D-01, 0.94635D-01, 0.99924D-01,
     & 0.10519D+00, 0.11044D+00, 0.11567D+00, 0.12088D+00, 0.12607D+00,
     & 0.13126D+00, 0.13641D+00, 0.14154D+00, 0.14664D+00, 0.15172D+00,
     & 0.10002D-07, 0.48864D-02, 0.98142D-02, 0.14777D-01, 0.19768D-01,
     & 0.24785D-01, 0.29828D-01, 0.34882D-01, 0.39942D-01, 0.45006D-01,
     & 0.50070D-01, 0.55141D-01, 0.60211D-01, 0.65270D-01, 0.70315D-01,
     & 0.75345D-01, 0.80360D-01, 0.85364D-01, 0.90362D-01, 0.95335D-01,
     & 0.10028D+00, 0.10521D+00, 0.11011D+00, 0.11498D+00, 0.11983D+00,
     & 0.12467D+00, 0.12948D+00, 0.13426D+00, 0.13900D+00, 0.14372D+00,
     & 0.10002D-07, 0.47464D-02, 0.95185D-02, 0.14311D-01, 0.19119D-01,
     & 0.23940D-01, 0.28780D-01, 0.33618D-01, 0.38451D-01, 0.43279D-01,
     & 0.48097D-01, 0.52916D-01, 0.57726D-01, 0.62516D-01, 0.67286D-01,
     & 0.72034D-01, 0.76761D-01, 0.81470D-01, 0.86169D-01, 0.90838D-01,
     & 0.95477D-01, 0.10009D+00, 0.10467D+00, 0.10922D+00, 0.11374D+00,
     & 0.11825D+00, 0.12273D+00, 0.12717D+00, 0.13158D+00, 0.13595D+00,
     & 0.10003D-07, 0.46054D-02, 0.92216D-02, 0.13845D-01, 0.18471D-01,
     & 0.23099D-01, 0.27738D-01, 0.32364D-01, 0.36976D-01, 0.41572D-01,
     & 0.46152D-01, 0.50725D-01, 0.55282D-01, 0.59812D-01, 0.64315D-01,
     & 0.68791D-01, 0.73239D-01, 0.77665D-01, 0.82076D-01, 0.86452D-01,
     & 0.90794D-01, 0.95103D-01, 0.99377D-01, 0.10362D+00, 0.10783D+00,
     & 0.11203D+00, 0.11619D+00, 0.12031D+00, 0.12440D+00, 0.12844D+00,
     & 0.10003D-07, 0.44615D-02, 0.89200D-02, 0.13373D-01, 0.17817D-01,
     & 0.22253D-01, 0.26691D-01, 0.31106D-01, 0.35499D-01, 0.39867D-01,
     & 0.44212D-01, 0.48543D-01, 0.52852D-01, 0.57127D-01, 0.61370D-01,
     & 0.65580D-01, 0.69757D-01, 0.73907D-01, 0.78039D-01, 0.82132D-01,
     & 0.86187D-01, 0.90204D-01, 0.94185D-01, 0.98130D-01, 0.10204D+00,
     & 0.10594D+00, 0.10979D+00, 0.11361D+00, 0.11738D+00, 0.12112D+00,
     & 0.10003D-07, 0.43148D-02, 0.86136D-02, 0.12895D-01, 0.17157D-01,
     & 0.21401D-01, 0.25638D-01, 0.29845D-01, 0.34020D-01, 0.38164D-01,
     & 0.42276D-01, 0.46370D-01, 0.50435D-01, 0.54462D-01, 0.58450D-01,
     & 0.62401D-01, 0.66315D-01, 0.70198D-01, 0.74058D-01, 0.77877D-01,
     & 0.81654D-01, 0.85391D-01, 0.89088D-01, 0.92748D-01, 0.96371D-01,
     & 0.99976D-01, 0.10354D+00, 0.10706D+00, 0.11054D+00, 0.11399D+00,
     & 0.10002D-07, 0.41649D-02, 0.83020D-02, 0.12410D-01, 0.16490D-01,
     & 0.20542D-01, 0.24580D-01, 0.28579D-01, 0.32539D-01, 0.36462D-01,
     & 0.40346D-01, 0.44207D-01, 0.48034D-01, 0.51817D-01, 0.55557D-01,
     & 0.59256D-01, 0.62914D-01, 0.66537D-01, 0.70135D-01, 0.73688D-01,
     & 0.77197D-01, 0.80663D-01, 0.84088D-01, 0.87473D-01, 0.90820D-01,
     & 0.94146D-01, 0.97429D-01, 0.10067D+00, 0.10387D+00, 0.10703D+00,
     & 0.10001D-07, 0.40125D-02, 0.79861D-02, 0.11921D-01, 0.15818D-01,
     & 0.19679D-01, 0.23519D-01, 0.27312D-01, 0.31061D-01, 0.34765D-01,
     & 0.38426D-01, 0.42057D-01, 0.45651D-01, 0.49197D-01, 0.52696D-01,
     & 0.56150D-01, 0.59560D-01, 0.62933D-01, 0.66276D-01, 0.69573D-01,
     & 0.72824D-01, 0.76030D-01, 0.79194D-01, 0.82316D-01, 0.85398D-01,
     & 0.88458D-01, 0.91474D-01, 0.94448D-01, 0.97380D-01, 0.10027D+00,
     & 0.10002D-07, 0.38576D-02, 0.76662D-02, 0.11427D-01, 0.15142D-01,
     & 0.18813D-01, 0.22456D-01, 0.26046D-01, 0.29586D-01, 0.33076D-01,
     & 0.36519D-01, 0.39927D-01, 0.43293D-01, 0.46608D-01, 0.49873D-01,
     & 0.53090D-01, 0.56261D-01, 0.59391D-01, 0.62490D-01, 0.65540D-01,
     & 0.68543D-01, 0.71501D-01, 0.74414D-01, 0.77285D-01, 0.80116D-01,
     & 0.82922D-01, 0.85684D-01, 0.88403D-01, 0.91081D-01, 0.93718D-01,
     & 0.10001D-07, 0.36983D-02, 0.73387D-02, 0.10923D-01, 0.14454D-01,
     & 0.17935D-01, 0.21380D-01, 0.24768D-01, 0.28100D-01, 0.31378D-01,
     & 0.34604D-01, 0.37792D-01, 0.40934D-01, 0.44022D-01, 0.47058D-01,
     & 0.50044D-01, 0.52981D-01, 0.55876D-01, 0.58737D-01, 0.61548D-01,
     & 0.64312D-01, 0.67029D-01, 0.69701D-01, 0.72330D-01, 0.74918D-01,
     & 0.77480D-01, 0.79998D-01, 0.82474D-01, 0.84909D-01, 0.87304D-01/

      data ((g_grdl(i,j),j=1,30),i=11,20)/
     & 0.99996D-08, 0.35346D-02, 0.70033D-02, 0.10409D-01, 0.13754D-01,
     & 0.17043D-01, 0.20291D-01, 0.23476D-01, 0.26602D-01, 0.29670D-01,
     & 0.32683D-01, 0.35653D-01, 0.38575D-01, 0.41440D-01, 0.44252D-01,
     & 0.47012D-01, 0.49723D-01, 0.52389D-01, 0.55019D-01, 0.57599D-01,
     & 0.60131D-01, 0.62616D-01, 0.65056D-01, 0.67453D-01, 0.69809D-01,
     & 0.72137D-01, 0.74422D-01, 0.76665D-01, 0.78868D-01, 0.81031D-01,
     & 0.99991D-08, 0.33677D-02, 0.66627D-02, 0.98883D-02, 0.13048D-01,
     & 0.16146D-01, 0.19198D-01, 0.22183D-01, 0.25105D-01, 0.27967D-01,
     & 0.30771D-01, 0.33529D-01, 0.36236D-01, 0.38886D-01, 0.41481D-01,
     & 0.44023D-01, 0.46514D-01, 0.48960D-01, 0.51368D-01, 0.53727D-01,
     & 0.56037D-01, 0.58300D-01, 0.60519D-01, 0.62695D-01, 0.64830D-01,
     & 0.66937D-01, 0.69001D-01, 0.71024D-01, 0.73007D-01, 0.74953D-01,
     & 0.99973D-08, 0.31956D-02, 0.63127D-02, 0.93552D-02, 0.12327D-01,
     & 0.15233D-01, 0.18087D-01, 0.20872D-01, 0.23591D-01, 0.26248D-01,
     & 0.28845D-01, 0.31394D-01, 0.33890D-01, 0.36328D-01, 0.38710D-01,
     & 0.41039D-01, 0.43317D-01, 0.45549D-01, 0.47742D-01, 0.49885D-01,
     & 0.51981D-01, 0.54031D-01, 0.56037D-01, 0.58000D-01, 0.59924D-01,
     & 0.61817D-01, 0.63670D-01, 0.65483D-01, 0.67258D-01, 0.68996D-01,
     & 0.99985D-08, 0.30204D-02, 0.59576D-02, 0.88160D-02, 0.11600D-01,
     & 0.14314D-01, 0.16972D-01, 0.19559D-01, 0.22079D-01, 0.24535D-01,
     & 0.26930D-01, 0.29274D-01, 0.31564D-01, 0.33796D-01, 0.35973D-01,
     & 0.38096D-01, 0.40169D-01, 0.42195D-01, 0.44181D-01, 0.46119D-01,
     & 0.48010D-01, 0.49856D-01, 0.51660D-01, 0.53422D-01, 0.55145D-01,
     & 0.56837D-01, 0.58490D-01, 0.60105D-01, 0.61683D-01, 0.63226D-01,
     & 0.10003D-07, 0.28414D-02, 0.55959D-02, 0.82683D-02, 0.10863D-01,
     & 0.13386D-01, 0.15849D-01, 0.18240D-01, 0.20562D-01, 0.22820D-01,
     & 0.25016D-01, 0.27160D-01, 0.29249D-01, 0.31281D-01, 0.33257D-01,
     & 0.35181D-01, 0.37055D-01, 0.38883D-01, 0.40671D-01, 0.42411D-01,
     & 0.44106D-01, 0.45757D-01, 0.47367D-01, 0.48938D-01, 0.50470D-01,
     & 0.51971D-01, 0.53435D-01, 0.54862D-01, 0.56255D-01, 0.57614D-01,
     & 0.10001D-07, 0.26554D-02, 0.52214D-02, 0.77033D-02, 0.10106D-01,
     & 0.12434D-01, 0.14700D-01, 0.16893D-01, 0.19019D-01, 0.21079D-01,
     & 0.23078D-01, 0.25023D-01, 0.26914D-01, 0.28749D-01, 0.30530D-01,
     & 0.32259D-01, 0.33939D-01, 0.35574D-01, 0.37169D-01, 0.38718D-01,
     & 0.40224D-01, 0.41688D-01, 0.43112D-01, 0.44498D-01, 0.45848D-01,
     & 0.47167D-01, 0.48450D-01, 0.49699D-01, 0.50916D-01, 0.52101D-01,
     & 0.10001D-07, 0.24649D-02, 0.48393D-02, 0.71284D-02, 0.93373D-02,
     & 0.11471D-01, 0.13540D-01, 0.15538D-01, 0.17468D-01, 0.19334D-01,
     & 0.21139D-01, 0.22890D-01, 0.24588D-01, 0.26230D-01, 0.27821D-01,
     & 0.29362D-01, 0.30855D-01, 0.32305D-01, 0.33714D-01, 0.35080D-01,
     & 0.36405D-01, 0.37691D-01, 0.38939D-01, 0.40150D-01, 0.41327D-01,
     & 0.42474D-01, 0.43587D-01, 0.44669D-01, 0.45720D-01, 0.46741D-01,
     & 0.10001D-07, 0.22695D-02, 0.44484D-02, 0.65421D-02, 0.85558D-02,
     & 0.10495D-01, 0.12367D-01, 0.14170D-01, 0.15906D-01, 0.17580D-01,
     & 0.19195D-01, 0.20756D-01, 0.22265D-01, 0.23721D-01, 0.25127D-01,
     & 0.26486D-01, 0.27799D-01, 0.29070D-01, 0.30302D-01, 0.31493D-01,
     & 0.32645D-01, 0.33761D-01, 0.34841D-01, 0.35887D-01, 0.36900D-01,
     & 0.37885D-01, 0.38838D-01, 0.39762D-01, 0.40658D-01, 0.41527D-01,
     & 0.10002D-07, 0.20694D-02, 0.40494D-02, 0.59455D-02, 0.77628D-02,
     & 0.95064D-02, 0.11183D-01, 0.12792D-01, 0.14337D-01, 0.15823D-01,
     & 0.17251D-01, 0.18626D-01, 0.19951D-01, 0.21226D-01, 0.22454D-01,
     & 0.23637D-01, 0.24778D-01, 0.25878D-01, 0.26940D-01, 0.27964D-01,
     & 0.28953D-01, 0.29907D-01, 0.30828D-01, 0.31719D-01, 0.32579D-01,
     & 0.33410D-01, 0.34214D-01, 0.34991D-01, 0.35743D-01, 0.36470D-01,
     & 0.10003D-07, 0.18648D-02, 0.36427D-02, 0.53391D-02, 0.69591D-02,
     & 0.85075D-02, 0.99892D-02, 0.11407D-01, 0.12764D-01, 0.14063D-01,
     & 0.15309D-01, 0.16504D-01, 0.17650D-01, 0.18750D-01, 0.19806D-01,
     & 0.20821D-01, 0.21795D-01, 0.22732D-01, 0.23632D-01, 0.24499D-01,
     & 0.25332D-01, 0.26135D-01, 0.26907D-01, 0.27651D-01, 0.28367D-01,
     & 0.29057D-01, 0.29721D-01, 0.30362D-01, 0.30980D-01, 0.31575D-01/

      data ((g_grdl(i,j),j=1,30),i=21,30)/
     & 0.10004D-07, 0.16559D-02, 0.32286D-02, 0.47235D-02, 0.61454D-02,
     & 0.74988D-02, 0.87870D-02, 0.10015D-01, 0.11187D-01, 0.12305D-01,
     & 0.13372D-01, 0.14391D-01, 0.15365D-01, 0.16296D-01, 0.17187D-01,
     & 0.18039D-01, 0.18856D-01, 0.19637D-01, 0.20385D-01, 0.21102D-01,
     & 0.21789D-01, 0.22448D-01, 0.23081D-01, 0.23688D-01, 0.24271D-01,
     & 0.24828D-01, 0.25364D-01, 0.25879D-01, 0.26373D-01, 0.26849D-01,
     & 0.99978D-08, 0.14417D-02, 0.28053D-02, 0.40960D-02, 0.53184D-02,
     & 0.64764D-02, 0.75720D-02, 0.86125D-02, 0.96011D-02, 0.10541D-01,
     & 0.11434D-01, 0.12282D-01, 0.13088D-01, 0.13857D-01, 0.14589D-01,
     & 0.15287D-01, 0.15953D-01, 0.16587D-01, 0.17190D-01, 0.17766D-01,
     & 0.18316D-01, 0.18842D-01, 0.19345D-01, 0.19825D-01, 0.20284D-01,
     & 0.20720D-01, 0.21137D-01, 0.21536D-01, 0.21918D-01, 0.22284D-01,
     & 0.99975D-08, 0.12264D-02, 0.23812D-02, 0.34692D-02, 0.44948D-02,
     & 0.54612D-02, 0.63691D-02, 0.72276D-02, 0.80396D-02, 0.88079D-02,
     & 0.95350D-02, 0.10221D-01, 0.10869D-01, 0.11483D-01, 0.12067D-01,
     & 0.12621D-01, 0.13146D-01, 0.13644D-01, 0.14114D-01, 0.14560D-01,
     & 0.14985D-01, 0.15390D-01, 0.15774D-01, 0.16140D-01, 0.16487D-01,
     & 0.16813D-01, 0.17125D-01, 0.17421D-01, 0.17703D-01, 0.17972D-01,
     & 0.10002D-07, 0.10109D-02, 0.19580D-02, 0.28457D-02, 0.36779D-02,
     & 0.44573D-02, 0.51831D-02, 0.58661D-02, 0.65088D-02, 0.71137D-02,
     & 0.76828D-02, 0.82150D-02, 0.87146D-02, 0.91862D-02, 0.96315D-02,
     & 0.10052D-01, 0.10448D-01, 0.10821D-01, 0.11169D-01, 0.11498D-01,
     & 0.11810D-01, 0.12105D-01, 0.12384D-01, 0.12647D-01, 0.12895D-01,
     & 0.13125D-01, 0.13343D-01, 0.13550D-01, 0.13745D-01, 0.13930D-01,
     & 0.10001D-07, 0.79450D-03, 0.15346D-02, 0.22239D-02, 0.28659D-02,
     & 0.34626D-02, 0.40121D-02, 0.45262D-02, 0.50069D-02, 0.54564D-02,
     & 0.58763D-02, 0.62647D-02, 0.66259D-02, 0.69648D-02, 0.72826D-02,
     & 0.75804D-02, 0.78593D-02, 0.81187D-02, 0.83578D-02, 0.85825D-02,
     & 0.87935D-02, 0.89915D-02, 0.91770D-02, 0.93507D-02, 0.95128D-02,
     & 0.96602D-02, 0.97986D-02, 0.99284D-02, 0.10050D-01, 0.10164D-01,
     & 0.10001D-07, 0.74287D-03, 0.14337D-02, 0.20762D-02, 0.26734D-02,
     & 0.32273D-02, 0.37358D-02, 0.42106D-02, 0.46540D-02, 0.50677D-02,
     & 0.54534D-02, 0.58091D-02, 0.61390D-02, 0.64479D-02, 0.67370D-02,
     & 0.70074D-02, 0.72601D-02, 0.74944D-02, 0.77095D-02, 0.79111D-02,
     & 0.81001D-02, 0.82770D-02, 0.84424D-02, 0.85967D-02, 0.87403D-02,
     & 0.88700D-02, 0.89914D-02, 0.91050D-02, 0.92111D-02, 0.93099D-02,
     & 0.10000D-07, 0.69333D-03, 0.13371D-02, 0.19347D-02, 0.24892D-02,
     & 0.30025D-02, 0.34720D-02, 0.39098D-02, 0.43178D-02, 0.46978D-02,
     & 0.50515D-02, 0.53764D-02, 0.56769D-02, 0.59579D-02, 0.62203D-02,
     & 0.64651D-02, 0.66934D-02, 0.69045D-02, 0.70973D-02, 0.72777D-02,
     & 0.74464D-02, 0.76038D-02, 0.77506D-02, 0.78873D-02, 0.80139D-02,
     & 0.81275D-02, 0.82335D-02, 0.83323D-02, 0.84242D-02, 0.85095D-02,
     & 0.10000D-07, 0.64593D-03, 0.12447D-02, 0.17995D-02, 0.23134D-02,
     & 0.27880D-02, 0.32206D-02, 0.36233D-02, 0.39979D-02, 0.43461D-02,
     & 0.46695D-02, 0.49655D-02, 0.52385D-02, 0.54932D-02, 0.57306D-02,
     & 0.59517D-02, 0.61572D-02, 0.63466D-02, 0.65188D-02, 0.66796D-02,
     & 0.68295D-02, 0.69691D-02, 0.70988D-02, 0.72192D-02, 0.73303D-02,
     & 0.74291D-02, 0.75211D-02, 0.76065D-02, 0.76856D-02, 0.77587D-02,
     & 0.10000D-07, 0.60039D-03, 0.11560D-02, 0.16700D-02, 0.21451D-02,
     & 0.25828D-02, 0.29804D-02, 0.33499D-02, 0.36929D-02, 0.40111D-02,
     & 0.43059D-02, 0.45749D-02, 0.48221D-02, 0.50523D-02, 0.52663D-02,
     & 0.54652D-02, 0.56497D-02, 0.58190D-02, 0.59721D-02, 0.61148D-02,
     & 0.62474D-02, 0.63705D-02, 0.64846D-02, 0.65901D-02, 0.66870D-02,
     & 0.67724D-02, 0.68516D-02, 0.69248D-02, 0.69923D-02, 0.70544D-02,
     & 0.10000D-07, 0.55674D-03, 0.10711D-02, 0.15460D-02, 0.19841D-02,
     & 0.23868D-02, 0.27512D-02, 0.30891D-02, 0.34022D-02, 0.36921D-02,
     & 0.39601D-02, 0.42035D-02, 0.44265D-02, 0.46338D-02, 0.48261D-02,
     & 0.50043D-02, 0.51691D-02, 0.53198D-02, 0.54553D-02, 0.55811D-02,
     & 0.56978D-02, 0.58058D-02, 0.59055D-02, 0.59973D-02, 0.60813D-02,
     & 0.61545D-02, 0.62221D-02, 0.62843D-02, 0.63414D-02, 0.63935D-02/

      data ((g_grdl(i,j),j=1,30),i=31,40)/
     & 0.10000D-07, 0.51481D-03, 0.98959D-03, 0.14271D-02, 0.18300D-02,
     & 0.21993D-02, 0.25320D-02, 0.28401D-02, 0.31250D-02, 0.33881D-02,
     & 0.36308D-02, 0.38504D-02, 0.40507D-02, 0.42365D-02, 0.44085D-02,
     & 0.45674D-02, 0.47140D-02, 0.48475D-02, 0.49667D-02, 0.50771D-02,
     & 0.51791D-02, 0.52732D-02, 0.53598D-02, 0.54391D-02, 0.55114D-02,
     & 0.55735D-02, 0.56306D-02, 0.56828D-02, 0.57305D-02, 0.57737D-02,
     & 0.10000D-07, 0.47455D-03, 0.91142D-03, 0.13132D-02, 0.16824D-02,
     & 0.20199D-02, 0.23227D-02, 0.26025D-02, 0.28607D-02, 0.30986D-02,
     & 0.33175D-02, 0.35145D-02, 0.36937D-02, 0.38595D-02, 0.40125D-02,
     & 0.41535D-02, 0.42831D-02, 0.44006D-02, 0.45048D-02, 0.46010D-02,
     & 0.46896D-02, 0.47710D-02, 0.48456D-02, 0.49135D-02, 0.49750D-02,
     & 0.50272D-02, 0.50748D-02, 0.51181D-02, 0.51573D-02, 0.51926D-02,
     & 0.10000D-07, 0.43592D-03, 0.83647D-03, 0.12041D-02, 0.15411D-02,
     & 0.18484D-02, 0.21228D-02, 0.23758D-02, 0.26087D-02, 0.28229D-02,
     & 0.30193D-02, 0.31953D-02, 0.33547D-02, 0.35017D-02, 0.36371D-02,
     & 0.37614D-02, 0.38754D-02, 0.39781D-02, 0.40685D-02, 0.41516D-02,
     & 0.42279D-02, 0.42977D-02, 0.43612D-02, 0.44189D-02, 0.44707D-02,
     & 0.45138D-02, 0.45529D-02, 0.45882D-02, 0.46199D-02, 0.46480D-02,
     & 0.10000D-07, 0.39881D-03, 0.76455D-03, 0.10995D-02, 0.14059D-02,
     & 0.16844D-02, 0.19319D-02, 0.21595D-02, 0.23687D-02, 0.25604D-02,
     & 0.27358D-02, 0.28921D-02, 0.30330D-02, 0.31626D-02, 0.32816D-02,
     & 0.33905D-02, 0.34899D-02, 0.35791D-02, 0.36568D-02, 0.37280D-02,
     & 0.37930D-02, 0.38522D-02, 0.39058D-02, 0.39542D-02, 0.39972D-02,
     & 0.40323D-02, 0.40638D-02, 0.40920D-02, 0.41169D-02, 0.41388D-02,
     & 0.10001D-07, 0.36331D-03, 0.69582D-03, 0.99968D-03, 0.12769D-02,
     & 0.15281D-02, 0.17501D-02, 0.19539D-02, 0.21406D-02, 0.23113D-02,
     & 0.24670D-02, 0.26049D-02, 0.27286D-02, 0.28420D-02, 0.29458D-02,
     & 0.30405D-02, 0.31266D-02, 0.32033D-02, 0.32694D-02, 0.33297D-02,
     & 0.33846D-02, 0.34342D-02, 0.34788D-02, 0.35188D-02, 0.35540D-02,
     & 0.35819D-02, 0.36067D-02, 0.36286D-02, 0.36477D-02, 0.36641D-02,
     & 0.99998D-08, 0.32896D-03, 0.62939D-03, 0.90329D-03, 0.11525D-02,
     & 0.13777D-02, 0.15754D-02, 0.17564D-02, 0.19219D-02, 0.20727D-02,
     & 0.22098D-02, 0.23304D-02, 0.24380D-02, 0.25364D-02, 0.26261D-02,
     & 0.27075D-02, 0.27812D-02, 0.28464D-02, 0.29020D-02, 0.29524D-02,
     & 0.29979D-02, 0.30389D-02, 0.30754D-02, 0.31078D-02, 0.31359D-02,
     & 0.31575D-02, 0.31764D-02, 0.31928D-02, 0.32067D-02, 0.32183D-02,
     & 0.99996D-08, 0.29617D-03, 0.56604D-03, 0.81147D-03, 0.10341D-02,
     & 0.12346D-02, 0.14094D-02, 0.15691D-02, 0.17147D-02, 0.18469D-02,
     & 0.19666D-02, 0.20713D-02, 0.21639D-02, 0.22484D-02, 0.23251D-02,
     & 0.23944D-02, 0.24569D-02, 0.25116D-02, 0.25575D-02, 0.25990D-02,
     & 0.26362D-02, 0.26694D-02, 0.26987D-02, 0.27243D-02, 0.27463D-02,
     & 0.27623D-02, 0.27761D-02, 0.27876D-02, 0.27971D-02, 0.28047D-02,
     & 0.99998D-08, 0.26474D-03, 0.50538D-03, 0.72366D-03, 0.92110D-03,
     & 0.10982D-02, 0.12515D-02, 0.13911D-02, 0.15180D-02, 0.16328D-02,
     & 0.17364D-02, 0.18262D-02, 0.19051D-02, 0.19768D-02, 0.20416D-02,
     & 0.20998D-02, 0.21520D-02, 0.21972D-02, 0.22346D-02, 0.22680D-02,
     & 0.22978D-02, 0.23240D-02, 0.23470D-02, 0.23667D-02, 0.23832D-02,
     & 0.23945D-02, 0.24038D-02, 0.24113D-02, 0.24171D-02, 0.24211D-02,
     & 0.99999D-08, 0.23459D-03, 0.44730D-03, 0.63967D-03, 0.81313D-03,
     & 0.96801D-03, 0.11010D-02, 0.12218D-02, 0.13312D-02, 0.14298D-02,
     & 0.15183D-02, 0.15944D-02, 0.16607D-02, 0.17206D-02, 0.17745D-02,
     & 0.18227D-02, 0.18655D-02, 0.19022D-02, 0.19318D-02, 0.19582D-02,
     & 0.19813D-02, 0.20015D-02, 0.20188D-02, 0.20334D-02, 0.20452D-02,
     & 0.20524D-02, 0.20580D-02, 0.20620D-02, 0.20647D-02, 0.20659D-02,
     & 0.99999D-08, 0.20577D-03, 0.39183D-03, 0.55957D-03, 0.71028D-03,
     & 0.84421D-03, 0.95814D-03, 0.10613D-02, 0.11543D-02, 0.12378D-02,
     & 0.13124D-02, 0.13758D-02, 0.14305D-02, 0.14797D-02, 0.15237D-02,
     & 0.15627D-02, 0.15971D-02, 0.16262D-02, 0.16490D-02, 0.16690D-02,
     & 0.16864D-02, 0.17012D-02, 0.17137D-02, 0.17238D-02, 0.17317D-02,
     & 0.17355D-02, 0.17380D-02, 0.17392D-02, 0.17393D-02, 0.17383D-02/

      data ((g_grdl(i,j),j=1,30),i=41,50)/
     & 0.10000D-07, 0.17816D-03, 0.33876D-03, 0.48307D-03, 0.61222D-03,
     & 0.72641D-03, 0.82251D-03, 0.90917D-03, 0.98701D-03, 0.10566D-02,
     & 0.11184D-02, 0.11701D-02, 0.12144D-02, 0.12539D-02, 0.12889D-02,
     & 0.13198D-02, 0.13467D-02, 0.13691D-02, 0.13859D-02, 0.14005D-02,
     & 0.14129D-02, 0.14232D-02, 0.14316D-02, 0.14380D-02, 0.14426D-02,
     & 0.14436D-02, 0.14436D-02, 0.14427D-02, 0.14409D-02, 0.14382D-02,
     & 0.10000D-07, 0.15185D-03, 0.28829D-03, 0.41042D-03, 0.51924D-03,
     & 0.61487D-03, 0.69432D-03, 0.76568D-03, 0.82947D-03, 0.88614D-03,
     & 0.93616D-03, 0.97742D-03, 0.10122D-02, 0.10430D-02, 0.10701D-02,
     & 0.10937D-02, 0.11140D-02, 0.11304D-02, 0.11422D-02, 0.11521D-02,
     & 0.11603D-02, 0.11668D-02, 0.11717D-02, 0.11751D-02, 0.11770D-02,
     & 0.11759D-02, 0.11741D-02, 0.11715D-02, 0.11683D-02, 0.11644D-02,
     & 0.10000D-07, 0.12674D-03, 0.24019D-03, 0.34132D-03, 0.43098D-03,
     & 0.50924D-03, 0.57328D-03, 0.63052D-03, 0.68140D-03, 0.72632D-03,
     & 0.76564D-03, 0.79746D-03, 0.82376D-03, 0.84687D-03, 0.86697D-03,
     & 0.88424D-03, 0.89884D-03, 0.91024D-03, 0.91774D-03, 0.92381D-03,
     & 0.92851D-03, 0.93193D-03, 0.93413D-03, 0.93516D-03, 0.93499D-03,
     & 0.93240D-03, 0.92928D-03, 0.92564D-03, 0.92152D-03, 0.91694D-03,
     & 0.10000D-07, 0.10289D-03, 0.19460D-03, 0.27595D-03, 0.34766D-03,
     & 0.40974D-03, 0.45959D-03, 0.50390D-03, 0.54302D-03, 0.57728D-03,
     & 0.60698D-03, 0.63042D-03, 0.64932D-03, 0.66572D-03, 0.67978D-03,
     & 0.69162D-03, 0.70137D-03, 0.70858D-03, 0.71262D-03, 0.71561D-03,
     & 0.71759D-03, 0.71863D-03, 0.71877D-03, 0.71805D-03, 0.71643D-03,
     & 0.71292D-03, 0.70905D-03, 0.70485D-03, 0.70033D-03, 0.69551D-03,
     & 0.10000D-07, 0.80279D-04, 0.15148D-03, 0.21428D-03, 0.26926D-03,
     & 0.31637D-03, 0.35330D-03, 0.38589D-03, 0.41444D-03, 0.43918D-03,
     & 0.46037D-03, 0.47652D-03, 0.48909D-03, 0.49981D-03, 0.50879D-03,
     & 0.51613D-03, 0.52191D-03, 0.52577D-03, 0.52719D-03, 0.52787D-03,
     & 0.52788D-03, 0.52723D-03, 0.52597D-03, 0.52412D-03, 0.52165D-03,
     & 0.51777D-03, 0.51368D-03, 0.50941D-03, 0.50496D-03, 0.50033D-03,
     & 0.10000D-07, 0.58794D-04, 0.11064D-03, 0.15606D-03, 0.19550D-03,
     & 0.22888D-03, 0.25424D-03, 0.27643D-03, 0.29566D-03, 0.31212D-03,
     & 0.32597D-03, 0.33601D-03, 0.34340D-03, 0.34953D-03, 0.35447D-03,
     & 0.35829D-03, 0.36104D-03, 0.36245D-03, 0.36208D-03, 0.36128D-03,
     & 0.36006D-03, 0.35844D-03, 0.35645D-03, 0.35411D-03, 0.35138D-03,
     & 0.34768D-03, 0.34390D-03, 0.34004D-03, 0.33610D-03, 0.33210D-03,
     & 0.10000D-07, 0.39068D-04, 0.73247D-04, 0.10290D-03, 0.12835D-03,
     & 0.14950D-03, 0.16474D-03, 0.17791D-03, 0.18915D-03, 0.19858D-03,
     & 0.20632D-03, 0.21145D-03, 0.21483D-03, 0.21747D-03, 0.21941D-03,
     & 0.22070D-03, 0.22136D-03, 0.22121D-03, 0.21994D-03, 0.21846D-03,
     & 0.21678D-03, 0.21490D-03, 0.21285D-03, 0.21063D-03, 0.20822D-03,
     & 0.20525D-03, 0.20228D-03, 0.19930D-03, 0.19631D-03, 0.19331D-03,
     & 0.10000D-07, 0.20280D-04, 0.37909D-04, 0.53088D-04, 0.65994D-04,
     & 0.76556D-04, 0.83810D-04, 0.90012D-04, 0.95230D-04, 0.99528D-04,
     & 0.10296D-03, 0.10502D-03, 0.10617D-03, 0.10698D-03, 0.10747D-03,
     & 0.10765D-03, 0.10755D-03, 0.10705D-03, 0.10601D-03, 0.10488D-03,
     & 0.10369D-03, 0.10242D-03, 0.10109D-03, 0.99696D-04, 0.98229D-04,
     & 0.96510D-04, 0.94805D-04, 0.93115D-04, 0.91438D-04, 0.89774D-04,
     & 0.10000D-07, 0.64613D-05, 0.12030D-04, 0.16779D-04, 0.20769D-04,
     & 0.23968D-04, 0.26020D-04, 0.27746D-04, 0.29167D-04, 0.30303D-04,
     & 0.31172D-04, 0.31592D-04, 0.31726D-04, 0.31768D-04, 0.31724D-04,
     & 0.31599D-04, 0.31397D-04, 0.31082D-04, 0.30606D-04, 0.30116D-04,
     & 0.29616D-04, 0.29104D-04, 0.28582D-04, 0.28051D-04, 0.27506D-04,
     & 0.26896D-04, 0.26297D-04, 0.25709D-04, 0.25132D-04, 0.24566D-04,
     & 0.10000D-07, 0.15171D-06, 0.27078D-06, 0.36887D-06, 0.44749D-06,
     & 0.50537D-06, 0.53079D-06, 0.54971D-06, 0.56257D-06, 0.56976D-06,
     & 0.57167D-06, 0.56301D-06, 0.54825D-06, 0.53278D-06, 0.51664D-06,
     & 0.49988D-06, 0.48253D-06, 0.46374D-06, 0.44235D-06, 0.42163D-06,
     & 0.40158D-06, 0.38214D-06, 0.36331D-06, 0.34505D-06, 0.32727D-06,
     & 0.30920D-06, 0.29192D-06, 0.27538D-06, 0.25957D-06, 0.24445D-06/

      data ((c_grdl(i,j),j=1,30),i=1,10)/
     & 0.23432D-05, 0.23506D-05, 0.23571D-05, 0.23629D-05, 0.23680D-05,
     & 0.23725D-05, 0.23765D-05, 0.23801D-05, 0.23833D-05, 0.23860D-05,
     & 0.23885D-05, 0.23907D-05, 0.23926D-05, 0.23944D-05, 0.23959D-05,
     & 0.23972D-05, 0.23984D-05, 0.23995D-05, 0.24004D-05, 0.24013D-05,
     & 0.24020D-05, 0.24027D-05, 0.24032D-05, 0.24037D-05, 0.24042D-05,
     & 0.24046D-05, 0.24050D-05, 0.24053D-05, 0.24056D-05, 0.24058D-05,
     & 0.23232D-05, 0.23319D-05, 0.23396D-05, 0.23464D-05, 0.23524D-05,
     & 0.23577D-05, 0.23625D-05, 0.23666D-05, 0.23704D-05, 0.23736D-05,
     & 0.23766D-05, 0.23791D-05, 0.23814D-05, 0.23834D-05, 0.23852D-05,
     & 0.23868D-05, 0.23882D-05, 0.23895D-05, 0.23906D-05, 0.23916D-05,
     & 0.23924D-05, 0.23932D-05, 0.23939D-05, 0.23945D-05, 0.23950D-05,
     & 0.23955D-05, 0.23959D-05, 0.23963D-05, 0.23966D-05, 0.23969D-05,
     & 0.22996D-05, 0.23098D-05, 0.23189D-05, 0.23269D-05, 0.23340D-05,
     & 0.23403D-05, 0.23458D-05, 0.23508D-05, 0.23552D-05, 0.23590D-05,
     & 0.23625D-05, 0.23655D-05, 0.23682D-05, 0.23706D-05, 0.23727D-05,
     & 0.23746D-05, 0.23762D-05, 0.23777D-05, 0.23790D-05, 0.23801D-05,
     & 0.23812D-05, 0.23821D-05, 0.23829D-05, 0.23836D-05, 0.23842D-05,
     & 0.23848D-05, 0.23853D-05, 0.23857D-05, 0.23861D-05, 0.23864D-05,
     & 0.22719D-05, 0.22839D-05, 0.22945D-05, 0.23040D-05, 0.23123D-05,
     & 0.23197D-05, 0.23263D-05, 0.23321D-05, 0.23372D-05, 0.23418D-05,
     & 0.23458D-05, 0.23494D-05, 0.23526D-05, 0.23554D-05, 0.23579D-05,
     & 0.23601D-05, 0.23621D-05, 0.23638D-05, 0.23653D-05, 0.23667D-05,
     & 0.23679D-05, 0.23690D-05, 0.23699D-05, 0.23707D-05, 0.23715D-05,
     & 0.23721D-05, 0.23727D-05, 0.23732D-05, 0.23737D-05, 0.23741D-05,
     & 0.22391D-05, 0.22533D-05, 0.22658D-05, 0.22770D-05, 0.22868D-05,
     & 0.22955D-05, 0.23032D-05, 0.23101D-05, 0.23162D-05, 0.23215D-05,
     & 0.23263D-05, 0.23305D-05, 0.23342D-05, 0.23376D-05, 0.23405D-05,
     & 0.23431D-05, 0.23454D-05, 0.23474D-05, 0.23492D-05, 0.23508D-05,
     & 0.23523D-05, 0.23535D-05, 0.23546D-05, 0.23556D-05, 0.23565D-05,
     & 0.23573D-05, 0.23580D-05, 0.23586D-05, 0.23591D-05, 0.23596D-05,
     & 0.22007D-05, 0.22173D-05, 0.22321D-05, 0.22451D-05, 0.22567D-05,
     & 0.22670D-05, 0.22761D-05, 0.22842D-05, 0.22913D-05, 0.22976D-05,
     & 0.23032D-05, 0.23082D-05, 0.23126D-05, 0.23165D-05, 0.23200D-05,
     & 0.23230D-05, 0.23257D-05, 0.23281D-05, 0.23303D-05, 0.23322D-05,
     & 0.23338D-05, 0.23353D-05, 0.23366D-05, 0.23378D-05, 0.23388D-05,
     & 0.23397D-05, 0.23405D-05, 0.23413D-05, 0.23419D-05, 0.23425D-05,
     & 0.31169D-05, 0.28891D-05, 0.25513D-05, 0.22077D-05, 0.22214D-05,
     & 0.22334D-05, 0.22442D-05, 0.22536D-05, 0.22621D-05, 0.22695D-05,
     & 0.22761D-05, 0.22820D-05, 0.22871D-05, 0.22917D-05, 0.22958D-05,
     & 0.22994D-05, 0.23026D-05, 0.23054D-05, 0.23079D-05, 0.23102D-05,
     & 0.23121D-05, 0.23139D-05, 0.23154D-05, 0.23168D-05, 0.23180D-05,
     & 0.23191D-05, 0.23200D-05, 0.23209D-05, 0.23216D-05, 0.23223D-05,
     & 0.35047D-05, 0.33626D-05, 0.32065D-05, 0.30302D-05, 0.28176D-05,
     & 0.24983D-05, 0.22065D-05, 0.22177D-05, 0.22276D-05, 0.22364D-05,
     & 0.22442D-05, 0.22510D-05, 0.22571D-05, 0.22626D-05, 0.22673D-05,
     & 0.22716D-05, 0.22754D-05, 0.22787D-05, 0.22816D-05, 0.22843D-05,
     & 0.22866D-05, 0.22886D-05, 0.22905D-05, 0.22921D-05, 0.22935D-05,
     & 0.22948D-05, 0.22959D-05, 0.22969D-05, 0.22978D-05, 0.22985D-05,
     & 0.37825D-05, 0.36775D-05, 0.35659D-05, 0.34480D-05, 0.33232D-05,
     & 0.31900D-05, 0.30454D-05, 0.28824D-05, 0.26824D-05, 0.23192D-05,
     & 0.22066D-05, 0.22147D-05, 0.22218D-05, 0.22282D-05, 0.22338D-05,
     & 0.22388D-05, 0.22433D-05, 0.22472D-05, 0.22507D-05, 0.22538D-05,
     & 0.22565D-05, 0.22589D-05, 0.22610D-05, 0.22629D-05, 0.22646D-05,
     & 0.22661D-05, 0.22674D-05, 0.22686D-05, 0.22696D-05, 0.22706D-05,
     & 0.39884D-05, 0.39114D-05, 0.38282D-05, 0.37404D-05, 0.36489D-05,
     & 0.35545D-05, 0.34577D-05, 0.33587D-05, 0.32574D-05, 0.31533D-05,
     & 0.30454D-05, 0.29317D-05, 0.28084D-05, 0.26674D-05, 0.24810D-05,
     & 0.22003D-05, 0.22055D-05, 0.22101D-05, 0.22142D-05, 0.22178D-05,
     & 0.22211D-05, 0.22239D-05, 0.22264D-05, 0.22287D-05, 0.22306D-05,
     & 0.22324D-05, 0.22340D-05, 0.22353D-05, 0.22366D-05, 0.22376D-05/

      data ((c_grdl(i,j),j=1,30),i=11,20)/
     & 0.41292D-05, 0.40791D-05, 0.40213D-05, 0.39577D-05, 0.38901D-05,
     & 0.38197D-05, 0.37476D-05, 0.36747D-05, 0.36018D-05, 0.35293D-05,
     & 0.34577D-05, 0.33873D-05, 0.33183D-05, 0.32509D-05, 0.31851D-05,
     & 0.31211D-05, 0.30586D-05, 0.29978D-05, 0.29384D-05, 0.28803D-05,
     & 0.28233D-05, 0.27670D-05, 0.27112D-05, 0.26552D-05, 0.25984D-05,
     & 0.25393D-05, 0.24759D-05, 0.24028D-05, 0.22992D-05, 0.21989D-05,
     & 0.42015D-05, 0.41804D-05, 0.41490D-05, 0.41098D-05, 0.40646D-05,
     & 0.40152D-05, 0.39630D-05, 0.39093D-05, 0.38550D-05, 0.38008D-05,
     & 0.37476D-05, 0.36956D-05, 0.36454D-05, 0.35971D-05, 0.35511D-05,
     & 0.35075D-05, 0.34663D-05, 0.34275D-05, 0.33913D-05, 0.33575D-05,
     & 0.33261D-05, 0.32971D-05, 0.32704D-05, 0.32458D-05, 0.32232D-05,
     & 0.32026D-05, 0.31838D-05, 0.31666D-05, 0.31511D-05, 0.31370D-05,
     & 0.41971D-05, 0.42089D-05, 0.42070D-05, 0.41942D-05, 0.41730D-05,
     & 0.41454D-05, 0.41132D-05, 0.40777D-05, 0.40402D-05, 0.40017D-05,
     & 0.39630D-05, 0.39248D-05, 0.38875D-05, 0.38515D-05, 0.38171D-05,
     & 0.37846D-05, 0.37539D-05, 0.37252D-05, 0.36985D-05, 0.36738D-05,
     & 0.36510D-05, 0.36301D-05, 0.36110D-05, 0.35935D-05, 0.35776D-05,
     & 0.35632D-05, 0.35502D-05, 0.35384D-05, 0.35278D-05, 0.35183D-05,
     & 0.41048D-05, 0.41543D-05, 0.41863D-05, 0.42038D-05, 0.42096D-05,
     & 0.42062D-05, 0.41956D-05, 0.41797D-05, 0.41599D-05, 0.41374D-05,
     & 0.41132D-05, 0.40881D-05, 0.40628D-05, 0.40378D-05, 0.40134D-05,
     & 0.39899D-05, 0.39676D-05, 0.39466D-05, 0.39269D-05, 0.39086D-05,
     & 0.38917D-05, 0.38761D-05, 0.38618D-05, 0.38488D-05, 0.38369D-05,
     & 0.38262D-05, 0.38164D-05, 0.38076D-05, 0.37997D-05, 0.37926D-05,
     & 0.39140D-05, 0.40052D-05, 0.40754D-05, 0.41274D-05, 0.41642D-05,
     & 0.41886D-05, 0.42029D-05, 0.42090D-05, 0.42089D-05, 0.42040D-05,
     & 0.41956D-05, 0.41847D-05, 0.41721D-05, 0.41585D-05, 0.41444D-05,
     & 0.41302D-05, 0.41161D-05, 0.41026D-05, 0.40896D-05, 0.40773D-05,
     & 0.40657D-05, 0.40550D-05, 0.40450D-05, 0.40359D-05, 0.40275D-05,
     & 0.40198D-05, 0.40129D-05, 0.40066D-05, 0.40009D-05, 0.39958D-05,
     & 0.36173D-05, 0.37531D-05, 0.38643D-05, 0.39540D-05, 0.40256D-05,
     & 0.40813D-05, 0.41238D-05, 0.41553D-05, 0.41779D-05, 0.41933D-05,
     & 0.42029D-05, 0.42080D-05, 0.42097D-05, 0.42088D-05, 0.42059D-05,
     & 0.42018D-05, 0.41968D-05, 0.41912D-05, 0.41854D-05, 0.41795D-05,
     & 0.41736D-05, 0.41679D-05, 0.41625D-05, 0.41574D-05, 0.41526D-05,
     & 0.41482D-05, 0.41441D-05, 0.41403D-05, 0.41369D-05, 0.41337D-05,
     & 0.32119D-05, 0.33922D-05, 0.35461D-05, 0.36761D-05, 0.37845D-05,
     & 0.38742D-05, 0.39475D-05, 0.40073D-05, 0.40554D-05, 0.40937D-05,
     & 0.41238D-05, 0.41473D-05, 0.41654D-05, 0.41791D-05, 0.41893D-05,
     & 0.41967D-05, 0.42020D-05, 0.42055D-05, 0.42078D-05, 0.42091D-05,
     & 0.42096D-05, 0.42096D-05, 0.42092D-05, 0.42086D-05, 0.42078D-05,
     & 0.42068D-05, 0.42059D-05, 0.42049D-05, 0.42039D-05, 0.42029D-05,
     & 0.27056D-05, 0.29259D-05, 0.31200D-05, 0.32889D-05, 0.34350D-05,
     & 0.35601D-05, 0.36664D-05, 0.37562D-05, 0.38318D-05, 0.38949D-05,
     & 0.39476D-05, 0.39915D-05, 0.40279D-05, 0.40581D-05, 0.40830D-05,
     & 0.41036D-05, 0.41206D-05, 0.41346D-05, 0.41461D-05, 0.41556D-05,
     & 0.41635D-05, 0.41701D-05, 0.41755D-05, 0.41800D-05, 0.41837D-05,
     & 0.41868D-05, 0.41895D-05, 0.41917D-05, 0.41935D-05, 0.41951D-05,
     & 0.21218D-05, 0.23701D-05, 0.25959D-05, 0.27989D-05, 0.29793D-05,
     & 0.31379D-05, 0.32762D-05, 0.33965D-05, 0.35004D-05, 0.35898D-05,
     & 0.36665D-05, 0.37321D-05, 0.37882D-05, 0.38361D-05, 0.38770D-05,
     & 0.39119D-05, 0.39417D-05, 0.39673D-05, 0.39892D-05, 0.40080D-05,
     & 0.40241D-05, 0.40379D-05, 0.40499D-05, 0.40602D-05, 0.40691D-05,
     & 0.40768D-05, 0.40835D-05, 0.40893D-05, 0.40944D-05, 0.40988D-05,
     & 0.38054D-05, 0.35981D-05, 0.20010D-05, 0.22261D-05, 0.24315D-05,
     & 0.26171D-05, 0.27834D-05, 0.29312D-05, 0.30617D-05, 0.31761D-05,
     & 0.32763D-05, 0.33638D-05, 0.34401D-05, 0.35065D-05, 0.35642D-05,
     & 0.36143D-05, 0.36578D-05, 0.36957D-05, 0.37286D-05, 0.37572D-05,
     & 0.37822D-05, 0.38039D-05, 0.38229D-05, 0.38395D-05, 0.38540D-05,
     & 0.38667D-05, 0.38778D-05, 0.38876D-05, 0.38961D-05, 0.39036D-05/

      data ((c_grdl(i,j),j=1,30),i=21,30)/
     & 0.28922D-05, 0.34104D-05, 0.37371D-05, 0.37900D-05, 0.34198D-05,
     & 0.20242D-05, 0.22087D-05, 0.23762D-05, 0.25272D-05, 0.26627D-05,
     & 0.27835D-05, 0.28908D-05, 0.29857D-05, 0.30694D-05, 0.31431D-05,
     & 0.32079D-05, 0.32649D-05, 0.33150D-05, 0.33591D-05, 0.33978D-05,
     & 0.34318D-05, 0.34618D-05, 0.34881D-05, 0.35112D-05, 0.35316D-05,
     & 0.35495D-05, 0.35653D-05, 0.35792D-05, 0.35915D-05, 0.36023D-05,
     & 0.32094D-05, 0.32875D-05, 0.32156D-05, 0.31226D-05, 0.35177D-05,
     & 0.37562D-05, 0.37984D-05, 0.35837D-05, 0.28863D-05, 0.20743D-05,
     & 0.22087D-05, 0.23300D-05, 0.24389D-05, 0.25362D-05, 0.26233D-05,
     & 0.27008D-05, 0.27697D-05, 0.28308D-05, 0.28849D-05, 0.29329D-05,
     & 0.29753D-05, 0.30129D-05, 0.30461D-05, 0.30754D-05, 0.31014D-05,
     & 0.31243D-05, 0.31446D-05, 0.31625D-05, 0.31784D-05, 0.31924D-05,
     & 0.11029D-05, 0.21836D-05, 0.31245D-05, 0.32213D-05, 0.31830D-05,
     & 0.31402D-05, 0.30852D-05, 0.34216D-05, 0.36595D-05, 0.37881D-05,
     & 0.37983D-05, 0.36776D-05, 0.33926D-05, 0.28004D-05, 0.20310D-05,
     & 0.21165D-05, 0.21932D-05, 0.22620D-05, 0.23234D-05, 0.23781D-05,
     & 0.24269D-05, 0.24704D-05, 0.25090D-05, 0.25433D-05, 0.25738D-05,
     & 0.26010D-05, 0.26250D-05, 0.26464D-05, 0.26653D-05, 0.26821D-05,
     & 0.63210D-09, 0.15563D-06, 0.68930D-06, 0.15281D-05, 0.24694D-05,
     & 0.31786D-05, 0.32704D-05, 0.32881D-05, 0.32823D-05, 0.27832D-05,
     & 0.30853D-05, 0.33349D-05, 0.35297D-05, 0.36710D-05, 0.37613D-05,
     & 0.38041D-05, 0.38037D-05, 0.37642D-05, 0.36885D-05, 0.35790D-05,
     & 0.34360D-05, 0.32564D-05, 0.30301D-05, 0.27236D-05, 0.19769D-05,
     & 0.20065D-05, 0.20329D-05, 0.20564D-05, 0.20772D-05, 0.20958D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.22839D-07, 0.25890D-06,
     & 0.76150D-06, 0.14535D-05, 0.22123D-05, 0.28856D-05, 0.32301D-05,
     & 0.32703D-05, 0.32545D-05, 0.31953D-05, 0.32827D-05, 0.31075D-05,
     & 0.28801D-05, 0.30516D-05, 0.31983D-05, 0.33220D-05, 0.34251D-05,
     & 0.35101D-05, 0.35794D-05, 0.36353D-05, 0.36797D-05, 0.37147D-05,
     & 0.37419D-05, 0.37626D-05, 0.37782D-05, 0.37895D-05, 0.37976D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.63401D-07,
     & 0.36247D-06, 0.88613D-06, 0.15568D-05, 0.22647D-05, 0.28834D-05,
     & 0.32302D-05, 0.32854D-05, 0.32010D-05, 0.32752D-05, 0.32578D-05,
     & 0.32674D-05, 0.29979D-05, 0.28792D-05, 0.30197D-05, 0.31409D-05,
     & 0.32448D-05, 0.33331D-05, 0.34079D-05, 0.34709D-05, 0.35239D-05,
     & 0.35683D-05, 0.36055D-05, 0.36365D-05, 0.36623D-05, 0.36838D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.27590D-08,
     & 0.12074D-06, 0.46345D-06, 0.99194D-06, 0.16311D-05, 0.22869D-05,
     & 0.28578D-05, 0.32126D-05, 0.32668D-05, 0.31212D-05, 0.32769D-05,
     & 0.31847D-05, 0.32735D-05, 0.32621D-05, 0.30719D-05, 0.28283D-05,
     & 0.29439D-05, 0.30446D-05, 0.31321D-05, 0.32078D-05, 0.32730D-05,
     & 0.33293D-05, 0.33777D-05, 0.34193D-05, 0.34552D-05, 0.34860D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.16572D-07, 0.18662D-06, 0.55532D-06, 0.10743D-05, 0.16751D-05,
     & 0.22796D-05, 0.28085D-05, 0.31705D-05, 0.32136D-05, 0.32530D-05,
     & 0.32083D-05, 0.32881D-05, 0.32009D-05, 0.32711D-05, 0.32765D-05,
     & 0.31981D-05, 0.28946D-05, 0.28305D-05, 0.29140D-05, 0.29872D-05,
     & 0.30514D-05, 0.31075D-05, 0.31564D-05, 0.31992D-05, 0.32365D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.43045D-07, 0.25354D-06, 0.63231D-06, 0.11308D-05,
     & 0.16890D-05, 0.22436D-05, 0.27344D-05, 0.30990D-05, 0.32112D-05,
     & 0.32797D-05, 0.30928D-05, 0.32334D-05, 0.32880D-05, 0.31815D-05,
     & 0.32504D-05, 0.32811D-05, 0.32727D-05, 0.32199D-05, 0.31009D-05,
     & 0.27538D-05, 0.28146D-05, 0.28682D-05, 0.29153D-05, 0.29568D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.15371D-08, 0.78592D-07, 0.31502D-06, 0.69029D-06,
     & 0.11602D-05, 0.16735D-05, 0.21800D-05, 0.26347D-05, 0.29956D-05,
     & 0.32125D-05, 0.32080D-05, 0.32851D-05, 0.31055D-05, 0.32209D-05,
     & 0.32818D-05, 0.32677D-05, 0.31977D-05, 0.32461D-05, 0.32738D-05,
     & 0.32828D-05, 0.32744D-05, 0.32495D-05, 0.32075D-05, 0.31458D-05/

      data ((c_grdl(i,j),j=1,30),i=31,40)/
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.89117D-08, 0.11654D-06, 0.36563D-06,
     & 0.72687D-06, 0.11626D-05, 0.16301D-05, 0.20901D-05, 0.25093D-05,
     & 0.28597D-05, 0.31151D-05, 0.32318D-05, 0.32264D-05, 0.32855D-05,
     & 0.31199D-05, 0.31716D-05, 0.32432D-05, 0.32819D-05, 0.32833D-05,
     & 0.31958D-05, 0.32004D-05, 0.32326D-05, 0.32555D-05, 0.32707D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.21982D-07, 0.15158D-06,
     & 0.40123D-06, 0.74118D-06, 0.11393D-05, 0.15610D-05, 0.19759D-05,
     & 0.23594D-05, 0.26928D-05, 0.29605D-05, 0.31492D-05, 0.32318D-05,
     & 0.32033D-05, 0.32743D-05, 0.32755D-05, 0.30775D-05, 0.31532D-05,
     & 0.32104D-05, 0.32510D-05, 0.32763D-05, 0.32875D-05, 0.32841D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.21346D-09, 0.37999D-07,
     & 0.17930D-06, 0.42049D-06, 0.73368D-06, 0.10923D-05, 0.14690D-05,
     & 0.18397D-05, 0.21871D-05, 0.24977D-05, 0.27621D-05, 0.29742D-05,
     & 0.31292D-05, 0.32190D-05, 0.31940D-05, 0.32188D-05, 0.32691D-05,
     & 0.32854D-05, 0.32601D-05, 0.31186D-05, 0.31177D-05, 0.31585D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.21677D-08,
     & 0.53519D-07, 0.19726D-06, 0.42305D-06, 0.70595D-06, 0.10245D-05,
     & 0.13570D-05, 0.16851D-05, 0.19958D-05, 0.22794D-05, 0.25298D-05,
     & 0.27436D-05, 0.29193D-05, 0.30570D-05, 0.31566D-05, 0.32169D-05,
     & 0.32285D-05, 0.31672D-05, 0.32178D-05, 0.32532D-05, 0.32751D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.57340D-08, 0.65490D-07, 0.20418D-06, 0.40975D-06, 0.66044D-06,
     & 0.93926D-06, 0.12290D-05, 0.15161D-05, 0.17899D-05, 0.20438D-05,
     & 0.22733D-05, 0.24763D-05, 0.26521D-05, 0.28011D-05, 0.29248D-05,
     & 0.30251D-05, 0.31038D-05, 0.31628D-05, 0.32034D-05, 0.32265D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.95922D-08, 0.71954D-07, 0.20007D-06, 0.38236D-06,
     & 0.60032D-06, 0.84043D-06, 0.10895D-05, 0.13370D-05, 0.15747D-05,
     & 0.17975D-05, 0.20023D-05, 0.21871D-05, 0.23516D-05, 0.24964D-05,
     & 0.26224D-05, 0.27309D-05, 0.28236D-05, 0.29022D-05, 0.29682D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.12402D-07, 0.72255D-07, 0.18602D-06,
     & 0.34324D-06, 0.52919D-06, 0.73238D-06, 0.94312D-06, 0.11529D-05,
     & 0.13559D-05, 0.15476D-05, 0.17256D-05, 0.18886D-05, 0.20361D-05,
     & 0.21683D-05, 0.22860D-05, 0.23902D-05, 0.24818D-05, 0.25622D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.38910D-10, 0.13334D-07, 0.66757D-07,
     & 0.16395D-06, 0.29549D-06, 0.45102D-06, 0.61968D-06, 0.79456D-06,
     & 0.96939D-06, 0.11391D-05, 0.13007D-05, 0.14521D-05, 0.15916D-05,
     & 0.17193D-05, 0.18352D-05, 0.19398D-05, 0.20334D-05, 0.21170D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.10684D-09, 0.12236D-07,
     & 0.56643D-07, 0.13632D-06, 0.24302D-06, 0.36981D-06, 0.50679D-06,
     & 0.64888D-06, 0.79137D-06, 0.93053D-06, 0.10636D-05, 0.11889D-05,
     & 0.13055D-05, 0.14131D-05, 0.15112D-05, 0.16003D-05, 0.16809D-05,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.89600D-10,
     & 0.95595D-08, 0.43702D-07, 0.10576D-06, 0.18943D-06, 0.28877D-06,
     & 0.39798D-06, 0.51071D-06, 0.62406D-06, 0.73523D-06, 0.84220D-06,
     & 0.94348D-06, 0.10382D-05, 0.11258D-05, 0.12065D-05, 0.12801D-05/

      data ((c_grdl(i,j),j=1,30),i=41,50)/
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.17572D-10, 0.61540D-08, 0.30090D-07, 0.75358D-07, 0.13817D-06,
     & 0.21308D-06, 0.29638D-06, 0.38401D-06, 0.47178D-06, 0.55818D-06,
     & 0.64167D-06, 0.72110D-06, 0.79580D-06, 0.86533D-06, 0.92952D-06,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.29858D-08, 0.17782D-07, 0.47801D-07,
     & 0.91947D-07, 0.14620D-06, 0.20674D-06, 0.27130D-06, 0.33755D-06,
     & 0.40295D-06, 0.46608D-06, 0.52642D-06, 0.58338D-06, 0.63663D-06,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.83897D-09, 0.83145D-08,
     & 0.25872D-07, 0.53789D-07, 0.90164D-07, 0.13212D-06, 0.17727D-06,
     & 0.22401D-06, 0.27104D-06, 0.31732D-06, 0.36201D-06, 0.40392D-06,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.24959D-10,
     & 0.25016D-08, 0.10874D-07, 0.26011D-07, 0.47435D-07, 0.73873D-07,
     & 0.10335D-06, 0.13455D-06, 0.16620D-06, 0.19759D-06, 0.22821D-06,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.19417D-09, 0.27459D-08, 0.91282D-08, 0.19506D-07,
     & 0.33426D-07, 0.50165D-07, 0.68836D-07, 0.88418D-07, 0.10825D-06,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.10312D-09, 0.15095D-08,
     & 0.49813D-08, 0.10579D-07, 0.18050D-07, 0.27009D-07, 0.37034D-07,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.25462D-09, 0.13603D-08, 0.34372D-08, 0.64174D-08,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.14786D-10,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00/

      DO I=1,50
        DO J=1,30
          UDS_GRD(I,J) = UDS_GRDL(I,J)
          G_GRD(I,J)   = G_GRDL(I,J)
          C_GRD(I,J)   = C_GRDL(I,J)
        ENDDO
      ENDDO

      RETURN
      END
*CMZ :  2.06/31 23/06/99  12.57.26  by  Hannes Jung
*CMZ :  2.06/17 11/08/97  140.2 71/6
*-- Author :
      SUBROUTINE I_NLO_Q3G1
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NQ2MAX=30,NZMAX=50)
      DIMENSION UDS_GRD(NZMAX,NQ2MAX),C_GRD(NZMAX,NQ2MAX),
     &          G_GRD(NZMAX,NQ2MAX)
      DIMENSION UDS_GRDL(NZMAX,NQ2MAX),C_GRDL(NZMAX,NQ2MAX),
     &          G_GRDL(NZMAX,NQ2MAX)
      COMMON /CPARAM/ UDS_GRD,C_GRD,G_GRD

      data ((uds_grdl(i,j),j=1,30),i=1,10)/
     & 0.22512D-03, 0.23099D-02, 0.44126D-02, 0.65304D-02, 0.86608D-02,
     & 0.10801D-01, 0.12948D-01, 0.15102D-01, 0.17263D-01, 0.19427D-01,
     & 0.21594D-01, 0.23763D-01, 0.25933D-01, 0.28102D-01, 0.30270D-01,
     & 0.32437D-01, 0.34600D-01, 0.36761D-01, 0.38919D-01, 0.41072D-01,
     & 0.43219D-01, 0.45361D-01, 0.47497D-01, 0.49626D-01, 0.51749D-01,
     & 0.53867D-01, 0.55978D-01, 0.58080D-01, 0.60173D-01, 0.62258D-01,
     & 0.24680D-03, 0.22735D-02, 0.43129D-02, 0.63626D-02, 0.84205D-02,
     & 0.10485D-01, 0.12553D-01, 0.14624D-01, 0.16698D-01, 0.18773D-01,
     & 0.20847D-01, 0.22921D-01, 0.24993D-01, 0.27061D-01, 0.29126D-01,
     & 0.31186D-01, 0.33242D-01, 0.35292D-01, 0.37339D-01, 0.39378D-01,
     & 0.41410D-01, 0.43434D-01, 0.45450D-01, 0.47458D-01, 0.49457D-01,
     & 0.51453D-01, 0.53438D-01, 0.55413D-01, 0.57379D-01, 0.59335D-01,
     & 0.27352D-03, 0.22426D-02, 0.42196D-02, 0.62023D-02, 0.81892D-02,
     & 0.10179D-01, 0.12170D-01, 0.14160D-01, 0.16150D-01, 0.18137D-01,
     & 0.20121D-01, 0.22102D-01, 0.24079D-01, 0.26050D-01, 0.28015D-01,
     & 0.29973D-01, 0.31924D-01, 0.33868D-01, 0.35807D-01, 0.37737D-01,
     & 0.39657D-01, 0.41568D-01, 0.43469D-01, 0.45361D-01, 0.47243D-01,
     & 0.49119D-01, 0.50985D-01, 0.52839D-01, 0.54683D-01, 0.56515D-01,
     & 0.30663D-03, 0.22192D-02, 0.41348D-02, 0.60521D-02, 0.79696D-02,
     & 0.98863D-02, 0.11802D-01, 0.13714D-01, 0.15622D-01, 0.17524D-01,
     & 0.19421D-01, 0.21312D-01, 0.23198D-01, 0.25075D-01, 0.26943D-01,
     & 0.28803D-01, 0.30653D-01, 0.32495D-01, 0.34331D-01, 0.36155D-01,
     & 0.37969D-01, 0.39771D-01, 0.41563D-01, 0.43343D-01, 0.45113D-01,
     & 0.46877D-01, 0.48628D-01, 0.50367D-01, 0.52094D-01, 0.53809D-01,
     & 0.34785D-03, 0.22042D-02, 0.40593D-02, 0.59119D-02, 0.77611D-02,
     & 0.96063D-02, 0.11448D-01, 0.13283D-01, 0.15111D-01, 0.16930D-01,
     & 0.18741D-01, 0.20546D-01, 0.22342D-01, 0.24128D-01, 0.25903D-01,
     & 0.27667D-01, 0.29420D-01, 0.31163D-01, 0.32899D-01, 0.34621D-01,
     & 0.36332D-01, 0.38030D-01, 0.39715D-01, 0.41389D-01, 0.43051D-01,
     & 0.44706D-01, 0.46347D-01, 0.47976D-01, 0.49591D-01, 0.51194D-01,
     & 0.39944D-03, 0.21999D-02, 0.39950D-02, 0.57838D-02, 0.75658D-02,
     & 0.93406D-02, 0.11110D-01, 0.12870D-01, 0.14619D-01, 0.16357D-01,
     & 0.18085D-01, 0.19805D-01, 0.21514D-01, 0.23211D-01, 0.24895D-01,
     & 0.26566D-01, 0.28225D-01, 0.29872D-01, 0.31511D-01, 0.33136D-01,
     & 0.34746D-01, 0.36344D-01, 0.37928D-01, 0.39498D-01, 0.41057D-01,
     & 0.42607D-01, 0.44143D-01, 0.45666D-01, 0.47174D-01, 0.48669D-01,
     & 0.46435D-03, 0.22095D-02, 0.39453D-02, 0.56713D-02, 0.73871D-02,
     & 0.90929D-02, 0.10791D-01, 0.12477D-01, 0.14149D-01, 0.15809D-01,
     & 0.17455D-01, 0.19092D-01, 0.20717D-01, 0.22327D-01, 0.23923D-01,
     & 0.25504D-01, 0.27072D-01, 0.28627D-01, 0.30172D-01, 0.31702D-01,
     & 0.33217D-01, 0.34718D-01, 0.36204D-01, 0.37675D-01, 0.39134D-01,
     & 0.40584D-01, 0.42020D-01, 0.43440D-01, 0.44847D-01, 0.46239D-01,
     & 0.54647D-03, 0.22370D-02, 0.39145D-02, 0.55788D-02, 0.72299D-02,
     & 0.88683D-02, 0.10497D-01, 0.12110D-01, 0.13708D-01, 0.15291D-01,
     & 0.16859D-01, 0.18416D-01, 0.19959D-01, 0.21485D-01, 0.22996D-01,
     & 0.24491D-01, 0.25971D-01, 0.27437D-01, 0.28892D-01, 0.30331D-01,
     & 0.31754D-01, 0.33161D-01, 0.34554D-01, 0.35931D-01, 0.37294D-01,
     & 0.38649D-01, 0.39988D-01, 0.41312D-01, 0.42621D-01, 0.43915D-01,
     & 0.65085D-03, 0.22878D-02, 0.39083D-02, 0.55125D-02, 0.71005D-02,
     & 0.86733D-02, 0.10234D-01, 0.11778D-01, 0.13303D-01, 0.14812D-01,
     & 0.16304D-01, 0.17783D-01, 0.19247D-01, 0.20693D-01, 0.22121D-01,
     & 0.23533D-01, 0.24929D-01, 0.26310D-01, 0.27678D-01, 0.29030D-01,
     & 0.30365D-01, 0.31684D-01, 0.32986D-01, 0.34274D-01, 0.35547D-01,
     & 0.36810D-01, 0.38057D-01, 0.39289D-01, 0.40505D-01, 0.41707D-01,
     & 0.78410D-03, 0.23679D-02, 0.39319D-02, 0.54767D-02, 0.70027D-02,
     & 0.85109D-02, 0.10005D-01, 0.11480D-01, 0.12935D-01, 0.14371D-01,
     & 0.15789D-01, 0.17192D-01, 0.18579D-01, 0.19946D-01, 0.21296D-01,
     & 0.22627D-01, 0.23940D-01, 0.25239D-01, 0.26524D-01, 0.27791D-01,
     & 0.29041D-01, 0.30274D-01, 0.31491D-01, 0.32692D-01, 0.33877D-01,
     & 0.35053D-01, 0.36212D-01, 0.37355D-01, 0.38483D-01, 0.39596D-01/

      data ((uds_grdl(i,j),j=1,30),i=11,20)/
     & 0.95485D-03, 0.24860D-02, 0.39944D-02, 0.54807D-02, 0.69456D-02,
     & 0.83906D-02, 0.98198D-02, 0.11227D-01, 0.12613D-01, 0.13978D-01,
     & 0.15324D-01, 0.16653D-01, 0.17965D-01, 0.19257D-01, 0.20529D-01,
     & 0.21782D-01, 0.23016D-01, 0.24235D-01, 0.25439D-01, 0.26626D-01,
     & 0.27794D-01, 0.28944D-01, 0.30078D-01, 0.31196D-01, 0.32298D-01,
     & 0.33389D-01, 0.34464D-01, 0.35523D-01, 0.36566D-01, 0.37595D-01,
     & 0.11744D-02, 0.26540D-02, 0.41079D-02, 0.55371D-02, 0.69426D-02,
     & 0.83259D-02, 0.96916D-02, 0.11033D-01, 0.12352D-01, 0.13649D-01,
     & 0.14925D-01, 0.16183D-01, 0.17423D-01, 0.18641D-01, 0.19839D-01,
     & 0.21016D-01, 0.22175D-01, 0.23317D-01, 0.24445D-01, 0.25553D-01,
     & 0.26643D-01, 0.27715D-01, 0.28770D-01, 0.29808D-01, 0.30831D-01,
     & 0.31842D-01, 0.32837D-01, 0.33816D-01, 0.34779D-01, 0.35727D-01,
     & 0.14573D-02, 0.28854D-02, 0.42852D-02, 0.56578D-02, 0.70045D-02,
     & 0.83271D-02, 0.96300D-02, 0.10907D-01, 0.12160D-01, 0.13390D-01,
     & 0.14597D-01, 0.15786D-01, 0.16955D-01, 0.18102D-01, 0.19227D-01,
     & 0.20332D-01, 0.21417D-01, 0.22484D-01, 0.23537D-01, 0.24570D-01,
     & 0.25584D-01, 0.26580D-01, 0.27559D-01, 0.28521D-01, 0.29467D-01,
     & 0.30401D-01, 0.31319D-01, 0.32221D-01, 0.33107D-01, 0.33978D-01,
     & 0.18219D-02, 0.31993D-02, 0.45457D-02, 0.58629D-02, 0.71519D-02,
     & 0.84150D-02, 0.96566D-02, 0.10871D-01, 0.12060D-01, 0.13225D-01,
     & 0.14365D-01, 0.15486D-01, 0.16587D-01, 0.17664D-01, 0.18720D-01,
     & 0.19754D-01, 0.20769D-01, 0.21765D-01, 0.22745D-01, 0.23706D-01,
     & 0.24647D-01, 0.25571D-01, 0.26477D-01, 0.27366D-01, 0.28239D-01,
     & 0.29100D-01, 0.29944D-01, 0.30773D-01, 0.31586D-01, 0.32384D-01,
     & 0.22915D-02, 0.36187D-02, 0.49128D-02, 0.61754D-02, 0.74081D-02,
     & 0.86129D-02, 0.97945D-02, 0.10948D-01, 0.12074D-01, 0.13175D-01,
     & 0.14251D-01, 0.15307D-01, 0.16340D-01, 0.17351D-01, 0.18339D-01,
     & 0.19305D-01, 0.20251D-01, 0.21178D-01, 0.22089D-01, 0.22980D-01,
     & 0.23852D-01, 0.24705D-01, 0.25541D-01, 0.26361D-01, 0.27164D-01,
     & 0.27954D-01, 0.28729D-01, 0.29487D-01, 0.30231D-01, 0.30959D-01,
     & 0.28965D-02, 0.41720D-02, 0.54123D-02, 0.66191D-02, 0.77943D-02,
     & 0.89400D-02, 0.10061D-01, 0.11152D-01, 0.12216D-01, 0.13252D-01,
     & 0.14264D-01, 0.15254D-01, 0.16221D-01, 0.17165D-01, 0.18085D-01,
     & 0.18984D-01, 0.19862D-01, 0.20721D-01, 0.21563D-01, 0.22386D-01,
     & 0.23189D-01, 0.23974D-01, 0.24742D-01, 0.25493D-01, 0.26228D-01,
     & 0.26950D-01, 0.27656D-01, 0.28346D-01, 0.29022D-01, 0.29683D-01,
     & 0.36714D-02, 0.48945D-02, 0.60804D-02, 0.72311D-02, 0.83485D-02,
     & 0.94350D-02, 0.10495D-01, 0.11524D-01, 0.12525D-01, 0.13498D-01,
     & 0.14446D-01, 0.15370D-01, 0.16272D-01, 0.17150D-01, 0.18004D-01,
     & 0.18837D-01, 0.19648D-01, 0.20441D-01, 0.21216D-01, 0.21971D-01,
     & 0.22707D-01, 0.23426D-01, 0.24127D-01, 0.24811D-01, 0.25480D-01,
     & 0.26135D-01, 0.26775D-01, 0.27400D-01, 0.28010D-01, 0.28606D-01,
     & 0.46583D-02, 0.58267D-02, 0.69561D-02, 0.80489D-02, 0.91069D-02,
     & 0.10133D-01, 0.11130D-01, 0.12097D-01, 0.13034D-01, 0.13943D-01,
     & 0.14825D-01, 0.15684D-01, 0.16520D-01, 0.17331D-01, 0.18119D-01,
     & 0.18886D-01, 0.19631D-01, 0.20356D-01, 0.21064D-01, 0.21753D-01,
     & 0.22423D-01, 0.23076D-01, 0.23711D-01, 0.24330D-01, 0.24933D-01,
     & 0.25523D-01, 0.26098D-01, 0.26658D-01, 0.27204D-01, 0.27737D-01,
     & 0.59035D-02, 0.70131D-02, 0.80823D-02, 0.91135D-02, 0.10109D-01,
     & 0.11071D-01, 0.12003D-01, 0.12904D-01, 0.13774D-01, 0.14617D-01,
     & 0.15432D-01, 0.16224D-01, 0.16992D-01, 0.17735D-01, 0.18456D-01,
     & 0.19154D-01, 0.19832D-01, 0.20490D-01, 0.21131D-01, 0.21752D-01,
     & 0.22356D-01, 0.22942D-01, 0.23511D-01, 0.24064D-01, 0.24603D-01,
     & 0.25127D-01, 0.25637D-01, 0.26133D-01, 0.26616D-01, 0.27086D-01,
     & 0.74537D-02, 0.84981D-02, 0.95010D-02, 0.10465D-01, 0.11392D-01,
     & 0.12285D-01, 0.13147D-01, 0.13978D-01, 0.14778D-01, 0.15550D-01,
     & 0.16294D-01, 0.17015D-01, 0.17711D-01, 0.18384D-01, 0.19034D-01,
     & 0.19662D-01, 0.20270D-01, 0.20858D-01, 0.21429D-01, 0.21981D-01,
     & 0.22516D-01, 0.23034D-01, 0.23536D-01, 0.24022D-01, 0.24494D-01,
     & 0.24953D-01, 0.25397D-01, 0.25828D-01, 0.26246D-01, 0.26652D-01/

      data ((uds_grdl(i,j),j=1,30),i=21,30)/
     & 0.93478D-02, 0.10318D-01, 0.11246D-01, 0.12135D-01, 0.12987D-01,
     & 0.13803D-01, 0.14588D-01, 0.15341D-01, 0.16065D-01, 0.16760D-01,
     & 0.17428D-01, 0.18072D-01, 0.18691D-01, 0.19288D-01, 0.19863D-01,
     & 0.20416D-01, 0.20950D-01, 0.21465D-01, 0.21961D-01, 0.22441D-01,
     & 0.22904D-01, 0.23350D-01, 0.23782D-01, 0.24198D-01, 0.24601D-01,
     & 0.24991D-01, 0.25367D-01, 0.25731D-01, 0.26083D-01, 0.26424D-01,
     & 0.11605D-01, 0.12485D-01, 0.13324D-01, 0.14123D-01, 0.14885D-01,
     & 0.15613D-01, 0.16308D-01, 0.16972D-01, 0.17607D-01, 0.18214D-01,
     & 0.18796D-01, 0.19353D-01, 0.19887D-01, 0.20398D-01, 0.20889D-01,
     & 0.21359D-01, 0.21811D-01, 0.22245D-01, 0.22661D-01, 0.23061D-01,
     & 0.23445D-01, 0.23814D-01, 0.24169D-01, 0.24511D-01, 0.24839D-01,
     & 0.25155D-01, 0.25459D-01, 0.25751D-01, 0.26033D-01, 0.26304D-01,
     & 0.14186D-01, 0.14958D-01, 0.15690D-01, 0.16383D-01, 0.17040D-01,
     & 0.17663D-01, 0.18254D-01, 0.18815D-01, 0.19349D-01, 0.19856D-01,
     & 0.20339D-01, 0.20798D-01, 0.21235D-01, 0.21651D-01, 0.22048D-01,
     & 0.22427D-01, 0.22788D-01, 0.23132D-01, 0.23459D-01, 0.23772D-01,
     & 0.24071D-01, 0.24356D-01, 0.24628D-01, 0.24888D-01, 0.25137D-01,
     & 0.25373D-01, 0.25599D-01, 0.25815D-01, 0.26022D-01, 0.26219D-01,
     & 0.16971D-01, 0.17610D-01, 0.18211D-01, 0.18775D-01, 0.19306D-01,
     & 0.19804D-01, 0.20271D-01, 0.20712D-01, 0.21127D-01, 0.21518D-01,
     & 0.21886D-01, 0.22233D-01, 0.22559D-01, 0.22866D-01, 0.23157D-01,
     & 0.23431D-01, 0.23690D-01, 0.23934D-01, 0.24162D-01, 0.24378D-01,
     & 0.24582D-01, 0.24775D-01, 0.24956D-01, 0.25128D-01, 0.25289D-01,
     & 0.25439D-01, 0.25581D-01, 0.25714D-01, 0.25840D-01, 0.25958D-01,
     & 0.19693D-01, 0.20165D-01, 0.20603D-01, 0.21008D-01, 0.21384D-01,
     & 0.21731D-01, 0.22050D-01, 0.22345D-01, 0.22619D-01, 0.22873D-01,
     & 0.23108D-01, 0.23323D-01, 0.23520D-01, 0.23703D-01, 0.23872D-01,
     & 0.24028D-01, 0.24171D-01, 0.24301D-01, 0.24419D-01, 0.24527D-01,
     & 0.24626D-01, 0.24716D-01, 0.24798D-01, 0.24872D-01, 0.24938D-01,
     & 0.24995D-01, 0.25045D-01, 0.25090D-01, 0.25129D-01, 0.25163D-01,
     & 0.20289D-01, 0.20716D-01, 0.21109D-01, 0.21472D-01, 0.21806D-01,
     & 0.22113D-01, 0.22392D-01, 0.22649D-01, 0.22885D-01, 0.23103D-01,
     & 0.23302D-01, 0.23483D-01, 0.23647D-01, 0.23797D-01, 0.23935D-01,
     & 0.24060D-01, 0.24174D-01, 0.24275D-01, 0.24365D-01, 0.24446D-01,
     & 0.24518D-01, 0.24582D-01, 0.24639D-01, 0.24689D-01, 0.24731D-01,
     & 0.24765D-01, 0.24793D-01, 0.24816D-01, 0.24834D-01, 0.24847D-01,
     & 0.20826D-01, 0.21206D-01, 0.21555D-01, 0.21874D-01, 0.22167D-01,
     & 0.22433D-01, 0.22672D-01, 0.22891D-01, 0.23090D-01, 0.23272D-01,
     & 0.23436D-01, 0.23583D-01, 0.23714D-01, 0.23833D-01, 0.23939D-01,
     & 0.24035D-01, 0.24119D-01, 0.24193D-01, 0.24255D-01, 0.24309D-01,
     & 0.24355D-01, 0.24395D-01, 0.24427D-01, 0.24453D-01, 0.24473D-01,
     & 0.24484D-01, 0.24490D-01, 0.24492D-01, 0.24490D-01, 0.24483D-01,
     & 0.21300D-01, 0.21633D-01, 0.21937D-01, 0.22214D-01, 0.22464D-01,
     & 0.22689D-01, 0.22889D-01, 0.23070D-01, 0.23232D-01, 0.23378D-01,
     & 0.23509D-01, 0.23622D-01, 0.23720D-01, 0.23808D-01, 0.23884D-01,
     & 0.23950D-01, 0.24006D-01, 0.24052D-01, 0.24087D-01, 0.24115D-01,
     & 0.24136D-01, 0.24151D-01, 0.24160D-01, 0.24163D-01, 0.24160D-01,
     & 0.24150D-01, 0.24136D-01, 0.24117D-01, 0.24095D-01, 0.24069D-01,
     & 0.21708D-01, 0.21995D-01, 0.22254D-01, 0.22486D-01, 0.22695D-01,
     & 0.22880D-01, 0.23040D-01, 0.23183D-01, 0.23309D-01, 0.23420D-01,
     & 0.23516D-01, 0.23596D-01, 0.23663D-01, 0.23719D-01, 0.23766D-01,
     & 0.23803D-01, 0.23831D-01, 0.23850D-01, 0.23860D-01, 0.23862D-01,
     & 0.23859D-01, 0.23851D-01, 0.23837D-01, 0.23818D-01, 0.23794D-01,
     & 0.23763D-01, 0.23728D-01, 0.23691D-01, 0.23650D-01, 0.23606D-01,
     & 0.22049D-01, 0.22289D-01, 0.22502D-01, 0.22692D-01, 0.22858D-01,
     & 0.23003D-01, 0.23124D-01, 0.23230D-01, 0.23320D-01, 0.23396D-01,
     & 0.23458D-01, 0.23506D-01, 0.23542D-01, 0.23568D-01, 0.23585D-01,
     & 0.23594D-01, 0.23596D-01, 0.23589D-01, 0.23573D-01, 0.23551D-01,
     & 0.23525D-01, 0.23493D-01, 0.23457D-01, 0.23417D-01, 0.23373D-01,
     & 0.23322D-01, 0.23268D-01, 0.23212D-01, 0.23153D-01, 0.23092D-01/

      data ((uds_grdl(i,j),j=1,30),i=31,40)/
     & 0.22320D-01, 0.22513D-01, 0.22681D-01, 0.22827D-01, 0.22952D-01,
     & 0.23057D-01, 0.23140D-01, 0.23208D-01, 0.23262D-01, 0.23304D-01,
     & 0.23334D-01, 0.23350D-01, 0.23355D-01, 0.23352D-01, 0.23341D-01,
     & 0.23323D-01, 0.23298D-01, 0.23266D-01, 0.23225D-01, 0.23180D-01,
     & 0.23131D-01, 0.23078D-01, 0.23021D-01, 0.22961D-01, 0.22897D-01,
     & 0.22827D-01, 0.22755D-01, 0.22682D-01, 0.22606D-01, 0.22529D-01,
     & 0.22520D-01, 0.22666D-01, 0.22789D-01, 0.22892D-01, 0.22975D-01,
     & 0.23040D-01, 0.23085D-01, 0.23117D-01, 0.23136D-01, 0.23144D-01,
     & 0.23142D-01, 0.23127D-01, 0.23102D-01, 0.23070D-01, 0.23032D-01,
     & 0.22988D-01, 0.22938D-01, 0.22881D-01, 0.22817D-01, 0.22750D-01,
     & 0.22679D-01, 0.22605D-01, 0.22528D-01, 0.22449D-01, 0.22366D-01,
     & 0.22279D-01, 0.22190D-01, 0.22099D-01, 0.22008D-01, 0.21915D-01,
     & 0.22648D-01, 0.22746D-01, 0.22824D-01, 0.22884D-01, 0.22927D-01,
     & 0.22953D-01, 0.22960D-01, 0.22955D-01, 0.22941D-01, 0.22916D-01,
     & 0.22882D-01, 0.22837D-01, 0.22783D-01, 0.22724D-01, 0.22659D-01,
     & 0.22589D-01, 0.22515D-01, 0.22435D-01, 0.22348D-01, 0.22259D-01,
     & 0.22168D-01, 0.22074D-01, 0.21979D-01, 0.21881D-01, 0.21781D-01,
     & 0.21677D-01, 0.21572D-01, 0.21466D-01, 0.21360D-01, 0.21253D-01,
     & 0.22702D-01, 0.22753D-01, 0.22787D-01, 0.22804D-01, 0.22806D-01,
     & 0.22793D-01, 0.22763D-01, 0.22724D-01, 0.22675D-01, 0.22618D-01,
     & 0.22554D-01, 0.22480D-01, 0.22398D-01, 0.22312D-01, 0.22222D-01,
     & 0.22128D-01, 0.22030D-01, 0.21928D-01, 0.21820D-01, 0.21711D-01,
     & 0.21600D-01, 0.21488D-01, 0.21374D-01, 0.21259D-01, 0.21143D-01,
     & 0.21023D-01, 0.20903D-01, 0.20783D-01, 0.20663D-01, 0.20543D-01,
     & 0.22682D-01, 0.22687D-01, 0.22676D-01, 0.22651D-01, 0.22614D-01,
     & 0.22563D-01, 0.22497D-01, 0.22423D-01, 0.22342D-01, 0.22254D-01,
     & 0.22160D-01, 0.22057D-01, 0.21949D-01, 0.21837D-01, 0.21722D-01,
     & 0.21605D-01, 0.21485D-01, 0.21362D-01, 0.21234D-01, 0.21106D-01,
     & 0.20976D-01, 0.20847D-01, 0.20716D-01, 0.20585D-01, 0.20454D-01,
     & 0.20320D-01, 0.20186D-01, 0.20053D-01, 0.19920D-01, 0.19788D-01,
     & 0.22582D-01, 0.22539D-01, 0.22484D-01, 0.22417D-01, 0.22340D-01,
     & 0.22252D-01, 0.22150D-01, 0.22042D-01, 0.21929D-01, 0.21811D-01,
     & 0.21688D-01, 0.21558D-01, 0.21424D-01, 0.21287D-01, 0.21149D-01,
     & 0.21010D-01, 0.20869D-01, 0.20725D-01, 0.20579D-01, 0.20432D-01,
     & 0.20286D-01, 0.20140D-01, 0.19994D-01, 0.19849D-01, 0.19703D-01,
     & 0.19556D-01, 0.19409D-01, 0.19264D-01, 0.19120D-01, 0.18977D-01,
     & 0.22407D-01, 0.22319D-01, 0.22220D-01, 0.22112D-01, 0.21996D-01,
     & 0.21871D-01, 0.21735D-01, 0.21594D-01, 0.21450D-01, 0.21303D-01,
     & 0.21152D-01, 0.20997D-01, 0.20838D-01, 0.20678D-01, 0.20518D-01,
     & 0.20357D-01, 0.20196D-01, 0.20035D-01, 0.19870D-01, 0.19707D-01,
     & 0.19545D-01, 0.19384D-01, 0.19224D-01, 0.19065D-01, 0.18907D-01,
     & 0.18748D-01, 0.18590D-01, 0.18434D-01, 0.18280D-01, 0.18127D-01,
     & 0.22157D-01, 0.22022D-01, 0.21881D-01, 0.21732D-01, 0.21578D-01,
     & 0.21417D-01, 0.21247D-01, 0.21075D-01, 0.20902D-01, 0.20726D-01,
     & 0.20550D-01, 0.20369D-01, 0.20187D-01, 0.20005D-01, 0.19825D-01,
     & 0.19645D-01, 0.19465D-01, 0.19286D-01, 0.19106D-01, 0.18927D-01,
     & 0.18751D-01, 0.18576D-01, 0.18403D-01, 0.18232D-01, 0.18063D-01,
     & 0.17893D-01, 0.17726D-01, 0.17560D-01, 0.17397D-01, 0.17237D-01,
     & 0.21828D-01, 0.21648D-01, 0.21464D-01, 0.21276D-01, 0.21084D-01,
     & 0.20889D-01, 0.20686D-01, 0.20484D-01, 0.20282D-01, 0.20080D-01,
     & 0.19878D-01, 0.19674D-01, 0.19470D-01, 0.19268D-01, 0.19068D-01,
     & 0.18870D-01, 0.18673D-01, 0.18478D-01, 0.18283D-01, 0.18091D-01,
     & 0.17902D-01, 0.17715D-01, 0.17531D-01, 0.17349D-01, 0.17170D-01,
     & 0.16991D-01, 0.16815D-01, 0.16641D-01, 0.16471D-01, 0.16303D-01,
     & 0.21420D-01, 0.21195D-01, 0.20969D-01, 0.20742D-01, 0.20514D-01,
     & 0.20285D-01, 0.20051D-01, 0.19819D-01, 0.19590D-01, 0.19362D-01,
     & 0.19137D-01, 0.18911D-01, 0.18686D-01, 0.18465D-01, 0.18247D-01,
     & 0.18032D-01, 0.17821D-01, 0.17611D-01, 0.17403D-01, 0.17198D-01,
     & 0.16998D-01, 0.16800D-01, 0.16606D-01, 0.16415D-01, 0.16227D-01,
     & 0.16041D-01, 0.15857D-01, 0.15678D-01, 0.15501D-01, 0.15328D-01/

      data ((uds_grdl(i,j),j=1,30),i=41,50)/
     & 0.20930D-01, 0.20661D-01, 0.20393D-01, 0.20128D-01, 0.19864D-01,
     & 0.19602D-01, 0.19338D-01, 0.19079D-01, 0.18823D-01, 0.18572D-01,
     & 0.18324D-01, 0.18077D-01, 0.17834D-01, 0.17596D-01, 0.17361D-01,
     & 0.17132D-01, 0.16906D-01, 0.16684D-01, 0.16464D-01, 0.16249D-01,
     & 0.16038D-01, 0.15832D-01, 0.15629D-01, 0.15431D-01, 0.15236D-01,
     & 0.15043D-01, 0.14855D-01, 0.14670D-01, 0.14489D-01, 0.14312D-01,
     & 0.20356D-01, 0.20042D-01, 0.19734D-01, 0.19431D-01, 0.19133D-01,
     & 0.18840D-01, 0.18547D-01, 0.18261D-01, 0.17981D-01, 0.17707D-01,
     & 0.17438D-01, 0.17173D-01, 0.16912D-01, 0.16658D-01, 0.16409D-01,
     & 0.16166D-01, 0.15928D-01, 0.15695D-01, 0.15466D-01, 0.15241D-01,
     & 0.15022D-01, 0.14809D-01, 0.14599D-01, 0.14395D-01, 0.14195D-01,
     & 0.13998D-01, 0.13805D-01, 0.13617D-01, 0.13433D-01, 0.13253D-01,
     & 0.19691D-01, 0.19334D-01, 0.18985D-01, 0.18646D-01, 0.18314D-01,
     & 0.17990D-01, 0.17670D-01, 0.17359D-01, 0.17056D-01, 0.16761D-01,
     & 0.16473D-01, 0.16190D-01, 0.15915D-01, 0.15646D-01, 0.15385D-01,
     & 0.15130D-01, 0.14882D-01, 0.14640D-01, 0.14402D-01, 0.14171D-01,
     & 0.13946D-01, 0.13726D-01, 0.13512D-01, 0.13304D-01, 0.13100D-01,
     & 0.12900D-01, 0.12705D-01, 0.12515D-01, 0.12330D-01, 0.12149D-01,
     & 0.18925D-01, 0.18525D-01, 0.18137D-01, 0.17761D-01, 0.17397D-01,
     & 0.17044D-01, 0.16698D-01, 0.16363D-01, 0.16039D-01, 0.15724D-01,
     & 0.15419D-01, 0.15121D-01, 0.14832D-01, 0.14552D-01, 0.14279D-01,
     & 0.14015D-01, 0.13759D-01, 0.13509D-01, 0.13266D-01, 0.13030D-01,
     & 0.12800D-01, 0.12577D-01, 0.12360D-01, 0.12149D-01, 0.11943D-01,
     & 0.11743D-01, 0.11548D-01, 0.11358D-01, 0.11173D-01, 0.10993D-01,
     & 0.18031D-01, 0.17588D-01, 0.17162D-01, 0.16751D-01, 0.16356D-01,
     & 0.15974D-01, 0.15604D-01, 0.15248D-01, 0.14904D-01, 0.14573D-01,
     & 0.14252D-01, 0.13942D-01, 0.13642D-01, 0.13352D-01, 0.13071D-01,
     & 0.12800D-01, 0.12538D-01, 0.12284D-01, 0.12037D-01, 0.11798D-01,
     & 0.11567D-01, 0.11343D-01, 0.11125D-01, 0.10914D-01, 0.10710D-01,
     & 0.10511D-01, 0.10318D-01, 0.10130D-01, 0.99483D-02, 0.97713D-02,
     & 0.16981D-01, 0.16493D-01, 0.16027D-01, 0.15581D-01, 0.15155D-01,
     & 0.14747D-01, 0.14356D-01, 0.13981D-01, 0.13621D-01, 0.13276D-01,
     & 0.12944D-01, 0.12624D-01, 0.12317D-01, 0.12022D-01, 0.11737D-01,
     & 0.11463D-01, 0.11198D-01, 0.10943D-01, 0.10697D-01, 0.10460D-01,
     & 0.10230D-01, 0.10008D-01, 0.97939D-02, 0.95864D-02, 0.93857D-02,
     & 0.91919D-02, 0.90041D-02, 0.88221D-02, 0.86456D-02, 0.84745D-02,
     & 0.15730D-01, 0.15213D-01, 0.14721D-01, 0.14251D-01, 0.13804D-01,
     & 0.13376D-01, 0.12968D-01, 0.12578D-01, 0.12205D-01, 0.11848D-01,
     & 0.11506D-01, 0.11179D-01, 0.10866D-01, 0.10565D-01, 0.10277D-01,
     & 0.99995D-02, 0.97332D-02, 0.94775D-02, 0.92324D-02, 0.89963D-02,
     & 0.87689D-02, 0.85499D-02, 0.83388D-02, 0.81353D-02, 0.79392D-02,
     & 0.77510D-02, 0.75692D-02, 0.73935D-02, 0.72237D-02, 0.70595D-02,
     & 0.14416D-01, 0.13778D-01, 0.13179D-01, 0.12618D-01, 0.12090D-01,
     & 0.11596D-01, 0.11137D-01, 0.10703D-01, 0.10293D-01, 0.99058D-02,
     & 0.95392D-02, 0.91955D-02, 0.88715D-02, 0.85632D-02, 0.82700D-02,
     & 0.79909D-02, 0.77253D-02, 0.74736D-02, 0.72365D-02, 0.70097D-02,
     & 0.67927D-02, 0.65850D-02, 0.63864D-02, 0.61963D-02, 0.60146D-02,
     & 0.58432D-02, 0.56785D-02, 0.55202D-02, 0.53679D-02, 0.52215D-02,
     & 0.97887D-02, 0.92603D-02, 0.87687D-02, 0.83116D-02, 0.78867D-02,
     & 0.74930D-02, 0.71344D-02, 0.67981D-02, 0.64826D-02, 0.61868D-02,
     & 0.59094D-02, 0.56534D-02, 0.54148D-02, 0.51892D-02, 0.49760D-02,
     & 0.47746D-02, 0.45842D-02, 0.44056D-02, 0.42398D-02, 0.40820D-02,
     & 0.39319D-02, 0.37890D-02, 0.36531D-02, 0.35238D-02, 0.34011D-02,
     & 0.32872D-02, 0.31781D-02, 0.30737D-02, 0.29738D-02, 0.28782D-02,
     & 0.61584D-03, 0.57915D-03, 0.54515D-03, 0.51366D-03, 0.48451D-03,
     & 0.45764D-03, 0.43338D-03, 0.41071D-03, 0.38952D-03, 0.36973D-03,
     & 0.35126D-03, 0.33433D-03, 0.31864D-03, 0.30387D-03, 0.28995D-03,
     & 0.27684D-03, 0.26450D-03, 0.25299D-03, 0.24238D-03, 0.23232D-03,
     & 0.22277D-03, 0.21372D-03, 0.20513D-03, 0.19699D-03, 0.18929D-03,
     & 0.18221D-03, 0.17545D-03, 0.16900D-03, 0.16284D-03, 0.15696D-03/

      data ((g_grdl(i,j),j=1,30),i=1,10)/
     & 0.66473D+00, 0.72970D+00, 0.79455D+00, 0.85925D+00, 0.92376D+00,
     & 0.98811D+00, 0.10525D+01, 0.11165D+01, 0.11800D+01, 0.12432D+01,
     & 0.13059D+01, 0.13684D+01, 0.14306D+01, 0.14921D+01, 0.15532D+01,
     & 0.16137D+01, 0.16736D+01, 0.17331D+01, 0.17924D+01, 0.18510D+01,
     & 0.19089D+01, 0.19663D+01, 0.20231D+01, 0.20792D+01, 0.21349D+01,
     & 0.21903D+01, 0.22451D+01, 0.22992D+01, 0.23527D+01, 0.24056D+01,
     & 0.66468D+00, 0.72693D+00, 0.78889D+00, 0.85055D+00, 0.91187D+00,
     & 0.97291D+00, 0.10339D+01, 0.10943D+01, 0.11542D+01, 0.12136D+01,
     & 0.12725D+01, 0.13311D+01, 0.13893D+01, 0.14469D+01, 0.15038D+01,
     & 0.15601D+01, 0.16158D+01, 0.16711D+01, 0.17260D+01, 0.17802D+01,
     & 0.18338D+01, 0.18868D+01, 0.19391D+01, 0.19908D+01, 0.20420D+01,
     & 0.20929D+01, 0.21431D+01, 0.21927D+01, 0.22417D+01, 0.22900D+01,
     & 0.66466D+00, 0.72417D+00, 0.78324D+00, 0.84187D+00, 0.90004D+00,
     & 0.95780D+00, 0.10154D+01, 0.10723D+01, 0.11287D+01, 0.11845D+01,
     & 0.12396D+01, 0.12944D+01, 0.13488D+01, 0.14024D+01, 0.14553D+01,
     & 0.15077D+01, 0.15593D+01, 0.16105D+01, 0.16613D+01, 0.17113D+01,
     & 0.17607D+01, 0.18095D+01, 0.18575D+01, 0.19050D+01, 0.19519D+01,
     & 0.19985D+01, 0.20444D+01, 0.20897D+01, 0.21343D+01, 0.21784D+01,
     & 0.66471D+00, 0.72151D+00, 0.77773D+00, 0.83337D+00, 0.88844D+00,
     & 0.94300D+00, 0.99728D+00, 0.10509D+01, 0.11037D+01, 0.11560D+01,
     & 0.12075D+01, 0.12587D+01, 0.13093D+01, 0.13591D+01, 0.14083D+01,
     & 0.14567D+01, 0.15045D+01, 0.15518D+01, 0.15986D+01, 0.16447D+01,
     & 0.16901D+01, 0.17348D+01, 0.17789D+01, 0.18223D+01, 0.18651D+01,
     & 0.19077D+01, 0.19495D+01, 0.19907D+01, 0.20313D+01, 0.20712D+01,
     & 0.66471D+00, 0.71877D+00, 0.77213D+00, 0.82481D+00, 0.87680D+00,
     & 0.92820D+00, 0.97922D+00, 0.10295D+01, 0.10789D+01, 0.11277D+01,
     & 0.11758D+01, 0.12233D+01, 0.12703D+01, 0.13165D+01, 0.13620D+01,
     & 0.14067D+01, 0.14507D+01, 0.14942D+01, 0.15372D+01, 0.15795D+01,
     & 0.16210D+01, 0.16619D+01, 0.17021D+01, 0.17417D+01, 0.17807D+01,
     & 0.18193D+01, 0.18573D+01, 0.18946D+01, 0.19314D+01, 0.19675D+01,
     & 0.66466D+00, 0.71598D+00, 0.76648D+00, 0.81619D+00, 0.86514D+00,
     & 0.91340D+00, 0.96120D+00, 0.10082D+01, 0.10543D+01, 0.10997D+01,
     & 0.11443D+01, 0.11884D+01, 0.12319D+01, 0.12745D+01, 0.13164D+01,
     & 0.13575D+01, 0.13980D+01, 0.14378D+01, 0.14771D+01, 0.15157D+01,
     & 0.15536D+01, 0.15908D+01, 0.16274D+01, 0.16633D+01, 0.16986D+01,
     & 0.17336D+01, 0.17679D+01, 0.18015D+01, 0.18346D+01, 0.18670D+01,
     & 0.66456D+00, 0.71313D+00, 0.76079D+00, 0.80757D+00, 0.85350D+00,
     & 0.89867D+00, 0.94332D+00, 0.98707D+00, 0.10300D+01, 0.10720D+01,
     & 0.11133D+01, 0.11540D+01, 0.11941D+01, 0.12333D+01, 0.12717D+01,
     & 0.13094D+01, 0.13463D+01, 0.13827D+01, 0.14185D+01, 0.14536D+01,
     & 0.14880D+01, 0.15217D+01, 0.15547D+01, 0.15872D+01, 0.16190D+01,
     & 0.16504D+01, 0.16812D+01, 0.17114D+01, 0.17410D+01, 0.17700D+01,
     & 0.66450D+00, 0.71031D+00, 0.75512D+00, 0.79898D+00, 0.84194D+00,
     & 0.88406D+00, 0.92560D+00, 0.96620D+00, 0.10059D+01, 0.10448D+01,
     & 0.10828D+01, 0.11202D+01, 0.11570D+01, 0.11929D+01, 0.12280D+01,
     & 0.12623D+01, 0.12959D+01, 0.13289D+01, 0.13614D+01, 0.13932D+01,
     & 0.14242D+01, 0.14546D+01, 0.14843D+01, 0.15134D+01, 0.15419D+01,
     & 0.15701D+01, 0.15976D+01, 0.16245D+01, 0.16508D+01, 0.16766D+01,
     & 0.66450D+00, 0.70756D+00, 0.74956D+00, 0.79055D+00, 0.83057D+00,
     & 0.86972D+00, 0.90821D+00, 0.94573D+00, 0.98235D+00, 0.10181D+01,
     & 0.10530D+01, 0.10873D+01, 0.11208D+01, 0.11535D+01, 0.11854D+01,
     & 0.12166D+01, 0.12470D+01, 0.12768D+01, 0.13061D+01, 0.13347D+01,
     & 0.13625D+01, 0.13898D+01, 0.14163D+01, 0.14423D+01, 0.14677D+01,
     & 0.14927D+01, 0.15172D+01, 0.15410D+01, 0.15643D+01, 0.15870D+01,
     & 0.66441D+00, 0.70471D+00, 0.74388D+00, 0.78200D+00, 0.81912D+00,
     & 0.85531D+00, 0.89079D+00, 0.92530D+00, 0.95887D+00, 0.99156D+00,
     & 0.10234D+01, 0.10546D+01, 0.10850D+01, 0.11146D+01, 0.11435D+01,
     & 0.11716D+01, 0.11989D+01, 0.12257D+01, 0.12519D+01, 0.12774D+01,
     & 0.13022D+01, 0.13264D+01, 0.13500D+01, 0.13730D+01, 0.13955D+01,
     & 0.14175D+01, 0.14390D+01, 0.14599D+01, 0.14804D+01, 0.15003D+01/

      data ((g_grdl(i,j),j=1,30),i=11,20)/
     & 0.66425D+00, 0.70176D+00, 0.73811D+00, 0.77337D+00, 0.80759D+00,
     & 0.84086D+00, 0.87338D+00, 0.90491D+00, 0.93551D+00, 0.96522D+00,
     & 0.99408D+00, 0.10223D+01, 0.10497D+01, 0.10763D+01, 0.11022D+01,
     & 0.11273D+01, 0.11517D+01, 0.11755D+01, 0.11988D+01, 0.12214D+01,
     & 0.12433D+01, 0.12647D+01, 0.12854D+01, 0.13056D+01, 0.13253D+01,
     & 0.13445D+01, 0.13632D+01, 0.13814D+01, 0.13991D+01, 0.14163D+01,
     & 0.66414D+00, 0.69889D+00, 0.73245D+00, 0.76488D+00, 0.79627D+00,
     & 0.82668D+00, 0.85630D+00, 0.88494D+00, 0.91265D+00, 0.93947D+00,
     & 0.96546D+00, 0.99074D+00, 0.10153D+01, 0.10391D+01, 0.10621D+01,
     & 0.10844D+01, 0.11060D+01, 0.11270D+01, 0.11475D+01, 0.11673D+01,
     & 0.11865D+01, 0.12052D+01, 0.12232D+01, 0.12408D+01, 0.12578D+01,
     & 0.12744D+01, 0.12905D+01, 0.13062D+01, 0.13213D+01, 0.13361D+01,
     & 0.66394D+00, 0.69590D+00, 0.72666D+00, 0.75628D+00, 0.78485D+00,
     & 0.81243D+00, 0.83919D+00, 0.86499D+00, 0.88986D+00, 0.91386D+00,
     & 0.93704D+00, 0.95951D+00, 0.98127D+00, 0.10023D+01, 0.10225D+01,
     & 0.10421D+01, 0.10610D+01, 0.10794D+01, 0.10972D+01, 0.11143D+01,
     & 0.11310D+01, 0.11470D+01, 0.11625D+01, 0.11776D+01, 0.11921D+01,
     & 0.12063D+01, 0.12199D+01, 0.12331D+01, 0.12459D+01, 0.12583D+01,
     & 0.66392D+00, 0.69310D+00, 0.72108D+00, 0.74793D+00, 0.77372D+00,
     & 0.79853D+00, 0.82250D+00, 0.84552D+00, 0.86764D+00, 0.88891D+00,
     & 0.90938D+00, 0.92915D+00, 0.94822D+00, 0.96655D+00, 0.98420D+00,
     & 0.10012D+01, 0.10176D+01, 0.10333D+01, 0.10486D+01, 0.10633D+01,
     & 0.10775D+01, 0.10911D+01, 0.11042D+01, 0.11169D+01, 0.11291D+01,
     & 0.11409D+01, 0.11523D+01, 0.11633D+01, 0.11739D+01, 0.11841D+01,
     & 0.66409D+00, 0.69049D+00, 0.71570D+00, 0.73980D+00, 0.76285D+00,
     & 0.78492D+00, 0.80615D+00, 0.82646D+00, 0.84590D+00, 0.86453D+00,
     & 0.88237D+00, 0.89953D+00, 0.91600D+00, 0.93178D+00, 0.94691D+00,
     & 0.96141D+00, 0.97533D+00, 0.98869D+00, 0.10016D+01, 0.10139D+01,
     & 0.10257D+01, 0.10371D+01, 0.10479D+01, 0.10584D+01, 0.10684D+01,
     & 0.10781D+01, 0.10873D+01, 0.10962D+01, 0.11047D+01, 0.11129D+01,
     & 0.66384D+00, 0.68744D+00, 0.70987D+00, 0.73121D+00, 0.75153D+00,
     & 0.77090D+00, 0.78942D+00, 0.80706D+00, 0.82387D+00, 0.83989D+00,
     & 0.85517D+00, 0.86979D+00, 0.88374D+00, 0.89705D+00, 0.90975D+00,
     & 0.92186D+00, 0.93343D+00, 0.94447D+00, 0.95503D+00, 0.96510D+00,
     & 0.97471D+00, 0.98389D+00, 0.99264D+00, 0.10010D+01, 0.10090D+01,
     & 0.10166D+01, 0.10238D+01, 0.10307D+01, 0.10373D+01, 0.10436D+01,
     & 0.66367D+00, 0.68446D+00, 0.70412D+00, 0.72273D+00, 0.74035D+00,
     & 0.75705D+00, 0.77291D+00, 0.78793D+00, 0.80217D+00, 0.81566D+00,
     & 0.82846D+00, 0.84061D+00, 0.85214D+00, 0.86307D+00, 0.87343D+00,
     & 0.88326D+00, 0.89257D+00, 0.90141D+00, 0.90978D+00, 0.91771D+00,
     & 0.92523D+00, 0.93235D+00, 0.93909D+00, 0.94548D+00, 0.95151D+00,
     & 0.95720D+00, 0.96259D+00, 0.96767D+00, 0.97247D+00, 0.97700D+00,
     & 0.66346D+00, 0.68143D+00, 0.69832D+00, 0.71420D+00, 0.72914D+00,
     & 0.74320D+00, 0.75643D+00, 0.76888D+00, 0.78060D+00, 0.79163D+00,
     & 0.80201D+00, 0.81177D+00, 0.82095D+00, 0.82958D+00, 0.83770D+00,
     & 0.84533D+00, 0.85250D+00, 0.85922D+00, 0.86551D+00, 0.87141D+00,
     & 0.87695D+00, 0.88213D+00, 0.88697D+00, 0.89150D+00, 0.89572D+00,
     & 0.89962D+00, 0.90325D+00, 0.90663D+00, 0.90976D+00, 0.91266D+00,
     & 0.66324D+00, 0.67836D+00, 0.69247D+00, 0.70563D+00, 0.71790D+00,
     & 0.72934D+00, 0.73998D+00, 0.74991D+00, 0.75916D+00, 0.76778D+00,
     & 0.77580D+00, 0.78324D+00, 0.79014D+00, 0.79656D+00, 0.80251D+00,
     & 0.80803D+00, 0.81314D+00, 0.81785D+00, 0.82216D+00, 0.82613D+00,
     & 0.82978D+00, 0.83312D+00, 0.83618D+00, 0.83896D+00, 0.84148D+00,
     & 0.84370D+00, 0.84570D+00, 0.84748D+00, 0.84906D+00, 0.85044D+00,
     & 0.66295D+00, 0.67521D+00, 0.68651D+00, 0.69694D+00, 0.70655D+00,
     & 0.71538D+00, 0.72346D+00, 0.73089D+00, 0.73771D+00, 0.74396D+00,
     & 0.74967D+00, 0.75485D+00, 0.75954D+00, 0.76381D+00, 0.76767D+00,
     & 0.77116D+00, 0.77429D+00, 0.77706D+00, 0.77947D+00, 0.78160D+00,
     & 0.78346D+00, 0.78507D+00, 0.78643D+00, 0.78757D+00, 0.78848D+00,
     & 0.78912D+00, 0.78959D+00, 0.78988D+00, 0.79002D+00, 0.79000D+00/

      data ((g_grdl(i,j),j=1,30),i=21,30)/
     & 0.66257D+00, 0.67190D+00, 0.68036D+00, 0.68803D+00, 0.69495D+00,
     & 0.70117D+00, 0.70668D+00, 0.71163D+00, 0.71603D+00, 0.71994D+00,
     & 0.72338D+00, 0.72633D+00, 0.72886D+00, 0.73103D+00, 0.73286D+00,
     & 0.73437D+00, 0.73558D+00, 0.73649D+00, 0.73707D+00, 0.73744D+00,
     & 0.73758D+00, 0.73753D+00, 0.73728D+00, 0.73685D+00, 0.73624D+00,
     & 0.73540D+00, 0.73443D+00, 0.73333D+00, 0.73211D+00, 0.73078D+00,
     & 0.66155D+00, 0.66786D+00, 0.67341D+00, 0.67825D+00, 0.68244D+00,
     & 0.68600D+00, 0.68892D+00, 0.69135D+00, 0.69334D+00, 0.69490D+00,
     & 0.69607D+00, 0.69681D+00, 0.69719D+00, 0.69728D+00, 0.69711D+00,
     & 0.69668D+00, 0.69602D+00, 0.69511D+00, 0.69393D+00, 0.69258D+00,
     & 0.69107D+00, 0.68942D+00, 0.68763D+00, 0.68571D+00, 0.68366D+00,
     & 0.68141D+00, 0.67908D+00, 0.67666D+00, 0.67417D+00, 0.67161D+00,
     & 0.66072D+00, 0.66389D+00, 0.66642D+00, 0.66836D+00, 0.66974D+00,
     & 0.67059D+00, 0.67086D+00, 0.67075D+00, 0.67029D+00, 0.66949D+00,
     & 0.66838D+00, 0.66691D+00, 0.66515D+00, 0.66319D+00, 0.66104D+00,
     & 0.65870D+00, 0.65620D+00, 0.65351D+00, 0.65060D+00, 0.64760D+00,
     & 0.64450D+00, 0.64131D+00, 0.63803D+00, 0.63468D+00, 0.63126D+00,
     & 0.62767D+00, 0.62405D+00, 0.62040D+00, 0.61672D+00, 0.61302D+00,
     & 0.65988D+00, 0.65971D+00, 0.65904D+00, 0.65790D+00, 0.65633D+00,
     & 0.65433D+00, 0.65184D+00, 0.64909D+00, 0.64608D+00, 0.64285D+00,
     & 0.63940D+00, 0.63567D+00, 0.63173D+00, 0.62768D+00, 0.62353D+00,
     & 0.61927D+00, 0.61493D+00, 0.61046D+00, 0.60584D+00, 0.60120D+00,
     & 0.59653D+00, 0.59183D+00, 0.58711D+00, 0.58238D+00, 0.57762D+00,
     & 0.57276D+00, 0.56791D+00, 0.56309D+00, 0.55829D+00, 0.55350D+00,
     & 0.65807D+00, 0.65418D+00, 0.64995D+00, 0.64541D+00, 0.64059D+00,
     & 0.63549D+00, 0.63000D+00, 0.62438D+00, 0.61864D+00, 0.61280D+00,
     & 0.60686D+00, 0.60073D+00, 0.59450D+00, 0.58827D+00, 0.58202D+00,
     & 0.57578D+00, 0.56954D+00, 0.56326D+00, 0.55691D+00, 0.55061D+00,
     & 0.54436D+00, 0.53816D+00, 0.53202D+00, 0.52593D+00, 0.51987D+00,
     & 0.51377D+00, 0.50776D+00, 0.50182D+00, 0.49595D+00, 0.49016D+00,
     & 0.65751D+00, 0.65264D+00, 0.64748D+00, 0.64206D+00, 0.63640D+00,
     & 0.63049D+00, 0.62422D+00, 0.61786D+00, 0.61142D+00, 0.60491D+00,
     & 0.59833D+00, 0.59160D+00, 0.58479D+00, 0.57800D+00, 0.57124D+00,
     & 0.56450D+00, 0.55779D+00, 0.55107D+00, 0.54429D+00, 0.53759D+00,
     & 0.53096D+00, 0.52440D+00, 0.51791D+00, 0.51149D+00, 0.50514D+00,
     & 0.49875D+00, 0.49246D+00, 0.48626D+00, 0.48015D+00, 0.47413D+00,
     & 0.65690D+00, 0.65105D+00, 0.64495D+00, 0.63864D+00, 0.63213D+00,
     & 0.62541D+00, 0.61837D+00, 0.61128D+00, 0.60414D+00, 0.59697D+00,
     & 0.58977D+00, 0.58244D+00, 0.57506D+00, 0.56774D+00, 0.56046D+00,
     & 0.55324D+00, 0.54607D+00, 0.53892D+00, 0.53173D+00, 0.52463D+00,
     & 0.51764D+00, 0.51073D+00, 0.50392D+00, 0.49719D+00, 0.49054D+00,
     & 0.48387D+00, 0.47732D+00, 0.47088D+00, 0.46454D+00, 0.45831D+00,
     & 0.65625D+00, 0.64940D+00, 0.64236D+00, 0.63516D+00, 0.62780D+00,
     & 0.62027D+00, 0.61246D+00, 0.60463D+00, 0.59680D+00, 0.58897D+00,
     & 0.58115D+00, 0.57323D+00, 0.56528D+00, 0.55743D+00, 0.54965D+00,
     & 0.54195D+00, 0.53433D+00, 0.52676D+00, 0.51916D+00, 0.51169D+00,
     & 0.50434D+00, 0.49710D+00, 0.48997D+00, 0.48294D+00, 0.47601D+00,
     & 0.46909D+00, 0.46230D+00, 0.45562D+00, 0.44907D+00, 0.44263D+00,
     & 0.65554D+00, 0.64767D+00, 0.63968D+00, 0.63157D+00, 0.62335D+00,
     & 0.61501D+00, 0.60642D+00, 0.59786D+00, 0.58934D+00, 0.58085D+00,
     & 0.57241D+00, 0.56390D+00, 0.55540D+00, 0.54702D+00, 0.53875D+00,
     & 0.53058D+00, 0.52253D+00, 0.51453D+00, 0.50655D+00, 0.49872D+00,
     & 0.49102D+00, 0.48345D+00, 0.47602D+00, 0.46871D+00, 0.46151D+00,
     & 0.45434D+00, 0.44732D+00, 0.44043D+00, 0.43368D+00, 0.42705D+00,
     & 0.65475D+00, 0.64586D+00, 0.63690D+00, 0.62787D+00, 0.61878D+00,
     & 0.60962D+00, 0.60024D+00, 0.59094D+00, 0.58172D+00, 0.57258D+00,
     & 0.56352D+00, 0.55442D+00, 0.54537D+00, 0.53646D+00, 0.52770D+00,
     & 0.51908D+00, 0.51059D+00, 0.50219D+00, 0.49383D+00, 0.48564D+00,
     & 0.47761D+00, 0.46973D+00, 0.46201D+00, 0.45442D+00, 0.44697D+00,
     & 0.43957D+00, 0.43233D+00, 0.42524D+00, 0.41830D+00, 0.41150D+00/

      data ((g_grdl(i,j),j=1,30),i=31,40)/
     & 0.65389D+00, 0.64394D+00, 0.63398D+00, 0.62401D+00, 0.61404D+00,
     & 0.60405D+00, 0.59387D+00, 0.58383D+00, 0.57391D+00, 0.56410D+00,
     & 0.55442D+00, 0.54474D+00, 0.53514D+00, 0.52572D+00, 0.51647D+00,
     & 0.50740D+00, 0.49848D+00, 0.48969D+00, 0.48096D+00, 0.47242D+00,
     & 0.46406D+00, 0.45589D+00, 0.44788D+00, 0.44004D+00, 0.43235D+00,
     & 0.42473D+00, 0.41728D+00, 0.41001D+00, 0.40289D+00, 0.39594D+00,
     & 0.65293D+00, 0.64189D+00, 0.63091D+00, 0.61998D+00, 0.60911D+00,
     & 0.59826D+00, 0.58728D+00, 0.57647D+00, 0.56584D+00, 0.55537D+00,
     & 0.54506D+00, 0.53479D+00, 0.52464D+00, 0.51471D+00, 0.50499D+00,
     & 0.49546D+00, 0.48613D+00, 0.47695D+00, 0.46786D+00, 0.45899D+00,
     & 0.45032D+00, 0.44186D+00, 0.43358D+00, 0.42549D+00, 0.41758D+00,
     & 0.40975D+00, 0.40212D+00, 0.39467D+00, 0.38740D+00, 0.38030D+00,
     & 0.65186D+00, 0.63970D+00, 0.62766D+00, 0.61574D+00, 0.60394D+00,
     & 0.59222D+00, 0.58041D+00, 0.56884D+00, 0.55748D+00, 0.54634D+00,
     & 0.53540D+00, 0.52454D+00, 0.51384D+00, 0.50340D+00, 0.49319D+00,
     & 0.48323D+00, 0.47348D+00, 0.46392D+00, 0.45448D+00, 0.44528D+00,
     & 0.43632D+00, 0.42758D+00, 0.41905D+00, 0.41073D+00, 0.40260D+00,
     & 0.39459D+00, 0.38678D+00, 0.37917D+00, 0.37176D+00, 0.36453D+00,
     & 0.65068D+00, 0.63734D+00, 0.62420D+00, 0.61125D+00, 0.59849D+00,
     & 0.58587D+00, 0.57322D+00, 0.56086D+00, 0.54877D+00, 0.53695D+00,
     & 0.52537D+00, 0.51392D+00, 0.50268D+00, 0.49172D+00, 0.48105D+00,
     & 0.47064D+00, 0.46050D+00, 0.45056D+00, 0.44078D+00, 0.43127D+00,
     & 0.42202D+00, 0.41302D+00, 0.40425D+00, 0.39571D+00, 0.38738D+00,
     & 0.37919D+00, 0.37123D+00, 0.36349D+00, 0.35595D+00, 0.34861D+00,
     & 0.64937D+00, 0.63481D+00, 0.62053D+00, 0.60651D+00, 0.59276D+00,
     & 0.57921D+00, 0.56569D+00, 0.55252D+00, 0.53968D+00, 0.52716D+00,
     & 0.51494D+00, 0.50290D+00, 0.49110D+00, 0.47963D+00, 0.46849D+00,
     & 0.45765D+00, 0.44711D+00, 0.43681D+00, 0.42671D+00, 0.41690D+00,
     & 0.40737D+00, 0.39812D+00, 0.38912D+00, 0.38038D+00, 0.37187D+00,
     & 0.36353D+00, 0.35543D+00, 0.34757D+00, 0.33992D+00, 0.33249D+00,
     & 0.64774D+00, 0.63188D+00, 0.61639D+00, 0.60125D+00, 0.58645D+00,
     & 0.57194D+00, 0.55753D+00, 0.54353D+00, 0.52992D+00, 0.51669D+00,
     & 0.50381D+00, 0.49117D+00, 0.47882D+00, 0.46685D+00, 0.45524D+00,
     & 0.44398D+00, 0.43304D+00, 0.42239D+00, 0.41198D+00, 0.40188D+00,
     & 0.39210D+00, 0.38262D+00, 0.37341D+00, 0.36448D+00, 0.35581D+00,
     & 0.34734D+00, 0.33912D+00, 0.33116D+00, 0.32343D+00, 0.31592D+00,
     & 0.64596D+00, 0.62872D+00, 0.61196D+00, 0.59565D+00, 0.57976D+00,
     & 0.56423D+00, 0.54889D+00, 0.53403D+00, 0.51964D+00, 0.50568D+00,
     & 0.49213D+00, 0.47888D+00, 0.46598D+00, 0.45351D+00, 0.44144D+00,
     & 0.42975D+00, 0.41844D+00, 0.40745D+00, 0.39674D+00, 0.38638D+00,
     & 0.37635D+00, 0.36665D+00, 0.35726D+00, 0.34817D+00, 0.33935D+00,
     & 0.33077D+00, 0.32247D+00, 0.31442D+00, 0.30663D+00, 0.29908D+00,
     & 0.64391D+00, 0.62520D+00, 0.60708D+00, 0.58952D+00, 0.57248D+00,
     & 0.55591D+00, 0.53960D+00, 0.52385D+00, 0.50864D+00, 0.49394D+00,
     & 0.47972D+00, 0.46586D+00, 0.45241D+00, 0.43944D+00, 0.42691D+00,
     & 0.41482D+00, 0.40314D+00, 0.39182D+00, 0.38084D+00, 0.37023D+00,
     & 0.35999D+00, 0.35010D+00, 0.34054D+00, 0.33130D+00, 0.32237D+00,
     & 0.31371D+00, 0.30534D+00, 0.29725D+00, 0.28942D+00, 0.28185D+00,
     & 0.64148D+00, 0.62119D+00, 0.60162D+00, 0.58273D+00, 0.56447D+00,
     & 0.54678D+00, 0.52946D+00, 0.51280D+00, 0.49675D+00, 0.48129D+00,
     & 0.46638D+00, 0.45191D+00, 0.43791D+00, 0.42444D+00, 0.41147D+00,
     & 0.39899D+00, 0.38695D+00, 0.37533D+00, 0.36409D+00, 0.35326D+00,
     & 0.34283D+00, 0.33277D+00, 0.32308D+00, 0.31373D+00, 0.30471D+00,
     & 0.29600D+00, 0.28760D+00, 0.27949D+00, 0.27166D+00, 0.26410D+00,
     & 0.63857D+00, 0.61657D+00, 0.59543D+00, 0.57511D+00, 0.55556D+00,
     & 0.53669D+00, 0.51831D+00, 0.50069D+00, 0.48377D+00, 0.46752D+00,
     & 0.45191D+00, 0.43682D+00, 0.42228D+00, 0.40833D+00, 0.39493D+00,
     & 0.38206D+00, 0.36970D+00, 0.35780D+00, 0.34634D+00, 0.33532D+00,
     & 0.32473D+00, 0.31454D+00, 0.30474D+00, 0.29531D+00, 0.28624D+00,
     & 0.27753D+00, 0.26913D+00, 0.26104D+00, 0.25325D+00, 0.24573D+00/

      data ((g_grdl(i,j),j=1,30),i=41,50)/
     & 0.63505D+00, 0.61117D+00, 0.58833D+00, 0.56646D+00, 0.54551D+00,
     & 0.52539D+00, 0.50591D+00, 0.48730D+00, 0.46949D+00, 0.45244D+00,
     & 0.43611D+00, 0.42042D+00, 0.40535D+00, 0.39094D+00, 0.37713D+00,
     & 0.36391D+00, 0.35124D+00, 0.33909D+00, 0.32745D+00, 0.31628D+00,
     & 0.30557D+00, 0.29529D+00, 0.28543D+00, 0.27597D+00, 0.26688D+00,
     & 0.25821D+00, 0.24986D+00, 0.24184D+00, 0.23412D+00, 0.22670D+00,
     & 0.63069D+00, 0.60475D+00, 0.58005D+00, 0.55651D+00, 0.53404D+00,
     & 0.51258D+00, 0.49194D+00, 0.47228D+00, 0.45354D+00, 0.43567D+00,
     & 0.41862D+00, 0.40232D+00, 0.38676D+00, 0.37190D+00, 0.35771D+00,
     & 0.34417D+00, 0.33123D+00, 0.31888D+00, 0.30711D+00, 0.29585D+00,
     & 0.28507D+00, 0.27476D+00, 0.26488D+00, 0.25544D+00, 0.24640D+00,
     & 0.23782D+00, 0.22958D+00, 0.22168D+00, 0.21410D+00, 0.20682D+00,
     & 0.62515D+00, 0.59691D+00, 0.57014D+00, 0.54475D+00, 0.52065D+00,
     & 0.49774D+00, 0.47589D+00, 0.45515D+00, 0.43547D+00, 0.41677D+00,
     & 0.39900D+00, 0.38213D+00, 0.36609D+00, 0.35083D+00, 0.33632D+00,
     & 0.32250D+00, 0.30935D+00, 0.29686D+00, 0.28503D+00, 0.27375D+00,
     & 0.26297D+00, 0.25269D+00, 0.24288D+00, 0.23352D+00, 0.22460D+00,
     & 0.21619D+00, 0.20813D+00, 0.20042D+00, 0.19304D+00, 0.18597D+00,
     & 0.61784D+00, 0.58702D+00, 0.55796D+00, 0.53053D+00, 0.50463D+00,
     & 0.48017D+00, 0.45704D+00, 0.43519D+00, 0.41453D+00, 0.39500D+00,
     & 0.37653D+00, 0.35913D+00, 0.34269D+00, 0.32711D+00, 0.31233D+00,
     & 0.29833D+00, 0.28505D+00, 0.27251D+00, 0.26073D+00, 0.24952D+00,
     & 0.23885D+00, 0.22871D+00, 0.21906D+00, 0.20988D+00, 0.20116D+00,
     & 0.19303D+00, 0.18525D+00, 0.17783D+00, 0.17074D+00, 0.16397D+00,
     & 0.60751D+00, 0.57375D+00, 0.54210D+00, 0.51241D+00, 0.48456D+00,
     & 0.45844D+00, 0.43404D+00, 0.41109D+00, 0.38950D+00, 0.36920D+00,
     & 0.35011D+00, 0.33229D+00, 0.31558D+00, 0.29981D+00, 0.28491D+00,
     & 0.27086D+00, 0.25759D+00, 0.24515D+00, 0.23357D+00, 0.22259D+00,
     & 0.21218D+00, 0.20230D+00, 0.19295D+00, 0.18409D+00, 0.17572D+00,
     & 0.16798D+00, 0.16062D+00, 0.15360D+00, 0.14692D+00, 0.14056D+00,
     & 0.59285D+00, 0.55564D+00, 0.52101D+00, 0.48878D+00, 0.45879D+00,
     & 0.43095D+00, 0.40539D+00, 0.38148D+00, 0.35911D+00, 0.33820D+00,
     & 0.31866D+00, 0.30063D+00, 0.28389D+00, 0.26814D+00, 0.25334D+00,
     & 0.23944D+00, 0.22639D+00, 0.21424D+00, 0.20306D+00, 0.19250D+00,
     & 0.18252D+00, 0.17310D+00, 0.16421D+00, 0.15583D+00, 0.14795D+00,
     & 0.14078D+00, 0.13396D+00, 0.12749D+00, 0.12136D+00, 0.11554D+00,
     & 0.57180D+00, 0.53155D+00, 0.49423D+00, 0.45965D+00, 0.42763D+00,
     & 0.39804D+00, 0.37103D+00, 0.34590D+00, 0.32256D+00, 0.30089D+00,
     & 0.28079D+00, 0.26249D+00, 0.24567D+00, 0.22997D+00, 0.21531D+00,
     & 0.20164D+00, 0.18891D+00, 0.17721D+00, 0.16665D+00, 0.15673D+00,
     & 0.14742D+00, 0.13869D+00, 0.13050D+00, 0.12284D+00, 0.11570D+00,
     & 0.10936D+00, 0.10337D+00, 0.97712D-01, 0.92370D-01, 0.87332D-01,
     & 0.55100D+00, 0.50007D+00, 0.45383D+00, 0.41194D+00, 0.37412D+00,
     & 0.34034D+00, 0.31163D+00, 0.28532D+00, 0.26126D+00, 0.23930D+00,
     & 0.21932D+00, 0.20196D+00, 0.18656D+00, 0.17231D+00, 0.15916D+00,
     & 0.14704D+00, 0.13591D+00, 0.12590D+00, 0.11725D+00, 0.10917D+00,
     & 0.10164D+00, 0.94639D-01, 0.88131D-01, 0.82096D-01, 0.76544D-01,
     & 0.71812D-01, 0.67360D-01, 0.63176D-01, 0.59249D-01, 0.55568D-01,
     & 0.38752D+00, 0.34483D+00, 0.30654D+00, 0.27232D+00, 0.24189D+00,
     & 0.21531D+00, 0.19388D+00, 0.17444D+00, 0.15685D+00, 0.14102D+00,
     & 0.12682D+00, 0.11496D+00, 0.10475D+00, 0.95393D-01, 0.86832D-01,
     & 0.79025D-01, 0.71932D-01, 0.65696D-01, 0.60523D-01, 0.55724D-01,
     & 0.51282D-01, 0.47179D-01, 0.43399D-01, 0.39927D-01, 0.36771D-01,
     & 0.34198D-01, 0.31790D-01, 0.29539D-01, 0.27438D-01, 0.25480D-01,
     & 0.24863D-01, 0.21885D-01, 0.19226D-01, 0.16865D-01, 0.14779D-01,
     & 0.12975D-01, 0.11557D-01, 0.10276D-01, 0.91253D-02, 0.80954D-02,
     & 0.71791D-02, 0.64303D-02, 0.57976D-02, 0.52202D-02, 0.46950D-02,
     & 0.42190D-02, 0.37896D-02, 0.34175D-02, 0.31174D-02, 0.28404D-02,
     & 0.25851D-02, 0.23507D-02, 0.21360D-02, 0.19401D-02, 0.17637D-02,
     & 0.16251D-02, 0.14958D-02, 0.13754D-02, 0.12637D-02, 0.11601D-02/

      data ((c_grdl(i,j),j=1,30),i=1,10)/
     & 0.14587D-02, 0.14612D-02, 0.14634D-02, 0.14653D-02, 0.14670D-02,
     & 0.14685D-02, 0.14699D-02, 0.14711D-02, 0.14721D-02, 0.14731D-02,
     & 0.14739D-02, 0.14746D-02, 0.14753D-02, 0.14759D-02, 0.14764D-02,
     & 0.14768D-02, 0.14772D-02, 0.14776D-02, 0.14779D-02, 0.14782D-02,
     & 0.14784D-02, 0.14786D-02, 0.14788D-02, 0.14790D-02, 0.14792D-02,
     & 0.14793D-02, 0.14794D-02, 0.14795D-02, 0.14796D-02, 0.14797D-02,
     & 0.14519D-02, 0.14548D-02, 0.14574D-02, 0.14597D-02, 0.14618D-02,
     & 0.14636D-02, 0.14652D-02, 0.14666D-02, 0.14678D-02, 0.14689D-02,
     & 0.14699D-02, 0.14708D-02, 0.14715D-02, 0.14722D-02, 0.14728D-02,
     & 0.14733D-02, 0.14738D-02, 0.14742D-02, 0.14746D-02, 0.14749D-02,
     & 0.14752D-02, 0.14755D-02, 0.14757D-02, 0.14759D-02, 0.14761D-02,
     & 0.14762D-02, 0.14764D-02, 0.14765D-02, 0.14766D-02, 0.14767D-02,
     & 0.14438D-02, 0.14473D-02, 0.14504D-02, 0.14531D-02, 0.14555D-02,
     & 0.14577D-02, 0.14595D-02, 0.14612D-02, 0.14627D-02, 0.14640D-02,
     & 0.14652D-02, 0.14662D-02, 0.14671D-02, 0.14679D-02, 0.14686D-02,
     & 0.14692D-02, 0.14698D-02, 0.14703D-02, 0.14707D-02, 0.14711D-02,
     & 0.14714D-02, 0.14718D-02, 0.14720D-02, 0.14723D-02, 0.14725D-02,
     & 0.14727D-02, 0.14728D-02, 0.14730D-02, 0.14731D-02, 0.14732D-02,
     & 0.14343D-02, 0.14384D-02, 0.14421D-02, 0.14453D-02, 0.14481D-02,
     & 0.14507D-02, 0.14529D-02, 0.14549D-02, 0.14566D-02, 0.14582D-02,
     & 0.14595D-02, 0.14608D-02, 0.14618D-02, 0.14628D-02, 0.14636D-02,
     & 0.14644D-02, 0.14650D-02, 0.14656D-02, 0.14661D-02, 0.14666D-02,
     & 0.14670D-02, 0.14673D-02, 0.14677D-02, 0.14679D-02, 0.14682D-02,
     & 0.14684D-02, 0.14686D-02, 0.14688D-02, 0.14689D-02, 0.14691D-02,
     & 0.14229D-02, 0.14279D-02, 0.14322D-02, 0.14360D-02, 0.14394D-02,
     & 0.14424D-02, 0.14450D-02, 0.14474D-02, 0.14495D-02, 0.14513D-02,
     & 0.14529D-02, 0.14543D-02, 0.14556D-02, 0.14567D-02, 0.14577D-02,
     & 0.14586D-02, 0.14594D-02, 0.14601D-02, 0.14607D-02, 0.14612D-02,
     & 0.14617D-02, 0.14621D-02, 0.14625D-02, 0.14628D-02, 0.14631D-02,
     & 0.14634D-02, 0.14636D-02, 0.14638D-02, 0.14640D-02, 0.14642D-02,
     & 0.14095D-02, 0.14153D-02, 0.14205D-02, 0.14250D-02, 0.14290D-02,
     & 0.14326D-02, 0.14357D-02, 0.14385D-02, 0.14410D-02, 0.14431D-02,
     & 0.14450D-02, 0.14467D-02, 0.14482D-02, 0.14496D-02, 0.14508D-02,
     & 0.14518D-02, 0.14527D-02, 0.14535D-02, 0.14543D-02, 0.14549D-02,
     & 0.14555D-02, 0.14560D-02, 0.14564D-02, 0.14568D-02, 0.14572D-02,
     & 0.14575D-02, 0.14577D-02, 0.14580D-02, 0.14582D-02, 0.14584D-02,
     & 0.16432D-02, 0.15849D-02, 0.14988D-02, 0.14120D-02, 0.14167D-02,
     & 0.14210D-02, 0.14247D-02, 0.14280D-02, 0.14309D-02, 0.14335D-02,
     & 0.14357D-02, 0.14377D-02, 0.14395D-02, 0.14411D-02, 0.14425D-02,
     & 0.14437D-02, 0.14448D-02, 0.14458D-02, 0.14467D-02, 0.14474D-02,
     & 0.14481D-02, 0.14487D-02, 0.14492D-02, 0.14497D-02, 0.14501D-02,
     & 0.14505D-02, 0.14508D-02, 0.14511D-02, 0.14513D-02, 0.14515D-02,
     & 0.17441D-02, 0.17067D-02, 0.16662D-02, 0.16209D-02, 0.15666D-02,
     & 0.14853D-02, 0.14116D-02, 0.14155D-02, 0.14189D-02, 0.14220D-02,
     & 0.14247D-02, 0.14271D-02, 0.14292D-02, 0.14311D-02, 0.14327D-02,
     & 0.14342D-02, 0.14355D-02, 0.14366D-02, 0.14376D-02, 0.14385D-02,
     & 0.14393D-02, 0.14400D-02, 0.14407D-02, 0.14412D-02, 0.14417D-02,
     & 0.14421D-02, 0.14425D-02, 0.14429D-02, 0.14432D-02, 0.14434D-02,
     & 0.18192D-02, 0.17904D-02, 0.17604D-02, 0.17291D-02, 0.16965D-02,
     & 0.16620D-02, 0.16248D-02, 0.15832D-02, 0.15322D-02, 0.14396D-02,
     & 0.14116D-02, 0.14144D-02, 0.14169D-02, 0.14191D-02, 0.14211D-02,
     & 0.14228D-02, 0.14244D-02, 0.14257D-02, 0.14269D-02, 0.14280D-02,
     & 0.14290D-02, 0.14298D-02, 0.14305D-02, 0.14312D-02, 0.14318D-02,
     & 0.14323D-02, 0.14327D-02, 0.14331D-02, 0.14335D-02, 0.14338D-02,
     & 0.18786D-02, 0.18558D-02, 0.18321D-02, 0.18076D-02, 0.17826D-02,
     & 0.17573D-02, 0.17317D-02, 0.17057D-02, 0.16794D-02, 0.16525D-02,
     & 0.16248D-02, 0.15957D-02, 0.15643D-02, 0.15284D-02, 0.14809D-02,
     & 0.14094D-02, 0.14112D-02, 0.14128D-02, 0.14142D-02, 0.14155D-02,
     & 0.14166D-02, 0.14176D-02, 0.14185D-02, 0.14193D-02, 0.14200D-02,
     & 0.14206D-02, 0.14211D-02, 0.14216D-02, 0.14220D-02, 0.14224D-02/

      data ((c_grdl(i,j),j=1,30),i=11,20)/
     & 0.19244D-02, 0.19071D-02, 0.18887D-02, 0.18694D-02, 0.18497D-02,
     & 0.18296D-02, 0.18096D-02, 0.17896D-02, 0.17699D-02, 0.17506D-02,
     & 0.17317D-02, 0.17132D-02, 0.16952D-02, 0.16777D-02, 0.16607D-02,
     & 0.16442D-02, 0.16282D-02, 0.16126D-02, 0.15974D-02, 0.15826D-02,
     & 0.15681D-02, 0.15537D-02, 0.15395D-02, 0.15253D-02, 0.15108D-02,
     & 0.14958D-02, 0.14796D-02, 0.14610D-02, 0.14345D-02, 0.14089D-02,
     & 0.19555D-02, 0.19446D-02, 0.19317D-02, 0.19175D-02, 0.19024D-02,
     & 0.18868D-02, 0.18710D-02, 0.18552D-02, 0.18396D-02, 0.18244D-02,
     & 0.18096D-02, 0.17953D-02, 0.17817D-02, 0.17687D-02, 0.17564D-02,
     & 0.17448D-02, 0.17339D-02, 0.17237D-02, 0.17142D-02, 0.17054D-02,
     & 0.16972D-02, 0.16897D-02, 0.16827D-02, 0.16764D-02, 0.16705D-02,
     & 0.16652D-02, 0.16604D-02, 0.16560D-02, 0.16520D-02, 0.16483D-02,
     & 0.19692D-02, 0.19659D-02, 0.19597D-02, 0.19513D-02, 0.19414D-02,
     & 0.19304D-02, 0.19187D-02, 0.19067D-02, 0.18946D-02, 0.18827D-02,
     & 0.18710D-02, 0.18597D-02, 0.18489D-02, 0.18386D-02, 0.18289D-02,
     & 0.18198D-02, 0.18113D-02, 0.18034D-02, 0.17961D-02, 0.17894D-02,
     & 0.17832D-02, 0.17776D-02, 0.17724D-02, 0.17677D-02, 0.17635D-02,
     & 0.17596D-02, 0.17561D-02, 0.17530D-02, 0.17502D-02, 0.17477D-02,
     & 0.19614D-02, 0.19675D-02, 0.19695D-02, 0.19682D-02, 0.19645D-02,
     & 0.19589D-02, 0.19520D-02, 0.19443D-02, 0.19360D-02, 0.19274D-02,
     & 0.19187D-02, 0.19101D-02, 0.19018D-02, 0.18938D-02, 0.18862D-02,
     & 0.18791D-02, 0.18724D-02, 0.18661D-02, 0.18604D-02, 0.18550D-02,
     & 0.18501D-02, 0.18457D-02, 0.18416D-02, 0.18379D-02, 0.18345D-02,
     & 0.18315D-02, 0.18287D-02, 0.18263D-02, 0.18241D-02, 0.18221D-02,
     & 0.19273D-02, 0.19449D-02, 0.19569D-02, 0.19644D-02, 0.19684D-02,
     & 0.19695D-02, 0.19684D-02, 0.19657D-02, 0.19619D-02, 0.19572D-02,
     & 0.19520D-02, 0.19466D-02, 0.19410D-02, 0.19354D-02, 0.19300D-02,
     & 0.19247D-02, 0.19197D-02, 0.19150D-02, 0.19106D-02, 0.19065D-02,
     & 0.19027D-02, 0.18993D-02, 0.18961D-02, 0.18932D-02, 0.18906D-02,
     & 0.18882D-02, 0.18861D-02, 0.18841D-02, 0.18824D-02, 0.18809D-02,
     & 0.18615D-02, 0.18929D-02, 0.19171D-02, 0.19352D-02, 0.19485D-02,
     & 0.19579D-02, 0.19640D-02, 0.19676D-02, 0.19692D-02, 0.19694D-02,
     & 0.19684D-02, 0.19666D-02, 0.19643D-02, 0.19616D-02, 0.19587D-02,
     & 0.19557D-02, 0.19527D-02, 0.19497D-02, 0.19469D-02, 0.19442D-02,
     & 0.19416D-02, 0.19392D-02, 0.19370D-02, 0.19350D-02, 0.19331D-02,
     & 0.19314D-02, 0.19299D-02, 0.19284D-02, 0.19272D-02, 0.19260D-02,
     & 0.17578D-02, 0.18055D-02, 0.18443D-02, 0.18753D-02, 0.18999D-02,
     & 0.19191D-02, 0.19340D-02, 0.19453D-02, 0.19537D-02, 0.19597D-02,
     & 0.19640D-02, 0.19668D-02, 0.19684D-02, 0.19693D-02, 0.19695D-02,
     & 0.19692D-02, 0.19686D-02, 0.19677D-02, 0.19668D-02, 0.19657D-02,
     & 0.19646D-02, 0.19635D-02, 0.19624D-02, 0.19614D-02, 0.19604D-02,
     & 0.19595D-02, 0.19586D-02, 0.19578D-02, 0.19571D-02, 0.19565D-02,
     & 0.16134D-02, 0.16784D-02, 0.17324D-02, 0.17785D-02, 0.18165D-02,
     & 0.18477D-02, 0.18731D-02, 0.18936D-02, 0.19102D-02, 0.19234D-02,
     & 0.19340D-02, 0.19424D-02, 0.19490D-02, 0.19541D-02, 0.19581D-02,
     & 0.19612D-02, 0.19636D-02, 0.19653D-02, 0.19666D-02, 0.19676D-02,
     & 0.19683D-02, 0.19688D-02, 0.19691D-02, 0.19693D-02, 0.19694D-02,
     & 0.19695D-02, 0.19695D-02, 0.19694D-02, 0.19694D-02, 0.19693D-02,
     & 0.14198D-02, 0.15062D-02, 0.15795D-02, 0.16415D-02, 0.16936D-02,
     & 0.17374D-02, 0.17751D-02, 0.18067D-02, 0.18330D-02, 0.18549D-02,
     & 0.18731D-02, 0.18882D-02, 0.19007D-02, 0.19111D-02, 0.19197D-02,
     & 0.19269D-02, 0.19328D-02, 0.19378D-02, 0.19419D-02, 0.19454D-02,
     & 0.19483D-02, 0.19507D-02, 0.19528D-02, 0.19545D-02, 0.19559D-02,
     & 0.19572D-02, 0.19582D-02, 0.19591D-02, 0.19599D-02, 0.19605D-02,
     & 0.18585D-02, 0.17843D-02, 0.13754D-02, 0.14568D-02, 0.15266D-02,
     & 0.15861D-02, 0.16369D-02, 0.16800D-02, 0.17164D-02, 0.17480D-02,
     & 0.17751D-02, 0.17982D-02, 0.18178D-02, 0.18345D-02, 0.18487D-02,
     & 0.18608D-02, 0.18711D-02, 0.18798D-02, 0.18874D-02, 0.18938D-02,
     & 0.18994D-02, 0.19041D-02, 0.19083D-02, 0.19118D-02, 0.19149D-02,
     & 0.19176D-02, 0.19199D-02, 0.19219D-02, 0.19237D-02, 0.19252D-02/

      data ((c_grdl(i,j),j=1,30),i=21,30)/
     & 0.16429D-02, 0.17809D-02, 0.18512D-02, 0.18450D-02, 0.17352D-02,
     & 0.13841D-02, 0.14507D-02, 0.15082D-02, 0.15577D-02, 0.16003D-02,
     & 0.16369D-02, 0.16684D-02, 0.16954D-02, 0.17185D-02, 0.17389D-02,
     & 0.17567D-02, 0.17721D-02, 0.17854D-02, 0.17970D-02, 0.18070D-02,
     & 0.18157D-02, 0.18233D-02, 0.18299D-02, 0.18357D-02, 0.18407D-02,
     & 0.18451D-02, 0.18490D-02, 0.18523D-02, 0.18553D-02, 0.18579D-02,
     & 0.17196D-02, 0.17399D-02, 0.17187D-02, 0.17073D-02, 0.18060D-02,
     & 0.18543D-02, 0.18488D-02, 0.17802D-02, 0.15970D-02, 0.14025D-02,
     & 0.14508D-02, 0.14926D-02, 0.15290D-02, 0.15606D-02, 0.15881D-02,
     & 0.16119D-02, 0.16328D-02, 0.16509D-02, 0.16667D-02, 0.16805D-02,
     & 0.16925D-02, 0.17030D-02, 0.17121D-02, 0.17202D-02, 0.17272D-02,
     & 0.17336D-02, 0.17393D-02, 0.17442D-02, 0.17486D-02, 0.17524D-02,
     & 0.96152D-03, 0.14072D-02, 0.16959D-02, 0.17218D-02, 0.17124D-02,
     & 0.16994D-02, 0.16972D-02, 0.17835D-02, 0.18366D-02, 0.18583D-02,
     & 0.18488D-02, 0.18075D-02, 0.17279D-02, 0.15752D-02, 0.13866D-02,
     & 0.14179D-02, 0.14453D-02, 0.14693D-02, 0.14904D-02, 0.15089D-02,
     & 0.15251D-02, 0.15393D-02, 0.15518D-02, 0.15628D-02, 0.15725D-02,
     & 0.15811D-02, 0.15886D-02, 0.15952D-02, 0.16011D-02, 0.16062D-02,
     & 0.60430D-05, 0.30458D-03, 0.73593D-03, 0.11557D-02, 0.15033D-02,
     & 0.17103D-02, 0.17344D-02, 0.17399D-02, 0.17368D-02, 0.16109D-02,
     & 0.16972D-02, 0.17624D-02, 0.18087D-02, 0.18390D-02, 0.18550D-02,
     & 0.18587D-02, 0.18516D-02, 0.18352D-02, 0.18108D-02, 0.17789D-02,
     & 0.17395D-02, 0.16920D-02, 0.16336D-02, 0.15558D-02, 0.13664D-02,
     & 0.13775D-02, 0.13873D-02, 0.13960D-02, 0.14036D-02, 0.14104D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.89809D-04, 0.41383D-03,
     & 0.77930D-03, 0.11237D-02, 0.14172D-02, 0.16301D-02, 0.17241D-02,
     & 0.17344D-02, 0.17321D-02, 0.17156D-02, 0.17368D-02, 0.16911D-02,
     & 0.16394D-02, 0.16880D-02, 0.17274D-02, 0.17592D-02, 0.17844D-02,
     & 0.18042D-02, 0.18197D-02, 0.18317D-02, 0.18407D-02, 0.18473D-02,
     & 0.18520D-02, 0.18552D-02, 0.18573D-02, 0.18584D-02, 0.18588D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.17446D-03,
     & 0.50406D-03, 0.84938D-03, 0.11678D-02, 0.14352D-02, 0.16295D-02,
     & 0.17240D-02, 0.17387D-02, 0.17184D-02, 0.17362D-02, 0.17312D-02,
     & 0.17323D-02, 0.16635D-02, 0.16392D-02, 0.16791D-02, 0.17122D-02,
     & 0.17395D-02, 0.17619D-02, 0.17803D-02, 0.17952D-02, 0.18074D-02,
     & 0.18173D-02, 0.18253D-02, 0.18319D-02, 0.18372D-02, 0.18415D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.19558D-04,
     & 0.26078D-03, 0.58306D-03, 0.90494D-03, 0.11986D-02, 0.14428D-02,
     & 0.16221D-02, 0.17194D-02, 0.17343D-02, 0.16972D-02, 0.17376D-02,
     & 0.17128D-02, 0.17349D-02, 0.17309D-02, 0.16821D-02, 0.16243D-02,
     & 0.16578D-02, 0.16860D-02, 0.17099D-02, 0.17299D-02, 0.17468D-02,
     & 0.17610D-02, 0.17729D-02, 0.17830D-02, 0.17915D-02, 0.17987D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.72152D-04, 0.34013D-03, 0.64884D-03, 0.94721D-03, 0.12166D-02,
     & 0.14403D-02, 0.16078D-02, 0.17081D-02, 0.17207D-02, 0.17299D-02,
     & 0.17203D-02, 0.17400D-02, 0.17170D-02, 0.17344D-02, 0.17348D-02,
     & 0.17142D-02, 0.16375D-02, 0.16249D-02, 0.16492D-02, 0.16700D-02,
     & 0.16879D-02, 0.17032D-02, 0.17164D-02, 0.17277D-02, 0.17374D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.13645D-03, 0.40871D-03, 0.69999D-03, 0.97530D-03,
     & 0.12221D-02, 0.14280D-02, 0.15858D-02, 0.16892D-02, 0.17193D-02,
     & 0.17374D-02, 0.16894D-02, 0.17268D-02, 0.17399D-02, 0.17120D-02,
     & 0.17293D-02, 0.17366D-02, 0.17337D-02, 0.17198D-02, 0.16894D-02,
     & 0.16021D-02, 0.16202D-02, 0.16359D-02, 0.16496D-02, 0.16614D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.12406D-04, 0.19957D-03, 0.46451D-03, 0.73653D-03,
     & 0.98963D-03, 0.12159D-02, 0.14059D-02, 0.15555D-02, 0.16610D-02,
     & 0.17193D-02, 0.17192D-02, 0.17385D-02, 0.16929D-02, 0.17236D-02,
     & 0.17387D-02, 0.17342D-02, 0.17162D-02, 0.17283D-02, 0.17350D-02,
     & 0.17368D-02, 0.17342D-02, 0.17275D-02, 0.17166D-02, 0.17008D-02/

      data ((c_grdl(i,j),j=1,30),i=31,40)/
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.46643D-04, 0.25515D-03, 0.50665D-03,
     & 0.75878D-03, 0.99081D-03, 0.11982D-02, 0.13741D-02, 0.15161D-02,
     & 0.16227D-02, 0.16934D-02, 0.17245D-02, 0.17240D-02, 0.17387D-02,
     & 0.16960D-02, 0.17107D-02, 0.17292D-02, 0.17387D-02, 0.17385D-02,
     & 0.17156D-02, 0.17169D-02, 0.17249D-02, 0.17306D-02, 0.17343D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.87516D-04, 0.29970D-03,
     & 0.53516D-03, 0.76732D-03, 0.97947D-03, 0.11696D-02, 0.13324D-02,
     & 0.14672D-02, 0.15733D-02, 0.16512D-02, 0.17024D-02, 0.17245D-02,
     & 0.17180D-02, 0.17361D-02, 0.17358D-02, 0.16852D-02, 0.17058D-02,
     & 0.17209D-02, 0.17312D-02, 0.17374D-02, 0.17399D-02, 0.17387D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.23997D-05, 0.12587D-03,
     & 0.33198D-03, 0.55026D-03, 0.76286D-03, 0.95625D-03, 0.11304D-02,
     & 0.12813D-02, 0.14084D-02, 0.15124D-02, 0.15941D-02, 0.16551D-02,
     & 0.16971D-02, 0.17211D-02, 0.17149D-02, 0.17220D-02, 0.17349D-02,
     & 0.17386D-02, 0.17318D-02, 0.16956D-02, 0.16962D-02, 0.17072D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.16239D-04,
     & 0.15681D-03, 0.35174D-03, 0.55226D-03, 0.74613D-03, 0.92186D-03,
     & 0.10812D-02, 0.12206D-02, 0.13398D-02, 0.14402D-02, 0.15227D-02,
     & 0.15886D-02, 0.16397D-02, 0.16779D-02, 0.17044D-02, 0.17205D-02,
     & 0.17237D-02, 0.17084D-02, 0.17218D-02, 0.17309D-02, 0.17363D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.33867D-04, 0.17807D-03, 0.35912D-03, 0.54182D-03, 0.71792D-03,
     & 0.87772D-03, 0.10225D-02, 0.11506D-02, 0.12620D-02, 0.13574D-02,
     & 0.14382D-02, 0.15055D-02, 0.15609D-02, 0.16056D-02, 0.16412D-02,
     & 0.16692D-02, 0.16905D-02, 0.17061D-02, 0.17169D-02, 0.17231D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.49163D-04, 0.18890D-03, 0.35475D-03, 0.52020D-03,
     & 0.67913D-03, 0.82425D-03, 0.95484D-03, 0.10722D-02, 0.11754D-02,
     & 0.12650D-02, 0.13422D-02, 0.14084D-02, 0.14646D-02, 0.15120D-02,
     & 0.15517D-02, 0.15848D-02, 0.16122D-02, 0.16348D-02, 0.16534D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.58969D-04, 0.18940D-03, 0.33947D-03,
     & 0.48836D-03, 0.63069D-03, 0.76208D-03, 0.87974D-03, 0.98610D-03,
     & 0.10807D-02, 0.11640D-02, 0.12368D-02, 0.12998D-02, 0.13545D-02,
     & 0.14018D-02, 0.14425D-02, 0.14774D-02, 0.15073D-02, 0.15329D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.51448D-06, 0.62042D-04, 0.18023D-03,
     & 0.31444D-03, 0.44740D-03, 0.57372D-03, 0.69182D-03, 0.79842D-03,
     & 0.89339D-03, 0.97938D-03, 0.10558D-02, 0.11230D-02, 0.11824D-02,
     & 0.12343D-02, 0.12796D-02, 0.13190D-02, 0.13536D-02, 0.13837D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.12994D-05, 0.58413D-04,
     & 0.16252D-03, 0.28085D-03, 0.39849D-03, 0.51006D-03, 0.61477D-03,
     & 0.71060D-03, 0.79660D-03, 0.87312D-03, 0.94180D-03, 0.10035D-02,
     & 0.10580D-02, 0.11060D-02, 0.11485D-02, 0.11860D-02, 0.12189D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.11086D-05,
     & 0.49043D-04, 0.13779D-03, 0.24024D-03, 0.34323D-03, 0.44140D-03,
     & 0.53262D-03, 0.61758D-03, 0.69466D-03, 0.76379D-03, 0.82523D-03,
     & 0.87993D-03, 0.92886D-03, 0.97286D-03, 0.10118D-02, 0.10463D-02/

      data ((c_grdl(i,j),j=1,30),i=41,50)/
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.24245D-06, 0.35669D-04, 0.10799D-03, 0.19443D-03, 0.28316D-03,
     & 0.36843D-03, 0.44818D-03, 0.52153D-03, 0.58924D-03, 0.65080D-03,
     & 0.70600D-03, 0.75531D-03, 0.79913D-03, 0.83803D-03, 0.87259D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.20775D-04, 0.75736D-04, 0.14594D-03,
     & 0.22025D-03, 0.29310D-03, 0.36181D-03, 0.42546D-03, 0.48364D-03,
     & 0.53651D-03, 0.58502D-03, 0.62873D-03, 0.66787D-03, 0.70277D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.76270D-05, 0.44377D-04,
     & 0.97662D-04, 0.15730D-03, 0.21757D-03, 0.27556D-03, 0.32970D-03,
     & 0.37958D-03, 0.42522D-03, 0.46649D-03, 0.50368D-03, 0.53727D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.33875D-06,
     & 0.18141D-04, 0.53747D-04, 0.98013D-04, 0.14523D-03, 0.19203D-03,
     & 0.23683D-03, 0.27863D-03, 0.31706D-03, 0.35210D-03, 0.38378D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.22090D-05, 0.19486D-04, 0.47452D-04, 0.80689D-04,
     & 0.11575D-03, 0.15050D-03, 0.18374D-03, 0.21492D-03, 0.24375D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.12586D-05, 0.12229D-04,
     & 0.30525D-04, 0.52708D-04, 0.76520D-04, 0.10051D-03, 0.12378D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.27972D-05, 0.11260D-04, 0.23120D-04, 0.36780D-04,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.20540D-06,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00/

      DO I=1,50
        DO J=1,30
          UDS_GRD(I,J) = UDS_GRDL(I,J)
          G_GRD(I,J)   = G_GRDL(I,J)
          C_GRD(I,J)   = C_GRDL(I,J)
        ENDDO
      ENDDO

      RETURN
      END
*CMZ :  2.06/29 23/06/99  12.57.26  by  Hannes Jung
*CMZ :  2.06/17 11/08/97  140.2 71/6
*-- Author :
      SUBROUTINE I_NLO_Q3G3
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NQ2MAX=30,NZMAX=50)
      DIMENSION UDS_GRD(NZMAX,NQ2MAX),C_GRD(NZMAX,NQ2MAX),
     &          G_GRD(NZMAX,NQ2MAX)
      DIMENSION UDS_GRDL(NZMAX,NQ2MAX),C_GRDL(NZMAX,NQ2MAX),
     &          G_GRDL(NZMAX,NQ2MAX)
      COMMON /CPARAM/ UDS_GRD,C_GRD,G_GRD
      data ((uds_grdl(i,j),j=1,30),i=1,10)/
     & 0.94426D-03, 0.30654D-02, 0.52006D-02, 0.73473D-02, 0.95031D-02,
     & 0.11665D-01, 0.13829D-01, 0.15999D-01, 0.18173D-01, 0.20350D-01,
     & 0.22529D-01, 0.24707D-01, 0.26884D-01, 0.29061D-01, 0.31237D-01,
     & 0.33411D-01, 0.35582D-01, 0.37751D-01, 0.39914D-01, 0.42074D-01,
     & 0.44229D-01, 0.46380D-01, 0.48526D-01, 0.50666D-01, 0.52800D-01,
     & 0.54928D-01, 0.57050D-01, 0.59165D-01, 0.61273D-01, 0.63373D-01,
     & 0.97765D-03, 0.30258D-02, 0.50834D-02, 0.71481D-02, 0.92181D-02,
     & 0.11291D-01, 0.13363D-01, 0.15438D-01, 0.17514D-01, 0.19590D-01,
     & 0.21665D-01, 0.23737D-01, 0.25806D-01, 0.27872D-01, 0.29935D-01,
     & 0.31994D-01, 0.34048D-01, 0.36098D-01, 0.38141D-01, 0.40179D-01,
     & 0.42211D-01, 0.44236D-01, 0.46255D-01, 0.48266D-01, 0.50270D-01,
     & 0.52269D-01, 0.54259D-01, 0.56241D-01, 0.58214D-01, 0.60180D-01,
     & 0.10176D-02, 0.29924D-02, 0.49722D-02, 0.69554D-02, 0.89404D-02,
     & 0.10925D-01, 0.12908D-01, 0.14889D-01, 0.16869D-01, 0.18846D-01,
     & 0.20820D-01, 0.22789D-01, 0.24753D-01, 0.26712D-01, 0.28665D-01,
     & 0.30613D-01, 0.32554D-01, 0.34489D-01, 0.36416D-01, 0.38337D-01,
     & 0.40250D-01, 0.42154D-01, 0.44051D-01, 0.45939D-01, 0.47819D-01,
     & 0.49693D-01, 0.51557D-01, 0.53412D-01, 0.55257D-01, 0.57094D-01,
     & 0.10656D-02, 0.29676D-02, 0.48707D-02, 0.67736D-02, 0.86750D-02,
     & 0.10574D-01, 0.12468D-01, 0.14358D-01, 0.16244D-01, 0.18125D-01,
     & 0.20000D-01, 0.21869D-01, 0.23731D-01, 0.25586D-01, 0.27434D-01,
     & 0.29274D-01, 0.31106D-01, 0.32931D-01, 0.34748D-01, 0.36555D-01,
     & 0.38354D-01, 0.40143D-01, 0.41924D-01, 0.43694D-01, 0.45456D-01,
     & 0.47210D-01, 0.48955D-01, 0.50689D-01, 0.52412D-01, 0.54126D-01,
     & 0.11233D-02, 0.29519D-02, 0.47783D-02, 0.66011D-02, 0.84196D-02,
     & 0.10233D-01, 0.12040D-01, 0.13840D-01, 0.15634D-01, 0.17421D-01,
     & 0.19200D-01, 0.20971D-01, 0.22734D-01, 0.24488D-01, 0.26234D-01,
     & 0.27969D-01, 0.29696D-01, 0.31414D-01, 0.33123D-01, 0.34822D-01,
     & 0.36511D-01, 0.38189D-01, 0.39858D-01, 0.41515D-01, 0.43163D-01,
     & 0.44804D-01, 0.46433D-01, 0.48051D-01, 0.49659D-01, 0.51255D-01,
     & 0.11927D-02, 0.29477D-02, 0.46973D-02, 0.64405D-02, 0.81768D-02,
     & 0.99055D-02, 0.11626D-01, 0.13339D-01, 0.15042D-01, 0.16736D-01,
     & 0.18421D-01, 0.20097D-01, 0.21764D-01, 0.23420D-01, 0.25066D-01,
     & 0.26701D-01, 0.28325D-01, 0.29940D-01, 0.31545D-01, 0.33140D-01,
     & 0.34723D-01, 0.36294D-01, 0.37855D-01, 0.39404D-01, 0.40943D-01,
     & 0.42474D-01, 0.43994D-01, 0.45502D-01, 0.46998D-01, 0.48483D-01,
     & 0.12765D-02, 0.29581D-02, 0.46314D-02, 0.62957D-02, 0.79507D-02,
     & 0.95962D-02, 0.11232D-01, 0.12858D-01, 0.14473D-01, 0.16077D-01,
     & 0.17670D-01, 0.19253D-01, 0.20826D-01, 0.22387D-01, 0.23936D-01,
     & 0.25474D-01, 0.26999D-01, 0.28515D-01, 0.30020D-01, 0.31514D-01,
     & 0.32995D-01, 0.34465D-01, 0.35922D-01, 0.37368D-01, 0.38803D-01,
     & 0.40229D-01, 0.41644D-01, 0.43046D-01, 0.44437D-01, 0.45816D-01,
     & 0.13782D-02, 0.29864D-02, 0.45839D-02, 0.61702D-02, 0.77453D-02,
     & 0.93091D-02, 0.10863D-01, 0.12404D-01, 0.13932D-01, 0.15449D-01,
     & 0.16953D-01, 0.18447D-01, 0.19929D-01, 0.21398D-01, 0.22855D-01,
     & 0.24298D-01, 0.25730D-01, 0.27150D-01, 0.28560D-01, 0.29957D-01,
     & 0.31341D-01, 0.32713D-01, 0.34072D-01, 0.35420D-01, 0.36755D-01,
     & 0.38083D-01, 0.39398D-01, 0.40701D-01, 0.41991D-01, 0.43269D-01,
     & 0.15020D-02, 0.30380D-02, 0.45610D-02, 0.60711D-02, 0.75681D-02,
     & 0.90524D-02, 0.10525D-01, 0.11984D-01, 0.13430D-01, 0.14862D-01,
     & 0.16281D-01, 0.17688D-01, 0.19083D-01, 0.20464D-01, 0.21832D-01,
     & 0.23186D-01, 0.24527D-01, 0.25856D-01, 0.27175D-01, 0.28481D-01,
     & 0.29773D-01, 0.31052D-01, 0.32318D-01, 0.33572D-01, 0.34815D-01,
     & 0.36048D-01, 0.37269D-01, 0.38478D-01, 0.39674D-01, 0.40858D-01,
     & 0.16530D-02, 0.31172D-02, 0.45667D-02, 0.60015D-02, 0.74218D-02,
     & 0.88281D-02, 0.10222D-01, 0.11601D-01, 0.12966D-01, 0.14316D-01,
     & 0.15651D-01, 0.16975D-01, 0.18286D-01, 0.19582D-01, 0.20864D-01,
     & 0.22132D-01, 0.23387D-01, 0.24629D-01, 0.25861D-01, 0.27079D-01,
     & 0.28283D-01, 0.29474D-01, 0.30652D-01, 0.31817D-01, 0.32970D-01,
     & 0.34115D-01, 0.35247D-01, 0.36366D-01, 0.37472D-01, 0.38567D-01/

      data ((uds_grdl(i,j),j=1,30),i=11,20)/
     & 0.18379D-02, 0.32311D-02, 0.46081D-02, 0.59692D-02, 0.73146D-02,
     & 0.86450D-02, 0.99625D-02, 0.11264D-01, 0.12550D-01, 0.13821D-01,
     & 0.15077D-01, 0.16321D-01, 0.17551D-01, 0.18766D-01, 0.19966D-01,
     & 0.21152D-01, 0.22324D-01, 0.23483D-01, 0.24632D-01, 0.25766D-01,
     & 0.26887D-01, 0.27994D-01, 0.29088D-01, 0.30169D-01, 0.31238D-01,
     & 0.32298D-01, 0.33346D-01, 0.34380D-01, 0.35403D-01, 0.36413D-01,
     & 0.20652D-02, 0.33897D-02, 0.46967D-02, 0.59867D-02, 0.72601D-02,
     & 0.85177D-02, 0.97619D-02, 0.10989D-01, 0.12201D-01, 0.13396D-01,
     & 0.14576D-01, 0.15744D-01, 0.16897D-01, 0.18035D-01, 0.19158D-01,
     & 0.20266D-01, 0.21360D-01, 0.22442D-01, 0.23512D-01, 0.24568D-01,
     & 0.25610D-01, 0.26639D-01, 0.27654D-01, 0.28656D-01, 0.29647D-01,
     & 0.30629D-01, 0.31597D-01, 0.32553D-01, 0.33497D-01, 0.34429D-01,
     & 0.23450D-02, 0.36026D-02, 0.48416D-02, 0.60628D-02, 0.72666D-02,
     & 0.84541D-02, 0.96277D-02, 0.10784D-01, 0.11924D-01, 0.13047D-01,
     & 0.14154D-01, 0.15249D-01, 0.16330D-01, 0.17394D-01, 0.18444D-01,
     & 0.19478D-01, 0.20498D-01, 0.21506D-01, 0.22502D-01, 0.23484D-01,
     & 0.24452D-01, 0.25406D-01, 0.26347D-01, 0.27275D-01, 0.28192D-01,
     & 0.29099D-01, 0.29994D-01, 0.30876D-01, 0.31746D-01, 0.32605D-01,
     & 0.26907D-02, 0.38843D-02, 0.50585D-02, 0.62143D-02, 0.73521D-02,
     & 0.84732D-02, 0.95802D-02, 0.10669D-01, 0.11742D-01, 0.12797D-01,
     & 0.13837D-01, 0.14863D-01, 0.15875D-01, 0.16871D-01, 0.17852D-01,
     & 0.18818D-01, 0.19769D-01, 0.20708D-01, 0.21635D-01, 0.22548D-01,
     & 0.23447D-01, 0.24332D-01, 0.25205D-01, 0.26064D-01, 0.26912D-01,
     & 0.27751D-01, 0.28577D-01, 0.29391D-01, 0.30193D-01, 0.30983D-01,
     & 0.31180D-02, 0.42514D-02, 0.53650D-02, 0.64595D-02, 0.75357D-02,
     & 0.85947D-02, 0.96396D-02, 0.10666D-01, 0.11676D-01, 0.12668D-01,
     & 0.13644D-01, 0.14607D-01, 0.15556D-01, 0.16489D-01, 0.17405D-01,
     & 0.18307D-01, 0.19195D-01, 0.20069D-01, 0.20933D-01, 0.21782D-01,
     & 0.22617D-01, 0.23438D-01, 0.24247D-01, 0.25043D-01, 0.25827D-01,
     & 0.26602D-01, 0.27365D-01, 0.28116D-01, 0.28855D-01, 0.29582D-01,
     & 0.36461D-02, 0.47226D-02, 0.57787D-02, 0.68153D-02, 0.78332D-02,
     & 0.88336D-02, 0.98198D-02, 0.10788D-01, 0.11738D-01, 0.12671D-01,
     & 0.13587D-01, 0.14490D-01, 0.15379D-01, 0.16252D-01, 0.17109D-01,
     & 0.17951D-01, 0.18778D-01, 0.19592D-01, 0.20396D-01, 0.21185D-01,
     & 0.21960D-01, 0.22722D-01, 0.23470D-01, 0.24207D-01, 0.24931D-01,
     & 0.25647D-01, 0.26351D-01, 0.27042D-01, 0.27722D-01, 0.28390D-01,
     & 0.42979D-02, 0.53226D-02, 0.63264D-02, 0.73101D-02, 0.82747D-02,
     & 0.92215D-02, 0.10154D-01, 0.11068D-01, 0.11963D-01, 0.12842D-01,
     & 0.13703D-01, 0.14552D-01, 0.15386D-01, 0.16203D-01, 0.17005D-01,
     & 0.17791D-01, 0.18563D-01, 0.19322D-01, 0.20070D-01, 0.20804D-01,
     & 0.21524D-01, 0.22230D-01, 0.22924D-01, 0.23605D-01, 0.24274D-01,
     & 0.24935D-01, 0.25583D-01, 0.26220D-01, 0.26845D-01, 0.27460D-01,
     & 0.50996D-02, 0.60778D-02, 0.70343D-02, 0.79703D-02, 0.88865D-02,
     & 0.97846D-02, 0.10668D-01, 0.11533D-01, 0.12378D-01, 0.13207D-01,
     & 0.14018D-01, 0.14816D-01, 0.15599D-01, 0.16366D-01, 0.17116D-01,
     & 0.17852D-01, 0.18572D-01, 0.19280D-01, 0.19977D-01, 0.20659D-01,
     & 0.21327D-01, 0.21982D-01, 0.22624D-01, 0.23254D-01, 0.23872D-01,
     & 0.24481D-01, 0.25079D-01, 0.25664D-01, 0.26238D-01, 0.26802D-01,
     & 0.60794D-02, 0.70165D-02, 0.79312D-02, 0.88244D-02, 0.96973D-02,
     & 0.10551D-01, 0.11391D-01, 0.12210D-01, 0.13011D-01, 0.13793D-01,
     & 0.14558D-01, 0.15310D-01, 0.16046D-01, 0.16765D-01, 0.17468D-01,
     & 0.18156D-01, 0.18829D-01, 0.19488D-01, 0.20137D-01, 0.20770D-01,
     & 0.21390D-01, 0.21997D-01, 0.22590D-01, 0.23172D-01, 0.23741D-01,
     & 0.24302D-01, 0.24851D-01, 0.25388D-01, 0.25914D-01, 0.26429D-01,
     & 0.72644D-02, 0.81660D-02, 0.90439D-02, 0.98994D-02, 0.10733D-01,
     & 0.11548D-01, 0.12347D-01, 0.13125D-01, 0.13884D-01, 0.14624D-01,
     & 0.15346D-01, 0.16054D-01, 0.16746D-01, 0.17420D-01, 0.18079D-01,
     & 0.18721D-01, 0.19348D-01, 0.19962D-01, 0.20564D-01, 0.21152D-01,
     & 0.21725D-01, 0.22285D-01, 0.22832D-01, 0.23366D-01, 0.23889D-01,
     & 0.24402D-01, 0.24904D-01, 0.25394D-01, 0.25873D-01, 0.26341D-01/

      data ((uds_grdl(i,j),j=1,30),i=21,30)/
     & 0.86753D-02, 0.95469D-02, 0.10393D-01, 0.11215D-01, 0.12015D-01,
     & 0.12793D-01, 0.13555D-01, 0.14295D-01, 0.15014D-01, 0.15714D-01,
     & 0.16395D-01, 0.17061D-01, 0.17710D-01, 0.18342D-01, 0.18956D-01,
     & 0.19554D-01, 0.20137D-01, 0.20705D-01, 0.21262D-01, 0.21803D-01,
     & 0.22330D-01, 0.22843D-01, 0.23343D-01, 0.23831D-01, 0.24306D-01,
     & 0.24773D-01, 0.25227D-01, 0.25669D-01, 0.26101D-01, 0.26521D-01,
     & 0.10317D-01, 0.11161D-01, 0.11978D-01, 0.12768D-01, 0.13534D-01,
     & 0.14276D-01, 0.15001D-01, 0.15702D-01, 0.16381D-01, 0.17040D-01,
     & 0.17678D-01, 0.18300D-01, 0.18905D-01, 0.19491D-01, 0.20059D-01,
     & 0.20610D-01, 0.21144D-01, 0.21665D-01, 0.22172D-01, 0.22664D-01,
     & 0.23142D-01, 0.23605D-01, 0.24055D-01, 0.24492D-01, 0.24917D-01,
     & 0.25332D-01, 0.25735D-01, 0.26127D-01, 0.26507D-01, 0.26877D-01,
     & 0.12159D-01, 0.12978D-01, 0.13766D-01, 0.14525D-01, 0.15256D-01,
     & 0.15962D-01, 0.16647D-01, 0.17307D-01, 0.17943D-01, 0.18556D-01,
     & 0.19148D-01, 0.19722D-01, 0.20278D-01, 0.20813D-01, 0.21330D-01,
     & 0.21829D-01, 0.22311D-01, 0.22778D-01, 0.23230D-01, 0.23667D-01,
     & 0.24089D-01, 0.24497D-01, 0.24891D-01, 0.25272D-01, 0.25641D-01,
     & 0.25999D-01, 0.26345D-01, 0.26679D-01, 0.27003D-01, 0.27316D-01,
     & 0.14115D-01, 0.14905D-01, 0.15660D-01, 0.16383D-01, 0.17074D-01,
     & 0.17736D-01, 0.18373D-01, 0.18983D-01, 0.19567D-01, 0.20127D-01,
     & 0.20663D-01, 0.21179D-01, 0.21674D-01, 0.22148D-01, 0.22603D-01,
     & 0.23040D-01, 0.23458D-01, 0.23860D-01, 0.24247D-01, 0.24618D-01,
     & 0.24973D-01, 0.25315D-01, 0.25642D-01, 0.25957D-01, 0.26259D-01,
     & 0.26549D-01, 0.26827D-01, 0.27095D-01, 0.27351D-01, 0.27597D-01,
     & 0.15999D-01, 0.16746D-01, 0.17453D-01, 0.18122D-01, 0.18755D-01,
     & 0.19356D-01, 0.19926D-01, 0.20467D-01, 0.20979D-01, 0.21464D-01,
     & 0.21925D-01, 0.22362D-01, 0.22776D-01, 0.23169D-01, 0.23542D-01,
     & 0.23896D-01, 0.24232D-01, 0.24550D-01, 0.24851D-01, 0.25137D-01,
     & 0.25408D-01, 0.25665D-01, 0.25908D-01, 0.26139D-01, 0.26357D-01,
     & 0.26563D-01, 0.26757D-01, 0.26942D-01, 0.27116D-01, 0.27281D-01,
     & 0.16408D-01, 0.17141D-01, 0.17833D-01, 0.18485D-01, 0.19100D-01,
     & 0.19682D-01, 0.20231D-01, 0.20750D-01, 0.21240D-01, 0.21704D-01,
     & 0.22141D-01, 0.22555D-01, 0.22946D-01, 0.23315D-01, 0.23664D-01,
     & 0.23994D-01, 0.24306D-01, 0.24600D-01, 0.24877D-01, 0.25138D-01,
     & 0.25386D-01, 0.25619D-01, 0.25839D-01, 0.26046D-01, 0.26241D-01,
     & 0.26423D-01, 0.26595D-01, 0.26757D-01, 0.26909D-01, 0.27052D-01,
     & 0.16776D-01, 0.17493D-01, 0.18166D-01, 0.18800D-01, 0.19396D-01,
     & 0.19956D-01, 0.20483D-01, 0.20980D-01, 0.21447D-01, 0.21887D-01,
     & 0.22301D-01, 0.22690D-01, 0.23056D-01, 0.23400D-01, 0.23725D-01,
     & 0.24030D-01, 0.24317D-01, 0.24586D-01, 0.24838D-01, 0.25075D-01,
     & 0.25298D-01, 0.25507D-01, 0.25703D-01, 0.25886D-01, 0.26058D-01,
     & 0.26217D-01, 0.26365D-01, 0.26504D-01, 0.26634D-01, 0.26754D-01,
     & 0.17100D-01, 0.17798D-01, 0.18453D-01, 0.19066D-01, 0.19640D-01,
     & 0.20178D-01, 0.20682D-01, 0.21154D-01, 0.21596D-01, 0.22011D-01,
     & 0.22400D-01, 0.22763D-01, 0.23103D-01, 0.23422D-01, 0.23721D-01,
     & 0.24000D-01, 0.24262D-01, 0.24505D-01, 0.24731D-01, 0.24943D-01,
     & 0.25141D-01, 0.25325D-01, 0.25496D-01, 0.25656D-01, 0.25804D-01,
     & 0.25939D-01, 0.26064D-01, 0.26180D-01, 0.26286D-01, 0.26385D-01,
     & 0.17378D-01, 0.18056D-01, 0.18689D-01, 0.19279D-01, 0.19830D-01,
     & 0.20344D-01, 0.20821D-01, 0.21267D-01, 0.21684D-01, 0.22072D-01,
     & 0.22435D-01, 0.22771D-01, 0.23084D-01, 0.23375D-01, 0.23647D-01,
     & 0.23900D-01, 0.24135D-01, 0.24353D-01, 0.24553D-01, 0.24738D-01,
     & 0.24910D-01, 0.25070D-01, 0.25217D-01, 0.25352D-01, 0.25476D-01,
     & 0.25586D-01, 0.25688D-01, 0.25781D-01, 0.25865D-01, 0.25941D-01,
     & 0.17610D-01, 0.18265D-01, 0.18873D-01, 0.19439D-01, 0.19964D-01,
     & 0.20452D-01, 0.20901D-01, 0.21320D-01, 0.21708D-01, 0.22069D-01,
     & 0.22404D-01, 0.22712D-01, 0.22996D-01, 0.23259D-01, 0.23503D-01,
     & 0.23729D-01, 0.23937D-01, 0.24128D-01, 0.24301D-01, 0.24460D-01,
     & 0.24606D-01, 0.24739D-01, 0.24861D-01, 0.24972D-01, 0.25072D-01,
     & 0.25158D-01, 0.25236D-01, 0.25306D-01, 0.25368D-01, 0.25422D-01/

      data ((uds_grdl(i,j),j=1,30),i=31,40)/
     & 0.17793D-01, 0.18422D-01, 0.19004D-01, 0.19542D-01, 0.20040D-01,
     & 0.20499D-01, 0.20919D-01, 0.21307D-01, 0.21666D-01, 0.21998D-01,
     & 0.22303D-01, 0.22581D-01, 0.22836D-01, 0.23070D-01, 0.23286D-01,
     & 0.23483D-01, 0.23663D-01, 0.23827D-01, 0.23972D-01, 0.24104D-01,
     & 0.24224D-01, 0.24332D-01, 0.24429D-01, 0.24515D-01, 0.24590D-01,
     & 0.24653D-01, 0.24707D-01, 0.24754D-01, 0.24793D-01, 0.24826D-01,
     & 0.17928D-01, 0.18527D-01, 0.19080D-01, 0.19588D-01, 0.20055D-01,
     & 0.20483D-01, 0.20871D-01, 0.21228D-01, 0.21556D-01, 0.21856D-01,
     & 0.22131D-01, 0.22378D-01, 0.22602D-01, 0.22806D-01, 0.22992D-01,
     & 0.23160D-01, 0.23312D-01, 0.23447D-01, 0.23564D-01, 0.23669D-01,
     & 0.23763D-01, 0.23845D-01, 0.23916D-01, 0.23978D-01, 0.24029D-01,
     & 0.24068D-01, 0.24099D-01, 0.24123D-01, 0.24140D-01, 0.24151D-01,
     & 0.18012D-01, 0.18579D-01, 0.19099D-01, 0.19574D-01, 0.20008D-01,
     & 0.20403D-01, 0.20757D-01, 0.21080D-01, 0.21374D-01, 0.21642D-01,
     & 0.21884D-01, 0.22099D-01, 0.22291D-01, 0.22464D-01, 0.22620D-01,
     & 0.22758D-01, 0.22881D-01, 0.22988D-01, 0.23077D-01, 0.23154D-01,
     & 0.23221D-01, 0.23277D-01, 0.23323D-01, 0.23360D-01, 0.23388D-01,
     & 0.23403D-01, 0.23411D-01, 0.23413D-01, 0.23409D-01, 0.23399D-01,
     & 0.18046D-01, 0.18576D-01, 0.19059D-01, 0.19498D-01, 0.19896D-01,
     & 0.20255D-01, 0.20573D-01, 0.20860D-01, 0.21120D-01, 0.21353D-01,
     & 0.21562D-01, 0.21744D-01, 0.21903D-01, 0.22044D-01, 0.22168D-01,
     & 0.22277D-01, 0.22370D-01, 0.22448D-01, 0.22509D-01, 0.22559D-01,
     & 0.22599D-01, 0.22629D-01, 0.22650D-01, 0.22663D-01, 0.22667D-01,
     & 0.22659D-01, 0.22645D-01, 0.22625D-01, 0.22600D-01, 0.22570D-01,
     & 0.18029D-01, 0.18519D-01, 0.18962D-01, 0.19362D-01, 0.19722D-01,
     & 0.20042D-01, 0.20321D-01, 0.20570D-01, 0.20793D-01, 0.20991D-01,
     & 0.21165D-01, 0.21312D-01, 0.21437D-01, 0.21545D-01, 0.21638D-01,
     & 0.21716D-01, 0.21780D-01, 0.21828D-01, 0.21861D-01, 0.21883D-01,
     & 0.21897D-01, 0.21902D-01, 0.21898D-01, 0.21887D-01, 0.21868D-01,
     & 0.21838D-01, 0.21802D-01, 0.21761D-01, 0.21716D-01, 0.21667D-01,
     & 0.17957D-01, 0.18400D-01, 0.18799D-01, 0.19155D-01, 0.19472D-01,
     & 0.19750D-01, 0.19987D-01, 0.20197D-01, 0.20381D-01, 0.20540D-01,
     & 0.20678D-01, 0.20789D-01, 0.20879D-01, 0.20954D-01, 0.21015D-01,
     & 0.21061D-01, 0.21095D-01, 0.21115D-01, 0.21119D-01, 0.21114D-01,
     & 0.21101D-01, 0.21081D-01, 0.21053D-01, 0.21019D-01, 0.20978D-01,
     & 0.20926D-01, 0.20869D-01, 0.20808D-01, 0.20744D-01, 0.20676D-01,
     & 0.17833D-01, 0.18227D-01, 0.18577D-01, 0.18886D-01, 0.19157D-01,
     & 0.19392D-01, 0.19585D-01, 0.19752D-01, 0.19896D-01, 0.20017D-01,
     & 0.20116D-01, 0.20191D-01, 0.20246D-01, 0.20287D-01, 0.20315D-01,
     & 0.20330D-01, 0.20334D-01, 0.20325D-01, 0.20301D-01, 0.20270D-01,
     & 0.20232D-01, 0.20187D-01, 0.20136D-01, 0.20079D-01, 0.20017D-01,
     & 0.19944D-01, 0.19868D-01, 0.19788D-01, 0.19706D-01, 0.19621D-01,
     & 0.17656D-01, 0.17995D-01, 0.18292D-01, 0.18551D-01, 0.18773D-01,
     & 0.18961D-01, 0.19108D-01, 0.19232D-01, 0.19333D-01, 0.19414D-01,
     & 0.19475D-01, 0.19513D-01, 0.19532D-01, 0.19539D-01, 0.19535D-01,
     & 0.19519D-01, 0.19494D-01, 0.19456D-01, 0.19405D-01, 0.19348D-01,
     & 0.19286D-01, 0.19218D-01, 0.19145D-01, 0.19067D-01, 0.18984D-01,
     & 0.18892D-01, 0.18797D-01, 0.18701D-01, 0.18602D-01, 0.18501D-01,
     & 0.17424D-01, 0.17703D-01, 0.17943D-01, 0.18147D-01, 0.18318D-01,
     & 0.18455D-01, 0.18555D-01, 0.18633D-01, 0.18691D-01, 0.18730D-01,
     & 0.18753D-01, 0.18753D-01, 0.18736D-01, 0.18710D-01, 0.18673D-01,
     & 0.18627D-01, 0.18572D-01, 0.18508D-01, 0.18431D-01, 0.18349D-01,
     & 0.18263D-01, 0.18173D-01, 0.18079D-01, 0.17981D-01, 0.17879D-01,
     & 0.17770D-01, 0.17659D-01, 0.17546D-01, 0.17433D-01, 0.17318D-01,
     & 0.17136D-01, 0.17350D-01, 0.17528D-01, 0.17674D-01, 0.17789D-01,
     & 0.17875D-01, 0.17924D-01, 0.17955D-01, 0.17969D-01, 0.17966D-01,
     & 0.17949D-01, 0.17912D-01, 0.17860D-01, 0.17799D-01, 0.17731D-01,
     & 0.17655D-01, 0.17572D-01, 0.17481D-01, 0.17380D-01, 0.17274D-01,
     & 0.17166D-01, 0.17056D-01, 0.16942D-01, 0.16826D-01, 0.16708D-01,
     & 0.16582D-01, 0.16456D-01, 0.16330D-01, 0.16203D-01, 0.16076D-01/

      data ((uds_grdl(i,j),j=1,30),i=41,50)/
     & 0.16789D-01, 0.16932D-01, 0.17044D-01, 0.17128D-01, 0.17185D-01,
     & 0.17215D-01, 0.17213D-01, 0.17196D-01, 0.17164D-01, 0.17119D-01,
     & 0.17062D-01, 0.16988D-01, 0.16901D-01, 0.16808D-01, 0.16709D-01,
     & 0.16604D-01, 0.16495D-01, 0.16379D-01, 0.16254D-01, 0.16128D-01,
     & 0.15999D-01, 0.15870D-01, 0.15739D-01, 0.15606D-01, 0.15473D-01,
     & 0.15333D-01, 0.15195D-01, 0.15057D-01, 0.14919D-01, 0.14782D-01,
     & 0.16381D-01, 0.16449D-01, 0.16490D-01, 0.16508D-01, 0.16504D-01,
     & 0.16478D-01, 0.16423D-01, 0.16357D-01, 0.16279D-01, 0.16192D-01,
     & 0.16095D-01, 0.15984D-01, 0.15863D-01, 0.15739D-01, 0.15611D-01,
     & 0.15479D-01, 0.15345D-01, 0.15205D-01, 0.15059D-01, 0.14913D-01,
     & 0.14767D-01, 0.14621D-01, 0.14474D-01, 0.14328D-01, 0.14181D-01,
     & 0.14031D-01, 0.13882D-01, 0.13734D-01, 0.13588D-01, 0.13443D-01,
     & 0.15906D-01, 0.15893D-01, 0.15860D-01, 0.15809D-01, 0.15741D-01,
     & 0.15656D-01, 0.15548D-01, 0.15432D-01, 0.15309D-01, 0.15180D-01,
     & 0.15045D-01, 0.14898D-01, 0.14746D-01, 0.14592D-01, 0.14436D-01,
     & 0.14280D-01, 0.14122D-01, 0.13962D-01, 0.13798D-01, 0.13635D-01,
     & 0.13473D-01, 0.13313D-01, 0.13154D-01, 0.12996D-01, 0.12839D-01,
     & 0.12680D-01, 0.12523D-01, 0.12369D-01, 0.12217D-01, 0.12067D-01,
     & 0.15354D-01, 0.15256D-01, 0.15145D-01, 0.15023D-01, 0.14890D-01,
     & 0.14746D-01, 0.14585D-01, 0.14421D-01, 0.14253D-01, 0.14083D-01,
     & 0.13911D-01, 0.13731D-01, 0.13549D-01, 0.13368D-01, 0.13188D-01,
     & 0.13009D-01, 0.12831D-01, 0.12653D-01, 0.12474D-01, 0.12297D-01,
     & 0.12123D-01, 0.11951D-01, 0.11782D-01, 0.11616D-01, 0.11452D-01,
     & 0.11287D-01, 0.11126D-01, 0.10968D-01, 0.10812D-01, 0.10660D-01,
     & 0.14702D-01, 0.14517D-01, 0.14327D-01, 0.14133D-01, 0.13935D-01,
     & 0.13733D-01, 0.13520D-01, 0.13310D-01, 0.13100D-01, 0.12892D-01,
     & 0.12685D-01, 0.12476D-01, 0.12268D-01, 0.12063D-01, 0.11862D-01,
     & 0.11664D-01, 0.11470D-01, 0.11278D-01, 0.11087D-01, 0.10900D-01,
     & 0.10717D-01, 0.10538D-01, 0.10363D-01, 0.10192D-01, 0.10024D-01,
     & 0.98574D-02, 0.96949D-02, 0.95362D-02, 0.93811D-02, 0.92296D-02,
     & 0.13924D-01, 0.13650D-01, 0.13381D-01, 0.13115D-01, 0.12854D-01,
     & 0.12595D-01, 0.12335D-01, 0.12082D-01, 0.11835D-01, 0.11593D-01,
     & 0.11356D-01, 0.11123D-01, 0.10893D-01, 0.10670D-01, 0.10453D-01,
     & 0.10242D-01, 0.10036D-01, 0.98346D-02, 0.96369D-02, 0.94448D-02,
     & 0.92580D-02, 0.90763D-02, 0.88996D-02, 0.87275D-02, 0.85599D-02,
     & 0.83956D-02, 0.82359D-02, 0.80805D-02, 0.79293D-02, 0.77821D-02,
     & 0.12983D-01, 0.12632D-01, 0.12292D-01, 0.11964D-01, 0.11647D-01,
     & 0.11339D-01, 0.11037D-01, 0.10746D-01, 0.10466D-01, 0.10194D-01,
     & 0.99323D-02, 0.96773D-02, 0.94302D-02, 0.91918D-02, 0.89616D-02,
     & 0.87393D-02, 0.85245D-02, 0.83166D-02, 0.81148D-02, 0.79199D-02,
     & 0.77316D-02, 0.75495D-02, 0.73734D-02, 0.72030D-02, 0.70381D-02,
     & 0.68783D-02, 0.67236D-02, 0.65738D-02, 0.64287D-02, 0.62882D-02,
     & 0.11996D-01, 0.11499D-01, 0.11030D-01, 0.10589D-01, 0.10173D-01,
     & 0.97804D-02, 0.94134D-02, 0.90655D-02, 0.87356D-02, 0.84226D-02,
     & 0.81257D-02, 0.78455D-02, 0.75801D-02, 0.73271D-02, 0.70858D-02,
     & 0.68557D-02, 0.66362D-02, 0.64274D-02, 0.62297D-02, 0.60403D-02,
     & 0.58588D-02, 0.56848D-02, 0.55182D-02, 0.53584D-02, 0.52054D-02,
     & 0.50604D-02, 0.49209D-02, 0.47867D-02, 0.46575D-02, 0.45331D-02,
     & 0.81943D-02, 0.77597D-02, 0.73551D-02, 0.69784D-02, 0.66277D-02,
     & 0.63024D-02, 0.60053D-02, 0.57264D-02, 0.54645D-02, 0.52187D-02,
     & 0.49881D-02, 0.47746D-02, 0.45755D-02, 0.43871D-02, 0.42089D-02,
     & 0.40404D-02, 0.38810D-02, 0.37314D-02, 0.35922D-02, 0.34597D-02,
     & 0.33335D-02, 0.32134D-02, 0.30991D-02, 0.29904D-02, 0.28871D-02,
     & 0.27910D-02, 0.26990D-02, 0.26109D-02, 0.25266D-02, 0.24459D-02,
     & 0.51728D-03, 0.48644D-03, 0.45786D-03, 0.43138D-03, 0.40686D-03,
     & 0.38426D-03, 0.36384D-03, 0.34475D-03, 0.32691D-03, 0.31024D-03,
     & 0.29468D-03, 0.28041D-03, 0.26720D-03, 0.25475D-03, 0.24302D-03,
     & 0.23197D-03, 0.22158D-03, 0.21188D-03, 0.20294D-03, 0.19447D-03,
     & 0.18642D-03, 0.17880D-03, 0.17157D-03, 0.16471D-03, 0.15823D-03,
     & 0.15228D-03, 0.14659D-03, 0.14116D-03, 0.13598D-03, 0.13103D-03/

      data ((g_grdl(i,j),j=1,30),i=1,10)/
     & 0.76535D+00, 0.82656D+00, 0.88784D+00, 0.94915D+00, 0.10105D+01,
     & 0.10717D+01, 0.11331D+01, 0.11942D+01, 0.12552D+01, 0.13159D+01,
     & 0.13763D+01, 0.14366D+01, 0.14967D+01, 0.15564D+01, 0.16157D+01,
     & 0.16747D+01, 0.17333D+01, 0.17915D+01, 0.18496D+01, 0.19072D+01,
     & 0.19643D+01, 0.20209D+01, 0.20771D+01, 0.21329D+01, 0.21882D+01,
     & 0.22434D+01, 0.22980D+01, 0.23521D+01, 0.24058D+01, 0.24589D+01,
     & 0.76009D+00, 0.81820D+00, 0.87626D+00, 0.93422D+00, 0.99205D+00,
     & 0.10498D+01, 0.11075D+01, 0.11649D+01, 0.12220D+01, 0.12788D+01,
     & 0.13353D+01, 0.13915D+01, 0.14475D+01, 0.15031D+01, 0.15582D+01,
     & 0.16129D+01, 0.16672D+01, 0.17212D+01, 0.17749D+01, 0.18280D+01,
     & 0.18807D+01, 0.19329D+01, 0.19846D+01, 0.20359D+01, 0.20867D+01,
     & 0.21373D+01, 0.21874D+01, 0.22370D+01, 0.22860D+01, 0.23346D+01,
     & 0.75400D+00, 0.80903D+00, 0.86389D+00, 0.91854D+00, 0.97297D+00,
     & 0.10272D+01, 0.10813D+01, 0.11351D+01, 0.11885D+01, 0.12415D+01,
     & 0.12941D+01, 0.13465D+01, 0.13986D+01, 0.14502D+01, 0.15013D+01,
     & 0.15519D+01, 0.16021D+01, 0.16519D+01, 0.17014D+01, 0.17504D+01,
     & 0.17989D+01, 0.18469D+01, 0.18943D+01, 0.19413D+01, 0.19879D+01,
     & 0.20342D+01, 0.20800D+01, 0.21252D+01, 0.21700D+01, 0.22142D+01,
     & 0.74700D+00, 0.79902D+00, 0.85075D+00, 0.90218D+00, 0.95331D+00,
     & 0.10041D+01, 0.10548D+01, 0.11051D+01, 0.11549D+01, 0.12043D+01,
     & 0.12532D+01, 0.13019D+01, 0.13502D+01, 0.13980D+01, 0.14452D+01,
     & 0.14920D+01, 0.15382D+01, 0.15841D+01, 0.16297D+01, 0.16747D+01,
     & 0.17192D+01, 0.17632D+01, 0.18066D+01, 0.18496D+01, 0.18921D+01,
     & 0.19344D+01, 0.19761D+01, 0.20173D+01, 0.20581D+01, 0.20983D+01,
     & 0.73881D+00, 0.78783D+00, 0.83648D+00, 0.88474D+00, 0.93261D+00,
     & 0.98014D+00, 0.10275D+01, 0.10743D+01, 0.11206D+01, 0.11665D+01,
     & 0.12119D+01, 0.12569D+01, 0.13016D+01, 0.13457D+01, 0.13893D+01,
     & 0.14323D+01, 0.14749D+01, 0.15170D+01, 0.15588D+01, 0.16000D+01,
     & 0.16407D+01, 0.16809D+01, 0.17205D+01, 0.17597D+01, 0.17984D+01,
     & 0.18368D+01, 0.18748D+01, 0.19122D+01, 0.19490D+01, 0.19854D+01,
     & 0.72926D+00, 0.77532D+00, 0.82092D+00, 0.86608D+00, 0.91078D+00,
     & 0.95507D+00, 0.99913D+00, 0.10426D+01, 0.10856D+01, 0.11281D+01,
     & 0.11700D+01, 0.12116D+01, 0.12528D+01, 0.12934D+01, 0.13334D+01,
     & 0.13729D+01, 0.14119D+01, 0.14504D+01, 0.14886D+01, 0.15263D+01,
     & 0.15634D+01, 0.15999D+01, 0.16360D+01, 0.16716D+01, 0.17067D+01,
     & 0.17415D+01, 0.17758D+01, 0.18096D+01, 0.18429D+01, 0.18757D+01,
     & 0.71818D+00, 0.76134D+00, 0.80398D+00, 0.84610D+00, 0.88772D+00,
     & 0.92888D+00, 0.96976D+00, 0.10101D+01, 0.10498D+01, 0.10890D+01,
     & 0.11276D+01, 0.11659D+01, 0.12037D+01, 0.12409D+01, 0.12776D+01,
     & 0.13137D+01, 0.13493D+01, 0.13845D+01, 0.14193D+01, 0.14535D+01,
     & 0.14872D+01, 0.15204D+01, 0.15531D+01, 0.15852D+01, 0.16169D+01,
     & 0.16484D+01, 0.16793D+01, 0.17097D+01, 0.17397D+01, 0.17691D+01,
     & 0.70548D+00, 0.74580D+00, 0.78554D+00, 0.82471D+00, 0.86335D+00,
     & 0.90149D+00, 0.93931D+00, 0.97651D+00, 0.10131D+01, 0.10492D+01,
     & 0.10847D+01, 0.11198D+01, 0.11544D+01, 0.11885D+01, 0.12219D+01,
     & 0.12549D+01, 0.12873D+01, 0.13192D+01, 0.13508D+01, 0.13818D+01,
     & 0.14123D+01, 0.14423D+01, 0.14718D+01, 0.15008D+01, 0.15293D+01,
     & 0.15576D+01, 0.15854D+01, 0.16126D+01, 0.16395D+01, 0.16658D+01,
     & 0.69102D+00, 0.72859D+00, 0.76554D+00, 0.80188D+00, 0.83765D+00,
     & 0.87290D+00, 0.90779D+00, 0.94205D+00, 0.97571D+00, 0.10088D+01,
     & 0.10413D+01, 0.10734D+01, 0.11050D+01, 0.11361D+01, 0.11665D+01,
     & 0.11965D+01, 0.12259D+01, 0.12548D+01, 0.12834D+01, 0.13114D+01,
     & 0.13389D+01, 0.13659D+01, 0.13924D+01, 0.14185D+01, 0.14441D+01,
     & 0.14694D+01, 0.14942D+01, 0.15186D+01, 0.15425D+01, 0.15660D+01,
     & 0.67442D+00, 0.70931D+00, 0.74355D+00, 0.77717D+00, 0.81018D+00,
     & 0.84264D+00, 0.87472D+00, 0.90617D+00, 0.93700D+00, 0.96724D+00,
     & 0.99691D+00, 0.10262D+01, 0.10549D+01, 0.10831D+01, 0.11108D+01,
     & 0.11378D+01, 0.11644D+01, 0.11905D+01, 0.12162D+01, 0.12415D+01,
     & 0.12662D+01, 0.12904D+01, 0.13141D+01, 0.13374D+01, 0.13602D+01,
     & 0.13828D+01, 0.14049D+01, 0.14266D+01, 0.14478D+01, 0.14687D+01/

      data ((g_grdl(i,j),j=1,30),i=11,20)/
     & 0.65553D+00, 0.68784D+00, 0.71948D+00, 0.75046D+00, 0.78083D+00,
     & 0.81064D+00, 0.84005D+00, 0.86881D+00, 0.89696D+00, 0.92451D+00,
     & 0.95150D+00, 0.97808D+00, 0.10042D+01, 0.10297D+01, 0.10546D+01,
     & 0.10790D+01, 0.11029D+01, 0.11264D+01, 0.11495D+01, 0.11721D+01,
     & 0.11942D+01, 0.12158D+01, 0.12370D+01, 0.12577D+01, 0.12780D+01,
     & 0.12980D+01, 0.13176D+01, 0.13368D+01, 0.13555D+01, 0.13739D+01,
     & 0.63436D+00, 0.66424D+00, 0.69343D+00, 0.72195D+00, 0.74985D+00,
     & 0.77717D+00, 0.80408D+00, 0.83034D+00, 0.85599D+00, 0.88105D+00,
     & 0.90555D+00, 0.92963D+00, 0.95322D+00, 0.97625D+00, 0.99873D+00,
     & 0.10207D+01, 0.10422D+01, 0.10632D+01, 0.10839D+01, 0.11040D+01,
     & 0.11238D+01, 0.11430D+01, 0.11618D+01, 0.11802D+01, 0.11982D+01,
     & 0.12159D+01, 0.12332D+01, 0.12501D+01, 0.12666D+01, 0.12827D+01,
     & 0.61065D+00, 0.63823D+00, 0.66511D+00, 0.69131D+00, 0.71689D+00,
     & 0.74188D+00, 0.76645D+00, 0.79038D+00, 0.81369D+00, 0.83643D+00,
     & 0.85861D+00, 0.88037D+00, 0.90165D+00, 0.92237D+00, 0.94257D+00,
     & 0.96227D+00, 0.98147D+00, 0.10003D+01, 0.10187D+01, 0.10367D+01,
     & 0.10542D+01, 0.10712D+01, 0.10879D+01, 0.11041D+01, 0.11200D+01,
     & 0.11355D+01, 0.11507D+01, 0.11656D+01, 0.11800D+01, 0.11941D+01,
     & 0.58471D+00, 0.61018D+00, 0.63494D+00, 0.65903D+00, 0.68247D+00,
     & 0.70534D+00, 0.72777D+00, 0.74957D+00, 0.77076D+00, 0.79138D+00,
     & 0.81146D+00, 0.83111D+00, 0.85030D+00, 0.86894D+00, 0.88707D+00,
     & 0.90471D+00, 0.92188D+00, 0.93864D+00, 0.95506D+00, 0.97102D+00,
     & 0.98654D+00, 0.10016D+01, 0.10163D+01, 0.10307D+01, 0.10446D+01,
     & 0.10583D+01, 0.10716D+01, 0.10845D+01, 0.10972D+01, 0.11094D+01,
     & 0.55665D+00, 0.58022D+00, 0.60306D+00, 0.62523D+00, 0.64676D+00,
     & 0.66770D+00, 0.68821D+00, 0.70809D+00, 0.72737D+00, 0.74608D+00,
     & 0.76426D+00, 0.78202D+00, 0.79932D+00, 0.81609D+00, 0.83236D+00,
     & 0.84816D+00, 0.86350D+00, 0.87845D+00, 0.89305D+00, 0.90721D+00,
     & 0.92096D+00, 0.93430D+00, 0.94726D+00, 0.95986D+00, 0.97210D+00,
     & 0.98409D+00, 0.99572D+00, 0.10070D+01, 0.10180D+01, 0.10286D+01,
     & 0.52613D+00, 0.54801D+00, 0.56916D+00, 0.58963D+00, 0.60945D+00,
     & 0.62869D+00, 0.64748D+00, 0.66565D+00, 0.68322D+00, 0.70025D+00,
     & 0.71674D+00, 0.73281D+00, 0.74842D+00, 0.76352D+00, 0.77814D+00,
     & 0.79230D+00, 0.80601D+00, 0.81934D+00, 0.83233D+00, 0.84490D+00,
     & 0.85707D+00, 0.86885D+00, 0.88026D+00, 0.89133D+00, 0.90206D+00,
     & 0.91253D+00, 0.92267D+00, 0.93249D+00, 0.94200D+00, 0.95121D+00,
     & 0.49425D+00, 0.51470D+00, 0.53441D+00, 0.55344D+00, 0.57181D+00,
     & 0.58959D+00, 0.60690D+00, 0.62360D+00, 0.63972D+00, 0.65528D+00,
     & 0.67031D+00, 0.68492D+00, 0.69907D+00, 0.71273D+00, 0.72591D+00,
     & 0.73865D+00, 0.75095D+00, 0.76287D+00, 0.77445D+00, 0.78563D+00,
     & 0.79642D+00, 0.80684D+00, 0.81691D+00, 0.82664D+00, 0.83605D+00,
     & 0.84520D+00, 0.85404D+00, 0.86257D+00, 0.87081D+00, 0.87877D+00,
     & 0.46174D+00, 0.48105D+00, 0.49961D+00, 0.51746D+00, 0.53465D+00,
     & 0.55123D+00, 0.56733D+00, 0.58281D+00, 0.59770D+00, 0.61204D+00,
     & 0.62585D+00, 0.63923D+00, 0.65215D+00, 0.66458D+00, 0.67654D+00,
     & 0.68806D+00, 0.69915D+00, 0.70986D+00, 0.72024D+00, 0.73022D+00,
     & 0.73983D+00, 0.74908D+00, 0.75798D+00, 0.76656D+00, 0.77483D+00,
     & 0.78284D+00, 0.79054D+00, 0.79796D+00, 0.80509D+00, 0.81196D+00,
     & 0.42992D+00, 0.44841D+00, 0.46612D+00, 0.48310D+00, 0.49939D+00,
     & 0.51505D+00, 0.53020D+00, 0.54472D+00, 0.55864D+00, 0.57199D+00,
     & 0.58481D+00, 0.59718D+00, 0.60909D+00, 0.62051D+00, 0.63145D+00,
     & 0.64196D+00, 0.65204D+00, 0.66174D+00, 0.67109D+00, 0.68006D+00,
     & 0.68866D+00, 0.69690D+00, 0.70481D+00, 0.71240D+00, 0.71968D+00,
     & 0.72670D+00, 0.73342D+00, 0.73987D+00, 0.74604D+00, 0.75196D+00,
     & 0.40060D+00, 0.41861D+00, 0.43580D+00, 0.45221D+00, 0.46790D+00,
     & 0.48292D+00, 0.49738D+00, 0.51119D+00, 0.52438D+00, 0.53698D+00,
     & 0.54903D+00, 0.56061D+00, 0.57171D+00, 0.58230D+00, 0.59242D+00,
     & 0.60209D+00, 0.61133D+00, 0.62017D+00, 0.62866D+00, 0.63676D+00,
     & 0.64449D+00, 0.65188D+00, 0.65892D+00, 0.66565D+00, 0.67207D+00,
     & 0.67822D+00, 0.68408D+00, 0.68966D+00, 0.69499D+00, 0.70006D+00/

      data ((g_grdl(i,j),j=1,30),i=21,30)/
     & 0.37631D+00, 0.39420D+00, 0.41119D+00, 0.42735D+00, 0.44272D+00,
     & 0.45736D+00, 0.47139D+00, 0.48472D+00, 0.49740D+00, 0.50945D+00,
     & 0.52093D+00, 0.53188D+00, 0.54233D+00, 0.55226D+00, 0.56169D+00,
     & 0.57065D+00, 0.57918D+00, 0.58729D+00, 0.59501D+00, 0.60235D+00,
     & 0.60931D+00, 0.61592D+00, 0.62218D+00, 0.62812D+00, 0.63376D+00,
     & 0.63910D+00, 0.64416D+00, 0.64894D+00, 0.65347D+00, 0.65774D+00,
     & 0.36045D+00, 0.37858D+00, 0.39570D+00, 0.41189D+00, 0.42721D+00,
     & 0.44171D+00, 0.45551D+00, 0.46854D+00, 0.48087D+00, 0.49252D+00,
     & 0.50354D+00, 0.51398D+00, 0.52386D+00, 0.53320D+00, 0.54201D+00,
     & 0.55033D+00, 0.55818D+00, 0.56558D+00, 0.57257D+00, 0.57915D+00,
     & 0.58535D+00, 0.59118D+00, 0.59667D+00, 0.60181D+00, 0.60665D+00,
     & 0.61116D+00, 0.61538D+00, 0.61934D+00, 0.62303D+00, 0.62648D+00,
     & 0.35918D+00, 0.37788D+00, 0.39543D+00, 0.41190D+00, 0.42737D+00,
     & 0.44190D+00, 0.45559D+00, 0.46843D+00, 0.48047D+00, 0.49176D+00,
     & 0.50234D+00, 0.51227D+00, 0.52156D+00, 0.53026D+00, 0.53840D+00,
     & 0.54600D+00, 0.55310D+00, 0.55971D+00, 0.56585D+00, 0.57156D+00,
     & 0.57688D+00, 0.58181D+00, 0.58638D+00, 0.59061D+00, 0.59450D+00,
     & 0.59803D+00, 0.60127D+00, 0.60424D+00, 0.60696D+00, 0.60942D+00,
     & 0.38130D+00, 0.40079D+00, 0.41890D+00, 0.43574D+00, 0.45138D+00,
     & 0.46590D+00, 0.47937D+00, 0.49186D+00, 0.50345D+00, 0.51418D+00,
     & 0.52410D+00, 0.53323D+00, 0.54164D+00, 0.54939D+00, 0.55653D+00,
     & 0.56309D+00, 0.56909D+00, 0.57455D+00, 0.57946D+00, 0.58393D+00,
     & 0.58799D+00, 0.59165D+00, 0.59493D+00, 0.59786D+00, 0.60043D+00,
     & 0.60259D+00, 0.60447D+00, 0.60609D+00, 0.60745D+00, 0.60857D+00,
     & 0.44281D+00, 0.46279D+00, 0.48108D+00, 0.49782D+00, 0.51309D+00,
     & 0.52699D+00, 0.53952D+00, 0.55092D+00, 0.56127D+00, 0.57063D+00,
     & 0.57906D+00, 0.58652D+00, 0.59314D+00, 0.59905D+00, 0.60429D+00,
     & 0.60891D+00, 0.61294D+00, 0.61635D+00, 0.61912D+00, 0.62144D+00,
     & 0.62336D+00, 0.62488D+00, 0.62604D+00, 0.62684D+00, 0.62729D+00,
     & 0.62725D+00, 0.62696D+00, 0.62644D+00, 0.62570D+00, 0.62474D+00,
     & 0.46653D+00, 0.48646D+00, 0.50462D+00, 0.52113D+00, 0.53611D+00,
     & 0.54964D+00, 0.56168D+00, 0.57257D+00, 0.58237D+00, 0.59115D+00,
     & 0.59897D+00, 0.60577D+00, 0.61169D+00, 0.61690D+00, 0.62144D+00,
     & 0.62534D+00, 0.62866D+00, 0.63134D+00, 0.63335D+00, 0.63494D+00,
     & 0.63612D+00, 0.63691D+00, 0.63734D+00, 0.63743D+00, 0.63717D+00,
     & 0.63641D+00, 0.63541D+00, 0.63419D+00, 0.63277D+00, 0.63114D+00,
     & 0.49370D+00, 0.51343D+00, 0.53130D+00, 0.54746D+00, 0.56201D+00,
     & 0.57503D+00, 0.58647D+00, 0.59672D+00, 0.60585D+00, 0.61394D+00,
     & 0.62104D+00, 0.62707D+00, 0.63218D+00, 0.63659D+00, 0.64032D+00,
     & 0.64341D+00, 0.64591D+00, 0.64778D+00, 0.64894D+00, 0.64969D+00,
     & 0.65005D+00, 0.65003D+00, 0.64966D+00, 0.64896D+00, 0.64792D+00,
     & 0.64636D+00, 0.64459D+00, 0.64261D+00, 0.64044D+00, 0.63809D+00,
     & 0.52454D+00, 0.54394D+00, 0.56139D+00, 0.57705D+00, 0.59102D+00,
     & 0.60339D+00, 0.61407D+00, 0.62352D+00, 0.63183D+00, 0.63907D+00,
     & 0.64531D+00, 0.65041D+00, 0.65458D+00, 0.65805D+00, 0.66084D+00,
     & 0.66301D+00, 0.66458D+00, 0.66551D+00, 0.66572D+00, 0.66554D+00,
     & 0.66498D+00, 0.66406D+00, 0.66280D+00, 0.66123D+00, 0.65933D+00,
     & 0.65691D+00, 0.65429D+00, 0.65149D+00, 0.64852D+00, 0.64539D+00,
     & 0.55930D+00, 0.57815D+00, 0.59498D+00, 0.60993D+00, 0.62314D+00,
     & 0.63468D+00, 0.64441D+00, 0.65290D+00, 0.66022D+00, 0.66646D+00,
     & 0.67168D+00, 0.67573D+00, 0.67881D+00, 0.68120D+00, 0.68293D+00,
     & 0.68404D+00, 0.68456D+00, 0.68444D+00, 0.68359D+00, 0.68236D+00,
     & 0.68078D+00, 0.67886D+00, 0.67663D+00, 0.67410D+00, 0.67126D+00,
     & 0.66789D+00, 0.66435D+00, 0.66066D+00, 0.65682D+00, 0.65283D+00,
     & 0.59824D+00, 0.61632D+00, 0.63231D+00, 0.64636D+00, 0.65859D+00,
     & 0.66908D+00, 0.67765D+00, 0.68496D+00, 0.69110D+00, 0.69615D+00,
     & 0.70017D+00, 0.70296D+00, 0.70479D+00, 0.70593D+00, 0.70644D+00,
     & 0.70635D+00, 0.70568D+00, 0.70438D+00, 0.70234D+00, 0.69995D+00,
     & 0.69723D+00, 0.69421D+00, 0.69090D+00, 0.68732D+00, 0.68346D+00,
     & 0.67906D+00, 0.67452D+00, 0.66986D+00, 0.66508D+00, 0.66019D+00/

      data ((g_grdl(i,j),j=1,30),i=31,40)/
     & 0.64164D+00, 0.65866D+00, 0.67353D+00, 0.68639D+00, 0.69739D+00,
     & 0.70658D+00, 0.71374D+00, 0.71965D+00, 0.72439D+00, 0.72803D+00,
     & 0.73065D+00, 0.73201D+00, 0.73239D+00, 0.73212D+00, 0.73124D+00,
     & 0.72979D+00, 0.72779D+00, 0.72517D+00, 0.72180D+00, 0.71812D+00,
     & 0.71415D+00, 0.70992D+00, 0.70543D+00, 0.70069D+00, 0.69571D+00,
     & 0.69020D+00, 0.68459D+00, 0.67888D+00, 0.67310D+00, 0.66723D+00,
     & 0.68981D+00, 0.70543D+00, 0.71885D+00, 0.73021D+00, 0.73968D+00,
     & 0.74729D+00, 0.75276D+00, 0.75699D+00, 0.76007D+00, 0.76207D+00,
     & 0.76305D+00, 0.76276D+00, 0.76148D+00, 0.75960D+00, 0.75714D+00,
     & 0.75415D+00, 0.75066D+00, 0.74656D+00, 0.74172D+00, 0.73662D+00,
     & 0.73127D+00, 0.72570D+00, 0.71992D+00, 0.71394D+00, 0.70774D+00,
     & 0.70103D+00, 0.69426D+00, 0.68744D+00, 0.68057D+00, 0.67367D+00,
     & 0.74305D+00, 0.75687D+00, 0.76845D+00, 0.77796D+00, 0.78555D+00,
     & 0.79125D+00, 0.79470D+00, 0.79695D+00, 0.79807D+00, 0.79815D+00,
     & 0.79725D+00, 0.79504D+00, 0.79188D+00, 0.78817D+00, 0.78393D+00,
     & 0.77922D+00, 0.77405D+00, 0.76831D+00, 0.76184D+00, 0.75517D+00,
     & 0.74832D+00, 0.74130D+00, 0.73411D+00, 0.72676D+00, 0.71925D+00,
     & 0.71125D+00, 0.70324D+00, 0.69523D+00, 0.68722D+00, 0.67921D+00,
     & 0.80163D+00, 0.81316D+00, 0.82245D+00, 0.82967D+00, 0.83497D+00,
     & 0.83838D+00, 0.83945D+00, 0.83938D+00, 0.83824D+00, 0.83610D+00,
     & 0.83303D+00, 0.82867D+00, 0.82337D+00, 0.81760D+00, 0.81138D+00,
     & 0.80474D+00, 0.79770D+00, 0.79015D+00, 0.78190D+00, 0.77351D+00,
     & 0.76501D+00, 0.75640D+00, 0.74769D+00, 0.73888D+00, 0.72995D+00,
     & 0.72057D+00, 0.71125D+00, 0.70197D+00, 0.69275D+00, 0.68357D+00,
     & 0.86585D+00, 0.87456D+00, 0.88106D+00, 0.88551D+00, 0.88807D+00,
     & 0.88874D+00, 0.88700D+00, 0.88421D+00, 0.88042D+00, 0.87572D+00,
     & 0.87016D+00, 0.86332D+00, 0.85561D+00, 0.84751D+00, 0.83906D+00,
     & 0.83027D+00, 0.82117D+00, 0.81161D+00, 0.80141D+00, 0.79116D+00,
     & 0.78087D+00, 0.77054D+00, 0.76019D+00, 0.74981D+00, 0.73937D+00,
     & 0.72854D+00, 0.71782D+00, 0.70721D+00, 0.69672D+00, 0.68633D+00,
     & 0.93637D+00, 0.94153D+00, 0.94456D+00, 0.94562D+00, 0.94486D+00,
     & 0.94227D+00, 0.93724D+00, 0.93127D+00, 0.92443D+00, 0.91677D+00,
     & 0.90836D+00, 0.89872D+00, 0.88830D+00, 0.87760D+00, 0.86665D+00,
     & 0.85547D+00, 0.84408D+00, 0.83232D+00, 0.81998D+00, 0.80770D+00,
     & 0.79546D+00, 0.78328D+00, 0.77115D+00, 0.75908D+00, 0.74704D+00,
     & 0.73466D+00, 0.72247D+00, 0.71046D+00, 0.69862D+00, 0.68696D+00,
     & 0.10130D+01, 0.10139D+01, 0.10128D+01, 0.10098D+01, 0.10051D+01,
     & 0.99867D+00, 0.98980D+00, 0.98015D+00, 0.96978D+00, 0.95875D+00,
     & 0.94709D+00, 0.93430D+00, 0.92082D+00, 0.90722D+00, 0.89351D+00,
     & 0.87970D+00, 0.86579D+00, 0.85163D+00, 0.83699D+00, 0.82251D+00,
     & 0.80820D+00, 0.79404D+00, 0.78003D+00, 0.76617D+00, 0.75243D+00,
     & 0.73844D+00, 0.72473D+00, 0.71127D+00, 0.69806D+00, 0.68510D+00,
     & 0.10962D+01, 0.10918D+01, 0.10856D+01, 0.10778D+01, 0.10685D+01,
     & 0.10575D+01, 0.10442D+01, 0.10304D+01, 0.10160D+01, 0.10011D+01,
     & 0.98577D+00, 0.96944D+00, 0.95259D+00, 0.93578D+00, 0.91903D+00,
     & 0.90233D+00, 0.88569D+00, 0.86893D+00, 0.85182D+00, 0.83500D+00,
     & 0.81846D+00, 0.80220D+00, 0.78621D+00, 0.77048D+00, 0.75496D+00,
     & 0.73932D+00, 0.72403D+00, 0.70909D+00, 0.69448D+00, 0.68019D+00,
     & 0.11861D+01, 0.11753D+01, 0.11631D+01, 0.11495D+01, 0.11347D+01,
     & 0.11185D+01, 0.11000D+01, 0.10813D+01, 0.10623D+01, 0.10431D+01,
     & 0.10236D+01, 0.10034D+01, 0.98276D+00, 0.96242D+00, 0.94233D+00,
     & 0.92248D+00, 0.90287D+00, 0.88331D+00, 0.86356D+00, 0.84425D+00,
     & 0.82538D+00, 0.80691D+00, 0.78885D+00, 0.77116D+00, 0.75381D+00,
     & 0.73648D+00, 0.71960D+00, 0.70316D+00, 0.68714D+00, 0.67153D+00,
     & 0.12827D+01, 0.12644D+01, 0.12449D+01, 0.12245D+01, 0.12032D+01,
     & 0.11808D+01, 0.11565D+01, 0.11321D+01, 0.11079D+01, 0.10837D+01,
     & 0.10596D+01, 0.10350D+01, 0.10103D+01, 0.98603D+00, 0.96230D+00,
     & 0.93903D+00, 0.91622D+00, 0.89367D+00, 0.87114D+00, 0.84923D+00,
     & 0.82791D+00, 0.80716D+00, 0.78695D+00, 0.76726D+00, 0.74805D+00,
     & 0.72903D+00, 0.71057D+00, 0.69265D+00, 0.67525D+00, 0.65834D+00/

      data ((g_grdl(i,j),j=1,30),i=41,50)/
     & 0.13861D+01, 0.13585D+01, 0.13305D+01, 0.13020D+01, 0.12730D+01,
     & 0.12435D+01, 0.12124D+01, 0.11818D+01, 0.11516D+01, 0.11219D+01,
     & 0.10927D+01, 0.10632D+01, 0.10340D+01, 0.10056D+01, 0.97790D+00,
     & 0.95097D+00, 0.92475D+00, 0.89904D+00, 0.87362D+00, 0.84900D+00,
     & 0.82516D+00, 0.80206D+00, 0.77967D+00, 0.75795D+00, 0.73687D+00,
     & 0.71619D+00, 0.69619D+00, 0.67683D+00, 0.65810D+00, 0.63996D+00,
     & 0.14958D+01, 0.14573D+01, 0.14190D+01, 0.13809D+01, 0.13431D+01,
     & 0.13053D+01, 0.12664D+01, 0.12286D+01, 0.11918D+01, 0.11558D+01,
     & 0.11208D+01, 0.10860D+01, 0.10519D+01, 0.10189D+01, 0.98707D+00,
     & 0.95624D+00, 0.92641D+00, 0.89741D+00, 0.86903D+00, 0.84167D+00,
     & 0.81529D+00, 0.78984D+00, 0.76529D+00, 0.74159D+00, 0.71869D+00,
     & 0.69646D+00, 0.67502D+00, 0.65434D+00, 0.63439D+00, 0.61514D+00,
     & 0.16109D+01, 0.15591D+01, 0.15086D+01, 0.14592D+01, 0.14110D+01,
     & 0.13636D+01, 0.13159D+01, 0.12700D+01, 0.12257D+01, 0.11829D+01,
     & 0.11415D+01, 0.11010D+01, 0.10616D+01, 0.10239D+01, 0.98758D+00,
     & 0.95269D+00, 0.91913D+00, 0.88678D+00, 0.85545D+00, 0.82539D+00,
     & 0.79652D+00, 0.76880D+00, 0.74217D+00, 0.71659D+00, 0.69201D+00,
     & 0.66839D+00, 0.64570D+00, 0.62388D+00, 0.60290D+00, 0.58273D+00,
     & 0.17293D+01, 0.16617D+01, 0.15967D+01, 0.15340D+01, 0.14735D+01,
     & 0.14150D+01, 0.13574D+01, 0.13023D+01, 0.12496D+01, 0.11991D+01,
     & 0.11508D+01, 0.11042D+01, 0.10594D+01, 0.10166D+01, 0.97578D+00,
     & 0.93676D+00, 0.89948D+00, 0.86384D+00, 0.82976D+00, 0.79718D+00,
     & 0.76604D+00, 0.73627D+00, 0.70781D+00, 0.68061D+00, 0.65461D+00,
     & 0.62994D+00, 0.60631D+00, 0.58366D+00, 0.56197D+00, 0.54118D+00,
     & 0.18460D+01, 0.17592D+01, 0.16767D+01, 0.15983D+01, 0.15236D+01,
     & 0.14524D+01, 0.13837D+01, 0.13186D+01, 0.12569D+01, 0.11983D+01,
     & 0.11427D+01, 0.10898D+01, 0.10396D+01, 0.99196D+00, 0.94671D+00,
     & 0.90377D+00, 0.86301D+00, 0.82441D+00, 0.78798D+00, 0.75331D+00,
     & 0.72033D+00, 0.68895D+00, 0.65910D+00, 0.63071D+00, 0.60375D+00,
     & 0.57852D+00, 0.55444D+00, 0.53144D+00, 0.50949D+00, 0.48855D+00,
     & 0.19554D+01, 0.18452D+01, 0.17417D+01, 0.16445D+01, 0.15533D+01,
     & 0.14677D+01, 0.13874D+01, 0.13119D+01, 0.12409D+01, 0.11740D+01,
     & 0.11112D+01, 0.10524D+01, 0.99718D+00, 0.94510D+00, 0.89597D+00,
     & 0.84963D+00, 0.80593D+00, 0.76494D+00, 0.72680D+00, 0.69067D+00,
     & 0.65646D+00, 0.62407D+00, 0.59343D+00, 0.56446D+00, 0.53712D+00,
     & 0.51195D+00, 0.48802D+00, 0.46526D+00, 0.44363D+00, 0.42308D+00,
     & 0.20489D+01, 0.19149D+01, 0.17899D+01, 0.16732D+01, 0.15643D+01,
     & 0.14627D+01, 0.13681D+01, 0.12797D+01, 0.11973D+01, 0.11205D+01,
     & 0.10489D+01, 0.98298D+00, 0.92196D+00, 0.86485D+00, 0.81143D+00,
     & 0.76151D+00, 0.71490D+00, 0.67185D+00, 0.63271D+00, 0.59590D+00,
     & 0.56128D+00, 0.52877D+00, 0.49825D+00, 0.46964D+00, 0.44294D+00,
     & 0.41907D+00, 0.39649D+00, 0.37515D+00, 0.35498D+00, 0.33594D+00,
     & 0.21643D+01, 0.19663D+01, 0.17864D+01, 0.16233D+01, 0.14759D+01,
     & 0.13440D+01, 0.12316D+01, 0.11286D+01, 0.10342D+01, 0.94809D+00,
     & 0.86965D+00, 0.80137D+00, 0.74066D+00, 0.68449D+00, 0.63262D+00,
     & 0.58481D+00, 0.54084D+00, 0.50131D+00, 0.46704D+00, 0.43504D+00,
     & 0.40521D+00, 0.37745D+00, 0.35164D+00, 0.32771D+00, 0.30567D+00,
     & 0.28685D+00, 0.26915D+00, 0.25251D+00, 0.23688D+00, 0.22223D+00,
     & 0.16121D+01, 0.14345D+01, 0.12751D+01, 0.11327D+01, 0.10060D+01,
     & 0.89542D+00, 0.80626D+00, 0.72536D+00, 0.65220D+00, 0.58631D+00,
     & 0.52723D+00, 0.47790D+00, 0.43545D+00, 0.39653D+00, 0.36092D+00,
     & 0.32845D+00, 0.29894D+00, 0.27301D+00, 0.25150D+00, 0.23155D+00,
     & 0.21308D+00, 0.19602D+00, 0.18030D+00, 0.16586D+00, 0.15274D+00,
     & 0.14205D+00, 0.13204D+00, 0.12268D+00, 0.11395D+00, 0.10581D+00,
     & 0.10658D+00, 0.93837D-01, 0.82464D-01, 0.72359D-01, 0.63433D-01,
     & 0.55712D-01, 0.49637D-01, 0.44154D-01, 0.39222D-01, 0.34809D-01,
     & 0.30882D-01, 0.27671D-01, 0.24956D-01, 0.22479D-01, 0.20224D-01,
     & 0.18181D-01, 0.16338D-01, 0.14740D-01, 0.13450D-01, 0.12259D-01,
     & 0.11161D-01, 0.10153D-01, 0.92295D-02, 0.83868D-02, 0.76280D-02,
     & 0.70305D-02, 0.64734D-02, 0.59549D-02, 0.54733D-02, 0.50270D-02/

      data ((c_grdl(i,j),j=1,30),i=1,10)/
     & 0.48607D-02, 0.48645D-02, 0.48678D-02, 0.48708D-02, 0.48733D-02,
     & 0.48756D-02, 0.48776D-02, 0.48794D-02, 0.48809D-02, 0.48823D-02,
     & 0.48835D-02, 0.48846D-02, 0.48855D-02, 0.48863D-02, 0.48871D-02,
     & 0.48877D-02, 0.48883D-02, 0.48888D-02, 0.48892D-02, 0.48896D-02,
     & 0.48900D-02, 0.48903D-02, 0.48906D-02, 0.48908D-02, 0.48911D-02,
     & 0.48912D-02, 0.48914D-02, 0.48916D-02, 0.48917D-02, 0.48918D-02,
     & 0.48502D-02, 0.48547D-02, 0.48588D-02, 0.48623D-02, 0.48654D-02,
     & 0.48681D-02, 0.48705D-02, 0.48726D-02, 0.48745D-02, 0.48762D-02,
     & 0.48776D-02, 0.48789D-02, 0.48800D-02, 0.48810D-02, 0.48819D-02,
     & 0.48827D-02, 0.48833D-02, 0.48840D-02, 0.48845D-02, 0.48850D-02,
     & 0.48854D-02, 0.48858D-02, 0.48861D-02, 0.48864D-02, 0.48866D-02,
     & 0.48869D-02, 0.48871D-02, 0.48873D-02, 0.48874D-02, 0.48876D-02,
     & 0.48374D-02, 0.48430D-02, 0.48478D-02, 0.48521D-02, 0.48559D-02,
     & 0.48591D-02, 0.48620D-02, 0.48646D-02, 0.48668D-02, 0.48688D-02,
     & 0.48705D-02, 0.48721D-02, 0.48734D-02, 0.48746D-02, 0.48757D-02,
     & 0.48766D-02, 0.48774D-02, 0.48782D-02, 0.48788D-02, 0.48794D-02,
     & 0.48799D-02, 0.48803D-02, 0.48807D-02, 0.48811D-02, 0.48814D-02,
     & 0.48817D-02, 0.48819D-02, 0.48821D-02, 0.48823D-02, 0.48825D-02,
     & 0.48219D-02, 0.48287D-02, 0.48346D-02, 0.48398D-02, 0.48443D-02,
     & 0.48483D-02, 0.48518D-02, 0.48549D-02, 0.48576D-02, 0.48599D-02,
     & 0.48620D-02, 0.48639D-02, 0.48655D-02, 0.48670D-02, 0.48682D-02,
     & 0.48693D-02, 0.48703D-02, 0.48712D-02, 0.48720D-02, 0.48727D-02,
     & 0.48733D-02, 0.48738D-02, 0.48743D-02, 0.48747D-02, 0.48751D-02,
     & 0.48754D-02, 0.48757D-02, 0.48760D-02, 0.48762D-02, 0.48764D-02,
     & 0.48031D-02, 0.48113D-02, 0.48185D-02, 0.48248D-02, 0.48303D-02,
     & 0.48351D-02, 0.48394D-02, 0.48431D-02, 0.48464D-02, 0.48492D-02,
     & 0.48518D-02, 0.48540D-02, 0.48560D-02, 0.48577D-02, 0.48593D-02,
     & 0.48606D-02, 0.48618D-02, 0.48629D-02, 0.48638D-02, 0.48646D-02,
     & 0.48653D-02, 0.48660D-02, 0.48666D-02, 0.48671D-02, 0.48675D-02,
     & 0.48679D-02, 0.48682D-02, 0.48686D-02, 0.48688D-02, 0.48691D-02,
     & 0.47800D-02, 0.47901D-02, 0.47989D-02, 0.48066D-02, 0.48133D-02,
     & 0.48192D-02, 0.48243D-02, 0.48289D-02, 0.48328D-02, 0.48363D-02,
     & 0.48394D-02, 0.48421D-02, 0.48445D-02, 0.48466D-02, 0.48484D-02,
     & 0.48501D-02, 0.48515D-02, 0.48528D-02, 0.48539D-02, 0.48549D-02,
     & 0.48558D-02, 0.48565D-02, 0.48572D-02, 0.48578D-02, 0.48584D-02,
     & 0.48589D-02, 0.48593D-02, 0.48597D-02, 0.48600D-02, 0.48603D-02,
     & 0.49173D-02, 0.48860D-02, 0.48356D-02, 0.47843D-02, 0.47925D-02,
     & 0.47997D-02, 0.48060D-02, 0.48115D-02, 0.48164D-02, 0.48206D-02,
     & 0.48243D-02, 0.48276D-02, 0.48305D-02, 0.48331D-02, 0.48353D-02,
     & 0.48373D-02, 0.48390D-02, 0.48406D-02, 0.48419D-02, 0.48431D-02,
     & 0.48442D-02, 0.48451D-02, 0.48460D-02, 0.48467D-02, 0.48474D-02,
     & 0.48479D-02, 0.48485D-02, 0.48489D-02, 0.48493D-02, 0.48497D-02,
     & 0.49647D-02, 0.49483D-02, 0.49290D-02, 0.49056D-02, 0.48757D-02,
     & 0.48274D-02, 0.47836D-02, 0.47903D-02, 0.47963D-02, 0.48014D-02,
     & 0.48060D-02, 0.48100D-02, 0.48135D-02, 0.48166D-02, 0.48194D-02,
     & 0.48218D-02, 0.48239D-02, 0.48258D-02, 0.48274D-02, 0.48289D-02,
     & 0.48302D-02, 0.48313D-02, 0.48323D-02, 0.48332D-02, 0.48340D-02,
     & 0.48347D-02, 0.48353D-02, 0.48359D-02, 0.48364D-02, 0.48368D-02,
     & 0.49912D-02, 0.49822D-02, 0.49712D-02, 0.49583D-02, 0.49436D-02,
     & 0.49269D-02, 0.49077D-02, 0.48850D-02, 0.48557D-02, 0.47986D-02,
     & 0.47836D-02, 0.47885D-02, 0.47928D-02, 0.47966D-02, 0.47999D-02,
     & 0.48029D-02, 0.48055D-02, 0.48078D-02, 0.48098D-02, 0.48116D-02,
     & 0.48132D-02, 0.48145D-02, 0.48158D-02, 0.48169D-02, 0.48178D-02,
     & 0.48187D-02, 0.48194D-02, 0.48201D-02, 0.48207D-02, 0.48212D-02,
     & 0.50019D-02, 0.49994D-02, 0.49945D-02, 0.49878D-02, 0.49795D-02,
     & 0.49700D-02, 0.49594D-02, 0.49479D-02, 0.49354D-02, 0.49221D-02,
     & 0.49077D-02, 0.48920D-02, 0.48743D-02, 0.48534D-02, 0.48246D-02,
     & 0.47798D-02, 0.47830D-02, 0.47858D-02, 0.47882D-02, 0.47904D-02,
     & 0.47923D-02, 0.47940D-02, 0.47955D-02, 0.47969D-02, 0.47981D-02,
     & 0.47991D-02, 0.48000D-02, 0.48008D-02, 0.48015D-02, 0.48022D-02/

      data ((c_grdl(i,j),j=1,30),i=11,20)/
     & 0.49972D-02, 0.50011D-02, 0.50022D-02, 0.50012D-02, 0.49983D-02,
     & 0.49939D-02, 0.49884D-02, 0.49820D-02, 0.49749D-02, 0.49673D-02,
     & 0.49594D-02, 0.49513D-02, 0.49430D-02, 0.49346D-02, 0.49262D-02,
     & 0.49178D-02, 0.49095D-02, 0.49012D-02, 0.48929D-02, 0.48847D-02,
     & 0.48765D-02, 0.48683D-02, 0.48600D-02, 0.48516D-02, 0.48429D-02,
     & 0.48338D-02, 0.48238D-02, 0.48122D-02, 0.47953D-02, 0.47789D-02,
     & 0.53209D-02, 0.52939D-02, 0.52643D-02, 0.49992D-02, 0.50016D-02,
     & 0.50022D-02, 0.50013D-02, 0.49993D-02, 0.49962D-02, 0.49926D-02,
     & 0.49884D-02, 0.49839D-02, 0.49792D-02, 0.49744D-02, 0.49697D-02,
     & 0.49650D-02, 0.49604D-02, 0.49560D-02, 0.49517D-02, 0.49477D-02,
     & 0.49439D-02, 0.49404D-02, 0.49370D-02, 0.49340D-02, 0.49311D-02,
     & 0.49285D-02, 0.49260D-02, 0.49238D-02, 0.49218D-02, 0.49199D-02,
     & 0.53658D-02, 0.53512D-02, 0.53322D-02, 0.53102D-02, 0.52863D-02,
     & 0.52613D-02, 0.49989D-02, 0.50011D-02, 0.50021D-02, 0.50021D-02,
     & 0.50013D-02, 0.50000D-02, 0.49981D-02, 0.49960D-02, 0.49937D-02,
     & 0.49913D-02, 0.49889D-02, 0.49865D-02, 0.49841D-02, 0.49819D-02,
     & 0.49797D-02, 0.49777D-02, 0.49758D-02, 0.49741D-02, 0.49724D-02,
     & 0.49709D-02, 0.49696D-02, 0.49683D-02, 0.49672D-02, 0.49661D-02,
     & 0.53739D-02, 0.53757D-02, 0.53706D-02, 0.53604D-02, 0.53466D-02,
     & 0.53301D-02, 0.53121D-02, 0.52931D-02, 0.52738D-02, 0.52546D-02,
     & 0.49989D-02, 0.50007D-02, 0.50016D-02, 0.50021D-02, 0.50022D-02,
     & 0.50020D-02, 0.50015D-02, 0.50008D-02, 0.50001D-02, 0.49992D-02,
     & 0.49984D-02, 0.49975D-02, 0.49967D-02, 0.49959D-02, 0.49951D-02,
     & 0.49944D-02, 0.49937D-02, 0.49930D-02, 0.49925D-02, 0.49919D-02,
     & 0.53342D-02, 0.53572D-02, 0.53703D-02, 0.53756D-02, 0.53749D-02,
     & 0.53698D-02, 0.53614D-02, 0.53507D-02, 0.53386D-02, 0.53255D-02,
     & 0.53121D-02, 0.52986D-02, 0.52854D-02, 0.52726D-02, 0.52604D-02,
     & 0.49971D-02, 0.49986D-02, 0.49998D-02, 0.50006D-02, 0.50012D-02,
     & 0.50015D-02, 0.50018D-02, 0.50020D-02, 0.50021D-02, 0.50022D-02,
     & 0.50022D-02, 0.50022D-02, 0.50022D-02, 0.50021D-02, 0.50020D-02,
     & 0.52326D-02, 0.52831D-02, 0.53197D-02, 0.53449D-02, 0.53615D-02,
     & 0.53711D-02, 0.53754D-02, 0.53756D-02, 0.53728D-02, 0.53678D-02,
     & 0.53614D-02, 0.53540D-02, 0.53460D-02, 0.53378D-02, 0.53295D-02,
     & 0.53215D-02, 0.53137D-02, 0.53063D-02, 0.52994D-02, 0.52929D-02,
     & 0.52869D-02, 0.52813D-02, 0.52762D-02, 0.52716D-02, 0.52674D-02,
     & 0.52636D-02, 0.52601D-02, 0.52570D-02, 0.52542D-02, 0.49966D-02,
     & 0.50497D-02, 0.51364D-02, 0.52038D-02, 0.52552D-02, 0.52939D-02,
     & 0.53227D-02, 0.53433D-02, 0.53577D-02, 0.53671D-02, 0.53727D-02,
     & 0.53754D-02, 0.53759D-02, 0.53748D-02, 0.53725D-02, 0.53695D-02,
     & 0.53660D-02, 0.53622D-02, 0.53583D-02, 0.53544D-02, 0.53506D-02,
     & 0.53469D-02, 0.53434D-02, 0.53402D-02, 0.53371D-02, 0.53343D-02,
     & 0.53317D-02, 0.53294D-02, 0.53272D-02, 0.53252D-02, 0.53235D-02,
     & 0.47777D-02, 0.49034D-02, 0.50024D-02, 0.50877D-02, 0.51558D-02,
     & 0.52096D-02, 0.52516D-02, 0.52842D-02, 0.53095D-02, 0.53288D-02,
     & 0.53433D-02, 0.53541D-02, 0.53620D-02, 0.53676D-02, 0.53714D-02,
     & 0.53738D-02, 0.53752D-02, 0.53758D-02, 0.53759D-02, 0.53756D-02,
     & 0.53750D-02, 0.53742D-02, 0.53733D-02, 0.53723D-02, 0.53714D-02,
     & 0.53704D-02, 0.53694D-02, 0.53686D-02, 0.53677D-02, 0.53669D-02,
     & 0.47636D-02, 0.45576D-02, 0.47098D-02, 0.48329D-02, 0.49316D-02,
     & 0.50118D-02, 0.50815D-02, 0.51384D-02, 0.51844D-02, 0.52216D-02,
     & 0.52516D-02, 0.52757D-02, 0.52952D-02, 0.53109D-02, 0.53235D-02,
     & 0.53336D-02, 0.53417D-02, 0.53483D-02, 0.53536D-02, 0.53578D-02,
     & 0.53612D-02, 0.53640D-02, 0.53662D-02, 0.53679D-02, 0.53694D-02,
     & 0.53705D-02, 0.53714D-02, 0.53722D-02, 0.53728D-02, 0.53733D-02,
     & 0.51658D-02, 0.50069D-02, 0.46836D-02, 0.44510D-02, 0.46007D-02,
     & 0.47232D-02, 0.48239D-02, 0.49063D-02, 0.49732D-02, 0.50316D-02,
     & 0.50815D-02, 0.51233D-02, 0.51581D-02, 0.51870D-02, 0.52112D-02,
     & 0.52314D-02, 0.52483D-02, 0.52625D-02, 0.52745D-02, 0.52845D-02,
     & 0.52931D-02, 0.53004D-02, 0.53067D-02, 0.53120D-02, 0.53165D-02,
     & 0.53204D-02, 0.53237D-02, 0.53266D-02, 0.53291D-02, 0.53313D-02/

      data ((c_grdl(i,j),j=1,30),i=21,30)/
     & 0.48002D-02, 0.50556D-02, 0.51651D-02, 0.51300D-02, 0.49145D-02,
     & 0.46997D-02, 0.44376D-02, 0.45619D-02, 0.46652D-02, 0.47516D-02,
     & 0.48239D-02, 0.48844D-02, 0.49348D-02, 0.49770D-02, 0.50145D-02,
     & 0.50477D-02, 0.50760D-02, 0.51002D-02, 0.51211D-02, 0.51390D-02,
     & 0.51544D-02, 0.51677D-02, 0.51791D-02, 0.51891D-02, 0.51977D-02,
     & 0.52052D-02, 0.52117D-02, 0.52174D-02, 0.52223D-02, 0.52267D-02,
     & 0.49335D-02, 0.49726D-02, 0.49291D-02, 0.49239D-02, 0.50971D-02,
     & 0.51684D-02, 0.51387D-02, 0.49991D-02, 0.46634D-02, 0.47333D-02,
     & 0.44376D-02, 0.45287D-02, 0.46058D-02, 0.46711D-02, 0.47271D-02,
     & 0.47748D-02, 0.48159D-02, 0.48510D-02, 0.48812D-02, 0.49071D-02,
     & 0.49295D-02, 0.49488D-02, 0.49655D-02, 0.49799D-02, 0.49926D-02,
     & 0.50047D-02, 0.50153D-02, 0.50245D-02, 0.50327D-02, 0.50398D-02,
     & 0.31999D-02, 0.42940D-02, 0.48867D-02, 0.49374D-02, 0.49210D-02,
     & 0.48938D-02, 0.49048D-02, 0.50601D-02, 0.51452D-02, 0.51705D-02,
     & 0.51386D-02, 0.50521D-02, 0.49011D-02, 0.46242D-02, 0.47044D-02,
     & 0.47603D-02, 0.48068D-02, 0.44783D-02, 0.45238D-02, 0.45633D-02,
     & 0.45975D-02, 0.46273D-02, 0.46532D-02, 0.46758D-02, 0.46956D-02,
     & 0.47130D-02, 0.47282D-02, 0.47415D-02, 0.47532D-02, 0.47635D-02,
     & 0.25784D-04, 0.11802D-02, 0.25716D-02, 0.37008D-02, 0.45040D-02,
     & 0.49136D-02, 0.49603D-02, 0.49725D-02, 0.49637D-02, 0.47366D-02,
     & 0.49049D-02, 0.50238D-02, 0.51015D-02, 0.51486D-02, 0.51691D-02,
     & 0.51667D-02, 0.51454D-02, 0.51084D-02, 0.50586D-02, 0.49966D-02,
     & 0.49226D-02, 0.48353D-02, 0.47294D-02, 0.45894D-02, 0.46666D-02,
     & 0.46875D-02, 0.47056D-02, 0.47214D-02, 0.47352D-02, 0.47472D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.37022D-03, 0.15584D-02,
     & 0.26974D-02, 0.36204D-02, 0.43163D-02, 0.47625D-02, 0.49400D-02,
     & 0.49603D-02, 0.49592D-02, 0.49267D-02, 0.49634D-02, 0.48788D-02,
     & 0.47933D-02, 0.48874D-02, 0.49612D-02, 0.50182D-02, 0.50615D-02,
     & 0.50943D-02, 0.51188D-02, 0.51376D-02, 0.51511D-02, 0.51602D-02,
     & 0.51660D-02, 0.51692D-02, 0.51705D-02, 0.51704D-02, 0.51692D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.70083D-03,
     & 0.18550D-02, 0.28947D-02, 0.37309D-02, 0.43564D-02, 0.47612D-02,
     & 0.49397D-02, 0.49683D-02, 0.49341D-02, 0.49650D-02, 0.49542D-02,
     & 0.49545D-02, 0.48292D-02, 0.47928D-02, 0.48704D-02, 0.49331D-02,
     & 0.49832D-02, 0.50230D-02, 0.50546D-02, 0.50795D-02, 0.50994D-02,
     & 0.51151D-02, 0.51278D-02, 0.51380D-02, 0.51460D-02, 0.51522D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.82758D-04,
     & 0.10225D-02, 0.21069D-02, 0.30463D-02, 0.38067D-02, 0.43731D-02,
     & 0.47469D-02, 0.49308D-02, 0.49607D-02, 0.48942D-02, 0.49688D-02,
     & 0.49218D-02, 0.49608D-02, 0.49517D-02, 0.48625D-02, 0.47633D-02,
     & 0.48292D-02, 0.48837D-02, 0.49287D-02, 0.49657D-02, 0.49962D-02,
     & 0.50213D-02, 0.50421D-02, 0.50592D-02, 0.50733D-02, 0.50853D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.29914D-03, 0.13055D-02, 0.23109D-02, 0.31614D-02, 0.38503D-02,
     & 0.43676D-02, 0.47188D-02, 0.49094D-02, 0.49355D-02, 0.49521D-02,
     & 0.49377D-02, 0.49725D-02, 0.49293D-02, 0.49598D-02, 0.49594D-02,
     & 0.49208D-02, 0.47824D-02, 0.47646D-02, 0.48126D-02, 0.48530D-02,
     & 0.48873D-02, 0.49162D-02, 0.49408D-02, 0.49616D-02, 0.49793D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.55445D-03, 0.15411D-02, 0.24653D-02, 0.32368D-02,
     & 0.38638D-02, 0.43404D-02, 0.46751D-02, 0.48744D-02, 0.49316D-02,
     & 0.49663D-02, 0.48794D-02, 0.49495D-02, 0.49725D-02, 0.49203D-02,
     & 0.49510D-02, 0.49635D-02, 0.49573D-02, 0.49311D-02, 0.48757D-02,
     & 0.47188D-02, 0.47553D-02, 0.47865D-02, 0.48133D-02, 0.48364D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.52700D-04, 0.79587D-03, 0.17267D-02, 0.25734D-02,
     & 0.32750D-02, 0.38487D-02, 0.42912D-02, 0.46133D-02, 0.48215D-02,
     & 0.49308D-02, 0.49328D-02, 0.49680D-02, 0.48860D-02, 0.49436D-02,
     & 0.49708D-02, 0.49612D-02, 0.49278D-02, 0.49491D-02, 0.49609D-02,
     & 0.49636D-02, 0.49582D-02, 0.49454D-02, 0.49252D-02, 0.48964D-02/

      data ((c_grdl(i,j),j=1,30),i=31,40)/
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.19512D-03, 0.10020D-02, 0.18634D-02,
     & 0.26382D-02, 0.32781D-02, 0.38057D-02, 0.42193D-02, 0.45312D-02,
     & 0.47480D-02, 0.48822D-02, 0.49406D-02, 0.49417D-02, 0.49683D-02,
     & 0.48905D-02, 0.49197D-02, 0.49540D-02, 0.49708D-02, 0.49694D-02,
     & 0.49269D-02, 0.49291D-02, 0.49433D-02, 0.49532D-02, 0.49597D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.36103D-03, 0.11628D-02,
     & 0.19548D-02, 0.26629D-02, 0.32479D-02, 0.37353D-02, 0.41239D-02,
     & 0.44264D-02, 0.46497D-02, 0.48029D-02, 0.48984D-02, 0.49407D-02,
     & 0.49305D-02, 0.49640D-02, 0.49628D-02, 0.48713D-02, 0.49105D-02,
     & 0.49387D-02, 0.49576D-02, 0.49686D-02, 0.49726D-02, 0.49698D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.10275D-04, 0.51310D-03,
     & 0.12770D-02, 0.20030D-02, 0.26500D-02, 0.31858D-02, 0.36373D-02,
     & 0.40048D-02, 0.42968D-02, 0.45233D-02, 0.46917D-02, 0.48102D-02,
     & 0.48889D-02, 0.49340D-02, 0.49237D-02, 0.49381D-02, 0.49617D-02,
     & 0.49682D-02, 0.49555D-02, 0.48899D-02, 0.48923D-02, 0.49132D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.68834D-04,
     & 0.63325D-03, 0.13460D-02, 0.20093D-02, 0.26014D-02, 0.30926D-02,
     & 0.35129D-02, 0.38601D-02, 0.41410D-02, 0.43674D-02, 0.45450D-02,
     & 0.46806D-02, 0.47809D-02, 0.48534D-02, 0.49022D-02, 0.49330D-02,
     & 0.49393D-02, 0.49125D-02, 0.49376D-02, 0.49544D-02, 0.49643D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.14238D-03, 0.71457D-03, 0.13716D-02, 0.19760D-02, 0.25185D-02,
     & 0.29727D-02, 0.33615D-02, 0.36880D-02, 0.39594D-02, 0.41813D-02,
     & 0.43629D-02, 0.45087D-02, 0.46243D-02, 0.47146D-02, 0.47839D-02,
     & 0.48370D-02, 0.48767D-02, 0.49054D-02, 0.49262D-02, 0.49379D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.20547D-03, 0.75567D-03, 0.13565D-02, 0.19070D-02,
     & 0.24028D-02, 0.28246D-02, 0.31820D-02, 0.34900D-02, 0.37495D-02,
     & 0.39664D-02, 0.41464D-02, 0.42967D-02, 0.44207D-02, 0.45224D-02,
     & 0.46055D-02, 0.46730D-02, 0.47275D-02, 0.47716D-02, 0.48070D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.24559D-03, 0.75754D-03, 0.13032D-02,
     & 0.18044D-02, 0.22552D-02, 0.26478D-02, 0.29782D-02, 0.32656D-02,
     & 0.35117D-02, 0.37213D-02, 0.38990D-02, 0.40482D-02, 0.41748D-02,
     & 0.42820D-02, 0.43724D-02, 0.44485D-02, 0.45125D-02, 0.45664D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.22099D-05, 0.25811D-03, 0.72279D-03,
     & 0.12152D-02, 0.16703D-02, 0.20775D-02, 0.24409D-02, 0.27519D-02,
     & 0.30152D-02, 0.32477D-02, 0.34478D-02, 0.36188D-02, 0.37668D-02,
     & 0.38931D-02, 0.40008D-02, 0.40927D-02, 0.41726D-02, 0.42411D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.55726D-05, 0.24332D-03,
     & 0.65519D-03, 0.10951D-02, 0.15065D-02, 0.18744D-02, 0.22060D-02,
     & 0.24969D-02, 0.27467D-02, 0.29601D-02, 0.31468D-02, 0.33116D-02,
     & 0.34535D-02, 0.35758D-02, 0.36828D-02, 0.37757D-02, 0.38559D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.47558D-05,
     & 0.20498D-03, 0.55966D-03, 0.94727D-03, 0.13164D-02, 0.16505D-02,
     & 0.19467D-02, 0.22147D-02, 0.24494D-02, 0.26527D-02, 0.28274D-02,
     & 0.29787D-02, 0.31117D-02, 0.32303D-02, 0.33336D-02, 0.34234D-02/

      data ((c_grdl(i,j),j=1,30),i=41,50)/
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.10423D-05, 0.14985D-03, 0.44265D-03, 0.77652D-03, 0.11034D-02,
     & 0.14037D-02, 0.16729D-02, 0.19112D-02, 0.21263D-02, 0.23169D-02,
     & 0.24832D-02, 0.26282D-02, 0.27539D-02, 0.28632D-02, 0.29587D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.87856D-04, 0.31363D-03, 0.59130D-03,
     & 0.87329D-03, 0.11391D-02, 0.13809D-02, 0.15974D-02, 0.17891D-02,
     & 0.19591D-02, 0.21130D-02, 0.22492D-02, 0.23688D-02, 0.24736D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.32502D-04, 0.18580D-03,
     & 0.40159D-03, 0.63517D-03, 0.86331D-03, 0.10761D-02, 0.12690D-02,
     & 0.14419D-02, 0.15966D-02, 0.17332D-02, 0.18538D-02, 0.19615D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.14558D-05,
     & 0.76816D-04, 0.22425D-03, 0.40299D-03, 0.58854D-03, 0.76749D-03,
     & 0.93473D-03, 0.10872D-02, 0.12245D-02, 0.13473D-02, 0.14563D-02,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.94609D-05, 0.82458D-04, 0.19844D-03, 0.33360D-03,
     & 0.47330D-03, 0.60894D-03, 0.73611D-03, 0.85344D-03, 0.96020D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.53979D-05, 0.51954D-04,
     & 0.12852D-03, 0.22000D-03, 0.31679D-03, 0.41293D-03, 0.50489D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.11972D-04, 0.47865D-04, 0.97661D-04, 0.15445D-03,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.88314D-06,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00,
     & 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00, 0.00000D+00/


      DO I=1,50
        DO J=1,30
          UDS_GRD(I,J) = UDS_GRDL(I,J)
          G_GRD(I,J)   = G_GRDL(I,J)
          C_GRD(I,J)   = C_GRDL(I,J)
        ENDDO
      ENDDO

      RETURN
      END
*CMZ :  4.41/00 13/12/94  10.51.18  by  Hannes Jung
*-- Author :
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
      SUBROUTINE DJGEVT
C
C---->
C     PERFORM FRAGMENTATION
C---->
      RETURN
      END
*CMZ :  2.08/04 21/12/99  11.08.29  by  Hannes Jung
*CMZ :  4.41/00 13/12/94  10.51.18  by  Hannes Jung
*-- Author :
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
      SUBROUTINE DJGVAR(ICHNN,X,Y,Q2)
C---
C   TRANSFER VARIABLES FROM HERACLES TO LEPTO OR OTHER ROUTINE
C   FOR FRAGMENTATION
C---
C
      IMPLICIT DOUBLE PRECISION (A-H,M,O-Z)
      COMMON /HSELAB/ SP,EELE,PELE,EPRO,PPRO
      COMMON /HSIKP/  S,T,U,SS,TS,US,DKP,DKPS,DKQ,DKQS
      COMMON /HSGSW1/ MEI,MEF,MQI,MQF,MEI2,MEF2,MQI2,MQF2,MPRO,MPRO2
      PARAMETER (NMXHEP=2000)
      COMMON /HEPEVT/ NEVHEP,NHEP,ISTHEP(NMXHEP),IDHEP(NMXHEP),
     &                JMOHEP(2,NMXHEP),JDAHEP(2,NMXHEP),
     &                PHEP(5,NMXHEP),VHKK(4,NMXHEP)
      COMMON /HSRESC/ SSCH,Q2SCH,W2SCH,XSCH,YSCH
     &               ,SLIX,SLIY,SLIZ,SLIE,SLIM
     &               ,SLFX,SLFY,SLFZ,SLFE,SLFM

C---DECLARATIONS FOR LEPTO
C---->
C   TRANSER OF KINEMATICAL VARIABLES
C---->
      B=X
      RETURN
      END
*CMZ :  2.06/39 16/07/98  11.38.10  by  Hannes Jung
*CMZ :  4.41/00 10/10/97  08.39.21  by  Hannes Jung
*-- Author :
C######################################################################
C
C   Various routines to give structure function parametrizations.
C   All but LNSTRF can be used separately without initialization.
C
C ********************************************************************

      SUBROUTINE LNSTRF(X,Q2,XPQ)

C...Structure function per nucleon for a proton/neutron mixture
C...according to defined nucleus.

      DIMENSION XPQ(-6:6)

      CALL PYSTFU(2212,X,Q2,XPQ)

      RETURN
      END
*CMZ :  6.12/02 22/03/95  12.29.13  by  Martin Hampel
*CMZ :  6.00/00 10/05/94  13.50.16  by  Martin Hampel
*-- Author :
C%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
ck DJlepto6vh:
Ck 14/04/93 routines from LEPTO6.1 used by DJANGO6 but unmodified:

      SUBROUTINE LTIMEX(TIME)
C...Interface routine to transfer a call to some machine-dependent
C...routine to get the execution time used since job started.
C...Nice, but not necessary information. Can also be called by user.

      TIME=0.
C...Use of CERN library routine Z007, replace/delete if not available.
ck      CALL TIMEX(TIME)
C-MH activated...
      CALL TIMEX(TIME)
      RETURN
      END
*CMZ :  4.41/00 10/10/97  08.32.48  by  Hannes Jung
*-- Author :
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
      SUBROUTINE HSWCUT(W,IQF,IQFR,IFAIL)
      IMPLICIT DOUBLE PRECISION (A-H,M,O-Z)
C
      COMMON /HSCUTS/ XMIN,XMAX,Q2MIN,Q2MAX,YMIN,YMAX,WMIN,GMIN
      IFAIL=0
C...Check if energy in jet system is enough for fragmentation.
C-----> INSERT CONDITION
C
      RETURN
      END
*CMZ :  2.08/04 21/12/99  11.10.39  by  Hannes Jung
*CMZ :  2.08/02 04/11/99  16.39.09  by  Hannes Jung
*CMZ :  2.08/00 15/06/99  17.23.30  by  Hannes Jung
*CMZ :  2.06/39 16/07/98  10.57.27  by  Hannes Jung
*-- Author :    Hannes Jung   15/03/95
      SUBROUTINE HERACL(SIGMA,ERROR,ISTEP)
C
C***********************************************************************
C
C
C                     H E R A C L E S
C
C
C     EVENT GENERATOR FOR DEEP-INELASTIC E-P SCATTERING
C     INCLUDING RADIATIVE CORRECTIONS
C
C***********************************************************************
C
C     AUTHORS:
C              H. SPIESBERGER, A. KWIATKOWSKI
C                               II. INSTITUT FUER THEORETISCHE PHYSIK,
C                               UNIVERSITAET HAMBURG
C                               FRG
C
C              H.-J.MOEHRING
C                               SEKTION PHYSIK
C                               UNIVERSITAET LEIPZIG
C                               FRG
C
C
C     VERSION 4.6.1,  November 1997
C
C***********************************************************************
C
      IMPLICIT DOUBLE PRECISION (A-H,M,O-Z)
      EXTERNAL HSNCG1,HSNCG2,HSTSK1,HSTSK2,HSK1TS,HSK1K3
      EXTERNAL HSCCG1,HSCCG2,HSCCKL,HSCCQI,HSCCQF
      EXTERNAL HSELG1,HSELG2,HSELK1,HSELK2,HSELCO
      CHARACTER*19 FNAME,FNAMET
      PARAMETER (NCHN2=1,NCHC2=2,NCHE2=3)
      PARAMETER (NCHN31=6,NCHN32=7,NCHN33=8,NCHN34=9)
      PARAMETER (NCHC31=12,NCHC32=13,NCHC33=14)
      PARAMETER (NCHE31=15,NCHE32=16,NCHE33=17)
      COMMON /HSUNTS/ LUNTES,LUNDAT,LUNIN,LUNOUT,LUNRND
      COMMON /HSOPTN/ INT2(5),INT3(15),ISAM2(5),ISAM3(15),
     +                IOPLOT,IPRINT,ICUT
      COMMON /HSGSW/  SW,CW,SW2,CW2
     +              ,MW,MZ,MH,ME,MMY,MTAU,MU,MD,MS,MC,MB,MT
     +              ,MW2,MZ2,MH2,ME2,MMY2,MTAU2,MU2,MD2,MS2,MC2,MB2,MT2
      COMMON /HSELAB/ SPP,EELE,PELE,EPRO,PPRO
      COMMON /HSCUTS/ XMIN,XMAX,Q2MIN,Q2MAX,YMIN,YMAX,WMIN,GMIN
      COMMON /HSTCUT/ THEMIN,CTHMIN,CTHCON
      COMMON /HSPCUT/ PTMIN,PTXM0
      COMMON /HSISGM/ TCUTQ,TCUTQS
      COMMON /HSPARL/ LPAR(20),LPARIN(12),IPART
      COMMON /HSPDFO/ IPDFOP,IFLOPT,LQCD,LTM,LHT
      COMMON /HSELEP/ IDIPOL
      COMMON /HSNUCL/ HNA,HNZ
      COMMON /HSPARM/ POLARI,LLEPT,LQUA
      COMMON /HSWGTC/ IWEIGS
      COMMON /HSONLY/ IHSONL
C---
      PARAMETER(NDIM2=2,NBIN2=50)
      PARAMETER(NREG2N=2500)
C---                     NREG2N=NBIN2**NDIM2
      LOGICAL LGLO2,LLOC2
      COMMON /HSSNC2/ SIG2,SIG2E,T2GGMA,T2GMAX(NREG2N),
     +                XX2(50,2),
     +                FFGO2,DNCG2,FFLO2,DNCL2,GOLD2,
     +                NM2(NREG2N),NDO2,
     +                NTOT2,NCAL2,NCA12,NCA22,IBIM2,JCOR2,
     +                LGLO2,LLOC2
      PARAMETER(NREG2C=2500)
C---                     NREG2C=NBIN2**NDIM2
      LOGICAL LGLO2C,LLOC2C
      COMMON /HSSCC2/ SIG2C,SIG2EC,T2GMAC,T2MAXC(NREG2C),
     +                XX2C(50,2),
     +                FFGO2C,DNCG2C,FFLO2C,DNCL2C,GOLD2C,
     +                NM2C(NREG2C),NDO2C,
     +                NTOT2C,NCAL2C,NCA12C,NCA22C,IBIM2C,JCOR2C,
     +                LGLO2C,LLOC2C
      PARAMETER(NREG2E=50)
      PARAMETER(NDIM1=1)
C---                     NREG2E=NBIN2**NDIM1
      LOGICAL LGLO2E,LLOC2E
      COMMON /HSSEL2/ SIG2L,SIG2EE,T2GMAE,T2MAXE(NREG2E),
     +                XX2E(50,1),
     +                FFGO2E,DNCG2E,FFLO2E,DNCL2E,GOLD2E,
     +                NM2E(NREG2E),NDO2E,
     +                NTOT2E,NCAL2E,NCA12E,NCA22E,IBIM2E,JCOR2E,
     +                LGLO2E,LLOC2E
      PARAMETER(NDIM31=5,NBIN31=6,NREG31=7776)
C---                     NREG31=NBIN31**NDIM31
      LOGICAL LGLO31,LLOC31
      COMMON /HSSN31/ SIG31,SIG31E,T31GMA,T31MAX(NREG31),
     +                XX31(50,NDIM31),
     +                FFGO31,DNCG31,FFLO31,DNCL31,GOLD31,
     +                SI31,SI2N31,SWGT31,SCHI31,IT31,
     +                NM31(NREG31),NDO31,
     +                NTOT31,NCAL31,NCA131,NCA231,IBIM31,JCOR31,
     +                LGLO31,LLOC31
      PARAMETER(NDIM32=5,NBIN32=6,NREG32=7776)
C---                     NREG32=NBIN32**NDIM32
      LOGICAL LGLO32,LLOC32
      COMMON /HSSN32/ SIG32,SIG32E,T32GMA,T32MAX(NREG32),
     +                XX32(50,NDIM32),
     +                FFGO32,DNCG32,FFLO32,DNCL32,GOLD32,
     +                SI32,SI2N32,SWGT32,SCHI32,IT32,
     +                NM32(NREG32),NDO32,
     +                NTOT32,NCAL32,NCA132,NCA232,IBIM32,JCOR32,
     +                LGLO32,LLOC32
      PARAMETER(NDIM33=5,NBIN33=6,NREG33=7776)
C---                     NREG33=NBIN33**NDIM33
      LOGICAL LGLO33,LLOC33
      COMMON /HSSN33/ SIG33,SIG33E,T33GMA,T33MAX(NREG33),
     +                XX33(50,NDIM33),
     +                FFGO33,DNCG33,FFLO33,DNCL33,GOLD33,
     +                SI33,SI2N33,SWGT33,SCHI33,IT33,
     +                NM33(NREG33),NDO33,
     +                NTOT33,NCAL33,NCA133,NCA233,IBIM33,JCOR33,
     +                LGLO33,LLOC33
      PARAMETER(NDIM34=5,NBIN34=6,NREG34=7776)
C---                     NREG34=NBIN34**NDIM34
      LOGICAL LGLO34,LLOC34
      COMMON /HSSN34/ SIG34,SIG34E,T34GMA,T34MAX(NREG34),
     +                XX34(50,NDIM34),
     +                FFGO34,DNCG34,FFLO34,DNCL34,GOLD34,
     +                SI34,SI2N34,SWGT34,SCHI34,IT34,
     +                NM34(NREG34),NDO34,
     +                NTOT34,NCAL34,NCA134,NCA234,IBIM34,JCOR34,
     +                LGLO34,LLOC34
      PARAMETER(NDM3CC=5)
      PARAMETER(NBN31C=6,NRG31C=7776)
C---                     NRG31C=NBN31C**NDM3CC
      LOGICAL LGL31C,LLC31C
      COMMON /HSSC31/ SIG31C,SG31EC,T31GMC,T31MXC(NRG31C),
     +                XX31C(50,5),
     +                FFG31C,DNG31C,FFL31C,DNL31C,GLD31C,
     +                SI31C,S2N31C,SWT31C,SCH31C,IT31C,
     +                NM31C(NRG31C),NDO31C,
     +                NTT31C,NCL31C,NC131C,NC231C,IBM31C,JCR31C,
     +                LGL31C,LLC31C
      PARAMETER(NBN32C=6,NRG32C=7776)
C---                     NRG32C=NBN32C**NDM3CC
      LOGICAL LGL32C,LLC32C
      COMMON /HSSC32/ SIG32C,SG32EC,T32GMC,T32MXC(NRG32C),
     +                XX32C(50,5),
     +                FFG32C,DNG32C,FFL32C,DNL32C,GLD32C,
     +                SI32C,S2N32C,SWT32C,SCH32C,IT32C,
     +                NM32C(NRG32C),NDO32C,
     +                NTT32C,NCL32C,NC132C,NC232C,IBM32C,JCR32C,
     +                LGL32C,LLC32C
      PARAMETER(NBN33C=6,NRG33C=7776)
C---                     NRG33C=NBN33C**NDM3CC
      LOGICAL LGL33C,LLC33C
      COMMON /HSSC33/ SIG33C,SG33EC,T33GMC,T33MXC(NRG33C),
     +                XX33C(50,5),
     +                FFG33C,DNG33C,FFL33C,DNL33C,GLD33C,
     +                SI33C,S2N33C,SWT33C,SCH33C,IT33C,
     +                NM33C(NRG33C),NDO33C,
     +                NTT33C,NCL33C,NC133C,NC233C,IBM33C,JCR33C,
     +                LGL33C,LLC33C
      PARAMETER(NDM3EL=4)
      PARAMETER(NBN31E=8,NRG31E=4096)
C---                     NRG31E=NBN31E**NDM3EL
      LOGICAL LGL31E,LLC31E
      COMMON /HSSE31/ SIG31L,SG31EE,T31GME,T31MXE(NRG31E),
     +                XX31E(50,4),
     +                FFG31E,DNG31E,FFL31E,DNL31E,GLD31E,
     +                SI31E,S2N31E,SWT31E,SCH31E,IT31E,
     +                NM31E(NRG31E),NDO31E,
     +                NTT31E,NCL31E,NC131E,NC231E,IBM31E,JCR31E,
     +                LGL31E,LLC31E
      PARAMETER(NBN32E=8,NRG32E=4096)
C---                     NRG32E=NBN32E**NDM3EL
      LOGICAL LGL32E,LLC32E
      COMMON /HSSE32/ SIG32L,SG32EE,T32GME,T32MXE(NRG32E),
     +                XX32E(50,4),
     +                FFG32E,DNG32E,FFL32E,DNL32E,GLD32E,
     +                SI32E,S2N32E,SWT32E,SCH32E,IT32E,
     +                NM32E(NRG32E),NDO32E,
     +                NTT32E,NCL32E,NC132E,NC232E,IBM32E,JCR32E,
     +                LGL32E,LLC32E
      PARAMETER(NBN33E=8,NRG33E=4096)
C---                     NRG33E=NBN33E**NDM3EL
      LOGICAL LGL33E,LLC33E
      COMMON /HSSE33/ SIG33L,SG33EE,T33GME,T33MXE(NRG33E),
     +                XX33E(50,4),
     +                FFG33E,DNG33E,FFL33E,DNL33E,GLD33E,
     +                SI33E,S2N33E,SWT33E,SCH33E,IT33E,
     +                NM33E(NRG33E),NDO33E,
     +                NTT33E,NCL33E,NC133E,NC233E,IBM33E,JCR33E,
     +                LGL33E,LLC33E
C-------------------------
      CHARACTER*45 CHNAME
      COMMON /HSNAMC/ CHNAME(20)
      COMMON /HSNUME/ SIGTOT,SIGTRR,SIGG(20),SIGGRR(20),NEVENT,NEVE(20)
      COMMON /HSVGLP/ NPOVEG,NUMINT,NPHYP
      COMMON /HSRDIO/ ISDINP,ISDOUT
      COMMON /VGRES/  S1,S2,S3,S4
      COMMON /HSIRCT/ DELEPS,DELTA,EGMIN,IOPEGM
      REAL*4          PYSTOP,PYSLAM
      COMMON /HYSTFU/ PYSTOP,PYSLAM,NPYMOD,NPYMAX,NPYMIN
      COMMON /HSALFS/ PAR111,PAR112,PARL11,PARL19,MST111,MST115
      REAL*4          PAR111,PAR112,PARL11,PARL19
      INTEGER         MST111,MST115
      CHARACTER*80 TITLE
      CHARACTER*10 CODE,CODEWD
      DIMENSION CODE(40)
      DIMENSION UIO(97)
      DIMENSION INT2C(5),ISAM2C(5),INT3C(15),ISAM3C(15)
C
CHJU RAPGAP COMMONS
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEEP,RGPYPARS.
      INTEGER IPYPAR
      PARAMETER (IPYPAR=200)
      REAL PARP
      INTEGER MSTP
      COMMON/PYPARS/MSTP(IPYPAR),PARP(IPYPAR)
C      SAVE

*KEEP,RGDISDIF.
      INTEGER IDIR,IDISDIF
      COMMON/DISDIF/ IDIR,IDISDIF
*KEND.
      INTEGER ISTEP
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEEP,RGPARAS.
      DOUBLE PRECISION PT2CUT,THEMA,THEMI,Q2START,W_Q2,OMEG2
      INTEGER IRUNA,IQ2,IRUNAEM
      INTEGER IPRO
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2
      DOUBLE PRECISION SCALFA
      COMMON/SCALF/ SCALFA
      COMMON/PTCUT/ PT2CUT(100)
      COMMON/ELECT/ THEMA,THEMI
      REAL ULALPS,ULALEM
      EXTERNAL ULALPS,ULALEM
C     SAVE

*KEEP,RGLUDAT1.
      REAL PARU,PARJ
      INTEGER MSTU,MSTJ
      COMMON/LUDAT1/MSTU(200),PARU(200),MSTJ(200),PARJ(200)
C      SAVE

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEND.
      DOUBLE PRECISION ME,MP
CHJU
C
C-------------------------------
C---INITIALIZE DEFAULTS NOT YET INITIALIZED IN BLOCK DATA
C---AND SET STARTING VALUES FOR VARIOUS COUNTERS
      DATA FNAME /' HERACLES DATA FILE'/
      DATA INT2C,ISAM2C,INT3C,ISAM3C /40*0/
      DATA CODE/
     +'TITLE     ','EL-BEAM   ','PR-BEAM   ','KINEM-CUTS','EGAM-MIN  ',
     +'INT-OPT-NC','INT-OPT-CC','INT-POINTS','HYP-CUBES ','GSW-PARAM ',
     +'STRUCTFUNC','NFLAVORS  ','SAM-OPT-NC','SAM-OPT-CC','RNDM-SEEDS',
     +'GSW-MASS  ','THMIN-QRAD','FLONG     ','ALFAS     ','          ',
     +'EP-DIPOLE ','NUCLEUS   ','          ','          ','          ',
     +'THETA-CUT ','PT-CUT    ','          ','          ','          ',
     +'WEIGHTS   ','          ','          ','          ','          ',
     +'INT-ONLY  ','TEST-OPT  ','IOUNITS   ','START     ','STOP      '/
      DATA TITLE/' '/
C
C---ACCURACY FOR INTEGRATING THE NON-RADIATIVE CONTRIBUTION
      DATA EPSO /1D-4/
C
C---DEFINE VEGAS PARAMETERS
      DATA ACCVEG,IPRVEG,IGRVEG   /1D-5,    3,     1/
      DATA NPOIN /20/
      DATA FF,PDX /2*1D0/
      DATA IWEIGR/0D0/
C
c      write(6,*) ' HERACL: SIGMA,ERROR,ISTEP ',SIGMA,ERROR,ISTEP
      IF(ISTEP.EQ.1) THEN

      ELSEIF(ISTEP.EQ.2) THEN
         GOTO 150
      ELSEIF(ISTEP.EQ.3) THEN
         GOTO 160
      ELSE
         write(6,*) ' HERACL: ISTEP not implemented. ISTEP = ',ISTEP
      ENDIF
C
      test = hsrndm()

C
C---PRINT THE TITLE
C
      WRITE(LUNOUT,10000)
10000 FORMAT(1x,/
     +'**************************************************',
     +'*****************************',
     +//,10X,'                         HERACLES '
     +//,10X,'     Event generator for deep-inelastic e-P collisions '
     + /,10X,'              including radiative corrections  '
     +//,10X,'                 VERSION 4.6.1, 29.04.1998 '//
     +//,10X,'                      H. Spiesberger '//
     +//,10X,'                    called from RAPGAP     '//
     +'**************************************************',
     +'*****************************'//,
     +//,10X,'          make sure you have linked HERACLES 4.6.1 '//,
     +' **************************************************',
     +'****************************',//)
C***********************************************************************
C               DEFINES THE PROPERTIES OF THE ELECTRON BEAM
C
C     EELE    =  ENERGY OF THE ELECTRON BEAM
C     POLARI  =  DEGREE OF BEAM POLARIZATION
C     LLEPT   =  -1  ELECTRON BEAM
C             =  +1  POSITRON BEAM
C***********************************************************************
      EELE = DBLE(DSQRT(PLEPIN**2+PBEAM(1,5)**2))
      LLEPT = -ISIGN(1,KE)
c      write(6,*) ' electron ',EELE,LLEPT
C***********************************************************************
C               CONTROL CARD: CODEWD = PR-BEAM
C               DEFINES THE PROPERTIES OF THE PROTON BEAM
C
C     EPRO    =  ENERGY OF THE PROTON BEAM
C***********************************************************************
      EPRO = DBLE(DSQRT(PPIN**2+PBEAM(2,5)**2))
C
      ME =P(1,5)
      MP =P(2,5)
      W02=(1.D0 + MP)**2
      W12=W02-MP*MP
      YMAX=SSS+W12+DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
      YMAX=YMAX/(2.D0*(SSS+ME*ME))
      YMIN=SSS+W12-DSQRT((SSS-W12)**2 - 4.D0*ME*ME*W12)
      YMIN=YMIN/(2.D0*(SSS+ME*ME))
      IF(YMI.NE.0.)   YMIN = DBLE(YMI)
      IF(YMA.NE.0.)   YMAX = DBLE(YMA)
      IF(QMI.NE.0.)   Q2MIN = DBLE(QMI)
      IF(QMA.NE.0.)   Q2MAX = DBLE(QMA)
C***********************************************************************
C               CONTROL CARD: CODEWD = THETA-CUT
C
C    CUT ON MINIMUM ELECTRON SCATTERING ANGLE (MASSES NEGLECTED)
C
C***********************************************************************
      IF(THEMA.NE.0.0) then
         THEMIN = (180. - THEMA)*3.1415927D0/180.D0
c         WRITE(6,'(5X,A,F12.4)') ' THETA-MIN =  ', THEMIN
      endif
      XMINN = Q2MIN/YMAX/4.D0/EELE/EPRO
      IF(IDIR.EQ.0) THEN
         XMAXX = DMIN1(1.D0 - XF,XMAX)
      ELSE
         XMAXX=DMIN1(XMAX,Q2MAX/YMIN/4.D0/EELE/EPRO)
      ENDIF
      XMIN=DMAX1(XMIN,XMINN)
      XMAX = XMAXX
      IF(EGMIN.GT.0D0) IOPEGM=1
C
C
C***********************************************************************
C               CONTROL CARD: CODEWD = HYP-CUBES
C
C       NUMINT =  NUMBER OF INTERVALS PER AXIS IN SUBDIVISION
C                 OF THE INTEGRATION REGION
C                 NOT ACTIVATED SO FAR
C                 (PREDEFINED FOR EACH INDIVIDUAL CONTRIBUTION
C                 IN PARAMETER STATEMENTS)
C
C       NPHYP  =  NUMBER OF POINTS TO BE SAMPLED PER HYPERCUBE
C                 FOR ESTIMATION OF THE LOCAL MAXIMA
C***********************************************************************
      IF(NPHYP.LT.3) NPHYP=3
c      WRITE(LUNOUT,'(5X,A/5X,4I6)') ' NUMINT, NPHYP', NUMINT, NPHYP
      NPOIN=NPHYP
C
      LPARIN(12)=1
C---REDEFINITION FOR INTERNAL USE
      LPAR(1)=1
      LPAR(2)=LPARIN(2)
      LPAR(3)=LPARIN(3)
      LPAR(4)=LPARIN(1)
      LPAR(7)=LPARIN(7)
      LPAR(8)=LPARIN(8)
      LPAR(9)=LPARIN(9)
      LPAR(10)=LPARIN(10)
      LPAR(11)=0
      IF(LPARIN(4).EQ.1 .OR. LPARIN(5).EQ.1 .OR. LPARIN(6).EQ.1)
     +   LPAR(11)=1
      LPAR(12)=LPARIN(4)
      LPAR(13)=LPARIN(5)
      LPAR(14)=LPARIN(6)
      LPAR(15)=LPARIN(11)
      LPAR(16)=LPARIN(11)
      LPAR(17)=LPARIN(12)
C
C***********************************************************************
C               CONTROL CARD: CODEWD = STRUCTFUNC
C
C               DEFINES THE PARAMETRIZATION OF PARTON DENSITIES
C               OR STRUCTURE FUNCTIONS
C               APPLIED IN THE ACTUAL CALCULATION
C
C***********************************************************************
      ISTRFC = MSTP(51)
      IF(MSTP(51).GT.1000000) THEN
         ISTRFC = MSTP(51) - 1000000 + 100000 + 10000
      ENDIF
      ILQMOD=ISTRFC/100000
      ILIB=(ISTRFC-100000*ILQMOD)/10000
      ICODE=MOD(ISTRFC,10000)
      IPDFOP=0
      IF (ILQMOD.LE.1) IPDFOP=1
      LPAR(6)=ISTRFC
      NPYMOD=MOD(ISTRFC,100000)
      IPART=ISTRFC
C
C***********************************************************************
C               CONTROL CARD: CODEWD = NFLAVORS
C***********************************************************************
      NPYMAX=NFLAV
C***********************************************************************
C               CONTROL CARD: CODEWD = THMIN-QRAD
C
C        DEFINES THE ANGULAR CUTS FOR HARD QUARKONIC BREMSSTRAHLUNG
C
C              TCUTQ  :  INITIAL STATE RADIATION
C              TCUTQS :  FINAL STATE RADIATION
C
C***********************************************************************
C
C***********************************************************************
C               CONTROL CARD: CODEWD = FLONG
C
C    INCLUDE THE LONGITUDINAL STRUCTURE FUNCTION (FOR IPART < 1000)
C
C***********************************************************************
C***********************************************************************
C               CONTROL CARD: CODEWD = ALFAS
C
C    DEFINITION OF ALPHA_S IN THE CALCULATION OF THE LONGITUDINAL
C    STRUCTURE FUNCTION
C
C***********************************************************************
      MST111=MSTU(111)
      MST115=MSTU(115)
      PAR111=PARU(111)
      PAR112=PARU(112)
      CALL DIALFS
C
C***********************************************************************
C               CONTROL CARD: CODEWD = INT-ONLY
C
C               PERFORM ONLY INTEGRATION, NO ETIMATION OF MAXIMA
C               IOPLOT < 0: NO CALL TO HSESTM
C               IOPLOT >= 0: CALL TO HSESTM
C***********************************************************************
      IOPLOT = 0
C***********************************************************************
C               CONTROL CARD: CODEWD = TEST-OPT
C
C               DEFINITION OF TEST OPTIONS
C
C     IOPLOT :  OUTPUT OF STANDARD PLOTS USING MODIFIED AXO ROUTINES
C        = 1 :  STANDARD PLOTS
C        = 0 :  NO PLOTS
C
C     IPRINT :  DIFFERENT QUANTITY OF TEST OUTPUT FOR IPRINT GT. 0
C***********************************************************************
      IPRINT = 0
C
C***********************************************************************
C               CONTROL CARD: CODEWD = IOUNITS
C
C               I / O UNITS
C
C     LUNOUT: FOR STANDARD INPUT
C     LUNRND: IN-/OUTPUT FOR RANDOM NUMBER SEED
C     LUNDAT: IN-OUTPUT OF SAMPLING INFORMATION
C
C***********************************************************************
C
      OPEN(LUNDAT,FILE='heracles.dat',STATUS='UNKNOWN',
     + FORM='UNFORMATTED')

C***********************************************************************
C               CONTROL CARD: CODEWD = START
C               STARTS THE SAMPLING OF EVENTS AND STANDARD HISTOGRAM
C               OUTPUT
C
C     NEVENT :  NUMBER OF EVENTS TO BE SAMPLED
C***********************************************************************
      NEVENT=10
c      WRITE(LUNOUT,'(5X,A,I8)') ' NEVENT =',NEVENT
C
      INFOCA=0
      DO 10   I=1,5
         IF(NEVENT.LE.0) ISAM2(I)=0
         IF(INT2(I).GT.0) INFOCA=1
   10 CONTINUE
      DO 20   I=1,15
         IF(NEVENT.LE.0) ISAM3(I)=0
         IF(INT3(I).GT.0) INFOCA=1
   20 CONTINUE
C
C---DO THE NECESSARY INITIALIZATION / PRINT PARAMETERS
      CALL HSPRLG
C
C---CHECK CONSISTENCY OF INPUT DATA FILE
      IF(INFOCA.EQ.1) THEN
         READ(LUNDAT,ERR=30  ,END=30  ,IOSTAT=IOS) FNAMET
         IF(FNAME.EQ.FNAMET) THEN
            READ(LUNDAT,ERR=30  ,END=30  ,IOSTAT=IOS) INT2C,INT3C,
     +      ISAM2C,ISAM3C
            CALL HSDTIN
            GOTO 60
         ENDIF
   30    CONTINUE
         WRITE(LUNOUT,'(/A,I3/A)') ' *** NO STANDARD HERACLES INPUT '
     +   //'FILE ASSIGNED TO UNIT',LUNDAT, ' *** COLD START OF '
     +   //'HERACLES ASSUMED'
         DO 40   I=1,5
            INT2C(I)=0
            ISAM2C(I)=0
   40    CONTINUE
         DO 50   I=1,15
            ISAM3C(I)=0
            INT3C(I)=0
   50    CONTINUE
C
   60    CONTINUE
C
         INTEST=0
         DO 70   I=1,15
            IF(INT3(I).GT.100.AND.INT3C(I).EQ.0) INTEST=1
   70    CONTINUE
         IF(INTEST.EQ.1) THEN
            WRITE(LUNOUT,'(A/A,15I4/A,15I4/A)') ' *** INCONSISTENT '
     +      //'INPUT DATA FOR INTEGRATION (INT3) ***', ' *** INT3(I) : '
     +      ,INT3, ' *** INT3C(I): ',INT3C, ' *** EXECUTION STOPPED ***'
            STOP
         ENDIF
      ENDIF
C
C***********************************************************************
C
C               TEST RUN
C
C***********************************************************************
c
c      call tstrrr
c      stop
c
C
      INFOSA=0
C
C---NEUTRAL CURRENT
C---BORN TERM + SOFT & VIRTUAL CORRECTIONS------------------------------
C
      IF(INT2(1).GE.1) THEN
         WRITE(LUNOUT,'(///,5X,2A)') ' START INTEGRATION FOR ',
     +   CHNAME(1)
C---INTEGRATION
         INCCC=1
         CALL HSINIT(INCCC,EPSO,NBIN2,NDO2,SIG2,SIG2E,XX2)
         WRITE(LUNOUT,'(//A/5X,A/5X,1PE12.4,A,1PE12.4,A)') ' CROSS '
     +   //'SECTION (WITH ERROR ESTIMATE) FOR THE CHANNEL:', CHNAME(1),
     +   SIG2, ' +/- ', SIG2E, '  NB'
         WRITE(LUNTES,'(5X,A,1PD10.1)') ' RELATIVE ACCURACY REQUIRED:',
     +   EPSO
C---LOCAL/GLOBAL MAXIMA FOR THE MODIFIED SAMPLING FUNCTION
         CALL HSESTM(HSNCG2,NCHN2,NDIM2,NPOIN,NDO2,NBIN2, T2GGMA,
     +   T2GMAX,XX2,IBIM2,NREG2N)
C---SET OPTION TO SAVE INFORMATION FROM INTEGRATION ONTO UNIT LUNDAT
         INFOSA=1
         INT2C(1)=1
      ENDIF
C
C---NEUTRAL CURRENT
C---LEPTONIC BREMSSTRAHLUNG: INITIAL STATE------------------------------
      IF(INT3(1).GT.0) THEN
         WRITE(LUNOUT,'(///,5X,2A)') ' START INTEGRATION FOR ',
     +   CHNAME(6)
C---INTEGRATION
         IF(INT3(1).LT.100) THEN
            ITMX31=INT3(1)
            CALL VEGAS(HSTSK1,ACCVEG,NDIM31,NPOVEG,ITMX31,IPRVEG,
     +      IGRVEG, NDO31,IT31,SI31,SI2N31,SWGT31,SCHI31,XX31)
         ELSEIF(INT3(1).LT.200) THEN
            ITMX31=INT3(1) - 100
            CALL VEGAS1(HSTSK1,ACCVEG,NDIM31,NPOVEG,ITMX31,IPRVEG,
     +      IGRVEG, NDO31,IT31,SI31,SI2N31,SWGT31,SCHI31,XX31)
         ELSE
            ITMX31=INT3(1) - 200
            CALL VEGAS2(HSTSK1,ACCVEG,NDIM31,NPOVEG,ITMX31,IPRVEG,
     +      IGRVEG, NDO31,IT31,SI31,SI2N31,SWGT31,SCHI31,XX31)
         ENDIF
         SIG31=S1
         SIG31E=S2
C
C---LOCAL/GLOBAL MAXIMA FOR THE MODIFIED SAMPLING FUNCTION
         CALL HSESTM(HSTSK1,NCHN31,NDIM31,NPOIN,NDO31,NBIN31, T31GMA,
     +   T31MAX,XX31,IBIM31,NREG31)
         INFOSA=1
         INT3C(1)=INT3C(1) + ITMX31
      ENDIF
C
C---NEUTRAL CURRENT
C---LEPTONIC BREMSSTRAHLUNG: FINAL STATE -------------------------------
      IF(INT3(2).GT.0) THEN
         WRITE(LUNOUT,'(///,5X,2A)') ' START INTEGRATION FOR ',
     +   CHNAME(7)
C---INTEGRATION
         IF(INT3(2).LT.100) THEN
            ITMX32=INT3(2)
            CALL VEGAS(HSTSK2,ACCVEG,NDIM32,NPOVEG,ITMX32,IPRVEG,
     +      IGRVEG, NDO32,IT32,SI32,SI2N32,SWGT32,SCHI32,XX32)
         ELSEIF(INT3(2).LT.200) THEN
            ITMX32=INT3(2) - 100
            CALL VEGAS1(HSTSK2,ACCVEG,NDIM32,NPOVEG,ITMX32,IPRVEG,
     +      IGRVEG, NDO32,IT32,SI32,SI2N32,SWGT32,SCHI32,XX32)
         ELSE
            ITMX32=INT3(2) - 200
            CALL VEGAS2(HSTSK2,ACCVEG,NDIM32,NPOVEG,ITMX32,IPRVEG,
     +      IGRVEG, NDO32,IT32,SI32,SI2N32,SWGT32,SCHI32,XX32)
         ENDIF
         SIG32=S1
         SIG32E=S2
C
C---LOCAL/GLOBAL MAXIMA FOR THE MODIFIED SAMPLING FUNCTION
         CALL HSESTM(HSTSK2,NCHN32,NDIM32,NPOIN,NDO32,NBIN32, T32GMA,
     +   T32MAX,XX32,IBIM32,NREG32)
         INFOSA=1
         INT3C(2)=INT3C(2) + ITMX32
      ENDIF
C
C---NEUTRAL CURRENT
C---LEPTONIC BREMSSTRAHLUNG: COMPTON CONTRIBUTION ----------------------
      IF(INT3(3).GT.0) THEN
         WRITE(LUNOUT,'(///,5X,2A)') ' START INTEGRATION FOR ',
     +   CHNAME(8)
C---INTEGRATION
         IF(INT3(3).LT.100) THEN
            ITMX33=INT3(3)
            CALL VEGAS(HSK1TS,ACCVEG,NDIM33,NPOVEG,ITMX33,IPRVEG,
     +      IGRVEG, NDO33,IT33,SI33,SI2N33,SWGT33,SCHI33,XX33)
         ELSEIF(INT3(3).LT.200) THEN
            ITMX33=INT3(3) - 100
            CALL VEGAS1(HSK1TS,ACCVEG,NDIM33,NPOVEG,ITMX33,IPRVEG,
     +      IGRVEG, NDO33,IT33,SI33,SI2N33,SWGT33,SCHI33,XX33)
         ELSE
            ITMX33=INT3(3) - 200
            CALL VEGAS2(HSK1TS,ACCVEG,NDIM33,NPOVEG,ITMX33,IPRVEG,
     +      IGRVEG, NDO33,IT33,SI33,SI2N33,SWGT33,SCHI33,XX33)
         ENDIF
         SIG33=S1
         SIG33E=S2
C
C---LOCAL/GLOBAL MAXIMA FOR THE MODIFIED SAMPLING FUNCTION
         CALL HSESTM(HSK1TS,NCHN33,NDIM33,NPOIN,NDO33,NBIN33, T33GMA,
     +   T33MAX,XX33,IBIM33,NREG33)
         INFOSA=1
         INT3C(3)=INT3C(3) + ITMX33
      ENDIF
C
C---NEUTRAL CURRENT
C---LEPTONIC BREMSSTRAHLUNG: QUARKONIC RADIATION -----------------------
      IF(INT3(4).GT.0) THEN
         WRITE(LUNOUT,'(///,5X,2A)') ' START INTEGRATION FOR ',
     +   CHNAME(9)
C---INTEGRATION
         IF(INT3(4).LT.100) THEN
            ITMX34=INT3(4)
            CALL VEGAS(HSK1K3,ACCVEG,NDIM34,NPOVEG,ITMX34,IPRVEG,
     +      IGRVEG, NDO34,IT34,SI34,SI2N34,SWGT34,SCHI34,XX34)
         ELSEIF(INT3(4).LT.200) THEN
            ITMX34=INT3(4) - 100
            CALL VEGAS1(HSK1K3,ACCVEG,NDIM31,NPOVEG,ITMX34,IPRVEG,
     +      IGRVEG, NDO34,IT34,SI34,SI2N34,SWGT34,SCHI34,XX34)
         ELSE
            ITMX34=INT3(4) - 200
            CALL VEGAS2(HSK1K3,ACCVEG,NDIM34,NPOVEG,ITMX34,IPRVEG,
     +      IGRVEG, NDO34,IT34,SI34,SI2N34,SWGT34,SCHI34,XX34)
         ENDIF
         SIG34=S1
         SIG34E=S2
C
C---LOCAL/GLOBAL MAXIMA FOR THE MODIFIED SAMPLING FUNCTION
         CALL HSESTM(HSK1K3,NCHN34,NDIM34,NPOIN,NDO34,NBIN34, T34GMA,
     +   T34MAX,XX34,IBIM34,NREG34)
         INFOSA=1
         INT3C(4)=INT3C(4) + ITMX34
      ENDIF
C
C-----------------------------------------------------------------------
C
C---CHARGED CURRENT
C---BORN TERM + SOFT & VIRTUAL CORRECTIONS------------------------------
C
      IF(INT2(2).GE.1) THEN
         WRITE(LUNOUT,'(///,5X,2A)') ' START INTEGRATION FOR ',
     +   CHNAME(2)
C---INTEGRATION
         INCCC=2
         CALL HSINIT(INCCC,EPSO,NBIN2,NDO2C,SIG2C,SIG2EC,XX2C)
         WRITE(LUNOUT,'(//A/5X,A/5X,1PE12.4,A,1PE12.4,A)') ' CROSS '
     +   //'SECTION (WITH ERROR ESTIMATE) FOR THE CHANNEL:', CHNAME(2),
     +   SIG2C, ' +/- ', SIG2EC, '  NB'
         WRITE(LUNTES,'(5X,A,1PD10.1)') ' RELATIVE ACCURACY REQUIRED:',
     +   EPSO
C---LOCAL/GLOBAL MAXIMA FOR THE MODIFIED SAMPLING FUNCTION
         CALL HSESTM(HSCCG2,NCHC2,NDIM2,NPOIN,NDO2C,NBIN2, T2GMAC,
     +   T2MAXC,XX2C,IBIM2C,NREG2C)
C---SET OPTION TO SAVE INFORMATION FROM INTEGRATION ONTO UNIT LUNDAT
         INFOSA=1
         INT2C(2)=1
      ENDIF
C
C---CHARGED CURRENT
C---PHOTON BREMSSTRAHLUNG: KP - CHANNEL-------------------------------
      IF(INT3(7).GT.0) THEN
         WRITE(LUNOUT,'(///,5X,2A)') ' START INTEGRATION FOR ', CHNAME(
     +   12)
C---INTEGRATION
         IF(INT3(7).LT.100) THEN
            ITM31C=INT3(7)
            CALL VEGAS(HSCCKL,ACCVEG,NDM3CC,NPOVEG,ITM31C,IPRVEG,
     +      IGRVEG, NDO31C,IT31C,SI31C,S2N31C,SWT31C,SCH31C,XX31C)
         ELSEIF(INT3(7).LT.200) THEN
            ITM31C=INT3(7) - 100
            CALL VEGAS1(HSCCKL,ACCVEG,NDM3CC,NPOVEG,ITM31C,IPRVEG,
     +      IGRVEG, NDO31C,IT31C,SI31C,S2N31C,SWT31C,SCH31C,XX31C)
         ELSE
            ITM31C=INT3(7) - 200
            CALL VEGAS2(HSCCKL,ACCVEG,NDM3CC,NPOVEG,ITM31C,IPRVEG,
     +      IGRVEG, NDO31C,IT31C,SI31C,S2N31C,SWT31C,SCH31C,XX31C)
         ENDIF
         SIG31C=S1
         SG31EC=S2
C
C---LOCAL/GLOBAL MAXIMA FOR THE MODIFIED SAMPLING FUNCTION
         CALL HSESTM(HSCCKL,NCHC31,NDM3CC,NPOIN,NDO31C,NBN31C, T31GMC,
     +   T31MXC,XX31C,IBM31C,NRG31C)
         INFOSA=1
         INT3C(7)=INT3C(7) + ITM31C
      ENDIF
C
C---CHARGED CURRENT
C---PHOTON BREMSSTRAHLUNG: KQ - CHANNEL-------------------------------
      IF(INT3(8).GT.0) THEN
         WRITE(LUNOUT,'(///,5X,2A)') ' START INTEGRATION FOR ', CHNAME(
     +   13)
C---INTEGRATION
         IF(INT3(8).LT.100) THEN
            ITM32C=INT3(8)
            CALL VEGAS(HSCCQI,ACCVEG,NDM3CC,NPOVEG,ITM32C,IPRVEG,
     +      IGRVEG, NDO32C,IT32C,SI32C,S2N32C,SWT32C,SCH32C,XX32C)
         ELSEIF(INT3(8).LT.200) THEN
            ITM32C=INT3(8) - 100
            CALL VEGAS1(HSCCQI,ACCVEG,NDM3CC,NPOVEG,ITM32C,IPRVEG,
     +      IGRVEG, NDO32C,IT32C,SI32C,S2N32C,SWT32C,SCH32C,XX32C)
         ELSE
            ITM32C=INT3(8) - 200
            CALL VEGAS2(HSCCQI,ACCVEG,NDM3CC,NPOVEG,ITM32C,IPRVEG,
     +      IGRVEG, NDO32C,IT32C,SI32C,S2N32C,SWT32C,SCH32C,XX32C)
         ENDIF
         SIG32C=S1
         SG32EC=S2
C
C---LOCAL/GLOBAL MAXIMA FOR THE MODIFIED SAMPLING FUNCTION
         CALL HSESTM(HSCCQI,NCHC32,NDM3CC,NPOIN,NDO32C,NBN32C, T32GMC,
     +   T32MXC,XX32C,IBM32C,NRG32C)
         INFOSA=1
         INT3C(8)=INT3C(8) + ITM32C
      ENDIF
C
C---CHARGED CURRENT
C---PHOTON BREMSSTRAHLUNG: KQS - CHANNEL------------------------------
      IF(INT3(9).GT.0) THEN
         WRITE(LUNOUT,'(///,5X,2A)') ' START INTEGRATION FOR ', CHNAME(
     +   14)
C---INTEGRATION
         IF(INT3(9).LT.100) THEN
            ITM33C=INT3(9)
            CALL VEGAS(HSCCQF,ACCVEG,NDM3CC,NPOVEG,ITM33C,IPRVEG,
     +      IGRVEG, NDO33C,IT33C,SI33C,S2N33C,SWT33C,SCH33C,XX33C)
         ELSEIF(INT3(9).LT.200) THEN
            ITM33C=INT3(9) - 100
            CALL VEGAS1(HSCCQF,ACCVEG,NDM3CC,NPOVEG,ITM33C,IPRVEG,
     +      IGRVEG, NDO33C,IT33C,SI33C,S2N33C,SWT33C,SCH33C,XX33C)
         ELSE
            ITM33C=INT3(9) - 200
            CALL VEGAS2(HSCCQF,ACCVEG,NDM3CC,NPOVEG,ITM33C,IPRVEG,
     +      IGRVEG, NDO33C,IT33C,SI33C,S2N33C,SWT33C,SCH33C,XX33C)
         ENDIF
         SIG33C=S1
         SG33EC=S2
C
C---LOCAL/GLOBAL MAXIMA FOR THE MODIFIED SAMPLING FUNCTION
         CALL HSESTM(HSCCQF,NCHC33,NDM3CC,NPOIN,NDO33C,NBN33C, T33GMC,
     +   T33MXC,XX33C,IBM33C,NRG33C)
         INFOSA=1
         INT3C(9)=INT3C(9) + ITM33C
      ENDIF
C
C-----------------------------------------------------------------------
C
C---ELASTIC EP SCATTERING
C---BORN TERM + SOFT & VIRTUAL CORRECTIONS------------------------------
C
      IF(INT2(3).GE.1) THEN
         WRITE(LUNOUT,'(///,5X,2A)') ' START INTEGRATION FOR ',
     +   CHNAME(3)
C---INTEGRATION
         CALL HSINIL(HSELG1,EPSO,NBIN2,NDO2E,SIG2L,SIG2EE,XX2E)
         WRITE(LUNOUT,'(//A/5X,A/5X,1PE12.4,A,1PE12.4,A)') ' CROSS '
     +   //'SECTION (WITH ERROR ESTIMATE) FOR THE CHANNEL:', CHNAME(3),
     +   SIG2L, ' +/- ', SIG2EE, '  NB'
         WRITE(LUNTES,'(5X,A,1PD10.1)') ' RELATIVE ACCURACY REQUIRED:',
     +   EPSO
C---LOCAL/GLOBAL MAXIMA FOR THE MODIFIED SAMPLING FUNCTION
         CALL HSESTM(HSELG2,NCHE2,NDIM1,NPOIN,NDO2E,NBIN2, T2GMAE,
     +   T2MAXE,XX2E,IBIM2E,NREG2E)
C---SET OPTION TO SAVE INFORMATION FROM INTEGRATION ONTO UNIT LUNDAT
         INFOSA=1
         INT2C(3)=1
      ENDIF
C
C---ELASTIC TAIL
C---PHOTON BREMSSTRAHLUNG: INITIAL STATE RADIATION -------------------
      IF(INT3(10).GT.0) THEN
         WRITE(LUNOUT,'(///,5X,2A)') ' START INTEGRATION FOR ', CHNAME(
     +   15)
C---INTEGRATION
         IF(INT3(10).LT.100) THEN
            ITM31E=INT3(10)
            CALL VEGAS(HSELK1,ACCVEG,NDM3EL,NPOVEG,ITM31E,IPRVEG,
     +      IGRVEG, NDO31E,IT31E,SI31E,S2N31E,SWT31E,SCH31E,XX31E)
         ELSEIF(INT3(10).LT.200) THEN
            ITM31E=INT3(10) - 100
            CALL VEGAS1(HSELK1,ACCVEG,NDM3EL,NPOVEG,ITM31E,IPRVEG,
     +      IGRVEG, NDO31E,IT31E,SI31E,S2N31E,SWT31E,SCH31E,XX31E)
         ELSE
            ITM31E=INT3(10) - 200
            CALL VEGAS2(HSELK1,ACCVEG,NDM3EL,NPOVEG,ITM31E,IPRVEG,
     +      IGRVEG, NDO31E,IT31E,SI31E,S2N31E,SWT31E,SCH31E,XX31E)
         ENDIF
         SIG31L=S1
         SG31EE=S2
C
C---LOCAL/GLOBAL MAXIMA FOR THE MODIFIED SAMPLING FUNCTION
         CALL HSESTM(HSELK1,NCHE31,NDM3EL,NPOIN,NDO31E,NBN31E, T31GME,
     +   T31MXE,XX31E,IBM31E,NRG31E)
         INFOSA=1
         INT3C(10)=INT3C(10) + ITM31E
      ENDIF
C
C---ELSTIC TAIL
C---PHOTON BREMSSTRAHLUNG: FINAL STATE RADIATOIN ---------------------
      IF(INT3(11).GT.0) THEN
         WRITE(LUNOUT,'(///,5X,2A)') ' START INTEGRATION FOR ', CHNAME(
     +   16)
C---INTEGRATION
         IF(INT3(11).LT.100) THEN
            ITM32E=INT3(11)
            CALL VEGAS(HSELK2,ACCVEG,NDM3EL,NPOVEG,ITM32E,IPRVEG,
     +      IGRVEG, NDO32E,IT32E,SI32E,S2N32E,SWT32E,SCH32E,XX32E)
         ELSEIF(INT3(11).LT.200) THEN
            ITM32E=INT3(11) - 100
            CALL VEGAS1(HSELK2,ACCVEG,NDM3EL,NPOVEG,ITM32E,IPRVEG,
     +      IGRVEG, NDO32E,IT32E,SI32E,S2N32E,SWT32E,SCH32E,XX32E)
         ELSE
            ITM32E=INT3(11) - 200
            CALL VEGAS2(HSELK2,ACCVEG,NDM3EL,NPOVEG,ITM32E,IPRVEG,
     +      IGRVEG, NDO32E,IT32E,SI32E,S2N32E,SWT32E,SCH32E,XX32E)
         ENDIF
         SIG32L=S1
         SG32EE=S2
C
C---LOCAL/GLOBAL MAXIMA FOR THE MODIFIED SAMPLING FUNCTION
         CALL HSESTM(HSELK2,NCHE32,NDM3EL,NPOIN,NDO32E,NBN32E, T32GME,
     +   T32MXE,XX32E,IBM32E,NRG32E)
         INFOSA=1
         INT3C(11)=INT3C(11)+ITM32E
      ENDIF
C
C---ELASTIC TAIL
C---PHOTON BREMSSTRAHLUNG: COMPTON PART ------------------------------
      IF(INT3(12).GT.0) THEN
         WRITE(LUNOUT,'(///,5X,2A)') ' START INTEGRATION FOR ', CHNAME(
     +   17)
C---INTEGRATION
         IF(INT3(12).LT.100) THEN
            ITM33E=INT3(12)
            CALL VEGAS(HSELCO,ACCVEG,NDM3EL,NPOVEG,ITM33E,IPRVEG,
     +      IGRVEG, NDO33E,IT33E,SI33E,S2N33E,SWT33E,SCH33E,XX33E)
         ELSEIF(INT3(12).LT.200) THEN
            ITM33E=INT3(12) - 100
            CALL VEGAS1(HSELCO,ACCVEG,NDM3EL,NPOVEG,ITM33E,IPRVEG,
     +      IGRVEG, NDO33E,IT33E,SI33E,S2N33E,SWT33E,SCH33E,XX33E)
         ELSE
            ITM33E=INT3(12) - 200
            CALL VEGAS2(HSELCO,ACCVEG,NDM3EL,NPOVEG,ITM33E,IPRVEG,
     +      IGRVEG, NDO33E,IT33E,SI33E,S2N33E,SWT33E,SCH33E,XX33E)
         ENDIF
         SIG33L=S1
         SG33EE=S2
C
C---LOCAL/GLOBAL MAXIMA FOR THE MODIFIED SAMPLING FUNCTION
         CALL HSESTM(HSELCO,NCHE33,NDM3EL,NPOIN,NDO33E,NBN33E, T33GME,
     +   T33MXE,XX33E,IBM33E,NRG33E)
         INFOSA=1
         INT3C(12)=INT3C(12) + ITM33E
      ENDIF
C--------------------------------------------------------------------
      IF(INFOSA.EQ.1) THEN
         WRITE(LUNTES,'(///2A/)') ' ACTUAL CROSS SECTION VALUES (WITH '
     +   //'ERROR ESTIMATES)', ' AFTER INTEGRATION'
         WRITE(LUNTES,'(/A/)') ' ** NEUTRAL CURRENT: '
         WRITE(LUNTES,'(3X,A,1PE12.4,A,1PE12.4,A)') ' VIRTUAL & SOFT '
     +   //'CONTRIBUTIONS  SIG2   ', SIG2, ' +/- ', SIG2E, '  NB'
         WRITE(LUNTES,'(3X,A,1PE12.4,A,1PE12.4,A)') ' INITIAL STATE '
     +   //'LEPTONIC RADIATION     ', SIG31, ' +/- ', SIG31E, '  NB'
         WRITE(LUNTES,'(3X,A,1PE12.4,A,1PE12.4,A)') ' FINAL STATE '
     +   //'LEPTONIC RADIATION       ', SIG32, ' +/- ', SIG32E, '  NB'
         WRITE(LUNTES,'(3X,A,1PE12.4,A,1PE12.4,A)') ' COMPTON '
     +   //'CONTRIBUTION                 ', SIG33, ' +/- ', SIG33E, '  '
     +   //'NB'
         WRITE(LUNTES,'(3X,A,1PE12.4,A,1PE12.4,A)') ' QUARKONIC '
     +   //'RADIATION                  ', SIG34, ' +/- ', SIG34E, '  '
     +   //'NB'
         WRITE(LUNTES,'(/A/)') ' ** CHARGED CURRENT: '
         WRITE(LUNTES,'(3X,A,1PE12.4,A,1PE12.4,A)') ' VIRTUAL & SOFT '
     +   //'CONTRIBUTIONS  SIG2C  ', SIG2C, ' +/- ', SIG2EC, '  NB'
         WRITE(LUNTES,'(3X,A,1PE12.4,A,1PE12.4,A)') ' LEPTONIC '
     +   //'RADIATION (1/k.p)   SIG31C  ', SIG31C, ' +/- ', SG31EC, '  '
     +   //'NB'
         WRITE(LUNTES,'(3X,A,1PE12.4,A,1PE12.4,A)') ' QUARKONIC '
     +   //'RADIATION (1/k.q)  SIG32C  ', SIG32C, ' +/- ', SG32EC, '  '
     +   //'NB'
         WRITE(LUNTES,'(3X,A,1PE12.4,A,1PE12.4,A)') ' LEPTONIC '
     +   //'RADIATION (1/k.qs)  SIG33C  ', SIG33C, ' +/- ', SG33EC, '  '
     +   //'NB'
         WRITE(LUNTES,'(/A/)') ' ** ELASTIC TAIL: '
         WRITE(LUNTES,'(3X,A,1PE12.4,A,1PE12.4,A)') ' ELASTIC EP WITH '
     +   //'CORRECTIONS          ', SIG2L, ' +/- ', SIG2EE, '  NB'
         WRITE(LUNTES,'(3X,A,1PE12.4,A,1PE12.4,A)') ' INITIAL STATE '
     +   //'LEPTONIC RADIATION     ', SIG31L, ' +/- ', SG31EE, '  NB'
         WRITE(LUNTES,'(3X,A,1PE12.4,A,1PE12.4,A)') ' FINAL STATE '
     +   //'LEPTONIC RADIATION       ', SIG32L, ' +/- ', SG32EE, '  '
     +   //'NB'
         WRITE(LUNTES,'(3X,A,1PE12.4,A,1PE12.4,A)') ' COMPTON '
     +   //'CONTRIBUTION                 ', SIG33L, ' +/- ', SG33EE, ' '
     +   //' NB'
         SIGTW=SIG2+SIG31+SIG32+SIG33+SIG34 +SIG2C+SIG31C+SIG32C+
     +   SIG33C +SIG2L+SIG31L+SIG32L+SIG33L
         SIGEW=DSQRT(SIG2E**2+SIG31E**2+SIG32E**2+SIG33E**2+SIG34E**2
     +   +SIG2EC**2+SG31EC**2+SG32EC**2+SG33EC**2 +SIG2EE**2+SG31EE**2+
     +   SG32EE**2+SG33EE**2)
         WRITE(LUNTES,'(/A,1PE12.4,A,1PE12.4,A)') ' ** TOTAL CROSS '
     +   //'SECTION:                 ', SIGTW, ' +/- ', SIGEW, '  NB'
      ENDIF
C
C***********************************************************************
C   SAVE INFORMATION FROM INTEGRATION
C***********************************************************************
C
      IF(INFOSA.EQ.1) THEN
         REWIND (LUNDAT)
         WRITE(LUNDAT,ERR=170,IOSTAT=IOS) FNAME
         WRITE(LUNDAT,ERR=170,IOSTAT=IOS) INT2C,INT3C,ISAM2C,ISAM3C
         CALL HSDOUT
      ENDIF
      INFOSA=0
C
C***********************************************************************
C   INITIALIZATION FOR SAMPLING
C***********************************************************************
      DO 80   I=1,5
         IF(ISAM2(I).GT.0) INFOSA=1
         IF(ISAM2C(I).LT.ISAM2(I)) ISAM2C(I)=ISAM2(I)
   80 CONTINUE
      DO 90   I=1,15
         IF(ISAM3(I).GT.0) INFOSA=1
         IF(ISAM3C(I).LT.ISAM3(I)) ISAM3C(I)=ISAM3(I)
   90 CONTINUE
      IF(INFOSA.EQ.1) THEN
C
C---CHECK CONSISTENCY OF INPUT DATA FILE
C---READ SAMPLING INFORMATION FOR ALL CONTRIBUTIONS
         REWIND (LUNDAT)
         READ(LUNDAT,ERR=100 ,END=100 ,IOSTAT=IOS) FNAMET
         IF(FNAME.EQ.FNAMET) THEN
            READ(LUNDAT,ERR=100 ,END=100 ,IOSTAT=IOS) INT2C,INT3C,
     +      ISAM2C,ISAM3C
            CALL HSDTIN
            GOTO 110
         ENDIF
  100    CONTINUE
         WRITE(LUNOUT,'(/A,I3/A)') ' *** NO STANDARD HERACLES INPUT '
     +   //'FILE ASSIGNED TO UNIT',LUNDAT, ' *** EXECUTION STOPPED ***'
         STOP
C
  110    CONTINUE
         INFOSA=0
         DO 120  I=1,5
            IF(ISAM2(I).GT.0.AND.INT2C(I).EQ.0) INFOSA=1
  120    CONTINUE
         DO 130  I=1,15
            IF(ISAM3(I).GT.0.AND.INT3C(I).EQ.0) INFOSA=1
  130    CONTINUE
         IF(INFOSA.EQ.1) THEN
            WRITE(LUNOUT,'(A/A/2(A,5I4/),2(A,15I4/),A)') ' *** '
     +      //'INCONSISTENT INPUT DATA FOR SAMPLING (INT/ISAM) ***',
     +      ' *** ANY CHANNEL(S) REQUESTED NOT YET INTEGRATED     ***',
     +      ' *** INT2C(I): ',INT2C, ' *** ISAM2(I): ',ISAM2, ' *** '
     +      //'INT3C(I): ',INT3C, ' *** ISAM3(I): ',ISAM3, ' *** '
     +      //'EXECUTION STOPPED ***'
            STOP
         ENDIF
C
C---DETERMINE TOTAL CROSS SECTIONS AND ERRORS
         IF(ISAM2(1).GT.0) THEN
            SIGG(1)=SIG2
            SIGGRR(1)=SIG2E
         ENDIF
         IF(ISAM2(2).GT.0) THEN
            SIGG(2)=SIG2C
            SIGGRR(2)=SIG2EC
         ENDIF
         IF(ISAM2(3).GT.0) THEN
            SIGG(3)=SIG2L
            SIGGRR(3)=SIG2EE
         ENDIF
         IF(ISAM3(1).GT.0) THEN
            SIGG(6)=SIG31
            SIGGRR(6)=SIG31E
         ENDIF
         IF(ISAM3(2).GT.0) THEN
            SIGG(7)=SIG32
            SIGGRR(7)=SIG32E
         ENDIF
         IF(ISAM3(3).GT.0) THEN
            SIGG(8)=SIG33
            SIGGRR(8)=SIG33E
         ENDIF
         IF(ISAM3(4).GT.0) THEN
            SIGG(9)=SIG34
            SIGGRR(9)=SIG34E
         ENDIF
         IF(ISAM3(7).GT.0) THEN
            SIGG(12)=SIG31C
            SIGGRR(12)=SG31EC
         ENDIF
         IF(ISAM3(8).GT.0) THEN
            SIGG(13)=SIG32C
            SIGGRR(13)=SG32EC
         ENDIF
         IF(ISAM3(9).GT.0) THEN
            SIGG(14)=SIG33C
            SIGGRR(14)=SG33EC
         ENDIF
         IF(ISAM3(10).GT.0) THEN
            SIGG(15)=SIG31L
            SIGGRR(15)=SG31EE
         ENDIF
         IF(ISAM3(11).GT.0) THEN
            SIGG(16)=SIG32L
            SIGGRR(16)=SG32EE
         ENDIF
         IF(ISAM3(12).GT.0) THEN
            SIGG(17)=SIG33L
            SIGGRR(17)=SG33EE
         ENDIF
         DO 140  I=1,20
            SIGTOT=SIGTOT + SIGG(I)
            SIGTRR=SIGTRR + SIGGRR(I)**2
  140    CONTINUE
         SIGTRR=SQRT(SIGTRR)

CHJU
         SIGMA = SIGTOT
         ERROR =SIGTRR
CHJU
c---INITIALIZATION OF USER ROUTINES---------
         ICALL=1
         CALL HSUSER(ICALL,0D0,0D0,0D0)
         RETURN
      ENDIF
  150 CONTINUE
C
C***********************************************************************
C   EVENT GENERATION
C***********************************************************************
C
C---CONTROL OF EVENT GENERATION IN HSEVTG
      IWEIGS=IWEIGR
      CALL HSEVTG
CHJU
      RETURN
  160 CONTINUE
C
C---FINAL CALL OF USER TO GENERATE USER MONITORED OUTPUT
c        ICALL=3
c        CALL HSUSER(ICALL,0D0,0D0,0D0)
C
C---SAVE INFORMATION FOR FURTHER SAMPLING
      REWIND (LUNDAT)
      WRITE(LUNDAT,ERR=170,IOSTAT=IOS) FNAME
      WRITE(LUNDAT,ERR=170,IOSTAT=IOS) INT2C,INT3C,ISAM2C,ISAM3C
      CALL HSDOUT

C
C---SAVE CURRENT RANDOM NUMBER STATUS IF REQUESTED
      IF(ISDOUT.GT.0) THEN
         REWIND LUNRND
ccccc         CALL RNDMOU(UIO,CIO,CDIO,CMIO,IIO,JIO)
c         WRITE(LUNRND,*) UIO
c         WRITE(LUNRND,*) CIO,CDIO,CMIO,IIO,JIO
c         WRITE(LUNOUT,'(/A,I2)') ' *** ACTUAL RANDOM NUMBER SEEDS '
c     +   //'WRITTEN TO UNIT LUNRND=',LUNRND
      ENDIF
CHJU        STOP
      RETURN
C
C---ERROR WHILE WRITING HERACLES DATA FILE
  170 CONTINUE
      WRITE(LUNOUT,'(A,I4/A)')
     +   ' *** ERROR WRITING HERACLES DATA FILE ON UNIT',LUNDAT,
     +   ' *** EXECUTION STOPPED ***'
      STOP
C
C
C***********************************************************************
C               ERROR END
C***********************************************************************
      END
*CMZ :  2.06/39 07/07/98  15.33.52  by  Hannes Jung
*-- Author :
      SUBROUTINE HSEVTG
C---
C   EVENT SAMPLING
C   FRACTIONS FROM DIFFERENT CONTRIBUTIONS ACCORDING TO CROSS SECTIONS
C---
      IMPLICIT DOUBLE PRECISION (A-H,M,O-Z)
      EXTERNAL HSNCG2, HSTSK1, HSTSK2, HSK1TS, HSK1K3
      EXTERNAL HSCCG2, HSCCKL, HSCCQI, HSCCQF
      EXTERNAL HSELG2, HSELK1, HSELK2, HSELCO
      PARAMETER (NCHN2=1,NCHC2=2,NCHE2=3)
      PARAMETER (NCHN31=6,NCHN32=7,NCHN33=8,NCHN34=9)
      PARAMETER (NCHC31=12,NCHC32=13,NCHC33=14)
      PARAMETER (NCHE31=15,NCHE32=16,NCHE33=16)
      COMMON /HSOPTN/ INT2(5),INT3(15),ISAM2(5),ISAM3(15),
     +                IOPLOT,IPRINT,ICUT
      COMMON /HSNUME/ SIGTOT,SIGTRR,SIGG(20),SIGGRR(20),NEVENT,NEVE(20)
      COMMON /HSUNTS/ LUNTES,LUNDAT,LUNIN,LUNOUT,LUNRND
C-----------------------------
      PARAMETER(NDIM2=2,NBIN2=50)
      PARAMETER(NREG2N=2500)
      LOGICAL LGLO2,LLOC2
      COMMON /HSSNC2/ SIG2,SIG2E,T2GGMA,T2GMAX(NREG2N),
     +                XX2(50,2),
     +                FFGO2,DNCG2,FFLO2,DNCL2,GOLD2,
     +                NM2(NREG2N),NDO2,
     +                NTOT2,NCAL2,NCA12,NCA22,IBIM2,JCOR2,
     +                LGLO2,LLOC2
      PARAMETER(NREG2C=2500)
      LOGICAL LGLO2C,LLOC2C
      COMMON /HSSCC2/ SIG2C,SIG2EC,T2GMAC,T2MAXC(NREG2C),
     +                XX2C(50,2),
     +                FFGO2C,DNCG2C,FFLO2C,DNCL2C,GOLD2C,
     +                NM2C(NREG2C),NDO2C,
     +                NTOT2C,NCAL2C,NCA12C,NCA22C,IBIM2C,JCOR2C,
     +                LGLO2C,LLOC2C
      PARAMETER(NREG2E=50)
      PARAMETER(NDIM1=1)
      LOGICAL LGLO2E,LLOC2E
      COMMON /HSSEL2/ SIG2L,SIG2EE,T2GMAE,T2MAXE(NREG2E),
     +                XX2E(50,1),
     +                FFGO2E,DNCG2E,FFLO2E,DNCL2E,GOLD2E,
     +                NM2E(NREG2E),NDO2E,
     +                NTOT2E,NCAL2E,NCA12E,NCA22E,IBIM2E,JCOR2E,
     +                LGLO2E,LLOC2E
      PARAMETER(NDIM31=5,NBIN31=6,NREG31=7776)
      LOGICAL LGLO31,LLOC31
      COMMON /HSSN31/ SIG31,SIG31E,T31GMA,T31MAX(NREG31),
     +                XX31(50,NDIM31),
     +                FFGO31,DNCG31,FFLO31,DNCL31,GOLD31,
     +                SI31,SI2N31,SWGT31,SCHI31,IT31,
     +                NM31(NREG31),NDO31,
     +                NTOT31,NCAL31,NCA131,NCA231,IBIM31,JCOR31,
     +                LGLO31,LLOC31
      PARAMETER(NDIM32=5,NBIN32=6,NREG32=7776)
      LOGICAL LGLO32,LLOC32
      COMMON /HSSN32/ SIG32,SIG32E,T32GMA,T32MAX(NREG32),
     +                XX32(50,NDIM32),
     +                FFGO32,DNCG32,FFLO32,DNCL32,GOLD32,
     +                SI32,SI2N32,SWGT32,SCHI32,IT32,
     +                NM32(NREG32),NDO32,
     +                NTOT32,NCAL32,NCA132,NCA232,IBIM32,JCOR32,
     +                LGLO32,LLOC32
      PARAMETER(NDIM33=5,NBIN33=6,NREG33=7776)
      LOGICAL LGLO33,LLOC33
      COMMON /HSSN33/ SIG33,SIG33E,T33GMA,T33MAX(NREG33),
     +                XX33(50,NDIM33),
     +                FFGO33,DNCG33,FFLO33,DNCL33,GOLD33,
     +                SI33,SI2N33,SWGT33,SCHI33,IT33,
     +                NM33(NREG33),NDO33,
     +                NTOT33,NCAL33,NCA133,NCA233,IBIM33,JCOR33,
     +                LGLO33,LLOC33
      PARAMETER(NDIM34=5,NBIN34=6,NREG34=7776)
      LOGICAL LGLO34,LLOC34
      COMMON /HSSN34/ SIG34,SIG34E,T34GMA,T34MAX(NREG34),
     +                XX34(50,NDIM34),
     +                FFGO34,DNCG34,FFLO34,DNCL34,GOLD34,
     +                SI34,SI2N34,SWGT34,SCHI34,IT34,
     +                NM34(NREG34),NDO34,
     +                NTOT34,NCAL34,NCA134,NCA234,IBIM34,JCOR34,
     +                LGLO34,LLOC34
      PARAMETER(NDM3CC=5)
      PARAMETER(NBN31C=6,NRG31C=7776)
      LOGICAL LGL31C,LLC31C
      COMMON /HSSC31/ SIG31C,SG31EC,T31GMC,T31MXC(NRG31C),
     +                XX31C(50,5),
     +                FFG31C,DNG31C,FFL31C,DNL31C,GLD31C,
     +                SI31C,S2N31C,SWT31C,SCH31C,IT31C,
     +                NM31C(NRG31C),NDO31C,
     +                NTT31C,NCL31C,NC131C,NC231C,IBM31C,JCR31C,
     +                LGL31C,LLC31C
      PARAMETER(NBN32C=6,NRG32C=7776)
      LOGICAL LGL32C,LLC32C
      COMMON /HSSC32/ SIG32C,SG32EC,T32GMC,T32MXC(NRG32C),
     +                XX32C(50,5),
     +                FFG32C,DNG32C,FFL32C,DNL32C,GLD32C,
     +                SI32C,S2N32C,SWT32C,SCH32C,IT32C,
     +                NM32C(NRG32C),NDO32C,
     +                NTT32C,NCL32C,NC132C,NC232C,IBM32C,JCR32C,
     +                LGL32C,LLC32C
      PARAMETER(NBN33C=6,NRG33C=7776)
      LOGICAL LGL33C,LLC33C
      COMMON /HSSC33/ SIG33C,SG33EC,T33GMC,T33MXC(NRG33C),
     +                XX33C(50,5),
     +                FFG33C,DNG33C,FFL33C,DNL33C,GLD33C,
     +                SI33C,S2N33C,SWT33C,SCH33C,IT33C,
     +                NM33C(NRG33C),NDO33C,
     +                NTT33C,NCL33C,NC133C,NC233C,IBM33C,JCR33C,
     +                LGL33C,LLC33C
      PARAMETER(NDM3EL=4)
      PARAMETER(NBN31E=8,NRG31E=4096)
      LOGICAL LGL31E,LLC31E
      COMMON /HSSE31/ SIG31L,SG31EE,T31GME,T31MXE(NRG31E),
     +                XX31E(50,4),
     +                FFG31E,DNG31E,FFL31E,DNL31E,GLD31E,
     +                SI31E,S2N31E,SWT31E,SCH31E,IT31E,
     +                NM31E(NRG31E),NDO31E,
     +                NTT31E,NCL31E,NC131E,NC231E,IBM31E,JCR31E,
     +                LGL31E,LLC31E
      PARAMETER(NBN32E=8,NRG32E=4096)
      LOGICAL LGL32E,LLC32E
      COMMON /HSSE32/ SIG32L,SG32EE,T32GME,T32MXE(NRG32E),
     +                XX32E(50,4),
     +                FFG32E,DNG32E,FFL32E,DNL32E,GLD32E,
     +                SI32E,S2N32E,SWT32E,SCH32E,IT32E,
     +                NM32E(NRG32E),NDO32E,
     +                NTT32E,NCL32E,NC132E,NC232E,IBM32E,JCR32E,
     +                LGL32E,LLC32E
      PARAMETER(NBN33E=8,NRG33E=4096)
      LOGICAL LGL33E,LLC33E
      COMMON /HSSE33/ SIG33L,SG33EE,T33GME,T33MXE(NRG33E),
     +                XX33E(50,4),
     +                FFG33E,DNG33E,FFL33E,DNL33E,GLD33E,
     +                SI33E,S2N33E,SWT33E,SCH33E,IT33E,
     +                NM33E(NRG33E),NDO33E,
     +                NTT33E,NCL33E,NC133E,NC233E,IBM33E,JCR33E,
     +                LGL33E,LLC33E
      CHARACTER*45 CHNAME
      COMMON /HSNAMC/ CHNAME(20)
      DIMENSION PROCON(20),ICONTI(20),EFFIC(20)
      PARAMETER(NEV2=1,NEV3NC=1,NEV3CC=1,NEVEL=1)
      LOGICAL LFIRST(20)
      DATA LFIRST /20*.TRUE./
      LOGICAL FIRST
      DATA FIRST/.TRUE./
C-----------------------------------------------------------------------
      IF(FIRST) THEN
         WRITE(LUNOUT,'(//A/)') ' CROSS SECTIONS ACTUALLY APPLIED FOR '
     +   //'SAMPLING (IN NANOBARN): '
         WRITE(LUNOUT,'(A,1PE12.4,A,1PE11.4/)') ' TOTAL CROSS SECTION, '
     +   //' SIGTOT =              ', SIGTOT,' +/-',SIGTRR
         DO 10 I=1,20
            IF(SIGG(I).GT.0D0) WRITE(LUNOUT,'(A,1PE12.4,A,1PE11.4)')
     +      CHNAME(I),SIGG(I),' +/-', SIGGRR(I)
   10    CONTINUE
C-----------------------------------------------------------------------
C---CUMULATIVE PROBABILITIES FOR CHOSING THE ACTUAL CONTRIBUTION
         PROCON(1)=SIGG(1)/SIGTOT
         DO 20 I=2,20
            PROCON(I)=PROCON(I-1) + SIGG(I)/SIGTOT
   20    CONTINUE
         DO 30 I=1,5
            ICONTI(I)=ISAM2(I)
   30    CONTINUE
         DO 40 I=1,15
            ICONTI(I+5)=ISAM3(I)
   40    CONTINUE
         FIRST=.FALSE.
      ENDIF
C-----------------------------------------------------------------------
C---EVENT SAMPLING
ccc      DO 1000 I=1,NEVENT
C---CHANNEL SELECTION
      RNC=HSRNDM()
      DO 50 NC=1,20
         IF(RNC.LE.PROCON(NC)) THEN
            NCA=NC
            GOTO 60
         ENDIF
   50 CONTINUE
      NCA=999
      WRITE(LUNOUT,'(A,I4/A)') ' HSEVTG: ERROR IN CHANNEL SELECTION - '
     +//'NCA=',NCA, '         EXECUTION STOPPED'
      STOP
C---GENERATION OF ONE SINGLE EVENT IN THE SELECTED CHANNEL
   60 GOTO(70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,
     +220,230,240,250,260), NCA
C
C---NON RADIATIVE EVENTS - NEUTRAL CURRENT / BORN + VIRTUAL&SOFT
   70 CONTINUE
      IF(IPRINT.GE.3) WRITE(LUNTES,'(//A/A,5X,2I3,I8,2I4)') ' CALL '
     +//'HSGENM ',' NCHN2,NDIM2,NEV2,NDO2,NBIN2', NCHN2,NDIM2,NEV2,
     +NDO2,NBIN2
      CALL HSGENM(HSNCG2,NCHN2,NDIM2,NEV2,ICONTI(1),T2GGMA,T2GMAX,
     +GOLD2,FFGO2,FFLO2,DNCG2,DNCL2,LLOC2,LGLO2, NTOT2,NM2,NCAL2,NCA12,
     +NCA22,IBIM2,JCOR2, XX2,NDO2,NBIN2,NREG2N)
      GOTO 270
C---NON RADIATIVE EVENTS - CHARGED CURRENT / BORN + VIRTUAL&SOFT
   80 CONTINUE
      CALL HSGENM(HSCCG2,NCHC2,NDIM2,NEV2,ICONTI(2),T2GMAC,T2MAXC,
     +GOLD2C,FFGO2C,FFLO2C,DNCG2C,DNCL2C,LLOC2C,LGLO2C, NTOT2C,NM2C,
     +NCAL2C,NCA12C,NCA22C,IBIM2C,JCOR2C, XX2C,NDO2C,NBIN2,NREG2C)
      GOTO 270
C---NON RADIATIVE EVENTS - ELASTIC EP / BORN + VIRTUAL&SOFT
   90 CONTINUE
      IF(IPRINT.GE.3) WRITE(LUNTES,'(//A/A,5X,2I3,I8,2I4)') ' CALL '
     +//'HSGENM ',' NCHE2,NDIM1,NEVEL,NDO2E,NBIN2', NCHE2,NDIM1,NEVEL,
     +NDO2E,NBIN2
      CALL HSGENM(HSELG2,NCHE2,NDIM1,NEVEL,ICONTI(3),T2GMAE,T2MAXE,
     +GOLD2E,FFGO2E,FFLO2E,DNCG2E,DNCL2E,LLOC2E,LGLO2E, NTOT2E,NM2E,
     +NCAL2E,NCA12E,NCA22E,IBIM2E,JCOR2E, XX2E,NDO2E,NBIN2,NREG2E)
      GOTO 270
  100 CONTINUE
  110 CONTINUE
      WRITE(LUNOUT,'(A,I4/A)') ' HSEVTG: UNDEFINED CHANNEL SELECTED- '
     +//'NCA=',NCA, '         EXECUTION STOPPED'
      STOP
C---RADIATIVE EVENTS - NEUTRAL CURRENT / INITIAL STATE LEPTONIC RAD.
  120 CONTINUE
      IF(IPRINT.GE.3) WRITE(LUNTES,'(//A/A,5X,2I3,I8,2I4)') ' CALL '
     +//'HSGENM ',' NCHN31,NDIM31,NEV3NC,NDO31,NBIN31', NCHN31,NDIM31,
     +NEV3NC,NDO31,NBIN31
      CALL HSGENM(HSTSK1,NCHN31,NDIM31,NEV3NC,ICONTI(6), T31GMA,T31MAX,
     +GOLD31,FFGO31,FFLO31,DNCG31,DNCL31,LLOC31,LGLO31, NTOT31,NM31,
     +NCAL31,NCA131,NCA231,IBIM31,JCOR31, XX31,NDO31,NBIN31,NREG31)
      GOTO 270
C---RADIATIVE EVENTS - NEUTRAL CURRENT / FINAL STATE LEPTONIC RAD.
  130 CONTINUE
      IF(IPRINT.GE.3) WRITE(LUNTES,'(//A/A,5X,2I3,I8,2I4)') ' CALL '
     +//'HSGENM ',' NCHN32,NDIM32,NEV3NC,NDO32,NBIN32', NCHN32,NDIM32,
     +NEV3NC,NDO32,NBIN32
      CALL HSGENM(HSTSK2,NCHN32,NDIM32,NEV3NC,ICONTI(7), T32GMA,T32MAX,
     +GOLD32,FFGO32,FFLO32,DNCG32,DNCL32,LLOC32,LGLO32, NTOT32,NM32,
     +NCAL32,NCA132,NCA232,IBIM32,JCOR32, XX32,NDO32,NBIN32,NREG32)
      GOTO 270
C---RADIATIVE EVENTS - NEUTRAL CURRENT / COMPTON CONTRIBUTION
  140 CONTINUE
      IF(IPRINT.GE.1) WRITE(LUNTES,'(//A/A,5X,2I3,I8,2I4)') ' CALL '
     +//'HSGENM ',' NCHN33,NDIM33,NEV3NC,NDO33,NBIN33', NCHN33,NDIM33,
     +NEV3NC,NDO33,NBIN33
      CALL HSGENM(HSK1TS,NCHN33,NDIM33,NEV3NC,ICONTI(8), T33GMA,T33MAX,
     +GOLD33,FFGO33,FFLO33,DNCG33,DNCL33,LLOC33,LGLO33, NTOT33,NM33,
     +NCAL33,NCA133,NCA233,IBIM33,JCOR33, XX33,NDO33,NBIN33,NREG33)
      GOTO 270
C---RADIATIVE EVENTS - NEUTRAL CURRENT / QUARKONIC RADIATION
  150 CONTINUE
      IF(IPRINT.GE.1) WRITE(LUNTES,'(//A/A,5X,2I3,I8,2I4)') ' CALL '
     +//'HSGENM ',' NCHN34,NDIM34,NEV3NC,NDO34,NBIN34', NCHN34,NDIM34,
     +NEV3NC,NDO34,NBIN34
      CALL HSGENM(HSK1K3,NCHN34,NDIM34,NEV3NC,ICONTI(9), T34GMA,T34MAX,
     +GOLD34,FFGO34,FFLO34,DNCG34,DNCL34,LLOC34,LGLO34, NTOT34,NM34,
     +NCAL34,NCA134,NCA234,IBIM34,JCOR34, XX34,NDO34,NBIN34,NREG34)
      GOTO 270
  160 CONTINUE
  170 CONTINUE
      GOTO 260
C---RADIATIVE EVENTS - CHARGED CURRENT / LEPTONIC RADIATION
  180 CONTINUE
      CALL HSGENM(HSCCKL,NCHC31,NDM3CC,NEV3CC,ICONTI(12),T31GMC,
     +T31MXC, GLD31C,FFG31C,FFL31C,DNG31C,DNL31C,LLC31C,LGL31C, NTT31C,
     +NM31C,NCL31C,NC131C,NC231C,IBM31C,JCR31C, XX31C,NDO31C,NBN31C,
     +NRG31C)
      GOTO 270
C---RADIATIVE EVENTS - CHARGED CURRENT / (KQ) CHANNEL
  190 CONTINUE
      CALL HSGENM(HSCCQI,NCHC32,NDM3CC,NEV3CC,ICONTI(13),T32GMC,
     +T32MXC, GLD32C,FFG32C,FFL32C,DNG32C,DNL32C,LLC32C,LGL32C, NTT32C,
     +NM32C,NCL32C,NC132C,NC232C,IBM32C,JCR32C, XX32C,NDO32C,NBN32C,
     +NRG32C)
      GOTO 270
C---RADIATIVE EVENTS - CHARGED CURRENT / (KQS) CHANNEL
  200 CONTINUE
      CALL HSGENM(HSCCQF,NCHC33,NDM3CC,NEV3CC,ICONTI(14),T33GMC,
     +T33MXC, GLD33C,FFG33C,FFL33C,DNG33C,DNL33C,LLC33C,LGL33C, NTT33C,
     +NM33C,NCL33C,NC133C,NC233C,IBM33C,JCR33C, XX33C,NDO33C,NBN33C,
     +NRG33C)
      GOTO 270
C---RADIATIVE EVENTS - ELASTIC TAIL / INITIAL STATE
  210 CONTINUE
      IF(IPRINT.GE.3) WRITE(LUNTES,'(//A/A,5X,2I3,I8,2I4)') ' CALL '
     +//'HSGENM ',' NCHE31,NDM3EL,NEVEL,NDO31E,NBN31E', NCHE31,NDM3EL,
     +NEVEL,NDO31E,NBN31E
      CALL HSGENM(HSELK1,NCHE31,NDM3EL,NEVEL,ICONTI(15),T31GME, T31MXE,
     +GLD31E,FFG31E,FFL31E,DNG31E,DNL31E,LLC31E,LGL31E, NTT31E,NM31E,
     +NCL31E,NC131E,NC231E,IBM31E,JCR31E, XX31E,NDO31E,NBN31E,NRG31E)
      GOTO 270
C---  RADIATIVE EVENTS - ELASTIC TAIL / FINAL STATE
  220 CONTINUE
      IF(IPRINT.GE.3) WRITE(LUNTES,'(//A/A,5X,2I3,I8,2I4)') ' CALL '
     +//'HSGENM ',' NCHE32,NDM3EL,NEVEL,NDO32E,NBN32E', NCHE32,NDM3EL,
     +NEVEL,NDO32E,NBN32E
      CALL HSGENM(HSELK2,NCHE32,NDM3EL,NEVEL,ICONTI(16),T32GME, T32MXE,
     +GLD32E,FFG32E,FFL32E,DNG32E,DNL32E,LLC32E,LGL32E, NTT32E,NM32E,
     +NCL32E,NC132E,NC232E,IBM32E,JCR32E, XX32E,NDO32E,NBN32E,NRG32E)
      GOTO 270
C---RADIATIVE EVENTS - ELASTIC TAIL / COMPTON
  230 CONTINUE
      IF(IPRINT.GE.3) WRITE(LUNTES,'(//A/A,5X,2I3,I8,2I4)') ' CALL '
     +//'HSGENM ',' NCHE33,NDM3EL,NEVEL,NDO33E,NBN33E', NCHE33,NDM3EL,
     +NEVEL,NDO33E,NBN33E
      CALL HSGENM(HSELCO,NCHE33,NDM3EL,NEVEL,ICONTI(17),T33GME, T33MXE,
     +GLD33E,FFG33E,FFL33E,DNG33E,DNL33E,LLC33E,LGL33E, NTT33E,NM33E,
     +NCL33E,NC133E,NC233E,IBM33E,JCR33E, XX33E,NDO33E,NBN33E,NRG33E)
      GOTO 270
  240 CONTINUE
  250 CONTINUE
  260 CONTINUE
      WRITE(LUNOUT,'(A,I4/A)') ' HSEVTG: UNDEFINED CHANNEL SELECTED- '
     +//'NCA=',NCA, '         EXECUTION STOPPED'
      STOP
C---
  270 CONTINUE
      NEVE(NCA)=NEVE(NCA) + 1
      IF(LFIRST(NCA)) THEN
         LFIRST(NCA)=.FALSE.
         ICONTI(NCA)=2
      ENDIF
ccc 1000 CONTINUE
C
C
      RETURN
      END
*CMZ :  2.06/44 28/07/98  18.47.33  by  Hannes Jung
*CMZ :  2.00/23 19/11/95  20.31.54  by  Hannes Jung
*CMZ :  2.00/01 11/05/95  09.18.01  by  Hannes Jung
*CMZ :  1.04/04 19/04/95  16.28.26  by  Hannes Jung
*CMZ :  1.04/03 15/03/95  16.10.11  by  Hannes Jung
*-- Author :
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C---FILL HEADER RECORD OF COMMON HEPEVT
C
      SUBROUTINE HSHEAD
      IMPLICIT DOUBLE PRECISION (A-H,M,O-Z)
C---------------------------------------------------------------------
*KEEP,RGHSOPTN.
      Integer INT2,INT3,ISAM2,ISAM3,IOPLOT,IPRINT,ICUT
      COMMON /HSOPTN/ INT2(5),INT3(15),ISAM2(5),ISAM3(15),
     +                IOPLOT,IPRINT,ICUT

*KEND.

      COMMON /HSUNTS/ LUNTES,LUNDAT,LUNIN,LUNOUT,LUNRND
      COMMON /VGASIO/ NINP,NOUTP
      COMMON /HSVGLP/ NPOVEG,NUMINT,NPHYP
      COMMON /HSRDIO/ ISDINP,ISDOUT
      COMMON /HSPARL/ LPAR(20),LPARIN(12),IPART
      COMMON /HSNUME/ SIGTOT,SIGTRR,SIGG(20),SIGGRR(20),NEVENT,NEVE(20)
      COMMON /HSELAB/ SP,EELE,PELE,EPRO,PPRO
      COMMON /HSPARM/ POLARI,LLEPT,LQUA
      COMMON /HSGSW/  SW,CW,SW2,CW2
     *              ,MW,MZ,MH,ME,MMY,MTAU,MU,MD,MS,MC,MB,MT
     *              ,MW2,MZ2,MH2,ME2,MMY2,MTAU2,MU2,MD2,MS2,MC2,MB2,MT2
      COMMON /PYSTFUC/ PYSTOP,PYSLAM,NPYMOD,NPYMAX,NPYMIN
      REAL           PYSTOP,PYSLAM
      COMMON /HSCUTS/ XMIN,XMAX,Q2MIN,Q2MAX,YMIN,YMAX,WMIN,GMIN
      COMMON /HSIRCT/ DELEPS,DELTA,EGMIN,IOPEGM
      PARAMETER (NMXHEP=2000)
      COMMON /HEPEVT/ NEVHEP,NHEP,ISTHEP(NMXHEP),IDHEP(NMXHEP),
     &                JMOHEP(2,NMXHEP),JDAHEP(2,NMXHEP),
     &                PHEP(5,NMXHEP),VHKK(4,NMXHEP)
      DIMENSION NOW(8)

      NEVHEP=-1
C---RUN AND GENERATOR'S IDENTIFIER
      ISTHEP(1)=1
      IDHEP(1)=0
C---DATE AND TIME
c      CALL DATIM(NOW)
      DO 10 INW=1,8
   10 NOW(INW)=0
      JMOHEP(1,1)=NOW(6)+NOW(7)*100+(NOW(8)-1900)*10000
      JMOHEP(2,1)=NOW(3)+NOW(4)*100+NOW(5)*10000
C---VERSION NUMBER AND DATE OF LAST CHANGE
      JDAHEP(1,1)=0404
      JDAHEP(2,1)=930813

C---REAL PARAMETERS FROM INPUT AND HSPRLG
      PHEP(1,2)=EELE
      PHEP(1,3)=POLARI
      PHEP(1,4)=EPRO
      PHEP(1,5)=XMIN
      PHEP(1,6)=XMAX
      PHEP(1,7)=YMIN
      PHEP(1,8)=YMAX
      PHEP(1,9)=Q2MIN
      PHEP(1,10)=WMIN
      PHEP(1,11)=EGMIN
      PHEP(1,12)=MW
      PHEP(1,13)=MZ
      PHEP(1,14)=MH
      PHEP(1,15)=MT

C---OPTION FLAGS
      ISTHEP(2)=LLEPT
      ISTHEP(3)=ICUT
      DO 20 I=1,12
   20 ISTHEP(I+3)=LPARIN(I)
      ISTHEP(16)=IPART
      ISTHEP(17)=NPYMIN
      ISTHEP(18)=NPYMAX
      ISTHEP(19)=LUNIN
      ISTHEP(20)=LUNOUT
      ISTHEP(21)=LUNTES
      ISTHEP(22)=LUNRND
      ISTHEP(23)=LUNDAT
      ISTHEP(24)=NINP
      ISTHEP(25)=NOUTP
      DO 30 I=1,5
   30 ISTHEP(25+I)=INT2(I)
      DO 40 I=1,15
   40 ISTHEP(30+I)=INT3(I)
      ISTHEP(46)=NPOVEG
      ISTHEP(47)=NUMINT
      ISTHEP(48)=NPHYP
      DO 50 I=1,5
   50 ISTHEP(48+I)=ISAM2(I)
      DO 60 I=1,15
   60 ISTHEP(53+I)=ISAM3(I)
      ISTHEP(69)=IOPLOT
      ISTHEP(70)=IPRINT
      ISTHEP(71)=ISDINP
      ISTHEP(72)=ISDOUT
      ISTHEP(73)=NEVENT
      NHEP=73

      RETURN
      END
*CMZ :  2.00/01 11/05/95  09.18.24  by  Hannes Jung
*CMZ :  1.04/04 19/04/95  16.28.26  by  Hannes Jung
*CMZ :  1.04/03 15/03/95  16.10.11  by  Hannes Jung
*-- Author :
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C---FILL TERMINATING RECORD OF COMMON HEPEVT
C
      SUBROUTINE HSTERM
      IMPLICIT DOUBLE PRECISION (A-H,M,O-Z)
C---------------------------------------------------------------------
      COMMON /HSNUME/ SIGTOT,SIGTRR,SIGG(20),SIGGRR(20),NEVENT,NEVE(20)
      COMMON /HSGSW/  SW,CW,SW2,CW2
     +              ,MW,MZ,MH,ME,MMY,MTAU,MU,MD,MS,MC,MB,MT
     +              ,MW2,MZ2,MH2,ME2,MMY2,MTAU2,MU2,MD2,MS2,MC2,MB2,MT2
      COMMON /PYSTFUC/ PYSTOP,PYSLAM,NPYMOD,NPYMAX,NPYMIN
      REAL           PYSTOP,PYSLAM
      COMMON /HSCUTS/ XMIN,XMAX,Q2MIN,Q2MAX,YMIN,YMAX,WMIN,GMIN
      PARAMETER (NMXHEP=2000)
      COMMON /HEPEVT/ NEVHEP,NHEP,ISTHEP(NMXHEP),IDHEP(NMXHEP),
     +                JMOHEP(2,NMXHEP),JDAHEP(2,NMXHEP),
     +                PHEP(5,NMXHEP),VHKK(4,NMXHEP)

      NEVHEP=-2

C---CROSS SECTIONS
      PHEP(1,1)=SIGTOT/1D3
      PHEP(1,2)=SIGTRR/1D3
      DO 10 I=1,20
         PHEP(1,2+I)=SIGG(I)/1D3
   10 PHEP(1,22+I)=SIGGRR(I)/1D3
C---MASSES, SW2
      PHEP(1,43)=SW2
      PHEP(1,44)=MW
C---EVENT NUMBERS
      ISTHEP(1)=NEVENT
      DO 20 I=1,20
   20 ISTHEP(1+I)=NEVE(I)
      NHEP=44

      RETURN
      END
*CMZ :  2.08/02 14/07/99  18.39.56  by  Hannes Jung
*CMZ :  2.06/39 16/07/98  11.40.09  by  Hannes Jung
*-- Author :
C   16/07/91 308131733  MEMBER NAME  HSUSER   (S44)         FVS
C
C
      SUBROUTINE HSUSER(ICALL,X,Y,Q2)
C---
C   OUTPUT TO UNIT LUNEVE = 6
C---
C
      IMPLICIT DOUBLE PRECISION (A-H,M,O-Z)
C---------------------------------------------------------------------
*KEEP,RGHSOPTN.
      Integer INT2,INT3,ISAM2,ISAM3,IOPLOT,IPRINT,ICUT
      COMMON /HSOPTN/ INT2(5),INT3(15),ISAM2(5),ISAM3(15),
     +                IOPLOT,IPRINT,ICUT

*KEND.

      COMMON /HSNUME/ SIGTOT,SIGTRR,SIGG(20),SIGGRR(20),NEVENT,NEVE(20)
      COMMON /HSELAB/ SP,EELE,PELE,EPRO,PPRO
      COMMON /HSPARM/ POLARI,LLEPT,LQUA
      COMMON /HSCUTS/ XMIN,XMAX,Q2MIN,Q2MAX,YMIN,YMAX,WMIN,GMIN
      COMMON /HSGSW1/ MEI,MEF,MQI,MQF,MEI2,MEF2,MQI2,MQF2,MPRO,MPRO2
      COMMON /HSIKP/  S,T,U,SS,TS,US,DKP,DKPS,DKQ,DKQS
      PARAMETER (NMXHEP=2000)
      COMMON /HEPEVT/ NEVHEP,NHEP,ISTHEP(NMXHEP),IDHEP(NMXHEP),
     +                JMOHEP(2,NMXHEP),JDAHEP(2,NMXHEP),
     +                PHEP(5,NMXHEP),VHKK(4,NMXHEP)
      COMMON /HSCHNN/ ICHNN
C+KEEP,   PARA.
      DOUBLE PRECISION ALPHS,PI,ALPH
      INTEGER IWEI
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      INTEGER IPRO,IRUNA,IQ2,IRUNAEM
      DOUBLE PRECISION Q2START,W_Q2
      COMMON/RAPA /IPRO,IRUNA,IQ2,IRUNAEM,Q2START,W_Q2,OMEG2

cENDKEEP

      COMMON/DIVO/ NDIM,NPOIN
*KEEP,RGHS45.
      INTEGER IHERAC,KPAHS
      DOUBLE PRECISION YHS,XHS,Q2HS
      COMMON /HS45/ IHERAC,KPAHS,YHS,XHS,Q2HS
*KEND.
      REAL RTIME
      LOGICAL FIRST
      DATA FIRST/.TRUE./
      GOTO (10 ,20 ,30 ) ICALL
C***********************************************************************
C---INITIALIZATION CALL

   10 CONTINUE
      IF(FIRST) THEN
C---WRITE SOME RUN PARAMETERS TO UNIT 6
         WRITE(6,'(/A/)') ' *****  PROPERTIES OF THE ELECTRON BEAM  ***'
     +   //'**'
         WRITE(6,'(10X,A,F8.1,A)') ' ENERGY OF INCIDENT ELECTRON =',
     +   EELE,' GEV'
         WRITE(6,'(10X,A,I3)') ' CHARGE OF INCIDENT ELECTRON =',LLEPT
         WRITE(6,'(10X,A,F8.4)') ' DEGREE OF BEAM POLARIZATION =',
     +   POLARI
         WRITE(6,'(/A/)') ' *****  PROPERTIES OF THE PROTON BEAM  *****'
         WRITE(6,'(10X,A,F8.1,A)') ' ENERGY OF INCIDENT PROTON =',EPRO,
     +   ' GEV'
         WRITE(6,'(//10X,A,1PE12.5,A)') ' CMS ENERGY SQUARED  S =',SP,
     +   ' GEV**2'
         WRITE(6,'(/A/)') ' *****  KINEMATICAL LIMITS FOR GENERATED '
     +   //'EVENTS  *****'
         WRITE(6,'(10X,A,1PE10.3,5X,A,1PE10.3)') ' XMIN=',XMIN,' XMAX='
     +   ,XMAX
         WRITE(6,'(10X,A,1PE10.3,A)') ' Q2MIN=',Q2MIN,' GEV**2'
         WRITE(6,'(10X,A,1PE10.3,A,18X,A)') ' WMIN=', WMIN, ' GEV',' '
     +   //'(ACTIVE ONLY FOR ICUT=2)'
         WRITE(6,'(10X,A,1PE10.3,5X,A,1PE10.3,1X,A)') ' YMIN=',YMIN,' '
     +   //'YMAX=',YMAX, ' (ACTIVE ONLY FOR ICUT=3)'
         WRITE(6,'(10X,A,I2)') ' ICUT=',ICUT
C---INITIALIZATION OF TIMING ROUTINE
         CALL TIMEX(RTIME)
         TIMINI=RTIME
         NEVMOD=1000
         FIRST=.FALSE.
      ENDIF
      RETURN
C***************
C---COLLECTING EVENTS IN DATA SET HEVENT.V30.DAT
   20 CONTINUE
      GSP=SP-MPRO2-MEI2
      IF (ICHNN.EQ.6.OR.ICHNN.EQ.7.OR.ICHNN.EQ.8.OR.ICHNN.EQ.12) THEN
         DKPRO=EPRO*PHEP(4,3)+PPRO*PHEP(3,3)
         Q2HS=-TS
         XHS=Q2HS/(Y*GSP-2D0*DKPRO)
         YHS=Q2HS/XHS/GSP
      ELSE
         Q2HS=Q2
         XHS=X
         YHS=Y
      ENDIF
      KPAHS = IDHEP(2)
      NDIM = 2
      IHERAC = 1
      IF(IPRO.EQ.3000) THEN
         IPRO=30
      ELSE
         IPRO = 12
      ENDIF
10000 FORMAT(2I6,3X,2D12.5,3X,I6)
10100 FORMAT(I6,4D16.9)
10200 FORMAT(' s,t,u = ',3D16.9/,'ss ts us = ',3D16.9/
     +  ,'dkp dkps,dkq,dkqs = ',4D16.9)
C
      IF(MOD(NEVHEP,NEVMOD).EQ.0) THEN

         CALL TIMEX(RTIME)
         TIMFIN=RTIME
         RTIME=TIMFIN-TIMINI
         TIMINI=TIMFIN
         TIMEVT=RTIME/NEVMOD
         WRITE(6,10300) NEVHEP,TIMEVT
10300   FORMAT(/,' AVERAGE TIME PER EVENT AFTER ',I6,' EVENTS: ',
     +            1PE11.2,' SEC')
      ENDIF
      RETURN
C***************
C
C---FINAL CALL
   30 CONTINUE
C---TERMINATING RECORD ON HEPEVT
      CALL HSTERM
      RETURN
      END
*CMZ :  2.00/01 11/05/95  10.01.11  by  Hannes Jung
*CMZ :  2.00/06 01/09/92  17.31.56  by  Peter Lanius
*CMZ :  1.01/09 13/03/92  14.28.04  by  Peter Lanius
*CMZ :  1.01/07 10/03/92  10.38.39  by  Peter Lanius
*CMZ :  1.01/05 05/03/92  17.32.45  by  Guenter Grindhammer
*CMZ :  1.00/06 12/02/92  09.44.24  by  Peter Lanius
*-- Author :    Peter Lanius   07/02/92
      SUBROUTINE PEPEVT
C**********************
C
C     print out the EPEVT common in a suitable form
C
C     Peter Lanius
C     07/02/92
C
C*********************************************************
C
      PARAMETER (NMXHEP=2000)
      IMPLICIT DOUBLE PRECISION (A-H,M,O-Z)
      COMMON /HEPEVT/ NEVHEP,NHEP,ISTHEP(NMXHEP),IDHEP(NMXHEP),
     +                JMOHEP(2,NMXHEP),JDAHEP(2,NMXHEP),
     +                PHEP(5,NMXHEP),VHKK(4,NMXHEP)

C---EVENT CHARACTERISTICS IN COMMON EPEVT
C   ELECTRON:      IDHEP(1), PHEP(I,1)
C   QUARK:         IDHEP(2), PHEP(I,2)
C   PHOTON:        IDHEP(3), PHEP(I,3)

      IF( NHEP .EQ. 0 ) THEN
         WRITE(*,*) '+++++++++++ PEPEVT: NHEP = 0, NO OUTPUT ++++++++++'
     +   //'+'
      END IF

      IF( NHEP .GT. 0 ) THEN
         WRITE(6,10000)
         DO 10  I = 1, NHEP
            WRITE(6,10100) I, IDHEP(I), ISTHEP(I), JMOHEP(1,I), PHEP(1,
     +      I), PHEP(2,I), PHEP(3,I), PHEP(4,I)
   10    CONTINUE
      END IF

10000 FORMAT(//,120('-'),/,6X,'Number',2X,'PDG-code',3X,
     +       'St-code',1X,'1.Mother',7X,'PX',13X,'PY',
     +       13X,'PZ',10X,'Energy',/,/,120('-'),/)
10100 FORMAT(4I10,4D15.4)

      RETURN
      END
*CMZ :  2.06/39 07/07/98  15.33.52  by  Hannes Jung
*CMZ :  6.22/00 20/07/95  17.30.40  by  Martin Hampel
*-- Author :
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
C     QTIMER(TIME)
C     TIMER ROUTINE, RETURNS THE TIME OF A CPU-CLOCK COUNTING IN
C     MICRO SECONDS (MACHINE DEPENDENT)
C
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C
      SUBROUTINE QTIMER(RTIME)
      REAL*8 RTIME
      LOGICAL FIRST
      DATA FIRST /.TRUE./
      IF(FIRST) THEN
         FIRST=.FALSE.
         NCL=0
      ENDIF
      NCL=NCL+1
      RTIME=NCL*1D6
      RETURN
      END
*CMZ :  2.08/02 14/07/99  18.40.56  by  Hannes Jung
*CMZ :  2.08/00 15/06/99  17.22.43  by  Hannes Jung
*CMZ :  2.06/39 07/07/98  15.33.52  by  Hannes Jung
*-- Author :
C######################################################################
C
C   Various routines to give structure function parametrizations.
C
C ********************************************************************

c...hs taken from LEPTO 6.5 (modified)
      SUBROUTINE LYSTFU(KF,X,Q2,XPQ)
      COMMON /ARSTRF/ KFSAVE(2),XSAVE(2),XQ2SAV(2),XPQSAV(2,-6:6)
      REAL*4          PYSTOP,PYSLAM
      COMMON /HYSTFU/ PYSTOP,PYSLAM,NPYMOD,NPYMAX,NPYMIN
      COMMON /HSPARL/ LPAR(20),LPARIN(12),IPART
      COMMON /HSPARM/ POLARI,LLEPT,LQUA
      DOUBLE PRECISION POLARI
      COMMON /HSELAB/ SP,EELE,PELE,EPRO,PPRO
      DOUBLE PRECISION SP,EELE,PELE,EPRO,PPRO
      COMMON /HSGSW1/ MEI,MEF,MQI,MQF,MEI2,MEF2,MQI2,MQF2,MPRO,MPRO2
      DOUBLE PRECISION MEI,MEF,MQI,MQF,MEI2,MEF2,MQI2,MQF2,MPRO,MPRO2
      COMMON /HSUNTS/ LUNTES,LUNDAT,LUNIN,LUNOUT,LUNRND
      DIMENSION XPQ(-6:6),XPQS(-6:6)
      DOUBLE PRECISION HSLOQS,DQ2,DX
*KEEP,RGLQ2.
      DOUBLE PRECISION Q2SUPP
      COMMON/LOWQ2S/Q2SUPP
*KEND.
C...hs
      LOGICAL LFIRST
      DATA LFIRST/.TRUE./

      IF (LFIRST) THEN
         LFIRST=.FALSE.
         write(6,*) ' RAPGAP version for LYSTFU '
      ENDIF

C...Reset arrays etc.
      DO 10  KFL=-6,6
         XPQ(KFL)=0.0
   10 XPQSAV(1,KFL)=0.
      XSAVE(1)=X
      XQ2SAV(1)=Q2
      KFSAVE(1)=KF
C...Check x and particle species.
      IF(X.LE.0..OR.X.GE.1.) THEN
         WRITE(6,10000) X
         RETURN
      ENDIF

      CALL PYSTFU(KF,X,Q2,XPQS)
      DO 20  KFL=-NPYMAX,NPYMAX
   20 XPQ(KFL)=XPQS(KFL)

C...H.S.
C...APPLY LOW Q2 SUPPRESSION
      IF (Q2SUPP.NE.0) THEN
         DCORRP=1.-EXP(-Q2SUPP*Q2)
         DO 30 IF=1,6
            XPQ(IF)=XPQ(IF)*DCORRP
   30    XPQ(-IF)=XPQ(-IF)*DCORRP
      ENDIF

      DO 40  KFL=-6,6
   40 XPQSAV(1,KFL)=XPQ(KFL)

C...Formats for error printouts.
10000 FORMAT(' Error in LYSTFU: x =',1P,E12.4,' outside physical range')

      RETURN
      END
*CMZ :  2.08/04 21/12/99  11.13.28  by  Hannes Jung
*CMZ :  2.06/44 01/08/98  17.44.57  by  Hannes Jung
*CMZ :  2.06/40 16/07/98  12.52.40  by  Hannes Jung
*CMZ :  2.06/39 06/07/98  16.39.29  by  Hannes Jung
*-- Author :    Hannes Jung   06/07/98
      SUBROUTINE HS46INI
      IMPLICIT DOUBLE PRECISION (A-H,M,O-Z)
      COMMON /VGASIO/ NINP,NOUTP
      COMMON /HSRDIO/ ISDINP,ISDOUT
      COMMON /HSVGLP/ NPOVEG,NUMINT,NPHYP
      COMMON /HSIRCT/ DELEPS,DELTA,EGMIN,IOPEGM
      COMMON /HSIRCX/ XIRDEL
      COMMON /HSOPTN/ INT2(5),INT3(15),ISAM2(5),ISAM3(15),
     *                IOPLOT,IPRINT,ICUT
      COMMON /HSISGM/ TCUTQ,TCUTQS
      COMMON /HSWGTC/ IWEIGS
      COMMON /HSONLY/ IHSONL
C---------------------------------------------------------------------
      PARAMETER(NDIM2=2,NBIN2=50)
      PARAMETER(NREG2N=2500)
C---                     NREG2N=NBIN2**NDIM2
      LOGICAL LGLO2,LLOC2
      COMMON /HSSNC2/ SIG2,SIG2E,T2GGMA,T2GMAX(NREG2N),
     +                XX2(50,2),
     +                FFGO2,DNCG2,FFLO2,DNCL2,GOLD2,
     +                NM2(NREG2N),NDO2,
     +                NTOT2,NCAL2,NCA12,NCA22,IBIM2,JCOR2,
     +                LGLO2,LLOC2
      PARAMETER(NREG2C=2500)
C---                     NREG2C=NBIN2**NDIM2
      LOGICAL LGLO2C,LLOC2C
      COMMON /HSSCC2/ SIG2C,SIG2EC,T2GMAC,T2MAXC(NREG2C),
     +                XX2C(50,2),
     +                FFGO2C,DNCG2C,FFLO2C,DNCL2C,GOLD2C,
     +                NM2C(NREG2C),NDO2C,
     +                NTOT2C,NCAL2C,NCA12C,NCA22C,IBIM2C,JCOR2C,
     +                LGLO2C,LLOC2C
      PARAMETER(NREG2E=50)
      PARAMETER(NDIM1=1)
C---                     NREG2E=NBIN2**NDIM1
      LOGICAL LGLO2E,LLOC2E
      COMMON /HSSEL2/ SIG2L,SIG2EE,T2GMAE,T2MAXE(NREG2E),
     +                XX2E(50,1),
     +                FFGO2E,DNCG2E,FFLO2E,DNCL2E,GOLD2E,
     +                NM2E(NREG2E),NDO2E,
     +                NTOT2E,NCAL2E,NCA12E,NCA22E,IBIM2E,JCOR2E,
     +                LGLO2E,LLOC2E
C-----------------------------
      PARAMETER(NDIM31=5,NBIN31=6,NREG31=7776)
C---                     NREG31=NBIN31**NDIM31
      LOGICAL LGLO31,LLOC31
      COMMON /HSSN31/ SIG31,SIG31E,T31GMA,T31MAX(NREG31),
     +                XX31(50,NDIM31),
     +                FFGO31,DNCG31,FFLO31,DNCL31,GOLD31,
     +                SI31,SI2N31,SWGT31,SCHI31,IT31,
     +                NM31(NREG31),NDO31,
     +                NTOT31,NCAL31,NCA131,NCA231,IBIM31,JCOR31,
     +                LGLO31,LLOC31
      PARAMETER(NDIM32=5,NBIN32=6,NREG32=7776)
C---                     NREG32=NBIN32**NDIM32
      LOGICAL LGLO32,LLOC32
      COMMON /HSSN32/ SIG32,SIG32E,T32GMA,T32MAX(NREG32),
     +                XX32(50,NDIM32),
     +                FFGO32,DNCG32,FFLO32,DNCL32,GOLD32,
     +                SI32,SI2N32,SWGT32,SCHI32,IT32,
     +                NM32(NREG32),NDO32,
     +                NTOT32,NCAL32,NCA132,NCA232,IBIM32,JCOR32,
     +                LGLO32,LLOC32
      PARAMETER(NDIM33=5,NBIN33=6,NREG33=7776)
C---                     NREG33=NBIN33**NDIM33
      LOGICAL LGLO33,LLOC33
      COMMON /HSSN33/ SIG33,SIG33E,T33GMA,T33MAX(NREG33),
     +                XX33(50,NDIM33),
     +                FFGO33,DNCG33,FFLO33,DNCL33,GOLD33,
     +                SI33,SI2N33,SWGT33,SCHI33,IT33,
     +                NM33(NREG33),NDO33,
     +                NTOT33,NCAL33,NCA133,NCA233,IBIM33,JCOR33,
     +                LGLO33,LLOC33
      PARAMETER(NDIM34=5,NBIN34=6,NREG34=7776)
C---                     NREG34=NBIN34**NDIM34
      LOGICAL LGLO34,LLOC34
      COMMON /HSSN34/ SIG34,SIG34E,T34GMA,T34MAX(NREG34),
     +                XX34(50,NDIM34),
     +                FFGO34,DNCG34,FFLO34,DNCL34,GOLD34,
     +                SI34,SI2N34,SWGT34,SCHI34,IT34,
     +                NM34(NREG34),NDO34,
     +                NTOT34,NCAL34,NCA134,NCA234,IBIM34,JCOR34,
     +                LGLO34,LLOC34
      PARAMETER(NDM3CC=5)
      PARAMETER(NBN31C=6,NRG31C=7776)
C---                     NRG31C=NBN31C**NDM3CC
      LOGICAL LGL31C,LLC31C
      COMMON /HSSC31/ SIG31C,SG31EC,T31GMC,T31MXC(NRG31C),
     +                XX31C(50,5),
     +                FFG31C,DNG31C,FFL31C,DNL31C,GLD31C,
     +                SI31C,S2N31C,SWT31C,SCH31C,IT31C,
     +                NM31C(NRG31C),NDO31C,
     +                NTT31C,NCL31C,NC131C,NC231C,IBM31C,JCR31C,
     +                LGL31C,LLC31C
      PARAMETER(NBN32C=6,NRG32C=7776)
C---                     NRG32C=NBN32C**NDM3CC
      LOGICAL LGL32C,LLC32C
      COMMON /HSSC32/ SIG32C,SG32EC,T32GMC,T32MXC(NRG32C),
     +                XX32C(50,5),
     +                FFG32C,DNG32C,FFL32C,DNL32C,GLD32C,
     +                SI32C,S2N32C,SWT32C,SCH32C,IT32C,
     +                NM32C(NRG32C),NDO32C,
     +                NTT32C,NCL32C,NC132C,NC232C,IBM32C,JCR32C,
     +                LGL32C,LLC32C
      PARAMETER(NBN33C=6,NRG33C=7776)
C---                     NRG33C=NBN33C**NDM3CC
      LOGICAL LGL33C,LLC33C
      COMMON /HSSC33/ SIG33C,SG33EC,T33GMC,T33MXC(NRG33C),
     +                XX33C(50,5),
     +                FFG33C,DNG33C,FFL33C,DNL33C,GLD33C,
     +                SI33C,S2N33C,SWT33C,SCH33C,IT33C,
     +                NM33C(NRG33C),NDO33C,
     +                NTT33C,NCL33C,NC133C,NC233C,IBM33C,JCR33C,
     +                LGL33C,LLC33C
      PARAMETER(NDM3EL=4)
      PARAMETER(NBN31E=8,NRG31E=4096)
C---                     NRG31C=NBN31E**NDM3EL
      LOGICAL LGL31E,LLC31E
      COMMON /HSSE31/ SIG31L,SG31EE,T31GME,T31MXE(NRG31E),
     +                XX31E(50,4),
     +                FFG31E,DNG31E,FFL31E,DNL31E,GLD31E,
     +                SI31E,S2N31E,SWT31E,SCH31E,IT31E,
     +                NM31E(NRG31E),NDO31E,
     +                NTT31E,NCL31E,NC131E,NC231E,IBM31E,JCR31E,
     +                LGL31E,LLC31E
      PARAMETER(NBN32E=8,NRG32E=4096)
C---                     NRG32E=NBN32E**NDM3EL
      LOGICAL LGL32E,LLC32E
      COMMON /HSSE32/ SIG32L,SG32EE,T32GME,T32MXE(NRG32E),
     +                XX32E(50,4),
     +                FFG32E,DNG32E,FFL32E,DNL32E,GLD32E,
     +                SI32E,S2N32E,SWT32E,SCH32E,IT32E,
     +                NM32E(NRG32E),NDO32E,
     +                NTT32E,NCL32E,NC132E,NC232E,IBM32E,JCR32E,
     +                LGL32E,LLC32E
      PARAMETER(NBN33E=8,NRG33E=4096)
C---                     NRG33E=NBN33E**NDM3EL
      LOGICAL LGL33E,LLC33E
      COMMON /HSSE33/ SIG33L,SG33EE,T33GME,T33MXE(NRG33E),
     +                XX33E(50,4),
     +                FFG33E,DNG33E,FFL33E,DNL33E,GLD33E,
     +                SI33E,S2N33E,SWT33E,SCH33E,IT33E,
     +                NM33E(NRG33E),NDO33E,
     +                NTT33E,NCL33E,NC133E,NC233E,IBM33E,JCR33E,
     +                LGL33E,LLC33E
C-----------------------------
      CHARACTER*45 CHNAME
      COMMON /HSNAMC/ CHNAME(20)
      COMMON /HSNUME/ SIGTOT,SIGTRR,SIGG(20),SIGGRR(20),NEVENT,NEVE(20)
      COMMON /HSELAB/ SP,EELE,PELE,EPRO,PPRO
      COMMON /HSCUTS/ XMIN,XMAX,Q2MIN,Q2MAX,YMIN,YMAX,WMIN,GMIN
      COMMON /HSTCUT/ THEMIN,CTHMIN,CTHCON
      COMMON /HSPCUT/ PTMIN,PTXM0
      COMMON /HSPARM/ POLARI,LLEPT,LQUA
      COMMON /HSUNTS/ LUNTES,LUNDAT,LUNIN,LUNOUT,LUNRND
      COMMON /HSPARL/ LPAR(20),LPARIN(12),IPART
      COMMON /HSPDFO/ IPDFOP,IFLOPT,LQCD,LTM,LHT
      COMMON /HSELEP/ IDIPOL
      COMMON /HSNUCL/ HNA,HNZ
      COMMON /HYSTFU/ PYSTOP,PYSLAM,NPYMOD,NPYMAX,NPYMIN
      REAL*4          PYSTOP,PYSLAM
      COMMON /HSALFS/ PAR111,PAR112,PARL11,PARL19,MST111,MST115
      REAL*4          PAR111,PAR112,PARL11,PARL19
      INTEGER         MST111,MST115

      DIMENSION IINT2(5),IINT3(15),IISAM2(5),IISAM3(15)
C---------------------------------------------------------------------
      LOGICAL LLGLO2,LLLOC2
      DIMENSION XT2GMAX(NREG2N),INM2(NREG2N)
      LOGICAL LLGLO2C,LLLOC2C
      DIMENSION XT2MAXC(NREG2C),INM2C(NREG2C)
      LOGICAL LLGLO31,LLLOC31
      DIMENSION XT2MAXE(NREG2E),INM2E(NREG2E)
      LOGICAL LLGLO2E,LLLOC2E
      DIMENSION XT31MAX(NREG31),INM31(NREG31)
      LOGICAL LLGLO32,LLLOC32
      DIMENSION XT32MAX(NREG32),INM32(NREG32)
      LOGICAL LLGLO33,LLLOC33
      DIMENSION XT33MAX(NREG33),INM33(NREG33)
      LOGICAL LLGLO34,LLLOC34
      DIMENSION XT34MAX(NREG34),INM34(NREG34)
      LOGICAL LLGL31C,LLLC31C
      DIMENSION XT31MXC(NRG31C),INM31C(NRG31C)
      LOGICAL LLGL32C,LLLC32C
      DIMENSION XT31MXE(NRG31E),INM31E(NRG31E)
      LOGICAL LLGL31E,LLLC31E
      DIMENSION XT32MXC(NRG32C),INM32C(NRG32C)
      LOGICAL LLGL33C,LLLC33C
      DIMENSION XT32MXE(NRG32E),INM32E(NRG32E)
      LOGICAL LLGL32E,LLLC32E
      DIMENSION XT33MXC(NRG33C),INM33C(NRG33C)
      LOGICAL LLGL33E,LLLC33E
      DIMENSION XT33MXE(NRG33E),INM33E(NRG33E)
C-----------------------------
      CHARACTER*45 CCHNAME
      DIMENSION CCHNAME(20),XSIGG(20),XSIGGRR(20),INEVE(20)
      DIMENSION ILPAR(20),ILPARIN(12)
      REAL          XPAR111,XPAR112
      INTEGER         IMST111,IMST115

C
C--- STANDARD KINEMATICS
      DATA XEELE, XEPRO  / 27.6D0, 820D0 /
      DATA XSIGTOT,XSIGTRR,XSIGG,XSIGGRR /42*0D0/
      DATA INEVENT,INEVE               /21*0/
      DATA ILUNIN,ILUNOUT,ILUNTES,ILUNRND,ILUNDAT
     *    /    5,     6,     6,    10,    11/
      DATA ININP,INOUTP /   5,    6/
      DATA IISDINP,IISDOUT / 0, 0/
      DATA INPOVEG   / 10000 /
      DATA IINT2, IINT3   / 20*0/
      DATA IISAM2, IISAM3 / 20*0/
      DATA IIOPLOT, IIPRINT /  0, 0 /
      DATA IIWEIGS / 0 /
      DATA IIHSONL / 1 /
      DATA XDELEPS, XDELTA, XEGMIN, IIOPEGM   / 2D-2,  0D0,  0D0, 0 /
      DATA XXIRDE /2D-4/
      DATA XXMIN, XXMAX, XQ2MIN, XQ2MAX, XYMIN, XYMAX, XWMIN, IICUT
     *    /1D-10,  1D0,   4D0,   1D8, 1D-2,  1D0,  5D0,    3 /
      DATA XTHEMIN,XCTHMIN,XCTHCON,XPTMIN,XPTXM0
     *    /0D0   ,1D0,   1D15,  0D0,  0D0  /
      DATA XTCUTQ,XTCUTQS / 0.25, 0.25/
      DATA XPOLARI, ILLEPT, ILQUA  /   0D0,    -1,    0/
C
C---DEFINE GSW PARAMETERS
      DATA ILPARIN / 2, 1, 3, 1, 0, 0, 2, 0, 0, 0, 0, 1/
      DATA IIPART  / 123041/
      DATA INPYMIN /1/, INPYMAX/6/
      DATA XPAR111 /0.2/, XPAR112/0.25/, IMST111/1/, IMST115/0/
      DATA XPARL11 /0.01/, XPARL19/0.03/
      DATA ILPAR / 1, 1, 3, 2, 0, 123041, 2, 0, 0, 0,
     *            1, 1, 0, 0, 0, 0, 0, 2, 0, 0/
      DATA IIPDFOP / 1 /
      DATA IIFLOPT,ILQCD,ILTM,ILHT / 4*0 /
      DATA IIDIPOL / 0 /
      DATA XHNA,XHNZ / 1D0,1D0 /
C
      DATA  XSIG2, XSIG2E, XT2GGMA, XT2GMAX   , INM2,     INDO2
     *    / 0D0 ,   0D0,    0D0, NREG2N*0D0, NREG2N*0,   50/
      DATA XFFGO2, XDNCG2, XFFLO2, XDNCL2, XGOLD2  /5*0D0/
      DATA LLGLO2,LLLOC2 /2*.FALSE./
C
      DATA  XSIG2C, XSIG2EC, XT2GMAC, XT2MAXC   , INM2C   ,  INDO2C
     *    /  0D0 ,    0D0,    0D0, NREG2C*0D0, NREG2C*0,     50/
      DATA XFFGO2C, XDNCG2C, XFFLO2C, XDNCL2C, XGOLD2C  /5*0D0/
      DATA LLGLO2C,LLLOC2C /2*.FALSE./
C
      DATA  XSIG2L, XSIG2EE, XT2GMAE, XT2MAXE   , INM2E   ,  INDO2E
     *    /  0D0 ,    0D0,    0D0, NREG2E*0D0, NREG2E*0,     50/
      DATA XFFGO2E, XDNCG2E, XFFLO2E, XDNCL2E, XGOLD2E  /5*0D0/
      DATA LLGLO2E,LLLOC2E /2*.FALSE./
C
      DATA  XSIG31, XSIG31E, XT31GMA, XT31MAX    , INM31    , INDO31
     *     / 0D0 ,    0D0,    0D0, NREG31*0D0, NREG31*0,    50/
      DATA XFFGO31,XDNCG31,XFFLO31,XDNCL31,XGOLD31 /5*0D0/
      DATA LLGLO31,LLLOC31 /2*.FALSE./
C
      DATA  XSIG32, XSIG32E, XT32GMA, XT32MAX    , INM32    , INDO32
     *     / 0D0 ,    0D0,    0D0, NREG32*0D0, NREG32*0,    50/
      DATA XFFGO32,XDNCG32,XFFLO32,XDNCL32,XGOLD32 /5*0D0/
      DATA LLGLO32,LLLOC32 /2*.FALSE./
C
      DATA  XSIG33, XSIG33E, XT33GMA, XT33MAX    , INM33    , INDO33
     *     / 0D0 ,    0D0,    0D0, NREG33*0D0, NREG33*0,    50/
      DATA XFFGO33,XDNCG33,XFFLO33,XDNCL33,XGOLD33 /5*0D0/
      DATA LLGLO33,LLLOC33 /2*.FALSE./
C
      DATA  XSIG34, XSIG34E, XT34GMA, XT34MAX    , INM34    , INDO34
     *     / 0D0 ,    0D0,    0D0, NREG34*0D0, NREG34*0,    50/
      DATA XFFGO34,XDNCG34,XFFLO34,XDNCL34,XGOLD34 /5*0D0/
      DATA LLGLO34,LLLOC34 /2*.FALSE./
C
      DATA  XSIG31C, XSG31EC, XT31GMC, XT31MXC    , INM31C   , INDO31C
     *     /  0D0 ,    0D0,    0D0, NRG31C*0D0, NRG31C*0,     50/
      DATA XFFG31C,XDNG31C,XFFL31C,XDNL31C,XGLD31C /5*0D0/
      DATA LLGL31C,LLLC31C /2*.FALSE./
      DATA  XSIG32C, XSG32EC, XT32GMC, XT32MXC    , INM32C   , INDO32C
     *     /  0D0 ,    0D0,    0D0, NRG32C*0D0, NRG32C*0,     50/
      DATA XFFG32C,XDNG32C,XFFL32C,XDNL32C,XGLD32C /5*0D0/
      DATA LLGL32C,LLLC32C /2*.FALSE./
      DATA  XSIG33C, XSG33EC, XT33GMC, XT33MXC    , INM33C   , INDO33C
     *     /  0D0 ,    0D0,    0D0, NRG33C*0D0, NRG33C*0,     50/
      DATA XFFG33C,XDNG33C,XFFL33C,XDNL33C,XGLD33C /5*0D0/
      DATA LLGL33C,LLLC33C /2*.FALSE./
C
      DATA  XSIG31L, XSG31EE, XT31GME, XT31MXE    , INM31E   , INDO31E
     *     /  0D0 ,    0D0,    0D0, NRG31E*0D0, NRG31E*0,     50/
      DATA XFFG31E,XDNG31E,XFFL31E,XDNL31E,XGLD31E /5*0D0/
      DATA LLGL31E,LLLC31E /2*.FALSE./
      DATA  XSIG32L, XSG32EE, XT32GME, XT32MXE    , INM32E   , INDO32E
     *     /  0D0 ,    0D0,    0D0, NRG32E*0D0, NRG32E*0,     50/
      DATA XFFG32E,XDNG32E,XFFL32E,XDNL32E,XGLD32E /5*0D0/
      DATA LLGL32E,LLLC32E /2*.FALSE./
      DATA  XSIG33L, XSG33EE, XT33GME, XT33MXE    , INM33E   , INDO33E
     *     /  0D0 ,    0D0,    0D0, NRG33E*0D0, NRG33E*0,     50/
      DATA XFFG33E,XDNG33E,XFFL33E,XDNL33E,XGLD33E /5*0D0/
      DATA LLGL33E,LLLC33E /2*.FALSE./
      DATA CCHNAME /
     &   'NEUTRAL CURRENT / ELASTIC + SOFT&VIRTUAL     ',
     &   'CHARGED CURRENT / ELASTIC + SOFT&VIRTUAL     ',
     &   'ELASTIC EP / NON-RADIATIVE + SOFT&VIRTUAL    ',
     &   'UNDEFINED                                    ',
     &   'UNDEFINED                                    ',
     &   'NEUTRAL CURRENT / LEPT. INITIAL STATE RADIAT.',
     &   'NEUTRAL CURRENT / LEPT. FINAL STATE RADIAT.  ',
     &   'NEUTRAL CURRENT / LEPT. COMPTON CONTRIBUTION ',
     &   'NEUTRAL CURRENT / QUARKONIC RADIATION        ',
     &   'UNDEFINED                                    ',
     &   'UNDEFINED                                    ',
     &   'CHARGED CURRENT / LEPT. INITIAL STATE RADIAT.',
     &   'CHARGED CURRENT / QUARK. INITIAL STATE RAD.  ',
     &   'CHARGED CURRENT / QUARK. FINAL STATE RADIAT. ',
     &   'ELASTIC TAIL / INITIAL STATE RADIATION       ',
     &   'ELASTIC TAIL / FINAL STATE RADIATION         ',
     &   'ELASTIC TAIL / COMTPON PART                  ',
     &   'UNDEFINED                                    ',
     &   'UNDEFINED                                    ',
     &   'UNDEFINED                                    '/
C
C------------------------------------------------------------------------------
C copy back variables:
C------------------------------------------------------------------------------

      EELE = XEELE
      EPRO = XEPRO
c cut on angle of scattered electron
      THEMIN=0.

      SIGTOT = XSIGTOT
      SIGTRR = XSIGTRR

C-MH for H1: NEVENT replaced by NNEVNT

      NNEVNT = INEVENT
C-MH

      LUNIN  = ILUNIN
      LUNOUT = ILUNOUT
      LUNTES = ILUNTES
      LUNRND = ILUNRND
      LUNDAT = ILUNDAT

      NINP   = ININP
      NOUTP  = INOUTP

      ISDINP = IISDINP
      ISDOUT = IISDOUT

      NPOVEG = INPOVEG
      IOPLOT = IIOPLOT
      IPRINT = IIPRINT
      IWEIGS = IIWEIGS
      IHSONL = IIHSONL

      DELEPS = XDELEPS
      DELTA  = XDELTA
      EGMIN  = XEGMIN
      IOPEGM = IIOPEGM

      XIRDE = XXIRDE
      XMIN   = XXMIN
      XMAX   = XXMAX
      Q2MIN  = XQ2MIN
      Q2MIN  = XQ2MAX
      YMIN   = XYMIN
      YMAX   = XYMAX
      WMIN   = XWMIN
      ICUT   = IICUT
      THEMI=XTHEMIN
      CTHMI=XCTHMIN
      CTHCON=XCTHCON
      PTMIN=XPTMIN
      PTXM0=XPTXM0

      TCUTQ  = XTCUTQ
      TCUTQS = XTCUTQS

      POLARI = XPOLARI
      LLEPT  = ILLEPT
      LQUA   = ILQUA

      IPART  = IIPART
      NPYMIN = INPYMIN
      NPYMAX = INPYMAX
      PAR111 = XPAR111
      PAR112 = XPAR112
      MST111 = IMST111
      MST115 = IMST115

      PARL11 = XPARL11
      PARL19 = XPARL19

      IPDFOP = IIPDFOP
      IFLOPT = IIFLOPT
      LQCD   = ILQCD
      LTM    = ILTM
      LHT    = ILHT

      IDIPOL = IIDIPOL

      HNA=XHNA
      HNZ=XHNZ

      SIG2   = XSIG2
      SIG2E  = XSIG2E
      T2GGMA = XT2GGMA
      NDO2   = INDO2

      FFGO2  = XFFGO2
      DNCG2  = XDNCG2
      FFLO2  = XFFLO2
      DNCL2  = XDNCL2
      GOLD2  = XGOLD2

      LGLO2  = LLGLO2
      LLOC2  = LLLOC2

      SIG2C  = XSIG2C
      SIG2EC = XSIG2EC
      T2GMAC = XT2GMAC
      NDO2C  = INDO2C

      FFGO2C = XFFGO2C
      DNCG2C = XDNCG2C
      FFLO2C = XFFLO2C
      DNCL2C = XDNCL2C
      GOLD2C = XGOLD2C
      LGLO2C = LLGLO2C
      LLOC2C = LLLOC2C

      SIG2L  = XSIG2L
      SIGEE = XSIG2EE
      T31GME = XT31GME
      NDO2E  = INDO2E
      FFGO2E = XFFGO2E
      DNCG2E = XDNCG2E
      FFLO2E = XFFLO2E
      DNCL2E = XDNCL2E
      GOLD2E = XGOLD2E
      LGLO2E = LLGLO2E
      LLOC2E = LLLOC2E

      SIG31  = XSIG31
      SIG31E = XSIG31E
      T31GMA = XT31GMA
      NDO31  = INDO31
      FFGO31 = XFFGO31
      DNCG31 = XDNCG31
      FFLO31 = XFFLO31
      DNCL31 = XDNCL31
      GOLD31 = XGOLD31
      LGLO31 = LLGLO31
      LLOC31 = LLLOC31

      SIG32  = XSIG32
      SIG32E = XSIG32E
      T32GMA = XT32GMA
      NDO32  = INDO32
      FFGO32 = XFFGO32
      DNCG32 = XDNCG32
      FFLO32 = XFFLO32
      DNCL32 = XDNCL32
      GOLD32 = XGOLD32
      LGLO32 = LLGLO32
      LLOC32 = LLLOC32

      SIG33  = XSIG33
      SIG33E = XSIG33E
      T33GMA = XT33GMA
      NDO33  = INDO33
      FFGO33 = XFFGO33
      DNCG33 = XDNCG33
      FFLO33 = XFFLO33
      DNCL33 = XDNCL33
      GOLD33 = XGOLD33
      LGLO33 = LLGLO33
      LLOC33 = LLLOC33

      SIG34  = XSIG34
      SIG34E = XSIG34E
      T34GMA = XT34GMA
      NDO34  = INDO34
      FFGO34 = XFFGO34
      DNCG34 = XDNCG34
      FFLO34 = XFFLO34
      DNCL34 = XDNCL34
      GOLD34 = XGOLD34
      LGLO34 = LLGLO34
      LLOC34 = LLLOC34

      SIG31C  = XSIG31C
      SG31EC  = XSG31EC
      T31GMC  = XT31GMC
      NDO31C  = INDO31C
      FFG31C  = XFFG31C
      DNG31C  = XDNG31C
      FFL31C  = XFFL31C
      DNL31C  = XDNL31C
      GLD31C  = XGLD31C
      LGL31C  = LLGL31C
      LLC31C  = LLLC31C

      SIG32C  = XSIG32C
      SG32EC  = XSG32EC
      T32GMC  = XT32GMC
      NDO32C  = INDO32C
      FFG32C  = XFFG32C
      DNG32C  = XDNG32C
      FFL32C  = XFFL32C
      DNL32C  = XDNL32C
      GLD32C  = XGLD32C
      LGL32C  = LLGL32C
      LLC32C  = LLLC32C

      SIG33C  = XSIG33C
      SG33EC  = XSG33EC
      T33GMC  = XT33GMC
      NDO33C  = INDO33C
      FFG33C  = XFFG33C
      DNG33C  = XDNG33C
      FFL33C  = XFFL33C
      DNL33C  = XDNL33C
      GLD33C  = XGLD33C
      LGL33C  = LLGL33C
      LLC33C  = LLLC33C


      SIG33C  = XSIG33C
      SG33EC  = XSG33EC
      T33GMC  = XT33GMC
      NDO33C  = INDO33C
      FFG33C  = XFFG33C
      DNG33C  = XDNG33C
      FFL33C  = XFFL33C
      DNL33C  = XDNL33C
      GLD33C  = XGLD33C
      LGL33C  = LLGL33C
      LLC33C  = LLLC33C


      SIG31L  = XSIG31L
      SG31EE  = XSG31EE
      T31GME  = XT31GME
      NDO31E  = INDO31E
      FFG31E  = XFFG31E
      DNG31E  = XDNG31E
      FFL31E  = XFFL31E
      DNL31C  = XDNL31E
      GLD31E  = XGLD31E
      LGL31E  = LLGL31E
      LLC31E  = LLLC31E

      SIG32L  = XSIG32L
      SG32EE  = XSG32EE
      T32GME  = XT32GME
      NDO32E  = INDO32E
      FFG32E  = XFFG32E
      DNG32E  = XDNG32E
      FFL32E  = XFFL32E
      DNL32C  = XDNL32E
      GLD32E  = XGLD32E
      LGL32E  = LLGL32E
      LLC32E  = LLLC32E

      SIG33L  = XSIG33L
      SG33EE  = XSG33EE
      T33GME  = XT33GME
      NDO33E  = INDO33E
      FFG33E  = XFFG33E
      DNG33E  = XDNG33E
      FFL33E  = XFFL33E
      DNL33C  = XDNL33E
      GLD33E  = XGLD33E
      LGL33E  = LLGL33E
      LLC33E  = LLLC33E

C--->

      NUMBER = 40
      CALL UCOPY(XSIGG,SIGG,NUMBER)

      NUMBER = 40
      CALL UCOPY(XSIGGRR,SIGGRR,NUMBER)

      NUMBER = 20
      CALL UCOPY(INEVE,NEVE,NUMBER)

      NUMBER = 5
      CALL UCOPY(IINT2,INT2,NUMBER)

      NUMBER = 15
      CALL UCOPY(IINT3,INT3,NUMBER)

      NUMBER = 5
      CALL UCOPY(IISAM2,ISAM2,NUMBER)

      NUMBER = 15
      CALL UCOPY(IISAM3,ISAM3,NUMBER)

      NUMBER = 12
      CALL UCOPY(ILPARIN,LPARIN,NUMBER)

      NUMBER = 20
      CALL UCOPY(ILPAR,LPAR,NUMBER)

      NUMBER = NREG2N * 2
      CALL UCOPY(XT2GMAX,T2GMAX,NUMBER)

      NUMBER = NREG2N
      CALL UCOPY(INM2,NM2,NUMBER)

      NUMBER = NREG2C * 2
      CALL UCOPY(XT2MAXC,T2MAXC,NUMBER)

      NUMBER = NREG2C
      CALL UCOPY(INM2C,NM2C,NUMBER)

      NUMBER = NREG2E * 2
      CALL UCOPY(XT2GME,T2GME,NUMBER)

      NUMBER = NREG2E
      CALL UCOPY(INM2E,NM2E,NUMBER)

      NUMBER = NREG31 * 2
      CALL UCOPY(XT31MAX,T31MAX,NUMBER)

      NUMBER = NREG31
      CALL UCOPY(INM31,NM31,NUMBER)

      NUMBER = NREG32 * 2
      CALL UCOPY(XT32MAX,T32MAX,NUMBER)

      NUMBER = NREG32
      CALL UCOPY(INM32,NM32,NUMBER)

      NUMBER = NREG33 * 2
      CALL UCOPY(XT33MAX,T33MAX,NUMBER)

      NUMBER = NREG33
      CALL UCOPY(INM33,NM33,NUMBER)

      NUMBER = NREG34 * 2
      CALL UCOPY(XT34MAX,T34MAX,NUMBER)

      NUMBER = NREG34
      CALL UCOPY(INM34,NM34,NUMBER)

      NUMBER = NRG31C * 2
      CALL UCOPY(XT31MXC,T31MXC,NUMBER)

      NUMBER = NRG31C
      CALL UCOPY(INM31C,NM31C,NUMBER)

      NUMBER = NRG32C * 2
      CALL UCOPY(XT32MXC,T32MXC,NUMBER)

      NUMBER = NRG32C
      CALL UCOPY(INM32C,NM32C,NUMBER)

      NUMBER = NRG33C * 2
      CALL UCOPY(XT33MXC,T33MXC,NUMBER)

      NUMBER = NRG33C
      CALL UCOPY(INM33C,NM33C,NUMBER)

      NUMBER = NRG31E * 2
      CALL UCOPY(XT31MXE,T31MXE,NUMBER)

      NUMBER = NRG31E
      CALL UCOPY(INM31E,NM31E,NUMBER)

      NUMBER = NRG32E * 2
      CALL UCOPY(XT32MXE,T32MXE,NUMBER)

      NUMBER = NRG32E
      CALL UCOPY(INM32E,NM32E,NUMBER)

      NUMBER = NRG33E * 2
      CALL UCOPY(XT33MXE,T33MXE,NUMBER)

      NUMBER = NRG33E
      CALL UCOPY(INM33E,NM33E,NUMBER)

      NUMBER = 225
      CALL UCOPY(CCHNAME,CHNAME,NUMBER)

      write(6,*) ' HERACLES 4.6.1 BLOCK DATA initialized '
      RETURN
      END
*CMZ :  2.08/04 22/12/99  15.39.36  by  Hannes Jung
*CMZ :  2.06/39 07/07/98  15.33.52  by  Hannes Jung
*CMZ :  2.06/02 19/08/97  16.26.26  by  Hannes Jung
*-- Author :    Hannes Jung   19/08/97
      DOUBLE PRECISION FUNCTION HSRNDM()
      Double Precision draprn
      EXTERNAL draprn
      LOGICAL FIRST
      DATA FIRST/.TRUE./
      IF(FIRST) THEN
         write(6,*) ' change of random number generator:               '
     +   //'              call hsrndm = draprn'
         FIRST = .FALSE.
      ENDIF
      HSRNDM = draprn()
      RETURN
      END
*CMZ :  2.06/51 10/10/98  10.30.09  by  Hannes Jung
*CMZ :  2.06/44 28/07/98  18.49.16  by  Hannes Jung
*CMZ :  2.06/39 16/07/98  11.40.09  by  Hannes Jung
*CMZ :  2.06/38 05/07/98  21.25.53  by  Hannes Jung
*CMZ :  6.22/00 20/07/95  17.30.36  by  Martin Hampel
*-- Author :
C **********************************************************************

      FUNCTION FLGINT(Z)

C...Gluon contribution integrand to QCD longitudinal structure function.
      DOUBLE PRECISION PARL
      COMMON /RAPTOU/ CUT(14),LST(40),PARL(30),X,Y,W2,Q2,U
      COMMON /LINTER/ PARI(40),EWQC(2,2,8),QC(8),ZL(2,4),ZQ(2,8),PQ(17)
      COMMON /LINTEG/ NTOT,NPASS
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEND.
      DIMENSION XPQ(-6:6)
      DATA PI/3.14159/
      NTOT=NTOT+1
      IF(IHF.EQ.0) THEN
         CALL LNSTRF(Z,Q2,XPQ)
         FLGINT=20./9.*PARL(25)/PI*(X/Z)**2*(1.-X/Z)/Z*XPQ(0)
         NPASS=NPASS+1
      ELSEIF(IHF.EQ.1) THEN
         FLGINT=FLHF(Z,X,Q2)
         NPASS=NPASS+1
      ELSE
         write(6,*) ' FLGINT wrong IHF = ',IHF
         STOP
      ENDIF


      RETURN
      END

      FUNCTION FLHF(X1,X,Q2)
      IMPLICIT DOUBLE PRECISION (A-G,O-Z)
      REAL X1,FLHF,XS,sscal
      REAL X,Q2,LUCHGE,ULMASS,XX,Q2X
      COMMON /HEAVYF/XX,Q2X,KPHF
      REAL XPQ(-6:6)
      REAL SNGL
      EXTERNAL LUCHGE,ULMASS
      pi=2.d0*dasin(1.d0)
      flhf = 0.0
      f2 = 0.0D0
      xt = 0.0D0
      AM = DBLE(ULMASS(KPHF))
      SMIN = 4.D0*AM**2
      CHIMIN=DBLE(X)*(1.D0 + SMIN/DBLE(Q2))
      CHIMIN = DMAX1(CHIMIN,DBLE(X))
      XPMIN = DBLE(X)
      XPMAX = DBLE(X)/CHIMIN
c      write(6,*) ' flhf x,q2',x,q2
c       write(6,*) ' flhf xpmax,xpmin',xpmax,xpmin
c       write(6,*) ' flhf: CHIMIN,x,smin,q2',CHIMIN,x,smin,q2
      if(xpmax.lt.xpmin) then
c       write(6,*) ' flhf xpmax,xpmin',xpmax,xpmin
c       write(6,*) ' flhf: CHIMIN,x,smin,q2',CHIMIN,x,smin,q2
         return
      endif
      IF(XPMIN.EQ.0.0D0) THEN
         write(6,*) ' flhf XPMIN CHIMIN,X ',CHIMIN,X,AM
      ENDIF
      XP = XPMIN * (XPMAX/XPMIN)**DBLE(X1)
cc      XP = XPMIN + DBLE(X1)*(XPMAX-XPMIN)
      IF((4.d0*am**2*xp/DBLE(Q2)/(1.d0-xp)).GE.1.d0) RETURN
      beta2 = 1.d0 - 4.d0*am**2*xp/DBLE(Q2)/(1.d0-xp)
      beta = dsqrt(beta2)
      ZQMAX = 1.d0 + beta
      ZQMIN = 1.d0 - beta
      xksi = am**2/DBLE(q2)
c         IF(ZQMIN.GT.0.5) RETURN
c        write(6,*) ' flhf CHIMIN,X,am,kphf ',CHIMIN,X,AM,KPHF
c        write(6,*) ' flhf beta,zqmax,zqmin',beta,zqmax,zqmin,xp
      zlog = dlog(zqmax/zqmin)
      SCAL=4.D0*AM**2
      ALPHA_S=ALPHAS(DSQRT(SCAL))
c      write(6,*) ' flhf alphas ',alpha_s
      xg = dble(x)/xp
      xt = zlog*(0.5d0*xp - xp**2 *(1.d0-xp) + 2.d0*xksi*xp**2*(1.d0-
     +3.d0*xp) - 4.d0*xksi**2*xp**3) + beta*(4.d0*xp**2*(1.d0-xp) -
     +0.5d0*xp -2.d0*xp**2*xksi*(1.d0-xp))
c note the following line is different in massless case from Peccei/Ruckl
c    +        + beta*(3.d0*xp**2*(1.d0-xp) - 0.5d0*xp ! Peccei/Ruckl
      xl = 2.d0*beta*xp**2*(1.d0-xp) -4.d0*xp**3*xksi*zlog
      f2 = alpha_s * xt /pi
      fl = alpha_s * xl /pi
c      write(6,*) 'x,xp,xglu ',x,xp,xg
      f2 = f2/xp
      fl = fl/xp
      if(xg.ge.1.) write(6,*) ' flhf  xg>1 ',xg,x,xp,x1
      XS = SNGL(XG)
      sscal = sngl(scal)
      CALL RYSTFU(2212,XS,SSCAL,XPQ)
c      write(6,*) ' flhf xs,scal,xpq(0) ',xs,scal,xpq(0)
      wtg = dble(XPQ(0))
      f2 = f2 * wtg
      if(x1.gt.1..or.x1.lt.0.) THEN
         write(6,*) ' flhf: x1 = ',x1,AM
      endif
c      write(6,*) ' f2,xp ',f2,xp
c      write(6,*) 'flhf: x1 = ',x1,AM
c      write(6,*) ' flhf ',f2,xp
      FLHF = SNGL(fl* XP*DLOG(XPMAX/XPMIN))
cc      flhf = SNGL(f2* (XPMAX-XPMIN))
      RETURN
      END
*CMZ :  2.06/51 10/10/98  10.30.09  by  Hannes Jung
*CMZ :  2.06/44 28/07/98  18.35.31  by  Hannes Jung
*CMZ :  2.06/39 16/07/98  11.40.09  by  Hannes Jung
*CMZ :  2.06/38 05/07/98  18.42.22  by  Hannes Jung
*CMZ :  6.22/00 20/07/95  17.30.36  by  Martin Hampel
*-- Author :
C **********************************************************************

      FUNCTION FLQINT(Z)

C...Quark contribution integrand to QCD longitudinal structure function.
      DOUBLE PRECISION PARL
      COMMON /RAPTOU/ CUT(14),LST(40),PARL(30),X,Y,W2,Q2,U
      COMMON /LINTER/ PARI(40),EWQC(2,2,8),QC(8),ZL(2,4),ZQ(2,8),PQ(17)
      COMMON /LINTEG/ NTOT,NPASS
      DIMENSION XPQ(-6:6)
*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEND.
      DATA PI/3.14159/
      NTOT=NTOT+1
      IF(IHF.EQ.0) THEN
         CALL LNSTRF(Z,Q2,XPQ)
         FLQINT=0.
         DO 10 I=-LST(12),LST(12)
            IF(I.EQ.0) GOTO 10
            FLQINT=FLQINT+QC(IABS(I))**2*XPQ(I)
   10    CONTINUE
         FLQINT=4./3.*PARL(25)/PI*(X/Z)**2*FLQINT/Z
      ENDIF
      NPASS=NPASS+1


      RETURN
      END
*CMZ :  2.08/05 30/03/2000  14.54.02  by  Hannes Jung
*CMZ :  2.08/04 21/12/99  12.01.05  by  Hannes Jung
*CMZ :  2.08/03 07/12/99  18.29.17  by  Hannes Jung
*CMZ :  2.08/02 04/11/99  16.39.09  by  Hannes Jung
*-- Author :
      Subroutine PARTKINE
      IMPLICIT NONE
c
C modified by H. Kowalski 11. Oct 1999
c   author    H.Kowalski
c   Reconstruction of parton four vectors from dynamic (generated) variables
c   Q2,Mx2,W2 and Kt2 (for 2 Body FiPaSt) or QtG2,SM2,KtQ2 (for 3 Body FiPaSt)
c   Results are stored in Common LUJETS
c
      Double Precision  Stot, Q2, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2, W2, Mx2, AJAC
      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf
      Double Precision    PGAMCM   , PPOMCM,   PGPOMCM
      Common /CINPKINE/   PGAMCM(5), PPOMCM(5),PGPOMCM(5)
      Double Precision   Qpar2BL   ,QBpar2BL,   Qpar2BC   ,QBpar2BC
      Common /C2BOKINE/  Qpar2BL(4),QBpar2BL(4),Qpar2BC(4),QBpar2BC(4)

      Double Precision    Kpar3BL   , Qpar3BL    ,QBpar3BL
      Double Precision    Kpar3BC   , Qpar3BC    ,QBpar3BC
      Common /C3BOKINE/   Kpar3BL(4), Qpar3BL(4) ,QBpar3BL(4),
     &                    Kpar3BC(4), Qpar3BC(4) ,QBpar3BC(4)

      Double Precision    Kt2, WT2
      COMMON /C2BODVAR/   Kt2, WT2
      Double Precision    KtG2, QtG2, SM2, ZW, KW2, WT3, YCUT
      COMMON /C3BODVAR/   KtG2, QtG2, SM2, ZW, KW2, WT3, YCUT


      Integer QFKF
      Double Precision    MQUARK, MCHARM
      COMMON /CQMASS/     MQUARK, MCHARM, QFKF

      Double Precision    LIMKIND
      Integer             IKIND,      Nevent, Ievent
      Common /CKIND/      LIMKIND(20),IKIND , Nevent, Ievent

*KEEP,RGLUJETS.
      INTEGER N,K
      REAL SP,V
      DOUBLE PRECISION P
      INTEGER LUPAN
      PARAMETER (LUPAN=4000)


      COMMON/LUJETS/N,K(LUPAN,5),SP(LUPAN,5),V(LUPAN,5)
      COMMON/DUJETS/P(LUPAN,5)
      REAL ULMASS
      DOUBLE PRECISION DOT1,DPLU,DLANGL
      EXTERNAL DLANGL,ULMASS,DPLU,LUCHGE,DOT1
C      SAVE

*KEEP,RGLUCO.
      REAL PLEPIN,PPIN
      INTEGER KE,KP,KEB,KPH,KGL,KPA,NFRAG,ILEPTO,IFPS,IHF,IALMKT
      INTEGER INTER,ISEMIH
      INTEGER NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT,NFLAV,NFLQCDC
      COMMON/LUCO  /KE,KP,KEB,KPH,KGL,KPA,NFLAV,NFLQCDC
      COMMON/INPU  /PLEPIN,PPIN,NFRAG,ILEPTO,IFPS,IHF,IALMKT,INTER,
     +              ISEMIH
      COMMON/HARD/ NIA1,NIR1,NIA2,NIR2,NF1,NF2,NFT
      INTEGER IHFLA
      COMMON/HFLAV/ IHFLA
C      SAVE

*KEND.

      Double Precision  RANUNI, AALAM, MQU2, MQU
      DATA MQU /0.01/, MQU2 /0.0001/
      Double Precision  TWOPI, Kl2, Kt, Kl, Mx, PHIRN
      Double Precision  DUM, FourDot, QFRAN, SIGQFRAN

      Double Precision  PDECAY1(4,2), PDECAY2(4,2)
      Double Precision  QtG, QlG, QlG2, costh
      Double Precision  THREEDOT
      Real theta

      Integer I, J,  IL, QF, Ip, SIGQF
      Real ECM, X1, X3
      Integer NJOIN, IJOIN(3)

      double precision xm1,xm2,xm3

      LOGICAL DEBUG

      DEBUG = .false.
      TWOPI = 2.*3.1415927

c
c store gamma* and pomeron vector
c
      IL = NIA1+2
      Mx = dsqrt(Mx2)

c         Write (*,10003) IL, NIA1,IKIND, MQUARK
10003    Format('PARTKINE IL',3I6,f9.3)

c      Call DUlist(1)
***************************************************************
c Choice of the quark flavor and its mass
      If(Mx.le.1.) THEN
         QFRAN = RANUNI(0.D0,1.D0)
         QF = 1
         if(QFRAN.le.0.8) QF=2
         MQU = 0.
      EndIf

      If(Mx.gt.1.) THEN
         QFRAN = RANUNI(0.D0,1.D0)
         QF = 3
         if(QFRAN.le.0.66666) QF=2
         if(QFRAN.gt.0.66666.and.QFRAN.le.0.833333) QF=1
         MQU = 0.
      EndIf

      If(IKIND.gt.10) Then
         QF = 4
         MQU = MCHARM
      EndIf
c End of Choice of the quark flavor and its mass
*************************************************************

      MQU2 = MQU**2

      SIGQFRAN = RANUNI(0.D0,1.D0)
      SIGQF = 1
      if(SIGQFRAN.le.0.5) SIGQF = -1

      If(IKIND.eq. 3.or.IKIND.eq. 4) Goto 10
      If(IKIND.eq.13.or.IKIND.eq.14) Goto 10

      ip = il

      If(IKIND.lt.10) Then
         Do i = 1,4
            P(Ip,  i) =   QBpar2BL(i)
            P(Ip+1,i) =   Qpar2BL(i)
         EndDo
      EndIf
      If(IKIND.gt.10) Then
         Do i = 1,4
            P(Ip,  i) =   QBpar2BC(i)
            P(Ip+1,i) =   Qpar2BC(i)
         EndDo
      EndIf
      P(Ip,  5) =  MQU
      P(Ip+1,5) =  MQU

      K(Ip,1)=   2
      K(Ip,2)=  -SIGQF*QF
      K(Ip+1,1)= 1
      K(Ip+1,2)= SIGQF*QF

c added hannes	
	KPA = K(Ip,2)
c end added hannes	

c check on on-shellness
c      xm1=dot1(ip,ip)
c      xm2=dot1(ip+1,ip+1)
c      write(6,*) ' partkine 2-parton',xm1,xm2

C prepare string connections for LUJOIN
      DO J=1,5
         P(N+1,J) = P(Ip,J)
         K(N+1,J) = K(Ip,J)
         P(N+2,J) = P(Ip+1,J)
         K(N+2,J) = K(Ip+1,J)
      Enddo
c set these two entrys as documentation lines
      K(Ip,1)=21
      K(Ip+1,1)=21

      if(debug) Call DUList(1)
      NJOIN = 2
      IJOIN(1) = N+1
      IJOIN(2) = N+2
      N=N+2
C End of preparation of string connections for LUJOIN

      Call LUJOIN(NJOIN,IJOIN)

      If(DEBUG) THEN
         Write (*,10000) N, IKIND, Q2, sqrt(W2), sqrt(Mx2), sqrt(KT2)
10000 Format('PARTKINE 2BODY- Q2, W, Mx Kt',2I5,4F8.1/)
c        Write (*,1002) (PGAMCM(i),  i=1,5)
c        Write (*,1002) (PPOMCM(i),  i=1,5)
c        Write (*,1002) (PGPOMCM(i),  i=1,5)
10100 Format('   ',5F10.3)

       Call DUList(1)
c      Write(*,*) ' '
      EndIf

      Return

 10   Continue
c     3 parton process
c
      ip = il

      If(IKIND.lt.10) Then
         Do i = 1,4
            P(Ip,  i) =   QBpar3BL(i)
            P(Ip+1,i) =   Kpar3BL(i)
            P(Ip+2,i) =   Qpar3BL(i)
         EndDo
      EndIf
      If(IKIND.gt.10) Then
         Do i = 1,4
            P(Ip,  i) =   QBpar3BC(i)
            P(Ip+1,i) =   Kpar3BC(i)
            P(Ip+2,i) =   Qpar3BC(i)
         EndDo
      EndIf

      P(Ip,  5) =  MQU
      P(Ip+1,5) =  0.
      P(Ip+2,5) =  MQU

      P(Ip,3)   = -P(Ip,3)
      P(Ip+1,3) = -P(Ip+1,3)
      P(Ip+2,3) = -P(Ip+2,3)

c     check on on-shellness
c     xm1=dot1(ip,ip)
c     xm2=dot1(ip+1,ip+1)
c     xm3=dot1(ip+2,ip+2)
c     write(6,*) ' partkine 3-parton ',Tdf,xm1,xm2,xm3
c     write(6,*) ' part 1 : ',(P(ip,i),i=1,4)
c     write(6,*) ' part 2 : ',(P(ip+1,i),i=1,4)
c     write(6,*) ' part 3 : ',(P(ip+2,i),i=1,4)

c
      K(Ip,1)= 2
      K(Ip,2)=-SIGQF*QF
      K(Ip+1,1)= 2
      K(Ip+1,2)= 21

      K(Ip+2,1)= 1
      K(Ip+2,2)= SIGQF*QF
	
c added hannes	
	KPA = K(Ip,2)
c end added hannes	

      ECM = sqrt(SM2)
      DO J=1,5
         P(N+1,J) = P(Ip,J)
         K(N+1,J) = K(Ip,J)
         P(N+2,J) = P(Ip+1,J)
         K(N+2,J) = K(Ip+1,J)
         P(N+3,J) = P(Ip+2,J)
         K(N+3,J) = K(Ip+2,J)
      Enddo
      K(Ip,1)=21
      K(Ip+1,1)=21
      K(Ip+2,1)=21

      If(DEBUG) THEN
         Write (*,10001) N, IKIND, Q2, sqrt(W2), sqrt(Mx2), sqrt(KT2)
10001    Format('PARTKINE 3BODY- Q2, W, Mx Kt',2I5,4F8.1/)
         write(6,*) ' QB ',(P(ip  ,i),i=1,4)
         write(6,*) ' K  ',(P(ip+1,i),i=1,4)
         write(6,*) ' Q  ',(P(ip+2,i),i=1,4)
         Call DUList(1)
c     Write(*,*) ' '
      EndIf


      NJOIN = 3
      IJOIN(1) = N+1
      IJOIN(2) = N+2
      IJOIN(3) = N+3
      N=N+3
      Call LUJOIN(NJOIN,IJOIN)

      if(debug) Call DuList(1)
      Return
      End

*CMZ :  2.08/05 27/03/2000  16.08.25  by  Hannes Jung
*CMZ :  2.08/04 21/12/99  11.48.06  by  Hannes Jung
*CMZ :  2.08/00 27/05/99  14.56.13  by  Hannes Jung
*-- Author :
C----------------------------------------------------------------------
      FUNCTION FourDot(P,Q)
      DOUBLE PRECISION FourDot
C---LORENTZ 4-VECTOR DOT PRODUCT
      DOUBLE PRECISION P(5),Q(5)
      FourDot=P(4)*Q(4)-(P(1)*Q(1)+P(2)*Q(2)+P(3)*Q(3))
      END
*
*CMZ :  2.08/00 27/05/99  14.56.13  by  Hannes Jung
*-- Author :
C----------------------------------------------------------------------
      FUNCTION THREEDOT(P,Q)
      DOUBLE PRECISION THREEDOT
C---Galilei 3-vector   DOT PRODUCT
      DOUBLE PRECISION P(3),Q(3)
      THREEDOT=P(1)*Q(1)+P(2)*Q(2)+P(3)*Q(3)
      END
*CMZ :  2.08/00 27/05/99  14.56.13  by  Hannes Jung
*-- Author :
C----------------------------------------------------------------------

      Function PHIFUNC(Lt2)
      Implicit NONE

      Double Precision  PHIFUNC,Lt2
      Double Precision  R02, LAM, SIGM0, X0, ALPHAS
      COMMON /SATURM/   R02, LAM, SIGM0, X0, ALPHAS
      PHIFUNC = 3.*SIGM0*R02*DEXP(-R02*Lt2)
      PHIFUNC = PHIFUNC/4./9.8696
      END
*CMZ :  2.08/05 27/03/2000  15.56.08  by  Hannes Jung
*-- Author :    Hannes Jung   27/03/2000
      Subroutine SATURPAR
      Implicit NONE

      Double Precision  R02, LAM, SIGM0, X0, ALPHAS
      COMMON /SATURM/   R02, LAM, SIGM0, X0, ALPHAS

CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C Parameters of Wuesthoff Model
C Alphas
           ALPHAS = 0.2
C SIGM0 is 23.0 mB we write this in GeV-2 as 23.03*2.568
c ori      SIGM0 = 23.03*2.568
           SIGM0 = 23.03*2.568
c ori      LAM  = 0.288
           LAM  = 0.288
c ori      X0 =  3.04/10000.
           X0 =  3.04/10000.

      RETURN
      END
*CMZ :  2.08/05 27/03/2000  16.11.13  by  Hannes Jung
*-- Author :    Hannes Jung   27/03/2000
      SUBROUTINE RANQ2W2MX
*-- Author :   H. Kowalski
C     Routine generates variables (Q2,W2,Mx2) and the
C     corresponding Jacobian factor AJAC in Common /CQ2W2MX/
C     The variables (Q2,W2,Mx2) are generated between limits
c     given in COMMON /GDLIMIT/
C     The routine computes also from Q2,W2,Mx2 the  variables
c     YBj, XBj, Xpom and Beta and puts them in COMMON /GDVARB1/
c
c     it generates also the variable Tdf (which plays a role of t)
c     Tdf generation is preliminary because it is to primitive
C-----------------------------------------------------------------------
      Implicit NONE

      Double Precision Q2min, Q2max, W2min, W2max, Mxmin, Mxmax
      COMMON /GDLIMIT/ Q2min, Q2max, W2min, W2max, Mxmin, Mxmax

      Double Precision  Stot, Q2, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2, W2, Mx2, AJAC
      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf

      Double Precision  R02, LAM, SIGM0, X0, ALPHAS
      COMMON /SATURM/   R02, LAM, SIGM0, X0, ALPHAS

      DOUBLE PRECISION Q2JAC, Yjac, MxJAC

      Double Precision  RANUNI
      External          RANUNI
      Double Precision  W2min1, W2max1,Mx2min,Mx2max
      Double Precision  W, Mx, Rsta, Rend, Tmin, Tend, mprot

*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.


C
C- generate the Q2 variable
C-
        Q2 = 	Q2MIN
	Q2JAC = 1.	
C
C- generate the W2 and YBj variable
C-
        W2min1 = W2min
        If(W2MIN1.lt.Q2) W2MIN1 = Q2
C-
        W2 =   W2MIN1
	YJAC = 1.
C-
        Ybj = (W2+Q2)/Stot
C-
C- generate the Mx variable
C-

      Mx = DEXP(RANUNI(DLOG(Mxmin),DLOG(Mxmax)))
      MxJAC = Mx * DLOG(Mxmax/Mxmin)

      Mx2 = Mx**2

      AJAC = Q2jac*Yjac*Mxjac

c  Generate the (positive) t variable in the range t=Tmin to t= Tend
c      Tend = 5.
      Tend = T2MAX
      If(Tend.Gt.Q2) Tend = Q2 - 0.1
      Tend = -Tend
      Tmin = 0.
      Rsta = DEXP(Tend)
      Rend = DEXP(Tmin)
      Tdf = -DLOG(RANUNI(Rsta,Rend))/6.

c       Tdf = 0.
C-
C-  compute the variables xb, xg, eta
C-
      Xbj = Q2/STOT/YBj
      beta = Q2/(Mx2 + Q2 + Tdf)
      Xpom = (Mx2 + Q2 + Tdf)/(W2 + Q2)

      R02 = (XPOM/X0)**LAM


c      W =   sqrt(W2)
c      write(*,1001) Q2,Mx,W,R02,Tdf

c  Tmin condition
      mprot = 0.9383
      tmin = mprot**2*Xpom**2/(1.-Xpom)

c      write(6,*) ' ajac =',ajac,Q2jac,Yjac,Mxjac,Mxmax,Mxmin
	If(Tdf.lt.tmin) Then
         AJAC = 0.
c         write(*,*) '***  t < Tmin  ***', Tdf, tmin
      Endif
C-


   10 RETURN
      END
*CMZ :  2.08/05 27/03/2000  16.11.42  by  Hannes Jung
*-- Author :    Hannes Jung   27/03/2000
      Subroutine INPUTKINE
      IMPLICIT NONE
c
c   author    H.Kowalski
c   reconstruction of input parton (gamma, pommeron) four vectors from
c   dynamic (generated) variables  Q2,Mx2,W2
c   results is stored in Common /CINPKINE/
c
      Double Precision  Stot, Q2, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2, W2, Mx2, AJAC
      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf
      Double Precision    PGAMCM   , PPOMCM,   PGPOMCM
      Common /CINPKINE/   PGAMCM(5), PPOMCM(5),PGPOMCM(5)

      Double Precision   MQU2, MQU
      DATA MQU /0.01/, MQU2 /0.0001/
      Double Precision  DUM, FourDot, RANUNI
      Double Precision   TWOPI
      Double Precision   Egam, Pgam, Epom, Mx
      EXTERNAL RANUNI

      Integer I

      LOGICAL DEBUG

      DEBUG = .false.
      TWOPI = 2.*3.1415927
c
c     Computation of gamma* and pomeron 4-vectors
c     in gamma-pomeron CMS
c
      Mx = dsqrt(Mx2)
      Egam = (Mx2-Q2+Tdf)/2./Mx
      Epom = (Mx2+Q2-Tdf)/2./Mx
      Pgam = ((Mx2+Q2+Tdf)**2-4.*Q2*Tdf)/4./Mx2
      If(Pgam.lt. 0.) write(*,*) '**** WARNING Pgam < 0  ****'
      Pgam = Dsqrt(Pgam)


      PGAMCM(1) = 0.
      PGAMCM(2) = 0.
      PGAMCM(3) = -Pgam
      PGAMCM(4) =  Egam

      PPOMCM(1) = 0.
      PPOMCM(2) = 0.
      PPOMCM(3) = Pgam
      PPOMCM(4) = Epom

      PGAMCM(5) = -Q2
      PPOMCM(5) = -Tdf

      Do i=1,4
         PGPOMCM(i)=PGAMCM(i)+PPOMCM(i)
      Enddo
      PGPOMCM(5) = dsqrt(FourDot(PGPOMCM,PGPOMCM))

      If(DEBUG) THEN
         Write (*,10000) Q2, sqrt(W2), sqrt(Mx2), Tdf
10000 Format('INPKINE- Q2, W, Mx Tdf',4F8.1/)

         Write (*,10100) (PGAMCM(i), i=1,5)
         Write (*,10100) (PPOMCM(i), i=1,5)
         Write (*,10100) (PGPOMCM(i), i=1,4)
10100 Format('   ',5F10.3)
         DUM = FourDot(PGPOMCM,PGPOMCM)
         Write(*,*) 'Mx  ', sqrt(dum)
         Write(*,*) ' '
      EndIf

      Return
      End
*CMZ :  2.08/05 27/03/2000  16.12.12  by  Hannes Jung
*-- Author :    Hannes Jung   27/03/2000
      Subroutine  COMPCROSS

      Double Precision  Stot, Q2, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2, W2, Mx2, AJAC
      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf

      Integer QFKF
      Double Precision    MQUARK, MCHARM
      COMMON /CQMASS/     MQUARK, MCHARM, QFKF
      Double Precision      CHARFAC
      COMMON /CCHARFAC/     CHARFAC

      Double Precision  DSQQT, DSQQL, DSQQGT, DSQQGL
      COMMON /CSWUEST/  DSQQT, DSQQL, DSQQGT, DSQQGL

      Double Precision    DLQQT, DLQQL, DLQQGT, DLQQGL, DLTOT
      Double Precision    DCQQT, DCQQL, DCQQGT, DCQQGL, DLCTOT
      COMMON /CCOMPCROS/  DLQQT, DLQQL, DLQQGT, DLQQGL, DLTOT,
     &                    DCQQT, DCQQL, DCQQGT, DCQQGL, DLCTOT

      Double Precision    Kt2, WT2
      COMMON /C2BODVAR/   Kt2, WT2
      Double Precision    KtG2, QtG2, SM2, ZW, KW2, WT3, YCUT
      COMMON /C3BODVAR/   KtG2, QtG2, SM2, ZW, KW2, WT3, YCUT

      Double Precision    Mx

      Mx = dsqrt(Mx2)
c Compute cross sections for light quarks

      MQUARK = 0.0001
      CHARFAC = 6./9.
      if(Mx.lt.1.) CHARFAC = 5./9.

      DSQQT  = 0.
      DSQQL  = 0.
      DSQQGT = 0.
      DSQQGL = 0.

       Call RAN2BODY
       Call RAN3BODY

       Call INTWAVE
       Call SIGDIF

      DLQQT  = DSQQT
      DLQQL  = DSQQL
      DLQQGT = DSQQGT
      DLQQGL = DSQQGL
      DLQQGL = 0.

cc Compute cross section with Charm

      DSQQT  = 0.
      DSQQL  = 0.
      DSQQGT = 0.
      DSQQGL = 0.

      if(Mx.gt.(2.*MCHARM+0.05)) Then
        MQUARK = MCHARM
        CHARFAC = 4./9.

        Call RAN2BODY
        Call RAN3BODY

        Call  INTWAVE
        Call  SIGDIF
      Endif

      DCQQT  = DSQQT
      DCQQL  = DSQQL
      DCQQGT = DSQQGT
      DCQQGL = DSQQGL

      Return
      END
*CMZ :  2.08/05 27/03/2000  16.12.39  by  Hannes Jung
*-- Author :    Hannes Jung   27/03/2000
      SUBROUTINE RAN2BODY
*-- Author :   H. Kowalski
C   Routine generates the 2-body Kt variable and stores it in
C   the COMMON /C2BODVAR/  together with the corresponding Jacobian WT2
C
      Implicit NONE
      Double Precision  Stot, Q2, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2, W2, Mx2, AJAC
      Integer QFKF
      Double Precision    MQUARK, MCHARM
      COMMON /CQMASS/     MQUARK, MCHARM, QFKF

      Integer QFKC, LUCOMP
      Double Precision    Kt2, WT2
      COMMON /C2BODVAR/   Kt2, WT2
      Double Precision   Kt2BL, Kt2BC
      COMMON /C2BOPT/    Kt2BL, Kt2BC

      Double Precision   Qpar2BL   ,QBpar2BL,   Qpar2BC   ,QBpar2BC
      Common /C2BOKINE/  Qpar2BL(4),QBpar2BL(4),Qpar2BC(4),QBpar2BC(4)

      Double Precision  Kt2Min, Kt2Max, Kt2JAC
      Double Precision  RANUNI, AALAM, MQU2, TWOPI, PHIRN, Kt,Kl2,Kl
      External          RANUNI, AALAM, LUCOMP


      Logical Debug2, Debug3


      MQU2  = MQUARK**2
c
c   2-parton phase space
c
c   create Kt2
c
      Kt2min = 0.0001
      Kt2max = AALAM(Mx2,MQU2,MQU2)/4./Mx2
c      Write(*,*) QFKF,MQUARK, MQU2, Mx2, Kt2Max

      Kt2 = DEXP(RANUNI(DLOG(Kt2min),DLOG(Kt2max)))
      Kt2JAC = Kt2*(DLOG(Kt2max/Kt2min))

      WT2 = Kt2JAC

      KL2 = Mx2/4.-Kt2-MQU2
      if(Kl2.lt.0.0) Then
         write(*,*) 'RAN2BODY- Kl2 lt 0', Kl2
         Kl2 = 0.
      Endif
      Kl = dsqrt(Kl2)
      Kt = dsqrt(Kt2)

      TWOPI = 2.*3.1415927
      PHIRN = RANUNI(0.D0,TWOPI)

      If(MQU2.lt.0.01) Then
         Qpar2BL(1) = Kt*DCOS(PHIRN)
         Qpar2BL(2) = Kt*DSIN(PHIRN)
         Qpar2BL(3) = -Kl
         Qpar2BL(4) = sqrt(Kt2+Kl2+MQU2)

         QBpar2BL(1) = -Kt*DCOS(PHIRN)
         QBpar2BL(2) = -Kt*DSIN(PHIRN)
         QBpar2BL(3) =  Kl
         QBpar2BL(4) = sqrt(Kt2+Kl2+MQU2)

         Kt2BL = dsqrt(Kt2)
      Endif

      If(MQU2.gt.1.) Then
         Qpar2BC(1) = Kt*DCOS(PHIRN)
         Qpar2BC(2) = Kt*DSIN(PHIRN)
         Qpar2BC(3) = -Kl
         Qpar2BC(4) = sqrt(Kt2+Kl2+MQU2)

         QBpar2BC(1) = -Kt*DCOS(PHIRN)
         QBpar2BC(2) = -Kt*DSIN(PHIRN)
         QBpar2BC(3) =  Kl
         QBpar2BC(4) = sqrt(Kt2+Kl2+MQU2)

         Kt2BC = dsqrt(Kt2)
      Endif


      Return
      End
*CMZ :  2.08/05 27/03/2000  16.13.23  by  Hannes Jung
*-- Author :    Hannes Jung   27/03/2000
      SUBROUTINE RAN3BODY
*-- Author :   H. Kowalski
C   Routine generates the 3-body variables KtG2, QtG2, SM2, ZW, KW2
C   and stores it in the COMMON /C3BODVAR/  together with
C   the corresponding Jacobian WT3
C   The variable YCUT in COMMON /C3BODVAR/ is set in the main program
C   it is necessary when the process QGQb is evaluated (not used in the
C   present version)
C
      Implicit NONE
      Double Precision  Stot, Q2, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2, W2, Mx2, AJAC
      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf
      Double Precision    PGAMCM   , PPOMCM,   PGPOMCM
      Common /CINPKINE/   PGAMCM(5), PPOMCM(5),PGPOMCM(5)

      Integer QFKF
      Double Precision    MQUARK, MCHARM
      COMMON /CQMASS/     MQUARK, MCHARM, QFKF

      Double Precision    Kpar3B(4), Qpar3B(4) ,QBpar3B(4)

      Double Precision    Kpar3BL   , Qpar3BL    ,QBpar3BL
      Double Precision    Kpar3BC   , Qpar3BC    ,QBpar3BC
      Common /C3BOKINE/   Kpar3BL(4), Qpar3BL(4) ,QBpar3BL(4),
     &                    Kpar3BC(4), Qpar3BC(4) ,QBpar3BC(4)

      Double Precision    Kt2, Qt2, SM2, ZW, KW2, WT3, YCUT
      COMMON /C3BODVAR/   Kt2, Qt2, SM2, ZW, KW2, WT3, YCUT
      Double Precision    Kt3BL, Qt3BL, ZW3BL, Kt3BC, Qt3BC, ZW3BC
      COMMON /C3BOPT/     Kt3BL, Qt3BL, ZW3BL, Kt3BC, Qt3BC, ZW3BC

      Double Precision       AlphaK, BetaK, AlphaQ, BetaQ

      Double Precision  Kt2min,  Kt2max,  KtJAC
      Double Precision  ZWMin,   ZWMax,   ZWJAC, Mx
      Double Precision  oZWMin,   oZWMax
      Double Precision  Qt2Min, Qt2Max, QtJAC, Qt2dum
      Double Precision  Pt2max
      Double Precision  RANUNI, AALAM, MQU2, MQU
      External          RANUNI, AALAM

      Double Precision    PGAMpri(4), PKtQt(2), PQQB(4), MQQB2
      Double Precision    PPOMpri(4)
      Double Precision  TWOPI, PHIRN, PHIKtQt, XSIGN,SIGN
      Double Precision  Kt, Qt, KtQt2, SS, Spri
      Double Precision  Left, Right, Leftpri, FourDot
      Double Precision  AA, BB, CC, Qt2m, SQ

      Integer I

      Logical Debug

      DEBUG = .false.
c
c   3-parton phase space
c
c   create Kt2
c
      TWOPI = 2.*3.1415927
      Mx = dsqrt(Mx2)
      WT3 = 0.
      IF(Mx.lt.1.) Return

      Kt2min =  0.001
c      Kt2min =  0.1
cH.K. 19.12.99 introduce charm mass
c  define MQU2 properly
      MQU2  = MQUARK**2
      Kt2max = AALAM(Mx2,0.0,4.D0*MQU2)/4./Mx2
cH.K. 19.12.99
c      if(Kt2max.gt.Q2) Kt2max = Q2

      Kt2   = DEXP(RANUNI(DLOG(Kt2min),DLOG(Kt2max)))
      KtJAC = Kt2*(DLOG(Kt2max/Kt2min))
      if(KtJAC.lt.0.0) Then
          write(*,*) ' Ktjac lt 0', Mx2, MQU2,Kt2max
          KtJAC = 0.
      Endif
c
c   create Spri, ZW
c
      Spri = (Mx2+Tdf+Q2)/2.
c      write(*,*) 'Spri 1 ',Spri, Q2,Mx2,Kt2,Tdf
      Spri = Spri*(1.+dsqrt(1.-4.*Tdf*Q2/(Mx2+Tdf+Q2)**2))
c      write(*,*) 'Spri 2 ',Spri

cH.K. 19.12.99 introduce charm mass
c old      ZWmin = ((Spri-Q2)/2./Spri)*(1.-dsqrt(1.-4.*Kt2/Mx2))+Q2/Spri
c old      ZWmax = ((Spri-Q2)/2./Spri)*(1.+dsqrt(1.-4.*Kt2/Mx2))+Q2/Spri

      ZWmin = ((MX2+4.*MQU2)/2./(Spri-Tdf))
     &   *(1.-dsqrt(1.-4.*Mx2*(Kt2+4.*MQU2)/(Mx2+4.*MQU2)**2))+Q2/Spri
      ZWmax = ((MX2+4.*MQU2)/2./(Spri-Tdf))
     &   *(1.+dsqrt(1.-4.*Mx2*(Kt2+4.*MQU2)/(Mx2+4.*MQU2)**2))+Q2/Spri
cH.K. 19.12.99

      if(ZWmin.gt.ZWmax) then
        ZWMIN = ZWMAX
        write(*,*) 'ZWMIN ',ZWmin,ZWmax,Q2,Mx2,Kt2
        write(*,*) 'Spri  ', Spri,Tdf
      Endif
      if(ZWmin.lt.Beta) then
        write(*,*) 'ZWMIN lt Beta ',Q2,Mx2,Kt2
      Endif
      if(ZWmin.gt.1.0) then
        write(*,*) 'ZWMIN gt 1. '
      Endif

      ZW = DEXP(RANUNI(DLOG(ZWmin),DLOG(ZWmax)))
      ZWJAC = ZW*(DLOG(ZWmax/ZWmin))
      if(ZWJAC.lt.0.0) ZWJAC = 0.

      If((ZW*Spri-Q2).lt.0.) Then
        write(*,*) ' ZW*Spri-Q2 < 0 '
        WT3 = 0.
        Return
      EndIf
      SM2 = ZW*Spri-Q2

      If(SM2.gt.Mx2) Then
        if((Sm2-0.5).gt.Mx2) Then
          write(*,*) ' SM2 gt Mx2',SM2,Mx2,Q2,W2,Tdf
        Endif
        WT3 = 0.
        Return
      Endif


c
c   create BetaK, AlphaK
c
      BetaK = 1.-ZW
      AlphaK = Kt2/(BetaK*Spri)

      PhiKtQt = RANUNI(0.D0,TWOPI)

cH.K 19.12.99
c old       Qt2min = Kt2

c old      Qt2max = (dsqrt(SM2)/2.)*(1.-(Tdf/Spri)-AlphaK-Kt2/SM2)/
c old     &      (dsqrt(1.-(Tdf/Spri)-AlphaK)+dsqrt(Kt2/SM2)*DCOS(PhiKtQt))

c      Fac1 =  1.-(Tdf/Spri)-AlphaK-Kt2/SM2
c      Fac2 =  1.-(Tdf/Spri)-AlphaK-Kt2/SM2*(DCOS(PhiKtQt)**2)
c      Fac4 = dsqrt((1.-(Tdf/Spri)-AlphaK)*(1.-4.*MQU2/SM2*Fac2/Fac1**2))
c      Fac4 = Fac4-dsqrt(Kt2/SM2)*DCOS(PhiKtQt)
c      Qt2max = dsqrt(SM2)/2.*Fac1/Fac2*Fac4
c      Qt2max = Qt2max**2
cH.K 19.12.99
cH.K.17.01.00

      AA = 1.-AlphaK-(Tdf/Spri)
      BB = AA-(Kt2/SM2)
      CC = AA-(Kt2/SM2)*(DCOS(PhiKtQt)**2)

      SQ = dsqrt(AA*(1.-4.*MQU2/SM2*CC/BB**2))
      Qt2max= 0.5*dsqrt(SM2)*BB/CC*(SQ-dsqrt(Kt2/SM2)*DCOS(PhiKtQt))

      Qt2min=-0.5*dsqrt(SM2)*BB/CC*(SQ+dsqrt(Kt2/SM2)*DCOS(PhiKtQt))
      if(Qt2min.lt.0.0) Qt2min = 0.0

      Qt2max = Qt2max**2
      Qt2min = Qt2min**2

      Qt2m = Kt2-MQU2
      if(Qt2m.lt.0.001)  Qt2m  = 0.001

      if(Qt2min.lt.Qt2m) Qt2min= Qt2m

c      Write(*,1001)  Qt2min,Qt2max,ZW,BETA,Kt2,Spri,SM2,PhiKtQt
c      Write(*,1001)  SQ,AA,BB,CC, MQU2

      if(Qt2max.lt.Qt2min) Then
c this case may happens when the  mass of the qq system (SM2) is small
c in this case Qt cannot be larger then (roughly) SM2/4.
c         Write(*,1001)  Qt2min,Qt2max,ZW,BETA,Kt2,MQU2
       Qt2dum = (dsqrt(SM2)/2.)*(1.-(Tdf/Spri)-AlphaK-Kt2/SM2)/
     &      (dsqrt(1.-(Tdf/Spri)-AlphaK)+dsqrt(Kt2/SM2)*DCOS(PhiKtQt))
       Qt2dum = Qt2dum**2
c       Write(*,1001) Qt2m,Qt2dum,Mx2,Sm2, tdf

c      oZWmin = ((Spri-Q2)/2./Spri)*(1.-dsqrt(1.-4.*Kt2/Mx2))+Q2/Spri
c      oZWmax = ((Spri-Q2)/2./Spri)*(1.+dsqrt(1.-4.*Kt2/Mx2))+Q2/Spri
c      write(*,*) ozwmin, zwmin
c      write(*,*) ozwmax, zwmax


         WT3 = 0.
         Return
 1001   Format(' Qt2min  Qt2max',10F9.4)
      Endif

      if(Qt2min.le.1.D-8) Then
c        Write(*,*) ' Qt2min', Qt2min,ZW,BETA,Kt2
        Qt2min = 1.D-8
      Endif

      Qt2 = DEXP(RANUNI(DLOG(Qt2min),DLOG(Qt2max)))
      QtJAC = Qt2*(DLOG(Qt2max/Qt2min))
      if(QtJAC.lt.0.0) QtJAC = 0.

      KW2 = Kt2/(1.-ZW)

      PHIRN = RANUNI(0.D0,TWOPI)

      Kt = dsqrt(Kt2)
      Kpar3B(1) = Kt*DCOS(PHIRN)
      Kpar3B(2) = Kt*DSIN(PHIRN)

      PhiRN = PhiKtQt+PhiRN
      If(PhiRn.gt.TWOPI) PhiRN = PhiRN-TWOPI

      Qt = dsqrt(Qt2)
      Qpar3B(1) = Qt*DCOS(PHIRN)
      Qpar3B(2) = Qt*DSIN(PHIRN)

      PKtQt(1) = Kpar3B(1) + Qpar3B(1)
      PKtQt(2) = Kpar3B(2) + Qpar3B(2)

      KtQt2 = PKtQt(1)**2 + PKtQt(2)**2

      XSIGN = RANUNI(0.D0,1.D0)

                         SIGN =  1.D0
      If(XSIGN.le.0.5D0) SIGN = -1.D0

      SS = (1.-(Tdf/Spri)-AlphaK+(Qt2-KtQt2)/SM2)**2
     *   - 4.*(1.-(Tdf/Spri)-AlphaK)*(Qt2+MQU2)/SM2
      If(SS.lt.0.) Then
c      write(*,*) ' '
c      write(*,*) '  SS lt 0', SS, MQU2, Kt2,Qt2, SM2
      WT3 = 0.
      return
      Endif

      AlphaQ =0.5*(1.-(Tdf/Spri)-AlphaK+(Qt2-KtQt2)/SM2+SIGN*dsqrt(SS))
      BetaQ  = Qt2/AlphaQ/Spri

      do i=1,4
       PGAMpri(i)=(PGAMCM(i)+  Q2*PPOMCM(i)/Spri)/(1.-Tdf*Q2/(Spri)**2)
       PPOMpri(i)=(PPOMCM(i)+ Tdf*PGAMCM(i)/Spri)/(1.-Tdf*Q2/(Spri)**2)
      EndDo

      Do i=3,4
        Kpar3B(i) = AlphaK*PGAMpri(i) + BetaK*PPOMpri(i)
        Qpar3B(i) = AlphaQ*PGAMpri(i) + BetaQ*PPOMpri(i)
      EndDo
      if((Qpar3B(4).lt.0.).or.(Kpar3B(4).lt.0.)) Then
       write(*,*) 'Energies lt 0'
      Endif

      do i=1,4
       QBpar3B(i) = PGAMCM(i)+PPOMCM(i)-Qpar3B(i)-Kpar3B(i)
       PQQB(i)    = QBpar3B(i) + Qpar3B(i)
      EndDo

      MQQB2 = FourDot(PQQB,PQQB)

c      write(*,*) TDF, FourDot(QBpar3B,QBpar3B),FourDot(Qpar3B,Qpar3B),
c     *           FourDot(Kpar3B,Kpar3B)

      If(SM2.lt.MQQB2) Then
       Write(*,*) ' Sm2 too small ', MQQB2, SM2
       SM2 = 0.
      Endif

      WT3 = KtJAC*ZWJAC*QtJAC/dsqrt(SS)

      If(MQU2.lt.0.01) Then
         Do i=1,4
            Kpar3BL(i)  = Kpar3B(i)
            Qpar3BL(i)  = Qpar3B(i)
            QBpar3BL(i) = QBpar3B(i)
         EndDo

         Kt3BL = dsqrt(Kt2)
         Qt3BL = dsqrt(Qt2)
         ZW3BL = ZW
      Endif

      If(MQU2.gt.1.00) Then
         Do i=1,4
            Kpar3BC(i)  = Kpar3B(i)
            Qpar3BC(i)  = Qpar3B(i)
            QBpar3BC(i) = QBpar3B(i)
         EndDo

         Kt3BC = dsqrt(Kt2)
         Qt3BC = dsqrt(Qt2)
         ZW3BC = ZW
      Endif

c      if(DEBUG) Then
c      write(*,*) ' '
c      write(*,*) '    SS,  AlphaK,   Kt2,    Qt2,    KtQt2,   SM2,  ZW'
c       write(*,1002)  SS, AlphaK,Kt2,Qt2,KtQt2,SM2,ZW,BETA
 1002  Format(6f8.2,2f8.3)
c      write(*,*) ' '
c      write(*,*) 'Wt3',ZWJAC,QtJAC,KtJAC
c      Endif

      Return
      End
*CMZ :  2.08/05 27/03/2000  16.13.48  by  Hannes Jung
*-- Author :    Hannes Jung   27/03/2000
      Subroutine  INTWAVE
c
c author H.Kowalski
c Integration of the wave function
c
      Implicit NONE
      Double Precision  KtX2, PI
      Double Precision  Stot, Q2, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2, W2, Mx2, AJAC
      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf

      Double Precision  R02, LAM, SIGM0, X0, ALPHAS
      COMMON /SATURM/   R02, LAM, SIGM0, X0, ALPHAS

      Double Precision    Kt2, WT2
      COMMON /C2BODVAR/   Kt2, WT2

      Double Precision  Lt2min, Lt2max

      Double Precision  IntWUT, INTWUL, INTWUG
      COMMON /CINTWAVE/ IntWUT, INTWUL, INTWUG

      Double Precision  SWAVET, SWAVEL, SWAVEG
      External          SWAVET, SWAVEL, SWAVEG

      Double Precision  DGQUAD
      External          DGQUAD

      Integer         NQUAD
      COMMON /CNQUAD/ NQUAD

      Double Precision  Mx

      Integer NQUA
      Mx = dsqrt(Mx2)

      Lt2min = 0.0
      Lt2max = 10.0/R02

      NQUA   = NQUAD
      IntWUT = DGQUAD(SWAVET,Lt2min,Lt2max,NQUA)
      IntWUL = DGQUAD(SWAVEL,Lt2min,Lt2max,NQUA)
      IntWUG = 0.

      IF(Mx.lt.1.) Return
      IntWUG = DGQUAD(SWAVEG,Lt2min,Lt2max,NQUA)

c      Write(*,1000) IntWUT, IntWUL, IntWUG
 1000 Format('INTWAVE',3E10.2)

      Return
      END

*CMZ :  2.08/05 27/03/2000  16.14.13  by  Hannes Jung
*-- Author :    Hannes Jung   27/03/2000
      Subroutine  SIGDIF
c
c author H.Kowalski
c COMPCROSS computes the diffractive X-section dsig/Mx in nB for the
c QQb  transverse   process - stored in DSQQT
c QQb  longitudinal process - stored in DSQQL
c QQbG transverse   process - stored in DSQQGT
c QQbG longitudinal process - stored in DSQQGL
c
      Implicit NONE
      Double Precision  FSIGT, FSIGL, FSIGGT, FSIGGL, DUM
      Double Precision  Stot, Q2, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2, W2, Mx2, AJAC
      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf

      Double Precision  R02, LAM, SIGM0, X0, ALPHAS
      COMMON /SATURM/   R02, LAM, SIGM0, X0, ALPHAS

      Integer QFKF
      Double Precision    MQUARK, MCHARM
      COMMON /CQMASS/     MQUARK, MCHARM, QFKF
      Double Precision      CHARFAC
      COMMON /CCHARFAC/     CHARFAC

      Double Precision    Kt2, WT2
      COMMON /C2BODVAR/   Kt2, WT2
      Double Precision    KtG2, QtG2, SM2, ZW, KW2, WT3, YCUT
      COMMON /C3BODVAR/   KtG2, QtG2, SM2, ZW, KW2, WT3, YCUT

      Double Precision   QW2, Mx, WTPhS, MQU2, PI
      Double Precision   FacT, FACL, FACGT, FACGL, FACQM

      Double Precision  IntWUT, INTWUL, INTWUG
      COMMON /CINTWAVE/ IntWUT, INTWUL, INTWUG

      Double Precision  DSQQT, DSQQL, DSQQGT, DSQQGL, DSTOT
      COMMON /CSWUEST/  DSQQT, DSQQL, DSQQGT, DSQQGL, DSTOT

      MQU2 = MQUARK**2
      Mx = dsqrt(Mx2)
      PI = 3.1415927

      QW2 = (Kt2+MQU2)/(1.-BETA)
      WTPhS = (Kt2+MQU2)/Kt2/dsqrt(1.-4.*BETA*QW2/Q2)/Mx2
      WTPhS = WTPhS*BETA/(1.-BETA)/Q2
      FacT = (1.-2.*BETA*QW2/Q2)*(IntWUT**2) +
     &        4.*Kt2*MQU2/QW2**2*(IntWUL**2)
      FacT = FacT * (1./137.)*(PI**2/12.)*1000000./2.568

      FSIGT = WTPhS*FacT*2.*Mx*CHARFAC*(1./6.)
      DSQQT = FSIGT*WT2*AJAC

c      write (*,*) 'SIGDIF',FacT,WTPhs,Wt2,AJAC

      WTPhS = 1./dsqrt(1.-4.*BETA*QW2/Q2)/Mx2
      FacL = (QW2*BETA**3/Q2/Q2)*(IntWUL**2)
      FacL = FacL *(1./137.)*(4.*PI**2/3.)*1000000./2.568
      FSIGL = WTPHS*FacL*2.*Mx*CHARFAC*(1./6.)
      DSQQL = FSIGL*WT2*AJAC

      DSQQGT  = 0.
      DSQQGL  = 0.
      IF(Mx.lt.1.) Return
cH.K 19.12.99 introduce charm mass
      FACQM = (QtG2+MQU2)
c instead of
c old      FACG = (1./QtG2)*((BETA/ZW)**2+(1.-BETA/ZW)**2)
c  new

      FACGT = ((1.-2.*FACQM/SM2)/FACQM)*((BETA/ZW)**2+(1.-BETA/ZW)**2)
c      write (*,*) 'SIGDIF',FacGT,FACQM,SM2,BETA,ZW
      FACGT = FACGT+4./FACQM*(BETA/ZW)*(1.-2.*BETA/ZW)*MQU2/Q2
      FACGT = FACGT+2.*SM2/FACQM**2*(BETA/ZW)**2*MQU2/Q2*
     1                 (1.-2.*MQU2/Q2)
cH.K 19.12.99
      FACGT = FACGT*((BETA/ZW)**2)/(1-ZW)**3
      FACGT = FACGT*(INTWUG**2)

      FACGT  =  FACGT*(9.*PI/32.)*(1./137.)*ALPHAS/Q2/Q2

      FSIGGT = (FACGT *1000000./2.568)*2.*Mx*CHARFAC*(1./6.)

c      write (*,*) 'SIGDIF',FacGT,INTWUG

c  new H.K 19.12.99
      FACGL = 8./SM2*(BETA/ZW)*(1.-BETA/ZW)
      FACGL = FACGL-8./FACQM*(BETA/ZW)**2*MQU2/Q2

      FACGL = FACGL*((BETA/ZW)**2)/(1-ZW)**3
      FACGL = FACGL*(INTWUG**2)

      FACGL = FACGL*(9.*PI/32.)*(1./137.)*ALPHAS/Q2/Q2

      FSIGGL = (FACGL *1000000./2.568)*2.*Mx*CHARFAC*(1./6.)

      if(WT3.gt.0.0) THEN
      DSQQGT  = FSIGGT* WT3*AJAC
      DSQQGL  = FSIGGL* WT3*AJAC
      Endif
      Return
      END
*CMZ :  2.08/05 27/03/2000  16.14.35  by  Hannes Jung
*-- Author :    Hannes Jung   27/03/2000
      FUNCTION SWAVET(Lt2)
C----------------------------------------------------------------------
      Implicit NONE

      Double Precision  Lt2, PHIFUNC, SWAVET

      Double Precision  Stot, Q2, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2, W2, Mx2, AJAC
      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf

      Double Precision    Kt2, WT2
      COMMON /C2BODVAR/   Kt2, WT2

      Double Precision  WAVEWUT, QW2
      Double Precision  R02, LAM, SIGM0, X0, ALPHAS
      COMMON /SATURM/   R02, LAM, SIGM0, X0, ALPHAS

      Integer QFKF
      Double Precision    MQUARK, MCHARM
      COMMON /CQMASS/     MQUARK, MCHARM, QFKF

      Double Precision    MQU2
      MQU2 = MQUARK**2
c...
c  QQBar Transverse Wave Function Convoluted with the
c  proton vituality function
c

      PHIFUNC = 3.*SIGM0*R02*DEXP(-R02*Lt2)
      PHIFUNC = PHIFUNC/4./9.8696

      QW2 = (Kt2+MQU2)/(1.-BETA)
      WAVEWUT = 1.-2.*BETA -2.*MQU2/QW2+(Lt2 -(1.-2.*BETA)*QW2+2.*MQU2)
     &        /sqrt((Lt2+QW2)**2 - 4.*Kt2*Lt2)
      SWAVET = WAVEWUT*PHIFUNC

c      write(*,1000)  SWAVET,PHIFUNC, Lt2,BETA,Kt2
 1000 Format('SWAVET ',7E12.3)
 999  RETURN
      END
*CMZ :  2.08/05 27/03/2000  16.14.59  by  Hannes Jung
*-- Author :    Hannes Jung   27/03/2000
      FUNCTION SWAVEL(Lt2)
C----------------------------------------------------------------------
      Implicit NONE

      Double Precision  Lt2, PHIFUNC, SWAVEL

      Double Precision  Stot, Q2, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2, W2, Mx2, AJAC
      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf

      Double Precision    Kt2, WT2
      COMMON /C2BODVAR/   Kt2, WT2

      Double Precision  WAVEWUL, QW2
      Double Precision  R02, LAM, SIGM0, X0, ALPHAS
      COMMON /SATURM/   R02, LAM, SIGM0, X0, ALPHAS

      Integer QFKF
      Double Precision    MQUARK, MCHARM
      COMMON /CQMASS/     MQUARK, MCHARM, QFKF

      Double Precision    MQU2
      MQU2 = MQUARK**2

c...
c  QQBar Longitudinal Wave Function Convoluted with the
c  proton vituality function
c

      PHIFUNC = 3.*SIGM0*R02*DEXP(-R02*Lt2)
      PHIFUNC = PHIFUNC/4./9.8696

c HK 19.12.99
c old      QW2 = Kt2/(1.-BETA)
      QW2 = (Kt2+MQU2)/(1.-BETA)

      WAVEWUL = 1.-
     &      QW2/sqrt((Lt2+QW2)**2 -4.*Kt2*Lt2)

      SWAVEL = WAVEWUL*PHIFUNC

c      write(*,1000)  SWAVEL,PHIFUNC, Lt2
 1000 Format('SWAVET ',7E12.3)
 999  RETURN
      END
*CMZ :  2.08/05 27/03/2000  16.15.24  by  Hannes Jung
*-- Author :    Hannes Jung   27/03/2000
      FUNCTION SWAVEG(Lt2)
C----------------------------------------------------------------------
      Implicit NONE

      Double Precision  Lt2, PHIFUNC, SWAVEG

      Double Precision  Stot, Q2, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2, W2, Mx2, AJAC
      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf

      Double Precision    KtG2, QtG2, SM2, ZW, KW2, WT3, YCUT
      COMMON /C3BODVAR/   KtG2, QtG2, SM2, ZW, KW2, WT3, YCUT

      Double Precision  WAVEWUG
      Double Precision  R02, LAM, SIGM0, X0, ALPHAS
      COMMON /SATURM/   R02, LAM, SIGM0, X0, ALPHAS

      Integer QFKF
      Double Precision    MQUARK, MCHARM
      COMMON /CQMASS/     MQUARK, MCHARM, QFKF

      Double Precision    MQU2
      MQU2 = MQUARK**2

c...
c  QQG Leading Twist Wave Function Convoluted with the
c  proton vituality function
c
c  factor 2 used for R02 because of gluon charge
      PHIFUNC = 3.*SIGM0*R02*DEXP(-R02*Lt2)
      PHIFUNC = PHIFUNC/4./9.8696

      WAVEWUG =  ZW**2+(1.-ZW)**2 + Lt2/KW2 -
     &   (((1.-2.*ZW)*KW2-Lt2)**2 + 2.*ZW*(1.-ZW)*KW2**2)/KW2/
     &   dsqrt((KW2+Lt2)**2-4.*(1.-ZW)*Lt2*KW2)

      SWAVEG = WAVEWUG*PHIFUNC

c      write(*,1000)  SWAVEL,PHIFUNC, Lt2
 1000 Format('SWAVET ',7E12.3)
 999  RETURN
      END

*CMZ :  2.08/05 27/03/2000  16.15.50  by  Hannes Jung
*-- Author :    Hannes Jung   27/03/2000
      FUNCTION RANUNI(A,B)
C ... Uniform random random number in range [A,B]
      DOUBLE PRECISION RANUNI,A,B,RN
      Real RVec(5)
	Double Precision draprn

ccc      Call RANMAR(RVec,1)
c      RN=RVec(1)
c changed to standard draprn

      RN=draprn()
      RANUNI=A+RN*(B-A)
      END
*CMZ :  2.08/06 31/03/2000  11.20.32  by  Hannes Jung
*CMZ :  2.08/05 30/03/2000  15.33.05  by  Hannes Jung
*-- Author :    Hannes Jung   27/03/2000
      Subroutine SATSIGTOT(Q2IN,XBJIN,SIGOUT,ESIGOUT,WEIOUT)
c
c Compute total diffractive sigma's (i.e. integrated over all masses)
c in microbarn at Q2IN,XBJIN by MC computation
c Finds also the maximal weight
      IMPLICIT NONE

      Double Precision Q2IN,XBJIN,SIGOUT,ESIGOUT,WEIOUT,W2IN
      Double Precision SIGXX, ESIGXX, DSigMax, DUM, weimc
	DATA DUM/0.d0/
      Double Precision DM, DW, DQ, EPS

      Double Precision Q2min, Q2max, W2min, W2max, Mxmin, Mxmax
      COMMON /GDLIMIT/ Q2min, Q2max, W2min, W2max, Mxmin, Mxmax

      Double Precision  Stot, Q2, W2, Mx2, AJAC
      COMMON /CQ2W2MX/  Stot, Q2, W2, Mx2, AJAC
      Double Precision  YBj, XBj, Xpom, Beta, Tdf
      COMMON /GDVARB1/  YBj, XBj, Xpom, Beta, Tdf

      Double Precision    DLQQT, DLQQL, DLQQGT, DLQQGL, DLTOT
      Double Precision    DCQQT, DCQQL, DCQQGT, DCQQGL, DLCTOT
      COMMON /CCOMPCROS/  DLQQT, DLQQL, DLQQGT, DLQQGL, DLTOT,
     &                    DCQQT, DCQQL, DCQQGT, DCQQGL, DLCTOT


      Integer         NQUAD
      COMMON /CNQUAD/ NQUAD

*KEEP,RGPART.
      DOUBLE PRECISION SSS,CM,DBCMS
      DOUBLE PRECISION PBEAM
      INTEGER KBEAM,KINT
      COMMON /PARTON/ SSS,CM(4),DBCMS(4)
      COMMON /BEAM/PBEAM(2,5),KBEAM(2,5),KINT(2,5)
C      SAVE


*KEEP,RGPARAM.
      INTEGER IWEI
      DOUBLE PRECISION ALPHS,PI,ALPH
      COMMON /PARAM/ ALPHS,PI,ALPH,IWEI
      DOUBLE PRECISION SIN2W,XMW2
      COMMON/ELWEAK/SIN2W,XMW2
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.
	Double Precision XMAX
      Integer NMaxWe, Iev
      Logical FIRST
      DATA FIRST/.TRUE./
      IF(FIRST) THEN
         FIRST=.FALSE.

         NQUAD = 24
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C Parameters of Wuesthoff Model
         Call SATURPAR
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      ENDIF

      Stot = SSS
      SIGOUT = 0.
      ESIGOUT = 0.

      SIGXX = 0.
      ESIGXX = 0.
      DsigMax = 0.
      XMAX=1.d0-XF
	
      if(XBJIN.GE.XMAX) RETURN

      W2IN = Q2IN*(1.-XBJIN)/XBJIN

      Q2min = Q2IN
      Q2max = Q2IN+0.0005

      W2min = W2IN
      W2max = W2IN+0.0005
c
      Mxmin = 0.3
      Mxmax = max(Mxmin,dsqrt(Q2IN*(XMAX-XBJIN)/XBJIN))
c	write(6,*) ' Mx ',Mxmin,dsqrt(Q2IN*(XMAX-XBJIN)/XBJIN),Mxmax


      NMaxWe = 15000

      Do Iev =1,NMaxWe

         Call RANQ2W2Mx
         Call INPUTKINE

         Call COMPCROSS

         EPS = 2.*(1.-YBj)/(1.+(1.-YBj)**2)

         DLTOT = DLQQT+DLQQGT + EPS*(DLQQL)
         DLCTOT= DCQQT+DCQQGT + EPS*(DCQQL+DCQQGL) + DLTOT

         weimc = DLCTOT/Float(NMaxWe)

         SIGXX = SIGXX + weimc
         ESIGXX = ESIGXX + weimc**2

         if(DLCTOT.gt.DSigMax) Then
            DSigMax = DLCTOT
c            Write(6,*) 'sigtot ',DsigMax,ajac
         Endif

      Enddo
c
c  End of diffractive cross section computation by MC
c

C normalize cross sections

      SIGout = SIGXX/ 1000.
      ESIGout = sqrt(ESIGXX)/1000.

      WEIOUT = DsigMax

c      Write(*,10000) Q2IN,XBJIN,SIGOUT, ESIGOUT,WEIOUT,ajac
10000 format('Q2,X, SIGOUT, WEIOUT,ajac',6E15.4)

      Return
      End
*CMZ :  2.07/03 26/03/99  17.10.39  by  Hannes Jung
*CMZ :  2.07/02 24/03/99  16.25.34  by  Hannes Jung
*CMZ :  2.07/01 17/03/99  10.54.12  by  Hannes Jung
*-- Author :
      SUBROUTINE ACTWFIT(BETA_IN,Q2_IN,XPQ,X_POM_IN,T2_IN)

      IMPLICIT Double Precision (A-G,O-Z)
      REAL*4 T2_IN,X_POM_IN,BETA_IN,Q2_IN,XPQ(-6:6)
      Double Precision T2,X_POM,DELTA2,MP,ALPHAP,ALPHA0
      DATA DELTA2/3.24D0/,MP/0.938D0/,ALPHAP/0.25D0/
      LOGICAL FIRST
      INTEGER ICALL
      DATA ICALL/0/
      LOGICAL FLAG
      DATA FLAG/.FALSE./
      integer iret, i
      character*(78) header, filename
      Parameter (Isetmax=15)
      character Flnm(Isetmax)*13
      Data (Flnm(I), I=1,Isetmax)
     + /'ACTW_A2.dat  ','ACTW_B2.dat  '
     + ,'ACTW_C2.dat  ','ACTW_D2.dat  ','ACTW_SG2.dat '
     + ,'ACTW_A2+.dat ','ACTW_B2+.dat '
     + ,'ACTW_C2+.dat ','ACTW_D2+.dat ','ACTW_SG2+.dat'
     + ,'ACTW_A2-.dat ','ACTW_B2-.dat '
     + ,'ACTW_C2-.dat ','ACTW_D2-.dat ','ACTW_SG2-.dat'/
      double precision pardis
*KEEP,RGDIFFR.
      INTEGER NG,NPOM
      DOUBLE PRECISION T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA
      COMMON/DIFFR/T2MAX,XF,ALPHP,RN2,EPSP,QMI,YMI,QMA,YMA,NG,NPOM
      INTEGER IREM
      COMMON/PREMNANT/IREM
*KEND.

      DATA FIRST/.TRUE./
      Icall = icall + 1
      if(icall.eq.1) then
         first=.true.
      else
         first=.false.
      endif

C Inform user of folly
      IF(FIRST) THEN
         WRITE(6,*)'#############################################'
         WRITE(6,*)'#            ACTW fit Selected              #'
         if(ng.eq.-1) then
            write(6,*)'#            fit A                          #'
         elseif(ng.eq.-2) then
            write(6,*)'#            fit B                          #'
         elseif(ng.eq.-3) then
            write(6,*)'#            fit C                          #'
         elseif(ng.eq.-4) then
            write(6,*)'#            fit D                          #'
         elseif(ng.eq.-5) then
            write(6,*)'#            fit SG (singular gluon)        #'
         else
            write(6,*)'#  no valid fit selected (-5 < NG < -1)     #'
            write(6,*)'#            program stopped                #'
            STOP
         endif
         IF(NPOM.EQ.-1) THEN
            write(6,*)'#         DL flux with alpha(0)=1.144       #'
         ELSEIF(NPOM.EQ.-2) THEN
            write(6,*)'#         DL flux with alpha(0)=1.189       #'
         ELSEIF(NPOM.EQ.-3) THEN
            write(6,*)'#         DL flux with alpha(0)=1.085       #'
         ELSE
            write(6,*)'#  no valid fit selected (-3 < NPOM < -1)   #'
            write(6,*)'#            program stopped                #'
            STOP
         endif
         WRITE(6,*)'#############################################'
         IF(NPOM.EQ.-1) THEN
            ALPHA0 = 1.144D0
         ELSEIF(NPOM.EQ.-2) THEN
            ALPHA0 = 1.189D0
         ELSEIF(NPOM.EQ.-3) THEN
            ALPHA0 = 1.085D0
         ELSE
            write(6,*) ' npom = ',npom,' not implemented '
            write(6,*) ' valid values are npom = -1,-2,-3'
            write(6,*) ' program stooped now '
            stop
         endif
         Iset = ABS(NG) + (ABS(NPOM)-1)*5
cwrong      call SetCtq4 (Iset)
         filename=Flnm(Iset)
         Print* ,'Opening ', filename
         call evlrnfe(filename, header, iret)


      ENDIF

C Input quantities are REAL*4 -> Convert to REAL*8
      BETA =DBLE(BETA_IN)
      Q    =DBLE(Sqrt(Q2_IN))
      X_POM=DBLE(X_POM_IN)
      T2   =DBLE(T2_IN)

      PI = 4.D0*DATAN(1.D0)
      F_POM = 9.D0*DELTA2/4.D0/PI**2
      F_DL = (4.D0*MP**2 - 2.8D0*T2)/(4.D0*MP**2 - T2)
      F_DL = F_DL/(1.D0 - T2/0.7D0)**2
      F_DL = F_DL**2
      F_POM = F_POM*F_DL*(X_POM**(1.D0-2.D0*(ALPHA0 + ALPHP*T2)))

      DO I=-6,6
         XPQ(I)=0.
cccc         XPART = Real(Beta*Ctq4Pdf (I, Beta, Q))*F_POM
         XPART = Real(Beta*pardis(I, Beta, Q, iret))*F_POM
         IF(XPART.EQ.0D0) XPART=1.D-10
         XPQ(I) = XPART
cc      write(6,*) ' I ',I,' xpdf ',Beta*pardis(I, Beta, Q, iret),F_POM
      ENDDO

      FIRST=.FALSE.

      RETURN
      END
*CMZ :  2.08/04 14/07/99  18.40.56  by  Hannes Jung
*CMZ :  2.07/02 23/03/99  16.46.55  by  Hannes Jung
*CMZ :  2.07/01 17/03/99  10          .  Q  &0.2
*-- Author :
      FUNCTION PARDIS (IPRTN, XX, QQ)
C
C       Given the parton distribution function in the array U in
C       COMMON / PEVLDT / , this routine fetches u(fl, x, q) at any value of
C       x and q using Mth-order polinomial (II=0) or rational fraction (II=1)
C       interpolation for x. It always uses quadratic polinomial interpolation
C       in ln ln (Q/lambda).

C       The calling program must ensure that 0 =< x =< 1 ;
C       If 0 =< x < Xmin, extrapolation is used and a warning is given

C       The calling program must ensure that Alambda < Q ;
C       If (Alambda < Q < Qini .or. Qmax < Q),
C          extrapolation is used and a warning is given
C
      IMPLICIT DOUBLE PRECISION (A-H, O-Z)
      Character Msg*80
      LOGICAL LSTX
C
      PARAMETER (MXX = 1000, MXQ = 100, MXF = 6)
      PARAMETER (MXPN = MXF * 2 + 2)
      PARAMETER (MXQX= MXQ * MXX,   MXPQX = MXQX * MXPN)
      PARAMETER (Smll = 1D-9)
C
      COMMON / IOUNIT / NIN, NOUT, NWRT

      COMMON / XXARAY / XCR, XMIN, XV(0:MXX), LSTX, NX
      COMMON / XYARAY / ZZ(MXX, MXX), ZV(0:MXX)
      COMMON / QARAY1 / QINI,QMAX, QV(0:MXQ),TV(0:MXQ), NT,JT,NG
      COMMON / QARAY2 / TLN(MXF), DTN(MXF), NTL(MXF), NTN(MXF)
      COMMON / EVLPAC / AL, IKNL, IPD0, IHDN, NfMx
      COMMON / PEVLDT / UPD(MXPQX)
      COMMON / PEVLD1 / KF, Nelmt
C
      Dimension Fq(5), Df(5)
C     Dimension QLg(5)
C                           M determines the order of the polynomial
C            II switches between the polint/ratint interpolation routines
C                                     They are fixed for this version
      Save
      Data M , II / 2, 0 /
      Data Iwrn1, Iwarn2, Iwarn3 / 3*0 /
C
C                                             Check integrity of Upd
C      If (Irun .Eq. 0) Then
C         Print '(1pE13.5, 5E13.5)', (UPD(I), I=1,Nelmt-1)
C         Irun = 1
C      Endif

      X = XX
      Q = QQ
C      M = Max (M, 1)
C      M = Min (M, 3)
      Md = M / 2
      Amd= Md
C
      IF (X .LT. Xmin-Smll) THEN
         Msg = '0 < X < Xmin in ParDis; extrapolation used!'
         CALL WARNR (IWRN3, NWRT, Msg, 'X', X, Xmin, 1D0, 1)
      EndIf
C
      IF (Q .LT. QINI-Smll) THEN
         Msg = 'Q less than QINI in PARDIS call; Q SET = QINI.'
         CALL WARNR (IWRN1, NWRT, Msg, 'Q', Q, QINI, QMAX, 1)
         Q = QINI
      ElseIF (Q .GT. QMAX) THEN
         Msg = 'Q greater than QMAX in PARDIS call; '
         Msg = Msg // 'Extrapolation will be used.'
         CALL WARNR(IWRN2, NWRT, Msg, 'Q', Q, QINI, QMAX, 1)
      EndIf
C                           Find lower end of interval containing X
      JL = -1
      JU = Nx+1
   10 If (JU-JL .GT. 1) Then
         JM = (JU+JL) / 2
         If (X .GT. XV(JM)) Then
            JL = JM
         Else
            JU = JM
         Endif
         Goto 10
      Endif

      Jx = JL - (M-1)/2
      If     (Jx .LT. 0) Then
         Jx = 0
      Elseif (Jx .GT. Nx-M) Then
         Jx = Nx - M
      Endif
C                                    Find the interval where Q lies
      JL = -1
      JU = NT+1
   20 If (JU-JL .GT. 1) Then
         JM = (JU+JL) / 2
         If (Q .GT. QV(JM)) Then
            JL = JM
         Else
            JU = JM
         Endif
         Goto 20
      Endif

      Jq = JL - (M-1)/2
      If     (Jq .LT. 0) Then
         Jq = 0
      Elseif (Jq .GT. Nt-M) Then
         Jq = Nt - M
      Endif

      SS  = LOG (Q/AL)
      TT  = LOG (SS)
C                             Find the off-set in the linear array Upd
      JFL = IPRTN + NfMx
      J0  = (JFL * (NT+1) + Jq) * (NX+1) + Jx
C
C                    Nt  -| ..........................
C                         | ..........................
C                   Jq+M -| .....o ......o............  Iq=M+1
C                         | .........X................
C                    Jq  -| .(J0)o ......o ...........  Iq=1
C                         | ...... ...................
C                     0  --------|-------|-----------|
C                         0     Jx     Jx+M          Nx

C      Write (Nwrt, '(/ 10(1pE11.3)/)') X, (XV(I),I=Jx,Jx+M), Q

      Do 30 Iq = 1, M+1
         J1 = J0 + (Nx+1)*(Iq-1) + 1
C                                                     Interpolate in x
         If (II .EQ. 0) Then
            Call Polint (XV(Jx), Upd(J1), M+1, X, Fq(Iq), Df(Iq))
         Elseif (II .EQ. 1) Then
            Call RatInt (XV(Jx), Upd(J1), M+1, X, Fq(Iq), Df(Iq))
         Else
            Print *, 'II out of range in Pardis; II = ', II
         Endif

C     QLg(Iq) = Log ( QV(Jq+Iq-1)/AL )
C     Write (Nwrt, '(10(1pE11.3))')
C    >QV(Jq+Iq-1), (Upd(I), I=J1,J1+M), Fq(Iq), Df(Iq)
   30 Continue
C                                                     Interpolate in LnLnQ
      Call Polint (TV(Jq), Fq(1), M+1, TT, Ftmp, Ddf)
C                                                     Or interpolate in LnQ
C     Call Polint (QLg(1), Fq(1), M+1, SS, Ftmp, Ddf)
C     Write (Nwrt, '(/ 10(1pE11.3))') (Fq(I), I=1,M+1), Ftmp, Ddf
C     Write (Nwrt, *) '----------'
C
      PARDIS = Ftmp
C
      RETURN
C                        ****************************
      END
*CMZ :  2.08/04 14/07/99  18.40.56  by  Hannes Jung
*CMZ :  2.07/02 23/03/99  16.46.55  by  Hannes Jung
*CMZ :  2.07/01 17/03/99  10          a  )  *0.2
*-- Author :
C===================================================================
C===================================================================

      SUBROUTINE POLINT (XA,YA,N,X,Y,DY)

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)

      PARAMETER (NMAX=10)
      DIMENSION XA(N),YA(N),C(NMAX),D(NMAX)
      NS=1
      DIF=ABS(X-XA(1))
      DO 10 I=1,N
         DIFT=ABS(X-XA(I))
         IF (DIFT.LT.DIF) THEN
            NS=I
            DIF=DIFT
         ENDIF
         C(I)=YA(I)
         D(I)=YA(I)
   10 CONTINUE
      Y=YA(NS)
      NS=NS-1
      DO 30 M=1,N-1
         DO 20 I=1,N-M
            HO=XA(I)-X
            HP=XA(I+M)-X
            W=C(I+1)-D(I)
            DEN=HO-HP
            IF(DEN.EQ.0.)PAUSE
            DEN=W/DEN
            D(I)=HP*DEN
            C(I)=HO*DEN
   20    CONTINUE
         IF (2*NS.LT.N-M)THEN
            DY=C(NS+1)
         ELSE
            DY=D(NS)
            NS=NS-1
         ENDIF
         Y=Y+DY
   30 CONTINUE
      RETURN
      END
*CMZ :  2.08/04 14/07/99  18.40.56  by  Hannes Jung
*CMZ :  2.07/02 23/03/99  16.46.55  by  Hannes Jung
*CMZ :  2.07/01 17/03/99  10          |  *  10.2
*-- Author :
C===================================================================
C===================================================================

      SUBROUTINE RATINT(XA,YA,N,X,Y,DY)
      IMPLICIT DOUBLE PRECISION (A-H, O-Z)
      PARAMETER (NMAX=10,TINY=1.E-25)
      DIMENSION XA(N),YA(N),C(NMAX),D(NMAX)
      NS=1
      HH=ABS(X-XA(1))
      DO 10 I=1,N
         H=ABS(X-XA(I))
         IF (H.EQ.0.)THEN
            Y=YA(I)
            DY=0.0
            RETURN
         ELSE IF (H.LT.HH) THEN
            NS=I
            HH=H
         ENDIF
         C(I)=YA(I)
         D(I)=YA(I)+TINY
   10 CONTINUE
      Y=YA(NS)
      NS=NS-1
      DO 30 M=1,N-1
         DO 20 I=1,N-M
            W=C(I+1)-D(I)
            H=XA(I+M)-X
            T=(XA(I)-X)*D(I)/H
            DD=T-C(I+1)
            IF(DD.EQ.0.)PAUSE
            DD=W/DD
            D(I)=C(I+1)*DD
            C(I)=T*DD
   20    CONTINUE
         IF (2*NS.LT.N-M)THEN
            DY=C(NS+1)
         ELSE
            DY=D(NS)
            NS=NS-1
         ENDIF
         Y=Y+DY
   30 CONTINUE
      RETURN
      END
*CMZ :  2.07/02 23/03/99  16.46.55  by  Hannes Jung
*CMZ :  2.07/01 17/03/99
*-- Author :
C===================================================================
C===================================================================

      SUBROUTINE EVLRNFE (FLNM, HEADER, IRET)
C         Read evolved parton density from named formatted file,
C         and set HEADER to the parton density name.
C         Parton density will be put in the standard common blocks
C         Error code returned.   IRET .EQ. 0 => no problem.

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)
      character *(*) flnm, header, myname
      parameter (myname = 'EVLRNFE')

      iret = 0
      nunit = nextun()
      OPEN (Nunit, FILE=flnm, FORM='FORMATTED', STATUS='OLD',
     +      iostat = iret)
      IF (Iret .NE. 0) THEN
         PRINT *, 'I could not open the parton density file ', flnm
         PRINT *, 'Did you forget to make it?'
         PRINT *, 'I am ', myname
         return
      ENDIF

      CALL EVLRD (NUNIT, HEADER, IRET)
      IF (Iret .NE. 0) THEN
         PRINT *, 'Error reading from file in ', myname
      ENDIF

      END
*CMZ :  2.08/04 14/07/99  18.40.56  by  Hannes Jung
*CMZ :  2.07/02 23/03/99  16.46.55  by  Hannes Jung
*CMZ :  2.07/01 17/03/99  10.53.28     \  +  {    
*-- Author :
C================================================================
C================================================================

      Subroutine EVLRD (NU, HEADER, IRR)
C
C     Before calling this routine, the calling program must open an external
C              file for data transfer, provide a filename for the file, and
C              establish the equivalence of that file with unit=Nu, such as:
C
C       Open (Nu, File='FILENAME', Form='UNFORMATTED', status='OLD', Err=... )
C
C       where the file named 'FILENAME' must exist and it has to be written
C       originally by EVLWT.  (cf. above)
C
C       Input parameter:   Nu = unit number for the external file to be
C                               written to. (established in calling program)
C
C                      Header = informational header for the file
C
C       Output parameter: Irr
C
C                       ----------------------------
      IMPLICIT DOUBLE PRECISION (A-H, O-Z)
      LOGICAL LSTX
      CHARACTER HEADER*78, Line*80
C
      PARAMETER (MXX = 1000, MXQ = 100, MXF = 6)
      PARAMETER (MXPN = MXF * 2 + 2)
      PARAMETER (MXQX= MXQ * MXX,   MXPQX = MXQX * MXPN)
      PARAMETER (M1=-3, M2=3, NDG=3, NDH=NDG+1, L1=M1-1, L2=M2+NDG-2)
C
      COMMON / IOUNIT / NIN, NOUT, NWRT
      COMMON / XXARAY / XCR, XMIN, XV(0:MXX), LSTX, NX
      COMMON / QARAY1 / QINI,QMAX, QV(0:MXQ),TV(0:MXQ), NT,JT,NG
      COMMON / QARAY2 / TLN(MXF), DTN(MXF), NTL(MXF), NTN(MXF)
      COMMON / EVLPAC / AL, IKNL, IPD0, IHDN, NfMx
      COMMON / PEVLDT / UPD(MXPQX)
      COMMON / PEVLD1 / KF, Nelmt

      Read  (Nu, '(A)') Header

      Read  (Nu, '(A)') Line
      Read  (Nu, *) Dr, Fl, Al, Am1, Am2, Am3, AM4, AM5, AM6

      Read  (Nu, '(A)') Line
      Read  (Nu, *) IPD0, IHDN, IKNL, NfMx, KF, Nelmt

      Read  (Nu, '(A)') Line
      Read  (Nu, *) NX,  NT, JT,  NG, NTL(NG+1)

      Read  (Nu, '(A)') Line
      Read  (Nu, *) (NTL(I), NTN(I), TLN(I), DTN(I), I =1, NG)

      Read  (Nu, '(A)') Line
      Read  (Nu, *) QINI, QMAX, (QV(I), TV(I), I =0, NT)

      Read  (Nu, '(A)') Line
      Read  (Nu, *) XMIN, XCR,  (XV(I), I =1, NX)
C
C                  Since quark = anti-quark for nfl>2 at this stage,
C                  we Read  out only the non-redundent data points
C                  No of flavors = NfMx sea + 1 gluon + 2 valence
      Nblk = (NX+1) * (NT+1)
      Npts =  Nblk  * (NfMx+3)
      Read  (Nu, '(A)') Line
      CALL RdUpd (UPD, Npts, NU, IRR)

      CLOSE (NU)
      IF (IRR .NE. 0) PRINT *, 'Read error in EVLRD'

      If (NfMx .GE. 3) Then
C                                       Refill Upd for s -> t
         Do 20 Nflv = 3, NfMx
            J0 = (-Nflv + NfMx) * Nblk
C offset = NfMx sea + 1 gluon + (Nflv-1) less-massive quarks = NfMx+Nflv
            J1 = ( Nflv + NfMx) * Nblk
            Do 10 I = 1, Nblk
               Upd (J1 + I) = Upd (J0 + I)
   10       Continue
   20    Continue
      EndIf

      End
*CMZ :  2.07/01 17/03/99  10          _  }  m0.2
*-- Author :
C================================================================
C================================================================

      SUBROUTINE RDUPD (UPD, NTL, NDAT, IRET)
C
C                       The I/O operation is made a stand-alone subprogram
C                       so that fast execution is achieved with block
C                       data transfer for the actual size of the array
C                       (rather than the declared size in the main program).
      DOUBLE PRECISION UPD
      DIMENSION UPD (NTL)

      READ (NDAT, *, IOSTAT=IRET) UPD
C                             To check read-in result against saved file.
C      Print '(1pE13.5, 5E13.5)', UPD
C

      END
*CMZ :  2.07/02 24/03/99  16.21.10  by  Hannes Jung
*-- Author :
C===================================================================
C===================================================================

      SUBROUTINE WARNR (IWRN, NWRT, MSG, NMVAR, VARIAB,
     +                  VMIN, VMAX, IACT)

C   Subroutine to handle warning messages.  Writes the (warning) message
C   and prints out the name and value of an offending variable to SYS$OUT
C   the first time, and to output file unit # NWRT in subsequent times.
C
C   The switch IACT decides whether the limits (VMIN, VMAX) are active or
C   not.

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)
      PARAMETER (D0=0D0, D1=1D0, D2=2D0, D3=3D0, D4=4D0, D10=1D1)

      CHARACTER*(*) MSG, NMVAR
      Data Nmax / 10 /

      IW = IWRN
      VR = VARIAB

      IF  (IW .EQ. 0) THEN
         PRINT '(1X, A/1X,2A,1PD16.7/A,I4)', MSG, NMVAR, ' = ', VR,
     +         ' For all warning messages, check file unit #', NWRT
         IF (IACT .EQ. 1) THEN
            PRINT '(A/2(1PE15.4))', ' The limits are: ', VMIN, VMAX
            WRITE (NWRT,'(A/2(1PE15.4))') ' The limits are: ', VMIN,
     +      VMAX
         ENDIF
      ENDIF

      If (Iw .LT. Nmax) Then
         WRITE (NWRT,'(I5, 2A/1X,2A,1PD16.7)') IW, '   ', MSG,
     +                  NMVAR, ' = ', VR
      Elseif (Iw .Eq. Nmax) Then
         Print '(/A/)', '!!! Severe Warning, Too many errors !!!'
         Print '(/A/)', '    !!! Check The Error File !!!'
         Write (Nwrt, '(//A//)')
     +     '!! Too many warnings, Message suppressed from now on !!'
      Endif

      IWRN = IW + 1

      RETURN
C           ****************************
      END
*CMZ :  2.08/04 14/07/99  18.40.56  by  Hannes Jung
*CMZ :  2.07/03 24/03/99  17.03.03  by  Hannes Jung
*CMZ :  2.07/02 23/03/99  16.46.55  by  Hannes Jung
*CMZ :  2.07/01 17/03/99  10
*-- Author :
C================================================================
C================================================================

      FUNCTION NEXTUN()
C                                    Returns an unallocated FORTRAN i/o unit.
      LOGICAL EX
C
      DO 10 N = 10, 300
         INQUIRE (UNIT=N, OPENED=EX)
         IF (.NOT. EX) then
            nextun = n
            RETURN
         end if
   10 CONTINUE
      RETURN
C               *************************
      END
*CMZ :  2.08/05 28/03/2000  14.07.14  by  Frank-Peter Schilling
*-- Author :

      SUBROUTINE SCA_PDF(ZT1,Q2T1,XPQ)

      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER IQ2,IZ,NQ2,NZ,IFIT

      INTEGER ICALL
      DATA ICALL /0/
      SAVE ICALL

      PARAMETER (NQ2MAX=30,NZMAX=99)

      DIMENSION XPQ(-6:6)

      DIMENSION UDS_GRD(NZMAX,NQ2MAX),C_GRD(NZMAX,NQ2MAX),
     +          G_GRD(NZMAX,NQ2MAX)

      COMMON /CPARAM2/ UDS_GRD,G_GRD,C_GRD

C     Initialise Parameterisation from data statements

      IF(ICALL.EQ.0) THEN
         ICALL=ICALL+1
         WRITE(6,*)' Initialising Semiclassical Model'

         CALL SCA_DAT

      ENDIF

C     Initialise xpq

      DO I=-6,6
         XPQ(I)=0.D0
      ENDDO
      ZT = ZT1
      Q2T = Q2T1
      IF(ZT.GT.0.99D0) THEN
         ZT = 0.99D0
      ENDIF
      IF(Q2T.GT.200.0D0) THEN
         Q2T = 200.D0
      ENDIF

c     define grid

      Q2L = 2.D0       ! q2 min
      Q2U = 200.0D0    ! q2 max
      ZL  = 0.01D0     ! beta min
      ZU  = 0.99D0     ! beta max
      NQ2 = 30         ! Points in Q2 grid
      NZ  = 99         ! Points in beta grid

c     binwidth in q2 and beta

      DQ2 = DLOG(Q2U/Q2L)/DFLOAT(NQ2-1)
      DZ = (ZU-ZL)/DFLOAT(NZ-1)

C     Check input parameters

      Q2T=MIN(Q2U-0.01D0,MAX(Q2L,Q2T))
      ZT =MIN(ZU,MAX(ZL,ZT))

C     Lower Grid Point
      IQ2 = INT(DLOG(Q2T/Q2L)/DQ2)+1
      IZ  = INT(MAX(0.D0,ZT-ZL)/DZ)+1

C     Central and boundary z,Q2 points for interpolation

      DLQ2  = DLOG(Q2T)
      DLQ21 = DLOG(Q2L)+DFLOAT(IQ2-1)*DQ2
      DLQ22 = DLOG(Q2L)+DFLOAT(IQ2)*DQ2

      DLZ = ZT
      DLZ1 = DFLOAT(MAX(IZ,0))*DZ
      DLZ2 = DFLOAT(MAX(IZ+1,0))*DZ

C     Light Flavour Singlet

      UDS11 = UDS_GRD(IZ,IQ2)
      UDS12 = UDS_GRD(IZ,IQ2+1)
      UDS21 = UDS_GRD(IZ+1,IQ2)
      UDS22 = UDS_GRD(IZ+1,IQ2+1)

C     Charm

      C11 = C_GRD(IZ,IQ2)
      C12 = C_GRD(IZ,IQ2+1)
      C21 = C_GRD(IZ+1,IQ2)
      C22 = C_GRD(IZ+1,IQ2+1)

C     Gluon

      G11 = G_GRD(IZ,IQ2)
      G12 = G_GRD(IZ,IQ2+1)
      G21 = G_GRD(IZ+1,IQ2)
      G22 = G_GRD(IZ+1,IQ2+1)

C     Interpolate to parton distributions to ZT,Q2T

      UDS_T = XYINTER(DLZ1,DLZ2,DLQ21,DLQ22,DLZ,DLQ2,
     &        UDS11,UDS12,UDS21,UDS22)
      C_T = XYINTER(DLZ1,DLZ2,DLQ21,DLQ22,DLZ,DLQ2,
     &      C11,C12,C21,C22)
      G_T = XYINTER(DLZ1,DLZ2,DLQ21,DLQ22,DLZ,DLQ2,
     &      G11,G12,G21,G22)

C    Fill XPQ array

      XPQ(-4) = C_T
      XPQ(-3) = UDS_T/6.0d0
      XPQ(-2) = UDS_T/6.0d0
      XPQ(-1) = UDS_T/6.0d0
      XPQ( 0) = G_T
      XPQ( 1) = UDS_T/6.0d0
      XPQ( 2) = UDS_T/6.0d0
      XPQ( 3) = UDS_T/6.0d0
      XPQ( 4) = C_T

C    Check output

      DO I=-6,6
         IF(XPQ(I).LT.-0.1D-10) THEN
            WRITE(6,*)'Error in SCA fit parameterisation',XPQ(I)
            WRITE(6,*)' at zt,q2t ',ZT,Q2T
            STOP
         ENDIF
      ENDDO

c     that's it

      RETURN
      END
*CMZ :  2.08/05 28/03/2000  14.07.14  by  Frank-Peter Schilling
*CMZ :  2.07/02 23/03/99  16.46.55  by  Hannes Jung
*-- Author :    Julian Phillips   13/09/96

*     Semiclassical Model Main Routine

      SUBROUTINE SCA_MAIN(BETA_IN,Q2_IN,XPQ,X_POM_IN,T2_IN)

      IMPLICIT REAL*8 (A-G,O-Z)
      REAL*4 T2_IN,X_POM_IN,BETA_IN,Q2_IN,XPQ(-6:6)
      DOUBLE PRECISION XPQD(-6:6)

      INTEGER ICALL
      DATA ICALL/0/
      SAVE ICALL

C     Inform user of folly

      IF(ICALL.EQ.0) THEN
         ICALL=1
         WRITE(6,*)'#############################################'
         WRITE(6,*)'# Semiclassical Model Selected              #'
         WRITE(6,*)'#############################################'
      ENDIF

C     Input quantities are REAL*4 -> Convert to REAL*8

      BETA =DBLE(BETA_IN)
      if(BETA.LT.0.01) BETA = 0.01D0
      if(BETA.GT.0.99) BETA = 0.99D0

      Q2   =DBLE(Q2_IN)
      if(Q2.GT.200.0d0) Q2=200.0d0
      if(Q2.LT.2.0d0)   Q2=2.0d0

      X_POM=DBLE(X_POM_IN)
      T2   =DBLE(T2_IN)

c     Get diffractive PDF's for xpom=0.003

      CALL SCA_PDF(BETA,Q2,XPQD)

c     transform to from xpom=0.003 to input xpom
c     add exponential t-dependence


      parl = 8.16d0
      xpom0 = 0.003d0
      b0=6.0d0

      xpomfac = ((parl-dlog(x_pom))**2/(parl-dlog(xpom0))**2)/(x_pom)
      tfac = DEXP(-(B0*DABS(T2)))*b0

      DO i=-6,6
         xpqd(i)=xpqd(i)*xpomfac*tfac
      enddo

c     convert to real*4

      DO I=-6,6
         XPQ(I)=0.
         IF(ABS(I).LT.5) THEN
           XPQ(I)=REAL(XPQD(I))
         ENDIF
         IF(XPQ(I).LT.1E-10) XPQ(I)=0.
      ENDDO

c     that's it

      RETURN
      END
*CMZ :  2.08/05 28/03/2000  14.07.14  by  Frank-Peter Schilling
*-- Author :    Frank-Peter Schilling   17/01/2000
***************************************************
*  Q2-evolved parton densities for semiclassical
*  Model of Buchmueller,Gehrmann,Hebecker
*  at xpom=0.003
***************************************************

      SUBROUTINE SCA_DAT

      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      PARAMETER (NQ2MAX= 30,NZMAX= 99)
      DIMENSION UDS_GRD(NZMAX,NQ2MAX)
      DIMENSION G_GRD(NZMAX,NQ2MAX)
      DIMENSION C_GRD(NZMAX,NQ2MAX)
      DIMENSION UDS_GRDL(NZMAX,NQ2MAX)
      DIMENSION G_GRDL(NZMAX,NQ2MAX)
      DIMENSION C_GRDL(NZMAX,NQ2MAX)
      COMMON /CPARAM2/ UDS_GRD,G_GRD,C_GRD

      data ((uds_grdl(i,j),j= 1, 1),
     &      i=1, 99)/ ! Singlet Q2=  2.
     &0.48847E-01, 0.48357E-01, 0.49220E-01, 0.50698E-01, 0.52578E-01,
     &0.54733E-01, 0.57135E-01, 0.59688E-01, 0.62368E-01, 0.65181E-01,
     &0.68112E-01, 0.71132E-01, 0.74209E-01, 0.77349E-01, 0.80531E-01,
     &0.83749E-01, 0.86999E-01, 0.90269E-01, 0.93548E-01, 0.96847E-01,
     &0.10014E+00, 0.10344E+00, 0.10672E+00, 0.11000E+00, 0.11324E+00,
     &0.11646E+00, 0.11966E+00, 0.12281E+00, 0.12592E+00, 0.12898E+00,
     &0.13199E+00, 0.13494E+00, 0.13783E+00, 0.14065E+00, 0.14341E+00,
     &0.14609E+00, 0.14868E+00, 0.15120E+00, 0.15362E+00, 0.15595E+00,
     &0.15819E+00, 0.16033E+00, 0.16236E+00, 0.16428E+00, 0.16609E+00,
     &0.16778E+00, 0.16935E+00, 0.17080E+00, 0.17212E+00, 0.17331E+00,
     &0.17436E+00, 0.17527E+00, 0.17603E+00, 0.17665E+00, 0.17712E+00,
     &0.17744E+00, 0.17759E+00, 0.17759E+00, 0.17742E+00, 0.17708E+00,
     &0.17657E+00, 0.17589E+00, 0.17503E+00, 0.17399E+00, 0.17276E+00,
     &0.17135E+00, 0.16974E+00, 0.16794E+00, 0.16595E+00, 0.16376E+00,
     &0.16137E+00, 0.15876E+00, 0.15596E+00, 0.15294E+00, 0.14972E+00,
     &0.14628E+00, 0.14262E+00, 0.13875E+00, 0.13465E+00, 0.13034E+00,
     &0.12579E+00, 0.12103E+00, 0.11604E+00, 0.11083E+00, 0.10538E+00,
     &0.99714E-01, 0.93821E-01, 0.87702E-01, 0.81362E-01, 0.74798E-01,
     &0.68025E-01, 0.61029E-01, 0.53836E-01, 0.46450E-01, 0.38881E-01,
     &0.31151E-01,
     &0.23288E-01,
     &0.15346E-01,
     &0.74370E-02/

      data ((uds_grdl(i,j),j= 2, 2),
     &      i=1, 99)/ ! Singlet Q2=  2.34420466
     &0.64805E-01, 0.62300E-01, 0.61941E-01, 0.62516E-01, 0.63671E-01,
     &0.65214E-01, 0.67081E-01, 0.69159E-01, 0.71410E-01, 0.73829E-01,
     &0.76395E-01, 0.79072E-01, 0.81826E-01, 0.84660E-01, 0.87549E-01,
     &0.90487E-01, 0.93467E-01, 0.96475E-01, 0.99501E-01, 0.10255E+00,
     &0.10560E+00, 0.10867E+00, 0.11172E+00, 0.11476E+00, 0.11778E+00,
     &0.12078E+00, 0.12375E+00, 0.12669E+00, 0.12958E+00, 0.13242E+00,
     &0.13522E+00, 0.13796E+00, 0.14064E+00, 0.14325E+00, 0.14580E+00,
     &0.14826E+00, 0.15065E+00, 0.15296E+00, 0.15518E+00, 0.15731E+00,
     &0.15934E+00, 0.16128E+00, 0.16311E+00, 0.16483E+00, 0.16643E+00,
     &0.16793E+00, 0.16930E+00, 0.17056E+00, 0.17168E+00, 0.17267E+00,
     &0.17353E+00, 0.17425E+00, 0.17483E+00, 0.17527E+00, 0.17556E+00,
     &0.17569E+00, 0.17567E+00, 0.17550E+00, 0.17516E+00, 0.17465E+00,
     &0.17398E+00, 0.17314E+00, 0.17213E+00, 0.17094E+00, 0.16957E+00,
     &0.16802E+00, 0.16628E+00, 0.16436E+00, 0.16225E+00, 0.15994E+00,
     &0.15744E+00, 0.15475E+00, 0.15185E+00, 0.14876E+00, 0.14546E+00,
     &0.14196E+00, 0.13825E+00, 0.13434E+00, 0.13021E+00, 0.12588E+00,
     &0.12134E+00, 0.11659E+00, 0.11162E+00, 0.10645E+00, 0.10107E+00,
     &0.95477E-01, 0.89680E-01, 0.83677E-01, 0.77473E-01, 0.71071E-01,
     &0.64484E-01, 0.57703E-01, 0.50754E-01, 0.43645E-01, 0.36392E-01,
     &0.29020E-01,
     &0.21565E-01,
     &0.14093E-01,
     &0.67372E-02/

      data ((uds_grdl(i,j),j= 3, 3),
     &      i=1, 99)/ ! Singlet Q2=  2.74764752
     &0.81139E-01, 0.76293E-01, 0.74561E-01, 0.74145E-01, 0.74515E-01,
     &0.75405E-01, 0.76709E-01, 0.78290E-01, 0.80096E-01, 0.82110E-01,
     &0.84301E-01, 0.86630E-01, 0.89057E-01, 0.91582E-01, 0.94179E-01,
     &0.96836E-01, 0.99547E-01, 0.10230E+00, 0.10507E+00, 0.10788E+00,
     &0.11069E+00, 0.11352E+00, 0.11635E+00, 0.11917E+00, 0.12197E+00,
     &0.12475E+00, 0.12751E+00, 0.13023E+00, 0.13291E+00, 0.13555E+00,
     &0.13814E+00, 0.14068E+00, 0.14315E+00, 0.14557E+00, 0.14791E+00,
     &0.15018E+00, 0.15237E+00, 0.15448E+00, 0.15651E+00, 0.15844E+00,
     &0.16028E+00, 0.16202E+00, 0.16366E+00, 0.16519E+00, 0.16661E+00,
     &0.16792E+00, 0.16911E+00, 0.17018E+00, 0.17112E+00, 0.17193E+00,
     &0.17261E+00, 0.17316E+00, 0.17356E+00, 0.17382E+00, 0.17394E+00,
     &0.17391E+00, 0.17373E+00, 0.17339E+00, 0.17290E+00, 0.17224E+00,
     &0.17142E+00, 0.17044E+00, 0.16928E+00, 0.16796E+00, 0.16646E+00,
     &0.16478E+00, 0.16293E+00, 0.16089E+00, 0.15867E+00, 0.15627E+00,
     &0.15368E+00, 0.15090E+00, 0.14792E+00, 0.14476E+00, 0.14140E+00,
     &0.13785E+00, 0.13411E+00, 0.13016E+00, 0.12602E+00, 0.12168E+00,
     &0.11714E+00, 0.11241E+00, 0.10748E+00, 0.10235E+00, 0.97034E-01,
     &0.91521E-01, 0.85821E-01, 0.79934E-01, 0.73866E-01, 0.67622E-01,
     &0.61215E-01, 0.54641E-01, 0.47926E-01, 0.41082E-01, 0.34125E-01,
     &0.27089E-01,
     &0.20014E-01,
     &0.12975E-01,
     &0.61224E-02/

      data ((uds_grdl(i,j),j= 4, 4),
     &      i=1, 99)/ ! Singlet Q2=  3.22052407
     &0.97803E-01, 0.90311E-01, 0.87068E-01, 0.85581E-01, 0.85115E-01,
     &0.85318E-01, 0.86033E-01, 0.87100E-01, 0.88448E-01, 0.90047E-01,
     &0.91857E-01, 0.93833E-01, 0.95931E-01, 0.98146E-01, 0.10045E+00,
     &0.10283E+00, 0.10527E+00, 0.10776E+00, 0.11029E+00, 0.11286E+00,
     &0.11544E+00, 0.11804E+00, 0.12064E+00, 0.12325E+00, 0.12583E+00,
     &0.12840E+00, 0.13095E+00, 0.13347E+00, 0.13595E+00, 0.13839E+00,
     &0.14079E+00, 0.14313E+00, 0.14541E+00, 0.14763E+00, 0.14978E+00,
     &0.15186E+00, 0.15386E+00, 0.15579E+00, 0.15763E+00, 0.15937E+00,
     &0.16103E+00, 0.16259E+00, 0.16405E+00, 0.16540E+00, 0.16664E+00,
     &0.16777E+00, 0.16879E+00, 0.16968E+00, 0.17045E+00, 0.17109E+00,
     &0.17161E+00, 0.17199E+00, 0.17223E+00, 0.17233E+00, 0.17230E+00,
     &0.17211E+00, 0.17177E+00, 0.17129E+00, 0.17065E+00, 0.16985E+00,
     &0.16890E+00, 0.16778E+00, 0.16650E+00, 0.16505E+00, 0.16343E+00,
     &0.16164E+00, 0.15968E+00, 0.15754E+00, 0.15523E+00, 0.15273E+00,
     &0.15006E+00, 0.14720E+00, 0.14416E+00, 0.14094E+00, 0.13753E+00,
     &0.13394E+00, 0.13016E+00, 0.12620E+00, 0.12204E+00, 0.11771E+00,
     &0.11318E+00, 0.10847E+00, 0.10358E+00, 0.98503E-01, 0.93248E-01,
     &0.87817E-01, 0.82215E-01, 0.76443E-01, 0.70510E-01, 0.64421E-01,
     &0.58189E-01, 0.51815E-01, 0.45323E-01, 0.38730E-01, 0.32055E-01,
     &0.25333E-01,
     &0.18612E-01,
     &0.11973E-01,
     &0.55797E-02/

      data ((uds_grdl(i,j),j= 5, 5),
     &      i=1, 99)/ ! Singlet Q2=  3.77478361
     &0.11474E+00, 0.10432E+00, 0.99443E-01, 0.96815E-01, 0.95468E-01,
     &0.94953E-01, 0.95059E-01, 0.95597E-01, 0.96477E-01, 0.97655E-01,
     &0.99079E-01, 0.10070E+00, 0.10247E+00, 0.10437E+00, 0.10638E+00,
     &0.10849E+00, 0.11066E+00, 0.11290E+00, 0.11519E+00, 0.11752E+00,
     &0.11987E+00, 0.12225E+00, 0.12464E+00, 0.12703E+00, 0.12941E+00,
     &0.13177E+00, 0.13412E+00, 0.13645E+00, 0.13873E+00, 0.14098E+00,
     &0.14318E+00, 0.14533E+00, 0.14743E+00, 0.14946E+00, 0.15143E+00,
     &0.15333E+00, 0.15515E+00, 0.15690E+00, 0.15856E+00, 0.16013E+00,
     &0.16162E+00, 0.16300E+00, 0.16429E+00, 0.16547E+00, 0.16654E+00,
     &0.16751E+00, 0.16836E+00, 0.16909E+00, 0.16970E+00, 0.17018E+00,
     &0.17054E+00, 0.17076E+00, 0.17085E+00, 0.17081E+00, 0.17062E+00,
     &0.17029E+00, 0.16982E+00, 0.16920E+00, 0.16842E+00, 0.16749E+00,
     &0.16641E+00, 0.16517E+00, 0.16377E+00, 0.16221E+00, 0.16048E+00,
     &0.15859E+00, 0.15653E+00, 0.15430E+00, 0.15190E+00, 0.14933E+00,
     &0.14658E+00, 0.14366E+00, 0.14056E+00, 0.13729E+00, 0.13384E+00,
     &0.13021E+00, 0.12641E+00, 0.12243E+00, 0.11827E+00, 0.11394E+00,
     &0.10943E+00, 0.10475E+00, 0.99897E-01, 0.94879E-01, 0.89692E-01,
     &0.84344E-01, 0.78840E-01, 0.73183E-01, 0.67383E-01, 0.61444E-01,
     &0.55382E-01, 0.49199E-01, 0.42922E-01, 0.36567E-01, 0.30158E-01,
     &0.23733E-01,
     &0.17342E-01,
     &0.11073E-01,
     &0.50989E-02/

      data ((uds_grdl(i,j),j= 6, 6),
     &      i=1, 99)/ ! Singlet Q2=  4.42443275
     &0.13190E+00, 0.11829E+00, 0.11167E+00, 0.10784E+00, 0.10557E+00,
     &0.10431E+00, 0.10379E+00, 0.10379E+00, 0.10420E+00, 0.10495E+00,
     &0.10598E+00, 0.10725E+00, 0.10869E+00, 0.11028E+00, 0.11200E+00,
     &0.11383E+00, 0.11575E+00, 0.11774E+00, 0.11978E+00, 0.12188E+00,
     &0.12401E+00, 0.12618E+00, 0.12835E+00, 0.13054E+00, 0.13271E+00,
     &0.13488E+00, 0.13704E+00, 0.13917E+00, 0.14126E+00, 0.14333E+00,
     &0.14535E+00, 0.14732E+00, 0.14923E+00, 0.15109E+00, 0.15289E+00,
     &0.15461E+00, 0.15626E+00, 0.15784E+00, 0.15933E+00, 0.16074E+00,
     &0.16205E+00, 0.16328E+00, 0.16440E+00, 0.16542E+00, 0.16633E+00,
     &0.16714E+00, 0.16783E+00, 0.16841E+00, 0.16887E+00, 0.16920E+00,
     &0.16941E+00, 0.16949E+00, 0.16944E+00, 0.16925E+00, 0.16893E+00,
     &0.16847E+00, 0.16786E+00, 0.16711E+00, 0.16622E+00, 0.16517E+00,
     &0.16397E+00, 0.16261E+00, 0.16111E+00, 0.15944E+00, 0.15761E+00,
     &0.15563E+00, 0.15348E+00, 0.15117E+00, 0.14869E+00, 0.14604E+00,
     &0.14324E+00, 0.14025E+00, 0.13711E+00, 0.13379E+00, 0.13031E+00,
     &0.12666E+00, 0.12283E+00, 0.11885E+00, 0.11469E+00, 0.11037E+00,
     &0.10588E+00, 0.10123E+00, 0.96425E-01, 0.91464E-01, 0.86347E-01,
     &0.81083E-01, 0.75677E-01, 0.70134E-01, 0.64462E-01, 0.58670E-01,
     &0.52773E-01, 0.46774E-01, 0.40702E-01, 0.34575E-01, 0.28417E-01,
     &0.22271E-01,
     &0.16188E-01,
     &0.10262E-01,
     &0.46713E-02/

      data ((uds_grdl(i,j),j= 7, 7),
     &      i=1, 99)/ ! Singlet Q2=  5.18588781
     &0.14924E+00, 0.13221E+00, 0.12374E+00, 0.11865E+00, 0.11543E+00,
     &0.11341E+00, 0.11225E+00, 0.11169E+00, 0.11162E+00, 0.11194E+00,
     &0.11259E+00, 0.11349E+00, 0.11460E+00, 0.11589E+00, 0.11733E+00,
     &0.11888E+00, 0.12054E+00, 0.12229E+00, 0.12410E+00, 0.12597E+00,
     &0.12788E+00, 0.12984E+00, 0.13180E+00, 0.13379E+00, 0.13577E+00,
     &0.13775E+00, 0.13971E+00, 0.14166E+00, 0.14358E+00, 0.14546E+00,
     &0.14730E+00, 0.14910E+00, 0.15084E+00, 0.15253E+00, 0.15416E+00,
     &0.15572E+00, 0.15721E+00, 0.15862E+00, 0.15996E+00, 0.16120E+00,
     &0.16236E+00, 0.16343E+00, 0.16440E+00, 0.16527E+00, 0.16603E+00,
     &0.16669E+00, 0.16723E+00, 0.16767E+00, 0.16798E+00, 0.16817E+00,
     &0.16825E+00, 0.16819E+00, 0.16800E+00, 0.16768E+00, 0.16724E+00,
     &0.16665E+00, 0.16592E+00, 0.16505E+00, 0.16404E+00, 0.16288E+00,
     &0.16157E+00, 0.16011E+00, 0.15850E+00, 0.15674E+00, 0.15483E+00,
     &0.15275E+00, 0.15052E+00, 0.14814E+00, 0.14559E+00, 0.14288E+00,
     &0.14002E+00, 0.13699E+00, 0.13379E+00, 0.13044E+00, 0.12693E+00,
     &0.12326E+00, 0.11943E+00, 0.11543E+00, 0.11128E+00, 0.10698E+00,
     &0.10252E+00, 0.97906E-01, 0.93144E-01, 0.88241E-01, 0.83196E-01,
     &0.78016E-01, 0.72707E-01, 0.67276E-01, 0.61731E-01, 0.56082E-01,
     &0.50343E-01, 0.44523E-01, 0.38646E-01, 0.32735E-01, 0.26816E-01,
     &0.20931E-01,
     &0.15137E-01,
     &0.95286E-02,
     &0.42899E-02/

      data ((uds_grdl(i,j),j= 8, 8),
     &      i=1, 99)/ ! Singlet Q2=  6.0783906
     &0.16673E+00, 0.14604E+00, 0.13564E+00, 0.12924E+00, 0.12504E+00,
     &0.12224E+00, 0.12042E+00, 0.11932E+00, 0.11875E+00, 0.11864E+00,
     &0.11890E+00, 0.11945E+00, 0.12023E+00, 0.12122E+00, 0.12237E+00,
     &0.12366E+00, 0.12507E+00, 0.12657E+00, 0.12815E+00, 0.12980E+00,
     &0.13150E+00, 0.13325E+00, 0.13502E+00, 0.13681E+00, 0.13860E+00,
     &0.14039E+00, 0.14218E+00, 0.14395E+00, 0.14569E+00, 0.14740E+00,
     &0.14907E+00, 0.15070E+00, 0.15228E+00, 0.15381E+00, 0.15528E+00,
     &0.15668E+00, 0.15801E+00, 0.15927E+00, 0.16045E+00, 0.16154E+00,
     &0.16255E+00, 0.16347E+00, 0.16429E+00, 0.16502E+00, 0.16564E+00,
     &0.16616E+00, 0.16656E+00, 0.16686E+00, 0.16704E+00, 0.16710E+00,
     &0.16704E+00, 0.16686E+00, 0.16654E+00, 0.16610E+00, 0.16554E+00,
     &0.16483E+00, 0.16399E+00, 0.16301E+00, 0.16189E+00, 0.16062E+00,
     &0.15922E+00, 0.15766E+00, 0.15596E+00, 0.15412E+00, 0.15211E+00,
     &0.14996E+00, 0.14766E+00, 0.14521E+00, 0.14260E+00, 0.13983E+00,
     &0.13692E+00, 0.13384E+00, 0.13062E+00, 0.12723E+00, 0.12370E+00,
     &0.12001E+00, 0.11617E+00, 0.11218E+00, 0.10804E+00, 0.10376E+00,
     &0.99322E-01, 0.94752E-01, 0.90040E-01, 0.85197E-01, 0.80224E-01,
     &0.75128E-01, 0.69916E-01, 0.64594E-01, 0.59173E-01, 0.53662E-01,
     &0.48078E-01, 0.42427E-01, 0.36739E-01, 0.31033E-01, 0.25340E-01,
     &0.19702E-01,
     &0.14178E-01,
     &0.88643E-02,
     &0.39486E-02/

      data ((uds_grdl(i,j),j= 9, 9),
     &      i=1, 99)/ ! Singlet Q2=  7.12449598
     &0.18432E+00, 0.15977E+00, 0.14735E+00, 0.13961E+00, 0.13441E+00,
     &0.13081E+00, 0.12834E+00, 0.12667E+00, 0.12561E+00, 0.12507E+00,
     &0.12494E+00, 0.12514E+00, 0.12560E+00, 0.12628E+00, 0.12715E+00,
     &0.12818E+00, 0.12934E+00, 0.13060E+00, 0.13196E+00, 0.13340E+00,
     &0.13489E+00, 0.13644E+00, 0.13801E+00, 0.13961E+00, 0.14122E+00,
     &0.14283E+00, 0.14444E+00, 0.14604E+00, 0.14761E+00, 0.14916E+00,
     &0.15067E+00, 0.15214E+00, 0.15356E+00, 0.15494E+00, 0.15625E+00,
     &0.15750E+00, 0.15868E+00, 0.15979E+00, 0.16082E+00, 0.16177E+00,
     &0.16264E+00, 0.16342E+00, 0.16410E+00, 0.16469E+00, 0.16518E+00,
     &0.16556E+00, 0.16583E+00, 0.16600E+00, 0.16605E+00, 0.16599E+00,
     &0.16581E+00, 0.16550E+00, 0.16507E+00, 0.16452E+00, 0.16384E+00,
     &0.16302E+00, 0.16207E+00, 0.16099E+00, 0.15977E+00, 0.15841E+00,
     &0.15691E+00, 0.15527E+00, 0.15348E+00, 0.15156E+00, 0.14948E+00,
     &0.14726E+00, 0.14489E+00, 0.14237E+00, 0.13971E+00, 0.13690E+00,
     &0.13394E+00, 0.13082E+00, 0.12757E+00, 0.12416E+00, 0.12061E+00,
     &0.11691E+00, 0.11307E+00, 0.10908E+00, 0.10495E+00, 0.10069E+00,
     &0.96290E-01, 0.91761E-01, 0.87100E-01, 0.82319E-01, 0.77418E-01,
     &0.72405E-01, 0.67288E-01, 0.62074E-01, 0.56774E-01, 0.51398E-01,
     &0.45961E-01, 0.40475E-01, 0.34966E-01, 0.29456E-01, 0.23977E-01,
     &0.18571E-01,
     &0.13300E-01,
     &0.82610E-02,
     &0.36423E-02/

      data ((uds_grdl(i,j),j= 10, 10),
     &      i=1, 99)/ ! Singlet Q2=  8.35063744
     &0.20199E+00, 0.17340E+00, 0.15889E+00, 0.14976E+00, 0.14354E+00,
     &0.13912E+00, 0.13599E+00, 0.13375E+00, 0.13221E+00, 0.13124E+00,
     &0.13072E+00, 0.13057E+00, 0.13070E+00, 0.13109E+00, 0.13169E+00,
     &0.13246E+00, 0.13337E+00, 0.13441E+00, 0.13554E+00, 0.13677E+00,
     &0.13806E+00, 0.13941E+00, 0.14080E+00, 0.14221E+00, 0.14365E+00,
     &0.14509E+00, 0.14653E+00, 0.14796E+00, 0.14937E+00, 0.15076E+00,
     &0.15211E+00, 0.15343E+00, 0.15470E+00, 0.15592E+00, 0.15709E+00,
     &0.15819E+00, 0.15923E+00, 0.16020E+00, 0.16109E+00, 0.16191E+00,
     &0.16264E+00, 0.16328E+00, 0.16383E+00, 0.16429E+00, 0.16465E+00,
     &0.16491E+00, 0.16506E+00, 0.16510E+00, 0.16503E+00, 0.16485E+00,
     &0.16455E+00, 0.16413E+00, 0.16359E+00, 0.16293E+00, 0.16215E+00,
     &0.16123E+00, 0.16018E+00, 0.15900E+00, 0.15769E+00, 0.15624E+00,
     &0.15465E+00, 0.15293E+00, 0.15107E+00, 0.14906E+00, 0.14692E+00,
     &0.14463E+00, 0.14221E+00, 0.13963E+00, 0.13692E+00, 0.13406E+00,
     &0.13106E+00, 0.12792E+00, 0.12463E+00, 0.12121E+00, 0.11764E+00,
     &0.11394E+00, 0.11010E+00, 0.10612E+00, 0.10201E+00, 0.97773E-01,
     &0.93407E-01, 0.88920E-01, 0.84311E-01, 0.79592E-01, 0.74764E-01,
     &0.69834E-01, 0.64812E-01, 0.59703E-01, 0.54521E-01, 0.49274E-01,
     &0.43981E-01, 0.38652E-01, 0.33315E-01, 0.27992E-01, 0.22715E-01,
     &0.17529E-01,
     &0.12495E-01,
     &0.77117E-02,
     &0.33667E-02/

      data ((uds_grdl(i,j),j= 11, 11),
     &      i=1, 99)/ ! Singlet Q2=  9.78780174
     &0.21970E+00, 0.18689E+00, 0.17024E+00, 0.15970E+00, 0.15243E+00,
     &0.14720E+00, 0.14339E+00, 0.14059E+00, 0.13856E+00, 0.13716E+00,
     &0.13625E+00, 0.13575E+00, 0.13557E+00, 0.13567E+00, 0.13599E+00,
     &0.13651E+00, 0.13718E+00, 0.13799E+00, 0.13891E+00, 0.13994E+00,
     &0.14103E+00, 0.14219E+00, 0.14339E+00, 0.14463E+00, 0.14589E+00,
     &0.14717E+00, 0.14844E+00, 0.14972E+00, 0.15097E+00, 0.15220E+00,
     &0.15341E+00, 0.15458E+00, 0.15570E+00, 0.15678E+00, 0.15781E+00,
     &0.15877E+00, 0.15968E+00, 0.16051E+00, 0.16127E+00, 0.16195E+00,
     &0.16255E+00, 0.16307E+00, 0.16350E+00, 0.16383E+00, 0.16407E+00,
     &0.16420E+00, 0.16424E+00, 0.16416E+00, 0.16398E+00, 0.16369E+00,
     &0.16328E+00, 0.16276E+00, 0.16211E+00, 0.16135E+00, 0.16046E+00,
     &0.15945E+00, 0.15831E+00, 0.15704E+00, 0.15564E+00, 0.15411E+00,
     &0.15244E+00, 0.15064E+00, 0.14871E+00, 0.14664E+00, 0.14443E+00,
     &0.14209E+00, 0.13960E+00, 0.13698E+00, 0.13422E+00, 0.13133E+00,
     &0.12830E+00, 0.12512E+00, 0.12182E+00, 0.11837E+00, 0.11480E+00,
     &0.11110E+00, 0.10726E+00, 0.10329E+00, 0.99203E-01, 0.94993E-01,
     &0.90662E-01, 0.86220E-01, 0.81665E-01, 0.77008E-01, 0.72252E-01,
     &0.67404E-01, 0.62474E-01, 0.57469E-01, 0.52401E-01, 0.47281E-01,
     &0.42126E-01, 0.36949E-01, 0.31775E-01, 0.26631E-01, 0.21546E-01,
     &0.16567E-01,
     &0.11756E-01,
     &0.72106E-02,
     &0.31180E-02/

      data ((uds_grdl(i,j),j= 12, 12),
     &      i=1, 99)/ ! Singlet Q2=  11.4723053
     &0.23745E+00, 0.20026E+00, 0.18139E+00, 0.16941E+00, 0.16108E+00,
     &0.15503E+00, 0.15055E+00, 0.14718E+00, 0.14467E+00, 0.14284E+00,
     &0.14155E+00, 0.14071E+00, 0.14021E+00, 0.14002E+00, 0.14008E+00,
     &0.14034E+00, 0.14079E+00, 0.14138E+00, 0.14209E+00, 0.14291E+00,
     &0.14381E+00, 0.14479E+00, 0.14581E+00, 0.14688E+00, 0.14797E+00,
     &0.14909E+00, 0.15021E+00, 0.15132E+00, 0.15243E+00, 0.15351E+00,
     &0.15457E+00, 0.15560E+00, 0.15659E+00, 0.15753E+00, 0.15842E+00,
     &0.15925E+00, 0.16002E+00, 0.16073E+00, 0.16136E+00, 0.16192E+00,
     &0.16240E+00, 0.16279E+00, 0.16310E+00, 0.16332E+00, 0.16344E+00,
     &0.16346E+00, 0.16338E+00, 0.16320E+00, 0.16291E+00, 0.16251E+00,
     &0.16200E+00, 0.16138E+00, 0.16063E+00, 0.15977E+00, 0.15879E+00,
     &0.15769E+00, 0.15646E+00, 0.15511E+00, 0.15363E+00, 0.15202E+00,
     &0.15028E+00, 0.14841E+00, 0.14641E+00, 0.14428E+00, 0.14201E+00,
     &0.13962E+00, 0.13708E+00, 0.13442E+00, 0.13162E+00, 0.12869E+00,
     &0.12563E+00, 0.12243E+00, 0.11911E+00, 0.11565E+00, 0.11207E+00,
     &0.10837E+00, 0.10454E+00, 0.10059E+00, 0.96522E-01, 0.92342E-01,
     &0.88048E-01, 0.83651E-01, 0.79150E-01, 0.74556E-01, 0.69871E-01,
     &0.65105E-01, 0.60266E-01, 0.55362E-01, 0.50405E-01, 0.45407E-01,
     &0.40386E-01, 0.35353E-01, 0.30337E-01, 0.25362E-01, 0.20461E-01,
     &0.15678E-01,
     &0.11075E-01,
     &0.67524E-02,
     &0.28930E-02/

      data ((uds_grdl(i,j),j= 13, 13),
     &      i=1, 99)/ ! Singlet Q2=  13.4467154
     &0.25519E+00, 0.21348E+00, 0.19235E+00, 0.17891E+00, 0.16952E+00,
     &0.16263E+00, 0.15748E+00, 0.15355E+00, 0.15054E+00, 0.14829E+00,
     &0.14663E+00, 0.14544E+00, 0.14464E+00, 0.14417E+00, 0.14396E+00,
     &0.14398E+00, 0.14419E+00, 0.14457E+00, 0.14508E+00, 0.14570E+00,
     &0.14642E+00, 0.14722E+00, 0.14807E+00, 0.14897E+00, 0.14990E+00,
     &0.15086E+00, 0.15183E+00, 0.15279E+00, 0.15375E+00, 0.15470E+00,
     &0.15562E+00, 0.15651E+00, 0.15736E+00, 0.15817E+00, 0.15893E+00,
     &0.15964E+00, 0.16028E+00, 0.16087E+00, 0.16138E+00, 0.16182E+00,
     &0.16218E+00, 0.16246E+00, 0.16265E+00, 0.16275E+00, 0.16276E+00,
     &0.16268E+00, 0.16249E+00, 0.16221E+00, 0.16182E+00, 0.16132E+00,
     &0.16071E+00, 0.15999E+00, 0.15916E+00, 0.15821E+00, 0.15714E+00,
     &0.15595E+00, 0.15464E+00, 0.15321E+00, 0.15166E+00, 0.14998E+00,
     &0.14817E+00, 0.14623E+00, 0.14417E+00, 0.14198E+00, 0.13966E+00,
     &0.13722E+00, 0.13464E+00, 0.13194E+00, 0.12910E+00, 0.12614E+00,
     &0.12305E+00, 0.11984E+00, 0.11650E+00, 0.11304E+00, 0.10946E+00,
     &0.10576E+00, 0.10194E+00, 0.98004E-01, 0.93959E-01, 0.89810E-01,
     &0.85556E-01, 0.81205E-01, 0.76758E-01, 0.72227E-01, 0.67613E-01,
     &0.62927E-01, 0.58176E-01, 0.53371E-01, 0.48523E-01, 0.43643E-01,
     &0.38751E-01, 0.33858E-01, 0.28993E-01, 0.24179E-01, 0.19451E-01,
     &0.14853E-01,
     &0.10448E-01,
     &0.63326E-02,
     &0.26890E-02/

      data ((uds_grdl(i,j),j= 14, 14),
     &      i=1, 99)/ ! Singlet Q2=  15.7609253
     &0.27292E+00, 0.22655E+00, 0.20312E+00, 0.18819E+00, 0.17773E+00,
     &0.17001E+00, 0.16418E+00, 0.15968E+00, 0.15620E+00, 0.15352E+00,
     &0.15149E+00, 0.14997E+00, 0.14886E+00, 0.14811E+00, 0.14765E+00,
     &0.14743E+00, 0.14742E+00, 0.14758E+00, 0.14789E+00, 0.14833E+00,
     &0.14886E+00, 0.14949E+00, 0.15017E+00, 0.15092E+00, 0.15169E+00,
     &0.15249E+00, 0.15331E+00, 0.15414E+00, 0.15496E+00, 0.15577E+00,
     &0.15655E+00, 0.15731E+00, 0.15804E+00, 0.15872E+00, 0.15936E+00,
     &0.15994E+00, 0.16047E+00, 0.16093E+00, 0.16133E+00, 0.16165E+00,
     &0.16190E+00, 0.16207E+00, 0.16215E+00, 0.16215E+00, 0.16205E+00,
     &0.16187E+00, 0.16158E+00, 0.16120E+00, 0.16071E+00, 0.16012E+00,
     &0.15942E+00, 0.15861E+00, 0.15769E+00, 0.15665E+00, 0.15551E+00,
     &0.15424E+00, 0.15285E+00, 0.15135E+00, 0.14972E+00, 0.14797E+00,
     &0.14610E+00, 0.14411E+00, 0.14199E+00, 0.13975E+00, 0.13738E+00,
     &0.13489E+00, 0.13227E+00, 0.12953E+00, 0.12667E+00, 0.12368E+00,
     &0.12057E+00, 0.11734E+00, 0.11399E+00, 0.11052E+00, 0.10694E+00,
     &0.10325E+00, 0.99441E-01, 0.95528E-01, 0.91509E-01, 0.87392E-01,
     &0.83177E-01, 0.78873E-01, 0.74481E-01, 0.70012E-01, 0.65468E-01,
     &0.60861E-01, 0.56198E-01, 0.51489E-01, 0.46745E-01, 0.41981E-01,
     &0.37212E-01, 0.32454E-01, 0.27733E-01, 0.23074E-01, 0.18511E-01,
     &0.14088E-01,
     &0.98678E-02,
     &0.59472E-02,
     &0.25035E-02/

      data ((uds_grdl(i,j),j= 15, 15),
     &      i=1, 99)/ ! Singlet Q2=  18.4734173
     &0.29062E+00, 0.23946E+00, 0.21369E+00, 0.19726E+00, 0.18572E+00,
     &0.17717E+00, 0.17066E+00, 0.16561E+00, 0.16165E+00, 0.15855E+00,
     &0.15615E+00, 0.15430E+00, 0.15289E+00, 0.15187E+00, 0.15115E+00,
     &0.15070E+00, 0.15047E+00, 0.15043E+00, 0.15054E+00, 0.15080E+00,
     &0.15116E+00, 0.15161E+00, 0.15214E+00, 0.15272E+00, 0.15335E+00,
     &0.15400E+00, 0.15468E+00, 0.15537E+00, 0.15605E+00, 0.15673E+00,
     &0.15739E+00, 0.15802E+00, 0.15862E+00, 0.15918E+00, 0.15970E+00,
     &0.16017E+00, 0.16058E+00, 0.16093E+00, 0.16121E+00, 0.16143E+00,
     &0.16157E+00, 0.16163E+00, 0.16162E+00, 0.16151E+00, 0.16132E+00,
     &0.16103E+00, 0.16065E+00, 0.16017E+00, 0.15959E+00, 0.15891E+00,
     &0.15813E+00, 0.15723E+00, 0.15623E+00, 0.15511E+00, 0.15389E+00,
     &0.15255E+00, 0.15109E+00, 0.14952E+00, 0.14782E+00, 0.14601E+00,
     &0.14408E+00, 0.14203E+00, 0.13986E+00, 0.13757E+00, 0.13516E+00,
     &0.13263E+00, 0.12998E+00, 0.12720E+00, 0.12431E+00, 0.12130E+00,
     &0.11817E+00, 0.11493E+00, 0.11157E+00, 0.10810E+00, 0.10452E+00,
     &0.10084E+00, 0.97047E-01, 0.93154E-01, 0.89162E-01, 0.85079E-01,
     &0.80905E-01, 0.76648E-01, 0.72311E-01, 0.67903E-01, 0.63430E-01,
     &0.58900E-01, 0.54322E-01, 0.49707E-01, 0.45066E-01, 0.40412E-01,
     &0.35764E-01, 0.31134E-01, 0.26551E-01, 0.22040E-01, 0.17633E-01,
     &0.13377E-01,
     &0.93313E-02,
     &0.55927E-02,
     &0.23347E-02/

      data ((uds_grdl(i,j),j= 16, 16),
     &      i=1, 99)/ ! Singlet Q2=  21.6527348
     &0.30827E+00, 0.25222E+00, 0.22407E+00, 0.20613E+00, 0.19350E+00,
     &0.18412E+00, 0.17694E+00, 0.17133E+00, 0.16689E+00, 0.16338E+00,
     &0.16062E+00, 0.15844E+00, 0.15674E+00, 0.15545E+00, 0.15449E+00,
     &0.15381E+00, 0.15336E+00, 0.15312E+00, 0.15305E+00, 0.15312E+00,
     &0.15331E+00, 0.15360E+00, 0.15397E+00, 0.15440E+00, 0.15488E+00,
     &0.15539E+00, 0.15594E+00, 0.15649E+00, 0.15704E+00, 0.15759E+00,
     &0.15813E+00, 0.15864E+00, 0.15912E+00, 0.15957E+00, 0.15997E+00,
     &0.16032E+00, 0.16062E+00, 0.16087E+00, 0.16105E+00, 0.16116E+00,
     &0.16120E+00, 0.16116E+00, 0.16104E+00, 0.16084E+00, 0.16055E+00,
     &0.16017E+00, 0.15970E+00, 0.15913E+00, 0.15847E+00, 0.15770E+00,
     &0.15683E+00, 0.15586E+00, 0.15478E+00, 0.15359E+00, 0.15229E+00,
     &0.15088E+00, 0.14935E+00, 0.14772E+00, 0.14596E+00, 0.14409E+00,
     &0.14211E+00, 0.14001E+00, 0.13779E+00, 0.13546E+00, 0.13300E+00,
     &0.13043E+00, 0.12775E+00, 0.12495E+00, 0.12203E+00, 0.11900E+00,
     &0.11586E+00, 0.11260E+00, 0.10924E+00, 0.10577E+00, 0.10220E+00,
     &0.98524E-01, 0.94748E-01, 0.90878E-01, 0.86914E-01, 0.82866E-01,
     &0.78732E-01, 0.74523E-01, 0.70240E-01, 0.65894E-01, 0.61490E-01,
     &0.57035E-01, 0.52542E-01, 0.48018E-01, 0.43476E-01, 0.38930E-01,
     &0.34397E-01, 0.29892E-01, 0.25442E-01, 0.21071E-01, 0.16814E-01,
     &0.12715E-01,
     &0.88339E-02,
     &0.52661E-02,
     &0.21805E-02/

      data ((uds_grdl(i,j),j= 17, 17),
     &      i=1, 99)/ ! Singlet Q2=  25.379221
     &0.32589E+00, 0.26483E+00, 0.23427E+00, 0.21481E+00, 0.20109E+00,
     &0.19087E+00, 0.18303E+00, 0.17686E+00, 0.17195E+00, 0.16803E+00,
     &0.16491E+00, 0.16241E+00, 0.16042E+00, 0.15886E+00, 0.15766E+00,
     &0.15676E+00, 0.15611E+00, 0.15567E+00, 0.15541E+00, 0.15531E+00,
     &0.15533E+00, 0.15546E+00, 0.15568E+00, 0.15596E+00, 0.15630E+00,
     &0.15668E+00, 0.15709E+00, 0.15751E+00, 0.15794E+00, 0.15837E+00,
     &0.15878E+00, 0.15918E+00, 0.15954E+00, 0.15988E+00, 0.16017E+00,
     &0.16042E+00, 0.16061E+00, 0.16075E+00, 0.16083E+00, 0.16084E+00,
     &0.16078E+00, 0.16065E+00, 0.16044E+00, 0.16014E+00, 0.15976E+00,
     &0.15930E+00, 0.15874E+00, 0.15809E+00, 0.15734E+00, 0.15649E+00,
     &0.15554E+00, 0.15449E+00, 0.15334E+00, 0.15208E+00, 0.15071E+00,
     &0.14923E+00, 0.14765E+00, 0.14595E+00, 0.14414E+00, 0.14222E+00,
     &0.14018E+00, 0.13803E+00, 0.13577E+00, 0.13339E+00, 0.13090E+00,
     &0.12830E+00, 0.12558E+00, 0.12276E+00, 0.11982E+00, 0.11677E+00,
     &0.11362E+00, 0.11036E+00, 0.10699E+00, 0.10352E+00, 0.99957E-01,
     &0.96295E-01, 0.92537E-01, 0.88691E-01, 0.84757E-01, 0.80743E-01,
     &0.76651E-01, 0.72490E-01, 0.68262E-01, 0.63977E-01, 0.59640E-01,
     &0.55260E-01, 0.50848E-01, 0.46413E-01, 0.41969E-01, 0.37527E-01,
     &0.33105E-01, 0.28720E-01, 0.24397E-01, 0.20161E-01, 0.16046E-01,
     &0.12097E-01,
     &0.83717E-02,
     &0.49643E-02,
     &0.20393E-02/

      data ((uds_grdl(i,j),j= 18, 18),
     &      i=1, 99)/ ! Singlet Q2=  29.7470417
     &0.34346E+00, 0.27730E+00, 0.24430E+00, 0.22330E+00, 0.20849E+00,
     &0.19744E+00, 0.18892E+00, 0.18220E+00, 0.17683E+00, 0.17251E+00,
     &0.16903E+00, 0.16622E+00, 0.16394E+00, 0.16213E+00, 0.16069E+00,
     &0.15956E+00, 0.15871E+00, 0.15808E+00, 0.15764E+00, 0.15737E+00,
     &0.15723E+00, 0.15721E+00, 0.15727E+00, 0.15742E+00, 0.15762E+00,
     &0.15786E+00, 0.15814E+00, 0.15844E+00, 0.15875E+00, 0.15906E+00,
     &0.15936E+00, 0.15964E+00, 0.15990E+00, 0.16012E+00, 0.16031E+00,
     &0.16045E+00, 0.16055E+00, 0.16059E+00, 0.16057E+00, 0.16048E+00,
     &0.16033E+00, 0.16010E+00, 0.15980E+00, 0.15942E+00, 0.15895E+00,
     &0.15840E+00, 0.15776E+00, 0.15703E+00, 0.15620E+00, 0.15528E+00,
     &0.15426E+00, 0.15314E+00, 0.15191E+00, 0.15058E+00, 0.14915E+00,
     &0.14761E+00, 0.14597E+00, 0.14421E+00, 0.14235E+00, 0.14037E+00,
     &0.13829E+00, 0.13610E+00, 0.13379E+00, 0.13138E+00, 0.12885E+00,
     &0.12622E+00, 0.12348E+00, 0.12063E+00, 0.11767E+00, 0.11461E+00,
     &0.11145E+00, 0.10818E+00, 0.10482E+00, 0.10135E+00, 0.97795E-01,
     &0.94147E-01, 0.90409E-01, 0.86587E-01, 0.82683E-01, 0.78706E-01,
     &0.74656E-01, 0.70543E-01, 0.66368E-01, 0.62144E-01, 0.57874E-01,
     &0.53568E-01, 0.49236E-01, 0.44888E-01, 0.40537E-01, 0.36196E-01,
     &0.31883E-01, 0.27613E-01, 0.23412E-01, 0.19305E-01, 0.15326E-01,
     &0.11519E-01,
     &0.79413E-02,
     &0.46848E-02,
     &0.19097E-02/

      data ((uds_grdl(i,j),j= 19, 19),
     &      i=1, 99)/ ! Singlet Q2=  34.8665771
     &0.36098E+00, 0.28961E+00, 0.25415E+00, 0.23161E+00, 0.21570E+00,
     &0.20382E+00, 0.19464E+00, 0.18737E+00, 0.18154E+00, 0.17682E+00,
     &0.17299E+00, 0.16986E+00, 0.16731E+00, 0.16524E+00, 0.16357E+00,
     &0.16223E+00, 0.16118E+00, 0.16036E+00, 0.15975E+00, 0.15931E+00,
     &0.15901E+00, 0.15884E+00, 0.15876E+00, 0.15877E+00, 0.15884E+00,
     &0.15895E+00, 0.15911E+00, 0.15929E+00, 0.15948E+00, 0.15967E+00,
     &0.15986E+00, 0.16003E+00, 0.16018E+00, 0.16031E+00, 0.16039E+00,
     &0.16044E+00, 0.16043E+00, 0.16038E+00, 0.16026E+00, 0.16008E+00,
     &0.15984E+00, 0.15953E+00, 0.15914E+00, 0.15867E+00, 0.15812E+00,
     &0.15749E+00, 0.15677E+00, 0.15597E+00, 0.15506E+00, 0.15407E+00,
     &0.15298E+00, 0.15179E+00, 0.15050E+00, 0.14911E+00, 0.14761E+00,
     &0.14601E+00, 0.14431E+00, 0.14250E+00, 0.14059E+00, 0.13857E+00,
     &0.13644E+00, 0.13421E+00, 0.13186E+00, 0.12942E+00, 0.12686E+00,
     &0.12420E+00, 0.12143E+00, 0.11857E+00, 0.11559E+00, 0.11252E+00,
     &0.10935E+00, 0.10608E+00, 0.10271E+00, 0.99255E-01, 0.95709E-01,
     &0.92076E-01, 0.88359E-01, 0.84562E-01, 0.80690E-01, 0.76749E-01,
     &0.72742E-01, 0.68676E-01, 0.64555E-01, 0.60390E-01, 0.56186E-01,
     &0.51952E-01, 0.47699E-01, 0.43436E-01, 0.39176E-01, 0.34933E-01,
     &0.30724E-01, 0.26565E-01, 0.22482E-01, 0.18499E-01, 0.14650E-01,
     &0.10978E-01,
     &0.75400E-02,
     &0.44258E-02,
     &0.17907E-02/

      data ((uds_grdl(i,j),j= 20, 20),
     &      i=1, 99)/ ! Singlet Q2=  40.8671951
     &0.37843E+00, 0.30177E+00, 0.26383E+00, 0.23973E+00, 0.22274E+00,
     &0.21002E+00, 0.20019E+00, 0.19238E+00, 0.18608E+00, 0.18097E+00,
     &0.17679E+00, 0.17336E+00, 0.17054E+00, 0.16822E+00, 0.16632E+00,
     &0.16477E+00, 0.16352E+00, 0.16252E+00, 0.16174E+00, 0.16114E+00,
     &0.16069E+00, 0.16037E+00, 0.16015E+00, 0.16003E+00, 0.15997E+00,
     &0.15996E+00, 0.15999E+00, 0.16006E+00, 0.16013E+00, 0.16022E+00,
     &0.16030E+00, 0.16037E+00, 0.16041E+00, 0.16044E+00, 0.16042E+00,
     &0.16037E+00, 0.16027E+00, 0.16013E+00, 0.15992E+00, 0.15966E+00,
     &0.15933E+00, 0.15893E+00, 0.15846E+00, 0.15791E+00, 0.15728E+00,
     &0.15657E+00, 0.15578E+00, 0.15490E+00, 0.15393E+00, 0.15286E+00,
     &0.15170E+00, 0.15045E+00, 0.14910E+00, 0.14764E+00, 0.14609E+00,
     &0.14444E+00, 0.14268E+00, 0.14083E+00, 0.13887E+00, 0.13680E+00,
     &0.13463E+00, 0.13236E+00, 0.12998E+00, 0.12750E+00, 0.12492E+00,
     &0.12223E+00, 0.11945E+00, 0.11656E+00, 0.11357E+00, 0.11049E+00,
     &0.10731E+00, 0.10404E+00, 0.10068E+00, 0.97229E-01, 0.93695E-01,
     &0.90079E-01, 0.86383E-01, 0.82613E-01, 0.78773E-01, 0.74869E-01,
     &0.70903E-01, 0.66885E-01, 0.62818E-01, 0.58712E-01, 0.54573E-01,
     &0.50410E-01, 0.46233E-01, 0.42053E-01, 0.37882E-01, 0.33734E-01,
     &0.29626E-01, 0.25574E-01, 0.21603E-01, 0.17740E-01, 0.14014E-01,
     &0.10471E-01,
     &0.71655E-02,
     &0.41853E-02,
     &0.16810E-02/

      data ((uds_grdl(i,j),j= 21, 21),
     &      i=1, 99)/ ! Singlet Q2=  47.9005318
     &0.39580E+00, 0.31378E+00, 0.27333E+00, 0.24769E+00, 0.22959E+00,
     &0.21606E+00, 0.20556E+00, 0.19722E+00, 0.19047E+00, 0.18497E+00,
     &0.18045E+00, 0.17672E+00, 0.17363E+00, 0.17106E+00, 0.16894E+00,
     &0.16719E+00, 0.16575E+00, 0.16457E+00, 0.16362E+00, 0.16286E+00,
     &0.16227E+00, 0.16180E+00, 0.16145E+00, 0.16120E+00, 0.16101E+00,
     &0.16088E+00, 0.16080E+00, 0.16075E+00, 0.16072E+00, 0.16069E+00,
     &0.16067E+00, 0.16064E+00, 0.16059E+00, 0.16051E+00, 0.16041E+00,
     &0.16026E+00, 0.16008E+00, 0.15984E+00, 0.15955E+00, 0.15920E+00,
     &0.15879E+00, 0.15831E+00, 0.15776E+00, 0.15713E+00, 0.15643E+00,
     &0.15565E+00, 0.15478E+00, 0.15383E+00, 0.15279E+00, 0.15166E+00,
     &0.15044E+00, 0.14912E+00, 0.14771E+00, 0.14620E+00, 0.14460E+00,
     &0.14289E+00, 0.14109E+00, 0.13918E+00, 0.13718E+00, 0.13507E+00,
     &0.13286E+00, 0.13055E+00, 0.12814E+00, 0.12563E+00, 0.12302E+00,
     &0.12032E+00, 0.11751E+00, 0.11461E+00, 0.11161E+00, 0.10852E+00,
     &0.10534E+00, 0.10207E+00, 0.98712E-01, 0.95270E-01, 0.91749E-01,
     &0.88151E-01, 0.84478E-01, 0.80735E-01, 0.76927E-01, 0.73060E-01,
     &0.69137E-01, 0.65167E-01, 0.61153E-01, 0.57105E-01, 0.53029E-01,
     &0.48935E-01, 0.44834E-01, 0.40734E-01, 0.36649E-01, 0.32594E-01,
     &0.28583E-01, 0.24635E-01, 0.20773E-01, 0.17023E-01, 0.13416E-01,
     &0.99951E-02,
     &0.68154E-02,
     &0.39617E-02,
     &0.15799E-02/

      data ((uds_grdl(i,j),j= 22, 22),
     &      i=1, 99)/ ! Singlet Q2=  56.1443253
     &0.41309E+00, 0.32563E+00, 0.28266E+00, 0.25546E+00, 0.23628E+00,
     &0.22192E+00, 0.21078E+00, 0.20190E+00, 0.19470E+00, 0.18882E+00,
     &0.18397E+00, 0.17994E+00, 0.17658E+00, 0.17378E+00, 0.17144E+00,
     &0.16948E+00, 0.16786E+00, 0.16651E+00, 0.16540E+00, 0.16449E+00,
     &0.16375E+00, 0.16315E+00, 0.16266E+00, 0.16228E+00, 0.16197E+00,
     &0.16173E+00, 0.16153E+00, 0.16137E+00, 0.16124E+00, 0.16111E+00,
     &0.16099E+00, 0.16086E+00, 0.16071E+00, 0.16054E+00, 0.16035E+00,
     &0.16011E+00, 0.15984E+00, 0.15952E+00, 0.15914E+00, 0.15871E+00,
     &0.15822E+00, 0.15767E+00, 0.15704E+00, 0.15634E+00, 0.15557E+00,
     &0.15471E+00, 0.15378E+00, 0.15276E+00, 0.15166E+00, 0.15046E+00,
     &0.14918E+00, 0.14781E+00, 0.14634E+00, 0.14478E+00, 0.14312E+00,
     &0.14136E+00, 0.13951E+00, 0.13756E+00, 0.13552E+00, 0.13337E+00,
     &0.13113E+00, 0.12879E+00, 0.12635E+00, 0.12381E+00, 0.12118E+00,
     &0.11845E+00, 0.11563E+00, 0.11271E+00, 0.10971E+00, 0.10661E+00,
     &0.10343E+00, 0.10016E+00, 0.96807E-01, 0.93376E-01, 0.89869E-01,
     &0.86290E-01, 0.82640E-01, 0.78925E-01, 0.75150E-01, 0.71320E-01,
     &0.67440E-01, 0.63517E-01, 0.59555E-01, 0.55564E-01, 0.51551E-01,
     &0.47526E-01, 0.43497E-01, 0.39476E-01, 0.35475E-01, 0.31509E-01,
     &0.27593E-01, 0.23744E-01, 0.19987E-01, 0.16346E-01, 0.12853E-01,
     &0.95484E-02,
     &0.64879E-02,
     &0.37536E-02,
     &0.14866E-02/

      data ((uds_grdl(i,j),j= 23, 23),
     &      i=1, 99)/ ! Singlet Q2=  65.8068924
     &0.43030E+00, 0.33733E+00, 0.29183E+00, 0.26307E+00, 0.24280E+00,
     &0.22763E+00, 0.21584E+00, 0.20643E+00, 0.19879E+00, 0.19253E+00,
     &0.18735E+00, 0.18304E+00, 0.17942E+00, 0.17638E+00, 0.17382E+00,
     &0.17167E+00, 0.16987E+00, 0.16835E+00, 0.16708E+00, 0.16602E+00,
     &0.16514E+00, 0.16440E+00, 0.16379E+00, 0.16329E+00, 0.16286E+00,
     &0.16251E+00, 0.16220E+00, 0.16194E+00, 0.16170E+00, 0.16147E+00,
     &0.16125E+00, 0.16103E+00, 0.16079E+00, 0.16053E+00, 0.16025E+00,
     &0.15993E+00, 0.15957E+00, 0.15917E+00, 0.15871E+00, 0.15820E+00,
     &0.15764E+00, 0.15701E+00, 0.15631E+00, 0.15554E+00, 0.15469E+00,
     &0.15377E+00, 0.15277E+00, 0.15169E+00, 0.15053E+00, 0.14927E+00,
     &0.14793E+00, 0.14650E+00, 0.14498E+00, 0.14337E+00, 0.14166E+00,
     &0.13986E+00, 0.13797E+00, 0.13598E+00, 0.13389E+00, 0.13171E+00,
     &0.12943E+00, 0.12706E+00, 0.12460E+00, 0.12203E+00, 0.11938E+00,
     &0.11663E+00, 0.11380E+00, 0.11087E+00, 0.10786E+00, 0.10476E+00,
     &0.10157E+00, 0.98306E-01, 0.94962E-01, 0.91543E-01, 0.88051E-01,
     &0.84492E-01, 0.80866E-01, 0.77180E-01, 0.73437E-01, 0.69645E-01,
     &0.65807E-01, 0.61931E-01, 0.58021E-01, 0.54087E-01, 0.50136E-01,
     &0.46176E-01, 0.42219E-01, 0.38275E-01, 0.34356E-01, 0.30476E-01,
     &0.26651E-01, 0.22899E-01, 0.19242E-01, 0.15706E-01, 0.12321E-01,
     &0.91284E-02,
     &0.61812E-02,
     &0.35597E-02,
     &0.14003E-02/

      data ((uds_grdl(i,j),j= 24, 24),
     &      i=1, 99)/ ! Singlet Q2=  77.1324081
     &0.44740E+00, 0.34887E+00, 0.30082E+00, 0.27051E+00, 0.24916E+00,
     &0.23317E+00, 0.22074E+00, 0.21081E+00, 0.20274E+00, 0.19611E+00,
     &0.19061E+00, 0.18600E+00, 0.18213E+00, 0.17886E+00, 0.17610E+00,
     &0.17376E+00, 0.17177E+00, 0.17009E+00, 0.16867E+00, 0.16746E+00,
     &0.16644E+00, 0.16558E+00, 0.16484E+00, 0.16422E+00, 0.16368E+00,
     &0.16321E+00, 0.16281E+00, 0.16244E+00, 0.16210E+00, 0.16178E+00,
     &0.16146E+00, 0.16115E+00, 0.16082E+00, 0.16048E+00, 0.16011E+00,
     &0.15971E+00, 0.15927E+00, 0.15879E+00, 0.15826E+00, 0.15767E+00,
     &0.15703E+00, 0.15633E+00, 0.15556E+00, 0.15473E+00, 0.15382E+00,
     &0.15283E+00, 0.15177E+00, 0.15063E+00, 0.14940E+00, 0.14809E+00,
     &0.14670E+00, 0.14521E+00, 0.14364E+00, 0.14198E+00, 0.14023E+00,
     &0.13839E+00, 0.13645E+00, 0.13442E+00, 0.13230E+00, 0.13008E+00,
     &0.12777E+00, 0.12537E+00, 0.12288E+00, 0.12030E+00, 0.11763E+00,
     &0.11486E+00, 0.11201E+00, 0.10908E+00, 0.10606E+00, 0.10295E+00,
     &0.99772E-01, 0.96511E-01, 0.93175E-01, 0.89768E-01, 0.86293E-01,
     &0.82754E-01, 0.79153E-01, 0.75496E-01, 0.71787E-01, 0.68032E-01,
     &0.64236E-01, 0.60406E-01, 0.56547E-01, 0.52669E-01, 0.48779E-01,
     &0.44884E-01, 0.40997E-01, 0.37128E-01, 0.33288E-01, 0.29492E-01,
     &0.25756E-01, 0.22096E-01, 0.18536E-01, 0.15100E-01, 0.11820E-01,
     &0.87331E-02,
     &0.58936E-02,
     &0.33788E-02,
     &0.13203E-02/

      data ((uds_grdl(i,j),j= 25, 25),
     &      i=1, 99)/ ! Singlet Q2=  90.407074
     &0.46440E+00, 0.36025E+00, 0.30966E+00, 0.27779E+00, 0.25536E+00,
     &0.23856E+00, 0.22550E+00, 0.21506E+00, 0.20656E+00, 0.19956E+00,
     &0.19373E+00, 0.18885E+00, 0.18473E+00, 0.18124E+00, 0.17827E+00,
     &0.17574E+00, 0.17358E+00, 0.17174E+00, 0.17016E+00, 0.16882E+00,
     &0.16767E+00, 0.16668E+00, 0.16582E+00, 0.16508E+00, 0.16443E+00,
     &0.16386E+00, 0.16335E+00, 0.16288E+00, 0.16245E+00, 0.16203E+00,
     &0.16163E+00, 0.16123E+00, 0.16082E+00, 0.16039E+00, 0.15994E+00,
     &0.15946E+00, 0.15894E+00, 0.15839E+00, 0.15778E+00, 0.15713E+00,
     &0.15642E+00, 0.15564E+00, 0.15481E+00, 0.15391E+00, 0.15293E+00,
     &0.15189E+00, 0.15076E+00, 0.14956E+00, 0.14828E+00, 0.14692E+00,
     &0.14547E+00, 0.14394E+00, 0.14232E+00, 0.14061E+00, 0.13882E+00,
     &0.13693E+00, 0.13496E+00, 0.13289E+00, 0.13073E+00, 0.12849E+00,
     &0.12615E+00, 0.12372E+00, 0.12121E+00, 0.11861E+00, 0.11592E+00,
     &0.11314E+00, 0.11028E+00, 0.10733E+00, 0.10431E+00, 0.10121E+00,
     &0.98025E-01, 0.94770E-01, 0.91444E-01, 0.88050E-01, 0.84592E-01,
     &0.81074E-01, 0.77498E-01, 0.73870E-01, 0.70194E-01, 0.66477E-01,
     &0.62723E-01, 0.58939E-01, 0.55131E-01, 0.51308E-01, 0.47477E-01,
     &0.43646E-01, 0.39828E-01, 0.36031E-01, 0.32268E-01, 0.28553E-01,
     &0.24903E-01, 0.21332E-01, 0.17866E-01, 0.14527E-01, 0.11346E-01,
     &0.83608E-02,
     &0.56236E-02,
     &0.32098E-02,
     &0.12462E-02/

      data ((uds_grdl(i,j),j= 26, 26),
     &      i=1, 99)/ ! Singlet Q2=  105.966339
     &0.48129E+00, 0.37148E+00, 0.31833E+00, 0.28491E+00, 0.26140E+00,
     &0.24381E+00, 0.23012E+00, 0.21917E+00, 0.21024E+00, 0.20288E+00,
     &0.19674E+00, 0.19159E+00, 0.18722E+00, 0.18351E+00, 0.18034E+00,
     &0.17763E+00, 0.17530E+00, 0.17330E+00, 0.17158E+00, 0.17010E+00,
     &0.16882E+00, 0.16770E+00, 0.16673E+00, 0.16588E+00, 0.16513E+00,
     &0.16445E+00, 0.16384E+00, 0.16328E+00, 0.16275E+00, 0.16225E+00,
     &0.16175E+00, 0.16127E+00, 0.16077E+00, 0.16027E+00, 0.15974E+00,
     &0.15918E+00, 0.15859E+00, 0.15796E+00, 0.15729E+00, 0.15656E+00,
     &0.15578E+00, 0.15494E+00, 0.15405E+00, 0.15308E+00, 0.15205E+00,
     &0.15094E+00, 0.14976E+00, 0.14851E+00, 0.14717E+00, 0.14576E+00,
     &0.14426E+00, 0.14268E+00, 0.14101E+00, 0.13926E+00, 0.13743E+00,
     &0.13550E+00, 0.13349E+00, 0.13139E+00, 0.12920E+00, 0.12693E+00,
     &0.12456E+00, 0.12211E+00, 0.11958E+00, 0.11695E+00, 0.11425E+00,
     &0.11146E+00, 0.10859E+00, 0.10564E+00, 0.10261E+00, 0.99505E-01,
     &0.96329E-01, 0.93080E-01, 0.89765E-01, 0.86386E-01, 0.82946E-01,
     &0.79449E-01, 0.75899E-01, 0.72300E-01, 0.68658E-01, 0.64978E-01,
     &0.61266E-01, 0.57528E-01, 0.53769E-01, 0.50000E-01, 0.46227E-01,
     &0.42459E-01, 0.38707E-01, 0.34981E-01, 0.31293E-01, 0.27658E-01,
     &0.24090E-01, 0.20606E-01, 0.17230E-01, 0.13984E-01, 0.10898E-01,
     &0.80097E-02,
     &0.53699E-02,
     &0.30517E-02,
     &0.11774E-02/

      data ((uds_grdl(i,j),j= 27, 27),
     &      i=1, 99)/ ! Singlet Q2=  124.203392
     &0.49807E+00, 0.38255E+00, 0.32683E+00, 0.29187E+00, 0.26730E+00,
     &0.24891E+00, 0.23460E+00, 0.22314E+00, 0.21380E+00, 0.20608E+00,
     &0.19964E+00, 0.19421E+00, 0.18960E+00, 0.18568E+00, 0.18231E+00,
     &0.17942E+00, 0.17693E+00, 0.17478E+00, 0.17292E+00, 0.17130E+00,
     &0.16989E+00, 0.16866E+00, 0.16758E+00, 0.16662E+00, 0.16576E+00,
     &0.16498E+00, 0.16428E+00, 0.16362E+00, 0.16300E+00, 0.16241E+00,
     &0.16184E+00, 0.16127E+00, 0.16069E+00, 0.16011E+00, 0.15951E+00,
     &0.15888E+00, 0.15821E+00, 0.15751E+00, 0.15677E+00, 0.15598E+00,
     &0.15514E+00, 0.15424E+00, 0.15327E+00, 0.15225E+00, 0.15116E+00,
     &0.15000E+00, 0.14876E+00, 0.14745E+00, 0.14607E+00, 0.14460E+00,
     &0.14306E+00, 0.14143E+00, 0.13972E+00, 0.13793E+00, 0.13606E+00,
     &0.13410E+00, 0.13205E+00, 0.12992E+00, 0.12770E+00, 0.12540E+00,
     &0.12301E+00, 0.12053E+00, 0.11798E+00, 0.11534E+00, 0.11262E+00,
     &0.10982E+00, 0.10694E+00, 0.10399E+00, 0.10096E+00, 0.97853E-01,
     &0.94681E-01, 0.91441E-01, 0.88137E-01, 0.84773E-01, 0.81351E-01,
     &0.77877E-01, 0.74353E-01, 0.70784E-01, 0.67175E-01, 0.63532E-01,
     &0.59861E-01, 0.56168E-01, 0.52459E-01, 0.48743E-01, 0.45027E-01,
     &0.41320E-01, 0.37633E-01, 0.33976E-01, 0.30361E-01, 0.26802E-01,
     &0.23315E-01, 0.19915E-01, 0.16625E-01, 0.13468E-01, 0.10474E-01,
     &0.76784E-02,
     &0.51314E-02,
     &0.29038E-02,
     &0.11134E-02/

      data ((uds_grdl(i,j),j= 28, 28),
     &      i=1, 99)/ ! Singlet Q2=  145.579071
     &0.51473E+00, 0.39346E+00, 0.33519E+00, 0.29868E+00, 0.27305E+00,
     &0.25387E+00, 0.23895E+00, 0.22700E+00, 0.21724E+00, 0.20917E+00,
     &0.20243E+00, 0.19673E+00, 0.19189E+00, 0.18775E+00, 0.18420E+00,
     &0.18113E+00, 0.17848E+00, 0.17618E+00, 0.17418E+00, 0.17244E+00,
     &0.17090E+00, 0.16956E+00, 0.16836E+00, 0.16730E+00, 0.16634E+00,
     &0.16547E+00, 0.16467E+00, 0.16392E+00, 0.16322E+00, 0.16254E+00,
     &0.16189E+00, 0.16124E+00, 0.16059E+00, 0.15993E+00, 0.15925E+00,
     &0.15855E+00, 0.15782E+00, 0.15705E+00, 0.15624E+00, 0.15538E+00,
     &0.15448E+00, 0.15352E+00, 0.15250E+00, 0.15142E+00, 0.15027E+00,
     &0.14905E+00, 0.14777E+00, 0.14641E+00, 0.14497E+00, 0.14346E+00,
     &0.14187E+00, 0.14020E+00, 0.13845E+00, 0.13662E+00, 0.13471E+00,
     &0.13271E+00, 0.13063E+00, 0.12847E+00, 0.12623E+00, 0.12390E+00,
     &0.12149E+00, 0.11899E+00, 0.11642E+00, 0.11376E+00, 0.11103E+00,
     &0.10822E+00, 0.10534E+00, 0.10238E+00, 0.99347E-01, 0.96247E-01,
     &0.93080E-01, 0.89849E-01, 0.86558E-01, 0.83209E-01, 0.79807E-01,
     &0.76355E-01, 0.72857E-01, 0.69318E-01, 0.65742E-01, 0.62137E-01,
     &0.58506E-01, 0.54858E-01, 0.51197E-01, 0.47534E-01, 0.43874E-01,
     &0.40227E-01, 0.36604E-01, 0.33014E-01, 0.29470E-01, 0.25985E-01,
     &0.22575E-01, 0.19256E-01, 0.16049E-01, 0.12979E-01, 0.10072E-01,
     &0.73654E-02,
     &0.49068E-02,
     &0.27651E-02,
     &0.10539E-02/

      data ((uds_grdl(i,j),j= 29, 29),
     &      i=1, 99)/ ! Singlet Q2=  170.633575
     &0.53127E+00, 0.40422E+00, 0.34338E+00, 0.30534E+00, 0.27865E+00,
     &0.25870E+00, 0.24317E+00, 0.23072E+00, 0.22056E+00, 0.21215E+00,
     &0.20511E+00, 0.19916E+00, 0.19408E+00, 0.18974E+00, 0.18600E+00,
     &0.18276E+00, 0.17996E+00, 0.17751E+00, 0.17537E+00, 0.17350E+00,
     &0.17185E+00, 0.17039E+00, 0.16909E+00, 0.16792E+00, 0.16687E+00,
     &0.16590E+00, 0.16501E+00, 0.16418E+00, 0.16339E+00, 0.16263E+00,
     &0.16190E+00, 0.16117E+00, 0.16045E+00, 0.15972E+00, 0.15897E+00,
     &0.15820E+00, 0.15740E+00, 0.15657E+00, 0.15570E+00, 0.15478E+00,
     &0.15381E+00, 0.15279E+00, 0.15172E+00, 0.15058E+00, 0.14938E+00,
     &0.14811E+00, 0.14677E+00, 0.14537E+00, 0.14388E+00, 0.14233E+00,
     &0.14070E+00, 0.13899E+00, 0.13720E+00, 0.13533E+00, 0.13338E+00,
     &0.13135E+00, 0.12924E+00, 0.12705E+00, 0.12478E+00, 0.12243E+00,
     &0.12000E+00, 0.11748E+00, 0.11489E+00, 0.11223E+00, 0.10948E+00,
     &0.10666E+00, 0.10377E+00, 0.10081E+00, 0.97781E-01, 0.94685E-01,
     &0.91525E-01, 0.88304E-01, 0.85025E-01, 0.81692E-01, 0.78310E-01,
     &0.74881E-01, 0.71409E-01, 0.67900E-01, 0.64358E-01, 0.60789E-01,
     &0.57199E-01, 0.53595E-01, 0.49982E-01, 0.46370E-01, 0.42765E-01,
     &0.39177E-01, 0.35616E-01, 0.32091E-01, 0.28616E-01, 0.25204E-01,
     &0.21869E-01, 0.18628E-01, 0.15502E-01, 0.12514E-01, 0.96911E-02,
     &0.70695E-02,
     &0.46952E-02,
     &0.26351E-02,
     &0.99844E-03/

      data ((uds_grdl(i,j),j= 30, 30),
     &      i=1, 99)/ ! Singlet Q2=  200.
     &0.54768E+00, 0.41482E+00, 0.35143E+00, 0.31185E+00, 0.28412E+00,
     &0.26339E+00, 0.24726E+00, 0.23434E+00, 0.22378E+00, 0.21503E+00,
     &0.20769E+00, 0.20148E+00, 0.19618E+00, 0.19164E+00, 0.18771E+00,
     &0.18431E+00, 0.18135E+00, 0.17877E+00, 0.17650E+00, 0.17450E+00,
     &0.17274E+00, 0.17117E+00, 0.16976E+00, 0.16850E+00, 0.16734E+00,
     &0.16629E+00, 0.16531E+00, 0.16440E+00, 0.16353E+00, 0.16269E+00,
     &0.16188E+00, 0.16108E+00, 0.16028E+00, 0.15948E+00, 0.15867E+00,
     &0.15783E+00, 0.15697E+00, 0.15607E+00, 0.15514E+00, 0.15416E+00,
     &0.15314E+00, 0.15206E+00, 0.15093E+00, 0.14974E+00, 0.14849E+00,
     &0.14717E+00, 0.14579E+00, 0.14433E+00, 0.14281E+00, 0.14121E+00,
     &0.13954E+00, 0.13779E+00, 0.13596E+00, 0.13406E+00, 0.13208E+00,
     &0.13002E+00, 0.12788E+00, 0.12566E+00, 0.12336E+00, 0.12099E+00,
     &0.11854E+00, 0.11601E+00, 0.11340E+00, 0.11072E+00, 0.10797E+00,
     &0.10514E+00, 0.10225E+00, 0.99286E-01, 0.96257E-01, 0.93165E-01,
     &0.90013E-01, 0.86802E-01, 0.83537E-01, 0.80221E-01, 0.76858E-01,
     &0.73453E-01, 0.70007E-01, 0.66528E-01, 0.63019E-01, 0.59488E-01,
     &0.55938E-01, 0.52377E-01, 0.48812E-01, 0.45250E-01, 0.41699E-01,
     &0.38168E-01, 0.34667E-01, 0.31207E-01, 0.27799E-01, 0.24456E-01,
     &0.21194E-01, 0.18029E-01, 0.14980E-01, 0.12072E-01, 0.93300E-02,
     &0.67895E-02,
     &0.44956E-02,
     &0.25130E-02,
     &0.94670E-03/

      data ((g_grdl(i,j),j= 1, 1),
     &      i=1, 99)/ ! Gluon Q2=  2.
     &0.11940E+01, 0.10922E+01, 0.10324E+01, 0.98890E+00, 0.95391E+00,
     &0.92410E+00, 0.89766E+00, 0.87373E+00, 0.85163E+00, 0.83082E+00,
     &0.81105E+00, 0.79212E+00, 0.77402E+00, 0.75650E+00, 0.73945E+00,
     &0.72280E+00, 0.70651E+00, 0.69053E+00, 0.67483E+00, 0.65941E+00,
     &0.64422E+00, 0.62926E+00, 0.61450E+00, 0.59993E+00, 0.58554E+00,
     &0.57132E+00, 0.55726E+00, 0.54334E+00, 0.52958E+00, 0.51596E+00,
     &0.50249E+00, 0.48916E+00, 0.47597E+00, 0.46292E+00, 0.45003E+00,
     &0.43727E+00, 0.42467E+00, 0.41219E+00, 0.39983E+00, 0.38759E+00,
     &0.37547E+00, 0.36353E+00, 0.35176E+00, 0.34015E+00, 0.32872E+00,
     &0.31745E+00, 0.30633E+00, 0.29536E+00, 0.28455E+00, 0.27391E+00,
     &0.26344E+00, 0.25313E+00, 0.24300E+00, 0.23304E+00, 0.22326E+00,
     &0.21366E+00, 0.20424E+00, 0.19501E+00, 0.18596E+00, 0.17710E+00,
     &0.16843E+00, 0.15996E+00, 0.15168E+00, 0.14360E+00, 0.13573E+00,
     &0.12806E+00, 0.12059E+00, 0.11333E+00, 0.10629E+00, 0.99454E-01,
     &0.92834E-01, 0.86427E-01, 0.80245E-01, 0.74280E-01, 0.68539E-01,
     &0.63023E-01, 0.57730E-01, 0.52666E-01, 0.47830E-01, 0.43229E-01,
     &0.38855E-01, 0.34714E-01, 0.30807E-01, 0.27137E-01, 0.23702E-01,
     &0.20505E-01, 0.17543E-01, 0.14812E-01, 0.12324E-01, 0.10073E-01,
     &0.80539E-02, 0.62679E-02, 0.47155E-02, 0.33927E-02, 0.22982E-02,
     &0.14231E-02,
     &0.77142E-03,
     &0.32533E-03,
     &0.78601E-04/

      data ((g_grdl(i,j),j= 2, 2),
     &      i=1, 99)/ ! Gluon Q2=  2.34420466
     &0.13005E+01, 0.11660E+01, 0.10891E+01, 0.10342E+01, 0.99087E+00,
     &0.95455E+00, 0.92284E+00, 0.89451E+00, 0.86864E+00, 0.84459E+00,
     &0.82197E+00, 0.80054E+00, 0.78019E+00, 0.76066E+00, 0.74179E+00,
     &0.72350E+00, 0.70571E+00, 0.68837E+00, 0.67144E+00, 0.65488E+00,
     &0.63866E+00, 0.62275E+00, 0.60713E+00, 0.59176E+00, 0.57665E+00,
     &0.56176E+00, 0.54710E+00, 0.53264E+00, 0.51838E+00, 0.50432E+00,
     &0.49045E+00, 0.47676E+00, 0.46326E+00, 0.44994E+00, 0.43680E+00,
     &0.42384E+00, 0.41107E+00, 0.39844E+00, 0.38598E+00, 0.37366E+00,
     &0.36150E+00, 0.34954E+00, 0.33777E+00, 0.32620E+00, 0.31482E+00,
     &0.30361E+00, 0.29258E+00, 0.28173E+00, 0.27105E+00, 0.26057E+00,
     &0.25026E+00, 0.24014E+00, 0.23021E+00, 0.22046E+00, 0.21091E+00,
     &0.20156E+00, 0.19239E+00, 0.18342E+00, 0.17465E+00, 0.16608E+00,
     &0.15771E+00, 0.14955E+00, 0.14159E+00, 0.13383E+00, 0.12629E+00,
     &0.11895E+00, 0.11183E+00, 0.10492E+00, 0.98221E-01, 0.91738E-01,
     &0.85473E-01, 0.79423E-01, 0.73598E-01, 0.67989E-01, 0.62605E-01,
     &0.57442E-01, 0.52502E-01, 0.47786E-01, 0.43295E-01, 0.39032E-01,
     &0.34991E-01, 0.31177E-01, 0.27590E-01, 0.24230E-01, 0.21096E-01,
     &0.18188E-01, 0.15505E-01, 0.13042E-01, 0.10806E-01, 0.87923E-02,
     &0.69951E-02, 0.54142E-02, 0.40484E-02, 0.28926E-02, 0.19436E-02,
     &0.11924E-02,
     &0.63884E-03,
     &0.26568E-03,
     &0.63196E-04/

      data ((g_grdl(i,j),j= 3, 3),
     &      i=1, 99)/ ! Gluon Q2=  2.74764752
     &0.14044E+01, 0.12369E+01, 0.11428E+01, 0.10767E+01, 0.10252E+01,
     &0.98260E+00, 0.94579E+00, 0.91323E+00, 0.88376E+00, 0.85661E+00,
     &0.83130E+00, 0.80750E+00, 0.78504E+00, 0.76361E+00, 0.74304E+00,
     &0.72322E+00, 0.70405E+00, 0.68546E+00, 0.66739E+00, 0.64979E+00,
     &0.63262E+00, 0.61585E+00, 0.59944E+00, 0.58337E+00, 0.56760E+00,
     &0.55213E+00, 0.53693E+00, 0.52199E+00, 0.50730E+00, 0.49285E+00,
     &0.47864E+00, 0.46465E+00, 0.45089E+00, 0.43734E+00, 0.42401E+00,
     &0.41089E+00, 0.39799E+00, 0.38527E+00, 0.37273E+00, 0.36038E+00,
     &0.34821E+00, 0.33626E+00, 0.32453E+00, 0.31301E+00, 0.30170E+00,
     &0.29058E+00, 0.27967E+00, 0.26894E+00, 0.25842E+00, 0.24809E+00,
     &0.23796E+00, 0.22804E+00, 0.21831E+00, 0.20879E+00, 0.19947E+00,
     &0.19036E+00, 0.18145E+00, 0.17275E+00, 0.16426E+00, 0.15597E+00,
     &0.14790E+00, 0.14003E+00, 0.13237E+00, 0.12493E+00, 0.11770E+00,
     &0.11069E+00, 0.10389E+00, 0.97306E-01, 0.90942E-01, 0.84791E-01,
     &0.78859E-01, 0.73143E-01, 0.67650E-01, 0.62373E-01, 0.57318E-01,
     &0.52482E-01, 0.47866E-01, 0.43470E-01, 0.39293E-01, 0.35340E-01,
     &0.31602E-01, 0.28083E-01, 0.24784E-01, 0.21702E-01, 0.18837E-01,
     &0.16188E-01, 0.13752E-01, 0.11525E-01, 0.95107E-02, 0.77048E-02,
     &0.61007E-02, 0.46972E-02, 0.34916E-02, 0.24782E-02, 0.16523E-02,
     &0.10046E-02,
     &0.53231E-03,
     &0.21846E-03,
     &0.51200E-04/

      data ((g_grdl(i,j),j= 4, 4),
     &      i=1, 99)/ ! Gluon Q2=  3.22052407
     &0.15061E+01, 0.13049E+01, 0.11938E+01, 0.11167E+01, 0.10572E+01,
     &0.10084E+01, 0.96672E+00, 0.93008E+00, 0.89718E+00, 0.86708E+00,
     &0.83921E+00, 0.81317E+00, 0.78871E+00, 0.76551E+00, 0.74335E+00,
     &0.72210E+00, 0.70165E+00, 0.68189E+00, 0.66277E+00, 0.64422E+00,
     &0.62620E+00, 0.60864E+00, 0.59152E+00, 0.57480E+00, 0.55846E+00,
     &0.54246E+00, 0.52679E+00, 0.51143E+00, 0.49637E+00, 0.48159E+00,
     &0.46709E+00, 0.45285E+00, 0.43887E+00, 0.42514E+00, 0.41166E+00,
     &0.39842E+00, 0.38542E+00, 0.37263E+00, 0.36006E+00, 0.34770E+00,
     &0.33555E+00, 0.32364E+00, 0.31196E+00, 0.30052E+00, 0.28930E+00,
     &0.27830E+00, 0.26751E+00, 0.25693E+00, 0.24656E+00, 0.23641E+00,
     &0.22647E+00, 0.21675E+00, 0.20724E+00, 0.19794E+00, 0.18886E+00,
     &0.17999E+00, 0.17134E+00, 0.16290E+00, 0.15468E+00, 0.14667E+00,
     &0.13888E+00, 0.13130E+00, 0.12394E+00, 0.11680E+00, 0.10988E+00,
     &0.10317E+00, 0.96678E-01, 0.90405E-01, 0.84352E-01, 0.78514E-01,
     &0.72895E-01, 0.67491E-01, 0.62308E-01, 0.57341E-01, 0.52591E-01,
     &0.48058E-01, 0.43740E-01, 0.39637E-01, 0.35750E-01, 0.32077E-01,
     &0.28615E-01, 0.25365E-01, 0.22325E-01, 0.19495E-01, 0.16871E-01,
     &0.14453E-01, 0.12237E-01, 0.10219E-01, 0.84002E-02, 0.67765E-02,
     &0.53411E-02, 0.40916E-02, 0.30243E-02, 0.21328E-02, 0.14114E-02,
     &0.85082E-03,
     &0.44605E-03,
     &0.18076E-03,
     &0.41772E-04/

      data ((g_grdl(i,j),j= 5, 5),
     &      i=1, 99)/ ! Gluon Q2=  3.77478361
     &0.16053E+01, 0.13703E+01, 0.12422E+01, 0.11543E+01, 0.10870E+01,
     &0.10323E+01, 0.98580E+00, 0.94525E+00, 0.90905E+00, 0.87614E+00,
     &0.84584E+00, 0.81768E+00, 0.79135E+00, 0.76648E+00, 0.74283E+00,
     &0.72026E+00, 0.69861E+00, 0.67778E+00, 0.65770E+00, 0.63828E+00,
     &0.61946E+00, 0.60119E+00, 0.58343E+00, 0.56614E+00, 0.54927E+00,
     &0.53281E+00, 0.51672E+00, 0.50100E+00, 0.48561E+00, 0.47055E+00,
     &0.45580E+00, 0.44136E+00, 0.42720E+00, 0.41333E+00, 0.39973E+00,
     &0.38641E+00, 0.37335E+00, 0.36053E+00, 0.34794E+00, 0.33560E+00,
     &0.32349E+00, 0.31164E+00, 0.30004E+00, 0.28869E+00, 0.27758E+00,
     &0.26670E+00, 0.25606E+00, 0.24563E+00, 0.23544E+00, 0.22547E+00,
     &0.21573E+00, 0.20621E+00, 0.19691E+00, 0.18784E+00, 0.17899E+00,
     &0.17037E+00, 0.16197E+00, 0.15379E+00, 0.14583E+00, 0.13810E+00,
     &0.13058E+00, 0.12328E+00, 0.11621E+00, 0.10936E+00, 0.10272E+00,
     &0.96307E-01, 0.90110E-01, 0.84132E-01, 0.78374E-01, 0.72831E-01,
     &0.67505E-01, 0.62394E-01, 0.57500E-01, 0.52820E-01, 0.48354E-01,
     &0.44100E-01, 0.40057E-01, 0.36225E-01, 0.32602E-01, 0.29187E-01,
     &0.25976E-01, 0.22969E-01, 0.20164E-01, 0.17560E-01, 0.15154E-01,
     &0.12943E-01, 0.10922E-01, 0.90894E-02, 0.74442E-02, 0.59809E-02,
     &0.46932E-02, 0.35777E-02, 0.26300E-02, 0.18433E-02, 0.12111E-02,
     &0.72410E-03,
     &0.37578E-03,
     &0.15046E-03,
     &0.34307E-04/

      data ((g_grdl(i,j),j= 6, 6),
     &      i=1, 99)/ ! Gluon Q2=  4.42443275
     &0.17022E+01, 0.14331E+01, 0.12882E+01, 0.11896E+01, 0.11147E+01,
     &0.10542E+01, 0.10032E+01, 0.95886E+00, 0.91951E+00, 0.88393E+00,
     &0.85132E+00, 0.82116E+00, 0.79306E+00, 0.76662E+00, 0.74159E+00,
     &0.71778E+00, 0.69502E+00, 0.67321E+00, 0.65223E+00, 0.63201E+00,
     &0.61248E+00, 0.59357E+00, 0.57523E+00, 0.55741E+00, 0.54008E+00,
     &0.52321E+00, 0.50676E+00, 0.49072E+00, 0.47505E+00, 0.45975E+00,
     &0.44480E+00, 0.43019E+00, 0.41589E+00, 0.40191E+00, 0.38823E+00,
     &0.37485E+00, 0.36176E+00, 0.34893E+00, 0.33636E+00, 0.32406E+00,
     &0.31201E+00, 0.30024E+00, 0.28873E+00, 0.27749E+00, 0.26650E+00,
     &0.25576E+00, 0.24527E+00, 0.23501E+00, 0.22499E+00, 0.21521E+00,
     &0.20566E+00, 0.19635E+00, 0.18728E+00, 0.17843E+00, 0.16982E+00,
     &0.16144E+00, 0.15328E+00, 0.14536E+00, 0.13766E+00, 0.13019E+00,
     &0.12294E+00, 0.11591E+00, 0.10911E+00, 0.10253E+00, 0.96174E-01,
     &0.90038E-01, 0.84120E-01, 0.78420E-01, 0.72940E-01, 0.67674E-01,
     &0.62624E-01, 0.57786E-01, 0.53163E-01, 0.48749E-01, 0.44546E-01,
     &0.40552E-01, 0.36763E-01, 0.33179E-01, 0.29798E-01, 0.26619E-01,
     &0.23636E-01, 0.20851E-01, 0.18259E-01, 0.15860E-01, 0.13648E-01,
     &0.11623E-01, 0.97778E-02, 0.81098E-02, 0.66180E-02, 0.52962E-02,
     &0.41382E-02, 0.31398E-02, 0.22959E-02, 0.15996E-02, 0.10438E-02,
     &0.61913E-03,
     &0.31820E-03,
     &0.12596E-03,
     &0.28354E-04/

      data ((g_grdl(i,j),j= 7, 7),
     &      i=1, 99)/ ! Gluon Q2=  5.18588781
     &0.17968E+01, 0.14934E+01, 0.13319E+01, 0.12228E+01, 0.11406E+01,
     &0.10744E+01, 0.10190E+01, 0.97105E+00, 0.92869E+00, 0.89056E+00,
     &0.85578E+00, 0.82372E+00, 0.79395E+00, 0.76605E+00, 0.73972E+00,
     &0.71476E+00, 0.69098E+00, 0.66825E+00, 0.64645E+00, 0.62550E+00,
     &0.60531E+00, 0.58582E+00, 0.56695E+00, 0.54867E+00, 0.53093E+00,
     &0.51370E+00, 0.49693E+00, 0.48061E+00, 0.46471E+00, 0.44921E+00,
     &0.43409E+00, 0.41934E+00, 0.40494E+00, 0.39088E+00, 0.37715E+00,
     &0.36374E+00, 0.35064E+00, 0.33782E+00, 0.32530E+00, 0.31305E+00,
     &0.30108E+00, 0.28940E+00, 0.27800E+00, 0.26688E+00, 0.25602E+00,
     &0.24543E+00, 0.23509E+00, 0.22500E+00, 0.21517E+00, 0.20558E+00,
     &0.19623E+00, 0.18713E+00, 0.17828E+00, 0.16966E+00, 0.16127E+00,
     &0.15313E+00, 0.14522E+00, 0.13754E+00, 0.13009E+00, 0.12287E+00,
     &0.11588E+00, 0.10912E+00, 0.10258E+00, 0.96263E-01, 0.90170E-01,
     &0.84298E-01, 0.78644E-01, 0.73209E-01, 0.67991E-01, 0.62985E-01,
     &0.58193E-01, 0.53611E-01, 0.49240E-01, 0.45075E-01, 0.41117E-01,
     &0.37362E-01, 0.33807E-01, 0.30452E-01, 0.27293E-01, 0.24330E-01,
     &0.21557E-01, 0.18973E-01, 0.16575E-01, 0.14360E-01, 0.12325E-01,
     &0.10466E-01, 0.87779E-02, 0.72570E-02, 0.59014E-02, 0.47049E-02,
     &0.36610E-02, 0.27651E-02, 0.20117E-02, 0.13936E-02, 0.90335E-03,
     &0.53175E-03,
     &0.27076E-03,
     &0.10601E-03,
     &0.23576E-04/

      data ((g_grdl(i,j),j= 8, 8),
     &      i=1, 99)/ ! Gluon Q2=  6.0783906
     &0.18890E+01, 0.15514E+01, 0.13734E+01, 0.12540E+01, 0.11646E+01,
     &0.10930E+01, 0.10333E+01, 0.98194E+00, 0.93671E+00, 0.89616E+00,
     &0.85930E+00, 0.82545E+00, 0.79412E+00, 0.76484E+00, 0.73730E+00,
     &0.71126E+00, 0.68653E+00, 0.66296E+00, 0.64041E+00, 0.61879E+00,
     &0.59801E+00, 0.57798E+00, 0.55865E+00, 0.53995E+00, 0.52185E+00,
     &0.50430E+00, 0.48726E+00, 0.47070E+00, 0.45460E+00, 0.43893E+00,
     &0.42368E+00, 0.40882E+00, 0.39434E+00, 0.38023E+00, 0.36647E+00,
     &0.35305E+00, 0.33997E+00, 0.32719E+00, 0.31471E+00, 0.30254E+00,
     &0.29066E+00, 0.27909E+00, 0.26781E+00, 0.25681E+00, 0.24610E+00,
     &0.23567E+00, 0.22549E+00, 0.21558E+00, 0.20593E+00, 0.19653E+00,
     &0.18739E+00, 0.17850E+00, 0.16986E+00, 0.16146E+00, 0.15331E+00,
     &0.14539E+00, 0.13772E+00, 0.13028E+00, 0.12307E+00, 0.11610E+00,
     &0.10936E+00, 0.10285E+00, 0.96558E-01, 0.90496E-01, 0.84654E-01,
     &0.79034E-01, 0.73631E-01, 0.68445E-01, 0.63474E-01, 0.58714E-01,
     &0.54164E-01, 0.49822E-01, 0.45686E-01, 0.41753E-01, 0.38021E-01,
     &0.34488E-01, 0.31150E-01, 0.28005E-01, 0.25051E-01, 0.22286E-01,
     &0.19704E-01, 0.17303E-01, 0.15081E-01, 0.13034E-01, 0.11158E-01,
     &0.94484E-02, 0.79015E-02, 0.65122E-02, 0.52778E-02, 0.41923E-02,
     &0.32491E-02, 0.24433E-02, 0.17689E-02, 0.12186E-02, 0.78491E-03,
     &0.45866E-03,
     &0.23147E-03,
     &0.89690E-04,
     &0.19715E-04/

      data ((g_grdl(i,j),j= 9, 9),
     &      i=1, 99)/ ! Gluon Q2=  7.12449598
     &0.19789E+01, 0.16070E+01, 0.14128E+01, 0.12834E+01, 0.11869E+01,
     &0.11102E+01, 0.10463E+01, 0.99164E+00, 0.94367E+00, 0.90081E+00,
     &0.86199E+00, 0.82645E+00, 0.79364E+00, 0.76307E+00, 0.73440E+00,
     &0.70736E+00, 0.68175E+00, 0.65740E+00, 0.63416E+00, 0.61193E+00,
     &0.59060E+00, 0.57010E+00, 0.55035E+00, 0.53128E+00, 0.51286E+00,
     &0.49503E+00, 0.47775E+00, 0.46099E+00, 0.44472E+00, 0.42892E+00,
     &0.41356E+00, 0.39863E+00, 0.38410E+00, 0.36996E+00, 0.35619E+00,
     &0.34279E+00, 0.32973E+00, 0.31700E+00, 0.30460E+00, 0.29251E+00,
     &0.28073E+00, 0.26928E+00, 0.25812E+00, 0.24727E+00, 0.23671E+00,
     &0.22643E+00, 0.21643E+00, 0.20669E+00, 0.19723E+00, 0.18803E+00,
     &0.17909E+00, 0.17041E+00, 0.16198E+00, 0.15380E+00, 0.14587E+00,
     &0.13818E+00, 0.13074E+00, 0.12353E+00, 0.11656E+00, 0.10983E+00,
     &0.10333E+00, 0.97052E-01, 0.91005E-01, 0.85182E-01, 0.79581E-01,
     &0.74199E-01, 0.69034E-01, 0.64083E-01, 0.59345E-01, 0.54815E-01,
     &0.50493E-01, 0.46374E-01, 0.42458E-01, 0.38741E-01, 0.35220E-01,
     &0.31892E-01, 0.28755E-01, 0.25805E-01, 0.23039E-01, 0.20455E-01,
     &0.18048E-01, 0.15815E-01, 0.13753E-01, 0.11858E-01, 0.10125E-01,
     &0.85514E-02, 0.71311E-02, 0.58595E-02, 0.47334E-02, 0.37465E-02,
     &0.28924E-02, 0.21658E-02, 0.15606E-02, 0.10694E-02, 0.68460E-03,
     &0.39724E-03,
     &0.19877E-03,
     &0.76256E-04,
     &0.16577E-04/

      data ((g_grdl(i,j),j= 10, 10),
     &      i=1, 99)/ ! Gluon Q2=  8.35063744
     &0.20666E+01, 0.16605E+01, 0.14503E+01, 0.13110E+01, 0.12078E+01,
     &0.11259E+01, 0.10581E+01, 0.10002E+01, 0.94966E+00, 0.90460E+00,
     &0.86392E+00, 0.82678E+00, 0.79258E+00, 0.76081E+00, 0.73108E+00,
     &0.70312E+00, 0.67669E+00, 0.65161E+00, 0.62775E+00, 0.60495E+00,
     &0.58314E+00, 0.56220E+00, 0.54207E+00, 0.52268E+00, 0.50397E+00,
     &0.48590E+00, 0.46842E+00, 0.45149E+00, 0.43509E+00, 0.41918E+00,
     &0.40374E+00, 0.38875E+00, 0.37419E+00, 0.36004E+00, 0.34629E+00,
     &0.33292E+00, 0.31991E+00, 0.30725E+00, 0.29493E+00, 0.28294E+00,
     &0.27127E+00, 0.25994E+00, 0.24892E+00, 0.23822E+00, 0.22781E+00,
     &0.21770E+00, 0.20786E+00, 0.19831E+00, 0.18903E+00, 0.18003E+00,
     &0.17129E+00, 0.16281E+00, 0.15459E+00, 0.14663E+00, 0.13892E+00,
     &0.13145E+00, 0.12423E+00, 0.11725E+00, 0.11051E+00, 0.10401E+00,
     &0.97733E-01, 0.91689E-01, 0.85872E-01, 0.80278E-01, 0.74905E-01,
     &0.69750E-01, 0.64810E-01, 0.60081E-01, 0.55563E-01, 0.51250E-01,
     &0.47141E-01, 0.43232E-01, 0.39522E-01, 0.36005E-01, 0.32680E-01,
     &0.29544E-01, 0.26592E-01, 0.23821E-01, 0.21229E-01, 0.18812E-01,
     &0.16565E-01, 0.14485E-01, 0.12569E-01, 0.10812E-01, 0.92098E-02,
     &0.77581E-02, 0.64518E-02, 0.52858E-02, 0.42565E-02, 0.33575E-02,
     &0.25825E-02, 0.19258E-02, 0.13813E-02, 0.94167E-03, 0.59930E-03,
     &0.34539E-03,
     &0.17143E-03,
     &0.65142E-04,
     &0.14012E-04/

      data ((g_grdl(i,j),j= 11, 11),
     &      i=1, 99)/ ! Gluon Q2=  9.78780174
     &0.21520E+01, 0.17118E+01, 0.14858E+01, 0.13370E+01, 0.12271E+01,
     &0.11404E+01, 0.10688E+01, 0.10079E+01, 0.95476E+00, 0.90762E+00,
     &0.86517E+00, 0.82652E+00, 0.79102E+00, 0.75811E+00, 0.72740E+00,
     &0.69857E+00, 0.67139E+00, 0.64565E+00, 0.62120E+00, 0.59790E+00,
     &0.57564E+00, 0.55432E+00, 0.53385E+00, 0.51417E+00, 0.49521E+00,
     &0.47693E+00, 0.45928E+00, 0.44221E+00, 0.42570E+00, 0.40971E+00,
     &0.39421E+00, 0.37919E+00, 0.36462E+00, 0.35048E+00, 0.33676E+00,
     &0.32343E+00, 0.31049E+00, 0.29791E+00, 0.28568E+00, 0.27380E+00,
     &0.26226E+00, 0.25105E+00, 0.24018E+00, 0.22962E+00, 0.21937E+00,
     &0.20942E+00, 0.19977E+00, 0.19040E+00, 0.18131E+00, 0.17249E+00,
     &0.16395E+00, 0.15568E+00, 0.14767E+00, 0.13991E+00, 0.13241E+00,
     &0.12516E+00, 0.11816E+00, 0.11140E+00, 0.10488E+00, 0.98596E-01,
     &0.92543E-01, 0.86719E-01, 0.81121E-01, 0.75746E-01, 0.70590E-01,
     &0.65650E-01, 0.60923E-01, 0.56405E-01, 0.52094E-01, 0.47985E-01,
     &0.44076E-01, 0.40364E-01, 0.36845E-01, 0.33516E-01, 0.30374E-01,
     &0.27414E-01, 0.24634E-01, 0.22029E-01, 0.19597E-01, 0.17333E-01,
     &0.15233E-01, 0.13294E-01, 0.11511E-01, 0.98795E-02, 0.83957E-02,
     &0.70546E-02, 0.58512E-02, 0.47802E-02, 0.38376E-02, 0.30170E-02,
     &0.23122E-02, 0.17175E-02, 0.12264E-02, 0.83195E-03, 0.52647E-03,
     &0.30145E-03,
     &0.14845E-03,
     &0.55901E-04,
     &0.11903E-04/

      data ((g_grdl(i,j),j= 12, 12),
     &      i=1, 99)/ ! Gluon Q2=  11.4723053
     &0.22353E+01, 0.17612E+01, 0.15197E+01, 0.13614E+01, 0.12451E+01,
     &0.11536E+01, 0.10784E+01, 0.10145E+01, 0.95906E+00, 0.90993E+00,
     &0.86581E+00, 0.82574E+00, 0.78901E+00, 0.75504E+00, 0.72340E+00,
     &0.69377E+00, 0.66589E+00, 0.63954E+00, 0.61456E+00, 0.59080E+00,
     &0.56813E+00, 0.54646E+00, 0.52570E+00, 0.50576E+00, 0.48659E+00,
     &0.46813E+00, 0.45033E+00, 0.43315E+00, 0.41655E+00, 0.40050E+00,
     &0.38497E+00, 0.36994E+00, 0.35538E+00, 0.34126E+00, 0.32758E+00,
     &0.31432E+00, 0.30145E+00, 0.28896E+00, 0.27683E+00, 0.26507E+00,
     &0.25365E+00, 0.24259E+00, 0.23186E+00, 0.22145E+00, 0.21137E+00,
     &0.20159E+00, 0.19210E+00, 0.18292E+00, 0.17401E+00, 0.16539E+00,
     &0.15705E+00, 0.14897E+00, 0.14116E+00, 0.13361E+00, 0.12632E+00,
     &0.11928E+00, 0.11249E+00, 0.10594E+00, 0.99634E-01, 0.93561E-01,
     &0.87720E-01, 0.82107E-01, 0.76719E-01, 0.71552E-01, 0.66602E-01,
     &0.61866E-01, 0.57340E-01, 0.53021E-01, 0.48905E-01, 0.44989E-01,
     &0.41268E-01, 0.37739E-01, 0.34401E-01, 0.31246E-01, 0.28274E-01,
     &0.25479E-01, 0.22858E-01, 0.20407E-01, 0.18123E-01, 0.16000E-01,
     &0.14035E-01, 0.12224E-01, 0.10563E-01, 0.90462E-02, 0.76699E-02,
     &0.64292E-02, 0.53187E-02, 0.43332E-02, 0.34684E-02, 0.27181E-02,
     &0.20758E-02, 0.15360E-02, 0.10922E-02, 0.73734E-03, 0.46405E-03,
     &0.26405E-03,
     &0.12906E-03,
     &0.48180E-04,
     &0.10161E-04/

      data ((g_grdl(i,j),j= 13, 13),
     &      i=1, 99)/ ! Gluon Q2=  13.4467154
     &0.23164E+01, 0.18086E+01, 0.15518E+01, 0.13844E+01, 0.12619E+01,
     &0.11658E+01, 0.10870E+01, 0.10204E+01, 0.96262E+00, 0.91160E+00,
     &0.86589E+00, 0.82448E+00, 0.78659E+00, 0.75163E+00, 0.71913E+00,
     &0.68876E+00, 0.66023E+00, 0.63332E+00, 0.60785E+00, 0.58367E+00,
     &0.56064E+00, 0.53866E+00, 0.51763E+00, 0.49747E+00, 0.47811E+00,
     &0.45950E+00, 0.44158E+00, 0.42431E+00, 0.40765E+00, 0.39156E+00,
     &0.37602E+00, 0.36099E+00, 0.34645E+00, 0.33238E+00, 0.31875E+00,
     &0.30556E+00, 0.29277E+00, 0.28038E+00, 0.26837E+00, 0.25672E+00,
     &0.24544E+00, 0.23452E+00, 0.22394E+00, 0.21369E+00, 0.20377E+00,
     &0.19416E+00, 0.18485E+00, 0.17584E+00, 0.16712E+00, 0.15869E+00,
     &0.15054E+00, 0.14266E+00, 0.13505E+00, 0.12770E+00, 0.12061E+00,
     &0.11378E+00, 0.10719E+00, 0.10084E+00, 0.94739E-01, 0.88870E-01,
     &0.83232E-01, 0.77821E-01, 0.72633E-01, 0.67664E-01, 0.62911E-01,
     &0.58368E-01, 0.54033E-01, 0.49902E-01, 0.45971E-01, 0.42235E-01,
     &0.38691E-01, 0.35335E-01, 0.32164E-01, 0.29173E-01, 0.26359E-01,
     &0.23718E-01, 0.21244E-01, 0.18936E-01, 0.16787E-01, 0.14795E-01,
     &0.12955E-01, 0.11262E-01, 0.97114E-02, 0.82996E-02, 0.70213E-02,
     &0.58717E-02, 0.48453E-02, 0.39371E-02, 0.31423E-02, 0.24549E-02,
     &0.18685E-02, 0.13775E-02, 0.97544E-03, 0.65548E-03, 0.41037E-03,
     &0.23210E-03,
     &0.11263E-03,
     &0.41701E-04,
     &0.87135E-05/

      data ((g_grdl(i,j),j= 14, 14),
     &      i=1, 99)/ ! Gluon Q2=  15.7609253
     &0.23954E+01, 0.18541E+01, 0.15824E+01, 0.14060E+01, 0.12774E+01,
     &0.11769E+01, 0.10948E+01, 0.10254E+01, 0.96550E+00, 0.91269E+00,
     &0.86548E+00, 0.82279E+00, 0.78382E+00, 0.74792E+00, 0.71463E+00,
     &0.68356E+00, 0.65444E+00, 0.62701E+00, 0.60110E+00, 0.57653E+00,
     &0.55318E+00, 0.53092E+00, 0.50965E+00, 0.48930E+00, 0.46979E+00,
     &0.45105E+00, 0.43304E+00, 0.41570E+00, 0.39899E+00, 0.38288E+00,
     &0.36734E+00, 0.35233E+00, 0.33782E+00, 0.32380E+00, 0.31025E+00,
     &0.29713E+00, 0.28444E+00, 0.27216E+00, 0.26026E+00, 0.24875E+00,
     &0.23760E+00, 0.22682E+00, 0.21640E+00, 0.20631E+00, 0.19655E+00,
     &0.18711E+00, 0.17798E+00, 0.16915E+00, 0.16061E+00, 0.15237E+00,
     &0.14440E+00, 0.13672E+00, 0.12930E+00, 0.12215E+00, 0.11525E+00,
     &0.10861E+00, 0.10222E+00, 0.96076E-01, 0.90168E-01, 0.84494E-01,
     &0.79051E-01, 0.73832E-01, 0.68836E-01, 0.64056E-01, 0.59489E-01,
     &0.55131E-01, 0.50977E-01, 0.47023E-01, 0.43265E-01, 0.39700E-01,
     &0.36322E-01, 0.33128E-01, 0.30114E-01, 0.27276E-01, 0.24610E-01,
     &0.22111E-01, 0.19775E-01, 0.17598E-01, 0.15576E-01, 0.13705E-01,
     &0.11978E-01, 0.10393E-01, 0.89453E-02, 0.76293E-02, 0.64404E-02,
     &0.53736E-02, 0.44235E-02, 0.35851E-02, 0.28534E-02, 0.22225E-02,
     &0.16861E-02, 0.12385E-02, 0.87358E-03, 0.58443E-03, 0.36403E-03,
     &0.20471E-03,
     &0.98658E-04,
     &0.36239E-04,
     &0.75059E-05/

      data ((g_grdl(i,j),j= 15, 15),
     &      i=1, 99)/ ! Gluon Q2=  18.4734173
     &0.24725E+01, 0.18979E+01, 0.16114E+01, 0.14264E+01, 0.12919E+01,
     &0.11871E+01, 0.11017E+01, 0.10298E+01, 0.96777E+00, 0.91325E+00,
     &0.86462E+00, 0.82073E+00, 0.78073E+00, 0.74397E+00, 0.70992E+00,
     &0.67822E+00, 0.64854E+00, 0.62064E+00, 0.59433E+00, 0.56941E+00,
     &0.54576E+00, 0.52326E+00, 0.50179E+00, 0.48127E+00, 0.46162E+00,
     &0.44278E+00, 0.42469E+00, 0.40731E+00, 0.39057E+00, 0.37446E+00,
     &0.35893E+00, 0.34395E+00, 0.32950E+00, 0.31554E+00, 0.30206E+00,
     &0.28904E+00, 0.27645E+00, 0.26428E+00, 0.25250E+00, 0.24112E+00,
     &0.23012E+00, 0.21949E+00, 0.20921E+00, 0.19928E+00, 0.18969E+00,
     &0.18042E+00, 0.17146E+00, 0.16281E+00, 0.15445E+00, 0.14639E+00,
     &0.13861E+00, 0.13111E+00, 0.12389E+00, 0.11692E+00, 0.11022E+00,
     &0.10377E+00, 0.97570E-01, 0.91613E-01, 0.85894E-01, 0.80408E-01,
     &0.75151E-01, 0.70117E-01, 0.65303E-01, 0.60703E-01, 0.56314E-01,
     &0.52130E-01, 0.48147E-01, 0.44361E-01, 0.40768E-01, 0.37362E-01,
     &0.34141E-01, 0.31099E-01, 0.28233E-01, 0.25538E-01, 0.23009E-01,
     &0.20643E-01, 0.18435E-01, 0.16381E-01, 0.14475E-01, 0.12715E-01,
     &0.11094E-01, 0.96089E-02, 0.82545E-02, 0.70261E-02, 0.59188E-02,
     &0.49274E-02, 0.40468E-02, 0.32715E-02, 0.25969E-02, 0.20167E-02,
     &0.15252E-02, 0.11165E-02, 0.78446E-03, 0.52255E-03, 0.32390E-03,
     &0.18113E-03,
     &0.86722E-04,
     &0.31615E-04,
     &0.64935E-05/

      data ((g_grdl(i,j),j= 16, 16),
     &      i=1, 99)/ ! Gluon Q2=  21.6527348
     &0.25476E+01, 0.19400E+01, 0.16390E+01, 0.14455E+01, 0.13053E+01,
     &0.11964E+01, 0.11078E+01, 0.10335E+01, 0.96948E+00, 0.91333E+00,
     &0.86335E+00, 0.81832E+00, 0.77737E+00, 0.73979E+00, 0.70504E+00,
     &0.67274E+00, 0.64256E+00, 0.61423E+00, 0.58754E+00, 0.56232E+00,
     &0.53841E+00, 0.51568E+00, 0.49403E+00, 0.47337E+00, 0.45361E+00,
     &0.43469E+00, 0.41655E+00, 0.39913E+00, 0.38239E+00, 0.36628E+00,
     &0.35078E+00, 0.33584E+00, 0.32145E+00, 0.30757E+00, 0.29417E+00,
     &0.28125E+00, 0.26877E+00, 0.25671E+00, 0.24507E+00, 0.23382E+00,
     &0.22296E+00, 0.21248E+00, 0.20236E+00, 0.19259E+00, 0.18316E+00,
     &0.17406E+00, 0.16527E+00, 0.15680E+00, 0.14862E+00, 0.14074E+00,
     &0.13314E+00, 0.12583E+00, 0.11878E+00, 0.11200E+00, 0.10548E+00,
     &0.99220E-01, 0.93203E-01, 0.87429E-01, 0.81892E-01, 0.76586E-01,
     &0.71508E-01, 0.66651E-01, 0.62011E-01, 0.57583E-01, 0.53362E-01,
     &0.49344E-01, 0.45523E-01, 0.41896E-01, 0.38458E-01, 0.35204E-01,
     &0.32130E-01, 0.29231E-01, 0.26503E-01, 0.23941E-01, 0.21542E-01,
     &0.19299E-01, 0.17210E-01, 0.15269E-01, 0.13472E-01, 0.11815E-01,
     &0.10291E-01, 0.88981E-02, 0.76299E-02, 0.64820E-02, 0.54494E-02,
     &0.45269E-02, 0.37093E-02, 0.29915E-02, 0.23683E-02, 0.18341E-02,
     &0.13828E-02, 0.10089E-02, 0.70622E-03, 0.46849E-03, 0.28903E-03,
     &0.16077E-03,
     &0.76487E-04,
     &0.27683E-04,
     &0.56407E-05/

      data ((g_grdl(i,j),j= 17, 17),
     &      i=1, 99)/ ! Gluon Q2=  25.379221
     &0.26208E+01, 0.19805E+01, 0.16653E+01, 0.14635E+01, 0.13177E+01,
     &0.12049E+01, 0.11133E+01, 0.10366E+01, 0.97066E+00, 0.91297E+00,
     &0.86171E+00, 0.81561E+00, 0.77376E+00, 0.73541E+00, 0.70002E+00,
     &0.66716E+00, 0.63651E+00, 0.60778E+00, 0.58076E+00, 0.55525E+00,
     &0.53111E+00, 0.50819E+00, 0.48639E+00, 0.46560E+00, 0.44576E+00,
     &0.42677E+00, 0.40859E+00, 0.39115E+00, 0.37442E+00, 0.35834E+00,
     &0.34287E+00, 0.32799E+00, 0.31367E+00, 0.29987E+00, 0.28657E+00,
     &0.27375E+00, 0.26138E+00, 0.24945E+00, 0.23794E+00, 0.22683E+00,
     &0.21612E+00, 0.20578E+00, 0.19582E+00, 0.18621E+00, 0.17694E+00,
     &0.16801E+00, 0.15939E+00, 0.15109E+00, 0.14309E+00, 0.13538E+00,
     &0.12796E+00, 0.12083E+00, 0.11396E+00, 0.10736E+00, 0.10102E+00,
     &0.94936E-01, 0.89097E-01, 0.83499E-01, 0.78137E-01, 0.73005E-01,
     &0.68098E-01, 0.63410E-01, 0.58936E-01, 0.54672E-01, 0.50612E-01,
     &0.46751E-01, 0.43085E-01, 0.39608E-01, 0.36317E-01, 0.33206E-01,
     &0.30270E-01, 0.27505E-01, 0.24908E-01, 0.22471E-01, 0.20192E-01,
     &0.18066E-01, 0.16088E-01, 0.14253E-01, 0.12556E-01, 0.10994E-01,
     &0.95611E-02, 0.82526E-02, 0.70638E-02, 0.59898E-02, 0.50256E-02,
     &0.41662E-02, 0.34062E-02, 0.27405E-02, 0.21642E-02, 0.16714E-02,
     &0.12564E-02, 0.91367E-03, 0.63730E-03, 0.42108E-03, 0.25861E-03,
     &0.14310E-03,
     &0.67673E-04,
     &0.24325E-04,
     &0.49187E-05/

      data ((g_grdl(i,j),j= 18, 18),
     &      i=1, 99)/ ! Gluon Q2=  29.7470417
     &0.26923E+01, 0.20195E+01, 0.16904E+01, 0.14804E+01, 0.13293E+01,
     &0.12126E+01, 0.11181E+01, 0.10391E+01, 0.97137E+00, 0.91221E+00,
     &0.85973E+00, 0.81263E+00, 0.76992E+00, 0.73085E+00, 0.69486E+00,
     &0.66149E+00, 0.63041E+00, 0.60132E+00, 0.57399E+00, 0.54823E+00,
     &0.52388E+00, 0.50079E+00, 0.47886E+00, 0.45797E+00, 0.43805E+00,
     &0.41902E+00, 0.40082E+00, 0.38338E+00, 0.36666E+00, 0.35062E+00,
     &0.33520E+00, 0.32039E+00, 0.30614E+00, 0.29243E+00, 0.27923E+00,
     &0.26652E+00, 0.25427E+00, 0.24247E+00, 0.23109E+00, 0.22012E+00,
     &0.20956E+00, 0.19938E+00, 0.18957E+00, 0.18012E+00, 0.17101E+00,
     &0.16224E+00, 0.15380E+00, 0.14566E+00, 0.13783E+00, 0.13030E+00,
     &0.12306E+00, 0.11609E+00, 0.10940E+00, 0.10298E+00, 0.96812E-01,
     &0.90899E-01, 0.85232E-01, 0.79804E-01, 0.74610E-01, 0.69645E-01,
     &0.64902E-01, 0.60375E-01, 0.56061E-01, 0.51953E-01, 0.48046E-01,
     &0.44335E-01, 0.40815E-01, 0.37481E-01, 0.34329E-01, 0.31353E-01,
     &0.28548E-01, 0.25910E-01, 0.23434E-01, 0.21116E-01, 0.18950E-01,
     &0.16932E-01, 0.15057E-01, 0.13321E-01, 0.11718E-01, 0.10245E-01,
     &0.88950E-02, 0.76649E-02, 0.65494E-02, 0.55435E-02, 0.46422E-02,
     &0.38405E-02, 0.31332E-02, 0.25151E-02, 0.19813E-02, 0.15261E-02,
     &0.11439E-02, 0.82923E-03, 0.57640E-03, 0.37937E-03, 0.23197E-03,
     &0.12773E-03,
     &0.60054E-04,
     &0.21445E-04,
     &0.43048E-05/

      data ((g_grdl(i,j),j= 19, 19),
     &      i=1, 99)/ ! Gluon Q2=  34.8665771
     &0.27620E+01, 0.20571E+01, 0.17142E+01, 0.14964E+01, 0.13400E+01,
     &0.12195E+01, 0.11223E+01, 0.10411E+01, 0.97165E+00, 0.91108E+00,
     &0.85745E+00, 0.80939E+00, 0.76589E+00, 0.72615E+00, 0.68959E+00,
     &0.65575E+00, 0.62427E+00, 0.59485E+00, 0.56725E+00, 0.54126E+00,
     &0.51672E+00, 0.49349E+00, 0.47145E+00, 0.45048E+00, 0.43051E+00,
     &0.41145E+00, 0.39323E+00, 0.37581E+00, 0.35912E+00, 0.34312E+00,
     &0.32776E+00, 0.31302E+00, 0.29886E+00, 0.28524E+00, 0.27215E+00,
     &0.25955E+00, 0.24743E+00, 0.23575E+00, 0.22451E+00, 0.21369E+00,
     &0.20327E+00, 0.19324E+00, 0.18359E+00, 0.17430E+00, 0.16536E+00,
     &0.15675E+00, 0.14847E+00, 0.14050E+00, 0.13284E+00, 0.12548E+00,
     &0.11841E+00, 0.11161E+00, 0.10509E+00, 0.98835E-01, 0.92837E-01,
     &0.87091E-01, 0.81589E-01, 0.76325E-01, 0.71294E-01, 0.66488E-01,
     &0.61903E-01, 0.57531E-01, 0.53369E-01, 0.49410E-01, 0.45649E-01,
     &0.42081E-01, 0.38700E-01, 0.35502E-01, 0.32481E-01, 0.29632E-01,
     &0.26951E-01, 0.24432E-01, 0.22072E-01, 0.19864E-01, 0.17804E-01,
     &0.15888E-01, 0.14109E-01, 0.12465E-01, 0.10950E-01, 0.95586E-02,
     &0.82866E-02, 0.71291E-02, 0.60812E-02, 0.51381E-02, 0.42947E-02,
     &0.35460E-02, 0.28869E-02, 0.23122E-02, 0.18171E-02, 0.13960E-02,
     &0.10435E-02, 0.75415E-03, 0.52246E-03, 0.34258E-03, 0.20860E-03,
     &0.11432E-03,
     &0.53448E-04,
     &0.18966E-04,
     &0.37809E-05/

      data ((g_grdl(i,j),j= 20, 20),
     &      i=1, 99)/ ! Gluon Q2=  40.8671951
     &0.28301E+01, 0.20933E+01, 0.17370E+01, 0.15114E+01, 0.13499E+01,
     &0.12258E+01, 0.11259E+01, 0.10426E+01, 0.97152E+00, 0.90962E+00,
     &0.85490E+00, 0.80594E+00, 0.76168E+00, 0.72132E+00, 0.68423E+00,
     &0.64996E+00, 0.61811E+00, 0.58839E+00, 0.56053E+00, 0.53435E+00,
     &0.50965E+00, 0.48629E+00, 0.46415E+00, 0.44312E+00, 0.42311E+00,
     &0.40404E+00, 0.38583E+00, 0.36843E+00, 0.35177E+00, 0.33583E+00,
     &0.32054E+00, 0.30588E+00, 0.29181E+00, 0.27830E+00, 0.26532E+00,
     &0.25284E+00, 0.24084E+00, 0.22930E+00, 0.21819E+00, 0.20752E+00,
     &0.19724E+00, 0.18737E+00, 0.17787E+00, 0.16874E+00, 0.15995E+00,
     &0.15151E+00, 0.14339E+00, 0.13559E+00, 0.12810E+00, 0.12090E+00,
     &0.11399E+00, 0.10736E+00, 0.10101E+00, 0.94915E-01, 0.89080E-01,
     &0.83496E-01, 0.78154E-01, 0.73048E-01, 0.68173E-01, 0.63521E-01,
     &0.59086E-01, 0.54864E-01, 0.50847E-01, 0.47030E-01, 0.43408E-01,
     &0.39976E-01, 0.36727E-01, 0.33657E-01, 0.30761E-01, 0.28033E-01,
     &0.25469E-01, 0.23063E-01, 0.20810E-01, 0.18706E-01, 0.16746E-01,
     &0.14925E-01, 0.13237E-01, 0.11679E-01, 0.10245E-01, 0.89300E-02,
     &0.77300E-02, 0.66398E-02, 0.56545E-02, 0.47693E-02, 0.39792E-02,
     &0.32792E-02, 0.26642E-02, 0.21293E-02, 0.16695E-02, 0.12794E-02,
     &0.95373E-03, 0.68725E-03, 0.47457E-03, 0.31006E-03, 0.18803E-03,
     &0.10257E-03,
     &0.47703E-04,
     &0.16827E-04,
     &0.33322E-05/

      data ((g_grdl(i,j),j= 21, 21),
     &      i=1, 99)/ ! Gluon Q2=  47.9005318
     &0.28965E+01, 0.21282E+01, 0.17586E+01, 0.15255E+01, 0.13591E+01,
     &0.12315E+01, 0.11290E+01, 0.10437E+01, 0.97102E+00, 0.90785E+00,
     &0.85210E+00, 0.80228E+00, 0.75732E+00, 0.71637E+00, 0.67880E+00,
     &0.64412E+00, 0.61194E+00, 0.58194E+00, 0.55387E+00, 0.52750E+00,
     &0.50266E+00, 0.47920E+00, 0.45699E+00, 0.43591E+00, 0.41587E+00,
     &0.39679E+00, 0.37860E+00, 0.36123E+00, 0.34463E+00, 0.32875E+00,
     &0.31354E+00, 0.29897E+00, 0.28499E+00, 0.27159E+00, 0.25872E+00,
     &0.24636E+00, 0.23449E+00, 0.22308E+00, 0.21212E+00, 0.20159E+00,
     &0.19146E+00, 0.18174E+00, 0.17240E+00, 0.16342E+00, 0.15480E+00,
     &0.14651E+00, 0.13855E+00, 0.13091E+00, 0.12358E+00, 0.11655E+00,
     &0.10980E+00, 0.10333E+00, 0.97137E-01, 0.91204E-01, 0.85528E-01,
     &0.80099E-01, 0.74912E-01, 0.69959E-01, 0.65233E-01, 0.60729E-01,
     &0.56439E-01, 0.52359E-01, 0.48481E-01, 0.44800E-01, 0.41311E-01,
     &0.38008E-01, 0.34885E-01, 0.31937E-01, 0.29159E-01, 0.26545E-01,
     &0.24091E-01, 0.21791E-01, 0.19641E-01, 0.17634E-01, 0.15768E-01,
     &0.14035E-01, 0.12433E-01, 0.10954E-01, 0.95963E-02, 0.83531E-02,
     &0.72200E-02, 0.61922E-02, 0.52649E-02, 0.44333E-02, 0.36923E-02,
     &0.30371E-02, 0.24626E-02, 0.19641E-02, 0.15365E-02, 0.11746E-02,
     &0.87332E-03, 0.62752E-03, 0.43196E-03, 0.28124E-03, 0.16989E-03,
     &0.92270E-04,
     &0.42693E-04,
     &0.14973E-04,
     &0.29466E-05/

      data ((g_grdl(i,j),j= 22, 22),
     &      i=1, 99)/ ! Gluon Q2=  56.1443253
     &0.29613E+01, 0.21618E+01, 0.17792E+01, 0.15387E+01, 0.13676E+01,
     &0.12366E+01, 0.11316E+01, 0.10444E+01, 0.97019E+00, 0.90580E+00,
     &0.84907E+00, 0.79845E+00, 0.75283E+00, 0.71133E+00, 0.67331E+00,
     &0.63826E+00, 0.60577E+00, 0.57552E+00, 0.54725E+00, 0.52072E+00,
     &0.49577E+00, 0.47222E+00, 0.44994E+00, 0.42883E+00, 0.40879E+00,
     &0.38972E+00, 0.37155E+00, 0.35423E+00, 0.33768E+00, 0.32187E+00,
     &0.30675E+00, 0.29227E+00, 0.27840E+00, 0.26510E+00, 0.25235E+00,
     &0.24012E+00, 0.22838E+00, 0.21711E+00, 0.20629E+00, 0.19590E+00,
     &0.18592E+00, 0.17635E+00, 0.16716E+00, 0.15833E+00, 0.14987E+00,
     &0.14174E+00, 0.13394E+00, 0.12646E+00, 0.11928E+00, 0.11241E+00,
     &0.10582E+00, 0.99507E-01, 0.93467E-01, 0.87689E-01, 0.82165E-01,
     &0.76888E-01, 0.71850E-01, 0.67043E-01, 0.62462E-01, 0.58099E-01,
     &0.53949E-01, 0.50004E-01, 0.46260E-01, 0.42709E-01, 0.39346E-01,
     &0.36166E-01, 0.33163E-01, 0.30331E-01, 0.27665E-01, 0.25159E-01,
     &0.22809E-01, 0.20610E-01, 0.18555E-01, 0.16641E-01, 0.14862E-01,
     &0.13213E-01, 0.11690E-01, 0.10287E-01, 0.89996E-02, 0.78229E-02,
     &0.67520E-02, 0.57822E-02, 0.49087E-02, 0.41265E-02, 0.34309E-02,
     &0.28170E-02, 0.22798E-02, 0.18145E-02, 0.14164E-02, 0.10803E-02,
     &0.80114E-03, 0.57406E-03, 0.39397E-03, 0.25564E-03, 0.15385E-03,
     &0.83204E-04,
     &0.38311E-04,
     &0.13363E-04,
     &0.26140E-05/

      data ((g_grdl(i,j),j= 23, 23),
     &      i=1, 99)/ ! Gluon Q2=  65.8068924
     &0.30246E+01, 0.21941E+01, 0.17988E+01, 0.15512E+01, 0.13754E+01,
     &0.12412E+01, 0.11337E+01, 0.10447E+01, 0.96904E+00, 0.90350E+00,
     &0.84584E+00, 0.79447E+00, 0.74822E+00, 0.70621E+00, 0.66777E+00,
     &0.63237E+00, 0.59961E+00, 0.56914E+00, 0.54068E+00, 0.51402E+00,
     &0.48896E+00, 0.46534E+00, 0.44303E+00, 0.42190E+00, 0.40185E+00,
     &0.38280E+00, 0.36468E+00, 0.34740E+00, 0.33093E+00, 0.31519E+00,
     &0.30016E+00, 0.28577E+00, 0.27201E+00, 0.25883E+00, 0.24620E+00,
     &0.23409E+00, 0.22249E+00, 0.21135E+00, 0.20067E+00, 0.19043E+00,
     &0.18060E+00, 0.17118E+00, 0.16214E+00, 0.15347E+00, 0.14515E+00,
     &0.13718E+00, 0.12954E+00, 0.12221E+00, 0.11519E+00, 0.10847E+00,
     &0.10203E+00, 0.95874E-01, 0.89986E-01, 0.84357E-01, 0.78981E-01,
     &0.73850E-01, 0.68955E-01, 0.64290E-01, 0.59848E-01, 0.55621E-01,
     &0.51604E-01, 0.47790E-01, 0.44173E-01, 0.40746E-01, 0.37504E-01,
     &0.34441E-01, 0.31551E-01, 0.28829E-01, 0.26270E-01, 0.23867E-01,
     &0.21615E-01, 0.19510E-01, 0.17547E-01, 0.15719E-01, 0.14023E-01,
     &0.12453E-01, 0.11004E-01, 0.96709E-02, 0.84496E-02, 0.73350E-02,
     &0.63221E-02, 0.54062E-02, 0.45825E-02, 0.38462E-02, 0.31925E-02,
     &0.26166E-02, 0.21136E-02, 0.16789E-02, 0.13078E-02, 0.99517E-03,
     &0.73622E-03, 0.52614E-03, 0.36002E-03, 0.23286E-03, 0.13963E-03,
     &0.75209E-04,
     &0.34468E-04,
     &0.11961E-04,
     &0.23263E-05/

      data ((g_grdl(i,j),j= 24, 24),
     &      i=1, 99)/ ! Gluon Q2=  77.1324081
     &0.30863E+01, 0.22252E+01, 0.18175E+01, 0.15629E+01, 0.13825E+01,
     &0.12452E+01, 0.11354E+01, 0.10446E+01, 0.96760E+00, 0.90097E+00,
     &0.84243E+00, 0.79034E+00, 0.74351E+00, 0.70103E+00, 0.66220E+00,
     &0.62649E+00, 0.59347E+00, 0.56279E+00, 0.53418E+00, 0.50741E+00,
     &0.48226E+00, 0.45859E+00, 0.43624E+00, 0.41510E+00, 0.39507E+00,
     &0.37605E+00, 0.35797E+00, 0.34076E+00, 0.32435E+00, 0.30870E+00,
     &0.29376E+00, 0.27948E+00, 0.26583E+00, 0.25276E+00, 0.24026E+00,
     &0.22828E+00, 0.21681E+00, 0.20581E+00, 0.19527E+00, 0.18517E+00,
     &0.17549E+00, 0.16622E+00, 0.15733E+00, 0.14881E+00, 0.14065E+00,
     &0.13282E+00, 0.12533E+00, 0.11816E+00, 0.11129E+00, 0.10472E+00,
     &0.98431E-01, 0.92422E-01, 0.86680E-01, 0.81197E-01, 0.75964E-01,
     &0.70973E-01, 0.66217E-01, 0.61688E-01, 0.57379E-01, 0.53284E-01,
     &0.49395E-01, 0.45705E-01, 0.42210E-01, 0.38902E-01, 0.35775E-01,
     &0.32824E-01, 0.30042E-01, 0.27425E-01, 0.24966E-01, 0.22660E-01,
     &0.20502E-01, 0.18486E-01, 0.16608E-01, 0.14863E-01, 0.13244E-01,
     &0.11748E-01, 0.10368E-01, 0.91015E-02, 0.79421E-02, 0.68854E-02,
     &0.59265E-02, 0.50607E-02, 0.42833E-02, 0.35895E-02, 0.29746E-02,
     &0.24338E-02, 0.19625E-02, 0.15558E-02, 0.12094E-02, 0.91828E-03,
     &0.67772E-03, 0.48308E-03, 0.32962E-03, 0.21253E-03, 0.12700E-03,
     &0.68140E-04,
     &0.31089E-04,
     &0.10735E-04,
     &0.20766E-05/

      data ((g_grdl(i,j),j= 25, 25),
     &      i=1, 99)/ ! Gluon Q2=  90.407074
     &0.31465E+01, 0.22553E+01, 0.18353E+01, 0.15738E+01, 0.13891E+01,
     &0.12487E+01, 0.11367E+01, 0.10442E+01, 0.96589E+00, 0.89823E+00,
     &0.83885E+00, 0.78609E+00, 0.73872E+00, 0.69579E+00, 0.65660E+00,
     &0.62060E+00, 0.58735E+00, 0.55650E+00, 0.52775E+00, 0.50087E+00,
     &0.47566E+00, 0.45194E+00, 0.42958E+00, 0.40844E+00, 0.38843E+00,
     &0.36946E+00, 0.35143E+00, 0.33428E+00, 0.31796E+00, 0.30240E+00,
     &0.28756E+00, 0.27338E+00, 0.25984E+00, 0.24690E+00, 0.23452E+00,
     &0.22267E+00, 0.21133E+00, 0.20047E+00, 0.19008E+00, 0.18012E+00,
     &0.17059E+00, 0.16146E+00, 0.15271E+00, 0.14435E+00, 0.13633E+00,
     &0.12866E+00, 0.12132E+00, 0.11429E+00, 0.10757E+00, 0.10114E+00,
     &0.95004E-01, 0.89139E-01, 0.83539E-01, 0.78196E-01, 0.73102E-01,
     &0.68247E-01, 0.63625E-01, 0.59227E-01, 0.55047E-01, 0.51077E-01,
     &0.47311E-01, 0.43741E-01, 0.40362E-01, 0.37167E-01, 0.34151E-01,
     &0.31306E-01, 0.28627E-01, 0.26109E-01, 0.23746E-01, 0.21532E-01,
     &0.19463E-01, 0.17532E-01, 0.15735E-01, 0.14066E-01, 0.12520E-01,
     &0.11093E-01, 0.97797E-02, 0.85746E-02, 0.74732E-02, 0.64706E-02,
     &0.55621E-02, 0.47430E-02, 0.40086E-02, 0.33542E-02, 0.27752E-02,
     &0.22669E-02, 0.18246E-02, 0.14439E-02, 0.11201E-02, 0.84868E-03,
     &0.62491E-03, 0.44433E-03, 0.30235E-03, 0.19436E-03, 0.11575E-03,
     &0.61874E-04,
     &0.28110E-04,
     &0.96610E-05,
     &0.18592E-05/

      data ((g_grdl(i,j),j= 26, 26),
     &      i=1, 99)/ ! Gluon Q2=  105.966339
     &0.32053E+01, 0.22842E+01, 0.18522E+01, 0.15841E+01, 0.13951E+01,
     &0.12518E+01, 0.11376E+01, 0.10435E+01, 0.96394E+00, 0.89529E+00,
     &0.83513E+00, 0.78173E+00, 0.73385E+00, 0.69051E+00, 0.65099E+00,
     &0.61473E+00, 0.58127E+00, 0.55026E+00, 0.52139E+00, 0.49443E+00,
     &0.46916E+00, 0.44541E+00, 0.42304E+00, 0.40192E+00, 0.38195E+00,
     &0.36302E+00, 0.34505E+00, 0.32798E+00, 0.31174E+00, 0.29628E+00,
     &0.28153E+00, 0.26747E+00, 0.25405E+00, 0.24122E+00, 0.22897E+00,
     &0.21726E+00, 0.20605E+00, 0.19533E+00, 0.18507E+00, 0.17526E+00,
     &0.16587E+00, 0.15689E+00, 0.14829E+00, 0.14007E+00, 0.13220E+00,
     &0.12468E+00, 0.11748E+00, 0.11060E+00, 0.10402E+00, 0.97739E-01,
     &0.91740E-01, 0.86015E-01, 0.80553E-01, 0.75346E-01, 0.70386E-01,
     &0.65663E-01, 0.61169E-01, 0.56898E-01, 0.52842E-01, 0.48993E-01,
     &0.45344E-01, 0.41889E-01, 0.38622E-01, 0.35535E-01, 0.32623E-01,
     &0.29880E-01, 0.27300E-01, 0.24876E-01, 0.22604E-01, 0.20478E-01,
     &0.18492E-01, 0.16641E-01, 0.14920E-01, 0.13324E-01, 0.11848E-01,
     &0.10486E-01, 0.92337E-02, 0.80865E-02, 0.70393E-02, 0.60874E-02,
     &0.52259E-02, 0.44504E-02, 0.37560E-02, 0.31383E-02, 0.25925E-02,
     &0.21142E-02, 0.16989E-02, 0.13419E-02, 0.10390E-02, 0.78557E-03,
     &0.57716E-03, 0.40938E-03, 0.27784E-03, 0.17809E-03, 0.10572E-03,
     &0.56309E-04,
     &0.25478E-04,
     &0.87173E-05,
     &0.16694E-05/

      data ((g_grdl(i,j),j= 27, 27),
     &      i=1, 99)/ ! Gluon Q2=  124.203392
     &0.32627E+01, 0.23120E+01, 0.18682E+01, 0.15937E+01, 0.14006E+01,
     &0.12544E+01, 0.11382E+01, 0.10426E+01, 0.96177E+00, 0.89218E+00,
     &0.83127E+00, 0.77728E+00, 0.72892E+00, 0.68520E+00, 0.64537E+00,
     &0.60887E+00, 0.57523E+00, 0.54407E+00, 0.51510E+00, 0.48807E+00,
     &0.46276E+00, 0.43900E+00, 0.41664E+00, 0.39554E+00, 0.37560E+00,
     &0.35673E+00, 0.33883E+00, 0.32184E+00, 0.30569E+00, 0.29032E+00,
     &0.27569E+00, 0.26174E+00, 0.24843E+00, 0.23573E+00, 0.22361E+00,
     &0.21203E+00, 0.20096E+00, 0.19038E+00, 0.18026E+00, 0.17059E+00,
     &0.16134E+00, 0.15250E+00, 0.14405E+00, 0.13597E+00, 0.12825E+00,
     &0.12086E+00, 0.11381E+00, 0.10707E+00, 0.10063E+00, 0.94492E-01,
     &0.88630E-01, 0.83041E-01, 0.77713E-01, 0.72638E-01, 0.67806E-01,
     &0.63210E-01, 0.58842E-01, 0.54692E-01, 0.50755E-01, 0.47022E-01,
     &0.43486E-01, 0.40142E-01, 0.36981E-01, 0.33998E-01, 0.31186E-01,
     &0.28540E-01, 0.26053E-01, 0.23719E-01, 0.21534E-01, 0.19490E-01,
     &0.17584E-01, 0.15809E-01, 0.14160E-01, 0.12633E-01, 0.11221E-01,
     &0.99208E-02, 0.87266E-02, 0.76338E-02, 0.66375E-02, 0.57329E-02,
     &0.49154E-02, 0.41805E-02, 0.35234E-02, 0.29397E-02, 0.24249E-02,
     &0.19744E-02, 0.15838E-02, 0.12489E-02, 0.96514E-03, 0.72827E-03,
     &0.53390E-03, 0.37781E-03, 0.25576E-03, 0.16348E-03, 0.96747E-04,
     &0.51354E-04,
     &0.23146E-04,
     &0.78859E-05,
     &0.15032E-05/

      data ((g_grdl(i,j),j= 28, 28),
     &      i=1, 99)/ ! Gluon Q2=  145.579071
     &0.33187E+01, 0.23388E+01, 0.18835E+01, 0.16027E+01, 0.14056E+01,
     &0.12567E+01, 0.11385E+01, 0.10413E+01, 0.95939E+00, 0.88891E+00,
     &0.82730E+00, 0.77275E+00, 0.72394E+00, 0.67986E+00, 0.63976E+00,
     &0.60304E+00, 0.56923E+00, 0.53795E+00, 0.50889E+00, 0.48180E+00,
     &0.45647E+00, 0.43270E+00, 0.41035E+00, 0.38929E+00, 0.36940E+00,
     &0.35059E+00, 0.33277E+00, 0.31586E+00, 0.29981E+00, 0.28454E+00,
     &0.27002E+00, 0.25618E+00, 0.24300E+00, 0.23042E+00, 0.21843E+00,
     &0.20698E+00, 0.19604E+00, 0.18560E+00, 0.17562E+00, 0.16609E+00,
     &0.15698E+00, 0.14828E+00, 0.13998E+00, 0.13204E+00, 0.12446E+00,
     &0.11721E+00, 0.11030E+00, 0.10370E+00, 0.97400E-01, 0.91392E-01,
     &0.85665E-01, 0.80207E-01, 0.75009E-01, 0.70062E-01, 0.65356E-01,
     &0.60882E-01, 0.56634E-01, 0.52602E-01, 0.48779E-01, 0.45157E-01,
     &0.41730E-01, 0.38491E-01, 0.35433E-01, 0.32549E-01, 0.29833E-01,
     &0.27279E-01, 0.24881E-01, 0.22633E-01, 0.20529E-01, 0.18565E-01,
     &0.16734E-01, 0.15030E-01, 0.13450E-01, 0.11987E-01, 0.10637E-01,
     &0.93949E-02, 0.82552E-02, 0.72134E-02, 0.62648E-02, 0.54047E-02,
     &0.46283E-02, 0.39312E-02, 0.33090E-02, 0.27570E-02, 0.22708E-02,
     &0.18461E-02, 0.14785E-02, 0.11638E-02, 0.89780E-03, 0.67613E-03,
     &0.49464E-03, 0.34925E-03, 0.23584E-03, 0.15034E-03, 0.88709E-04,
     &0.46934E-04,
     &0.21075E-04,
     &0.71515E-05,
     &0.13573E-05/

      data ((g_grdl(i,j),j= 29, 29),
     &      i=1, 99)/ ! Gluon Q2=  170.633575
     &0.33733E+01, 0.23647E+01, 0.18981E+01, 0.16110E+01, 0.14101E+01,
     &0.12585E+01, 0.11384E+01, 0.10398E+01, 0.95683E+00, 0.88549E+00,
     &0.82322E+00, 0.76815E+00, 0.71892E+00, 0.67451E+00, 0.63415E+00,
     &0.59723E+00, 0.56328E+00, 0.53189E+00, 0.50276E+00, 0.47563E+00,
     &0.45028E+00, 0.42652E+00, 0.40419E+00, 0.38317E+00, 0.36334E+00,
     &0.34460E+00, 0.32686E+00, 0.31004E+00, 0.29408E+00, 0.27892E+00,
     &0.26451E+00, 0.25079E+00, 0.23773E+00, 0.22528E+00, 0.21341E+00,
     &0.20210E+00, 0.19130E+00, 0.18099E+00, 0.17115E+00, 0.16176E+00,
     &0.15279E+00, 0.14423E+00, 0.13606E+00, 0.12826E+00, 0.12082E+00,
     &0.11372E+00, 0.10694E+00, 0.10047E+00, 0.94309E-01, 0.88433E-01,
     &0.82836E-01, 0.77506E-01, 0.72434E-01, 0.67610E-01, 0.63025E-01,
     &0.58671E-01, 0.54538E-01, 0.50619E-01, 0.46906E-01, 0.43392E-01,
     &0.40069E-01, 0.36931E-01, 0.33970E-01, 0.31181E-01, 0.28557E-01,
     &0.26091E-01, 0.23778E-01, 0.21612E-01, 0.19587E-01, 0.17697E-01,
     &0.15937E-01, 0.14302E-01, 0.12786E-01, 0.11385E-01, 0.10093E-01,
     &0.89049E-02, 0.78164E-02, 0.68227E-02, 0.59189E-02, 0.51003E-02,
     &0.43625E-02, 0.37009E-02, 0.31110E-02, 0.25885E-02, 0.21290E-02,
     &0.17283E-02, 0.13820E-02, 0.10860E-02, 0.83631E-03, 0.62864E-03,
     &0.45897E-03, 0.32335E-03, 0.21784E-03, 0.13851E-03, 0.81493E-04,
     &0.42981E-04,
     &0.19232E-04,
     &0.65013E-05,
     &0.12287E-05/

      data ((g_grdl(i,j),j= 30, 30),
     &      i=1, 99)/ ! Gluon Q2=  200.
     &0.34267E+01, 0.23896E+01, 0.19119E+01, 0.16189E+01, 0.14142E+01,
     &0.12600E+01, 0.11381E+01, 0.10381E+01, 0.95409E+00, 0.88195E+00,
     &0.81905E+00, 0.76348E+00, 0.71387E+00, 0.66916E+00, 0.62856E+00,
     &0.59146E+00, 0.55738E+00, 0.52590E+00, 0.49671E+00, 0.46955E+00,
     &0.44419E+00, 0.42045E+00, 0.39816E+00, 0.37719E+00, 0.35742E+00,
     &0.33875E+00, 0.32109E+00, 0.30437E+00, 0.28851E+00, 0.27346E+00,
     &0.25916E+00, 0.24556E+00, 0.23262E+00, 0.22030E+00, 0.20857E+00,
     &0.19738E+00, 0.18672E+00, 0.17654E+00, 0.16684E+00, 0.15759E+00,
     &0.14876E+00, 0.14034E+00, 0.13231E+00, 0.12464E+00, 0.11734E+00,
     &0.11037E+00, 0.10372E+00, 0.97388E-01, 0.91353E-01, 0.85606E-01,
     &0.80136E-01, 0.74930E-01, 0.69980E-01, 0.65276E-01, 0.60808E-01,
     &0.56568E-01, 0.52547E-01, 0.48737E-01, 0.45130E-01, 0.41719E-01,
     &0.38496E-01, 0.35455E-01, 0.32589E-01, 0.29890E-01, 0.27353E-01,
     &0.24972E-01, 0.22740E-01, 0.20651E-01, 0.18701E-01, 0.16882E-01,
     &0.15190E-01, 0.13619E-01, 0.12165E-01, 0.10821E-01, 0.95841E-02,
     &0.84477E-02, 0.74076E-02, 0.64591E-02, 0.55973E-02, 0.48179E-02,
     &0.41161E-02, 0.34876E-02, 0.29280E-02, 0.24331E-02, 0.19984E-02,
     &0.16199E-02, 0.12934E-02, 0.10148E-02, 0.78008E-03, 0.58530E-03,
     &0.42649E-03, 0.29984E-03, 0.20154E-03, 0.12782E-03, 0.75002E-04,
     &0.39439E-04,
     &0.17588E-04,
     &0.59240E-05,
     &0.11152E-05/

      data ((c_grdl(i,j),j= 1, 1),
     &      i=1, 99)/ ! Charm Q2=  2.
     &0.32840E-02, 0.17630E-02, 0.10781E-02, 0.68520E-03, 0.44009E-03,
     &0.28156E-03, 0.17770E-03, 0.10968E-03, 0.65604E-04, 0.37629E-04,
     &0.20413E-04, 0.10277E-04, 0.46655E-05, 0.18247E-05, 0.56466E-06,
     &0.11596E-06, 0.94619E-08, 0.13242E-10, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 2, 2),
     &      i=1, 99)/ ! Charm Q2=  2.34420466
     &0.41694E-02, 0.23114E-02, 0.14713E-02, 0.97845E-03, 0.66118E-03,
     &0.44803E-03, 0.30197E-03, 0.20117E-03, 0.13168E-03, 0.84175E-04,
     &0.52180E-04, 0.31098E-04, 0.17622E-04, 0.93472E-05, 0.45331E-05,
     &0.19410E-05, 0.68943E-06, 0.18028E-06, 0.25941E-07, 0.70609E-09,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 3, 3),
     &      i=1, 99)/ ! Charm Q2=  2.74764752
     &0.52455E-02, 0.29841E-02, 0.19633E-02, 0.13546E-02, 0.95337E-03,
     &0.67592E-03, 0.47919E-03, 0.33794E-03, 0.23609E-03, 0.16272E-03,
     &0.11017E-03, 0.72965E-04, 0.46987E-04, 0.29233E-04, 0.17411E-04,
     &0.98128E-05, 0.51423E-05, 0.24448E-05, 0.10108E-05, 0.33826E-06,
     &0.79137E-07, 0.87770E-08, 0.80625E-10, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 4, 4),
     &      i=1, 99)/ ! Charm Q2=  3.22052407
     &0.65506E-02, 0.37999E-02, 0.25681E-02, 0.18263E-02, 0.13285E-02,
     &0.97655E-03, 0.72036E-03, 0.53080E-03, 0.38936E-03, 0.28349E-03,
     &0.20430E-03, 0.14531E-03, 0.10168E-03, 0.69759E-04, 0.46730E-04,
     &0.30396E-04, 0.19073E-04, 0.11448E-04, 0.64924E-05, 0.34210E-05,
     &0.16309E-05, 0.67553E-06, 0.22588E-06, 0.52311E-07, 0.56670E-08,
     &0.46091E-10, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 5, 5),
     &      i=1, 99)/ ! Charm Q2=  3.77478361
     &0.81087E-02, 0.47781E-02, 0.33005E-02, 0.24059E-02, 0.17982E-02,
     &0.13610E-02, 0.10362E-02, 0.79030E-03, 0.60204E-03, 0.45691E-03,
     &0.34476E-03, 0.25811E-03, 0.19138E-03, 0.14022E-03, 0.10127E-03,
     &0.71920E-04, 0.50052E-04, 0.34009E-04, 0.22448E-04, 0.14310E-04,
     &0.87345E-05, 0.50497E-05, 0.27203E-05, 0.13362E-05, 0.57502E-06,
     &0.20391E-06, 0.52042E-07, 0.70323E-08, 0.15295E-09, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 6, 6),
     &      i=1, 99)/ ! Charm Q2=  4.42443275
     &0.99790E-02, 0.59381E-02, 0.41747E-02, 0.31058E-02, 0.23735E-02,
     &0.18398E-02, 0.14371E-02, 0.11267E-02, 0.88406E-03, 0.69289E-03,
     &0.54147E-03, 0.42126E-03, 0.32580E-03, 0.25015E-03, 0.19038E-03,
     &0.14339E-03, 0.10669E-03, 0.78260E-04, 0.56461E-04, 0.39955E-04,
     &0.27629E-04, 0.18591E-04, 0.12113E-04, 0.75804E-05, 0.45160E-05,
     &0.25258E-05, 0.12994E-05, 0.59663E-06, 0.23318E-06, 0.70019E-07,
     &0.13251E-07, 0.84586E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 7, 7),
     &      i=1, 99)/ ! Charm Q2=  5.18588781
     &0.10799E-01, 0.72938E-02, 0.52037E-02, 0.39367E-02, 0.30639E-02,
     &0.24220E-02, 0.19318E-02, 0.15486E-02, 0.12444E-02, 0.10005E-02,
     &0.80354E-03, 0.64385E-03, 0.51415E-03, 0.40873E-03, 0.32315E-03,
     &0.25382E-03, 0.19782E-03, 0.15281E-03, 0.11683E-03, 0.88275E-04,
     &0.65806E-04, 0.48285E-04, 0.34797E-04, 0.24554E-04, 0.16903E-04,
     &0.11295E-04, 0.72832E-05, 0.44971E-05, 0.26300E-05, 0.14331E-05,
     &0.71105E-06, 0.30977E-06, 0.11133E-06, 0.29014E-07, 0.40735E-08,
     &0.10339E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 8, 8),
     &      i=1, 99)/ ! Charm Q2=  6.0783906
     &0.12935E-01, 0.88728E-02, 0.63977E-02, 0.49079E-02, 0.38780E-02,
     &0.31156E-02, 0.25281E-02, 0.20638E-02, 0.16907E-02, 0.13873E-02,
     &0.11387E-02, 0.93388E-03, 0.76453E-03, 0.62422E-03, 0.50790E-03,
     &0.41152E-03, 0.33177E-03, 0.26595E-03, 0.21174E-03, 0.16732E-03,
     &0.13108E-03, 0.10169E-03, 0.78027E-04, 0.59107E-04, 0.44145E-04,
     &0.32424E-04, 0.23360E-04, 0.16472E-04, 0.11313E-04, 0.75309E-05,
     &0.48315E-05, 0.29582E-05, 0.17094E-05, 0.91637E-06, 0.44475E-06,
     &0.18660E-06, 0.63291E-07, 0.14903E-07, 0.16649E-08, 0.18056E-10,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 9, 9),
     &      i=1, 99)/ ! Charm Q2=  7.12449598
     &0.15360E-01, 0.10672E-01, 0.77691E-02, 0.60269E-02, 0.48218E-02,
     &0.39259E-02, 0.32312E-02, 0.26777E-02, 0.22284E-02, 0.18592E-02,
     &0.15530E-02, 0.12974E-02, 0.10833E-02, 0.90320E-03, 0.75148E-03,
     &0.62357E-03, 0.51576E-03, 0.42493E-03, 0.34858E-03, 0.28445E-03,
     &0.23083E-03, 0.18609E-03, 0.14893E-03, 0.11824E-03, 0.93015E-04,
     &0.72421E-04, 0.55745E-04, 0.42347E-04, 0.31695E-04, 0.23328E-04,
     &0.16833E-04, 0.11874E-04, 0.81545E-05, 0.54265E-05, 0.34736E-05,
     &0.21194E-05, 0.12186E-05, 0.64828E-06, 0.31135E-06, 0.12837E-06,
     &0.42198E-07, 0.94003E-08, 0.92216E-09, 0.43457E-11, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 10, 10),
     &      i=1, 99)/ ! Charm Q2=  8.35063744
     &0.16807E-01, 0.12726E-01, 0.93218E-02, 0.72971E-02, 0.58987E-02,
     &0.48565E-02, 0.40443E-02, 0.33933E-02, 0.28609E-02, 0.24197E-02,
     &0.20504E-02, 0.17389E-02, 0.14750E-02, 0.12505E-02, 0.10590E-02,
     &0.89533E-03, 0.75540E-03, 0.63566E-03, 0.53329E-03, 0.44587E-03,
     &0.37131E-03, 0.30785E-03, 0.25395E-03, 0.20834E-03, 0.16986E-03,
     &0.13757E-03, 0.11054E-03, 0.88093E-04, 0.69549E-04, 0.54338E-04,
     &0.41950E-04, 0.31959E-04, 0.23982E-04, 0.17690E-04, 0.12790E-04,
     &0.90377E-05, 0.62177E-05, 0.41410E-05, 0.26519E-05, 0.16185E-05,
     &0.92903E-06, 0.49398E-06, 0.23559E-06, 0.96762E-07, 0.31525E-07,
     &0.68673E-08, 0.64472E-09, 0.16129E-11, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 11, 11),
     &      i=1, 99)/ ! Charm Q2=  9.78780174
     &0.19472E-01, 0.13748E-01, 0.11059E-01, 0.87201E-02, 0.71093E-02,
     &0.59078E-02, 0.49683E-02, 0.42117E-02, 0.35894E-02, 0.30702E-02,
     &0.26325E-02, 0.22603E-02, 0.19420E-02, 0.16688E-02, 0.14335E-02,
     &0.12301E-02, 0.10543E-02, 0.90201E-03, 0.77019E-03, 0.65600E-03,
     &0.55723E-03, 0.47180E-03, 0.39810E-03, 0.33463E-03, 0.28000E-03,
     &0.23319E-03, 0.19317E-03, 0.15913E-03, 0.13022E-03, 0.10582E-03,
     &0.85330E-04, 0.68214E-04, 0.54010E-04, 0.42313E-04, 0.32742E-04,
     &0.25004E-04, 0.18812E-04, 0.13906E-04, 0.10073E-04, 0.71323E-05,
     &0.49141E-05, 0.32753E-05, 0.21004E-05, 0.12826E-05, 0.73708E-06,
     &0.39229E-06, 0.18710E-06, 0.76528E-07, 0.24861E-07, 0.53842E-08,
     &0.49862E-09, 0.72608E-12, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 12, 12),
     &      i=1, 99)/ ! Charm Q2=  11.4723053
     &0.22394E-01, 0.15953E-01, 0.12977E-01, 0.10297E-01, 0.84526E-02,
     &0.70779E-02, 0.60011E-02, 0.51310E-02, 0.44124E-02, 0.38096E-02,
     &0.32983E-02, 0.28611E-02, 0.24845E-02, 0.21586E-02, 0.18757E-02,
     &0.16292E-02, 0.14140E-02, 0.12260E-02, 0.10615E-02, 0.91746E-03,
     &0.79147E-03, 0.68122E-03, 0.58481E-03, 0.50067E-03, 0.42724E-03,
     &0.36332E-03, 0.30779E-03, 0.25966E-03, 0.21803E-03, 0.18219E-03,
     &0.15140E-03, 0.12507E-03, 0.10262E-03, 0.83608E-04, 0.67567E-04,
     &0.54131E-04, 0.42955E-04, 0.33712E-04, 0.26139E-04, 0.19991E-04,
     &0.15058E-04, 0.11139E-04, 0.80807E-05, 0.57242E-05, 0.39439E-05,
     &0.26304E-05, 0.16851E-05, 0.10291E-05, 0.59021E-06, 0.31184E-06,
     &0.14838E-06, 0.60353E-07, 0.19272E-07, 0.40872E-08, 0.36456E-09,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 13, 13),
     &      i=1, 99)/ ! Charm Q2=  13.4467154
     &0.24686E-01, 0.18352E-01, 0.15084E-01, 0.12017E-01, 0.99227E-02,
     &0.83619E-02, 0.71386E-02, 0.61473E-02, 0.53264E-02, 0.46347E-02,
     &0.40456E-02, 0.35390E-02, 0.31002E-02, 0.27183E-02, 0.23844E-02,
     &0.20917E-02, 0.18342E-02, 0.16075E-02, 0.14075E-02, 0.12310E-02,
     &0.10751E-02, 0.93737E-03, 0.81574E-03, 0.70844E-03, 0.61375E-03,
     &0.53036E-03, 0.45698E-03, 0.39252E-03, 0.33602E-03, 0.28658E-03,
     &0.24340E-03, 0.20585E-03, 0.17327E-03, 0.14507E-03, 0.12078E-03,
     &0.99929E-04, 0.82134E-04, 0.67000E-04, 0.54225E-04, 0.43468E-04,
     &0.34523E-04, 0.27109E-04, 0.21028E-04, 0.16081E-04, 0.12106E-04,
     &0.89567E-05, 0.64872E-05, 0.45873E-05, 0.31540E-05, 0.20968E-05,
     &0.13377E-05, 0.81326E-06, 0.46316E-06, 0.24291E-06, 0.11346E-06,
     &0.45189E-07, 0.13973E-07, 0.27690E-08, 0.20803E-09, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 14, 14),
     &      i=1, 99)/ ! Charm Q2=  15.7609253
     &0.27827E-01, 0.20919E-01, 0.16109E-01, 0.13879E-01, 0.11513E-01,
     &0.97529E-02, 0.83735E-02, 0.72545E-02, 0.63254E-02, 0.55402E-02,
     &0.48691E-02, 0.42894E-02, 0.37853E-02, 0.33443E-02, 0.29567E-02,
     &0.26149E-02, 0.23126E-02, 0.20446E-02, 0.18068E-02, 0.15953E-02,
     &0.14072E-02, 0.12398E-02, 0.10907E-02, 0.95812E-03, 0.84009E-03,
     &0.73509E-03, 0.64184E-03, 0.55908E-03, 0.48569E-03, 0.42073E-03,
     &0.36334E-03, 0.31275E-03, 0.26818E-03, 0.22910E-03, 0.19489E-03,
     &0.16501E-03, 0.13900E-03, 0.11650E-03, 0.97054E-04, 0.80333E-04,
     &0.66037E-04, 0.53876E-04, 0.43581E-04, 0.34916E-04, 0.27706E-04,
     &0.21730E-04, 0.16821E-04, 0.12839E-04, 0.96464E-05, 0.71084E-05,
     &0.51264E-05, 0.36069E-05, 0.24649E-05, 0.16251E-05, 0.10268E-05,
     &0.61669E-06, 0.34491E-06, 0.17645E-06, 0.79853E-07, 0.30289E-07,
     &0.86356E-08, 0.14704E-08, 0.74102E-10, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 15, 15),
     &      i=1, 99)/ ! Charm Q2=  18.4734173
     &0.31138E-01, 0.22491E-01, 0.18270E-01, 0.15872E-01, 0.13212E-01,
     &0.11243E-01, 0.96988E-02, 0.84454E-02, 0.74022E-02, 0.65198E-02,
     &0.57626E-02, 0.51068E-02, 0.45344E-02, 0.40315E-02, 0.35879E-02,
     &0.31947E-02, 0.28454E-02, 0.25341E-02, 0.22562E-02, 0.20079E-02,
     &0.17857E-02, 0.15866E-02, 0.14082E-02, 0.12484E-02, 0.11052E-02,
     &0.97692E-03, 0.86202E-03, 0.75915E-03, 0.66719E-03, 0.58507E-03,
     &0.51184E-03, 0.44651E-03, 0.38845E-03, 0.33689E-03, 0.29122E-03,
     &0.25087E-03, 0.21527E-03, 0.18395E-03, 0.15646E-03, 0.13249E-03,
     &0.11160E-03, 0.93459E-04, 0.77796E-04, 0.64328E-04, 0.52787E-04,
     &0.43000E-04, 0.34709E-04, 0.27744E-04, 0.21942E-04, 0.17144E-04,
     &0.13222E-04, 0.10041E-04, 0.74968E-05, 0.54836E-05, 0.39220E-05,
     &0.27323E-05, 0.18433E-05, 0.11970E-05, 0.74306E-06, 0.43338E-06,
     &0.23548E-06, 0.11550E-06, 0.49192E-07, 0.16960E-07, 0.41090E-08,
     &0.50063E-09, 0.59090E-11, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 16, 16),
     &      i=1, 99)/ ! Charm Q2=  21.6527348
     &0.34606E-01, 0.25118E-01, 0.20538E-01, 0.17977E-01, 0.15017E-01,
     &0.12820E-01, 0.11104E-01, 0.97100E-02, 0.85493E-02, 0.75648E-02,
     &0.67186E-02, 0.59841E-02, 0.53407E-02, 0.47739E-02, 0.42721E-02,
     &0.38256E-02, 0.34275E-02, 0.30711E-02, 0.27515E-02, 0.24647E-02,
     &0.22067E-02, 0.19745E-02, 0.17653E-02, 0.15768E-02, 0.14069E-02,
     &0.12537E-02, 0.11157E-02, 0.99134E-03, 0.87939E-03, 0.77867E-03,
     &0.68812E-03, 0.60676E-03, 0.53384E-03, 0.46854E-03, 0.41010E-03,
     &0.35794E-03, 0.31145E-03, 0.27013E-03, 0.23345E-03, 0.20098E-03,
     &0.17230E-03, 0.14712E-03, 0.12502E-03, 0.10568E-03, 0.88845E-04,
     &0.74259E-04, 0.61647E-04, 0.50833E-04, 0.41578E-04, 0.33730E-04,
     &0.27108E-04, 0.21557E-04, 0.16946E-04, 0.13156E-04, 0.10060E-04,
     &0.75787E-05, 0.55967E-05, 0.40469E-05, 0.28520E-05, 0.19522E-05,
     &0.12902E-05, 0.81807E-06, 0.48946E-06, 0.27536E-06, 0.14134E-06,
     &0.64260E-07, 0.24447E-07, 0.70003E-08, 0.12117E-08, 0.66801E-10,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 17, 17),
     &      i=1, 99)/ ! Charm Q2=  25.379221
     &0.38196E-01, 0.27847E-01, 0.22899E-01, 0.18881E-01, 0.16905E-01,
     &0.14479E-01, 0.12579E-01, 0.11040E-01, 0.97561E-02, 0.86666E-02,
     &0.77294E-02, 0.69132E-02, 0.61970E-02, 0.55645E-02, 0.50026E-02,
     &0.45014E-02, 0.40529E-02, 0.36502E-02, 0.32877E-02, 0.29608E-02,
     &0.26660E-02, 0.23994E-02, 0.21582E-02, 0.19398E-02, 0.17420E-02,
     &0.15628E-02, 0.14005E-02, 0.12534E-02, 0.11203E-02, 0.99972E-03,
     &0.89074E-03, 0.79226E-03, 0.70331E-03, 0.62312E-03, 0.55076E-03,
     &0.48569E-03, 0.42727E-03, 0.37483E-03, 0.32788E-03, 0.28595E-03,
     &0.24853E-03, 0.21530E-03, 0.18574E-03, 0.15963E-03, 0.13659E-03,
     &0.11632E-03, 0.98556E-04, 0.83066E-04, 0.69583E-04, 0.57919E-04,
     &0.47852E-04, 0.39259E-04, 0.31940E-04, 0.25743E-04, 0.20535E-04,
     &0.16203E-04, 0.12622E-04, 0.96925E-05, 0.73225E-05, 0.54359E-05,
     &0.39502E-05, 0.28008E-05, 0.19304E-05, 0.12873E-05, 0.82415E-06,
     &0.49953E-06, 0.28446E-06, 0.14902E-06, 0.69646E-07, 0.27598E-07,
     &0.84862E-08, 0.16709E-08, 0.12578E-09, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 18, 18),
     &      i=1, 99)/ ! Charm Q2=  29.7470417
     &0.41204E-01, 0.30657E-01, 0.25340E-01, 0.20943E-01, 0.18869E-01,
     &0.16201E-01, 0.14117E-01, 0.12424E-01, 0.11015E-01, 0.98182E-02,
     &0.87859E-02, 0.78864E-02, 0.70961E-02, 0.63961E-02, 0.57729E-02,
     &0.52158E-02, 0.47157E-02, 0.42655E-02, 0.38590E-02, 0.34915E-02,
     &0.31586E-02, 0.28566E-02, 0.25824E-02, 0.23331E-02, 0.21065E-02,
     &0.19004E-02, 0.17129E-02, 0.15422E-02, 0.13869E-02, 0.12458E-02,
     &0.11174E-02, 0.10008E-02, 0.89490E-03, 0.79881E-03, 0.71175E-03,
     &0.63287E-03, 0.56162E-03, 0.49721E-03, 0.43912E-03, 0.38681E-03,
     &0.33981E-03, 0.29764E-03, 0.25988E-03, 0.22620E-03, 0.19613E-03,
     &0.16941E-03, 0.14574E-03, 0.12482E-03, 0.10640E-03, 0.90248E-04,
     &0.76111E-04, 0.63814E-04, 0.53132E-04, 0.43953E-04, 0.36082E-04,
     &0.29368E-04, 0.23676E-04, 0.18900E-04, 0.14918E-04, 0.11612E-04,
     &0.89252E-05, 0.67467E-05, 0.50072E-05, 0.36375E-05, 0.25786E-05,
     &0.17759E-05, 0.11828E-05, 0.75478E-06, 0.45873E-06, 0.26004E-06,
     &0.13568E-06, 0.63046E-07, 0.24850E-07, 0.75276E-08, 0.14559E-08,
     &0.10678E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 19, 19),
     &      i=1, 99)/ ! Charm Q2=  34.8665771
     &0.44812E-01, 0.33531E-01, 0.26783E-01, 0.23061E-01, 0.19696E-01,
     &0.17979E-01, 0.15702E-01, 0.13855E-01, 0.12317E-01, 0.11008E-01,
     &0.98810E-02, 0.88968E-02, 0.80299E-02, 0.72614E-02, 0.65762E-02,
     &0.59622E-02, 0.54097E-02, 0.49111E-02, 0.44601E-02, 0.40510E-02,
     &0.36795E-02, 0.33414E-02, 0.30334E-02, 0.27526E-02, 0.24964E-02,
     &0.22626E-02, 0.20492E-02, 0.18543E-02, 0.16763E-02, 0.15136E-02,
     &0.13653E-02, 0.12298E-02, 0.11063E-02, 0.99370E-03, 0.89110E-03,
     &0.79770E-03, 0.71286E-03, 0.63579E-03, 0.56585E-03, 0.50252E-03,
     &0.44518E-03, 0.39342E-03, 0.34678E-03, 0.30476E-03, 0.26704E-03,
     &0.23317E-03, 0.20298E-03, 0.17602E-03, 0.15204E-03, 0.13077E-03,
     &0.11197E-03, 0.95411E-04, 0.80858E-04, 0.68168E-04, 0.57083E-04,
     &0.47505E-04, 0.39250E-04, 0.32169E-04, 0.26131E-04, 0.21032E-04,
     &0.16749E-04, 0.13170E-04, 0.10241E-04, 0.78348E-05, 0.58954E-05,
     &0.43543E-05, 0.31443E-05, 0.22143E-05, 0.15134E-05, 0.99811E-06,
     &0.62712E-06, 0.37460E-06, 0.20835E-06, 0.10568E-06, 0.47133E-07,
     &0.17496E-07, 0.48170E-08, 0.77800E-09, 0.33198E-10, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 20, 20),
     &      i=1, 99)/ ! Charm Q2=  40.8671951
     &0.48485E-01, 0.35797E-01, 0.29168E-01, 0.25220E-01, 0.21584E-01,
     &0.19808E-01, 0.17328E-01, 0.15323E-01, 0.13652E-01, 0.12231E-01,
     &0.11006E-01, 0.99352E-02, 0.89919E-02, 0.81544E-02, 0.74059E-02,
     &0.67341E-02, 0.61287E-02, 0.55813E-02, 0.50851E-02, 0.46341E-02,
     &0.42233E-02, 0.38485E-02, 0.35064E-02, 0.31937E-02, 0.29076E-02,
     &0.26457E-02, 0.24058E-02, 0.21860E-02, 0.19848E-02, 0.18003E-02,
     &0.16313E-02, 0.14765E-02, 0.13348E-02, 0.12051E-02, 0.10865E-02,
     &0.97812E-03, 0.87908E-03, 0.78880E-03, 0.70645E-03, 0.63147E-03,
     &0.56332E-03, 0.50142E-03, 0.44526E-03, 0.39444E-03, 0.34848E-03,
     &0.30699E-03, 0.26972E-03, 0.23618E-03, 0.20610E-03, 0.17923E-03,
     &0.15526E-03, 0.13393E-03, 0.11504E-03, 0.98343E-04, 0.83613E-04,
     &0.70754E-04, 0.59494E-04, 0.49702E-04, 0.41239E-04, 0.33955E-04,
     &0.27722E-04, 0.22434E-04, 0.17972E-04, 0.14220E-04, 0.11135E-04,
     &0.85871E-05, 0.65187E-05, 0.48625E-05, 0.35523E-05, 0.25338E-05,
     &0.17590E-05, 0.11814E-05, 0.75736E-06, 0.46724E-06, 0.26918E-06,
     &0.14311E-06, 0.68470E-07, 0.28021E-07, 0.90480E-08, 0.19761E-08,
     &0.18974E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 21, 21),
     &      i=1, 99)/ ! Charm Q2=  47.9005318
     &0.52201E-01, 0.38633E-01, 0.31579E-01, 0.27414E-01, 0.23498E-01,
     &0.21676E-01, 0.18991E-01, 0.16819E-01, 0.15015E-01, 0.13480E-01,
     &0.12155E-01, 0.10997E-01, 0.99758E-02, 0.90679E-02, 0.82560E-02,
     &0.75263E-02, 0.68676E-02, 0.62710E-02, 0.57290E-02, 0.52356E-02,
     &0.47852E-02, 0.43739E-02, 0.39973E-02, 0.36524E-02, 0.33360E-02,
     &0.30457E-02, 0.27791E-02, 0.25342E-02, 0.23092E-02, 0.21024E-02,
     &0.19125E-02, 0.17380E-02, 0.15778E-02, 0.14307E-02, 0.12956E-02,
     &0.11718E-02, 0.10582E-02, 0.95420E-03, 0.85911E-03, 0.77207E-03,
     &0.69259E-03, 0.62012E-03, 0.55408E-03, 0.49397E-03, 0.43936E-03,
     &0.38983E-03, 0.34497E-03, 0.30449E-03, 0.26787E-03, 0.23498E-03,
     &0.20544E-03, 0.17896E-03, 0.15529E-03, 0.13421E-03, 0.11551E-03,
     &0.98936E-04, 0.84330E-04, 0.71456E-04, 0.60235E-04, 0.50437E-04,
     &0.41950E-04, 0.34627E-04, 0.28352E-04, 0.23013E-04, 0.18493E-04,
     &0.14691E-04, 0.11535E-04, 0.89353E-05, 0.68156E-05, 0.51089E-05,
     &0.37523E-05, 0.26951E-05, 0.18846E-05, 0.12772E-05, 0.82752E-06,
     &0.51717E-06, 0.30284E-06, 0.16445E-06, 0.80938E-07, 0.34612E-07,
     &0.11975E-07, 0.29483E-08, 0.36963E-09, 0.30404E-11, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 22, 22),
     &      i=1, 99)/ ! Charm Q2=  56.1443253
     &0.55936E-01, 0.41485E-01, 0.34008E-01, 0.29645E-01, 0.25434E-01,
     &0.22249E-01, 0.20679E-01, 0.18342E-01, 0.16398E-01, 0.14747E-01,
     &0.13322E-01, 0.12076E-01, 0.10976E-01, 0.99975E-02, 0.91215E-02,
     &0.83332E-02, 0.76210E-02, 0.69751E-02, 0.63874E-02, 0.58515E-02,
     &0.53618E-02, 0.49134E-02, 0.45021E-02, 0.41248E-02, 0.37779E-02,
     &0.34589E-02, 0.31654E-02, 0.28952E-02, 0.26464E-02, 0.24173E-02,
     &0.22061E-02, 0.20117E-02, 0.18326E-02, 0.16677E-02, 0.15160E-02,
     &0.13764E-02, 0.12481E-02, 0.11302E-02, 0.10218E-02, 0.92250E-03,
     &0.83143E-03, 0.74802E-03, 0.67177E-03, 0.60209E-03, 0.53848E-03,
     &0.48053E-03, 0.42785E-03, 0.37996E-03, 0.33661E-03, 0.29725E-03,
     &0.26183E-03, 0.22986E-03, 0.20113E-03, 0.17536E-03, 0.15231E-03,
     &0.13177E-03, 0.11349E-03, 0.97255E-04, 0.82962E-04, 0.70384E-04,
     &0.59354E-04, 0.49744E-04, 0.41404E-04, 0.34195E-04, 0.28018E-04,
     &0.22752E-04, 0.18287E-04, 0.14558E-04, 0.11430E-04, 0.88618E-05,
     &0.67633E-05, 0.50695E-05, 0.37284E-05, 0.26792E-05, 0.18755E-05,
     &0.12719E-05, 0.82688E-06, 0.51513E-06, 0.30207E-06, 0.16444E-06,
     &0.81084E-07, 0.34682E-07, 0.11987E-07, 0.29761E-08, 0.37677E-09,
     &0.32098E-11, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 23, 23),
     &      i=1, 99)/ ! Charm Q2=  65.8068924
     &0.59679E-01, 0.44344E-01, 0.36449E-01, 0.30815E-01, 0.27387E-01,
     &0.23985E-01, 0.22386E-01, 0.19880E-01, 0.17797E-01, 0.16028E-01,
     &0.14501E-01, 0.13166E-01, 0.11987E-01, 0.10938E-01, 0.99981E-02,
     &0.91514E-02, 0.83853E-02, 0.76896E-02, 0.70561E-02, 0.64777E-02,
     &0.59483E-02, 0.54627E-02, 0.50170E-02, 0.46070E-02, 0.42298E-02,
     &0.38822E-02, 0.35618E-02, 0.32663E-02, 0.29935E-02, 0.27418E-02,
     &0.25095E-02, 0.22950E-02, 0.20969E-02, 0.19142E-02, 0.17456E-02,
     &0.15900E-02, 0.14467E-02, 0.13146E-02, 0.11930E-02, 0.10811E-02,
     &0.97817E-03, 0.88368E-03, 0.79692E-03, 0.71742E-03, 0.64462E-03,
     &0.57801E-03, 0.51718E-03, 0.46172E-03, 0.41122E-03, 0.36536E-03,
     &0.32363E-03, 0.28598E-03, 0.25188E-03, 0.22118E-03, 0.19352E-03,
     &0.16873E-03, 0.14655E-03, 0.12674E-03, 0.10909E-03, 0.93526E-04,
     &0.79723E-04, 0.67596E-04, 0.56978E-04, 0.47711E-04, 0.39668E-04,
     &0.32735E-04, 0.26799E-04, 0.21736E-04, 0.17443E-04, 0.13845E-04,
     &0.10855E-04, 0.83912E-05, 0.63855E-05, 0.47720E-05, 0.34926E-05,
     &0.24975E-05, 0.17367E-05, 0.11673E-05, 0.75671E-06, 0.46460E-06,
     &0.26903E-06, 0.14371E-06, 0.68894E-07, 0.28453E-07, 0.93601E-08,
     &0.20835E-08, 0.21585E-09, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 24, 24),
     &      i=1, 99)/ ! Charm Q2=  77.1324081
     &0.63422E-01, 0.47204E-01, 0.38900E-01, 0.32916E-01, 0.29354E-01,
     &0.25729E-01, 0.22848E-01, 0.21430E-01, 0.19206E-01, 0.17318E-01,
     &0.15689E-01, 0.14264E-01, 0.13006E-01, 0.11885E-01, 0.10881E-01,
     &0.99761E-02, 0.91564E-02, 0.84115E-02, 0.77323E-02, 0.71112E-02,
     &0.65420E-02, 0.60196E-02, 0.55393E-02, 0.50969E-02, 0.46893E-02,
     &0.43131E-02, 0.39657E-02, 0.36447E-02, 0.33481E-02, 0.30738E-02,
     &0.28201E-02, 0.25854E-02, 0.23685E-02, 0.21678E-02, 0.19823E-02,
     &0.18108E-02, 0.16523E-02, 0.15059E-02, 0.13709E-02, 0.12463E-02,
     &0.11315E-02, 0.10255E-02, 0.92822E-03, 0.83867E-03, 0.75650E-03,
     &0.68107E-03, 0.61195E-03, 0.54872E-03, 0.49091E-03, 0.43819E-03,
     &0.39024E-03, 0.34649E-03, 0.30691E-03, 0.27103E-03, 0.23861E-03,
     &0.20936E-03, 0.18306E-03, 0.15948E-03, 0.13836E-03, 0.11950E-03,
     &0.10281E-03, 0.87953E-04, 0.74870E-04, 0.63380E-04, 0.53309E-04,
     &0.44546E-04, 0.36955E-04, 0.30422E-04, 0.24824E-04, 0.20039E-04,
     &0.16039E-04, 0.12672E-04, 0.98828E-05, 0.75969E-05, 0.57414E-05,
     &0.42577E-05, 0.30898E-05, 0.21884E-05, 0.15044E-05, 0.99379E-06,
     &0.63138E-06, 0.37945E-06, 0.21280E-06, 0.10932E-06, 0.49744E-07,
     &0.18937E-07, 0.54502E-08, 0.96341E-09, 0.54103E-10, 0.00000E+00,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 25, 25),
     &      i=1, 99)/ ! Charm Q2=  90.407074
     &0.66385E-01, 0.50060E-01, 0.40967E-01, 0.35017E-01, 0.31326E-01,
     &0.27480E-01, 0.24424E-01, 0.22989E-01, 0.20622E-01, 0.18614E-01,
     &0.16882E-01, 0.15368E-01, 0.14030E-01, 0.12838E-01, 0.11769E-01,
     &0.10805E-01, 0.99316E-02, 0.91372E-02, 0.84123E-02, 0.77488E-02,
     &0.71405E-02, 0.65814E-02, 0.60665E-02, 0.55919E-02, 0.51538E-02,
     &0.47490E-02, 0.43747E-02, 0.40285E-02, 0.37080E-02, 0.34111E-02,
     &0.31361E-02, 0.28815E-02, 0.26454E-02, 0.24268E-02, 0.22243E-02,
     &0.20367E-02, 0.18631E-02, 0.17025E-02, 0.15539E-02, 0.14165E-02,
     &0.12896E-02, 0.11725E-02, 0.10644E-02, 0.96475E-03, 0.87302E-03,
     &0.78860E-03, 0.71108E-03, 0.63997E-03, 0.57482E-03, 0.51513E-03,
     &0.46055E-03, 0.41089E-03, 0.36552E-03, 0.32434E-03, 0.28697E-03,
     &0.25313E-03, 0.22257E-03, 0.19503E-03, 0.17029E-03, 0.14808E-03,
     &0.12819E-03, 0.11057E-03, 0.94851E-04, 0.80968E-04, 0.68746E-04,
     &0.58006E-04, 0.48635E-04, 0.40494E-04, 0.33464E-04, 0.27420E-04,
     &0.22232E-04, 0.17887E-04, 0.14206E-04, 0.11148E-04, 0.86266E-05,
     &0.65655E-05, 0.49124E-05, 0.36005E-05, 0.25775E-05, 0.17944E-05,
     &0.12000E-05, 0.78029E-06, 0.47932E-06, 0.27739E-06, 0.14819E-06,
     &0.70730E-07, 0.29250E-07, 0.95904E-08, 0.21339E-08, 0.22170E-09,
     &0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 26, 26),
     &      i=1, 99)/ ! Charm Q2=  105.966339
     &0.70002E-01, 0.52912E-01, 0.43326E-01, 0.37117E-01, 0.32321E-01,
     &0.29231E-01, 0.26001E-01, 0.23342E-01, 0.22044E-01, 0.19916E-01,
     &0.18080E-01, 0.16475E-01, 0.15056E-01, 0.13793E-01, 0.12659E-01,
     &0.11636E-01, 0.10709E-01, 0.98652E-02, 0.90946E-02, 0.83889E-02,
     &0.77412E-02, 0.71453E-02, 0.65959E-02, 0.60892E-02, 0.56208E-02,
     &0.51878E-02, 0.47870E-02, 0.44155E-02, 0.40712E-02, 0.37520E-02,
     &0.34559E-02, 0.31812E-02, 0.29261E-02, 0.26897E-02, 0.24702E-02,
     &0.22668E-02, 0.20781E-02, 0.19030E-02, 0.17408E-02, 0.15907E-02,
     &0.14517E-02, 0.13232E-02, 0.12043E-02, 0.10945E-02, 0.99321E-03,
     &0.89985E-03, 0.81384E-03, 0.73466E-03, 0.66194E-03, 0.59527E-03,
     &0.53415E-03, 0.47819E-03, 0.42710E-03, 0.38051E-03, 0.33808E-03,
     &0.29955E-03, 0.26460E-03, 0.23295E-03, 0.20443E-03, 0.17879E-03,
     &0.15573E-03, 0.13505E-03, 0.11666E-03, 0.10027E-03, 0.85753E-04,
     &0.72943E-04, 0.61674E-04, 0.51818E-04, 0.43242E-04, 0.35825E-04,
     &0.29432E-04, 0.23932E-04, 0.19311E-04, 0.15387E-04, 0.12118E-04,
     &0.94143E-05, 0.71963E-05, 0.54105E-05, 0.39878E-05, 0.28722E-05,
     &0.20137E-05, 0.13587E-05, 0.89292E-06, 0.55524E-06, 0.32639E-06,
     &0.17796E-06, 0.87540E-07, 0.37603E-07, 0.13131E-07, 0.32674E-08,
     &0.42360E-09, 0.32172E-11, 0.00000E+00, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 27, 27),
     &      i=1, 99)/ ! Charm Q2=  124.203392
     &0.73597E-01, 0.54917E-01, 0.45674E-01, 0.39215E-01, 0.34168E-01,
     &0.30979E-01, 0.27575E-01, 0.24774E-01, 0.23469E-01, 0.21219E-01,
     &0.19278E-01, 0.17582E-01, 0.16083E-01, 0.14748E-01, 0.13550E-01,
     &0.12468E-01, 0.11487E-01, 0.10594E-01, 0.97779E-02, 0.90301E-02,
     &0.83430E-02, 0.77105E-02, 0.71271E-02, 0.65884E-02, 0.60901E-02,
     &0.56289E-02, 0.52013E-02, 0.48047E-02, 0.44368E-02, 0.40953E-02,
     &0.37780E-02, 0.34832E-02, 0.32096E-02, 0.29553E-02, 0.27189E-02,
     &0.24995E-02, 0.22955E-02, 0.21063E-02, 0.19307E-02, 0.17678E-02,
     &0.16167E-02, 0.14767E-02, 0.13472E-02, 0.12272E-02, 0.11163E-02,
     &0.10138E-02, 0.91928E-03, 0.83211E-03, 0.75184E-03, 0.67803E-03,
     &0.61018E-03, 0.54797E-03, 0.49107E-03, 0.43887E-03, 0.39138E-03,
     &0.34805E-03, 0.30867E-03, 0.27292E-03, 0.24052E-03, 0.21125E-03,
     &0.18489E-03, 0.16120E-03, 0.13999E-03, 0.12100E-03, 0.10413E-03,
     &0.89143E-04, 0.75910E-04, 0.64261E-04, 0.54039E-04, 0.45145E-04,
     &0.37448E-04, 0.30806E-04, 0.25094E-04, 0.20263E-04, 0.16176E-04,
     &0.12756E-04, 0.99272E-05, 0.76039E-05, 0.57273E-05, 0.42299E-05,
     &0.30546E-05, 0.21476E-05, 0.14529E-05, 0.95821E-06, 0.59845E-06,
     &0.35371E-06, 0.19414E-06, 0.96383E-07, 0.41908E-07, 0.14924E-07,
     &0.38416E-08, 0.53455E-09, 0.81694E-11, 0.00000E+00, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 28, 28),
     &      i=1, 99)/ ! Charm Q2=  145.579071
     &0.77169E-01, 0.57652E-01, 0.48008E-01, 0.41305E-01, 0.36008E-01,
     &0.32725E-01, 0.29146E-01, 0.26203E-01, 0.23719E-01, 0.22522E-01,
     &0.20476E-01, 0.18689E-01, 0.17109E-01, 0.15702E-01, 0.14439E-01,
     &0.13299E-01, 0.12264E-01, 0.11322E-01, 0.10461E-01, 0.96709E-02,
     &0.89448E-02, 0.82757E-02, 0.76586E-02, 0.70880E-02, 0.65597E-02,
     &0.60703E-02, 0.56162E-02, 0.51948E-02, 0.48033E-02, 0.44396E-02,
     &0.41013E-02, 0.37869E-02, 0.34945E-02, 0.32223E-02, 0.29693E-02,
     &0.27338E-02, 0.25151E-02, 0.23117E-02, 0.21226E-02, 0.19469E-02,
     &0.17838E-02, 0.16324E-02, 0.14921E-02, 0.13619E-02, 0.12414E-02,
     &0.11299E-02, 0.10268E-02, 0.93159E-03, 0.84368E-03, 0.76272E-03,
     &0.68827E-03, 0.61978E-03, 0.55684E-03, 0.49928E-03, 0.44652E-03,
     &0.39833E-03, 0.35441E-03, 0.31441E-03, 0.27812E-03, 0.24523E-03,
     &0.21552E-03, 0.18868E-03, 0.16453E-03, 0.14297E-03, 0.12360E-03,
     &0.10642E-03, 0.91133E-04, 0.77632E-04, 0.65736E-04, 0.55301E-04,
     &0.46205E-04, 0.38322E-04, 0.31526E-04, 0.25704E-04, 0.20737E-04,
     &0.16557E-04, 0.13053E-04, 0.10153E-04, 0.77762E-05, 0.58515E-05,
     &0.43175E-05, 0.31162E-05, 0.21892E-05, 0.14809E-05, 0.97234E-06,
     &0.60586E-06, 0.35682E-06, 0.19493E-06, 0.95819E-07, 0.41365E-07,
     &0.14516E-07, 0.36301E-08, 0.47859E-09, 0.39449E-11, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 29, 29),
     &      i=1, 99)/ ! Charm Q2=  170.633575
     &0.80716E-01, 0.60369E-01, 0.50333E-01, 0.43388E-01, 0.37840E-01,
     &0.33567E-01, 0.30712E-01, 0.27626E-01, 0.25023E-01, 0.23826E-01,
     &0.21674E-01, 0.19794E-01, 0.18134E-01, 0.16655E-01, 0.15327E-01,
     &0.14128E-01, 0.13040E-01, 0.12049E-01, 0.11142E-01, 0.10310E-01,
     &0.95452E-02, 0.88401E-02, 0.81892E-02, 0.75867E-02, 0.70288E-02,
     &0.65113E-02, 0.60310E-02, 0.55848E-02, 0.51700E-02, 0.47842E-02,
     &0.44253E-02, 0.40912E-02, 0.37801E-02, 0.34902E-02, 0.32206E-02,
     &0.29694E-02, 0.27357E-02, 0.25181E-02, 0.23156E-02, 0.21272E-02,
     &0.19522E-02, 0.17895E-02, 0.16383E-02, 0.14982E-02, 0.13680E-02,
     &0.12475E-02, 0.11358E-02, 0.10325E-02, 0.93711E-03, 0.84903E-03,
     &0.76782E-03, 0.69294E-03, 0.62412E-03, 0.56100E-03, 0.50293E-03,
     &0.44995E-03, 0.40147E-03, 0.35727E-03, 0.31703E-03, 0.28041E-03,
     &0.24724E-03, 0.21728E-03, 0.19026E-03, 0.16590E-03, 0.14410E-03,
     &0.12460E-03, 0.10721E-03, 0.91788E-04, 0.78140E-04, 0.66137E-04,
     &0.55622E-04, 0.46456E-04, 0.38497E-04, 0.31607E-04, 0.25764E-04,
     &0.20756E-04, 0.16552E-04, 0.13026E-04, 0.10112E-04, 0.77244E-05,
     &0.57945E-05, 0.42596E-05, 0.30605E-05, 0.21392E-05, 0.14440E-05,
     &0.93731E-06, 0.57940E-06, 0.33654E-06, 0.18111E-06, 0.87530E-07,
     &0.36507E-07, 0.12162E-07, 0.28093E-08, 0.31399E-09, 0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      data ((c_grdl(i,j),j= 30, 30),
     &      i=1, 99)/ ! Charm Q2=  200.
     &0.84240E-01, 0.63067E-01, 0.52645E-01, 0.45196E-01, 0.39663E-01,
     &0.35201E-01, 0.32274E-01, 0.29045E-01, 0.26322E-01, 0.23980E-01,
     &0.22872E-01, 0.20899E-01, 0.19157E-01, 0.17606E-01, 0.16213E-01,
     &0.14955E-01, 0.13814E-01, 0.12773E-01, 0.11822E-01, 0.10948E-01,
     &0.10144E-01, 0.94030E-02, 0.87183E-02, 0.80841E-02, 0.74967E-02,
     &0.69513E-02, 0.64450E-02, 0.59744E-02, 0.55364E-02, 0.51287E-02,
     &0.47491E-02, 0.43954E-02, 0.40657E-02, 0.37586E-02, 0.34724E-02,
     &0.32055E-02, 0.29569E-02, 0.27251E-02, 0.25093E-02, 0.23085E-02,
     &0.21215E-02, 0.19475E-02, 0.17857E-02, 0.16355E-02, 0.14956E-02,
     &0.13661E-02, 0.12460E-02, 0.11347E-02, 0.10317E-02, 0.93641E-03,
     &0.84839E-03, 0.76729E-03, 0.69256E-03, 0.62379E-03, 0.56062E-03,
     &0.50269E-03, 0.44961E-03, 0.40111E-03, 0.35682E-03, 0.31654E-03,
     &0.27994E-03, 0.24677E-03, 0.21673E-03, 0.18962E-03, 0.16534E-03,
     &0.14346E-03, 0.12399E-03, 0.10661E-03, 0.91196E-04, 0.77568E-04,
     &0.65557E-04, 0.55045E-04, 0.45908E-04, 0.37988E-04, 0.31144E-04,
     &0.25307E-04, 0.20350E-04, 0.16172E-04, 0.12692E-04, 0.98105E-05,
     &0.74654E-05, 0.55769E-05, 0.40772E-05, 0.29070E-05, 0.20051E-05,
     &0.13473E-05, 0.86130E-06, 0.52457E-06, 0.29901E-06, 0.15662E-06,
     &0.72845E-07, 0.28749E-07, 0.87703E-08, 0.17380E-08, 0.13680E-09,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00,
     &0.00000E+00/

      DO I=1, 99
        DO J=1, 30
          UDS_GRD(I,J) = UDS_GRDL(I,J)
          G_GRD(I,J)   = G_GRDL(I,J)
          C_GRD(I,J)   = C_GRDL(I,J)
        ENDDO
      ENDDO

      RETURN
      END
*CMZ :  2.08/05 28/03/2000  14.07.14  by  Hannes Jung
*-- Author :    Hannes Jung   25/04/96
      SUBROUTINE SCAPDF(BETA,SCALE,XPQ,X_POM,T2)

      Implicit None

      REAL T2,X_POM
      REAL BETA,SCALE
      REAL XPQ(-6:6)
      integer i

      DO I=-6,6
         XPQ(I)=0.0
      ENDDO

      CALL SCA_MAIN(beta,scale,xpq,x_pom,t2)

      RETURN

      END
